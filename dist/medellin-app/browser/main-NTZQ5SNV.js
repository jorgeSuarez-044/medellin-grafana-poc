import{$ as ot,$a as Pf,$b as Un,A as Lb,Aa as Ci,Ab as sn,Ac as Qs,B as Nl,Ba as B_,Bb as V,Bc as Vf,C as vn,Ca as qb,Cb as $,Cc as jf,D as A_,Da as Oh,Db as Pe,Dc as Uf,E as Vl,Ea as Wb,Eb as U_,Ec as $r,F as jl,Fa as ja,Fb as $_,Fc as _x,G as Sf,Ga as wo,Gb as Of,Gc as yx,H as D_,Ha as Fh,Hb as Li,Hc as $f,I as xo,Ia as N_,Ib as Ff,Ic as vx,J as zb,Ja as Ef,Jb as _t,Jc as Gf,K as kh,Ka as nu,Kb as Je,L as Va,La as Lh,Lb as Er,M as Ul,Ma as ru,Mb as zi,Mc as Vh,N as R_,Na as ou,Nb as io,Nc as jh,O as Bb,Oa as Xb,Ob as an,P as O_,Pa as Yb,Pb as _i,Pc as Kc,Q as Nb,Qa as Kb,Qb as yi,Qc as Hf,R as Vb,Ra as Qb,Rb as sx,Rc as cu,S as F_,Sa as Jb,Sb as ax,Sc as bx,T as Tf,Ta as ex,Tb as Ua,Tc as xx,U as Ks,Ua as tx,Ub as le,V as gr,Va as Co,Vb as Lt,W as An,Wa as qe,Wb as ln,X as jb,Xa as zh,Xb as Wc,Y as Ji,Ya as _e,Yb as Mo,Z as ki,Za as Ft,Zb as So,_ as $o,_a as If,_b as To,a as Ye,aa as Zt,ab as kf,ac as _r,b as si,ba as Ub,bb as su,bc as G_,ca as ct,cb as au,cc as jr,d as Rb,da as L_,db as Bh,dc as Lf,e as I_,ea as zt,eb as $l,ec as zf,f as tu,fa as me,fb as ix,fc as Ur,g as Sr,ga as Ah,gb as nx,gc as lx,h as Ob,ha as z_,hb as rx,hc as pi,i as Na,ia as Hc,ib as V_,ic as Xc,j as P_,ja as $b,jb as rt,jc as $a,k as wf,ka as vs,kb as qt,kc as bs,l as Ut,la as Go,lb as Wt,lc as cx,m as to,ma as Ho,mb as Nr,mc as Bf,n as Bl,na as $t,nb as or,nc as dx,o as mr,oa as Gt,ob as it,oc as lu,p as bt,pa as Dh,pb as Af,pc as ux,q as Gc,qa as Gb,qb as Df,qc as hx,r as Ih,ra as Zo,rb as j_,rc as fi,s as Fb,sa as Tr,sb as Rf,sc as px,t as kt,ta as Zc,tb as Gl,tc as H_,u as iu,ua as Hb,ub as en,uc as fx,v as bo,va as Rh,vb as Ge,vc as mx,w as k_,wa as xi,wb as Vr,wc as Yc,x as Cf,xa as hi,xb as wi,xc as Nf,y as Ph,ya as qc,yb as Nh,yc as gx,z as Mf,za as Zb,zb as ox,zc as Hl}from"./chunk-3MUZ3QJ6.js";var $y=Rb((jy,Uy)=>{"use strict";(function(c,a){typeof jy=="object"&&typeof Uy<"u"?Uy.exports=a():typeof define=="function"&&define.amd?define(a):(c=typeof globalThis<"u"?globalThis:c||self,c.maplibregl=a())})(jy,function(){"use strict";var c={},a={};function i(h,s,T){if(a[h]=T,h==="index"){var Y="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",K={};return a.shared(K),a.index(c,K),typeof window<"u"&&c.setWorkerUrl(window.URL.createObjectURL(new Blob([Y],{type:"text/javascript"}))),c}}i("shared",["exports"],function(h){"use strict";function s(o,t,r,d){return new(r||(r=Promise))(function(f,_){function y(S){try{w(d.next(S))}catch(P){_(P)}}function b(S){try{w(d.throw(S))}catch(P){_(P)}}function w(S){var P;S.done?f(S.value):(P=S.value,P instanceof r?P:new r(function(A){A(P)})).then(y,b)}w((d=d.apply(o,t||[])).next())})}function T(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Y,K;function Ce(){if(K)return Y;function o(t,r){this.x=t,this.y=r}return K=1,Y=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,d=t.y-this.y;return r*r+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),d=Math.sin(t),f=d*this.x+r*this.y;return this.x=r*this.x-d*this.y,this.y=f,this},_rotateAround:function(t,r){var d=Math.cos(t),f=Math.sin(t),_=r.y+f*(this.x-r.x)+d*(this.y-r.y);return this.x=r.x+d*(this.x-r.x)-f*(this.y-r.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t},Y}typeof SuppressedError=="function"&&SuppressedError;var be,G,$e=T(Ce()),ft=function(){if(G)return be;function o(t,r,d,f){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(f-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=d,this.p2y=f}return G=1,be=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,f=0;f<8;f++){var _=this.sampleCurveX(d)-t;if(Math.abs(_)<r)return d;var y=this.sampleCurveDerivativeX(d);if(Math.abs(y)<1e-6)break;d-=_/y}var b=0,w=1;for(d=t,f=0;f<20&&(_=this.sampleCurveX(d),!(Math.abs(_-t)<r));f++)t>_?b=d:w=d,d=.5*(w-b)+b;return d},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},be}(),Ct=T(ft);let ut,lt;function vi(){return ut==null&&(ut=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ut}function bi(){if(lt==null&&(lt=!1,vi())){let t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let d=0;d<5*5;d++){let f=4*d;t.fillStyle=`rgb(${f},${f+1},${f+2})`,t.fillRect(d%5,Math.floor(d/5),1,1)}let r=t.getImageData(0,0,5,5).data;for(let d=0;d<5*5*4;d++)if(d%4!=3&&r[d]!==d){lt=!0;break}}}return lt||!1}var Et=1e-6,mi=typeof Float32Array<"u"?Float32Array:Array;function Yi(){var o=new mi(9);return mi!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function li(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Ir(){var o=new mi(3);return mi!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Ms(o){return Math.hypot(o[0],o[1],o[2])}function Gi(o,t,r){var d=new mi(3);return d[0]=o,d[1]=t,d[2]=r,d}Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)});var Kn,Bi=Ms;function Tt(o,t,r){var d=t[0],f=t[1],_=t[2],y=t[3];return o[0]=r[0]*d+r[4]*f+r[8]*_+r[12]*y,o[1]=r[1]*d+r[5]*f+r[9]*_+r[13]*y,o[2]=r[2]*d+r[6]*f+r[10]*_+r[14]*y,o[3]=r[3]*d+r[7]*f+r[11]*_+r[15]*y,o}function Gr(){var o=new mi(4);return mi!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function Ss(){var o=new mi(2);return mi!=Float32Array&&(o[0]=0,o[1]=0),o}function Ts(o,t){var r=new mi(2);return r[0]=o,r[1]=t,r}Ir(),Kn=new mi(4),mi!=Float32Array&&(Kn[0]=0,Kn[1]=0,Kn[2]=0,Kn[3]=0),Ir(),Gi(1,0,0),Gi(0,1,0),Gr(),Gr(),Yi(),Ss();let ci=8192;function ro(o,t,r){return t*(ci/(o.tileSize*Math.pow(2,r-o.tileID.overscaledZ)))}function vr(o,t){return(o%t+t)%t}function oo(o,t,r){return o*(1-r)+t*r}function tn(o){if(o<=0)return 0;if(o>=1)return 1;let t=o*o,r=t*o;return 4*(o<.5?r:3*(o-t)+r-.75)}function so(o,t,r,d){let f=new Ct(o,t,r,d);return _=>f.solve(_)}let bn=so(.25,.1,.25,1);function xn(o,t,r){return Math.min(r,Math.max(t,o))}function ar(o,t,r){let d=r-t,f=((o-t)%d+d)%d+t;return f===t?r:f}function wn(o,...t){for(let r of t)for(let d in r)o[d]=r[d];return o}let Yo=1;function Hr(o,t,r){let d={};for(let f in o)d[f]=t.call(this,o[f],f,o);return d}function Ko(o,t,r){let d={};for(let f in o)t.call(this,o[f],f,o)&&(d[f]=o[f]);return d}function lr(o){return Array.isArray(o)?o.map(lr):typeof o=="object"&&o?Hr(o,lr):o}let $n={};function Cn(o){$n[o]||(typeof console<"u"&&console.warn(o),$n[o]=!0)}function gi(o,t,r){return(r.y-o.y)*(t.x-o.x)>(t.y-o.y)*(r.x-o.x)}function Zr(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let nn=null;function rn(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}let na="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Mn(o,t,r,d,f){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let _=new VideoFrame(o,{timestamp:0});try{let y=_?.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);let b=y.startsWith("BGR"),w=new Uint8ClampedArray(d*f*4);if(yield _.copyTo(w,function(S,P,A,O,z){let B=4*Math.max(1,0),U=(Math.max(0,A)-A)*O*4+B,W=4*O,ie=Math.max(0,P),pe=Math.max(0,A);return{rect:{x:ie,y:pe,width:Math.min(S.width,P+O)-ie,height:Math.min(S.height,A+z)-pe},layout:[{offset:U,stride:W}]}}(o,t,r,d,f)),b)for(let S=0;S<w.length;S+=4){let P=w[S];w[S]=w[S+2],w[S+2]=P}return w}finally{_.close()}})}let Rn,Pr;function Ao(o,t,r,d){return o.addEventListener(t,r,d),{unsubscribe:()=>{o.removeEventListener(t,r,d)}}}function Xt(o){return o*Math.PI/180}function on(o){return o/Math.PI*180}let cr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},br={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ni="AbortError";function Ai(){return new Error(Ni)}let kr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ao(o){return kr.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}let qr="global-dispatcher";class Ei extends Error{constructor(t,r,d,f){super(`AJAXError: ${r} (${t}): ${d}`),this.status=t,this.statusText=r,this.url=d,this.body=f}}let Qn=()=>Zr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,xr=function(o,t){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){let d=ao(o.url);if(d)return d(o,t);if(Zr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:qr},t)}if(!(/^file:/.test(r=o.url)||/^file:/.test(Qn())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(d,f){return s(this,void 0,void 0,function*(){let _=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:Qn(),signal:f.signal}),y,b;d.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{y=yield fetch(_)}catch(S){throw new Ei(0,S.message,d.url,new Blob)}if(!y.ok){let S=yield y.blob();throw new Ei(y.status,y.statusText,d.url,S)}b=d.type==="arrayBuffer"||d.type==="image"?y.arrayBuffer():d.type==="json"?y.json():y.text();let w=yield b;if(f.signal.aborted)throw Ai();return{data:w,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(o,t);if(Zr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:qr},t)}var r;return function(d,f){return new Promise((_,y)=>{var b;let w=new XMLHttpRequest;w.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(w.responseType="arraybuffer");for(let S in d.headers)w.setRequestHeader(S,d.headers[S]);d.type==="json"&&(w.responseType="text",!((b=d.headers)===null||b===void 0)&&b.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=d.credentials==="include",w.onerror=()=>{y(new Error(w.statusText))},w.onload=()=>{if(!f.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let S=w.response;if(d.type==="json")try{S=JSON.parse(w.response)}catch(P){return void y(P)}_({data:S,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{let S=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});y(new Ei(w.status,w.statusText,d.url,S))}},f.signal.addEventListener("abort",()=>{w.abort(),y(Ai())}),w.send(d.body)})}(o,t)};function ve(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;let t=new URL(o),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function H(o,t,r){r[o]&&r[o].indexOf(t)!==-1||(r[o]=r[o]||[],r[o].push(t))}function Z(o,t,r){if(r&&r[o]){let d=r[o].indexOf(t);d!==-1&&r[o].splice(d,1)}}class Q{constructor(t,r={}){wn(this,r),this.type=t}}class se extends Q{constructor(t,r={}){super("error",wn({error:t},r))}}class fe{on(t,r){return this._listeners=this._listeners||{},H(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return Z(t,r,this._listeners),Z(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},H(t,r,this._oneTimeListeners),this):new Promise(d=>this.once(t,d))}fire(t,r){typeof t=="string"&&(t=new Q(t,r||{}));let d=t.type;if(this.listens(d)){t.target=this;let f=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(let b of f)b.call(this,t);let _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(let b of _)Z(d,b,this._oneTimeListeners),b.call(this,t);let y=this._eventedParent;y&&(wn(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof se&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var X={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Me=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ye(o,t){let r={};for(let d in o)d!=="ref"&&(r[d]=o[d]);return Me.forEach(d=>{d in t&&(r[d]=t[d])}),r}function we(o,t){if(Array.isArray(o)){if(!Array.isArray(t)||o.length!==t.length)return!1;for(let r=0;r<o.length;r++)if(!we(o[r],t[r]))return!1;return!0}if(typeof o=="object"&&o!==null&&t!==null){if(typeof t!="object"||Object.keys(o).length!==Object.keys(t).length)return!1;for(let r in o)if(!we(o[r],t[r]))return!1;return!0}return o===t}function Ee(o,t){o.push(t)}function xe(o,t,r){Ee(r,{command:"addSource",args:[o,t[o]]})}function Ne(o,t,r){Ee(t,{command:"removeSource",args:[o]}),r[o]=!0}function We(o,t,r,d){Ne(o,r,d),xe(o,t,r)}function Qe(o,t,r){let d;for(d in o[r])if(Object.prototype.hasOwnProperty.call(o[r],d)&&d!=="data"&&!we(o[r][d],t[r][d]))return!1;for(d in t[r])if(Object.prototype.hasOwnProperty.call(t[r],d)&&d!=="data"&&!we(o[r][d],t[r][d]))return!1;return!0}function ht(o,t,r,d,f,_){o=o||{},t=t||{};for(let y in o)Object.prototype.hasOwnProperty.call(o,y)&&(we(o[y],t[y])||r.push({command:_,args:[d,y,t[y],f]}));for(let y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(o,y)&&(we(o[y],t[y])||r.push({command:_,args:[d,y,t[y],f]}))}function It(o){return o.id}function wt(o,t){return o[t.id]=t,o}class De{constructor(t,r,d,f){this.message=(t?`${t}: `:"")+d,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)}}function ni(o,...t){for(let r of t)for(let d in r)o[d]=r[d];return o}class Bt extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class ri{constructor(t,r=[]){this.parent=t,this.bindings={};for(let[d,f]of r)this.bindings[d]=f}concat(t){return new ri(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}let xt={kind:"null"},Be={kind:"number"},mt={kind:"string"},Pt={kind:"boolean"},St={kind:"color"},Vi={kind:"projectionDefinition"},Jn={kind:"object"},At={kind:"value"},Es={kind:"collator"},ra={kind:"formatted"},Qo={kind:"padding"},Jo={kind:"colorArray"},dr={kind:"numberArray"},Do={kind:"resolvedImage"},Di={kind:"variableAnchorOffsetCollection"};function ai(o,t){return{kind:"array",itemType:o,N:t}}function Ii(o){if(o.kind==="array"){let t=Ii(o.itemType);return typeof o.N=="number"?`array<${t}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${t}>`}return o.kind}let oa=[xt,Be,mt,Pt,St,Vi,ra,Jn,ai(At),Qo,dr,Jo,Do,Di];function Is(o,t){if(t.kind==="error")return null;if(o.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Is(o.itemType,t.itemType))&&(typeof o.N!="number"||o.N===t.N))return null}else{if(o.kind===t.kind)return null;if(o.kind==="value"){for(let r of oa)if(!Is(r,t))return null}}return`Expected ${Ii(o)} but found ${Ii(t)} instead.`}function Ja(o,t){return t.some(r=>r.kind===o.kind)}function Ro(o,t){return t.some(r=>r==="null"?o===null:r==="array"?Array.isArray(o):r==="object"?o&&!Array.isArray(o)&&typeof o=="object":r===typeof o)}function lo(o,t){return o.kind==="array"&&t.kind==="array"?o.itemType.kind===t.itemType.kind&&typeof o.N=="number":o.kind===t.kind}let ld=.96422,el=.82521,cd=4/29,es=6/29,dd=3*es*es,ac=es*es*es,ud=Math.PI/180,hd=180/Math.PI;function lc(o){return(o%=360)<0&&(o+=360),o}function tl([o,t,r,d]){let f,_,y=cc((.2225045*(o=ts(o))+.7168786*(t=ts(t))+.0606169*(r=ts(r)))/1);o===t&&t===r?f=_=y:(f=cc((.4360747*o+.3850649*t+.1430804*r)/ld),_=cc((.0139322*o+.0971045*t+.7141733*r)/el));let b=116*y-16;return[b<0?0:b,500*(f-y),200*(y-_),d]}function ts(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function cc(o){return o>ac?Math.pow(o,1/3):o/dd+cd}function sa([o,t,r,d]){let f=(o+16)/116,_=isNaN(t)?f:f+t/500,y=isNaN(r)?f:f-r/200;return f=1*Ps(f),_=ld*Ps(_),y=el*Ps(y),[Wr(3.1338561*_-1.6168667*f-.4906146*y),Wr(-.9787684*_+1.9161415*f+.033454*y),Wr(.0719453*_-.2289914*f+1.4052427*y),d]}function Wr(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Ps(o){return o>es?o*o*o:dd*(o-cd)}let pd=Object.hasOwn||function(o,t){return Object.prototype.hasOwnProperty.call(o,t)};function aa(o,t){return pd(o,t)?o[t]:void 0}function la(o){return parseInt(o.padEnd(2,o),16)/255}function dc(o,t){return Gn(t?o/100:o,0,1)}function Gn(o,t,r){return Math.min(Math.max(t,o),r)}function Qt(o){return!o.some(Number.isNaN)}let ks={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function On(o,t,r){return o+r*(t-o)}function is(o,t,r){return o.map((d,f)=>On(d,t[f],r))}class Vt{constructor(t,r,d,f=1,_=!0){this.r=t,this.g=r,this.b=d,this.a=f,_||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[t,r,d,f]))}static parse(t){if(t instanceof Vt)return t;if(typeof t!="string")return;let r=function(d){if((d=d.toLowerCase().trim())==="transparent")return[0,0,0,0];let f=aa(ks,d);if(f){let[y,b,w]=f;return[y/255,b/255,w/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){let y=d.length<6?1:2,b=1;return[la(d.slice(b,b+=y)),la(d.slice(b,b+=y)),la(d.slice(b,b+=y)),la(d.slice(b,b+y)||"ff")]}if(d.startsWith("rgb")){let y=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){let[b,w,S,P,A,O,z,B,U,W,ie,pe]=y,oe=[P||" ",z||" ",W].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){let L=[S,O,U].join(""),q=L==="%%%"?100:L===""?255:0;if(q){let ae=[Gn(+w/q,0,1),Gn(+A/q,0,1),Gn(+B/q,0,1),ie?dc(+ie,pe):1];if(Qt(ae))return ae}}return}}let _=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){let[y,b,w,S,P,A,O,z,B]=_,U=[w||" ",P||" ",O].join("");if(U==="  "||U==="  /"||U===",,"||U===",,,"){let W=[+b,Gn(+S,0,100),Gn(+A,0,100),z?dc(+z,B):1];if(Qt(W))return function([ie,pe,oe,L]){function q(ae){let Te=(ae+ie/30)%12,Ve=pe*Math.min(oe,1-oe);return oe-Ve*Math.max(-1,Math.min(Te-3,9-Te,1))}return ie=lc(ie),pe/=100,oe/=100,[q(0),q(8),q(4),L]}(W)}}}(t);return r?new Vt(...r,!1):void 0}get rgb(){let{r:t,g:r,b:d,a:f}=this,_=f||1/0;return this.overwriteGetter("rgb",[t/_,r/_,d/_,f])}get hcl(){return this.overwriteGetter("hcl",function(t){let[r,d,f,_]=tl(t),y=Math.sqrt(d*d+f*f);return[Math.round(1e4*y)?lc(Math.atan2(f,d)*hd):NaN,y,r,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",tl(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){let[t,r,d,f]=this.rgb;return`rgba(${[t,r,d].map(_=>Math.round(255*_)).join(",")},${f})`}static interpolate(t,r,d,f="rgb"){switch(f){case"rgb":{let[_,y,b,w]=is(t.rgb,r.rgb,d);return new Vt(_,y,b,w,!1)}case"hcl":{let[_,y,b,w]=t.hcl,[S,P,A,O]=r.hcl,z,B;if(isNaN(_)||isNaN(S))isNaN(_)?isNaN(S)?z=NaN:(z=S,b!==1&&b!==0||(B=P)):(z=_,A!==1&&A!==0||(B=y));else{let oe=S-_;S>_&&oe>180?oe-=360:S<_&&_-S>180&&(oe+=360),z=_+d*oe}let[U,W,ie,pe]=function([oe,L,q,ae]){return oe=isNaN(oe)?0:oe*ud,sa([q,Math.cos(oe)*L,Math.sin(oe)*L,ae])}([z,B??On(y,P,d),On(b,A,d),On(w,O,d)]);return new Vt(U,W,ie,pe,!1)}case"lab":{let[_,y,b,w]=sa(is(t.lab,r.lab,d));return new Vt(_,y,b,w,!1)}}}}Vt.black=new Vt(0,0,0,1),Vt.white=new Vt(1,1,1,1),Vt.transparent=new Vt(0,0,0,0),Vt.red=new Vt(1,0,0,1);class ca{constructor(t,r,d){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}let da=["bottom","center","top"];class Ar{constructor(t,r,d,f,_,y){this.text=t,this.image=r,this.scale=d,this.fontStack=f,this.textColor=_,this.verticalAlign=y}}class Hn{constructor(t){this.sections=t}static fromString(t){return new Hn([new Ar(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Hn?t:Hn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Sn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Sn)return t;if(typeof t=="number")return new Sn([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(let r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Sn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d){return new Sn(is(t.values,r.values,d))}}class ji{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ji)return t;if(typeof t=="number")return new ji([t]);if(Array.isArray(t)){for(let r of t)if(typeof r!="number")return;return new ji(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d){return new ji(is(t.values,r.values,d))}}class hn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof hn)return t;if(typeof t=="string"){let d=Vt.parse(t);return d?new hn([d]):void 0}if(!Array.isArray(t))return;let r=[];for(let d of t){if(typeof d!="string")return;let f=Vt.parse(d);if(!f)return;r.push(f)}return new hn(r)}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d,f="rgb"){let _=[];if(t.values.length!=r.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${r.values.length}), cannot interpolate.`);for(let y=0;y<t.values.length;y++)_.push(Vt.interpolate(t.values[y],r.values[y],d,f));return new hn(_)}}class Mi extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}let As=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Zn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Zn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){let d=t[r],f=t[r+1];if(typeof d!="string"||!As.has(d)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new Zn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d){let f=t.values,_=r.values;if(f.length!==_.length)throw new Mi(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);let y=[];for(let b=0;b<f.length;b+=2){if(f[b]!==_[b])throw new Mi(`Cannot interpolate values containing mismatched anchors. from[${b}]: ${f[b]}, to[${b}]: ${_[b]}`);y.push(f[b]);let[w,S]=f[b+1],[P,A]=_[b+1];y.push([On(w,P,d),On(S,A,d)])}return new Zn(y)}}class ur{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ur({name:t,available:!1}):null}}class er{constructor(t,r,d){this.from=t,this.to=r,this.transition=d}static interpolate(t,r,d){return new er(t,r,d)}static parse(t){return t instanceof er?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new er(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new er(t.from,t.to,t.transition):typeof t=="string"?new er(t,t,1):void 0}}function ua(o,t,r,d){return typeof o=="number"&&o>=0&&o<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[o,t,r,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[o,t,r,d]:[o,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function oi(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof er||o instanceof Vt||o instanceof ca||o instanceof Hn||o instanceof Sn||o instanceof ji||o instanceof hn||o instanceof Zn||o instanceof ur)return!0;if(Array.isArray(o)){for(let t of o)if(!oi(t))return!1;return!0}if(typeof o=="object"){for(let t in o)if(!oi(o[t]))return!1;return!0}return!1}function Ui(o){if(o===null)return xt;if(typeof o=="string")return mt;if(typeof o=="boolean")return Pt;if(typeof o=="number")return Be;if(o instanceof Vt)return St;if(o instanceof er)return Vi;if(o instanceof ca)return Es;if(o instanceof Hn)return ra;if(o instanceof Sn)return Qo;if(o instanceof ji)return dr;if(o instanceof hn)return Jo;if(o instanceof Zn)return Di;if(o instanceof ur)return Do;if(Array.isArray(o)){let t=o.length,r;for(let d of o){let f=Ui(d);if(r){if(r===f)continue;r=At;break}r=f}return ai(r||At,t)}return Jn}function jt(o){let t=typeof o;return o===null?"":t==="string"||t==="number"||t==="boolean"?String(o):o instanceof Vt||o instanceof er||o instanceof Hn||o instanceof Sn||o instanceof ji||o instanceof hn||o instanceof Zn||o instanceof ur?o.toString():JSON.stringify(o)}class Mt{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!oi(t[1]))return r.error("invalid value");let d=t[1],f=Ui(d),_=r.expectedType;return f.kind!=="array"||f.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(f=_),new Mt(f,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}let Ds={string:mt,number:Be,boolean:Pt,object:Jn};class Dt{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d,f=1,_=t[0];if(_==="array"){let b,w;if(t.length>2){let S=t[1];if(typeof S!="string"||!(S in Ds)||S==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);b=Ds[S],f++}else b=At;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);w=t[2],f++}d=ai(b,w)}else{if(!Ds[_])throw new Error(`Types doesn't contain name = ${_}`);d=Ds[_]}let y=[];for(;f<t.length;f++){let b=r.parse(t[f],f,At);if(!b)return null;y.push(b)}return new Dt(d,y)}evaluate(t){for(let r=0;r<this.args.length;r++){let d=this.args[r].evaluate(t);if(!Is(this.type,Ui(d)))return d;if(r===this.args.length-1)throw new Mi(`Expected value to be of type ${Ii(this.type)}, but found ${Ii(Ui(d))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}let il={"to-boolean":Pt,"to-color":St,"to-number":Be,"to-string":mt};class Fn{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d=t[0];if(!il[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&t.length!==2)return r.error("Expected one argument.");let f=il[d],_=[];for(let y=1;y<t.length;y++){let b=r.parse(t[y],y,At);if(!b)return null;_.push(b)}return new Fn(f,_)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,d;for(let f of this.args){if(r=f.evaluate(t),d=null,r instanceof Vt)return r;if(typeof r=="string"){let _=t.parseColor(r);if(_)return _}else if(Array.isArray(r)&&(d=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:ua(r[0],r[1],r[2],r[3]),!d))return new Vt(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Mi(d||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(let d of this.args){r=d.evaluate(t);let f=Sn.parse(r);if(f)return f}throw new Mi(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"numberArray":{let r;for(let d of this.args){r=d.evaluate(t);let f=ji.parse(r);if(f)return f}throw new Mi(`Could not parse numberArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"colorArray":{let r;for(let d of this.args){r=d.evaluate(t);let f=hn.parse(r);if(f)return f}throw new Mi(`Could not parse colorArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(let d of this.args){r=d.evaluate(t);let f=Zn.parse(r);if(f)return f}throw new Mi(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(let d of this.args){if(r=d.evaluate(t),r===null)return 0;let f=Number(r);if(!isNaN(f))return f}throw new Mi(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Hn.fromString(jt(this.args[0].evaluate(t)));case"resolvedImage":return ur.fromString(jt(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return jt(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}let uc=["Unknown","Point","LineString","Polygon"];class hc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?uc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache.get(t);return r||(r=Vt.parse(t),this._parseColorCache.set(t,r)),r}}class ha{constructor(t,r,d=[],f,_=new ri,y=[]){this.registry=t,this.path=d,this.key=d.map(b=>`[${b}]`).join(""),this.scope=_,this.errors=y,this.expectedType=f,this._isConstant=r}parse(t,r,d,f,_={}){return r?this.concat(r,d,f)._parse(t,_):this._parse(t,_)}_parse(t,r){function d(f,_,y){return y==="assert"?new Dt(_,[f]):y==="coerce"?new Fn(_,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let _=this.registry[f];if(_){let y=_.parse(t,this);if(!y)return null;if(this.expectedType){let b=this.expectedType,w=y.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||w.kind!=="value"){if(b.kind==="projectionDefinition"&&["string","array"].includes(w.kind)||["color","formatted","resolvedImage"].includes(b.kind)&&["value","string"].includes(w.kind)||["padding","numberArray"].includes(b.kind)&&["value","number","array"].includes(w.kind)||b.kind==="colorArray"&&["value","string","array"].includes(w.kind)||b.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(w.kind))y=d(y,b,r.typeAnnotation||"coerce");else if(this.checkSubtype(b,w))return null}else y=d(y,b,r.typeAnnotation||"assert")}if(!(y instanceof Mt)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){let b=new hc;try{y=new Mt(y.type,y.evaluate(b))}catch(w){return this.error(w.message),null}}return y}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,d){let f=typeof t=="number"?this.path.concat(t):this.path,_=d?this.scope.concat(d):this.scope;return new ha(this.registry,this._isConstant,f,r||null,_,this.errors)}error(t,...r){let d=`${this.key}${r.map(f=>`[${f}]`).join("")}`;this.errors.push(new Bt(d,t))}checkSubtype(t,r){let d=Is(t,r);return d&&this.error(d),d}}class Dr{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(let r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);let d=[];for(let _=1;_<t.length-1;_+=2){let y=t[_];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,_);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",_);let b=r.parse(t[_+1],_+1);if(!b)return null;d.push([y,b])}let f=r.parse(t[t.length-1],t.length-1,r.expectedType,d);return f?new Dr(d,f):null}outputDefined(){return this.result.outputDefined()}}class pa{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let d=t[1];return r.scope.has(d)?new pa(d,r.scope.get(d)):r.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class pc{constructor(t,r,d){this.type=t,this.index=r,this.input=d}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,Be),f=r.parse(t[2],2,ai(r.expectedType||At));return d&&f?new pc(f.type.itemType,d,f):null}evaluate(t){let r=this.index.evaluate(t),d=this.input.evaluate(t);if(r<0)throw new Mi(`Array index out of bounds: ${r} < 0.`);if(r>=d.length)throw new Mi(`Array index out of bounds: ${r} > ${d.length-1}.`);if(r!==Math.floor(r))throw new Mi(`Array index must be an integer, but found ${r} instead.`);return d[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class fa{constructor(t,r){this.type=Pt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,At),f=r.parse(t[2],2,At);return d&&f?Ja(d.type,[Pt,mt,Be,xt,At])?new fa(d,f):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(d.type)} instead`):null}evaluate(t){let r=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!d)return!1;if(!Ro(r,["boolean","string","number","null"]))throw new Mi(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(Ui(r))} instead.`);if(!Ro(d,["string","array"]))throw new Mi(`Expected second argument to be of type array or string, but found ${Ii(Ui(d))} instead.`);return d.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class ma{constructor(t,r,d){this.type=Be,this.needle=t,this.haystack=r,this.fromIndex=d}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,At),f=r.parse(t[2],2,At);if(!d||!f)return null;if(!Ja(d.type,[Pt,mt,Be,xt,At]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(d.type)} instead`);if(t.length===4){let _=r.parse(t[3],3,Be);return _?new ma(d,f,_):null}return new ma(d,f)}evaluate(t){let r=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!Ro(r,["boolean","string","number","null"]))throw new Mi(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(Ui(r))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(t)),Ro(d,["string"])){let _=d.indexOf(r,f);return _===-1?-1:[...d.slice(0,_)].length}if(Ro(d,["array"]))return d.indexOf(r,f);throw new Mi(`Expected second argument to be of type array or string, but found ${Ii(Ui(d))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class tr{constructor(t,r,d,f,_,y){this.inputType=t,this.type=r,this.input=d,this.cases=f,this.outputs=_,this.otherwise=y}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let d,f;r.expectedType&&r.expectedType.kind!=="value"&&(f=r.expectedType);let _={},y=[];for(let S=2;S<t.length-1;S+=2){let P=t[S],A=t[S+1];Array.isArray(P)||(P=[P]);let O=r.concat(S);if(P.length===0)return O.error("Expected at least one branch label.");for(let B of P){if(typeof B!="number"&&typeof B!="string")return O.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return O.error("Numeric branch labels must be integer values.");if(d){if(O.checkSubtype(d,Ui(B)))return null}else d=Ui(B);if(_[String(B)]!==void 0)return O.error("Branch labels must be unique.");_[String(B)]=y.length}let z=r.parse(A,S,f);if(!z)return null;f=f||z.type,y.push(z)}let b=r.parse(t[1],1,At);if(!b)return null;let w=r.parse(t[t.length-1],t.length-1,f);return w?b.type.kind!=="value"&&r.concat(1).checkSubtype(d,b.type)?null:new tr(d,f,b,_,y,w):null}evaluate(t){let r=this.input.evaluate(t);return(Ui(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class pn{constructor(t,r,d){this.type=t,this.branches=r,this.otherwise=d}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let d;r.expectedType&&r.expectedType.kind!=="value"&&(d=r.expectedType);let f=[];for(let y=1;y<t.length-1;y+=2){let b=r.parse(t[y],y,Pt);if(!b)return null;let w=r.parse(t[y+1],y+1,d);if(!w)return null;f.push([b,w]),d=d||w.type}let _=r.parse(t[t.length-1],t.length-1,d);if(!_)return null;if(!d)throw new Error("Can't infer output type");return new pn(d,f,_)}evaluate(t){for(let[r,d]of this.branches)if(r.evaluate(t))return d.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(let[r,d]of this.branches)t(r),t(d);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Oo{constructor(t,r,d,f){this.type=t,this.input=r,this.beginIndex=d,this.endIndex=f}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,At),f=r.parse(t[2],2,Be);if(!d||!f)return null;if(!Ja(d.type,[ai(At),mt,At]))return r.error(`Expected first argument to be of type array or string, but found ${Ii(d.type)} instead`);if(t.length===4){let _=r.parse(t[3],3,Be);return _?new Oo(d.type,d,f,_):null}return new Oo(d.type,d,f)}evaluate(t){let r=this.input.evaluate(t),d=this.beginIndex.evaluate(t),f;if(this.endIndex&&(f=this.endIndex.evaluate(t)),Ro(r,["string"]))return[...r].slice(d,f).join("");if(Ro(r,["array"]))return r.slice(d,f);throw new Mi(`Expected first argument to be of type array or string, but found ${Ii(Ui(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function co(o,t){let r=o.length-1,d,f,_=0,y=r,b=0;for(;_<=y;)if(b=Math.floor((_+y)/2),d=o[b],f=o[b+1],d<=t){if(b===r||t<f)return b;_=b+1}else{if(!(d>t))throw new Mi("Input is not a number.");y=b-1}return 0}class Fo{constructor(t,r,d){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(let[f,_]of d)this.labels.push(f),this.outputs.push(_)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");let d=r.parse(t[1],1,Be);if(!d)return null;let f=[],_=null;r.expectedType&&r.expectedType.kind!=="value"&&(_=r.expectedType);for(let y=1;y<t.length;y+=2){let b=y===1?-1/0:t[y],w=t[y+1],S=y,P=y+1;if(typeof b!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(f.length&&f[f.length-1][0]>=b)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);let A=r.parse(w,P,_);if(!A)return null;_=_||A.type,f.push([b,A])}return new Fo(_,d,f)}evaluate(t){let r=this.labels,d=this.outputs;if(r.length===1)return d[0].evaluate(t);let f=this.input.evaluate(t);if(f<=r[0])return d[0].evaluate(t);let _=r.length;return f>=r[_-1]?d[_-1].evaluate(t):d[co(r,f)].evaluate(t)}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function fn(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var nl,ga,ns=function(){if(ga)return nl;function o(t,r,d,f){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(f-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=d,this.p2y=f}return ga=1,nl=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,f=0;f<8;f++){var _=this.sampleCurveX(d)-t;if(Math.abs(_)<r)return d;var y=this.sampleCurveDerivativeX(d);if(Math.abs(y)<1e-6)break;d-=_/y}var b=0,w=1;for(d=t,f=0;f<20&&(_=this.sampleCurveX(d),!(Math.abs(_-t)<r));f++)t>_?b=d:w=d,d=.5*(w-b)+b;return d},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},nl}(),Du=fn(ns);class Ln{constructor(t,r,d,f,_){this.type=t,this.operator=r,this.interpolation=d,this.input=f,this.labels=[],this.outputs=[];for(let[y,b]of _)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(t,r,d,f){let _=0;if(t.name==="exponential")_=_a(r,t.base,d,f);else if(t.name==="linear")_=_a(r,1,d,f);else if(t.name==="cubic-bezier"){let y=t.controlPoints;_=new Du(y[0],y[1],y[2],y[3]).solve(_a(r,1,d,f))}return _}static parse(t,r){let[d,f,_,...y]=t;if(!Array.isArray(f)||f.length===0)return r.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){let S=f[1];if(typeof S!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:S}}else{if(f[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(f[0])}`,1,0);{let S=f.slice(1);if(S.length!==4||S.some(P=>typeof P!="number"||P<0||P>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:S}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(_=r.parse(_,2,Be),!_)return null;let b=[],w=null;d!=="interpolate-hcl"&&d!=="interpolate-lab"||r.expectedType==Jo?r.expectedType&&r.expectedType.kind!=="value"&&(w=r.expectedType):w=St;for(let S=0;S<y.length;S+=2){let P=y[S],A=y[S+1],O=S+3,z=S+4;if(typeof P!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(b.length&&b[b.length-1][0]>=P)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);let B=r.parse(A,z,w);if(!B)return null;w=w||B.type,b.push([P,B])}return lo(w,Be)||lo(w,Vi)||lo(w,St)||lo(w,Qo)||lo(w,dr)||lo(w,Jo)||lo(w,Di)||lo(w,ai(Be))?new Ln(w,d,f,_,b):r.error(`Type ${Ii(w)} is not interpolatable.`)}evaluate(t){let r=this.labels,d=this.outputs;if(r.length===1)return d[0].evaluate(t);let f=this.input.evaluate(t);if(f<=r[0])return d[0].evaluate(t);let _=r.length;if(f>=r[_-1])return d[_-1].evaluate(t);let y=co(r,f),b=Ln.interpolationFactor(this.interpolation,f,r[y],r[y+1]),w=d[y].evaluate(t),S=d[y+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return On(w,S,b);case"color":return Vt.interpolate(w,S,b);case"padding":return Sn.interpolate(w,S,b);case"colorArray":return hn.interpolate(w,S,b);case"numberArray":return ji.interpolate(w,S,b);case"variableAnchorOffsetCollection":return Zn.interpolate(w,S,b);case"array":return is(w,S,b);case"projectionDefinition":return er.interpolate(w,S,b)}case"interpolate-hcl":switch(this.type.kind){case"color":return Vt.interpolate(w,S,b,"hcl");case"colorArray":return hn.interpolate(w,S,b,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Vt.interpolate(w,S,b,"lab");case"colorArray":return hn.interpolate(w,S,b,"lab")}}}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function _a(o,t,r,d){let f=d-r,_=o-r;return f===0?0:t===1?_/f:(Math.pow(t,_)-1)/(Math.pow(t,f)-1)}let Xr={color:Vt.interpolate,number:On,padding:Sn.interpolate,numberArray:ji.interpolate,colorArray:hn.interpolate,variableAnchorOffsetCollection:Zn.interpolate,array:is};class rs{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d=null,f=r.expectedType;f&&f.kind!=="value"&&(d=f);let _=[];for(let b of t.slice(1)){let w=r.parse(b,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!w)return null;d=d||w.type,_.push(w)}if(!d)throw new Error("No output type");let y=f&&_.some(b=>Is(f,b.type));return new rs(y?At:d,_)}evaluate(t){let r,d=null,f=0;for(let _ of this.args)if(f++,d=_.evaluate(t),d&&d instanceof ur&&!d.available&&(r||(r=d.name),d=null,f===this.args.length&&(d=r)),d!==null)break;return d}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function ya(o,t){return o==="=="||o==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function wr(o,t,r,d){return d.compare(t,r)===0}function os(o,t,r){let d=o!=="=="&&o!=="!=";return class FC{constructor(_,y,b){this.type=Pt,this.lhs=_,this.rhs=y,this.collator=b,this.hasUntypedArgument=_.type.kind==="value"||y.type.kind==="value"}static parse(_,y){if(_.length!==3&&_.length!==4)return y.error("Expected two or three arguments.");let b=_[0],w=y.parse(_[1],1,At);if(!w)return null;if(!ya(b,w.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${Ii(w.type)}'.`);let S=y.parse(_[2],2,At);if(!S)return null;if(!ya(b,S.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${Ii(S.type)}'.`);if(w.type.kind!==S.type.kind&&w.type.kind!=="value"&&S.type.kind!=="value")return y.error(`Cannot compare types '${Ii(w.type)}' and '${Ii(S.type)}'.`);d&&(w.type.kind==="value"&&S.type.kind!=="value"?w=new Dt(S.type,[w]):w.type.kind!=="value"&&S.type.kind==="value"&&(S=new Dt(w.type,[S])));let P=null;if(_.length===4){if(w.type.kind!=="string"&&S.type.kind!=="string"&&w.type.kind!=="value"&&S.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(P=y.parse(_[3],3,Es),!P)return null}return new FC(w,S,P)}evaluate(_){let y=this.lhs.evaluate(_),b=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){let w=Ui(y),S=Ui(b);if(w.kind!==S.kind||w.kind!=="string"&&w.kind!=="number")throw new Mi(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${w.kind}, ${S.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){let w=Ui(y),S=Ui(b);if(w.kind!=="string"||S.kind!=="string")return t(_,y,b)}return this.collator?r(_,y,b,this.collator.evaluate(_)):t(_,y,b)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}let rl=os("==",function(o,t,r){return t===r},wr),Ru=os("!=",function(o,t,r){return t!==r},function(o,t,r,d){return!wr(0,t,r,d)}),Rs=os("<",function(o,t,r){return t<r},function(o,t,r,d){return d.compare(t,r)<0}),fd=os(">",function(o,t,r){return t>r},function(o,t,r,d){return d.compare(t,r)>0}),Ou=os("<=",function(o,t,r){return t<=r},function(o,t,r,d){return d.compare(t,r)<=0}),Fu=os(">=",function(o,t,r){return t>=r},function(o,t,r,d){return d.compare(t,r)>=0});class ol{constructor(t,r,d){this.type=Es,this.locale=d,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");let d=t[1];if(typeof d!="object"||Array.isArray(d))return r.error("Collator options argument must be an object.");let f=r.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Pt);if(!f)return null;let _=r.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Pt);if(!_)return null;let y=null;return d.locale&&(y=r.parse(d.locale,1,mt),!y)?null:new ol(f,_,y)}evaluate(t){return new ca(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class ss{constructor(t,r,d,f,_){this.type=mt,this.number=t,this.locale=r,this.currency=d,this.minFractionDigits=f,this.maxFractionDigits=_}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");let d=r.parse(t[1],1,Be);if(!d)return null;let f=t[2];if(typeof f!="object"||Array.isArray(f))return r.error("NumberFormat options argument must be an object.");let _=null;if(f.locale&&(_=r.parse(f.locale,1,mt),!_))return null;let y=null;if(f.currency&&(y=r.parse(f.currency,1,mt),!y))return null;let b=null;if(f["min-fraction-digits"]&&(b=r.parse(f["min-fraction-digits"],1,Be),!b))return null;let w=null;return f["max-fraction-digits"]&&(w=r.parse(f["max-fraction-digits"],1,Be),!w)?null:new ss(d,_,y,b,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class sl{constructor(t){this.type=ra,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d=t[1];if(!Array.isArray(d)&&typeof d=="object")return r.error("First argument must be an image or text section.");let f=[],_=!1;for(let y=1;y<=t.length-1;++y){let b=t[y];if(_&&typeof b=="object"&&!Array.isArray(b)){_=!1;let w=null;if(b["font-scale"]&&(w=r.parse(b["font-scale"],1,Be),!w))return null;let S=null;if(b["text-font"]&&(S=r.parse(b["text-font"],1,ai(mt)),!S))return null;let P=null;if(b["text-color"]&&(P=r.parse(b["text-color"],1,St),!P))return null;let A=null;if(b["vertical-align"]){if(typeof b["vertical-align"]=="string"&&!da.includes(b["vertical-align"]))return r.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${b["vertical-align"]}' instead.`);if(A=r.parse(b["vertical-align"],1,mt),!A)return null}let O=f[f.length-1];O.scale=w,O.font=S,O.textColor=P,O.verticalAlign=A}else{let w=r.parse(t[y],1,At);if(!w)return null;let S=w.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,f.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new sl(f)}evaluate(t){return new Hn(this.sections.map(r=>{let d=r.content.evaluate(t);return Ui(d)===Do?new Ar("",d,null,null,null,r.verticalAlign?r.verticalAlign.evaluate(t):null):new Ar(jt(d),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null,r.verticalAlign?r.verticalAlign.evaluate(t):null)}))}eachChild(t){for(let r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor),r.verticalAlign&&t(r.verticalAlign)}outputDefined(){return!1}}class Os{constructor(t){this.type=Do,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");let d=r.parse(t[1],1,mt);return d?new Os(d):r.error("No image name provided.")}evaluate(t){let r=this.input.evaluate(t),d=ur.fromString(r);return d&&t.availableImages&&(d.available=t.availableImages.indexOf(r)>-1),d}eachChild(t){t(this.input)}outputDefined(){return!1}}class va{constructor(t){this.type=Be,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);let d=r.parse(t[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Ii(d.type)} instead.`):new va(d):null}evaluate(t){let r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Mi(`Expected value to be of type string or array, but found ${Ii(Ui(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}let Rr=8192;function al(o,t){let r=(180+o[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*Rr),Math.round(d*f*Rr)]}function Fs(o,t){let r=Math.pow(2,t.z);return[(f=(o[0]/Rr+t.x)/r,360*f-180),(d=(o[1]/Rr+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,f}function ba(o,t){o[0]=Math.min(o[0],t[0]),o[1]=Math.min(o[1],t[1]),o[2]=Math.max(o[2],t[0]),o[3]=Math.max(o[3],t[1])}function Ls(o,t){return!(o[0]<=t[0]||o[2]>=t[2]||o[1]<=t[1]||o[3]>=t[3])}function md(o,t,r){let d=o[0]-t[0],f=o[1]-t[1],_=o[0]-r[0],y=o[1]-r[1];return d*y-_*f==0&&d*_<=0&&f*y<=0}function xa(o,t,r,d){return(f=[d[0]-r[0],d[1]-r[1]])[0]*(_=[t[0]-o[0],t[1]-o[1]])[1]-f[1]*_[0]!=0&&!(!_c(o,t,r,d)||!_c(r,d,o,t));var f,_}function fc(o,t,r){for(let d of r)for(let f=0;f<d.length-1;++f)if(xa(o,t,d[f],d[f+1]))return!0;return!1}function Lo(o,t,r=!1){let d=!1;for(let b of t)for(let w=0;w<b.length-1;w++){if(md(o,b[w],b[w+1]))return r;(_=b[w])[1]>(f=o)[1]!=(y=b[w+1])[1]>f[1]&&f[0]<(y[0]-_[0])*(f[1]-_[1])/(y[1]-_[1])+_[0]&&(d=!d)}var f,_,y;return d}function mc(o,t){for(let r of t)if(Lo(o,r))return!0;return!1}function gc(o,t){for(let r of o)if(!Lo(r,t))return!1;for(let r=0;r<o.length-1;++r)if(fc(o[r],o[r+1],t))return!1;return!0}function gd(o,t){for(let r of t)if(gc(o,r))return!0;return!1}function _c(o,t,r,d){let f=d[0]-r[0],_=d[1]-r[1],y=(o[0]-r[0])*_-f*(o[1]-r[1]),b=(t[0]-r[0])*_-f*(t[1]-r[1]);return y>0&&b<0||y<0&&b>0}function Yr(o,t,r){let d=[];for(let f=0;f<o.length;f++){let _=[];for(let y=0;y<o[f].length;y++){let b=al(o[f][y],r);ba(t,b),_.push(b)}d.push(_)}return d}function _d(o,t,r){let d=[];for(let f=0;f<o.length;f++){let _=Yr(o[f],t,r);d.push(_)}return d}function yd(o,t,r,d){if(o[0]<r[0]||o[0]>r[2]){let f=.5*d,_=o[0]-r[0]>f?-d:r[0]-o[0]>f?d:0;_===0&&(_=o[0]-r[2]>f?-d:r[2]-o[0]>f?d:0),o[0]+=_}ba(t,o)}function vd(o,t,r,d){let f=Math.pow(2,d.z)*Rr,_=[d.x*Rr,d.y*Rr],y=[];for(let b of o)for(let w of b){let S=[w.x+_[0],w.y+_[1]];yd(S,t,r,f),y.push(S)}return y}function ll(o,t,r,d){let f=Math.pow(2,d.z)*Rr,_=[d.x*Rr,d.y*Rr],y=[];for(let w of o){let S=[];for(let P of w){let A=[P.x+_[0],P.y+_[1]];ba(t,A),S.push(A)}y.push(S)}if(t[2]-t[0]<=f/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(let w of y)for(let S of w)yd(S,t,r,f)}var b;return y}class uo{constructor(t,r){this.type=Pt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(oi(t[1])){let d=t[1];if(d.type==="FeatureCollection"){let f=[];for(let _ of d.features){let{type:y,coordinates:b}=_.geometry;y==="Polygon"&&f.push(b),y==="MultiPolygon"&&f.push(...b)}if(f.length)return new uo(d,{type:"MultiPolygon",coordinates:f})}else if(d.type==="Feature"){let f=d.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new uo(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new uo(d,d)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,d){let f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(d.type==="Polygon"){let b=Yr(d.coordinates,_,y),w=vd(r.geometry(),f,_,y);if(!Ls(f,_))return!1;for(let S of w)if(!Lo(S,b))return!1}if(d.type==="MultiPolygon"){let b=_d(d.coordinates,_,y),w=vd(r.geometry(),f,_,y);if(!Ls(f,_))return!1;for(let S of w)if(!mc(S,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,d){let f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(d.type==="Polygon"){let b=Yr(d.coordinates,_,y),w=ll(r.geometry(),f,_,y);if(!Ls(f,_))return!1;for(let S of w)if(!gc(S,b))return!1}if(d.type==="MultiPolygon"){let b=_d(d.coordinates,_,y),w=ll(r.geometry(),f,_,y);if(!Ls(f,_))return!1;for(let S of w)if(!gd(S,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let yc=class{constructor(o=[],t=(r,d)=>r<d?-1:r>d?1:0){if(this.data=o,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;let o=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),o}peek(){return this.data[0]}_up(o){let{data:t,compare:r}=this,d=t[o];for(;o>0;){let f=o-1>>1,_=t[f];if(r(d,_)>=0)break;t[o]=_,o=f}t[o]=d}_down(o){let{data:t,compare:r}=this,d=this.length>>1,f=t[o];for(;o<d;){let _=1+(o<<1),y=_+1;if(y<this.length&&r(t[y],t[_])<0&&(_=y),r(t[_],f)>=0)break;t[o]=t[_],o=_}t[o]=f}};function bd(o,t,r=0,d=o.length-1,f=xd){for(;d>r;){if(d-r>600){let w=d-r+1,S=t-r+1,P=Math.log(w),A=.5*Math.exp(2*P/3),O=.5*Math.sqrt(P*A*(w-A)/w)*(S-w/2<0?-1:1);bd(o,t,Math.max(r,Math.floor(t-S*A/w+O)),Math.min(d,Math.floor(t+(w-S)*A/w+O)),f)}let _=o[t],y=r,b=d;for(zs(o,r,t),f(o[d],_)>0&&zs(o,r,d);y<b;){for(zs(o,y,b),y++,b--;f(o[y],_)<0;)y++;for(;f(o[b],_)>0;)b--}f(o[r],_)===0?zs(o,r,b):(b++,zs(o,b,d)),b<=t&&(r=b+1),t<=b&&(d=b-1)}}function zs(o,t,r){let d=o[t];o[t]=o[r],o[r]=d}function xd(o,t){return o<t?-1:o>t?1:0}function wa(o,t){if(o.length<=1)return[o];let r=[],d,f;for(let _ of o){let y=Lu(_);y!==0&&(_.area=Math.abs(y),f===void 0&&(f=y<0),f===y<0?(d&&r.push(d),d=[_]):d.push(_))}if(d&&r.push(d),t>1)for(let _=0;_<r.length;_++)r[_].length<=t||(bd(r[_],t,1,r[_].length-1,wd),r[_]=r[_].slice(0,t));return r}function wd(o,t){return t.area-o.area}function Lu(o){let t=0;for(let r,d,f=0,_=o.length,y=_-1;f<_;y=f++)r=o[f],d=o[y],t+=(d.x-r.x)*(r.y+d.y);return t}let cl=1/298.257223563,Cd=cl*(2-cl),vc=Math.PI/180;class Ca{constructor(t){let r=6378.137*vc*1e3,d=Math.cos(t*vc),f=1/(1-Cd*(1-d*d)),_=Math.sqrt(f);this.kx=r*_*d,this.ky=r*_*f*(1-Cd)}distance(t,r){let d=this.wrap(t[0]-r[0])*this.kx,f=(t[1]-r[1])*this.ky;return Math.sqrt(d*d+f*f)}pointOnLine(t,r){let d,f,_,y,b=1/0;for(let w=0;w<t.length-1;w++){let S=t[w][0],P=t[w][1],A=this.wrap(t[w+1][0]-S)*this.kx,O=(t[w+1][1]-P)*this.ky,z=0;A===0&&O===0||(z=(this.wrap(r[0]-S)*this.kx*A+(r[1]-P)*this.ky*O)/(A*A+O*O),z>1?(S=t[w+1][0],P=t[w+1][1]):z>0&&(S+=A/this.kx*z,P+=O/this.ky*z)),A=this.wrap(r[0]-S)*this.kx,O=(r[1]-P)*this.ky;let B=A*A+O*O;B<b&&(b=B,d=S,f=P,_=w,y=z)}return{point:[d,f],index:_,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Md(o,t){return t[0]-o[0]}function ti(o){return o[1]-o[0]+1}function ho(o,t){return o[1]>=o[0]&&o[1]<t}function bc(o,t){if(o[0]>o[1])return[null,null];let r=ti(o);if(t){if(r===2)return[o,null];let f=Math.floor(r/2);return[[o[0],o[0]+f],[o[0]+f,o[1]]]}if(r===1)return[o,null];let d=Math.floor(r/2)-1;return[[o[0],o[0]+d],[o[0]+d+1,o[1]]]}function Bs(o,t){if(!ho(t,o.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let d=t[0];d<=t[1];++d)ba(r,o[d]);return r}function xc(o){let t=[1/0,1/0,-1/0,-1/0];for(let r of o)for(let d of r)ba(t,d);return t}function Sd(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function wc(o,t,r){if(!Sd(o)||!Sd(t))return NaN;let d=0,f=0;return o[2]<t[0]&&(d=t[0]-o[2]),o[0]>t[2]&&(d=o[0]-t[2]),o[1]>t[3]&&(f=o[1]-t[3]),o[3]<t[1]&&(f=t[1]-o[3]),r.distance([0,0],[d,f])}function as(o,t,r){let d=r.pointOnLine(t,o);return r.distance(o,d.point)}function dl(o,t,r,d,f){let _=Math.min(as(o,[r,d],f),as(t,[r,d],f)),y=Math.min(as(r,[o,t],f),as(d,[o,t],f));return Math.min(_,y)}function zu(o,t,r,d,f){if(!ho(t,o.length)||!ho(d,r.length))return 1/0;let _=1/0;for(let y=t[0];y<t[1];++y){let b=o[y],w=o[y+1];for(let S=d[0];S<d[1];++S){let P=r[S],A=r[S+1];if(xa(b,w,P,A))return 0;_=Math.min(_,dl(b,w,P,A,f))}}return _}function Bu(o,t,r,d,f){if(!ho(t,o.length)||!ho(d,r.length))return NaN;let _=1/0;for(let y=t[0];y<=t[1];++y)for(let b=d[0];b<=d[1];++b)if(_=Math.min(_,f.distance(o[y],r[b])),_===0)return _;return _}function Nu(o,t,r){if(Lo(o,t,!0))return 0;let d=1/0;for(let f of t){let _=f[0],y=f[f.length-1];if(_!==y&&(d=Math.min(d,as(o,[y,_],r)),d===0))return d;let b=r.pointOnLine(f,o);if(d=Math.min(d,r.distance(o,b.point)),d===0)return d}return d}function Vu(o,t,r,d){if(!ho(t,o.length))return NaN;for(let _=t[0];_<=t[1];++_)if(Lo(o[_],r,!0))return 0;let f=1/0;for(let _=t[0];_<t[1];++_){let y=o[_],b=o[_+1];for(let w of r)for(let S=0,P=w.length,A=P-1;S<P;A=S++){let O=w[A],z=w[S];if(xa(y,b,O,z))return 0;f=Math.min(f,dl(y,b,O,z,d))}}return f}function Cc(o,t){for(let r of o)for(let d of r)if(Lo(d,t,!0))return!0;return!1}function Td(o,t,r,d=1/0){let f=xc(o),_=xc(t);if(d!==1/0&&wc(f,_,r)>=d)return d;if(Ls(f,_)){if(Cc(o,t))return 0}else if(Cc(t,o))return 0;let y=1/0;for(let b of o)for(let w=0,S=b.length,P=S-1;w<S;P=w++){let A=b[P],O=b[w];for(let z of t)for(let B=0,U=z.length,W=U-1;B<U;W=B++){let ie=z[W],pe=z[B];if(xa(A,O,ie,pe))return 0;y=Math.min(y,dl(A,O,ie,pe,r))}}return y}function Ed(o,t,r,d,f,_){if(!_)return;let y=wc(Bs(d,_),f,r);y<t&&o.push([y,_,[0,0]])}function ul(o,t,r,d,f,_,y){if(!_||!y)return;let b=wc(Bs(d,_),Bs(f,y),r);b<t&&o.push([b,_,y])}function hl(o,t,r,d,f=1/0){let _=Math.min(d.distance(o[0],r[0][0]),f);if(_===0)return _;let y=new yc([[0,[0,o.length-1],[0,0]]],Md),b=xc(r);for(;y.length>0;){let w=y.pop();if(w[0]>=_)continue;let S=w[1],P=t?50:100;if(ti(S)<=P){if(!ho(S,o.length))return NaN;if(t){let A=Vu(o,S,r,d);if(isNaN(A)||A===0)return A;_=Math.min(_,A)}else for(let A=S[0];A<=S[1];++A){let O=Nu(o[A],r,d);if(_=Math.min(_,O),_===0)return 0}}else{let A=bc(S,t);Ed(y,_,d,o,b,A[0]),Ed(y,_,d,o,b,A[1])}}return _}function Ma(o,t,r,d,f,_=1/0){let y=Math.min(_,f.distance(o[0],r[0]));if(y===0)return y;let b=new yc([[0,[0,o.length-1],[0,r.length-1]]],Md);for(;b.length>0;){let w=b.pop();if(w[0]>=y)continue;let S=w[1],P=w[2],A=t?50:100,O=d?50:100;if(ti(S)<=A&&ti(P)<=O){if(!ho(S,o.length)&&ho(P,r.length))return NaN;let z;if(t&&d)z=zu(o,S,r,P,f),y=Math.min(y,z);else if(t&&!d){let B=o.slice(S[0],S[1]+1);for(let U=P[0];U<=P[1];++U)if(z=as(r[U],B,f),y=Math.min(y,z),y===0)return y}else if(!t&&d){let B=r.slice(P[0],P[1]+1);for(let U=S[0];U<=S[1];++U)if(z=as(o[U],B,f),y=Math.min(y,z),y===0)return y}else z=Bu(o,S,r,P,f),y=Math.min(y,z)}else{let z=bc(S,t),B=bc(P,d);ul(b,y,f,o,r,z[0],B[0]),ul(b,y,f,o,r,z[0],B[1]),ul(b,y,f,o,r,z[1],B[0]),ul(b,y,f,o,r,z[1],B[1])}}return y}function Sa(o){return o.type==="MultiPolygon"?o.coordinates.map(t=>({type:"Polygon",coordinates:t})):o.type==="MultiLineString"?o.coordinates.map(t=>({type:"LineString",coordinates:t})):o.type==="MultiPoint"?o.coordinates.map(t=>({type:"Point",coordinates:t})):[o]}class ls{constructor(t,r){this.type=Be,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(oi(t[1])){let d=t[1];if(d.type==="FeatureCollection")return new ls(d,d.features.map(f=>Sa(f.geometry)).flat());if(d.type==="Feature")return new ls(d,Sa(d.geometry));if("type"in d&&"coordinates"in d)return new ls(d,Sa(d))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,d){let f=r.geometry(),_=f.flat().map(w=>Fs([w.x,w.y],r.canonical));if(f.length===0)return NaN;let y=new Ca(_[0][1]),b=1/0;for(let w of d){switch(w.type){case"Point":b=Math.min(b,Ma(_,!1,[w.coordinates],!1,y,b));break;case"LineString":b=Math.min(b,Ma(_,!1,w.coordinates,!0,y,b));break;case"Polygon":b=Math.min(b,hl(_,!1,w.coordinates,y,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,d){let f=r.geometry(),_=f.flat().map(w=>Fs([w.x,w.y],r.canonical));if(f.length===0)return NaN;let y=new Ca(_[0][1]),b=1/0;for(let w of d){switch(w.type){case"Point":b=Math.min(b,Ma(_,!0,[w.coordinates],!1,y,b));break;case"LineString":b=Math.min(b,Ma(_,!0,w.coordinates,!0,y,b));break;case"Polygon":b=Math.min(b,hl(_,!0,w.coordinates,y,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="Polygon")return function(r,d){let f=r.geometry();if(f.length===0||f[0].length===0)return NaN;let _=wa(f,0).map(w=>w.map(S=>S.map(P=>Fs([P.x,P.y],r.canonical)))),y=new Ca(_[0][0][0][1]),b=1/0;for(let w of d)for(let S of _){switch(w.type){case"Point":b=Math.min(b,hl([w.coordinates],!1,S,y,b));break;case"LineString":b=Math.min(b,hl(w.coordinates,!0,S,y,b));break;case"Polygon":b=Math.min(b,Td(S,w.coordinates,y,b))}if(b===0)return b}return b}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class pl{constructor(t){this.type=At,this.key=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);let d=t[1];return d==null?r.error("Global state property must be defined."):typeof d!="string"?r.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new pl(d)}evaluate(t){var r;let d=(r=t.globals)===null||r===void 0?void 0:r.globalState;return d&&Object.keys(d).length!==0?aa(d,this.key):null}eachChild(){}outputDefined(){return!1}}let Ns={"==":rl,"!=":Ru,">":fd,"<":Rs,">=":Fu,"<=":Ou,array:Dt,at:pc,boolean:Dt,case:pn,coalesce:rs,collator:ol,format:sl,image:Os,in:fa,"index-of":ma,interpolate:Ln,"interpolate-hcl":Ln,"interpolate-lab":Ln,length:va,let:Dr,literal:Mt,match:tr,number:Dt,"number-format":ss,object:Dt,slice:Oo,step:Fo,string:Dt,"to-boolean":Fn,"to-color":Fn,"to-number":Fn,"to-string":Fn,var:pa,within:uo,distance:ls,"global-state":pl};class Or{constructor(t,r,d,f){this.name=t,this.type=r,this._evaluate=d,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){let d=t[0],f=Or.definitions[d];if(!f)return r.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);let _=Array.isArray(f)?f[0]:f.type,y=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,b=y.filter(([S])=>!Array.isArray(S)||S.length===t.length-1),w=null;for(let[S,P]of b){w=new ha(r.registry,Ta,r.path,null,r.scope);let A=[],O=!1;for(let z=1;z<t.length;z++){let B=t[z],U=Array.isArray(S)?S[z-1]:S.type,W=w.parse(B,1+A.length,U);if(!W){O=!0;break}A.push(W)}if(!O)if(Array.isArray(S)&&S.length!==A.length)w.error(`Expected ${S.length} arguments, but found ${A.length} instead.`);else{for(let z=0;z<A.length;z++){let B=Array.isArray(S)?S[z]:S.type,U=A[z];w.concat(z+1).checkSubtype(B,U.type)}if(w.errors.length===0)return new Or(d,_,P,A)}}if(b.length===1)r.errors.push(...w.errors);else{let S=(b.length?b:y).map(([A])=>{return O=A,Array.isArray(O)?`(${O.map(Ii).join(", ")})`:`(${Ii(O.type)}...)`;var O}).join(" | "),P=[];for(let A=1;A<t.length;A++){let O=r.parse(t[A],1+P.length);if(!O)return null;P.push(Ii(O.type))}r.error(`Expected arguments of type ${S}, but found (${P.join(", ")}) instead.`)}return null}static register(t,r){Or.definitions=r;for(let d in r)t[d]=Or}}function ju(o,[t,r,d,f]){t=t.evaluate(o),r=r.evaluate(o),d=d.evaluate(o);let _=f?f.evaluate(o):1,y=ua(t,r,d,_);if(y)throw new Mi(y);return new Vt(t/255,r/255,d/255,_,!1)}function Uu(o,t){return o in t}function Mc(o,t){let r=t[o];return r===void 0?null:r}function cs(o){return{type:o}}function Ta(o){if(o instanceof pa)return Ta(o.boundExpression);if(o instanceof Or&&o.name==="error"||o instanceof ol||o instanceof uo||o instanceof ls||o instanceof pl)return!1;let t=o instanceof Fn||o instanceof Dt,r=!0;return o.eachChild(d=>{r=t?r&&Ta(d):r&&d instanceof Mt}),!!r&&fl(o)&&ml(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function fl(o){if(o instanceof Or&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof uo||o instanceof ls)return!1;let t=!0;return o.eachChild(r=>{t&&!fl(r)&&(t=!1)}),t}function Ea(o){if(o instanceof Or&&o.name==="feature-state")return!1;let t=!0;return o.eachChild(r=>{t&&!Ea(r)&&(t=!1)}),t}function ml(o,t){if(o instanceof Or&&t.indexOf(o.name)>=0)return!1;let r=!0;return o.eachChild(d=>{r&&!ml(d,t)&&(r=!1)}),r}function gl(o){return{result:"success",value:o}}function Vs(o){return{result:"error",value:o}}function js(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Id(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function _l(o){return!!o.expression&&o.expression.interpolated}function Nt(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Kr(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&Ui(o)===Jn}function Ia(o){return o}function Sc(o,t){let r=o.stops&&typeof o.stops[0][0]=="object",d=r||!(r||o.property!==void 0),f=o.type||(_l(t)?"exponential":"interval"),_=function(P){switch(P.type){case"color":return Vt.parse;case"padding":return Sn.parse;case"numberArray":return ji.parse;case"colorArray":return hn.parse;default:return null}}(t);if(_&&((o=ni({},o)).stops&&(o.stops=o.stops.map(P=>[P[0],_(P[1])])),o.default=_(o.default?o.default:t.default)),o.colorSpace&&(y=o.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var y;let b=function(P){switch(P){case"exponential":return Pd;case"interval":return Gu;case"categorical":return $u;case"identity":return kd;default:throw new Error(`Unknown function type "${P}"`)}}(f),w,S;if(f==="categorical"){w=Object.create(null);for(let P of o.stops)w[P[0]]=P[1];S=typeof o.stops[0][0]}if(r){let P={},A=[];for(let B=0;B<o.stops.length;B++){let U=o.stops[B],W=U[0].zoom;P[W]===void 0&&(P[W]={zoom:W,type:o.type,property:o.property,default:o.default,stops:[]},A.push(W)),P[W].stops.push([U[0].value,U[1]])}let O=[];for(let B of A)O.push([P[B].zoom,Sc(P[B],t)]);let z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:Ln.interpolationFactor.bind(void 0,z),zoomStops:O.map(B=>B[0]),evaluate:({zoom:B},U)=>Pd({stops:O,base:o.base},t,B).evaluate(B,U)}}if(d){let P=f==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:Ln.interpolationFactor.bind(void 0,P),zoomStops:o.stops.map(A=>A[0]),evaluate:({zoom:A})=>b(o,t,A,w,S)}}return{kind:"source",evaluate(P,A){let O=A&&A.properties?A.properties[o.property]:void 0;return O===void 0?zo(o.default,t.default):b(o,t,O,w,S)}}}function zo(o,t,r){return o!==void 0?o:t!==void 0?t:r!==void 0?r:void 0}function $u(o,t,r,d,f){return zo(typeof r===f?d[r]:void 0,o.default,t.default)}function Gu(o,t,r){if(Nt(r)!=="number")return zo(o.default,t.default);let d=o.stops.length;if(d===1||r<=o.stops[0][0])return o.stops[0][1];if(r>=o.stops[d-1][0])return o.stops[d-1][1];let f=co(o.stops.map(_=>_[0]),r);return o.stops[f][1]}function Pd(o,t,r){let d=o.base!==void 0?o.base:1;if(Nt(r)!=="number")return zo(o.default,t.default);let f=o.stops.length;if(f===1||r<=o.stops[0][0])return o.stops[0][1];if(r>=o.stops[f-1][0])return o.stops[f-1][1];let _=co(o.stops.map(P=>P[0]),r),y=function(P,A,O,z){let B=z-O,U=P-O;return B===0?0:A===1?U/B:(Math.pow(A,U)-1)/(Math.pow(A,B)-1)}(r,d,o.stops[_][0],o.stops[_+1][0]),b=o.stops[_][1],w=o.stops[_+1][1],S=Xr[t.type]||Ia;return typeof b.evaluate=="function"?{evaluate(...P){let A=b.evaluate.apply(void 0,P),O=w.evaluate.apply(void 0,P);if(A!==void 0&&O!==void 0)return S(A,O,y,o.colorSpace)}}:S(b,w,y,o.colorSpace)}function kd(o,t,r){switch(t.type){case"color":r=Vt.parse(r);break;case"formatted":r=Hn.fromString(r.toString());break;case"resolvedImage":r=ur.fromString(r.toString());break;case"padding":r=Sn.parse(r);break;case"colorArray":r=hn.parse(r);break;case"numberArray":r=ji.parse(r);break;default:Nt(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return zo(r,o.default,t.default)}Or.register(Ns,{error:[{kind:"error"},[mt],(o,[t])=>{throw new Mi(t.evaluate(o))}],typeof:[mt,[At],(o,[t])=>Ii(Ui(t.evaluate(o)))],"to-rgba":[ai(Be,4),[St],(o,[t])=>{let[r,d,f,_]=t.evaluate(o).rgb;return[255*r,255*d,255*f,_]}],rgb:[St,[Be,Be,Be],ju],rgba:[St,[Be,Be,Be,Be],ju],has:{type:Pt,overloads:[[[mt],(o,[t])=>Uu(t.evaluate(o),o.properties())],[[mt,Jn],(o,[t,r])=>Uu(t.evaluate(o),r.evaluate(o))]]},get:{type:At,overloads:[[[mt],(o,[t])=>Mc(t.evaluate(o),o.properties())],[[mt,Jn],(o,[t,r])=>Mc(t.evaluate(o),r.evaluate(o))]]},"feature-state":[At,[mt],(o,[t])=>Mc(t.evaluate(o),o.featureState||{})],properties:[Jn,[],o=>o.properties()],"geometry-type":[mt,[],o=>o.geometryType()],id:[At,[],o=>o.id()],zoom:[Be,[],o=>o.globals.zoom],"heatmap-density":[Be,[],o=>o.globals.heatmapDensity||0],"line-progress":[Be,[],o=>o.globals.lineProgress||0],accumulated:[At,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Be,cs(Be),(o,t)=>{let r=0;for(let d of t)r+=d.evaluate(o);return r}],"*":[Be,cs(Be),(o,t)=>{let r=1;for(let d of t)r*=d.evaluate(o);return r}],"-":{type:Be,overloads:[[[Be,Be],(o,[t,r])=>t.evaluate(o)-r.evaluate(o)],[[Be],(o,[t])=>-t.evaluate(o)]]},"/":[Be,[Be,Be],(o,[t,r])=>t.evaluate(o)/r.evaluate(o)],"%":[Be,[Be,Be],(o,[t,r])=>t.evaluate(o)%r.evaluate(o)],ln2:[Be,[],()=>Math.LN2],pi:[Be,[],()=>Math.PI],e:[Be,[],()=>Math.E],"^":[Be,[Be,Be],(o,[t,r])=>Math.pow(t.evaluate(o),r.evaluate(o))],sqrt:[Be,[Be],(o,[t])=>Math.sqrt(t.evaluate(o))],log10:[Be,[Be],(o,[t])=>Math.log(t.evaluate(o))/Math.LN10],ln:[Be,[Be],(o,[t])=>Math.log(t.evaluate(o))],log2:[Be,[Be],(o,[t])=>Math.log(t.evaluate(o))/Math.LN2],sin:[Be,[Be],(o,[t])=>Math.sin(t.evaluate(o))],cos:[Be,[Be],(o,[t])=>Math.cos(t.evaluate(o))],tan:[Be,[Be],(o,[t])=>Math.tan(t.evaluate(o))],asin:[Be,[Be],(o,[t])=>Math.asin(t.evaluate(o))],acos:[Be,[Be],(o,[t])=>Math.acos(t.evaluate(o))],atan:[Be,[Be],(o,[t])=>Math.atan(t.evaluate(o))],min:[Be,cs(Be),(o,t)=>Math.min(...t.map(r=>r.evaluate(o)))],max:[Be,cs(Be),(o,t)=>Math.max(...t.map(r=>r.evaluate(o)))],abs:[Be,[Be],(o,[t])=>Math.abs(t.evaluate(o))],round:[Be,[Be],(o,[t])=>{let r=t.evaluate(o);return r<0?-Math.round(-r):Math.round(r)}],floor:[Be,[Be],(o,[t])=>Math.floor(t.evaluate(o))],ceil:[Be,[Be],(o,[t])=>Math.ceil(t.evaluate(o))],"filter-==":[Pt,[mt,At],(o,[t,r])=>o.properties()[t.value]===r.value],"filter-id-==":[Pt,[At],(o,[t])=>o.id()===t.value],"filter-type-==":[Pt,[mt],(o,[t])=>o.geometryType()===t.value],"filter-<":[Pt,[mt,At],(o,[t,r])=>{let d=o.properties()[t.value],f=r.value;return typeof d==typeof f&&d<f}],"filter-id-<":[Pt,[At],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r<d}],"filter->":[Pt,[mt,At],(o,[t,r])=>{let d=o.properties()[t.value],f=r.value;return typeof d==typeof f&&d>f}],"filter-id->":[Pt,[At],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r>d}],"filter-<=":[Pt,[mt,At],(o,[t,r])=>{let d=o.properties()[t.value],f=r.value;return typeof d==typeof f&&d<=f}],"filter-id-<=":[Pt,[At],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r<=d}],"filter->=":[Pt,[mt,At],(o,[t,r])=>{let d=o.properties()[t.value],f=r.value;return typeof d==typeof f&&d>=f}],"filter-id->=":[Pt,[At],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r>=d}],"filter-has":[Pt,[At],(o,[t])=>t.value in o.properties()],"filter-has-id":[Pt,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Pt,[ai(mt)],(o,[t])=>t.value.indexOf(o.geometryType())>=0],"filter-id-in":[Pt,[ai(At)],(o,[t])=>t.value.indexOf(o.id())>=0],"filter-in-small":[Pt,[mt,ai(At)],(o,[t,r])=>r.value.indexOf(o.properties()[t.value])>=0],"filter-in-large":[Pt,[mt,ai(At)],(o,[t,r])=>function(d,f,_,y){for(;_<=y;){let b=_+y>>1;if(f[b]===d)return!0;f[b]>d?y=b-1:_=b+1}return!1}(o.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Pt,overloads:[[[Pt,Pt],(o,[t,r])=>t.evaluate(o)&&r.evaluate(o)],[cs(Pt),(o,t)=>{for(let r of t)if(!r.evaluate(o))return!1;return!0}]]},any:{type:Pt,overloads:[[[Pt,Pt],(o,[t,r])=>t.evaluate(o)||r.evaluate(o)],[cs(Pt),(o,t)=>{for(let r of t)if(r.evaluate(o))return!0;return!1}]]},"!":[Pt,[Pt],(o,[t])=>!t.evaluate(o)],"is-supported-script":[Pt,[mt],(o,[t])=>{let r=o.globals&&o.globals.isSupportedScript;return!r||r(t.evaluate(o))}],upcase:[mt,[mt],(o,[t])=>t.evaluate(o).toUpperCase()],downcase:[mt,[mt],(o,[t])=>t.evaluate(o).toLowerCase()],concat:[mt,cs(At),(o,t)=>t.map(r=>jt(r.evaluate(o))).join("")],"resolved-locale":[mt,[Es],(o,[t])=>t.evaluate(o).resolvedLocale()]});class yl{constructor(t,r){this.expression=t,this._warningHistory={},this._evaluator=new hc,this._defaultValue=r?function(d){if(d.type==="color"&&Kr(d.default))return new Vt(0,0,0,0);switch(d.type){case"color":return Vt.parse(d.default)||null;case"padding":return Sn.parse(d.default)||null;case"numberArray":return ji.parse(d.default)||null;case"colorArray":return hn.parse(d.default)||null;case"variableAnchorOffsetCollection":return Zn.parse(d.default)||null;case"projectionDefinition":return er.parse(d.default)||null;default:return d.default===void 0?null:d.default}}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,d,f,_,y){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=d,this._evaluator.canonical=f,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,r,d,f,_,y){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=d||null,this._evaluator.canonical=f,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y||null;try{let b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Mi(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Pa(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Ns}function vl(o,t){let r=new ha(Ns,Ta,[],t?function(f){let _={color:St,string:mt,number:Be,enum:mt,boolean:Pt,formatted:ra,padding:Qo,numberArray:dr,colorArray:Jo,projectionDefinition:Vi,resolvedImage:Do,variableAnchorOffsetCollection:Di};return f.type==="array"?ai(_[f.value]||At,f.length):_[f.type]}(t):void 0),d=r.parse(o,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?gl(new yl(d,t)):Vs(r.errors)}class Cr{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Ea(r.expression)}evaluateWithoutErrorHandling(t,r,d,f,_,y){return this._styleExpression.evaluateWithoutErrorHandling(t,r,d,f,_,y)}evaluate(t,r,d,f,_,y){return this._styleExpression.evaluate(t,r,d,f,_,y)}}class ds{constructor(t,r,d,f){this.kind=t,this.zoomStops=d,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Ea(r.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,r,d,f,_,y){return this._styleExpression.evaluateWithoutErrorHandling(t,r,d,f,_,y)}evaluate(t,r,d,f,_,y){return this._styleExpression.evaluate(t,r,d,f,_,y)}interpolationFactor(t,r,d){return this.interpolationType?Ln.interpolationFactor(this.interpolationType,t,r,d):0}}function $i(o,t){let r=vl(o,t);if(r.result==="error")return r;let d=r.value.expression,f=fl(d);if(!f&&!js(t))return Vs([new Bt("","data expressions not supported")]);let _=ml(d,["zoom"]);if(!_&&!Id(t))return Vs([new Bt("","zoom expressions not supported")]);let y=Aa(d);return y||_?y instanceof Bt?Vs([y]):y instanceof Ln&&!_l(t)?Vs([new Bt("",'"interpolate" expressions cannot be used with this property')]):gl(y?new ds(f?"camera":"composite",r.value,y.labels,y instanceof Ln?y.interpolation:void 0):new Cr(f?"constant":"source",r.value)):Vs([new Bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ka{constructor(t,r){this._parameters=t,this._specification=r,ni(this,Sc(this._parameters,this._specification))}static deserialize(t){return new ka(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Aa(o){let t=null;if(o instanceof Dr)t=Aa(o.result);else if(o instanceof rs){for(let r of o.args)if(t=Aa(r),t)break}else(o instanceof Fo||o instanceof Ln)&&o.input instanceof Or&&o.input.name==="zoom"&&(t=o);return t instanceof Bt||o.eachChild(r=>{let d=Aa(r);d instanceof Bt?t=d:!t&&d?t=new Bt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&d&&t!==d&&(t=new Bt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Da(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(let t of o.slice(1))if(!Da(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}let Tc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ra(o){if(o==null)return{filter:()=>!0,needGeometry:!1};Da(o)||(o=xl(o));let t=vl(o,Tc);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,d,f)=>t.value.evaluate(r,d,{},f),needGeometry:Ad(o)}}function bl(o,t){return o<t?-1:o>t?1:0}function Ad(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let t=1;t<o.length;t++)if(Ad(o[t]))return!0;return!1}function xl(o){if(!o)return!0;let t=o[0];return o.length<=1?t!=="any":t==="=="?Us(o[1],o[2],"=="):t==="!="?F(Us(o[1],o[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Us(o[1],o[2],t):t==="any"?(r=o.slice(1),["any"].concat(r.map(xl))):t==="all"?["all"].concat(o.slice(1).map(xl)):t==="none"?["all"].concat(o.slice(1).map(xl).map(F)):t==="in"?M(o[1],o.slice(2)):t==="!in"?F(M(o[1],o.slice(2))):t==="has"?E(o[1]):t!=="!has"||F(E(o[1]));var r}function Us(o,t,r){switch(o){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,o,t]}}function M(o,t){if(t.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",o,["literal",t.sort(bl)]]:["filter-in-small",o,["literal",t]]}}function E(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function F(o){return["!",o]}function ne(o){let t=typeof o;if(t==="number"||t==="boolean"||t==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let f="[";for(let _ of o)f+=`${ne(_)},`;return`${f}]`}let r=Object.keys(o).sort(),d="{";for(let f=0;f<r.length;f++)d+=`${JSON.stringify(r[f])}:${ne(o[r[f]])},`;return`${d}}`}function Oe(o){let t="";for(let r of Me)t+=`/${ne(o[r])}`;return t}function et(o){let t=o.value;return t?[new De(o.key,t,"constants have been deprecated as of v8")]:[]}function yt(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function Jt(o){if(Array.isArray(o))return o.map(Jt);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){let t={};for(let r in o)t[r]=Jt(o[r]);return t}return yt(o)}function ii(o){let t=o.key,r=o.value,d=o.valueSpec||{},f=o.objectElementValidators||{},_=o.style,y=o.styleSpec,b=o.validateSpec,w=[],S=Nt(r);if(S!=="object")return[new De(t,r,`object expected, ${S} found`)];for(let P in r){let A=P.split(".")[0],O=aa(d,A)||d["*"],z;if(aa(f,A))z=f[A];else if(aa(d,A))z=b;else if(f["*"])z=f["*"];else{if(!d["*"]){w.push(new De(t,r[P],`unknown property "${P}"`));continue}z=b}w=w.concat(z({key:(t&&`${t}.`)+P,value:r[P],valueSpec:O,style:_,styleSpec:y,object:r,objectKey:P,validateSpec:b},r))}for(let P in d)f[P]||d[P].required&&d[P].default===void 0&&r[P]===void 0&&w.push(new De(t,r,`missing required property "${P}"`));return w}function Bo(o){let t=o.value,r=o.valueSpec,d=o.style,f=o.styleSpec,_=o.key,y=o.arrayElementValidator||o.validateSpec;if(Nt(t)!=="array")return[new De(_,t,`array expected, ${Nt(t)} found`)];if(r.length&&t.length!==r.length)return[new De(_,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new De(_,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let b={type:r.value,values:r.values};f.$version<7&&(b.function=r.function),Nt(r.value)==="object"&&(b=r.value);let w=[];for(let S=0;S<t.length;S++)w=w.concat(y({array:t,arrayIndex:S,value:t[S],valueSpec:b,validateSpec:o.validateSpec,style:d,styleSpec:f,key:`${_}[${S}]`}));return w}function us(o){let t=o.key,r=o.value,d=o.valueSpec,f=Nt(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new De(t,r,`number expected, ${f} found`)]:"minimum"in d&&r<d.minimum?[new De(t,r,`${r} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&r>d.maximum?[new De(t,r,`${r} is greater than the maximum value ${d.maximum}`)]:[]}function Hu(o){let t=o.valueSpec,r=yt(o.value.type),d,f,_,y={},b=r!=="categorical"&&o.value.property===void 0,w=!b,S=Nt(o.value.stops)==="array"&&Nt(o.value.stops[0])==="array"&&Nt(o.value.stops[0][0])==="object",P=ii({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(z){if(r==="identity")return[new De(z.key,z.value,'identity function may not have a "stops" property')];let B=[],U=z.value;return B=B.concat(Bo({key:z.key,value:U,valueSpec:z.valueSpec,validateSpec:z.validateSpec,style:z.style,styleSpec:z.styleSpec,arrayElementValidator:A})),Nt(U)==="array"&&U.length===0&&B.push(new De(z.key,U,"array must have at least one stop")),B},default:function(z){return z.validateSpec({key:z.key,value:z.value,valueSpec:t,validateSpec:z.validateSpec,style:z.style,styleSpec:z.styleSpec})}}});return r==="identity"&&b&&P.push(new De(o.key,o.value,'missing required property "property"')),r==="identity"||o.value.stops||P.push(new De(o.key,o.value,'missing required property "stops"')),r==="exponential"&&o.valueSpec.expression&&!_l(o.valueSpec)&&P.push(new De(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(w&&!js(o.valueSpec)?P.push(new De(o.key,o.value,"property functions not supported")):b&&!Id(o.valueSpec)&&P.push(new De(o.key,o.value,"zoom functions not supported"))),r!=="categorical"&&!S||o.value.property!==void 0||P.push(new De(o.key,o.value,'"property" property is required')),P;function A(z){let B=[],U=z.value,W=z.key;if(Nt(U)!=="array")return[new De(W,U,`array expected, ${Nt(U)} found`)];if(U.length!==2)return[new De(W,U,`array length 2 expected, length ${U.length} found`)];if(S){if(Nt(U[0])!=="object")return[new De(W,U,`object expected, ${Nt(U[0])} found`)];if(U[0].zoom===void 0)return[new De(W,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new De(W,U,"object stop key must have value")];if(_&&_>yt(U[0].zoom))return[new De(W,U[0].zoom,"stop zoom values must appear in ascending order")];yt(U[0].zoom)!==_&&(_=yt(U[0].zoom),f=void 0,y={}),B=B.concat(ii({key:`${W}[0]`,value:U[0],valueSpec:{zoom:{}},validateSpec:z.validateSpec,style:z.style,styleSpec:z.styleSpec,objectElementValidators:{zoom:us,value:O}}))}else B=B.concat(O({key:`${W}[0]`,value:U[0],validateSpec:z.validateSpec,style:z.style,styleSpec:z.styleSpec},U));return Pa(Jt(U[1]))?B.concat([new De(`${W}[1]`,U[1],"expressions are not allowed in function stops.")]):B.concat(z.validateSpec({key:`${W}[1]`,value:U[1],valueSpec:t,validateSpec:z.validateSpec,style:z.style,styleSpec:z.styleSpec}))}function O(z,B){let U=Nt(z.value),W=yt(z.value),ie=z.value!==null?z.value:B;if(d){if(U!==d)return[new De(z.key,ie,`${U} stop domain type must match previous stop domain type ${d}`)]}else d=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new De(z.key,ie,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&r!=="categorical"){let pe=`number expected, ${U} found`;return js(t)&&r===void 0&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new De(z.key,ie,pe)]}return r!=="categorical"||U!=="number"||isFinite(W)&&Math.floor(W)===W?r!=="categorical"&&U==="number"&&f!==void 0&&W<f?[new De(z.key,ie,"stop domain values must appear in ascending order")]:(f=W,r==="categorical"&&W in y?[new De(z.key,ie,"stop domain values must be unique")]:(y[W]=!0,[])):[new De(z.key,ie,`integer expected, found ${W}`)]}}function No(o){let t=(o.expressionContext==="property"?$i:vl)(Jt(o.value),o.valueSpec);if(t.result==="error")return t.value.map(d=>new De(`${o.key}${d.key}`,o.value,d.message));let r=t.value.expression||t.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!r.outputDefined())return[new De(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!Ea(r))return[new De(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!Ea(r))return[new De(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!ml(r,["zoom","feature-state"]))return[new De(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!fl(r))return[new De(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zu(o){let t=o.key,r=o.value,d=Nt(r);return d!=="string"?[new De(t,r,`color expected, ${d} found`)]:Vt.parse(String(r))?[]:[new De(t,r,`color expected, "${r}" found`)]}function Ec(o){let t=o.key,r=o.value,d=o.valueSpec,f=[];return Array.isArray(d.values)?d.values.indexOf(yt(r))===-1&&f.push(new De(t,r,`expected one of [${d.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(d.values).indexOf(yt(r))===-1&&f.push(new De(t,r,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(r)} found`)),f}function qu(o){return Da(Jt(o.value))?No(ni({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):jp(o)}function jp(o){let t=o.value,r=o.key;if(Nt(t)!=="array")return[new De(r,t,`array expected, ${Nt(t)} found`)];let d=o.styleSpec,f,_=[];if(t.length<1)return[new De(r,t,"filter array must have at least 1 element")];switch(_=_.concat(Ec({key:`${r}[0]`,value:t[0],valueSpec:d.filter_operator,style:o.style,styleSpec:o.styleSpec})),yt(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&yt(t[1])==="$type"&&_.push(new De(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&_.push(new De(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=Nt(t[1]),f!=="string"&&_.push(new De(`${r}[1]`,t[1],`string expected, ${f} found`)));for(let y=2;y<t.length;y++)f=Nt(t[y]),yt(t[1])==="$type"?_=_.concat(Ec({key:`${r}[${y}]`,value:t[y],valueSpec:d.geometry_type,style:o.style,styleSpec:o.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&_.push(new De(`${r}[${y}]`,t[y],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)_=_.concat(jp({key:`${r}[${y}]`,value:t[y],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":f=Nt(t[1]),t.length!==2?_.push(new De(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&_.push(new De(`${r}[1]`,t[1],`string expected, ${f} found`))}return _}function Up(o,t){let r=o.key,d=o.validateSpec,f=o.style,_=o.styleSpec,y=o.value,b=o.objectKey,w=_[`${t}_${o.layerType}`];if(!w)return[];let S=b.match(/^(.*)-transition$/);if(t==="paint"&&S&&w[S[1]]&&w[S[1]].transition)return d({key:r,value:y,valueSpec:_.transition,style:f,styleSpec:_});let P=o.valueSpec||w[b];if(!P)return[new De(r,y,`unknown property "${b}"`)];let A;if(Nt(y)==="string"&&js(P)&&!P.tokens&&(A=/^{([^}]+)}$/.exec(y)))return[new De(r,y,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];let O=[];return o.layerType==="symbol"&&(b==="text-field"&&f&&!f.glyphs&&O.push(new De(r,y,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&Kr(Jt(y))&&yt(y.type)==="identity"&&O.push(new De(r,y,'"text-font" does not support identity functions'))),O.concat(d({key:o.key,value:y,valueSpec:P,style:f,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:b}))}function $p(o){return Up(o,"paint")}function wl(o){return Up(o,"layout")}function Cl(o){let t=[],r=o.value,d=o.key,f=o.style,_=o.styleSpec;if(Nt(r)!=="object")return[new De(d,r,`object expected, ${Nt(r)} found`)];r.type||r.ref||t.push(new De(d,r,'either "type" or "ref" is required'));let y=yt(r.type),b=yt(r.ref);if(r.id){let w=yt(r.id);for(let S=0;S<o.arrayIndex;S++){let P=f.layers[S];yt(P.id)===w&&t.push(new De(d,r.id,`duplicate layer id "${r.id}", previously used at line ${P.id.__line__}`))}}if("ref"in r){let w;["type","source","source-layer","filter","layout"].forEach(S=>{S in r&&t.push(new De(d,r[S],`"${S}" is prohibited for ref layers`))}),f.layers.forEach(S=>{yt(S.id)===b&&(w=S)}),w?w.ref?t.push(new De(d,r.ref,"ref cannot reference another ref layer")):y=yt(w.type):t.push(new De(d,r.ref,`ref layer "${b}" not found`))}else if(y!=="background")if(r.source){let w=f.sources&&f.sources[r.source],S=w&&yt(w.type);w?S==="vector"&&y==="raster"?t.push(new De(d,r.source,`layer "${r.id}" requires a raster source`)):S!=="raster-dem"&&y==="hillshade"?t.push(new De(d,r.source,`layer "${r.id}" requires a raster-dem source`)):S==="raster"&&y!=="raster"?t.push(new De(d,r.source,`layer "${r.id}" requires a vector source`)):S!=="vector"||r["source-layer"]?S==="raster-dem"&&y!=="hillshade"?t.push(new De(d,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]||S==="geojson"&&w.lineMetrics||t.push(new De(d,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new De(d,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new De(d,r.source,`source "${r.source}" not found`))}else t.push(new De(d,r,'missing required property "source"'));return t=t.concat(ii({key:d,value:r,valueSpec:_.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${d}.type`,value:r.type,valueSpec:_.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:r,objectKey:"type"}),filter:qu,layout:w=>ii({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":S=>wl(ni({layerType:y},S))}}),paint:w=>ii({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":S=>$p(ni({layerType:y},S))}})}})),t}function Tn(o){let t=o.value,r=o.key,d=Nt(t);return d!=="string"?[new De(r,t,`string expected, ${d} found`)]:[]}let Ml={promoteId:function({key:o,value:t}){if(Nt(t)==="string")return Tn({key:o,value:t});{let r=[];for(let d in t)r.push(...Tn({key:`${o}.${d}`,value:t[d]}));return r}}};function Wu(o){let t=o.value,r=o.key,d=o.styleSpec,f=o.style,_=o.validateSpec;if(!t.type)return[new De(r,t,'"type" is required')];let y=yt(t.type),b;switch(y){case"vector":case"raster":return b=ii({key:r,value:t,valueSpec:d[`source_${y.replace("-","_")}`],style:o.style,styleSpec:d,objectElementValidators:Ml,validateSpec:_}),b;case"raster-dem":return b=function(w){var S;let P=(S=w.sourceName)!==null&&S!==void 0?S:"",A=w.value,O=w.styleSpec,z=O.source_raster_dem,B=w.style,U=[],W=Nt(A);if(A===void 0)return U;if(W!=="object")return U.push(new De("source_raster_dem",A,`object expected, ${W} found`)),U;let ie=yt(A.encoding)==="custom",pe=["redFactor","greenFactor","blueFactor","baseShift"],oe=w.value.encoding?`"${w.value.encoding}"`:"Default";for(let L in A)!ie&&pe.includes(L)?U.push(new De(L,A[L],`In "${P}": "${L}" is only valid when "encoding" is set to "custom". ${oe} encoding found`)):z[L]?U=U.concat(w.validateSpec({key:L,value:A[L],valueSpec:z[L],validateSpec:w.validateSpec,style:B,styleSpec:O})):U.push(new De(L,A[L],`unknown property "${L}"`));return U}({sourceName:r,value:t,style:o.style,styleSpec:d,validateSpec:_}),b;case"geojson":if(b=ii({key:r,value:t,valueSpec:d.source_geojson,style:f,styleSpec:d,validateSpec:_,objectElementValidators:Ml}),t.cluster)for(let w in t.clusterProperties){let[S,P]=t.clusterProperties[w],A=typeof S=="string"?[S,["accumulated"],["get",w]]:S;b.push(...No({key:`${r}.${w}.map`,value:P,expressionContext:"cluster-map"})),b.push(...No({key:`${r}.${w}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return b;case"video":return ii({key:r,value:t,valueSpec:d.source_video,style:f,validateSpec:_,styleSpec:d});case"image":return ii({key:r,value:t,valueSpec:d.source_image,style:f,validateSpec:_,styleSpec:d});case"canvas":return[new De(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ec({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Gp(o){let t=o.value,r=o.styleSpec,d=r.light,f=o.style,_=[],y=Nt(t);if(t===void 0)return _;if(y!=="object")return _=_.concat([new De("light",t,`object expected, ${y} found`)]),_;for(let b in t){let w=b.match(/^(.*)-transition$/);_=_.concat(w&&d[w[1]]&&d[w[1]].transition?o.validateSpec({key:b,value:t[b],valueSpec:r.transition,validateSpec:o.validateSpec,style:f,styleSpec:r}):d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],validateSpec:o.validateSpec,style:f,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)])}return _}function Hp(o){let t=o.value,r=o.styleSpec,d=r.sky,f=o.style,_=Nt(t);if(t===void 0)return[];if(_!=="object")return[new De("sky",t,`object expected, ${_} found`)];let y=[];for(let b in t)y=y.concat(d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],style:f,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)]);return y}function Sl(o){let t=o.value,r=o.styleSpec,d=r.terrain,f=o.style,_=[],y=Nt(t);if(t===void 0)return _;if(y!=="object")return _=_.concat([new De("terrain",t,`object expected, ${y} found`)]),_;for(let b in t)_=_.concat(d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],validateSpec:o.validateSpec,style:f,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)]);return _}function Xu(o){let t=[],r=o.value,d=o.key;if(Array.isArray(r)){let f=[],_=[];for(let y in r)r[y].id&&f.includes(r[y].id)&&t.push(new De(d,r,`all the sprites' ids must be unique, but ${r[y].id} is duplicated`)),f.push(r[y].id),r[y].url&&_.includes(r[y].url)&&t.push(new De(d,r,`all the sprites' URLs must be unique, but ${r[y].url} is duplicated`)),_.push(r[y].url),t=t.concat(ii({key:`${d}[${y}]`,value:r[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return t}return Tn({key:d,value:r})}function Dd(o){return t=o.value,t&&t.constructor===Object?[]:[new De(o.key,o.value,`object expected, ${Nt(o.value)} found`)];var t}let Zp={"*":()=>[],array:Bo,boolean:function(o){let t=o.value,r=o.key,d=Nt(t);return d!=="boolean"?[new De(r,t,`boolean expected, ${d} found`)]:[]},number:us,color:Zu,constants:et,enum:Ec,filter:qu,function:Hu,layer:Cl,object:ii,source:Wu,light:Gp,sky:Hp,terrain:Sl,projection:function(o){let t=o.value,r=o.styleSpec,d=r.projection,f=o.style,_=Nt(t);if(t===void 0)return[];if(_!=="object")return[new De("projection",t,`object expected, ${_} found`)];let y=[];for(let b in t)y=y.concat(d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],style:f,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)]);return y},projectionDefinition:function(o){let t=o.key,r=o.value;r=r instanceof String?r.valueOf():r;let d=Nt(r);return d!=="array"||function(f){return Array.isArray(f)&&f.length===3&&typeof f[0]=="string"&&typeof f[1]=="string"&&typeof f[2]=="number"}(r)||function(f){return!!["interpolate","step","literal"].includes(f[0])}(r)?["array","string"].includes(d)?[]:[new De(t,r,`projection expected, invalid type "${d}" found`)]:[new De(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Tn,formatted:function(o){return Tn(o).length===0?[]:No(o)},resolvedImage:function(o){return Tn(o).length===0?[]:No(o)},padding:function(o){let t=o.key,r=o.value;if(Nt(r)==="array"){if(r.length<1||r.length>4)return[new De(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];let d={type:"number"},f=[];for(let _=0;_<r.length;_++)f=f.concat(o.validateSpec({key:`${t}[${_}]`,value:r[_],validateSpec:o.validateSpec,valueSpec:d}));return f}return us({key:t,value:r,valueSpec:{}})},numberArray:function(o){let t=o.key,r=o.value;if(Nt(r)==="array"){let d={type:"number"};if(r.length<1)return[new De(t,r,"array length at least 1 expected, length 0 found")];let f=[];for(let _=0;_<r.length;_++)f=f.concat(o.validateSpec({key:`${t}[${_}]`,value:r[_],validateSpec:o.validateSpec,valueSpec:d}));return f}return us({key:t,value:r,valueSpec:{}})},colorArray:function(o){let t=o.key,r=o.value;if(Nt(r)==="array"){if(r.length<1)return[new De(t,r,"array length at least 1 expected, length 0 found")];let d=[];for(let f=0;f<r.length;f++)d=d.concat(Zu({key:`${t}[${f}]`,value:r[f]}));return d}return Zu({key:t,value:r})},variableAnchorOffsetCollection:function(o){let t=o.key,r=o.value,d=Nt(r),f=o.styleSpec;if(d!=="array"||r.length<1||r.length%2!=0)return[new De(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let y=0;y<r.length;y+=2)_=_.concat(Ec({key:`${t}[${y}]`,value:r[y],valueSpec:f.layout_symbol["text-anchor"]})),_=_.concat(Bo({key:`${t}[${y+1}]`,value:r[y+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:f}));return _},sprite:Xu,state:Dd};function Tl(o){let t=o.value,r=o.valueSpec,d=o.styleSpec;return o.validateSpec=Tl,r.expression&&Kr(yt(t))?Hu(o):r.expression&&Pa(Jt(t))?No(o):r.type&&Zp[r.type]?Zp[r.type](o):ii(ni({},o,{valueSpec:r.type?d[r.type]:r}))}function qp(o){let t=o.value,r=o.key,d=Tn(o);return d.length||(t.indexOf("{fontstack}")===-1&&d.push(new De(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&d.push(new De(r,t,'"glyphs" url must include a "{range}" token'))),d}function ir(o,t=X){let r=[];return r=r.concat(Tl({key:"",value:o,valueSpec:t.$root,styleSpec:t,style:o,validateSpec:Tl,objectElementValidators:{glyphs:qp,"*":()=>[]}})),o.constants&&(r=r.concat(et({key:"constants",value:o.constants}))),El(r)}function po(o){return function(t){return o(si(Ye({},t),{validateSpec:Tl}))}}function El(o){return[].concat(o).sort((t,r)=>t.line-r.line)}function fo(o){return function(...t){return El(o.apply(this,t))}}ir.source=fo(po(Wu)),ir.sprite=fo(po(Xu)),ir.glyphs=fo(po(qp)),ir.light=fo(po(Gp)),ir.sky=fo(po(Hp)),ir.terrain=fo(po(Sl)),ir.state=fo(po(Dd)),ir.layer=fo(po(Cl)),ir.filter=fo(po(qu)),ir.paintProperty=fo(po($p)),ir.layoutProperty=fo(po(wl));let Il=ir,Rd=Il.light,Ag=Il.sky,Yu=Il.paintProperty,Od=Il.layoutProperty;function Ku(o,t){let r=!1;if(t&&t.length)for(let d of t)o.fire(new se(new Error(d.message))),r=!0;return r}class Pl{constructor(t,r,d){let f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;let y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(r=y[1])+2*(d=y[2]);for(let w=0;w<this.d*this.d;w++){let S=y[3+w],P=y[3+w+1];f.push(S===P?null:y.subarray(S,P))}let b=y[3+f.length+1];this.keys=y.subarray(y[3+f.length],b),this.bboxes=y.subarray(b),this.insert=this._insertReadonly}else{this.d=r+2*d;for(let y=0;y<this.d*this.d;y++)f.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=d,this.scale=r/t,this.uid=0;let _=d/r*t;this.min=-_,this.max=t+_}insert(t,r,d,f,_){this._forEachCell(r,d,f,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,d,f,_,y){this.cells[_].push(y)}query(t,r,d,f,_){let y=this.min,b=this.max;if(t<=y&&r<=y&&b<=d&&b<=f&&!_)return Array.prototype.slice.call(this.keys);{let w=[];return this._forEachCell(t,r,d,f,this._queryCell,w,{},_),w}}_queryCell(t,r,d,f,_,y,b,w){let S=this.cells[_];if(S!==null){let P=this.keys,A=this.bboxes;for(let O=0;O<S.length;O++){let z=S[O];if(b[z]===void 0){let B=4*z;(w?w(A[B+0],A[B+1],A[B+2],A[B+3]):t<=A[B+2]&&r<=A[B+3]&&d>=A[B+0]&&f>=A[B+1])?(b[z]=!0,y.push(P[z])):b[z]=!1}}}}_forEachCell(t,r,d,f,_,y,b,w){let S=this._convertToCellCoord(t),P=this._convertToCellCoord(r),A=this._convertToCellCoord(d),O=this._convertToCellCoord(f);for(let z=S;z<=A;z++)for(let B=P;B<=O;B++){let U=this.d*B+z;if((!w||w(this._convertFromCellCoord(z),this._convertFromCellCoord(B),this._convertFromCellCoord(z+1),this._convertFromCellCoord(B+1)))&&_.call(this,t,r,d,f,U,y,b,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let t=this.cells,r=3+this.cells.length+1+1,d=0;for(let y=0;y<this.cells.length;y++)d+=this.cells[y].length;let f=new Int32Array(r+d+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let _=r;for(let y=0;y<t.length;y++){let b=t[y];f[3+y]=_,f.set(b,_),_+=b.length}return f[3+t.length]=_,f.set(this.keys,_),_+=this.keys.length,f[3+t.length+1]=_,f.set(this.bboxes,_),_+=this.bboxes.length,f.buffer}static serialize(t,r){let d=t.toArrayBuffer();return r&&r.push(d),{buffer:d}}static deserialize(t){return new Pl(t.buffer)}}let Vo={};function tt(o,t,r={}){if(Vo[o])throw new Error(`${o} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:o,writeable:!1}),Vo[o]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}tt("Object",Object),tt("TransferableGridIndex",Pl),tt("Color",Vt),tt("Error",Error),tt("AJAXError",Ei),tt("ResolvedImage",ur),tt("StylePropertyFunction",ka),tt("StyleExpression",yl,{omit:["_evaluator"]}),tt("ZoomDependentExpression",ds),tt("ZoomConstantExpression",Cr),tt("CompoundExpression",Or,{omit:["_evaluate"]});for(let o in Ns)Ns[o]._classRegistryKey||tt(`Expression_${o}`,Ns[o]);function Fd(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function Ld(o){return o.$name||o.constructor._classRegistryKey}function Wp(o){return!function(t){if(t===null||typeof t!="object")return!1;let r=Ld(t);return!(!r||r==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||Fd(o)||rn(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function kl(o,t){if(Wp(o))return(Fd(o)||rn(o))&&t&&t.push(o),ArrayBuffer.isView(o)&&t&&t.push(o.buffer),o instanceof ImageData&&t&&t.push(o.data.buffer),o;if(Array.isArray(o)){let _=[];for(let y of o)_.push(kl(y,t));return _}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);let r=Ld(o);if(!r)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!Vo[r])throw new Error(`${r} is not registered.`);let{klass:d}=Vo[r],f=d.serialize?d.serialize(o,t):{};if(d.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let _ in o){if(!o.hasOwnProperty(_)||Vo[r].omit.indexOf(_)>=0)continue;let y=o[_];f[_]=Vo[r].shallow.indexOf(_)>=0?y:kl(y,t)}o instanceof Error&&(f.message=o.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(f.$name=r),f}function Ic(o){if(Wp(o))return o;if(Array.isArray(o))return o.map(Ic);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);let t=Ld(o)||"Object";if(!Vo[t])throw new Error(`can't deserialize unregistered class ${t}`);let{klass:r}=Vo[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(o);let d=Object.create(r.prototype);for(let f of Object.keys(o)){if(f==="$name")continue;let _=o[f];d[f]=Vo[t].shallow.indexOf(f)>=0?_:Ic(_)}return d}class Qu{constructor(){this.first=!0}update(t,r){let d=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=d,!0))}}let Ht={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function zd(o){for(let t of o)if(Bd(t.charCodeAt(0)))return!0;return!1}function Dg(o){for(let t of o)if(!Yp(t.charCodeAt(0)))return!1;return!0}function Ju(o){let t=o.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(t.join("|"),"u")}let Xp=Ju(["Arab","Dupl","Mong","Ougr","Syrc"]);function Yp(o){return!Xp.test(String.fromCodePoint(o))}let eh=Ju(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Bd(o){return!(o!==746&&o!==747&&(o<4352||!(Ht["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||Ht["CJK Compatibility"](o)||Ht["CJK Strokes"](o)||!(!Ht["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||Ht["Enclosed CJK Letters and Months"](o)||Ht["Ideographic Description Characters"](o)||Ht.Kanbun(o)||Ht.Katakana(o)&&o!==12540||!(!Ht["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!Ht["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||Ht["Vertical Forms"](o)||Ht["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||eh.test(String.fromCodePoint(o)))))}function Pc(o){return!(Bd(o)||function(t){return!!(Ht["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ht["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ht["Letterlike Symbols"](t)||Ht["Number Forms"](t)||Ht["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ht["Control Pictures"](t)&&t!==9251||Ht["Optical Character Recognition"](t)||Ht["Enclosed Alphanumerics"](t)||Ht["Geometric Shapes"](t)||Ht["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ht["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ht["CJK Symbols and Punctuation"](t)||Ht.Katakana(t)||Ht["Private Use Area"](t)||Ht["CJK Compatibility Forms"](t)||Ht["Small Form Variants"](t)||Ht["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(o))}let Rg=Ju(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Nd(o){return Rg.test(String.fromCodePoint(o))}function Og(o,t){return!(!t&&Nd(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||Ht.Khmer(o))}function Fg(o){for(let t of o)if(Nd(t.charCodeAt(0)))return!0;return!1}let hs=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(hs.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,t){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;let r=o.pluginURL,d=new Promise(_=>{this.loadScriptResolve=_});t(r);let f=new Promise(_=>setTimeout(()=>_(),this.TIMEOUT));if(yield Promise.race([d,f]),this.isParsed()){let _={pluginStatus:"loaded",pluginURL:r};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class Ri{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Qu,this.transition={})}isSupportedScript(t){return function(r,d){for(let f of r)if(!Og(f.charCodeAt(0),d))return!1;return!0}(t,hs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let t=this.zoom,r=t-Math.floor(t),d=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*r}}}class kc{constructor(t,r){this.property=t,this.value=r,this.expression=function(d,f){if(Kr(d))return new ka(d,f);if(Pa(d)){let _=$i(d,f);if(_.result==="error")throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));return _.value}{let _=d;return f.type==="color"&&typeof d=="string"?_=Vt.parse(d):f.type!=="padding"||typeof d!="number"&&!Array.isArray(d)?f.type!=="numberArray"||typeof d!="number"&&!Array.isArray(d)?f.type!=="colorArray"||typeof d!="string"&&!Array.isArray(d)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(d)?_=Zn.parse(d):f.type==="projectionDefinition"&&typeof d=="string"&&(_=er.parse(d)):_=hn.parse(d):_=ji.parse(d):_=Sn.parse(d),{kind:"constant",evaluate:()=>_}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,d){return this.property.possiblyEvaluate(this,t,r,d)}}class th{constructor(t){this.property=t,this.value=new kc(t,void 0)}transitioned(t,r){return new Qp(this.property,this.value,r,wn({},t.transition,this.transition),t.now)}untransitioned(){return new Qp(this.property,this.value,null,{},0)}}class Kp{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return lr(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new th(this._values[t].property)),this._values[t].value=new kc(this._values[t].property,r===null?void 0:lr(r))}getTransition(t){return lr(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new th(this._values[t].property)),this._values[t].transition=lr(r)||void 0}serialize(){let t={};for(let r of Object.keys(this._values)){let d=this.getValue(r);d!==void 0&&(t[r]=d);let f=this.getTransition(r);f!==void 0&&(t[`${r}-transition`]=f)}return t}transitioned(t,r){let d=new Jp(this._properties);for(let f of Object.keys(this._values))d._values[f]=this._values[f].transitioned(t,r._values[f]);return d}untransitioned(){let t=new Jp(this._properties);for(let r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class Qp{constructor(t,r,d,f,_){this.property=t,this.value=r,this.begin=_+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=d)}possiblyEvaluate(t,r,d){let f=t.now||0,_=this.value.possiblyEvaluate(t,r,d),y=this.prior;if(y){if(f>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(f<this.begin)return y.possiblyEvaluate(t,r,d);{let b=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,r,d),_,tn(b))}}return _}}class Jp{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,d){let f=new Vd(this._properties);for(let _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(t,r,d);return f}hasTransition(){for(let t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Lg{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return lr(this._values[t].value)}setValue(t,r){this._values[t]=new kc(this._values[t].property,r===null?void 0:lr(r))}serialize(){let t={};for(let r of Object.keys(this._values)){let d=this.getValue(r);d!==void 0&&(t[r]=d)}return t}possiblyEvaluate(t,r,d){let f=new Vd(this._properties);for(let _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(t,r,d);return f}}class hr{constructor(t,r,d){this.property=t,this.value=r,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,d,f){return this.property.evaluate(this.value,this.parameters,t,r,d,f)}}class Vd{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class dt{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,d){let f=Xr[this.specification.type];return f?f(t,r,d):t}}class vt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,d,f){return new hr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},d,f)}:t.expression,r)}interpolate(t,r,d){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new hr(this,{kind:"constant",value:void 0},t.parameters);let f=Xr[this.specification.type];if(f){let _=f(t.value.value,r.value.value,d);return new hr(this,{kind:"constant",value:_},t.parameters)}return t}evaluate(t,r,d,f,_,y){return t.kind==="constant"?t.value:t.evaluate(r,d,f,_,y)}}class Ac extends vt{possiblyEvaluate(t,r,d,f){if(t.value===void 0)return new hr(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){let _=t.expression.evaluate(r,null,{},d,f),y=t.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,b=this._calculate(y,y,y,r);return new hr(this,{kind:"constant",value:b},r)}if(t.expression.kind==="camera"){let _=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new hr(this,{kind:"constant",value:_},r)}return new hr(this,t.expression,r)}evaluate(t,r,d,f,_,y){if(t.kind==="source"){let b=t.evaluate(r,d,f,_,y);return this._calculate(b,b,b,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},d,f),t.evaluate({zoom:Math.floor(r.zoom)},d,f),t.evaluate({zoom:Math.floor(r.zoom)+1},d,f),r):t.value}_calculate(t,r,d,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:d,to:r}}interpolate(t){return t}}class ih{constructor(t){this.specification=t}possiblyEvaluate(t,r,d,f){if(t.value!==void 0){if(t.expression.kind==="constant"){let _=t.expression.evaluate(r,null,{},d,f);return this._calculate(_,_,_,r)}return this._calculate(t.expression.evaluate(new Ri(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Ri(Math.floor(r.zoom),r)),t.expression.evaluate(new Ri(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,d,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:d,to:r}}interpolate(t){return t}}class nh{constructor(t){this.specification=t}possiblyEvaluate(t,r,d,f){return!!t.expression.evaluate(r,null,{},d,f)}interpolate(){return!1}}class mn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in t){let d=t[r];d.specification.overridable&&this.overridableProperties.push(r);let f=this.defaultPropertyValues[r]=new kc(d,void 0),_=this.defaultTransitionablePropertyValues[r]=new th(d);this.defaultTransitioningPropertyValues[r]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}}}tt("DataDrivenProperty",vt),tt("DataConstantProperty",dt),tt("CrossFadedDataDrivenProperty",Ac),tt("CrossFadedProperty",ih),tt("ColorRampProperty",nh);let rh="-transition";class Qr extends fe{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new Lg(r.layout)),r.paint)){this._transitionablePaint=new Kp(r.paint);for(let d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(let d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Vd(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,d={}){r!=null&&this._validate(Od,`layers.${this.id}.layout.${t}`,t,r,d)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(rh)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,d={}){if(r!=null&&this._validate(Yu,`layers.${this.id}.paint.${t}`,t,r,d))return!1;if(t.endsWith(rh))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{let f=this._transitionablePaint._values[t],_=f.property.specification["property-type"]==="cross-faded-data-driven",y=f.value.isDataDriven(),b=f.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);let w=this._transitionablePaint._values[t].value;return w.isDataDriven()||y||_||this._handleOverridablePaintPropertyUpdate(t,b,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,d){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){let t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Ko(t,(r,d)=>!(r===void 0||d==="layout"&&!Object.keys(r).length||d==="paint"&&!Object.keys(r).length))}_validate(t,r,d,f,_={}){return(!_||_.validate!==!1)&&Ku(this,t.call(Il,{key:r,layerType:this.type,objectKey:d,value:f,styleSpec:X,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let t in this.paint._values){let r=this.paint.get(t);if(r instanceof hr&&js(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}let ef={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Oa{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ki{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){let r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Hi(o,t=1){let r=0,d=0;return{members:o.map(f=>{let _=ef[f.type].BYTES_PER_ELEMENT,y=r=Al(r,Math.max(t,_)),b=f.components||1;return d=Math.max(d,_),r+=_*b,{name:f.name,type:f.type,components:b,offset:y}}),size:Al(r,Math.max(d,t)),alignment:t}}function Al(o,t){return Math.ceil(o/t)*t}class Dc extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){let d=this.length;return this.resize(d+1),this.emplace(d,t,r)}emplace(t,r,d){let f=2*t;return this.int16[f+0]=r,this.int16[f+1]=d,t}}Dc.prototype.bytesPerElement=4,tt("StructArrayLayout2i4",Dc);class Rc extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d){let f=this.length;return this.resize(f+1),this.emplace(f,t,r,d)}emplace(t,r,d,f){let _=3*t;return this.int16[_+0]=r,this.int16[_+1]=d,this.int16[_+2]=f,t}}Rc.prototype.bytesPerElement=6,tt("StructArrayLayout3i6",Rc);class Fa extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,f){let _=this.length;return this.resize(_+1),this.emplace(_,t,r,d,f)}emplace(t,r,d,f,_){let y=4*t;return this.int16[y+0]=r,this.int16[y+1]=d,this.int16[y+2]=f,this.int16[y+3]=_,t}}Fa.prototype.bytesPerElement=8,tt("StructArrayLayout4i8",Fa);class oh extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,f,_,y)}emplace(t,r,d,f,_,y,b){let w=6*t;return this.int16[w+0]=r,this.int16[w+1]=d,this.int16[w+2]=f,this.int16[w+3]=_,this.int16[w+4]=y,this.int16[w+5]=b,t}}oh.prototype.bytesPerElement=12,tt("StructArrayLayout2i4i12",oh);class sh extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,f,_,y)}emplace(t,r,d,f,_,y,b){let w=4*t,S=8*t;return this.int16[w+0]=r,this.int16[w+1]=d,this.uint8[S+4]=f,this.uint8[S+5]=_,this.uint8[S+6]=y,this.uint8[S+7]=b,t}}sh.prototype.bytesPerElement=8,tt("StructArrayLayout2i4ub8",sh);class Dl extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){let d=this.length;return this.resize(d+1),this.emplace(d,t,r)}emplace(t,r,d){let f=2*t;return this.float32[f+0]=r,this.float32[f+1]=d,t}}Dl.prototype.bytesPerElement=8,tt("StructArrayLayout2f8",Dl);class ah extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y,b,w,S,P){let A=this.length;return this.resize(A+1),this.emplace(A,t,r,d,f,_,y,b,w,S,P)}emplace(t,r,d,f,_,y,b,w,S,P,A){let O=10*t;return this.uint16[O+0]=r,this.uint16[O+1]=d,this.uint16[O+2]=f,this.uint16[O+3]=_,this.uint16[O+4]=y,this.uint16[O+5]=b,this.uint16[O+6]=w,this.uint16[O+7]=S,this.uint16[O+8]=P,this.uint16[O+9]=A,t}}ah.prototype.bytesPerElement=20,tt("StructArrayLayout10ui20",ah);class m extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y,b,w,S,P,A,O){let z=this.length;return this.resize(z+1),this.emplace(z,t,r,d,f,_,y,b,w,S,P,A,O)}emplace(t,r,d,f,_,y,b,w,S,P,A,O,z){let B=12*t;return this.int16[B+0]=r,this.int16[B+1]=d,this.int16[B+2]=f,this.int16[B+3]=_,this.uint16[B+4]=y,this.uint16[B+5]=b,this.uint16[B+6]=w,this.uint16[B+7]=S,this.int16[B+8]=P,this.int16[B+9]=A,this.int16[B+10]=O,this.int16[B+11]=z,t}}m.prototype.bytesPerElement=24,tt("StructArrayLayout4i4ui4i24",m);class e extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d){let f=this.length;return this.resize(f+1),this.emplace(f,t,r,d)}emplace(t,r,d,f){let _=3*t;return this.float32[_+0]=r,this.float32[_+1]=d,this.float32[_+2]=f,t}}e.prototype.bytesPerElement=12,tt("StructArrayLayout3f12",e);class n extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}n.prototype.bytesPerElement=4,tt("StructArrayLayout1ul4",n);class u extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y,b,w,S){let P=this.length;return this.resize(P+1),this.emplace(P,t,r,d,f,_,y,b,w,S)}emplace(t,r,d,f,_,y,b,w,S,P){let A=10*t,O=5*t;return this.int16[A+0]=r,this.int16[A+1]=d,this.int16[A+2]=f,this.int16[A+3]=_,this.int16[A+4]=y,this.int16[A+5]=b,this.uint32[O+3]=w,this.uint16[A+8]=S,this.uint16[A+9]=P,t}}u.prototype.bytesPerElement=20,tt("StructArrayLayout6i1ul2ui20",u);class p extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,f,_,y)}emplace(t,r,d,f,_,y,b){let w=6*t;return this.int16[w+0]=r,this.int16[w+1]=d,this.int16[w+2]=f,this.int16[w+3]=_,this.int16[w+4]=y,this.int16[w+5]=b,t}}p.prototype.bytesPerElement=12,tt("StructArrayLayout2i2i2i12",p);class g extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_){let y=this.length;return this.resize(y+1),this.emplace(y,t,r,d,f,_)}emplace(t,r,d,f,_,y){let b=4*t,w=8*t;return this.float32[b+0]=r,this.float32[b+1]=d,this.float32[b+2]=f,this.int16[w+6]=_,this.int16[w+7]=y,t}}g.prototype.bytesPerElement=16,tt("StructArrayLayout2f1f2i16",g);class v extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,f,_,y)}emplace(t,r,d,f,_,y,b){let w=16*t,S=4*t,P=8*t;return this.uint8[w+0]=r,this.uint8[w+1]=d,this.float32[S+1]=f,this.float32[S+2]=_,this.int16[P+6]=y,this.int16[P+7]=b,t}}v.prototype.bytesPerElement=16,tt("StructArrayLayout2ub2f2i16",v);class x extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d){let f=this.length;return this.resize(f+1),this.emplace(f,t,r,d)}emplace(t,r,d,f){let _=3*t;return this.uint16[_+0]=r,this.uint16[_+1]=d,this.uint16[_+2]=f,t}}x.prototype.bytesPerElement=6,tt("StructArrayLayout3ui6",x);class C extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y,b,w,S,P,A,O,z,B,U,W,ie){let pe=this.length;return this.resize(pe+1),this.emplace(pe,t,r,d,f,_,y,b,w,S,P,A,O,z,B,U,W,ie)}emplace(t,r,d,f,_,y,b,w,S,P,A,O,z,B,U,W,ie,pe){let oe=24*t,L=12*t,q=48*t;return this.int16[oe+0]=r,this.int16[oe+1]=d,this.uint16[oe+2]=f,this.uint16[oe+3]=_,this.uint32[L+2]=y,this.uint32[L+3]=b,this.uint32[L+4]=w,this.uint16[oe+10]=S,this.uint16[oe+11]=P,this.uint16[oe+12]=A,this.float32[L+7]=O,this.float32[L+8]=z,this.uint8[q+36]=B,this.uint8[q+37]=U,this.uint8[q+38]=W,this.uint32[L+10]=ie,this.int16[oe+22]=pe,t}}C.prototype.bytesPerElement=48,tt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",C);class I extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d,f,_,y,b,w,S,P,A,O,z,B,U,W,ie,pe,oe,L,q,ae,Te,Ve,Ie,Fe,He,je){let Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,t,r,d,f,_,y,b,w,S,P,A,O,z,B,U,W,ie,pe,oe,L,q,ae,Te,Ve,Ie,Fe,He,je)}emplace(t,r,d,f,_,y,b,w,S,P,A,O,z,B,U,W,ie,pe,oe,L,q,ae,Te,Ve,Ie,Fe,He,je,Ze){let ze=32*t,nt=16*t;return this.int16[ze+0]=r,this.int16[ze+1]=d,this.int16[ze+2]=f,this.int16[ze+3]=_,this.int16[ze+4]=y,this.int16[ze+5]=b,this.int16[ze+6]=w,this.int16[ze+7]=S,this.uint16[ze+8]=P,this.uint16[ze+9]=A,this.uint16[ze+10]=O,this.uint16[ze+11]=z,this.uint16[ze+12]=B,this.uint16[ze+13]=U,this.uint16[ze+14]=W,this.uint16[ze+15]=ie,this.uint16[ze+16]=pe,this.uint16[ze+17]=oe,this.uint16[ze+18]=L,this.uint16[ze+19]=q,this.uint16[ze+20]=ae,this.uint16[ze+21]=Te,this.uint16[ze+22]=Ve,this.uint32[nt+12]=Ie,this.float32[nt+13]=Fe,this.float32[nt+14]=He,this.uint16[ze+30]=je,this.uint16[ze+31]=Ze,t}}I.prototype.bytesPerElement=64,tt("StructArrayLayout8i15ui1ul2f2ui64",I);class k extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}k.prototype.bytesPerElement=4,tt("StructArrayLayout1f4",k);class R extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d){let f=this.length;return this.resize(f+1),this.emplace(f,t,r,d)}emplace(t,r,d,f){let _=3*t;return this.uint16[6*t+0]=r,this.float32[_+1]=d,this.float32[_+2]=f,t}}R.prototype.bytesPerElement=12,tt("StructArrayLayout1ui2f12",R);class D extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d){let f=this.length;return this.resize(f+1),this.emplace(f,t,r,d)}emplace(t,r,d,f){let _=4*t;return this.uint32[2*t+0]=r,this.uint16[_+2]=d,this.uint16[_+3]=f,t}}D.prototype.bytesPerElement=8,tt("StructArrayLayout1ul2ui8",D);class N extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){let d=this.length;return this.resize(d+1),this.emplace(d,t,r)}emplace(t,r,d){let f=2*t;return this.uint16[f+0]=r,this.uint16[f+1]=d,t}}N.prototype.bytesPerElement=4,tt("StructArrayLayout2ui4",N);class j extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}j.prototype.bytesPerElement=2,tt("StructArrayLayout1ui2",j);class ee extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d,f){let _=this.length;return this.resize(_+1),this.emplace(_,t,r,d,f)}emplace(t,r,d,f,_){let y=4*t;return this.float32[y+0]=r,this.float32[y+1]=d,this.float32[y+2]=f,this.float32[y+3]=_,t}}ee.prototype.bytesPerElement=16,tt("StructArrayLayout4f16",ee);class J extends Oa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new $e(this.anchorPointX,this.anchorPointY)}}J.prototype.size=20;class te extends u{get(t){return new J(this,t)}}tt("CollisionBoxArray",te);class re extends Oa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}re.prototype.size=48;class de extends C{get(t){return new re(this,t)}}tt("PlacedSymbolArray",de);class ce extends Oa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ce.prototype.size=64;class ue extends I{get(t){return new ce(this,t)}}tt("SymbolInstanceArray",ue);class ge extends k{getoffsetX(t){return this.float32[1*t+0]}}tt("GlyphOffsetArray",ge);class he extends Rc{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}tt("SymbolLineVertexArray",he);class Se extends Oa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Se.prototype.size=12;class Le extends R{get(t){return new Se(this,t)}}tt("TextAnchorOffsetArray",Le);class ke extends Oa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ke.prototype.size=8;class Ae extends D{get(t){return new ke(this,t)}}tt("FeatureIndexArray",Ae);class Re extends Dc{}class Ke extends Dc{}class Xe extends Dc{}class Ue extends oh{}class st extends sh{}class Ot extends Dl{}class ei extends ah{}class Zi extends m{}class Si extends e{}class qi extends n{}class Wi extends p{}class Pi extends v{}class di extends x{}class En extends N{}let zn=Hi([{name:"a_pos",components:2,type:"Int16"}],4),{members:qn}=zn;class ui{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,d,f){let _=this.segments[this.segments.length-1];return t>ui.MAX_VERTEX_ARRAY_LENGTH&&Cn(`Max vertices per segment is ${ui.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ui.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+t>ui.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==f?this.createNewSegment(r,d,f):_}createNewSegment(t,r,d){let f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return d!==void 0&&(f.sortKey=d),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(f),f}getOrCreateLatestSegment(t,r,d){return this.prepareSegment(0,t,r,d)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let t of this.segments)for(let r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,d,f){return new ui([{vertexOffset:t,primitiveOffset:r,vertexLength:d,primitiveLength:f,vaos:{},sortKey:0}])}}function $s(o,t){return 256*(o=xn(Math.floor(o),0,255))+xn(Math.floor(t),0,255)}ui.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,tt("SegmentVector",ui);let jo=Hi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Gs,La,Oc,Hs={exports:{}},za={exports:{}},Fr={exports:{}},Zs=function(){if(Oc)return Hs.exports;Oc=1;var o=(Gs||(Gs=1,za.exports=function(r,d){var f,_,y,b,w,S,P,A;for(_=r.length-(f=3&r.length),y=d,w=3432918353,S=461845907,A=0;A<_;)P=255&r.charCodeAt(A)|(255&r.charCodeAt(++A))<<8|(255&r.charCodeAt(++A))<<16|(255&r.charCodeAt(++A))<<24,++A,y=27492+(65535&(b=5*(65535&(y=(y^=P=(65535&(P=(P=(65535&P)*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*S+(((P>>>16)*S&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(P=0,f){case 3:P^=(255&r.charCodeAt(A+2))<<16;case 2:P^=(255&r.charCodeAt(A+1))<<8;case 1:y^=P=(65535&(P=(P=(65535&(P^=255&r.charCodeAt(A)))*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*S+(((P>>>16)*S&65535)<<16)&4294967295}return y^=r.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),za.exports),t=(La||(La=1,Fr.exports=function(r,d){for(var f,_=r.length,y=d^_,b=0;_>=4;)f=1540483477*(65535&(f=255&r.charCodeAt(b)|(255&r.charCodeAt(++b))<<8|(255&r.charCodeAt(++b))<<16|(255&r.charCodeAt(++b))<<24))+((1540483477*(f>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),_-=4,++b;switch(_){case 3:y^=(255&r.charCodeAt(b+2))<<16;case 2:y^=(255&r.charCodeAt(b+1))<<8;case 1:y=1540483477*(65535&(y^=255&r.charCodeAt(b)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Fr.exports);return Hs.exports=o,Hs.exports.murmur3=o,Hs.exports.murmur2=t,Hs.exports}(),ps=T(Zs);class qs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,d,f){this.ids.push(gn(t)),this.positions.push(r,d,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=gn(t),d=0,f=this.ids.length-1;for(;d<f;){let y=d+f>>1;this.ids[y]>=r?f=y:d=y+1}let _=[];for(;this.ids[d]===r;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(t,r){let d=new Float64Array(t.ids),f=new Uint32Array(t.positions);return _n(d,f,0,d.length-1),r&&r.push(d.buffer,f.buffer),{ids:d,positions:f}}static deserialize(t){let r=new qs;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function gn(o){let t=+o;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ps(String(o))}function _n(o,t,r,d){for(;r<d;){let f=o[r+d>>1],_=r-1,y=d+1;for(;;){do _++;while(o[_]<f);do y--;while(o[y]>f);if(_>=y)break;pr(o,_,y),pr(t,3*_,3*y),pr(t,3*_+1,3*y+1),pr(t,3*_+2,3*y+2)}y-r<d-y?(_n(o,t,r,y),r=y+1):(_n(o,t,y+1,d),d=y)}}function pr(o,t,r){let d=o[t];o[t]=o[r],o[r]=d}tt("FeaturePositionMap",qs);class Oi{constructor(t,r){this.gl=t.gl,this.location=r}}class jd extends Oi{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class tf extends Oi{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class nf extends Oi{constructor(t,r){super(t,r),this.current=Vt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}let zg=new Float32Array(16);function lh(o){return[$s(255*o.r,255*o.g),$s(255*o.b,255*o.a)]}class Fc{constructor(t,r,d){this.value=t,this.uniformNames=r.map(f=>`u_${f}`),this.type=d}setUniform(t,r,d){t.set(d.constantOr(this.value))}getBinding(t,r,d){return this.type==="color"?new nf(t,r):new jd(t,r)}}class Jr{constructor(t,r){this.uniformNames=r.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,d,f){let _=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&t.set(_)}getBinding(t,r,d){return d.substr(0,9)==="u_pattern"?new tf(t,r):new jd(t,r)}}class Uo{constructor(t,r,d,f){this.expression=t,this.type=d,this.maxValue=0,this.paintVertexAttributes=r.map(_=>({name:`a_${_}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,r,d,f,_){let y=this.paintVertexArray.length,b=this.expression.evaluate(new Ri(0),r,{},f,[],_);this.paintVertexArray.resize(t),this._setPaintValue(y,t,b)}updatePaintArray(t,r,d,f){let _=this.expression.evaluate({zoom:0},d,f);this._setPaintValue(t,r,_)}_setPaintValue(t,r,d){if(this.type==="color"){let f=lh(d);for(let _=t;_<r;_++)this.paintVertexArray.emplace(_,f[0],f[1])}else{for(let f=t;f<r;f++)this.paintVertexArray.emplace(f,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class eo{constructor(t,r,d,f,_,y){this.expression=t,this.uniformNames=r.map(b=>`u_${b}_t`),this.type=d,this.useIntegerZoom=f,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,r,d,f,_){let y=this.expression.evaluate(new Ri(this.zoom),r,{},f,[],_),b=this.expression.evaluate(new Ri(this.zoom+1),r,{},f,[],_),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,y,b)}updatePaintArray(t,r,d,f){let _=this.expression.evaluate({zoom:this.zoom},d,f),y=this.expression.evaluate({zoom:this.zoom+1},d,f);this._setPaintValue(t,r,_,y)}_setPaintValue(t,r,d,f){if(this.type==="color"){let _=lh(d),y=lh(f);for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,_[0],_[1],y[0],y[1])}else{for(let _=t;_<r;_++)this.paintVertexArray.emplace(_,d,f);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){let d=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,f=xn(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,r,d){return new jd(t,r)}}class fs{constructor(t,r,d,f,_,y){this.expression=t,this.type=r,this.useIntegerZoom=d,this.zoom=f,this.layerId=y,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(t,r,d){let f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,r.patterns&&r.patterns[this.layerId],d)}updatePaintArray(t,r,d,f,_){this._setPaintValues(t,r,d.patterns&&d.patterns[this.layerId],_)}_setPaintValues(t,r,d,f){if(!f||!d)return;let{min:_,mid:y,max:b}=d,w=f[_],S=f[y],P=f[b];if(w&&S&&P)for(let A=t;A<r;A++)this.zoomInPaintVertexArray.emplace(A,S.tl[0],S.tl[1],S.br[0],S.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],S.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,S.tl[0],S.tl[1],S.br[0],S.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],S.pixelRatio,P.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,jo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,jo.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ud{constructor(t,r,d){this.binders={},this._buffers=[];let f=[];for(let _ in t.paint._values){if(!d(_))continue;let y=t.paint.get(_);if(!(y instanceof hr&&js(y.property.specification)))continue;let b=ch(_,t.type),w=y.value,S=y.property.specification.type,P=y.property.useIntegerZoom,A=y.property.specification["property-type"],O=A==="cross-faded"||A==="cross-faded-data-driven";if(w.kind==="constant")this.binders[_]=O?new Jr(w.value,b):new Fc(w.value,b,S),f.push(`/u_${_}`);else if(w.kind==="source"||O){let z=qy(_,S,"source");this.binders[_]=O?new fs(w,S,P,r,z,t.id):new Uo(w,b,S,z),f.push(`/a_${_}`)}else{let z=qy(_,S,"composite");this.binders[_]=new eo(w,b,S,P,r,z),f.push(`/z_${_}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){let r=this.binders[t];return r instanceof Uo||r instanceof eo?r.maxValue:0}populatePaintArrays(t,r,d,f,_){for(let y in this.binders){let b=this.binders[y];(b instanceof Uo||b instanceof eo||b instanceof fs)&&b.populatePaintArray(t,r,d,f,_)}}setConstantPatternPositions(t,r){for(let d in this.binders){let f=this.binders[d];f instanceof Jr&&f.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,d,f,_){let y=!1;for(let b in t){let w=r.getPositions(b);for(let S of w){let P=d.feature(S.index);for(let A in this.binders){let O=this.binders[A];if((O instanceof Uo||O instanceof eo||O instanceof fs)&&O.expression.isStateDependent===!0){let z=f.paint.get(A);O.expression=z.value,O.updatePaintArray(S.start,S.end,P,t[b],_),y=!0}}}}return y}defines(){let t=[];for(let r in this.binders){let d=this.binders[r];(d instanceof Fc||d instanceof Jr)&&t.push(...d.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){let t=[];for(let r in this.binders){let d=this.binders[r];if(d instanceof Uo||d instanceof eo)for(let f=0;f<d.paintVertexAttributes.length;f++)t.push(d.paintVertexAttributes[f].name);else if(d instanceof fs)for(let f=0;f<jo.members.length;f++)t.push(jo.members[f].name)}return t}getBinderUniforms(){let t=[];for(let r in this.binders){let d=this.binders[r];if(d instanceof Fc||d instanceof Jr||d instanceof eo)for(let f of d.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){let d=[];for(let f in this.binders){let _=this.binders[f];if(_ instanceof Fc||_ instanceof Jr||_ instanceof eo){for(let y of _.uniformNames)if(r[y]){let b=_.getBinding(t,r[y],y);d.push({name:y,property:f,binding:b})}}}return d}setUniforms(t,r,d,f){for(let{name:_,property:y,binding:b}of r)this.binders[y].setUniform(b,f,d.get(y),_)}updatePaintBuffers(t){this._buffers=[];for(let r in this.binders){let d=this.binders[r];if(t&&d instanceof fs){let f=t.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(d instanceof Uo||d instanceof eo)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(t){for(let r in this.binders){let d=this.binders[r];(d instanceof Uo||d instanceof eo||d instanceof fs)&&d.upload(t)}this.updatePaintBuffers()}destroy(){for(let t in this.binders){let r=this.binders[t];(r instanceof Uo||r instanceof eo||r instanceof fs)&&r.destroy()}}}class Ws{constructor(t,r,d=()=>!0){this.programConfigurations={};for(let f of t)this.programConfigurations[f.id]=new Ud(f,r,d);this.needsUpload=!1,this._featureMap=new qs,this._bufferOffset=0}populatePaintArrays(t,r,d,f,_,y){for(let b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,f,_,y);r.id!==void 0&&this._featureMap.add(r.id,d,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,d,f){for(let _ of d)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(t,this._featureMap,r,_,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(let t in this.programConfigurations)this.programConfigurations[t].destroy()}}function ch(o,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${t}-`,"").replace(/-/g,"_")]}function qy(o,t,r){let d={color:{source:Dl,composite:ee},number:{source:k,composite:Dl}},f=function(_){return{"line-pattern":{source:ei,composite:ei},"fill-pattern":{source:ei,composite:ei},"fill-extrusion-pattern":{source:ei,composite:ei}}[_]}(o);return f&&f[r]||d[t][r]}tt("ConstantBinder",Fc),tt("CrossFadedConstantBinder",Jr),tt("SourceExpressionBinder",Uo),tt("CrossFadedCompositeBinder",fs),tt("CompositeExpressionBinder",eo),tt("ProgramConfiguration",Ud,{omit:["_buffers"]}),tt("ProgramConfigurationSet",Ws);let Bg=Math.pow(2,14)-1,Wy=-Bg-1;function Lc(o){let t=ci/o.extent,r=o.loadGeometry();for(let d=0;d<r.length;d++){let f=r[d];for(let _=0;_<f.length;_++){let y=f[_],b=Math.round(y.x*t),w=Math.round(y.y*t);y.x=xn(b,Wy,Bg),y.y=xn(w,Wy,Bg),(b<y.x||b>y.x+1||w<y.y||w>y.y+1)&&Cn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function zc(o,t){return{type:o.type,id:o.id,properties:o.properties,geometry:t?Lc(o):[]}}let Xy=-32768;function VC(o,t,r,d,f){o.emplaceBack(Xy+8*t+d,Xy+8*r+f)}class Ng{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ke,this.indexArray=new di,this.segments=new ui,this.programConfigurations=new Ws(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){let f=this.layers[0],_=[],y=null,b=!1,w=f.type==="heatmap";if(f.type==="circle"){let P=f;y=P.layout.get("circle-sort-key"),b=!y.isConstant(),w=w||P.paint.get("circle-pitch-alignment")==="map"}let S=w?r.subdivisionGranularity.circle:1;for(let{feature:P,id:A,index:O,sourceLayerIndex:z}of t){let B=this.layers[0]._featureFilter.needGeometry,U=zc(P,B);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),U,d))continue;let W=b?y.evaluate(U,{},d):void 0,ie={id:A,properties:P.properties,type:P.type,sourceLayerIndex:z,index:O,geometry:B?U.geometry:Lc(P),patterns:{},sortKey:W};_.push(ie)}b&&_.sort((P,A)=>P.sortKey-A.sortKey);for(let P of _){let{geometry:A,index:O,sourceLayerIndex:z}=P,B=t[O].feature;this.addFeature(P,A,O,d,S),r.featureIndex.insert(B,A,O,z,this.index)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,d,f,_=1){let y;switch(_){case 1:y=[0,7];break;case 3:y=[0,2,5,7];break;case 5:y=[0,1,3,4,6,7];break;case 7:y=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}let b=y.length;for(let w of r)for(let S of w){let P=S.x,A=S.y;if(P<0||P>=ci||A<0||A>=ci)continue;let O=this.segments.prepareSegment(b*b,this.layoutVertexArray,this.indexArray,t.sortKey),z=O.vertexLength;for(let B=0;B<b;B++)for(let U=0;U<b;U++)VC(this.layoutVertexArray,P,A,y[U],y[B]);for(let B=0;B<b-1;B++)for(let U=0;U<b-1;U++){let W=z+B*b+U,ie=z+(B+1)*b+U;this.indexArray.emplaceBack(W,ie+1,W+1),this.indexArray.emplaceBack(W,ie,ie+1)}O.vertexLength+=b*b,O.primitiveLength+=(b-1)*(b-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,{},f)}}function Yy(o,t){for(let r=0;r<o.length;r++)if(Bc(t,o[r]))return!0;for(let r=0;r<t.length;r++)if(Bc(o,t[r]))return!0;return!!Vg(o,t)}function jC(o,t,r){return!!Bc(o,t)||!!jg(t,o,r)}function Ky(o,t){if(o.length===1)return Jy(t,o[0]);for(let r=0;r<t.length;r++){let d=t[r];for(let f=0;f<d.length;f++)if(Bc(o,d[f]))return!0}for(let r=0;r<o.length;r++)if(Jy(t,o[r]))return!0;for(let r=0;r<t.length;r++)if(Vg(o,t[r]))return!0;return!1}function UC(o,t,r){if(o.length>1){if(Vg(o,t))return!0;for(let d=0;d<t.length;d++)if(jg(t[d],o,r))return!0}for(let d=0;d<o.length;d++)if(jg(o[d],t,r))return!0;return!1}function Vg(o,t){if(o.length===0||t.length===0)return!1;for(let r=0;r<o.length-1;r++){let d=o[r],f=o[r+1];for(let _=0;_<t.length-1;_++)if($C(d,f,t[_],t[_+1]))return!0}return!1}function $C(o,t,r,d){return gi(o,r,d)!==gi(t,r,d)&&gi(o,t,r)!==gi(o,t,d)}function jg(o,t,r){let d=r*r;if(t.length===1)return o.distSqr(t[0])<d;for(let f=1;f<t.length;f++)if(Qy(o,t[f-1],t[f])<d)return!0;return!1}function Qy(o,t,r){let d=t.distSqr(r);if(d===0)return o.distSqr(t);let f=((o.x-t.x)*(r.x-t.x)+(o.y-t.y)*(r.y-t.y))/d;return o.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function Jy(o,t){for(let r=0;r<o.length;r++)if(Bc(o[r],t))return!0;return!1}function Bc(o,t){let r=!1;for(let d=0,f=o.length-1;d<o.length;f=d++){let _=o[d],y=o[f];_.y>t.y!=y.y>t.y&&t.x<(y.x-_.x)*(t.y-_.y)/(y.y-_.y)+_.x&&(r=!r)}return r}function GC(o,t,r){let d=r[0],f=r[2];if(o.x<d.x&&t.x<d.x||o.x>f.x&&t.x>f.x||o.y<d.y&&t.y<d.y||o.y>f.y&&t.y>f.y)return!1;let _=gi(o,t,r[0]);return _!==gi(o,t,r[1])||_!==gi(o,t,r[2])||_!==gi(o,t,r[3])}function dh(o,t,r){let d=t.paint.get(o).value;return d.kind==="constant"?d.value:r.programConfigurations.get(t.id).getMaxValue(o)}function rf(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function of(o,t,r,d,f){if(!t[0]&&!t[1])return o;let _=$e.convert(t)._mult(f);r==="viewport"&&_._rotate(-d);let y=[];for(let b=0;b<o.length;b++)y.push(o[b].sub(_));return y}let ev,tv;tt("CircleBucket",Ng,{omit:["layers"]});var HC={get paint(){return tv=tv||new mn({"circle-radius":new vt(X.paint_circle["circle-radius"]),"circle-color":new vt(X.paint_circle["circle-color"]),"circle-blur":new vt(X.paint_circle["circle-blur"]),"circle-opacity":new vt(X.paint_circle["circle-opacity"]),"circle-translate":new dt(X.paint_circle["circle-translate"]),"circle-translate-anchor":new dt(X.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new dt(X.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new dt(X.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new vt(X.paint_circle["circle-stroke-width"]),"circle-stroke-color":new vt(X.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new vt(X.paint_circle["circle-stroke-opacity"])})},get layout(){return ev=ev||new mn({"circle-sort-key":new vt(X.layout_circle["circle-sort-key"])})}};class ZC extends Qr{constructor(t){super(t,HC)}createBucket(t){return new Ng(t)}queryRadius(t){let r=t;return dh("circle-radius",this,r)+dh("circle-stroke-width",this,r)+rf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:d,geometry:f,transform:_,pixelsToTileUnits:y,unwrappedTileID:b,getElevation:w}){let S=of(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,y),P=this.paint.get("circle-radius").evaluate(r,d)+this.paint.get("circle-stroke-width").evaluate(r,d),A=this.paint.get("circle-pitch-alignment")==="map",O=A?S:function(B,U,W,ie){return B.map(pe=>iv(pe,U,W,ie))}(S,_,b,w),z=A?P*y:P;for(let B of f)for(let U of B){let W=A?U:iv(U,_,b,w),ie=z,pe=_.projectTileCoordinates(U.x,U.y,b,w).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ie*=pe/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ie*=_.cameraToCenterDistance/pe),jC(O,W,ie))return!0}return!1}}function iv(o,t,r,d){let f=t.projectTileCoordinates(o.x,o.y,r,d).point;return new $e((.5*f.x+.5)*t.width,(.5*-f.y+.5)*t.height)}class nv extends Ng{}let rv;tt("HeatmapBucket",nv,{omit:["layers"]});var qC={get paint(){return rv=rv||new mn({"heatmap-radius":new vt(X.paint_heatmap["heatmap-radius"]),"heatmap-weight":new vt(X.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new dt(X.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nh(X.paint_heatmap["heatmap-color"]),"heatmap-opacity":new dt(X.paint_heatmap["heatmap-opacity"])})}};function Ug(o,{width:t,height:r},d,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*r*d)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*r*d}`)}else f=new Uint8Array(t*r*d);return o.width=t,o.height=r,o.data=f,o}function ov(o,{width:t,height:r},d){if(t===o.width&&r===o.height)return;let f=Ug({},{width:t,height:r},d);$g(o,f,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,t),height:Math.min(o.height,r)},d),o.width=t,o.height=r,o.data=f.data}function $g(o,t,r,d,f,_){if(f.width===0||f.height===0)return t;if(f.width>o.width||f.height>o.height||r.x>o.width-f.width||r.y>o.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||d.x>t.width-f.width||d.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");let y=o.data,b=t.data;if(y===b)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<f.height;w++){let S=((r.y+w)*o.width+r.x)*_,P=((d.y+w)*t.width+d.x)*_;for(let A=0;A<f.width*_;A++)b[P+A]=y[S+A]}return t}class uh{constructor(t,r){Ug(this,t,1,r)}resize(t){ov(this,t,1)}clone(){return new uh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,d,f,_){$g(t,r,d,f,_,1)}}class mo{constructor(t,r){Ug(this,t,4,r)}resize(t){ov(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new mo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,d,f,_){$g(t,r,d,f,_,4)}}function sv(o){let t={},r=o.resolution||256,d=o.clips?o.clips.length:1,f=o.image||new mo({width:r,height:d});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);let _=(y,b,w)=>{t[o.evaluationKey]=w;let S=o.expression.evaluate(t);f.data[y+b+0]=Math.floor(255*S.r/S.a),f.data[y+b+1]=Math.floor(255*S.g/S.a),f.data[y+b+2]=Math.floor(255*S.b/S.a),f.data[y+b+3]=Math.floor(255*S.a)};if(o.clips)for(let y=0,b=0;y<d;++y,b+=4*r)for(let w=0,S=0;w<r;w++,S+=4){let P=w/(r-1),{start:A,end:O}=o.clips[y];_(b,S,A*(1-P)+O*P)}else for(let y=0,b=0;y<r;y++,b+=4)_(0,b,y/(r-1));return f}tt("AlphaImage",uh),tt("RGBAImage",mo);let Gg="big-fb";class WC extends Qr{createBucket(t){return new nv(t)}constructor(t){super(t,qC),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=sv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Gg)&&this.heatmapFbos.delete(Gg)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let av;var XC={get paint(){return av=av||new mn({"hillshade-illumination-direction":new dt(X.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new dt(X.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new dt(X.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new dt(X.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new dt(X.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new dt(X.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new dt(X.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new dt(X.paint_hillshade["hillshade-method"])})}};class YC extends Qr{constructor(t){super(t,XC),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,r=this.paint.get("hillshade-illumination-altitude").values,d=this.paint.get("hillshade-highlight-color").values,f=this.paint.get("hillshade-shadow-color").values,_=Math.max(t.length,r.length,d.length,f.length);t=t.concat(Array(_-t.length).fill(t.at(-1))),r=r.concat(Array(_-r.length).fill(r.at(-1))),d=d.concat(Array(_-d.length).fill(d.at(-1))),f=f.concat(Array(_-f.length).fill(f.at(-1)));let y=r.map(Xt);return{directionRadians:t.map(Xt),altitudeRadians:y,shadowColor:f,highlightColor:d}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let KC=Hi([{name:"a_pos",components:2,type:"Int16"}],4),{members:QC}=KC;function Hg(o,t,r){let d=r.patternDependencies,f=!1;for(let _ of t){let y=_.paint.get(`${o}-pattern`);y.isConstant()||(f=!0);let b=y.constantOr(null);b&&(f=!0,d[b.to]=!0,d[b.from]=!0)}return f}function Zg(o,t,r,d,f){let _=f.patternDependencies;for(let y of t){let b=y.paint.get(`${o}-pattern`).value;if(b.kind!=="constant"){let w=b.evaluate({zoom:d-1},r,{},f.availableImages),S=b.evaluate({zoom:d},r,{},f.availableImages),P=b.evaluate({zoom:d+1},r,{},f.availableImages);w=w&&w.name?w.name:w,S=S&&S.name?S.name:S,P=P&&P.name?P.name:P,_[w]=!0,_[S]=!0,_[P]=!0,r.patterns[y.id]={min:w,mid:S,max:P}}}return r}function lv(o,t,r,d,f){let _;if(f===function(y,b,w,S){let P=0;for(let A=b,O=w-S;A<w;A+=S)P+=(y[O]-y[A])*(y[A+1]+y[O+1]),O=A;return P}(o,t,r,d)>0)for(let y=t;y<r;y+=d)_=hv(y/d|0,o[y],o[y+1],_);else for(let y=r-d;y>=t;y-=d)_=hv(y/d|0,o[y],o[y+1],_);return _&&$d(_,_.next)&&(mh(_),_=_.next),_}function Nc(o,t){if(!o)return o;t||(t=o);let r,d=o;do if(r=!1,d.steiner||!$d(d,d.next)&&cn(d.prev,d,d.next)!==0)d=d.next;else{if(mh(d),d=t=d.prev,d===d.next)break;r=!0}while(r||d!==t);return t}function hh(o,t,r,d,f,_,y){if(!o)return;!y&&_&&function(w,S,P,A){let O=w;do O.z===0&&(O.z=qg(O.x,O.y,S,P,A)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==w);O.prevZ.nextZ=null,O.prevZ=null,function(z){let B,U=1;do{let W,ie=z;z=null;let pe=null;for(B=0;ie;){B++;let oe=ie,L=0;for(let ae=0;ae<U&&(L++,oe=oe.nextZ,oe);ae++);let q=U;for(;L>0||q>0&&oe;)L!==0&&(q===0||!oe||ie.z<=oe.z)?(W=ie,ie=ie.nextZ,L--):(W=oe,oe=oe.nextZ,q--),pe?pe.nextZ=W:z=W,W.prevZ=pe,pe=W;ie=oe}pe.nextZ=null,U*=2}while(B>1)}(O)}(o,d,f,_);let b=o;for(;o.prev!==o.next;){let w=o.prev,S=o.next;if(_?e2(o,d,f,_):JC(o))t.push(w.i,o.i,S.i),mh(o),o=S.next,b=S.next;else if((o=S)===b){y?y===1?hh(o=t2(Nc(o),t),t,r,d,f,_,2):y===2&&i2(o,t,r,d,f,_):hh(Nc(o),t,r,d,f,_,1);break}}}function JC(o){let t=o.prev,r=o,d=o.next;if(cn(t,r,d)>=0)return!1;let f=t.x,_=r.x,y=d.x,b=t.y,w=r.y,S=d.y,P=Math.min(f,_,y),A=Math.min(b,w,S),O=Math.max(f,_,y),z=Math.max(b,w,S),B=d.next;for(;B!==t;){if(B.x>=P&&B.x<=O&&B.y>=A&&B.y<=z&&ph(f,b,_,w,y,S,B.x,B.y)&&cn(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function e2(o,t,r,d){let f=o.prev,_=o,y=o.next;if(cn(f,_,y)>=0)return!1;let b=f.x,w=_.x,S=y.x,P=f.y,A=_.y,O=y.y,z=Math.min(b,w,S),B=Math.min(P,A,O),U=Math.max(b,w,S),W=Math.max(P,A,O),ie=qg(z,B,t,r,d),pe=qg(U,W,t,r,d),oe=o.prevZ,L=o.nextZ;for(;oe&&oe.z>=ie&&L&&L.z<=pe;){if(oe.x>=z&&oe.x<=U&&oe.y>=B&&oe.y<=W&&oe!==f&&oe!==y&&ph(b,P,w,A,S,O,oe.x,oe.y)&&cn(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,L.x>=z&&L.x<=U&&L.y>=B&&L.y<=W&&L!==f&&L!==y&&ph(b,P,w,A,S,O,L.x,L.y)&&cn(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;oe&&oe.z>=ie;){if(oe.x>=z&&oe.x<=U&&oe.y>=B&&oe.y<=W&&oe!==f&&oe!==y&&ph(b,P,w,A,S,O,oe.x,oe.y)&&cn(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;L&&L.z<=pe;){if(L.x>=z&&L.x<=U&&L.y>=B&&L.y<=W&&L!==f&&L!==y&&ph(b,P,w,A,S,O,L.x,L.y)&&cn(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function t2(o,t){let r=o;do{let d=r.prev,f=r.next.next;!$d(d,f)&&dv(d,r,r.next,f)&&fh(d,f)&&fh(f,d)&&(t.push(d.i,r.i,f.i),mh(r),mh(r.next),r=o=f),r=r.next}while(r!==o);return Nc(r)}function i2(o,t,r,d,f,_){let y=o;do{let b=y.next.next;for(;b!==y.prev;){if(y.i!==b.i&&a2(y,b)){let w=uv(y,b);return y=Nc(y,y.next),w=Nc(w,w.next),hh(y,t,r,d,f,_,0),void hh(w,t,r,d,f,_,0)}b=b.next}y=y.next}while(y!==o)}function n2(o,t){let r=o.x-t.x;return r===0&&(r=o.y-t.y,r===0)&&(r=(o.next.y-o.y)/(o.next.x-o.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function r2(o,t){let r=function(f,_){let y=_,b=f.x,w=f.y,S,P=-1/0;if($d(f,y))return y;do{if($d(f,y.next))return y.next;if(w<=y.y&&w>=y.next.y&&y.next.y!==y.y){let U=y.x+(w-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(U<=b&&U>P&&(P=U,S=y.x<y.next.x?y:y.next,U===b))return S}y=y.next}while(y!==_);if(!S)return null;let A=S,O=S.x,z=S.y,B=1/0;y=S;do{if(b>=y.x&&y.x>=O&&b!==y.x&&cv(w<z?b:P,w,O,z,w<z?P:b,w,y.x,y.y)){let U=Math.abs(w-y.y)/(b-y.x);fh(y,f)&&(U<B||U===B&&(y.x>S.x||y.x===S.x&&o2(S,y)))&&(S=y,B=U)}y=y.next}while(y!==A);return S}(o,t);if(!r)return t;let d=uv(r,o);return Nc(d,d.next),Nc(r,r.next)}function o2(o,t){return cn(o.prev,o,t.prev)<0&&cn(t.next,o,o.next)<0}function qg(o,t,r,d,f){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-r)*f|0)|o<<8))|o<<4))|o<<2))|o<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-d)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function s2(o){let t=o,r=o;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==o);return r}function cv(o,t,r,d,f,_,y,b){return(f-y)*(t-b)>=(o-y)*(_-b)&&(o-y)*(d-b)>=(r-y)*(t-b)&&(r-y)*(_-b)>=(f-y)*(d-b)}function ph(o,t,r,d,f,_,y,b){return!(o===y&&t===b)&&cv(o,t,r,d,f,_,y,b)}function a2(o,t){return o.next.i!==t.i&&o.prev.i!==t.i&&!function(r,d){let f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==d.i&&f.next.i!==d.i&&dv(f,f.next,r,d))return!0;f=f.next}while(f!==r);return!1}(o,t)&&(fh(o,t)&&fh(t,o)&&function(r,d){let f=r,_=!1,y=(r.x+d.x)/2,b=(r.y+d.y)/2;do f.y>b!=f.next.y>b&&f.next.y!==f.y&&y<(f.next.x-f.x)*(b-f.y)/(f.next.y-f.y)+f.x&&(_=!_),f=f.next;while(f!==r);return _}(o,t)&&(cn(o.prev,o,t.prev)||cn(o,t.prev,t))||$d(o,t)&&cn(o.prev,o,o.next)>0&&cn(t.prev,t,t.next)>0)}function cn(o,t,r){return(t.y-o.y)*(r.x-t.x)-(t.x-o.x)*(r.y-t.y)}function $d(o,t){return o.x===t.x&&o.y===t.y}function dv(o,t,r,d){let f=af(cn(o,t,r)),_=af(cn(o,t,d)),y=af(cn(r,d,o)),b=af(cn(r,d,t));return f!==_&&y!==b||!(f!==0||!sf(o,r,t))||!(_!==0||!sf(o,d,t))||!(y!==0||!sf(r,o,d))||!(b!==0||!sf(r,t,d))}function sf(o,t,r){return t.x<=Math.max(o.x,r.x)&&t.x>=Math.min(o.x,r.x)&&t.y<=Math.max(o.y,r.y)&&t.y>=Math.min(o.y,r.y)}function af(o){return o>0?1:o<0?-1:0}function fh(o,t){return cn(o.prev,o,o.next)<0?cn(o,t,o.next)>=0&&cn(o,o.prev,t)>=0:cn(o,t,o.prev)<0||cn(o,o.next,t)<0}function uv(o,t){let r=Wg(o.i,o.x,o.y),d=Wg(t.i,t.x,t.y),f=o.next,_=t.prev;return o.next=t,t.prev=o,r.next=f,f.prev=r,d.next=r,r.prev=d,_.next=d,d.prev=_,d}function hv(o,t,r,d){let f=Wg(o,t,r);return d?(f.next=d.next,f.prev=d,d.next.prev=f,d.next=f):(f.prev=f,f.next=f),f}function mh(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Wg(o,t,r){return{i:o,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Gd{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class lf{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}lf.noSubdivision=new lf({fill:new Gd(0,0),line:new Gd(0,0),tile:new Gd(0,0),stencil:new Gd(0,0),circle:1}),tt("SubdivisionGranularityExpression",Gd),tt("SubdivisionGranularitySetting",lf);let Hd=-32768,gh=32767;class l2{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=ci/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|(r+=32768)<<0}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");let d=0|Math.round(t),f=0|Math.round(r),_=this._getKey(d,f);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);let y=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,y),this._vertexBuffer.push(d,f),y}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(f,_){let y=[];for(let b=0;b<_.length;b+=3){let w=_[b],S=_[b+1],P=_[b+2],A=f[2*w],O=f[2*w+1];(f[2*S]-A)*(f[2*P+1]-O)-(f[2*S+1]-O)*(f[2*P]-A)>0?(y.push(w),y.push(P),y.push(S)):(y.push(w),y.push(S),y.push(P))}return y}(this._vertexBuffer,t);let r=[],d=t.length;for(let f=0;f<d;f+=3){let _=[t[f+0],t[f+1],t[f+2]],y=[this._vertexBuffer[2*t[f+0]+0],this._vertexBuffer[2*t[f+0]+1],this._vertexBuffer[2*t[f+1]+0],this._vertexBuffer[2*t[f+1]+1],this._vertexBuffer[2*t[f+2]+0],this._vertexBuffer[2*t[f+2]+1]],b=1/0,w=1/0,S=-1/0,P=-1/0;for(let U=0;U<3;U++){let W=y[2*U],ie=y[2*U+1];b=Math.min(b,W),S=Math.max(S,W),w=Math.min(w,ie),P=Math.max(P,ie)}if(b===S||w===P)continue;let A=Math.floor(b/this._granularityCellSize),O=Math.ceil(S/this._granularityCellSize),z=Math.floor(w/this._granularityCellSize),B=Math.ceil(P/this._granularityCellSize);if(A!==O||z!==B)for(let U=z;U<B;U++){let W=this._scanlineGenerateVertexRingForCellRow(U,y,_);c2(this._vertexBuffer,W,r)}else r.push(..._)}return r}_scanlineGenerateVertexRingForCellRow(t,r,d){let f=t*this._granularityCellSize,_=f+this._granularityCellSize,y=[];for(let b=0;b<3;b++){let w=r[2*b],S=r[2*b+1],P=r[2*(b+1)%6],A=r[(2*(b+1)+1)%6],O=r[2*(b+2)%6],z=r[(2*(b+2)+1)%6],B=P-w,U=A-S,W=B===0,ie=U===0,pe=(f-S)/U,oe=(_-S)/U,L=Math.min(pe,oe),q=Math.max(pe,oe);if(!ie&&(L>=1||q<=0)||ie&&(S<f||S>_)){A>=f&&A<=_&&y.push(d[(b+1)%3]);continue}!ie&&L>0&&y.push(this._vertexToIndex(w+B*L,S+U*L));let ae=w+B*Math.max(L,0),Te=w+B*Math.min(q,1);W||this._generateIntraEdgeVertices(y,w,S,P,A,ae,Te),!ie&&q<1&&y.push(this._vertexToIndex(w+B*q,S+U*q)),(ie||A>=f&&A<=_)&&y.push(d[(b+1)%3]),!ie&&(A<=f||A>=_)&&this._generateInterEdgeVertices(y,w,S,P,A,O,z,Te,f,_)}return y}_generateIntraEdgeVertices(t,r,d,f,_,y,b){let w=f-r,S=_-d,P=S===0,A=P?Math.min(r,f):Math.min(y,b),O=P?Math.max(r,f):Math.max(y,b),z=Math.floor(A/this._granularityCellSize)+1,B=Math.ceil(O/this._granularityCellSize)-1;if(P?r<f:y<b)for(let U=z;U<=B;U++){let W=U*this._granularityCellSize;t.push(this._vertexToIndex(W,d+S*(W-r)/w))}else for(let U=B;U>=z;U--){let W=U*this._granularityCellSize;t.push(this._vertexToIndex(W,d+S*(W-r)/w))}}_generateInterEdgeVertices(t,r,d,f,_,y,b,w,S,P){let A=_-d,O=y-f,z=b-_,B=(S-_)/z,U=(P-_)/z,W=Math.min(B,U),ie=Math.max(B,U),pe=f+O*W,oe=Math.floor(Math.min(pe,w)/this._granularityCellSize)+1,L=Math.ceil(Math.max(pe,w)/this._granularityCellSize)-1,q=w<pe,ae=z===0;if(ae&&(b===S||b===P))return;if(ae||W>=1||ie<=0){let Ve=d-b,Ie=y+(r-y)*Math.min((S-b)/Ve,(P-b)/Ve);oe=Math.floor(Math.min(Ie,w)/this._granularityCellSize)+1,L=Math.ceil(Math.max(Ie,w)/this._granularityCellSize)-1,q=w<Ie}let Te=A>0?P:S;if(q)for(let Ve=oe;Ve<=L;Ve++)t.push(this._vertexToIndex(Ve*this._granularityCellSize,Te));else for(let Ve=L;Ve>=oe;Ve--)t.push(this._vertexToIndex(Ve*this._granularityCellSize,Te))}_generateOutline(t){let r=[];for(let d of t){let f=Vc(d,this._granularity,!0),_=this._pointArrayToIndices(f),y=[];for(let b=1;b<_.length;b++)y.push(_[b-1]),y.push(_[b]);r.push(y)}return r}_handlePoles(t){let r=!1,d=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(d=!0)),(r||d)&&this._fillPoles(t,r,d)}_ensureNoPoleVertices(){let t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){let d=t[r+1];d===Hd&&(t[r+1]=-32767),d===gh&&(t[r+1]=32766)}}_generatePoleQuad(t,r,d,f,_,y){f>_!=(y===Hd)?(t.push(r),t.push(d),t.push(this._vertexToIndex(f,y)),t.push(d),t.push(this._vertexToIndex(_,y)),t.push(this._vertexToIndex(f,y))):(t.push(d),t.push(r),t.push(this._vertexToIndex(f,y)),t.push(this._vertexToIndex(_,y)),t.push(d),t.push(this._vertexToIndex(f,y)))}_fillPoles(t,r,d){let f=this._vertexBuffer,_=ci,y=t.length;for(let b=2;b<y;b+=3){let w=t[b-2],S=t[b-1],P=t[b],A=f[2*w],O=f[2*w+1],z=f[2*S],B=f[2*S+1],U=f[2*P],W=f[2*P+1];r&&(O===0&&B===0&&this._generatePoleQuad(t,w,S,A,z,Hd),B===0&&W===0&&this._generatePoleQuad(t,S,P,z,U,Hd),W===0&&O===0&&this._generatePoleQuad(t,P,w,U,A,Hd)),d&&(O===_&&B===_&&this._generatePoleQuad(t,w,S,A,z,gh),B===_&&W===_&&this._generatePoleQuad(t,S,P,z,U,gh),W===_&&O===_&&this._generatePoleQuad(t,P,w,U,A,gh))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;let{flattened:d,holeIndices:f}=function(b){let w=[],S=[];for(let P of b)if(P.length!==0){P!==b[0]&&w.push(S.length/2);for(let A=0;A<P.length;A++)S.push(P[A].x),S.push(P[A].y)}return{flattened:S,holeIndices:w}}(t),_;this._initializeVertices(d);try{let b=function(S,P,A=2){let O=P&&P.length,z=O?P[0]*A:S.length,B=lv(S,0,z,A,!0),U=[];if(!B||B.next===B.prev)return U;let W,ie,pe;if(O&&(B=function(oe,L,q,ae){let Te=[];for(let Ve=0,Ie=L.length;Ve<Ie;Ve++){let Fe=lv(oe,L[Ve]*ae,Ve<Ie-1?L[Ve+1]*ae:oe.length,ae,!1);Fe===Fe.next&&(Fe.steiner=!0),Te.push(s2(Fe))}Te.sort(n2);for(let Ve=0;Ve<Te.length;Ve++)q=r2(Te[Ve],q);return q}(S,P,B,A)),S.length>80*A){W=1/0,ie=1/0;let oe=-1/0,L=-1/0;for(let q=A;q<z;q+=A){let ae=S[q],Te=S[q+1];ae<W&&(W=ae),Te<ie&&(ie=Te),ae>oe&&(oe=ae),Te>L&&(L=Te)}pe=Math.max(oe-W,L-ie),pe=pe!==0?32767/pe:0}return hh(B,U,A,W,ie,pe,0),U}(d,f),w=this._convertIndices(d,b);_=this._subdivideTrianglesScanline(w)}catch(b){console.error(b)}let y=[];return r&&(y=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:y}}_convertIndices(t,r){let d=[];for(let f=0;f<r.length;f++)d.push(this._vertexToIndex(t[2*r[f]],t[2*r[f]+1]));return d}_pointArrayToIndices(t){let r=[];for(let d=0;d<t.length;d++){let f=t[d];r.push(this._vertexToIndex(f.x,f.y))}return r}}function pv(o,t,r,d=!0){return new l2(r,t).subdividePolygonInternal(o,d)}function Vc(o,t,r=!1){if(!o||o.length<1)return[];if(o.length<2)return[];let d=o[0],f=o[o.length-1],_=r&&(d.x!==f.x||d.y!==f.y);if(t<2)return _?[...o,o[0]]:[...o];let y=Math.floor(ci/t),b=[];b.push(new $e(o[0].x,o[0].y));let w=o.length,S=_?w:w-1;for(let P=0;P<S;P++){let A=o[P],O=P<w-1?o[P+1]:o[0],z=A.x,B=A.y,U=O.x,W=O.y,ie=z!==U,pe=B!==W;if(!ie&&!pe)continue;let oe=U-z,L=W-B,q=Math.abs(oe),ae=Math.abs(L),Te=z,Ve=B;for(;;){let Fe=oe>0?(Math.floor(Te/y)+1)*y:(Math.ceil(Te/y)-1)*y,He=L>0?(Math.floor(Ve/y)+1)*y:(Math.ceil(Ve/y)-1)*y,je=Math.abs(Te-Fe),Ze=Math.abs(Ve-He),ze=Math.abs(Te-U),nt=Math.abs(Ve-W),gt=ie?je/q:Number.POSITIVE_INFINITY,pt=pe?Ze/ae:Number.POSITIVE_INFINITY;if((ze<=je||!ie)&&(nt<=Ze||!pe))break;if(gt<pt&&ie||!pe){Te=Fe,Ve+=L*gt;let at=new $e(Te,Math.round(Ve));b[b.length-1].x===at.x&&b[b.length-1].y===at.y||b.push(at)}else{Te+=oe*pt,Ve=He;let at=new $e(Math.round(Te),Ve);b[b.length-1].x===at.x&&b[b.length-1].y===at.y||b.push(at)}}let Ie=new $e(U,W);b[b.length-1].x===Ie.x&&b[b.length-1].y===Ie.y||b.push(Ie)}return b}function c2(o,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let d=0,f=o[2*t[0]];for(let w=1;w<t.length;w++){let S=o[2*t[w]];S<f&&(f=S,d=w)}let _=t.length,y=d,b=(y+1)%_;for(;;){let w=y-1>=0?y-1:_-1,S=(b+1)%_,P=o[2*t[w]],A=o[2*t[S]],O=o[2*t[y]],z=o[2*t[y]+1],B=o[2*t[b]+1],U=!1;if(P<A)U=!0;else if(P>A)U=!1;else{let W=B-z,ie=-(o[2*t[b]]-O),pe=z<B?1:-1;((P-O)*W+(o[2*t[w]+1]-z)*ie)*pe>((A-O)*W+(o[2*t[S]+1]-z)*ie)*pe&&(U=!0)}if(U){let W=t[w],ie=t[y],pe=t[b];W!==ie&&W!==pe&&ie!==pe&&r.push(pe,ie,W),y--,y<0&&(y=_-1)}else{let W=t[S],ie=t[y],pe=t[b];W!==ie&&W!==pe&&ie!==pe&&r.push(pe,ie,W),b++,b>=_&&(b=0)}if(w===S)break}}function fv(o,t,r,d,f,_,y,b,w){let S=f.length/2,P=y&&b&&w;if(S<ui.MAX_VERTEX_ARRAY_LENGTH){let A=t.prepareSegment(S,r,d),O=A.vertexLength;for(let U=0;U<_.length;U+=3)d.emplaceBack(O+_[U],O+_[U+1],O+_[U+2]);let z,B;A.vertexLength+=S,A.primitiveLength+=_.length/3,P&&(B=y.prepareSegment(S,r,b),z=B.vertexLength,B.vertexLength+=S);for(let U=0;U<f.length;U+=2)o(f[U],f[U+1]);if(P)for(let U=0;U<w.length;U++){let W=w[U];for(let ie=1;ie<W.length;ie+=2)b.emplaceBack(z+W[ie-1],z+W[ie]);B.primitiveLength+=W.length/2}}else(function(A,O,z,B,U,W){let ie=[];for(let ae=0;ae<B.length/2;ae++)ie.push(-1);let pe={count:0},oe=0,L=A.getOrCreateLatestSegment(O,z),q=L.vertexLength;for(let ae=2;ae<U.length;ae+=3){let Te=U[ae-2],Ve=U[ae-1],Ie=U[ae],Fe=ie[Te]<oe,He=ie[Ve]<oe,je=ie[Ie]<oe;L.vertexLength+((Fe?1:0)+(He?1:0)+(je?1:0))>ui.MAX_VERTEX_ARRAY_LENGTH&&(L=A.createNewSegment(O,z),oe=pe.count,Fe=!0,He=!0,je=!0,q=0);let Ze=_h(ie,B,W,pe,Te,Fe,L),ze=_h(ie,B,W,pe,Ve,He,L),nt=_h(ie,B,W,pe,Ie,je,L);z.emplaceBack(q+Ze-oe,q+ze-oe,q+nt-oe),L.primitiveLength++}})(t,r,d,f,_,o),P&&function(A,O,z,B,U,W){let ie=[];for(let ae=0;ae<B.length/2;ae++)ie.push(-1);let pe={count:0},oe=0,L=A.getOrCreateLatestSegment(O,z),q=L.vertexLength;for(let ae=0;ae<U.length;ae++){let Te=U[ae];for(let Ve=1;Ve<U[ae].length;Ve+=2){let Ie=Te[Ve-1],Fe=Te[Ve],He=ie[Ie]<oe,je=ie[Fe]<oe;L.vertexLength+((He?1:0)+(je?1:0))>ui.MAX_VERTEX_ARRAY_LENGTH&&(L=A.createNewSegment(O,z),oe=pe.count,He=!0,je=!0,q=0);let Ze=_h(ie,B,W,pe,Ie,He,L),ze=_h(ie,B,W,pe,Fe,je,L);z.emplaceBack(q+Ze-oe,q+ze-oe),L.primitiveLength++}}}(y,r,b,f,w,o),t.forceNewSegmentOnNextPrepare(),y?.forceNewSegmentOnNextPrepare()}function _h(o,t,r,d,f,_,y){if(_){let b=d.count;return r(t[2*f],t[2*f+1]),o[f]=d.count,d.count++,y.vertexLength++,b}return o[f]}class Xg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Xe,this.indexArray=new di,this.indexArray2=new En,this.programConfigurations=new Ws(t.layers,t.zoom),this.segments=new ui,this.segments2=new ui,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){this.hasPattern=Hg("fill",this.layers,r);let f=this.layers[0].layout.get("fill-sort-key"),_=!f.isConstant(),y=[];for(let{feature:b,id:w,index:S,sourceLayerIndex:P}of t){let A=this.layers[0]._featureFilter.needGeometry,O=zc(b,A);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),O,d))continue;let z=_?f.evaluate(O,{},d,r.availableImages):void 0,B={id:w,properties:b.properties,type:b.type,sourceLayerIndex:P,index:S,geometry:A?O.geometry:Lc(b),patterns:{},sortKey:z};y.push(B)}_&&y.sort((b,w)=>b.sortKey-w.sortKey);for(let b of y){let{geometry:w,index:S,sourceLayerIndex:P}=b;if(this.hasPattern){let A=Zg("fill",this.layers,b,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(b,w,S,d,{},r.subdivisionGranularity);r.featureIndex.insert(t[S].feature,w,S,P,this.index)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}addFeatures(t,r,d){for(let f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,r,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,QC),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,d,f,_,y){for(let b of wa(r,500)){let w=pv(b,f,y.fill.getGranularityForZoomLevel(f.z)),S=this.layoutVertexArray;fv((P,A)=>{S.emplaceBack(P,A)},this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,_,f)}}let mv,gv;tt("FillBucket",Xg,{omit:["layers","patternFeatures"]});var d2={get paint(){return gv=gv||new mn({"fill-antialias":new dt(X.paint_fill["fill-antialias"]),"fill-opacity":new vt(X.paint_fill["fill-opacity"]),"fill-color":new vt(X.paint_fill["fill-color"]),"fill-outline-color":new vt(X.paint_fill["fill-outline-color"]),"fill-translate":new dt(X.paint_fill["fill-translate"]),"fill-translate-anchor":new dt(X.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ac(X.paint_fill["fill-pattern"])})},get layout(){return mv=mv||new mn({"fill-sort-key":new vt(X.layout_fill["fill-sort-key"])})}};class u2 extends Qr{constructor(t){super(t,d2)}recalculate(t,r){super.recalculate(t,r);let d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Xg(t)}queryRadius(){return rf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:d,pixelsToTileUnits:f}){return Ky(of(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-d.bearingInRadians,f),r)}isTileClipped(){return!0}}let h2=Hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),p2=Hi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:f2}=h2;var Yg,_v,Kg,yv,Qg,vv,bv,cf={};function xv(){if(_v)return Yg;_v=1;var o=Ce();function t(f,_,y,b,w){this.properties={},this.extent=y,this.type=0,this._pbf=f,this._geometry=-1,this._keys=b,this._values=w,f.readFields(r,this,_)}function r(f,_,y){f==1?_.id=y.readVarint():f==2?function(b,w){for(var S=b.readVarint()+b.pos;b.pos<S;){var P=w._keys[b.readVarint()],A=w._values[b.readVarint()];w.properties[P]=A}}(y,_):f==3?_.type=y.readVarint():f==4&&(_._geometry=y.pos)}function d(f){for(var _,y,b=0,w=0,S=f.length,P=S-1;w<S;P=w++)b+=((y=f[P]).x-(_=f[w]).x)*(_.y+y.y);return b}return Yg=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var _,y=f.readVarint()+f.pos,b=1,w=0,S=0,P=0,A=[];f.pos<y;){if(w<=0){var O=f.readVarint();b=7&O,w=O>>3}if(w--,b===1||b===2)S+=f.readSVarint(),P+=f.readSVarint(),b===1&&(_&&A.push(_),_=[]),_.push(new o(S,P));else{if(b!==7)throw new Error("unknown command "+b);_&&_.push(_[0].clone())}}return _&&A.push(_),A},t.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var _=f.readVarint()+f.pos,y=1,b=0,w=0,S=0,P=1/0,A=-1/0,O=1/0,z=-1/0;f.pos<_;){if(b<=0){var B=f.readVarint();y=7&B,b=B>>3}if(b--,y===1||y===2)(w+=f.readSVarint())<P&&(P=w),w>A&&(A=w),(S+=f.readSVarint())<O&&(O=S),S>z&&(z=S);else if(y!==7)throw new Error("unknown command "+y)}return[P,O,A,z]},t.prototype.toGeoJSON=function(f,_,y){var b,w,S=this.extent*Math.pow(2,y),P=this.extent*f,A=this.extent*_,O=this.loadGeometry(),z=t.types[this.type];function B(ie){for(var pe=0;pe<ie.length;pe++){var oe=ie[pe];ie[pe]=[360*(oe.x+P)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+A)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(b=0;b<O.length;b++)U[b]=O[b][0];B(O=U);break;case 2:for(b=0;b<O.length;b++)B(O[b]);break;case 3:for(O=function(ie){var pe=ie.length;if(pe<=1)return[ie];for(var oe,L,q=[],ae=0;ae<pe;ae++){var Te=d(ie[ae]);Te!==0&&(L===void 0&&(L=Te<0),L===Te<0?(oe&&q.push(oe),oe=[ie[ae]]):oe.push(ie[ae]))}return oe&&q.push(oe),q}(O),b=0;b<O.length;b++)for(w=0;w<O[b].length;w++)B(O[b][w])}O.length===1?O=O[0]:z="Multi"+z;var W={type:"Feature",geometry:{type:z,coordinates:O},properties:this.properties};return"id"in this&&(W.id=this.id),W},Yg}function wv(){if(yv)return Kg;yv=1;var o=xv();function t(d,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(r,this,f),this.length=this._features.length}function r(d,f,_){d===15?f.version=_.readVarint():d===1?f.name=_.readString():d===5?f.extent=_.readVarint():d===2?f._features.push(_.pos):d===3?f._keys.push(_.readString()):d===4&&f._values.push(function(y){for(var b=null,w=y.readVarint()+y.pos;y.pos<w;){var S=y.readVarint()>>3;b=S===1?y.readString():S===2?y.readFloat():S===3?y.readDouble():S===4?y.readVarint64():S===5?y.readVarint():S===6?y.readSVarint():S===7?y.readBoolean():null}return b}(_))}return Kg=t,t.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var f=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,f,this.extent,this._keys,this._values)},Kg}function Cv(){return bv||(bv=1,cf.VectorTile=function(){if(vv)return Qg;vv=1;var o=wv();function t(r,d,f){if(r===3){var _=new o(f,f.readVarint()+f.pos);_.length&&(d[_.name]=_)}}return Qg=function(r,d){this.layers=r.readFields(t,{},d)},Qg}(),cf.VectorTileFeature=xv(),cf.VectorTileLayer=wv()),cf}var yh=T(Cv());let m2=yh.VectorTileFeature.types,Jg=Math.pow(2,13);function vh(o,t,r,d,f,_,y,b){o.emplaceBack(t,r,2*Math.floor(d*Jg)+y,f*Jg*2,_*Jg*2,Math.round(b))}class e_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ue,this.centroidVertexArray=new Re,this.indexArray=new di,this.programConfigurations=new Ws(t.layers,t.zoom),this.segments=new ui,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){this.features=[],this.hasPattern=Hg("fill-extrusion",this.layers,r);for(let{feature:f,id:_,index:y,sourceLayerIndex:b}of t){let w=this.layers[0]._featureFilter.needGeometry,S=zc(f,w);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),S,d))continue;let P={id:_,sourceLayerIndex:b,index:y,geometry:w?S.geometry:Lc(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Zg("fill-extrusion",this.layers,P,this.zoom,r)):this.addFeature(P,P.geometry,y,d,{},r.subdivisionGranularity),r.featureIndex.insert(f,P.geometry,y,b,this.index,!0)}}addFeatures(t,r,d){for(let f of this.features){let{geometry:_}=f;this.addFeature(f,_,f.index,r,d,t.subdivisionGranularity)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,f2),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,p2.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,d,f,_,y){for(let b of wa(r,500)){let w={x:0,y:0,sampleCount:0},S=this.layoutVertexArray.length;this.processPolygon(w,f,t,b,y);let P=this.layoutVertexArray.length-S,A=Math.floor(w.x/w.sampleCount),O=Math.floor(w.y/w.sampleCount);for(let z=0;z<P;z++)this.centroidVertexArray.emplaceBack(A,O)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,_,f)}processPolygon(t,r,d,f,_){if(f.length<1||Mv(f[0]))return;for(let A of f)A.length!==0&&g2(t,A);let y={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},b=_.fill.getGranularityForZoomLevel(r.z),w=m2[d.type]==="Polygon";for(let A of f){if(A.length===0||Mv(A))continue;let O=Vc(A,b,w);this._generateSideFaces(O,y)}if(!w)return;let S=pv(f,r,b,!1),P=this.layoutVertexArray;fv((A,O)=>{vh(P,A,O,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles)}_generateSideFaces(t,r){let d=0;for(let f=1;f<t.length;f++){let _=t[f],y=t[f-1];if(_2(_,y))continue;r.segment.vertexLength+4>ui.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let b=_.sub(y)._perp()._unit(),w=y.dist(_);d+w>32768&&(d=0),vh(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,0,d),vh(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,1,d),d+=w,vh(this.layoutVertexArray,y.x,y.y,b.x,b.y,0,0,d),vh(this.layoutVertexArray,y.x,y.y,b.x,b.y,0,1,d);let S=r.segment.vertexLength;this.indexArray.emplaceBack(S,S+2,S+1),this.indexArray.emplaceBack(S+1,S+2,S+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function g2(o,t){for(let r=0;r<t.length;r++){let d=t[r];r===t.length-1&&t[0].x===d.x&&t[0].y===d.y||(o.x+=d.x,o.y+=d.y,o.sampleCount++)}}function _2(o,t){return o.x===t.x&&(o.x<0||o.x>ci)||o.y===t.y&&(o.y<0||o.y>ci)}function Mv(o){return o.every(t=>t.x<0)||o.every(t=>t.x>ci)||o.every(t=>t.y<0)||o.every(t=>t.y>ci)}let Sv;tt("FillExtrusionBucket",e_,{omit:["layers","features"]});var y2={get paint(){return Sv=Sv||new mn({"fill-extrusion-opacity":new dt(X["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new vt(X["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new dt(X["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new dt(X["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ac(X["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new vt(X["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new vt(X["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new dt(X["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class v2 extends Qr{constructor(t){super(t,y2)}createBucket(t){return new e_(t)}queryRadius(){return rf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:d,geometry:f,transform:_,pixelsToTileUnits:y,pixelPosMatrix:b}){let w=of(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,y),S=this.paint.get("fill-extrusion-height").evaluate(r,d),P=this.paint.get("fill-extrusion-base").evaluate(r,d),A=function(z,B,U){let W=[];for(let ie of z){let pe=[ie.x,ie.y,0,1];Tt(pe,pe,B),W.push(new $e(pe[0]/pe[3],pe[1]/pe[3]))}return W}(w,b),O=function(z,B,U,W){let ie=[],pe=[],oe=W[8]*B,L=W[9]*B,q=W[10]*B,ae=W[11]*B,Te=W[8]*U,Ve=W[9]*U,Ie=W[10]*U,Fe=W[11]*U;for(let He of z){let je=[],Ze=[];for(let ze of He){let nt=ze.x,gt=ze.y,pt=W[0]*nt+W[4]*gt+W[12],at=W[1]*nt+W[5]*gt+W[13],Yt=W[2]*nt+W[6]*gt+W[14],Qi=W[3]*nt+W[7]*gt+W[15],Pn=Yt+q,rr=Qi+ae,_o=pt+Te,zr=at+Ve,Wn=Yt+Ie,Xi=Qi+Fe,Bn=new $e((pt+oe)/rr,(at+L)/rr);Bn.z=Pn/rr,je.push(Bn);let Xn=new $e(_o/Xi,zr/Xi);Xn.z=Wn/Xi,Ze.push(Xn)}ie.push(je),pe.push(Ze)}return[ie,pe]}(f,P,S,b);return function(z,B,U){let W=1/0;Ky(U,B)&&(W=Tv(U,B[0]));for(let ie=0;ie<B.length;ie++){let pe=B[ie],oe=z[ie];for(let L=0;L<pe.length-1;L++){let q=pe[L],ae=[q,pe[L+1],oe[L+1],oe[L],q];Yy(U,ae)&&(W=Math.min(W,Tv(U,ae)))}}return W!==1/0&&W}(O[0],O[1],A)}}function bh(o,t){return o.x*t.x+o.y*t.y}function Tv(o,t){if(o.length===1){let r=0,d=t[r++],f;for(;!f||d.equals(f);)if(f=t[r++],!f)return 1/0;for(;r<t.length;r++){let _=t[r],y=o[0],b=f.sub(d),w=_.sub(d),S=y.sub(d),P=bh(b,b),A=bh(b,w),O=bh(w,w),z=bh(S,b),B=bh(S,w),U=P*O-A*A,W=(O*z-A*B)/U,ie=(P*B-A*z)/U,pe=d.z*(1-W-ie)+f.z*W+_.z*ie;if(isFinite(pe))return pe}return 1/0}{let r=1/0;for(let d of t)r=Math.min(r,d.z);return r}}let b2=Hi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:x2}=b2,w2=Hi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:C2}=w2,M2=yh.VectorTileFeature.types,S2=Math.cos(Math.PI/180*37.5),Ev=Math.pow(2,14)/.5;class t_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new st,this.layoutVertexArray2=new Ot,this.indexArray=new di,this.programConfigurations=new Ws(t.layers,t.zoom),this.segments=new ui,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){this.hasPattern=Hg("line",this.layers,r);let f=this.layers[0].layout.get("line-sort-key"),_=!f.isConstant(),y=[];for(let{feature:b,id:w,index:S,sourceLayerIndex:P}of t){let A=this.layers[0]._featureFilter.needGeometry,O=zc(b,A);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),O,d))continue;let z=_?f.evaluate(O,{},d):void 0,B={id:w,properties:b.properties,type:b.type,sourceLayerIndex:P,index:S,geometry:A?O.geometry:Lc(b),patterns:{},sortKey:z};y.push(B)}_&&y.sort((b,w)=>b.sortKey-w.sortKey);for(let b of y){let{geometry:w,index:S,sourceLayerIndex:P}=b;if(this.hasPattern){let A=Zg("line",this.layers,b,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(b,w,S,d,{},r.subdivisionGranularity);r.featureIndex.insert(t[S].feature,w,S,P,this.index)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}addFeatures(t,r,d){for(let f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,r,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,C2)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,x2),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,d,f,_,y){let b=this.layers[0].layout,w=b.get("line-join").evaluate(t,{}),S=b.get("line-cap"),P=b.get("line-miter-limit"),A=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(let O of r)this.addLine(O,t,w,S,P,A,f,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,_,f)}addLine(t,r,d,f,_,y,b,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Vc(t,b?w.line.getGranularityForZoomLevel(b.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<t.length-1;oe++)this.totalDistance+=t[oe].dist(t[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let S=M2[r.type]==="Polygon",P=t.length;for(;P>=2&&t[P-1].equals(t[P-2]);)P--;let A=0;for(;A<P-1&&t[A].equals(t[A+1]);)A++;if(P<(S?3:2))return;d==="bevel"&&(_=1.05);let O=this.overscaling<=16?15*ci/(512*this.overscaling):0,z=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray),B,U,W,ie,pe;this.e1=this.e2=-1,S&&(B=t[P-2],pe=t[A].sub(B)._unit()._perp());for(let oe=A;oe<P;oe++){if(W=oe===P-1?S?t[A+1]:void 0:t[oe+1],W&&t[oe].equals(W))continue;pe&&(ie=pe),B&&(U=B),B=t[oe],pe=W?W.sub(B)._unit()._perp():ie,ie=ie||pe;let L=ie.add(pe);L.x===0&&L.y===0||L._unit();let q=ie.x*pe.x+ie.y*pe.y,ae=L.x*pe.x+L.y*pe.y,Te=ae!==0?1/ae:1/0,Ve=2*Math.sqrt(2-2*ae),Ie=ae<S2&&U&&W,Fe=ie.x*pe.y-ie.y*pe.x>0;if(Ie&&oe>A){let Ze=B.dist(U);if(Ze>2*O){let ze=B.sub(B.sub(U)._mult(O/Ze)._round());this.updateDistance(U,ze),this.addCurrentVertex(ze,ie,0,0,z),U=ze}}let He=U&&W,je=He?d:S?"butt":f;if(He&&je==="round"&&(Te<y?je="miter":Te<=2&&(je="fakeround")),je==="miter"&&Te>_&&(je="bevel"),je==="bevel"&&(Te>2&&(je="flipbevel"),Te<_&&(je="miter")),U&&this.updateDistance(U,B),je==="miter")L._mult(Te),this.addCurrentVertex(B,L,0,0,z);else if(je==="flipbevel"){if(Te>100)L=pe.mult(-1);else{let Ze=Te*ie.add(pe).mag()/ie.sub(pe).mag();L._perp()._mult(Ze*(Fe?-1:1))}this.addCurrentVertex(B,L,0,0,z),this.addCurrentVertex(B,L.mult(-1),0,0,z)}else if(je==="bevel"||je==="fakeround"){let Ze=-Math.sqrt(Te*Te-1),ze=Fe?Ze:0,nt=Fe?0:Ze;if(U&&this.addCurrentVertex(B,ie,ze,nt,z),je==="fakeround"){let gt=Math.round(180*Ve/Math.PI/20);for(let pt=1;pt<gt;pt++){let at=pt/gt;if(at!==.5){let Qi=at-.5;at+=at*Qi*(at-1)*((1.0904+q*(q*(3.55645-1.43519*q)-3.2452))*Qi*Qi+(.848013+q*(.215638*q-1.06021)))}let Yt=pe.sub(ie)._mult(at)._add(ie)._unit()._mult(Fe?-1:1);this.addHalfVertex(B,Yt.x,Yt.y,!1,Fe,0,z)}}W&&this.addCurrentVertex(B,pe,-ze,-nt,z)}else if(je==="butt")this.addCurrentVertex(B,L,0,0,z);else if(je==="square"){let Ze=U?1:-1;this.addCurrentVertex(B,L,Ze,Ze,z)}else je==="round"&&(U&&(this.addCurrentVertex(B,ie,0,0,z),this.addCurrentVertex(B,ie,1,1,z,!0)),W&&(this.addCurrentVertex(B,pe,-1,-1,z,!0),this.addCurrentVertex(B,pe,0,0,z)));if(Ie&&oe<P-1){let Ze=B.dist(W);if(Ze>2*O){let ze=B.add(W.sub(B)._mult(O/Ze)._round());this.updateDistance(B,ze),this.addCurrentVertex(ze,pe,0,0,z),B=ze}}}}addCurrentVertex(t,r,d,f,_,y=!1){let b=r.y*f-r.x,w=-r.y-r.x*f;this.addHalfVertex(t,r.x+r.y*d,r.y-r.x*d,y,!1,d,_),this.addHalfVertex(t,b,w,y,!0,-f,_),this.distance>Ev/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,d,f,_,y))}addHalfVertex({x:t,y:r},d,f,_,y,b,w){let S=.5*(this.lineClips?this.scaledDistance*(Ev-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(_?1:0),(r<<1)+(y?1:0),Math.round(63*d)+128,Math.round(63*f)+128,1+(b===0?0:b<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let P=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,P,this.e2),w.primitiveLength++),y?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let Iv,Pv;tt("LineBucket",t_,{omit:["layers","patternFeatures"]});var kv={get paint(){return Pv=Pv||new mn({"line-opacity":new vt(X.paint_line["line-opacity"]),"line-color":new vt(X.paint_line["line-color"]),"line-translate":new dt(X.paint_line["line-translate"]),"line-translate-anchor":new dt(X.paint_line["line-translate-anchor"]),"line-width":new vt(X.paint_line["line-width"]),"line-gap-width":new vt(X.paint_line["line-gap-width"]),"line-offset":new vt(X.paint_line["line-offset"]),"line-blur":new vt(X.paint_line["line-blur"]),"line-dasharray":new ih(X.paint_line["line-dasharray"]),"line-pattern":new Ac(X.paint_line["line-pattern"]),"line-gradient":new nh(X.paint_line["line-gradient"])})},get layout(){return Iv=Iv||new mn({"line-cap":new dt(X.layout_line["line-cap"]),"line-join":new vt(X.layout_line["line-join"]),"line-miter-limit":new dt(X.layout_line["line-miter-limit"]),"line-round-limit":new dt(X.layout_line["line-round-limit"]),"line-sort-key":new vt(X.layout_line["line-sort-key"])})}};class T2 extends vt{possiblyEvaluate(t,r){return r=new Ri(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,d,f){return r=wn({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,d,f)}}let df;class E2 extends Qr{constructor(t){super(t,kv),this.gradientVersion=0,df||(df=new T2(kv.paint.properties["line-width"].specification),df.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){let r=this.gradientExpression();this.stepInterpolant=!!function(d){return d._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof Fo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=df.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new t_(t)}queryRadius(t){let r=t,d=Av(dh("line-width",this,r),dh("line-gap-width",this,r)),f=dh("line-offset",this,r);return d/2+Math.abs(f)+rf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:d,geometry:f,transform:_,pixelsToTileUnits:y}){let b=of(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,y),w=y/2*Av(this.paint.get("line-width").evaluate(r,d),this.paint.get("line-gap-width").evaluate(r,d)),S=this.paint.get("line-offset").evaluate(r,d);return S&&(f=function(P,A){let O=[];for(let z=0;z<P.length;z++){let B=P[z],U=[];for(let W=0;W<B.length;W++){let ie=B[W-1],pe=B[W],oe=B[W+1],L=W===0?new $e(0,0):pe.sub(ie)._unit()._perp(),q=W===B.length-1?new $e(0,0):oe.sub(pe)._unit()._perp(),ae=L._add(q)._unit(),Te=ae.x*q.x+ae.y*q.y;Te!==0&&ae._mult(1/Te),U.push(ae._mult(A)._add(pe))}O.push(U)}return O}(f,S*y)),function(P,A,O){for(let z=0;z<A.length;z++){let B=A[z];if(P.length>=3){for(let U=0;U<B.length;U++)if(Bc(P,B[U]))return!0}if(UC(P,B,O))return!0}return!1}(b,f,w)}isTileClipped(){return!0}}function Av(o,t){return t>0?t+2*o:o}let I2=Hi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),P2=Hi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Hi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let k2=Hi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Hi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let Dv=Hi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),A2=Hi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function D2(o,t,r){return o.sections.forEach(d=>{d.text=function(f,_,y){let b=_.layout.get("text-transform").evaluate(y,{});return b==="uppercase"?f=f.toLocaleUpperCase():b==="lowercase"&&(f=f.toLocaleLowerCase()),hs.applyArabicShaping&&(f=hs.applyArabicShaping(f)),f}(d.text,t,r)}),o}Hi([{name:"triangle",components:3,type:"Uint16"}]),Hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Hi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Hi([{type:"Float32",name:"offsetX"}]),Hi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Hi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let xh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var Rv,i_,Ov,In=24,n_={};function R2(){return Rv||(Rv=1,n_.read=function(o,t,r,d,f){var _,y,b=8*f-d-1,w=(1<<b)-1,S=w>>1,P=-7,A=r?f-1:0,O=r?-1:1,z=o[t+A];for(A+=O,_=z&(1<<-P)-1,z>>=-P,P+=b;P>0;_=256*_+o[t+A],A+=O,P-=8);for(y=_&(1<<-P)-1,_>>=-P,P+=d;P>0;y=256*y+o[t+A],A+=O,P-=8);if(_===0)_=1-S;else{if(_===w)return y?NaN:1/0*(z?-1:1);y+=Math.pow(2,d),_-=S}return(z?-1:1)*y*Math.pow(2,_-d)},n_.write=function(o,t,r,d,f,_){var y,b,w,S=8*_-f-1,P=(1<<S)-1,A=P>>1,O=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=d?0:_-1,B=d?1:-1,U=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,y=P):(y=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-y))<1&&(y--,w*=2),(t+=y+A>=1?O/w:O*Math.pow(2,1-A))*w>=2&&(y++,w/=2),y+A>=P?(b=0,y=P):y+A>=1?(b=(t*w-1)*Math.pow(2,f),y+=A):(b=t*Math.pow(2,A-1)*Math.pow(2,f),y=0));f>=8;o[r+z]=255&b,z+=B,b/=256,f-=8);for(y=y<<f|b,S+=f;S>0;o[r+z]=255&y,z+=B,y/=256,S-=8);o[r+z-B]|=128*U}),n_}function Fv(){if(Ov)return i_;Ov=1,i_=t;var o=R2();function t(L){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(L)?L:new Uint8Array(L||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=4294967296,d=1/r,f=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function _(L){return L.type===t.Bytes?L.readVarint()+L.pos:L.pos+1}function y(L,q,ae){return ae?4294967296*q+(L>>>0):4294967296*(q>>>0)+(L>>>0)}function b(L,q,ae){var Te=q<=16383?1:q<=2097151?2:q<=268435455?3:Math.floor(Math.log(q)/(7*Math.LN2));ae.realloc(Te);for(var Ve=ae.pos-1;Ve>=L;Ve--)ae.buf[Ve+Te]=ae.buf[Ve]}function w(L,q){for(var ae=0;ae<L.length;ae++)q.writeVarint(L[ae])}function S(L,q){for(var ae=0;ae<L.length;ae++)q.writeSVarint(L[ae])}function P(L,q){for(var ae=0;ae<L.length;ae++)q.writeFloat(L[ae])}function A(L,q){for(var ae=0;ae<L.length;ae++)q.writeDouble(L[ae])}function O(L,q){for(var ae=0;ae<L.length;ae++)q.writeBoolean(L[ae])}function z(L,q){for(var ae=0;ae<L.length;ae++)q.writeFixed32(L[ae])}function B(L,q){for(var ae=0;ae<L.length;ae++)q.writeSFixed32(L[ae])}function U(L,q){for(var ae=0;ae<L.length;ae++)q.writeFixed64(L[ae])}function W(L,q){for(var ae=0;ae<L.length;ae++)q.writeSFixed64(L[ae])}function ie(L,q){return(L[q]|L[q+1]<<8|L[q+2]<<16)+16777216*L[q+3]}function pe(L,q,ae){L[ae]=q,L[ae+1]=q>>>8,L[ae+2]=q>>>16,L[ae+3]=q>>>24}function oe(L,q){return(L[q]|L[q+1]<<8|L[q+2]<<16)+(L[q+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(L,q,ae){for(ae=ae||this.length;this.pos<ae;){var Te=this.readVarint(),Ve=Te>>3,Ie=this.pos;this.type=7&Te,L(Ve,q,this),this.pos===Ie&&this.skip(Te)}return q},readMessage:function(L,q){return this.readFields(L,q,this.readVarint()+this.pos)},readFixed32:function(){var L=ie(this.buf,this.pos);return this.pos+=4,L},readSFixed32:function(){var L=oe(this.buf,this.pos);return this.pos+=4,L},readFixed64:function(){var L=ie(this.buf,this.pos)+ie(this.buf,this.pos+4)*r;return this.pos+=8,L},readSFixed64:function(){var L=ie(this.buf,this.pos)+oe(this.buf,this.pos+4)*r;return this.pos+=8,L},readFloat:function(){var L=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,L},readDouble:function(){var L=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,L},readVarint:function(L){var q,ae,Te=this.buf;return q=127&(ae=Te[this.pos++]),ae<128?q:(q|=(127&(ae=Te[this.pos++]))<<7,ae<128?q:(q|=(127&(ae=Te[this.pos++]))<<14,ae<128?q:(q|=(127&(ae=Te[this.pos++]))<<21,ae<128?q:function(Ve,Ie,Fe){var He,je,Ze=Fe.buf;if(He=(112&(je=Ze[Fe.pos++]))>>4,je<128||(He|=(127&(je=Ze[Fe.pos++]))<<3,je<128)||(He|=(127&(je=Ze[Fe.pos++]))<<10,je<128)||(He|=(127&(je=Ze[Fe.pos++]))<<17,je<128)||(He|=(127&(je=Ze[Fe.pos++]))<<24,je<128)||(He|=(1&(je=Ze[Fe.pos++]))<<31,je<128))return y(Ve,He,Ie);throw new Error("Expected varint not more than 10 bytes")}(q|=(15&(ae=Te[this.pos]))<<28,L,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var L=this.readVarint();return L%2==1?(L+1)/-2:L/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var L=this.readVarint()+this.pos,q=this.pos;return this.pos=L,L-q>=12&&f?function(ae,Te,Ve){return f.decode(ae.subarray(Te,Ve))}(this.buf,q,L):function(ae,Te,Ve){for(var Ie="",Fe=Te;Fe<Ve;){var He,je,Ze,ze=ae[Fe],nt=null,gt=ze>239?4:ze>223?3:ze>191?2:1;if(Fe+gt>Ve)break;gt===1?ze<128&&(nt=ze):gt===2?(192&(He=ae[Fe+1]))==128&&(nt=(31&ze)<<6|63&He)<=127&&(nt=null):gt===3?(je=ae[Fe+2],(192&(He=ae[Fe+1]))==128&&(192&je)==128&&((nt=(15&ze)<<12|(63&He)<<6|63&je)<=2047||nt>=55296&&nt<=57343)&&(nt=null)):gt===4&&(je=ae[Fe+2],Ze=ae[Fe+3],(192&(He=ae[Fe+1]))==128&&(192&je)==128&&(192&Ze)==128&&((nt=(15&ze)<<18|(63&He)<<12|(63&je)<<6|63&Ze)<=65535||nt>=1114112)&&(nt=null)),nt===null?(nt=65533,gt=1):nt>65535&&(nt-=65536,Ie+=String.fromCharCode(nt>>>10&1023|55296),nt=56320|1023&nt),Ie+=String.fromCharCode(nt),Fe+=gt}return Ie}(this.buf,q,L)},readBytes:function(){var L=this.readVarint()+this.pos,q=this.buf.subarray(this.pos,L);return this.pos=L,q},readPackedVarint:function(L,q){if(this.type!==t.Bytes)return L.push(this.readVarint(q));var ae=_(this);for(L=L||[];this.pos<ae;)L.push(this.readVarint(q));return L},readPackedSVarint:function(L){if(this.type!==t.Bytes)return L.push(this.readSVarint());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readSVarint());return L},readPackedBoolean:function(L){if(this.type!==t.Bytes)return L.push(this.readBoolean());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readBoolean());return L},readPackedFloat:function(L){if(this.type!==t.Bytes)return L.push(this.readFloat());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readFloat());return L},readPackedDouble:function(L){if(this.type!==t.Bytes)return L.push(this.readDouble());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readDouble());return L},readPackedFixed32:function(L){if(this.type!==t.Bytes)return L.push(this.readFixed32());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readFixed32());return L},readPackedSFixed32:function(L){if(this.type!==t.Bytes)return L.push(this.readSFixed32());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readSFixed32());return L},readPackedFixed64:function(L){if(this.type!==t.Bytes)return L.push(this.readFixed64());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readFixed64());return L},readPackedSFixed64:function(L){if(this.type!==t.Bytes)return L.push(this.readSFixed64());var q=_(this);for(L=L||[];this.pos<q;)L.push(this.readSFixed64());return L},skip:function(L){var q=7&L;if(q===t.Varint)for(;this.buf[this.pos++]>127;);else if(q===t.Bytes)this.pos=this.readVarint()+this.pos;else if(q===t.Fixed32)this.pos+=4;else{if(q!==t.Fixed64)throw new Error("Unimplemented type: "+q);this.pos+=8}},writeTag:function(L,q){this.writeVarint(L<<3|q)},realloc:function(L){for(var q=this.length||16;q<this.pos+L;)q*=2;if(q!==this.length){var ae=new Uint8Array(q);ae.set(this.buf),this.buf=ae,this.length=q}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(L){this.realloc(4),pe(this.buf,L,this.pos),this.pos+=4},writeSFixed32:function(L){this.realloc(4),pe(this.buf,L,this.pos),this.pos+=4},writeFixed64:function(L){this.realloc(8),pe(this.buf,-1&L,this.pos),pe(this.buf,Math.floor(L*d),this.pos+4),this.pos+=8},writeSFixed64:function(L){this.realloc(8),pe(this.buf,-1&L,this.pos),pe(this.buf,Math.floor(L*d),this.pos+4),this.pos+=8},writeVarint:function(L){(L=+L||0)>268435455||L<0?function(q,ae){var Te,Ve;if(q>=0?(Te=q%4294967296|0,Ve=q/4294967296|0):(Ve=~(-q/4294967296),4294967295^(Te=~(-q%4294967296))?Te=Te+1|0:(Te=0,Ve=Ve+1|0)),q>=18446744073709552e3||q<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ae.realloc(10),function(Ie,Fe,He){He.buf[He.pos++]=127&Ie|128,Ie>>>=7,He.buf[He.pos++]=127&Ie|128,Ie>>>=7,He.buf[He.pos++]=127&Ie|128,Ie>>>=7,He.buf[He.pos++]=127&Ie|128,He.buf[He.pos]=127&(Ie>>>=7)}(Te,0,ae),function(Ie,Fe){var He=(7&Ie)<<4;Fe.buf[Fe.pos++]|=He|((Ie>>>=3)?128:0),Ie&&(Fe.buf[Fe.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Fe.buf[Fe.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Fe.buf[Fe.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Fe.buf[Fe.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Fe.buf[Fe.pos++]=127&Ie)))))}(Ve,ae)}(L,this):(this.realloc(4),this.buf[this.pos++]=127&L|(L>127?128:0),L<=127||(this.buf[this.pos++]=127&(L>>>=7)|(L>127?128:0),L<=127||(this.buf[this.pos++]=127&(L>>>=7)|(L>127?128:0),L<=127||(this.buf[this.pos++]=L>>>7&127))))},writeSVarint:function(L){this.writeVarint(L<0?2*-L-1:2*L)},writeBoolean:function(L){this.writeVarint(!!L)},writeString:function(L){L=String(L),this.realloc(4*L.length),this.pos++;var q=this.pos;this.pos=function(Te,Ve,Ie){for(var Fe,He,je=0;je<Ve.length;je++){if((Fe=Ve.charCodeAt(je))>55295&&Fe<57344){if(!He){Fe>56319||je+1===Ve.length?(Te[Ie++]=239,Te[Ie++]=191,Te[Ie++]=189):He=Fe;continue}if(Fe<56320){Te[Ie++]=239,Te[Ie++]=191,Te[Ie++]=189,He=Fe;continue}Fe=He-55296<<10|Fe-56320|65536,He=null}else He&&(Te[Ie++]=239,Te[Ie++]=191,Te[Ie++]=189,He=null);Fe<128?Te[Ie++]=Fe:(Fe<2048?Te[Ie++]=Fe>>6|192:(Fe<65536?Te[Ie++]=Fe>>12|224:(Te[Ie++]=Fe>>18|240,Te[Ie++]=Fe>>12&63|128),Te[Ie++]=Fe>>6&63|128),Te[Ie++]=63&Fe|128)}return Ie}(this.buf,L,this.pos);var ae=this.pos-q;ae>=128&&b(q,ae,this),this.pos=q-1,this.writeVarint(ae),this.pos+=ae},writeFloat:function(L){this.realloc(4),o.write(this.buf,L,this.pos,!0,23,4),this.pos+=4},writeDouble:function(L){this.realloc(8),o.write(this.buf,L,this.pos,!0,52,8),this.pos+=8},writeBytes:function(L){var q=L.length;this.writeVarint(q),this.realloc(q);for(var ae=0;ae<q;ae++)this.buf[this.pos++]=L[ae]},writeRawMessage:function(L,q){this.pos++;var ae=this.pos;L(q,this);var Te=this.pos-ae;Te>=128&&b(ae,Te,this),this.pos=ae-1,this.writeVarint(Te),this.pos+=Te},writeMessage:function(L,q,ae){this.writeTag(L,t.Bytes),this.writeRawMessage(q,ae)},writePackedVarint:function(L,q){q.length&&this.writeMessage(L,w,q)},writePackedSVarint:function(L,q){q.length&&this.writeMessage(L,S,q)},writePackedBoolean:function(L,q){q.length&&this.writeMessage(L,O,q)},writePackedFloat:function(L,q){q.length&&this.writeMessage(L,P,q)},writePackedDouble:function(L,q){q.length&&this.writeMessage(L,A,q)},writePackedFixed32:function(L,q){q.length&&this.writeMessage(L,z,q)},writePackedSFixed32:function(L,q){q.length&&this.writeMessage(L,B,q)},writePackedFixed64:function(L,q){q.length&&this.writeMessage(L,U,q)},writePackedSFixed64:function(L,q){q.length&&this.writeMessage(L,W,q)},writeBytesField:function(L,q){this.writeTag(L,t.Bytes),this.writeBytes(q)},writeFixed32Field:function(L,q){this.writeTag(L,t.Fixed32),this.writeFixed32(q)},writeSFixed32Field:function(L,q){this.writeTag(L,t.Fixed32),this.writeSFixed32(q)},writeFixed64Field:function(L,q){this.writeTag(L,t.Fixed64),this.writeFixed64(q)},writeSFixed64Field:function(L,q){this.writeTag(L,t.Fixed64),this.writeSFixed64(q)},writeVarintField:function(L,q){this.writeTag(L,t.Varint),this.writeVarint(q)},writeSVarintField:function(L,q){this.writeTag(L,t.Varint),this.writeSVarint(q)},writeStringField:function(L,q){this.writeTag(L,t.Bytes),this.writeString(q)},writeFloatField:function(L,q){this.writeTag(L,t.Fixed32),this.writeFloat(q)},writeDoubleField:function(L,q){this.writeTag(L,t.Fixed64),this.writeDouble(q)},writeBooleanField:function(L,q){this.writeVarintField(L,!!q)}},i_}var r_=T(Fv());let o_=3;function O2(o,t,r){o===1&&r.readMessage(F2,t)}function F2(o,t,r){if(o===3){let{id:d,bitmap:f,width:_,height:y,left:b,top:w,advance:S}=r.readMessage(L2,{});t.push({id:d,bitmap:new uh({width:_+2*o_,height:y+2*o_},f),metrics:{width:_,height:y,left:b,top:w,advance:S}})}}function L2(o,t,r){o===1?t.id=r.readVarint():o===2?t.bitmap=r.readBytes():o===3?t.width=r.readVarint():o===4?t.height=r.readVarint():o===5?t.left=r.readSVarint():o===6?t.top=r.readSVarint():o===7&&(t.advance=r.readVarint())}let z2=o_;function Lv(o){let t=0,r=0;for(let y of o)t+=y.w*y.h,r=Math.max(r,y.w);o.sort((y,b)=>b.h-y.h);let d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],f=0,_=0;for(let y of o)for(let b=d.length-1;b>=0;b--){let w=d[b];if(!(y.w>w.w||y.h>w.h)){if(y.x=w.x,y.y=w.y,_=Math.max(_,y.y+y.h),f=Math.max(f,y.x+y.w),y.w===w.w&&y.h===w.h){let S=d.pop();b<d.length&&(d[b]=S)}else y.h===w.h?(w.x+=y.w,w.w-=y.w):y.w===w.w?(w.y+=y.h,w.h-=y.h):(d.push({x:w.x+y.w,y:w.y,w:w.w-y.w,h:y.h}),w.y+=y.h,w.h-=y.h);break}}return{w:f,h:_,fill:t/(f*_)||0}}let Lr=1;class s_{constructor(t,{pixelRatio:r,version:d,stretchX:f,stretchY:_,content:y,textFitWidth:b,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=f,this.stretchY=_,this.content=y,this.version=d,this.textFitWidth=b,this.textFitHeight=w}get tl(){return[this.paddedRect.x+Lr,this.paddedRect.y+Lr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Lr,this.paddedRect.y+this.paddedRect.h-Lr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Lr)/this.pixelRatio,(this.paddedRect.h-2*Lr)/this.pixelRatio]}}class zv{constructor(t,r){let d={},f={};this.haveRenderCallbacks=[];let _=[];this.addImages(t,d,_),this.addImages(r,f,_);let{w:y,h:b}=Lv(_),w=new mo({width:y||1,height:b||1});for(let S in t){let P=t[S],A=d[S].paddedRect;mo.copy(P.data,w,{x:0,y:0},{x:A.x+Lr,y:A.y+Lr},P.data)}for(let S in r){let P=r[S],A=f[S].paddedRect,O=A.x+Lr,z=A.y+Lr,B=P.data.width,U=P.data.height;mo.copy(P.data,w,{x:0,y:0},{x:O,y:z},P.data),mo.copy(P.data,w,{x:0,y:U-1},{x:O,y:z-1},{width:B,height:1}),mo.copy(P.data,w,{x:0,y:0},{x:O,y:z+U},{width:B,height:1}),mo.copy(P.data,w,{x:B-1,y:0},{x:O-1,y:z},{width:1,height:U}),mo.copy(P.data,w,{x:0,y:0},{x:O+B,y:z},{width:1,height:U})}this.image=w,this.iconPositions=d,this.patternPositions=f}addImages(t,r,d){for(let f in t){let _=t[f],y={x:0,y:0,w:_.data.width+2*Lr,h:_.data.height+2*Lr};d.push(y),r[f]=new s_(y,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let d in t.updatedImages)this.patchUpdatedImage(this.iconPositions[d],t.getImage(d),r),this.patchUpdatedImage(this.patternPositions[d],t.getImage(d),r)}patchUpdatedImage(t,r,d){if(!t||!r||t.version===r.version)return;t.version=r.version;let[f,_]=t.tl;d.update(r.data,void 0,{x:f,y:_})}}var Rl;tt("ImagePosition",s_),tt("ImageAtlas",zv),h.al=void 0,(Rl=h.al||(h.al={}))[Rl.none=0]="none",Rl[Rl.horizontal=1]="horizontal",Rl[Rl.vertical=2]="vertical",Rl[Rl.horizontalOnly=3]="horizontalOnly";let uf=-17;class wh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,r,d){let f=new wh;return f.scale=t||1,f.fontStack=r,f.verticalAlign=d||"bottom",f}static forImage(t,r){let d=new wh;return d.imageName=t,d.verticalAlign=r||"bottom",d}}class Zd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){let d=new Zd;for(let f=0;f<t.sections.length;f++){let _=t.sections[f];_.image?d.addImageSection(_):d.addTextSection(_,r)}return d}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let d=0;d<t.length;d++){let f=t.charCodeAt(d+1)||null,_=t.charCodeAt(d-1)||null;r+=f&&Pc(f)&&!xh[t[d+1]]||_&&Pc(_)&&!xh[t[d-1]]||!xh[t[d]]?t[d]:xh[t[d]]}return r}(this.text)}trim(){let t=0;for(let d=0;d<this.text.length&&pf[this.text.charCodeAt(d)];d++)t++;let r=this.text.length;for(let d=this.text.length-1;d>=0&&d>=t&&pf[this.text.charCodeAt(d)];d--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){let d=new Zd;return d.text=this.text.substring(t,r),d.sectionIndex=this.sectionIndex.slice(t,r),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}getMaxImageSize(t){let r=0,d=0;for(let f=0;f<this.length();f++){let _=this.getSection(f);if(_.imageName){let y=t[_.imageName];if(!y)continue;let b=y.displaySize;r=Math.max(r,b[0]),d=Math.max(d,b[1])}}return{maxImageWidth:r,maxImageHeight:d}}addTextSection(t,r){this.text+=t.text,this.sections.push(wh.forText(t.scale,t.fontStack||r,t.verticalAlign));let d=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(d)}addImageSection(t){let r=t.image?t.image.name:"";if(r.length===0)return void Cn("Can't add FormattedSection with an empty image.");let d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(wh.forImage(r,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Cn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function hf(o,t,r,d,f,_,y,b,w,S,P,A,O,z,B){let U=Zd.fromFeature(o,f),W;A===h.al.vertical&&U.verticalizePunctuation();let{processBidirectionalText:ie,processStyledBidirectionalText:pe}=hs;if(ie&&U.sections.length===1){W=[];let q=ie(U.toString(),a_(U,S,_,t,d,z));for(let ae of q){let Te=new Zd;Te.text=ae,Te.sections=U.sections;for(let Ve=0;Ve<ae.length;Ve++)Te.sectionIndex.push(0);W.push(Te)}}else if(pe){W=[];let q=pe(U.text,U.sectionIndex,a_(U,S,_,t,d,z));for(let ae of q){let Te=new Zd;Te.text=ae[0],Te.sectionIndex=ae[1],Te.sections=U.sections,W.push(Te)}}else W=function(q,ae){let Te=[],Ve=q.text,Ie=0;for(let Fe of ae)Te.push(q.substring(Ie,Fe)),Ie=Fe;return Ie<Ve.length&&Te.push(q.substring(Ie,Ve.length)),Te}(U,a_(U,S,_,t,d,z));let oe=[],L={positionedLines:oe,text:U.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(q,ae,Te,Ve,Ie,Fe,He,je,Ze,ze,nt,gt){let pt=0,at=0,Yt=0,Qi=0,Pn=je==="right"?1:je==="left"?0:.5,rr=In/gt,_o=0;for(let Xi of Ie){Xi.trim();let Bn=Xi.getMaxScale(),Xn={positionedGlyphs:[],lineOffset:0};q.positionedLines[_o]=Xn;let Yn=Xn.positionedGlyphs,Mr=0;if(!Xi.length()){at+=Fe,++_o;continue}let yo=j2(Ve,Xi,rr);for(let Br=0;Br<Xi.length();Br++){let kn=Xi.getSection(Br),Vn=Xi.getSectionIndex(Br),jn=Xi.getCharCode(Br),yn=U2(Ze,nt,jn),Fi;if(kn.imageName){if(q.iconsInText=!0,kn.scale=kn.scale*rr,Fi=G2(kn,yn,Bn,yo,Ve),!Fi)continue;Mr=Math.max(Mr,Fi.imageOffset)}else if(Fi=$2(kn,jn,yn,yo,ae,Te),!Fi)continue;let{rect:ms,metrics:Yd,baselineOffset:gs}=Fi;Yn.push({glyph:jn,imageName:kn.imageName,x:pt,y:at+gs+uf,vertical:yn,scale:kn.scale,fontStack:kn.fontStack,sectionIndex:Vn,metrics:Yd,rect:ms}),yn?(q.verticalizable=!0,pt+=(kn.imageName?Yd.advance:In)*kn.scale+ze):pt+=Yd.advance*kn.scale+ze}Yn.length!==0&&(Yt=Math.max(pt-ze,Yt),H2(Yn,0,Yn.length-1,Pn)),pt=0,Xn.lineOffset=Math.max(Mr,(Bn-1)*In);let Nn=Fe*Bn+Mr;at+=Nn,Qi=Math.max(Nn,Qi),++_o}let{horizontalAlign:zr,verticalAlign:Wn}=l_(He);(function(Xi,Bn,Xn,Yn,Mr,yo,Nn,Br,kn){let Vn=(Bn-Xn)*Mr,jn=0;jn=yo!==Nn?-Br*Yn-uf:-Yn*kn*Nn+.5*Nn;for(let yn of Xi)for(let Fi of yn.positionedGlyphs)Fi.x+=Vn,Fi.y+=jn})(q.positionedLines,Pn,zr,Wn,Yt,Qi,Fe,at,Ie.length),q.top+=-Wn*at,q.bottom=q.top+at,q.left+=-zr*Yt,q.right=q.left+Yt}(L,t,r,d,W,y,b,w,A,S,O,B),!function(q){for(let ae of q)if(ae.positionedGlyphs.length!==0)return!1;return!0}(oe)&&L}let pf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},B2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},N2={40:!0};function Bv(o,t,r,d,f,_){if(t.imageName){let y=d[t.imageName];return y?y.displaySize[0]*t.scale*In/_+f:0}{let y=r[t.fontStack],b=y&&y[o];return b?b.metrics.advance*t.scale+f:0}}function Nv(o,t,r,d){let f=Math.pow(o-t,2);return d?o<t?f/2:2*f:f+Math.abs(r)*r}function V2(o,t,r){let d=0;return o===10&&(d-=1e4),r&&(d+=150),o!==40&&o!==65288||(d+=50),t!==41&&t!==65289||(d+=50),d}function Vv(o,t,r,d,f,_){let y=null,b=Nv(t,r,f,_);for(let w of d){let S=Nv(t-w.x,r,f,_)+w.badness;S<=b&&(y=w,b=S)}return{index:o,x:t,priorBreak:y,badness:b}}function jv(o){return o?jv(o.priorBreak).concat(o.index):[]}function a_(o,t,r,d,f,_){if(!o)return[];let y=[],b=function(A,O,z,B,U,W){let ie=0;for(let pe=0;pe<A.length();pe++){let oe=A.getSection(pe);ie+=Bv(A.getCharCode(pe),oe,B,U,O,W)}return ie/Math.max(1,Math.ceil(ie/z))}(o,t,r,d,f,_),w=o.text.indexOf("\u200B")>=0,S=0;for(let A=0;A<o.length();A++){let O=o.getSection(A),z=o.getCharCode(A);if(pf[z]||(S+=Bv(z,O,d,f,t,_)),A<o.length()-1){let B=!((P=z)<11904)&&(!!Ht["CJK Compatibility Forms"](P)||!!Ht["CJK Compatibility"](P)||!!Ht["CJK Strokes"](P)||!!Ht["CJK Symbols and Punctuation"](P)||!!Ht["Enclosed CJK Letters and Months"](P)||!!Ht["Halfwidth and Fullwidth Forms"](P)||!!Ht["Ideographic Description Characters"](P)||!!Ht["Vertical Forms"](P)||eh.test(String.fromCodePoint(P)));(B2[z]||B||O.imageName||A!==o.length()-2&&N2[o.getCharCode(A+1)])&&y.push(Vv(A+1,S,b,y,V2(z,o.getCharCode(A+1),B&&w),!1))}}var P;return jv(Vv(o.length(),S,b,y,0,!0))}function l_(o){let t=.5,r=.5;switch(o){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function j2(o,t,r){let d=t.getMaxScale()*In,{maxImageWidth:f,maxImageHeight:_}=t.getMaxImageSize(o),y=Math.max(d,_*r);return{verticalLineContentWidth:Math.max(d,f*r),horizontalLineContentHeight:y}}function Uv(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function U2(o,t,r){return!(o===h.al.horizontal||!t&&!Bd(r)||t&&(pf[r]||(d=r,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(d)))));var d}function $2(o,t,r,d,f,_){let y=_[o.fontStack],b=function(S,P,A,O){if(S&&S.rect)return S;let z=P[A.fontStack],B=z&&z[O];return B?{rect:null,metrics:B.metrics}:null}(y&&y[t],f,o,t);if(b===null)return null;let w;if(r)w=d.verticalLineContentWidth-o.scale*In;else{let S=Uv(o.verticalAlign);w=(d.horizontalLineContentHeight-o.scale*In)*S}return{rect:b.rect,metrics:b.metrics,baselineOffset:w}}function G2(o,t,r,d,f){let _=f[o.imageName];if(!_)return null;let y=_.paddedRect,b=_.displaySize,w={width:b[0],height:b[1],left:Lr,top:-3,advance:t?b[1]:b[0]},S;if(t)S=d.verticalLineContentWidth-b[1]*o.scale;else{let P=Uv(o.verticalAlign);S=(d.horizontalLineContentHeight-b[1]*o.scale)*P}return{rect:y,metrics:w,baselineOffset:S,imageOffset:(t?b[0]:b[1])*o.scale-In*r}}function H2(o,t,r,d){if(d===0)return;let f=o[r],_=(o[r].x+f.metrics.advance*f.scale)*d;for(let y=t;y<=r;y++)o[y].x-=_}function Z2(o,t,r){let{horizontalAlign:d,verticalAlign:f}=l_(r),_=t[0]-o.displaySize[0]*d,y=t[1]-o.displaySize[1]*f;return{image:o,top:y,bottom:y+o.displaySize[1],left:_,right:_+o.displaySize[0]}}function $v(o){var t,r;let d=o.left,f=o.top,_=o.right-d,y=o.bottom-f,b=(t=o.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(r=o.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",S=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(w==="proportional"){if(b==="stretchOnly"&&_/y<S||b==="proportional"){let P=Math.ceil(y*S);d*=P/_,_=P}}else if(b==="proportional"&&w==="stretchOnly"&&S!==0&&_/y>S){let P=Math.ceil(_/S);f*=P/y,y=P}return{x1:d,y1:f,x2:d+_,y2:f+y}}function Gv(o,t,r,d,f,_){let y=o.image,b;if(y.content){let W=y.content,ie=y.pixelRatio||1;b=[W[0]/ie,W[1]/ie,y.displaySize[0]-W[2]/ie,y.displaySize[1]-W[3]/ie]}let w=t.left*_,S=t.right*_,P,A,O,z;r==="width"||r==="both"?(z=f[0]+w-d[3],A=f[0]+S+d[1]):(z=f[0]+(w+S-y.displaySize[0])/2,A=z+y.displaySize[0]);let B=t.top*_,U=t.bottom*_;return r==="height"||r==="both"?(P=f[1]+B-d[0],O=f[1]+U+d[2]):(P=f[1]+(B+U-y.displaySize[1])/2,O=P+y.displaySize[1]),{image:y,top:P,right:A,bottom:O,left:z,collisionPadding:b}}let Ch=255,Xs=128,Ol=Ch*Xs;function Hv(o,t){let{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Ri(o+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:d,interpolationType:f}=r,_=0;for(;_<d.length&&d[_]<=o;)_++;_=Math.max(0,_-1);let y=_;for(;y<d.length&&d[y]<o+1;)y++;y=Math.min(d.length-1,y);let b=d[_],w=d[y];return r.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:w,interpolationType:f}:{kind:"camera",minZoom:b,maxZoom:w,minSize:r.evaluate(new Ri(b)),maxSize:r.evaluate(new Ri(w)),interpolationType:f}}}function c_(o,t,r){let d="never",f=o.get(t);return f?d=f:o.get(r)&&(d="always"),d}let q2=yh.VectorTileFeature.types,W2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ff(o,t,r,d,f,_,y,b,w,S,P,A,O){let z=b?Math.min(Ol,Math.round(b[0])):0,B=b?Math.min(Ol,Math.round(b[1])):0;o.emplaceBack(t,r,Math.round(32*d),Math.round(32*f),_,y,(z<<1)+(w?1:0),B,16*S,16*P,256*A,256*O)}function d_(o,t,r){o.emplaceBack(t.x,t.y,r),o.emplaceBack(t.x,t.y,r),o.emplaceBack(t.x,t.y,r),o.emplaceBack(t.x,t.y,r)}function X2(o){for(let t of o.sections)if(Fg(t.text))return!0;return!1}class u_{constructor(t){this.layoutVertexArray=new Zi,this.indexArray=new di,this.programConfigurations=t,this.segments=new ui,this.dynamicLayoutVertexArray=new Si,this.opacityVertexArray=new qi,this.hasVisibleVertices=!1,this.placedSymbolArray=new de}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,d,f){this.isEmpty()||(d&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,I2.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,P2.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,W2,!0),this.opacityVertexBuffer.itemSize=1),(d||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}tt("SymbolBuffers",u_);class h_{constructor(t,r,d){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new d,this.segments=new ui,this.collisionVertexArray=new Pi}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,k2.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}tt("CollisionBuffers",h_);class qd{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Hv(this.zoom,r["text-size"]),this.iconSizeData=Hv(this.zoom,r["icon-size"]);let d=this.layers[0].layout,f=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=c_(d,"text-overlap","text-allow-overlap")!=="never"||c_(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(y=>h.al[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID}createArrays(){this.text=new u_(new Ws(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new u_(new Ws(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ge,this.lineVertexArray=new he,this.symbolInstances=new ue,this.textAnchorOffsets=new Le}calculateGlyphDependencies(t,r,d,f,_){for(let y=0;y<t.length;y++)if(r[t.charCodeAt(y)]=!0,(d||f)&&_){let b=xh[t.charAt(y)];b&&(r[b.charCodeAt(0)]=!0)}}populate(t,r,d){let f=this.layers[0],_=f.layout,y=_.get("text-font"),b=_.get("text-field"),w=_.get("icon-image"),S=(b.value.kind!=="constant"||b.value.value instanceof Hn&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),P=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,A=_.get("symbol-sort-key");if(this.features=[],!S&&!P)return;let O=r.iconDependencies,z=r.glyphDependencies,B=r.availableImages,U=new Ri(this.zoom);for(let{feature:W,id:ie,index:pe,sourceLayerIndex:oe}of t){let L=f._featureFilter.needGeometry,q=zc(W,L);if(!f._featureFilter.filter(U,q,d))continue;let ae,Te;if(L||(q.geometry=Lc(W)),S){let Ie=f.getValueAndResolveTokens("text-field",q,d,B),Fe=Hn.factory(Ie),He=this.hasRTLText=this.hasRTLText||X2(Fe);(!He||hs.getRTLTextPluginStatus()==="unavailable"||He&&hs.isParsed())&&(ae=D2(Fe,f,q))}if(P){let Ie=f.getValueAndResolveTokens("icon-image",q,d,B);Te=Ie instanceof ur?Ie:ur.fromString(Ie)}if(!ae&&!Te)continue;let Ve=this.sortFeaturesByKey?A.evaluate(q,{},d):void 0;if(this.features.push({id:ie,text:ae,icon:Te,index:pe,sourceLayerIndex:oe,geometry:q.geometry,properties:W.properties,type:q2[W.type],sortKey:Ve}),Te&&(O[Te.name]=!0),ae){let Ie=y.evaluate(q,{},d).join(","),Fe=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(h.al.vertical)>=0;for(let He of ae.sections)if(He.image)O[He.image.name]=!0;else{let je=zd(ae.toString()),Ze=He.fontStack||Ie,ze=z[Ze]=z[Ze]||{};this.calculateGlyphDependencies(He.text,ze,Fe,this.allowVerticalPlacement,je)}}}_.get("symbol-placement")==="line"&&(this.features=function(W){let ie={},pe={},oe=[],L=0;function q(Ie){oe.push(W[Ie]),L++}function ae(Ie,Fe,He){let je=pe[Ie];return delete pe[Ie],pe[Fe]=je,oe[je].geometry[0].pop(),oe[je].geometry[0]=oe[je].geometry[0].concat(He[0]),je}function Te(Ie,Fe,He){let je=ie[Fe];return delete ie[Fe],ie[Ie]=je,oe[je].geometry[0].shift(),oe[je].geometry[0]=He[0].concat(oe[je].geometry[0]),je}function Ve(Ie,Fe,He){let je=He?Fe[0][Fe[0].length-1]:Fe[0][0];return`${Ie}:${je.x}:${je.y}`}for(let Ie=0;Ie<W.length;Ie++){let Fe=W[Ie],He=Fe.geometry,je=Fe.text?Fe.text.toString():null;if(!je){q(Ie);continue}let Ze=Ve(je,He),ze=Ve(je,He,!0);if(Ze in pe&&ze in ie&&pe[Ze]!==ie[ze]){let nt=Te(Ze,ze,He),gt=ae(Ze,ze,oe[nt].geometry);delete ie[Ze],delete pe[ze],pe[Ve(je,oe[gt].geometry,!0)]=gt,oe[nt].geometry=null}else Ze in pe?ae(Ze,ze,He):ze in ie?Te(Ze,ze,He):(q(Ie),ie[Ze]=L-1,pe[ze]=L-1)}return oe.filter(Ie=>Ie.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,ie)=>W.sortKey-ie.sortKey)}update(t,r,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,d),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){let d=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(r[t.segment+1]),_=t.dist(r[t.segment]),y={};for(let b=t.segment+1;b<r.length;b++)y[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:f},b<r.length-1&&(f+=r[b+1].dist(r[b]));for(let b=t.segment||0;b>=0;b--)y[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:_},b>0&&(_+=r[b-1].dist(r[b]));for(let b=0;b<r.length;b++){let w=y[b];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(t,r,d,f,_,y,b,w,S,P,A,O){let z=t.indexArray,B=t.layoutVertexArray,U=t.segments.prepareSegment(4*r.length,B,z,this.canOverlap?y.sortKey:void 0),W=this.glyphOffsetArray.length,ie=U.vertexLength,pe=this.allowVerticalPlacement&&b===h.al.vertical?Math.PI/2:0,oe=y.text&&y.text.sections;for(let L=0;L<r.length;L++){let{tl:q,tr:ae,bl:Te,br:Ve,tex:Ie,pixelOffsetTL:Fe,pixelOffsetBR:He,minFontScaleX:je,minFontScaleY:Ze,glyphOffset:ze,isSDF:nt,sectionIndex:gt}=r[L],pt=U.vertexLength,at=ze[1];ff(B,w.x,w.y,q.x,at+q.y,Ie.x,Ie.y,d,nt,Fe.x,Fe.y,je,Ze),ff(B,w.x,w.y,ae.x,at+ae.y,Ie.x+Ie.w,Ie.y,d,nt,He.x,Fe.y,je,Ze),ff(B,w.x,w.y,Te.x,at+Te.y,Ie.x,Ie.y+Ie.h,d,nt,Fe.x,He.y,je,Ze),ff(B,w.x,w.y,Ve.x,at+Ve.y,Ie.x+Ie.w,Ie.y+Ie.h,d,nt,He.x,He.y,je,Ze),d_(t.dynamicLayoutVertexArray,w,pe),z.emplaceBack(pt,pt+2,pt+1),z.emplaceBack(pt+1,pt+2,pt+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ze[0]),L!==r.length-1&&gt===r[L+1].sectionIndex||t.programConfigurations.populatePaintArrays(B.length,y,y.index,{},O,oe&&oe[gt])}t.placedSymbolArray.emplaceBack(w.x,w.y,W,this.glyphOffsetArray.length-W,ie,S,P,w.segment,d?d[0]:0,d?d[1]:0,f[0],f[1],b,0,!1,0,A)}_addCollisionDebugVertex(t,r,d,f,_,y){return r.emplaceBack(0,0),t.emplaceBack(d.x,d.y,f,_,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,r,d,f,_,y,b){let w=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),S=w.vertexLength,P=_.layoutVertexArray,A=_.collisionVertexArray,O=b.anchorX,z=b.anchorY;this._addCollisionDebugVertex(P,A,y,O,z,new $e(t,r)),this._addCollisionDebugVertex(P,A,y,O,z,new $e(d,r)),this._addCollisionDebugVertex(P,A,y,O,z,new $e(d,f)),this._addCollisionDebugVertex(P,A,y,O,z,new $e(t,f)),w.vertexLength+=4;let B=_.indexArray;B.emplaceBack(S,S+1),B.emplaceBack(S+1,S+2),B.emplaceBack(S+2,S+3),B.emplaceBack(S+3,S),w.primitiveLength+=4}addDebugCollisionBoxes(t,r,d,f){for(let _=t;_<r;_++){let y=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,f?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new h_(Wi,Dv.members,En),this.iconCollisionBox=new h_(Wi,Dv.members,En);for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,d,f,_,y,b,w,S){let P={};for(let A=r;A<d;A++){let O=t.get(A);P.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.textFeatureIndex=O.featureIndex;break}for(let A=f;A<_;A++){let O=t.get(A);P.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalTextFeatureIndex=O.featureIndex;break}for(let A=y;A<b;A++){let O=t.get(A);P.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.iconFeatureIndex=O.featureIndex;break}for(let A=w;A<S;A++){let O=t.get(A);P.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},P.verticalIconFeatureIndex=O.featureIndex;break}return P}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let d=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){let d=t.placedSymbolArray.get(r),f=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<f;_+=4)t.indexArray.emplaceBack(_,_+2,_+1),t.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(t),d=Math.cos(t),f=[],_=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);let w=this.symbolInstances.get(b);f.push(0|Math.round(r*w.anchorX+d*w.anchorY)),_.push(w.featureIndex)}return y.sort((b,w)=>f[b]-f[w]||_[w]-_[b]),y}addToSortKeyRanges(t,r){let d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===r?d.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let d=this.symbolInstances.get(r);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((f,_,y)=>{f>=0&&y.indexOf(f)===_&&this.addIndicesForPlacedSymbol(this.text,f)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Zv,qv;tt("SymbolBucket",qd,{omit:["layers","collisionBoxArray","features","compareText"]}),qd.MAX_GLYPHS=65535,qd.addDynamicAttributes=d_;var p_={get paint(){return qv=qv||new mn({"icon-opacity":new vt(X.paint_symbol["icon-opacity"]),"icon-color":new vt(X.paint_symbol["icon-color"]),"icon-halo-color":new vt(X.paint_symbol["icon-halo-color"]),"icon-halo-width":new vt(X.paint_symbol["icon-halo-width"]),"icon-halo-blur":new vt(X.paint_symbol["icon-halo-blur"]),"icon-translate":new dt(X.paint_symbol["icon-translate"]),"icon-translate-anchor":new dt(X.paint_symbol["icon-translate-anchor"]),"text-opacity":new vt(X.paint_symbol["text-opacity"]),"text-color":new vt(X.paint_symbol["text-color"],{runtimeType:St,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new vt(X.paint_symbol["text-halo-color"]),"text-halo-width":new vt(X.paint_symbol["text-halo-width"]),"text-halo-blur":new vt(X.paint_symbol["text-halo-blur"]),"text-translate":new dt(X.paint_symbol["text-translate"]),"text-translate-anchor":new dt(X.paint_symbol["text-translate-anchor"])})},get layout(){return Zv=Zv||new mn({"symbol-placement":new dt(X.layout_symbol["symbol-placement"]),"symbol-spacing":new dt(X.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new dt(X.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new vt(X.layout_symbol["symbol-sort-key"]),"symbol-z-order":new dt(X.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new dt(X.layout_symbol["icon-allow-overlap"]),"icon-overlap":new dt(X.layout_symbol["icon-overlap"]),"icon-ignore-placement":new dt(X.layout_symbol["icon-ignore-placement"]),"icon-optional":new dt(X.layout_symbol["icon-optional"]),"icon-rotation-alignment":new dt(X.layout_symbol["icon-rotation-alignment"]),"icon-size":new vt(X.layout_symbol["icon-size"]),"icon-text-fit":new dt(X.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new dt(X.layout_symbol["icon-text-fit-padding"]),"icon-image":new vt(X.layout_symbol["icon-image"]),"icon-rotate":new vt(X.layout_symbol["icon-rotate"]),"icon-padding":new vt(X.layout_symbol["icon-padding"]),"icon-keep-upright":new dt(X.layout_symbol["icon-keep-upright"]),"icon-offset":new vt(X.layout_symbol["icon-offset"]),"icon-anchor":new vt(X.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new dt(X.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new dt(X.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new dt(X.layout_symbol["text-rotation-alignment"]),"text-field":new vt(X.layout_symbol["text-field"]),"text-font":new vt(X.layout_symbol["text-font"]),"text-size":new vt(X.layout_symbol["text-size"]),"text-max-width":new vt(X.layout_symbol["text-max-width"]),"text-line-height":new dt(X.layout_symbol["text-line-height"]),"text-letter-spacing":new vt(X.layout_symbol["text-letter-spacing"]),"text-justify":new vt(X.layout_symbol["text-justify"]),"text-radial-offset":new vt(X.layout_symbol["text-radial-offset"]),"text-variable-anchor":new dt(X.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new vt(X.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new vt(X.layout_symbol["text-anchor"]),"text-max-angle":new dt(X.layout_symbol["text-max-angle"]),"text-writing-mode":new dt(X.layout_symbol["text-writing-mode"]),"text-rotate":new vt(X.layout_symbol["text-rotate"]),"text-padding":new dt(X.layout_symbol["text-padding"]),"text-keep-upright":new dt(X.layout_symbol["text-keep-upright"]),"text-transform":new vt(X.layout_symbol["text-transform"]),"text-offset":new vt(X.layout_symbol["text-offset"]),"text-allow-overlap":new dt(X.layout_symbol["text-allow-overlap"]),"text-overlap":new dt(X.layout_symbol["text-overlap"]),"text-ignore-placement":new dt(X.layout_symbol["text-ignore-placement"]),"text-optional":new dt(X.layout_symbol["text-optional"])})}};class Wv{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:xt,this.defaultValue=t}evaluate(t){if(t.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}tt("FormatSectionOverride",Wv,{omit:["defaultValue"]});class mf extends Qr{constructor(t){super(t,p_)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let d=this.layout.get("text-writing-mode");if(d){let f=[];for(let _ of d)f.indexOf(_)<0&&f.push(_);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,d,f){let _=this.layout.get(t).evaluate(r,{},d,f),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||Pa(y.value)||!_?_:function(b,w){return w.replace(/{([^{}]+)}/g,(S,P)=>b&&P in b?String(b[P]):"")}(r.properties,_)}createBucket(t){return new qd(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let t of p_.paint.overridableProperties){if(!mf.hasPaintOverride(this.layout,t))continue;let r=this.paint.get(t),d=new Wv(r),f=new yl(d,r.property.specification),_=null;_=r.value.kind==="constant"||r.value.kind==="source"?new Cr("source",f):new ds("composite",f,r.value.zoomStops),this.paint._values[t]=new hr(r.property,_,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,d){return!(!this.layout||r.isDataDriven()||d.isDataDriven())&&mf.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){let d=t.get("text-field"),f=p_.paint.properties[r],_=!1,y=b=>{for(let w of b)if(f.overrides&&f.overrides.hasOverride(w))return void(_=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Hn)y(d.value.value.sections);else if(d.value.kind==="source"){let b=S=>{_||(S instanceof Mt&&Ui(S.value)===ra?y(S.value.sections):S instanceof sl?y(S.sections):S.eachChild(b))},w=d.value;w._styleExpression&&b(w._styleExpression.expression)}return _}}let Xv;var Y2={get paint(){return Xv=Xv||new mn({"background-color":new dt(X.paint_background["background-color"]),"background-pattern":new ih(X.paint_background["background-pattern"]),"background-opacity":new dt(X.paint_background["background-opacity"])})}};class K2 extends Qr{constructor(t){super(t,Y2)}}let Yv;var Q2={get paint(){return Yv=Yv||new mn({"raster-opacity":new dt(X.paint_raster["raster-opacity"]),"raster-hue-rotate":new dt(X.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new dt(X.paint_raster["raster-brightness-min"]),"raster-brightness-max":new dt(X.paint_raster["raster-brightness-max"]),"raster-saturation":new dt(X.paint_raster["raster-saturation"]),"raster-contrast":new dt(X.paint_raster["raster-contrast"]),"raster-resampling":new dt(X.paint_raster["raster-resampling"]),"raster-fade-duration":new dt(X.paint_raster["raster-fade-duration"])})}};class J2 extends Qr{constructor(t){super(t,Q2)}}class eM extends Qr{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class tM{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let iM={once:!0},f_=63710088e-1;class Fl{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fl(ar(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){let r=Math.PI/180,d=this.lat*r,f=t.lat*r,_=Math.sin(d)*Math.sin(f)+Math.cos(d)*Math.cos(f)*Math.cos((t.lng-this.lng)*r);return f_*Math.acos(Math.min(_,1))}static convert(t){if(t instanceof Fl)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Fl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Fl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let Kv=2*Math.PI*f_;function Qv(o){return Kv*Math.cos(o*Math.PI/180)}function Jv(o){return(180+o)/360}function eb(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function tb(o,t){return o/Qv(t)}function m_(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function ib(o,t){return o*Qv(m_(t))}class Mh{constructor(t,r,d=0){this.x=+t,this.y=+r,this.z=+d}static fromLngLat(t,r=0){let d=Fl.convert(t);return new Mh(Jv(d.lng),eb(d.lat),tb(r,d.lat))}toLngLat(){return new Fl(360*this.x-180,m_(this.y))}toAltitude(){return ib(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Kv*(t=m_(this.y),1/Math.cos(t*Math.PI/180));var t}}function nb(o,t,r){var d=2*Math.PI*6378137/256/Math.pow(2,r);return[o*d-2*Math.PI*6378137/2,t*d-2*Math.PI*6378137/2]}class g_{constructor(t,r,d){if(!function(f,_,y){return!(f<0||f>25||y<0||y>=Math.pow(2,f)||_<0||_>=Math.pow(2,f))}(t,r,d))throw new Error(`x=${r}, y=${d}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=d,this.key=Wd(0,t,t,r,d)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,d){let f=(y=this.y,b=this.z,w=nb(256*(_=this.x),256*(y=Math.pow(2,b)-y-1),b),S=nb(256*(_+1),256*(y+1),b),w[0]+","+w[1]+","+S[0]+","+S[1]);var _,y,b,w,S;let P=function(A,O,z){let B,U="";for(let W=A;W>0;W--)B=1<<W-1,U+=(O&B?1:0)+(z&B?2:0);return U}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){let r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){let r=Math.pow(2,this.z);return new $e((t.x*r-this.x)*ci,(t.y*r-this.y)*ci)}toString(){return`${this.z}/${this.x}/${this.y}`}}class rb{constructor(t,r){this.wrap=t,this.canonical=r,this.key=Wd(t,r.z,r.z,r.x,r.y)}}class go{constructor(t,r,d,f,_){if(this.terrainRttPosMatrix32f=null,t<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${d}`);this.overscaledZ=t,this.wrap=r,this.canonical=new g_(d,+f,+_),this.key=Wd(r,t,d,f,_)}clone(){return new go(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-t;return t>this.canonical.z?new go(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new go(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let d=this.canonical.z-t;return t>this.canonical.z?Wd(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Wd(this.wrap*+r,t,t,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(t){if(t.wrap!==this.wrap)return!1;let r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new go(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,d=2*this.canonical.x,f=2*this.canonical.y;return[new go(r,this.wrap,r,d,f),new go(r,this.wrap,r,d+1,f),new go(r,this.wrap,r,d,f+1),new go(r,this.wrap,r,d+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new go(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new go(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new rb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Mh(t.x-this.wrap,t.y))}}function Wd(o,t,r,d,f){(o*=2)<0&&(o=-1*o-1);let _=1<<r;return(_*_*o+_*f+d).toString(36)+r.toString(36)+t.toString(36)}tt("CanonicalTileID",g_),tt("OverscaledTileID",go,{omit:["terrainRttPosMatrix32f"]});class ob{constructor(t,r,d,f=1,_=1,y=1,b=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void Cn(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;let w=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=_,this.blueFactor=y,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let S=0;S<w;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(w,S)]=this.data[this._idx(w-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,w)]=this.data[this._idx(S,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let S=0;S<w;S++)for(let P=0;P<w;P++){let A=this.get(S,P);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(t,r){let d=new Uint8Array(this.data.buffer),f=4*this._idx(t,r);return this.unpack(d[f],d[f+1],d[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,d){return t*this.redFactor+r*this.greenFactor+d*this.blueFactor-this.baseShift}getPixels(){return new mo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,d){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=r*this.dim,_=r*this.dim+this.dim,y=d*this.dim,b=d*this.dim+this.dim;switch(r){case-1:f=_-1;break;case 1:_=f+1}switch(d){case-1:y=b-1;break;case 1:b=y+1}let w=-r*this.dim,S=-d*this.dim;for(let P=y;P<b;P++)for(let A=f;A<_;A++)this.data[this._idx(A,P)]=t.data[this._idx(A+w,P+S)]}}tt("DEMData",ob);class sb{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){let d=t[r];this._stringToNumber[d]=r,this._numberToString[r]=d}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class ab{constructor(t,r,d,f,_){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=d,t._y=f,this.properties=t.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){let t={geometry:this.geometry};for(let r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class lb{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Pl(ci,16,0),this.grid3D=new Pl(ci,16,0),this.featureIndexArray=new Ae,this.promoteId=r}insert(t,r,d,f,_,y){let b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,f,_);let w=y?this.grid3D:this.grid;for(let S=0;S<r.length;S++){let P=r[S],A=[1/0,1/0,-1/0,-1/0];for(let O=0;O<P.length;O++){let z=P[O];A[0]=Math.min(A[0],z.x),A[1]=Math.min(A[1],z.y),A[2]=Math.max(A[2],z.x),A[3]=Math.max(A[3],z.y)}A[0]<ci&&A[1]<ci&&A[2]>=0&&A[3]>=0&&w.insert(b,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new yh.VectorTile(new r_(this.rawTileData)).layers,this.sourceLayerCoder=new sb(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,d,f){this.loadVTLayers();let _=t.params,y=ci/t.tileSize/t.scale,b=Ra(_.filter),w=t.queryGeometry,S=t.queryPadding*y,P=db(w),A=this.grid.query(P.minX-S,P.minY-S,P.maxX+S,P.maxY+S),O=db(t.cameraQueryGeometry),z=this.grid3D.query(O.minX-S,O.minY-S,O.maxX+S,O.maxY+S,(W,ie,pe,oe)=>function(L,q,ae,Te,Ve){for(let Fe of L)if(q<=Fe.x&&ae<=Fe.y&&Te>=Fe.x&&Ve>=Fe.y)return!0;let Ie=[new $e(q,ae),new $e(q,Ve),new $e(Te,Ve),new $e(Te,ae)];if(L.length>2){for(let Fe of Ie)if(Bc(L,Fe))return!0}for(let Fe=0;Fe<L.length-1;Fe++)if(GC(L[Fe],L[Fe+1],Ie))return!0;return!1}(t.cameraQueryGeometry,W-S,ie-S,pe+S,oe+S));for(let W of z)A.push(W);A.sort(nM);let B={},U;for(let W=0;W<A.length;W++){let ie=A[W];if(ie===U)continue;U=ie;let pe=this.featureIndexArray.get(ie),oe=null;this.loadMatchingFeature(B,pe.bucketIndex,pe.sourceLayerIndex,pe.featureIndex,b,_.layers,_.availableImages,r,d,f,(L,q,ae)=>(oe||(oe=Lc(L)),q.queryIntersectsFeature({queryGeometry:w,feature:L,featureState:ae,geometry:oe,zoom:this.z,transform:t.transform,pixelsToTileUnits:y,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return B}loadMatchingFeature(t,r,d,f,_,y,b,w,S,P,A){let O=this.bucketLayerIDs[r];if(y&&!O.some(W=>y.has(W)))return;let z=this.sourceLayerCoder.decode(d),B=this.vtLayers[z].feature(f);if(_.needGeometry){let W=zc(B,!0);if(!_.filter(new Ri(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!_.filter(new Ri(this.tileID.overscaledZ),B))return;let U=this.getId(B,z);for(let W=0;W<O.length;W++){let ie=O[W];if(y&&!y.has(ie))continue;let pe=w[ie];if(!pe)continue;let oe={};U&&P&&(oe=P.getState(pe.sourceLayer||"_geojsonTileLayer",U));let L=wn({},S[ie]);L.paint=cb(L.paint,pe.paint,B,oe,b),L.layout=cb(L.layout,pe.layout,B,oe,b);let q=!A||A(B,pe,oe);if(!q)continue;let ae=new ab(B,this.z,this.x,this.y,U);ae.layer=L;let Te=t[ie];Te===void 0&&(Te=t[ie]=[]),Te.push({featureIndex:f,feature:ae,intersectionZ:q})}}lookupSymbolFeatures(t,r,d,f,_,y,b,w){let S={};this.loadVTLayers();let P=Ra(_);for(let A of t)this.loadMatchingFeature(S,d,f,A,P,y,b,w,r);return S}hasLayer(t){for(let r of this.bucketLayerIDs)for(let d of r)if(t===d)return!0;return!1}getId(t,r){var d;let f=t.id;return this.promoteId&&(f=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof f=="boolean"&&(f=Number(f)),f===void 0&&(!((d=t.properties)===null||d===void 0)&&d.cluster)&&this.promoteId&&(f=Number(t.properties.cluster_id))),f}}function cb(o,t,r,d,f){return Hr(o,(_,y)=>{let b=t instanceof Vd?t.get(y):null;return b&&b.evaluate?b.evaluate(r,d,f):b})}function db(o){let t=1/0,r=1/0,d=-1/0,f=-1/0;for(let _ of o)t=Math.min(t,_.x),r=Math.min(r,_.y),d=Math.max(d,_.x),f=Math.max(f,_.y);return{minX:t,minY:r,maxX:d,maxY:f}}function nM(o,t){return t-o}function ub(o,t,r,d,f){let _=[];for(let y=0;y<o.length;y++){let b=o[y],w;for(let S=0;S<b.length-1;S++){let P=b[S],A=b[S+1];P.x<t&&A.x<t||(P.x<t?P=new $e(t,P.y+(t-P.x)/(A.x-P.x)*(A.y-P.y))._round():A.x<t&&(A=new $e(t,P.y+(t-P.x)/(A.x-P.x)*(A.y-P.y))._round()),P.y<r&&A.y<r||(P.y<r?P=new $e(P.x+(r-P.y)/(A.y-P.y)*(A.x-P.x),r)._round():A.y<r&&(A=new $e(P.x+(r-P.y)/(A.y-P.y)*(A.x-P.x),r)._round()),P.x>=d&&A.x>=d||(P.x>=d?P=new $e(d,P.y+(d-P.x)/(A.x-P.x)*(A.y-P.y))._round():A.x>=d&&(A=new $e(d,P.y+(d-P.x)/(A.x-P.x)*(A.y-P.y))._round()),P.y>=f&&A.y>=f||(P.y>=f?P=new $e(P.x+(f-P.y)/(A.y-P.y)*(A.x-P.x),f)._round():A.y>=f&&(A=new $e(P.x+(f-P.y)/(A.y-P.y)*(A.x-P.x),f)._round()),w&&P.equals(w[w.length-1])||(w=[P],_.push(w)),w.push(A)))))}}return _}tt("FeatureIndex",lb,{omit:["rawTileData","sourceLayerCoder"]});class Ll extends $e{constructor(t,r,d,f){super(t,r),this.angle=d,f!==void 0&&(this.segment=f)}clone(){return new Ll(this.x,this.y,this.angle,this.segment)}}function hb(o,t,r,d,f){if(t.segment===void 0||r===0)return!0;let _=t,y=t.segment+1,b=0;for(;b>-r/2;){if(y--,y<0)return!1;b-=o[y].dist(_),_=o[y]}b+=o[y].dist(o[y+1]),y++;let w=[],S=0;for(;b<r/2;){let P=o[y],A=o[y+1];if(!A)return!1;let O=o[y-1].angleTo(P)-P.angleTo(A);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:b,angleDelta:O}),S+=O;b-w[0].distance>d;)S-=w.shift().angleDelta;if(S>f)return!1;y++,b+=P.dist(A)}return!0}function pb(o){let t=0;for(let r=0;r<o.length-1;r++)t+=o[r].dist(o[r+1]);return t}function fb(o,t,r){return o?.6*t*r:0}function mb(o,t){return Math.max(o?o.right-o.left:0,t?t.right-t.left:0)}function rM(o,t,r,d,f,_){let y=fb(r,f,_),b=mb(r,d)*_,w=0,S=pb(o)/2;for(let P=0;P<o.length-1;P++){let A=o[P],O=o[P+1],z=A.dist(O);if(w+z>S){let B=(S-w)/z,U=Xr.number(A.x,O.x,B),W=Xr.number(A.y,O.y,B),ie=new Ll(U,W,O.angleTo(A),P);return ie._round(),!y||hb(o,ie,b,y,t)?ie:void 0}w+=z}}function oM(o,t,r,d,f,_,y,b,w){let S=fb(d,_,y),P=mb(d,f),A=P*y,O=o[0].x===0||o[0].x===w||o[0].y===0||o[0].y===w;return t-A<t/4&&(t=A+t/4),gb(o,O?t/2*b%t:(P/2+2*_)*y*b%t,t,S,r,A,O,!1,w)}function gb(o,t,r,d,f,_,y,b,w){let S=_/2,P=pb(o),A=0,O=t-r,z=[];for(let B=0;B<o.length-1;B++){let U=o[B],W=o[B+1],ie=U.dist(W),pe=W.angleTo(U);for(;O+r<A+ie;){O+=r;let oe=(O-A)/ie,L=Xr.number(U.x,W.x,oe),q=Xr.number(U.y,W.y,oe);if(L>=0&&L<w&&q>=0&&q<w&&O-S>=0&&O+S<=P){let ae=new Ll(L,q,pe,B);ae._round(),d&&!hb(o,ae,_,d,f)||z.push(ae)}}A+=ie}return b||z.length||y||(z=gb(o,A/2,r,d,f,_,y,!0,w)),z}tt("Anchor",Ll);let Sh=Lr;function _b(o,t,r,d){let f=[],_=o.image,y=_.pixelRatio,b=_.paddedRect.w-2*Sh,w=_.paddedRect.h-2*Sh,S={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom},P=_.stretchX||[[0,b]],A=_.stretchY||[[0,w]],O=(ze,nt)=>ze+nt[1]-nt[0],z=P.reduce(O,0),B=A.reduce(O,0),U=b-z,W=w-B,ie=0,pe=z,oe=0,L=B,q=0,ae=U,Te=0,Ve=W;if(_.content&&d){let ze=_.content,nt=ze[2]-ze[0],gt=ze[3]-ze[1];(_.textFitWidth||_.textFitHeight)&&(S=$v(o)),ie=gf(P,0,ze[0]),oe=gf(A,0,ze[1]),pe=gf(P,ze[0],ze[2]),L=gf(A,ze[1],ze[3]),q=ze[0]-ie,Te=ze[1]-oe,ae=nt-pe,Ve=gt-L}let Ie=S.x1,Fe=S.y1,He=S.x2-Ie,je=S.y2-Fe,Ze=(ze,nt,gt,pt)=>{let at=_f(ze.stretch-ie,pe,He,Ie),Yt=yf(ze.fixed-q,ae,ze.stretch,z),Qi=_f(nt.stretch-oe,L,je,Fe),Pn=yf(nt.fixed-Te,Ve,nt.stretch,B),rr=_f(gt.stretch-ie,pe,He,Ie),_o=yf(gt.fixed-q,ae,gt.stretch,z),zr=_f(pt.stretch-oe,L,je,Fe),Wn=yf(pt.fixed-Te,Ve,pt.stretch,B),Xi=new $e(at,Qi),Bn=new $e(rr,Qi),Xn=new $e(rr,zr),Yn=new $e(at,zr),Mr=new $e(Yt/y,Pn/y),yo=new $e(_o/y,Wn/y),Nn=t*Math.PI/180;if(Nn){let Vn=Math.sin(Nn),jn=Math.cos(Nn),yn=[jn,-Vn,Vn,jn];Xi._matMult(yn),Bn._matMult(yn),Yn._matMult(yn),Xn._matMult(yn)}let Br=ze.stretch+ze.fixed,kn=nt.stretch+nt.fixed;return{tl:Xi,tr:Bn,bl:Yn,br:Xn,tex:{x:_.paddedRect.x+Sh+Br,y:_.paddedRect.y+Sh+kn,w:gt.stretch+gt.fixed-Br,h:pt.stretch+pt.fixed-kn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Mr,pixelOffsetBR:yo,minFontScaleX:ae/y/He,minFontScaleY:Ve/y/je,isSDF:r}};if(d&&(_.stretchX||_.stretchY)){let ze=yb(P,U,z),nt=yb(A,W,B);for(let gt=0;gt<ze.length-1;gt++){let pt=ze[gt],at=ze[gt+1];for(let Yt=0;Yt<nt.length-1;Yt++)f.push(Ze(pt,nt[Yt],at,nt[Yt+1]))}}else f.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:w+1}));return f}function gf(o,t,r){let d=0;for(let f of o)d+=Math.max(t,Math.min(r,f[1]))-Math.max(t,Math.min(r,f[0]));return d}function yb(o,t,r){let d=[{fixed:-1,stretch:0}];for(let[f,_]of o){let y=d[d.length-1];d.push({fixed:f-y.stretch,stretch:y.stretch}),d.push({fixed:f-y.stretch,stretch:y.stretch+(_-f)})}return d.push({fixed:t+Sh,stretch:r}),d}function _f(o,t,r,d){return o/t*r+d}function yf(o,t,r,d){return o-t*r/d}class vf{constructor(t,r,d,f,_,y,b,w,S,P){var A;if(this.boxStartIndex=t.length,S){let O=y.top,z=y.bottom,B=y.collisionPadding;B&&(O-=B[1],z+=B[3]);let U=z-O;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{let O=!((A=y.image)===null||A===void 0)&&A.content&&(y.image.textFitWidth||y.image.textFitHeight)?$v(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};O.y1=O.y1*b-w[0],O.y2=O.y2*b+w[2],O.x1=O.x1*b-w[3],O.x2=O.x2*b+w[1];let z=y.collisionPadding;if(z&&(O.x1-=z[0]*b,O.y1-=z[1]*b,O.x2+=z[2]*b,O.y2+=z[3]*b),P){let B=new $e(O.x1,O.y1),U=new $e(O.x2,O.y1),W=new $e(O.x1,O.y2),ie=new $e(O.x2,O.y2),pe=P*Math.PI/180;B._rotate(pe),U._rotate(pe),W._rotate(pe),ie._rotate(pe),O.x1=Math.min(B.x,U.x,W.x,ie.x),O.x2=Math.max(B.x,U.x,W.x,ie.x),O.y1=Math.min(B.y,U.y,W.y,ie.y),O.y2=Math.max(B.y,U.y,W.y,ie.y)}t.emplaceBack(r.x,r.y,O.x1,O.y1,O.x2,O.y2,d,f,_)}this.boxEndIndex=t.length}}class sM{constructor(t=[],r=(d,f)=>d<f?-1:d>f?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;let t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:r,compare:d}=this,f=r[t];for(;t>0;){let _=t-1>>1,y=r[_];if(d(f,y)>=0)break;r[t]=y,t=_}r[t]=f}_down(t){let{data:r,compare:d}=this,f=this.length>>1,_=r[t];for(;t<f;){let y=1+(t<<1),b=y+1;if(b<this.length&&d(r[b],r[y])<0&&(y=b),d(r[y],_)>=0)break;r[t]=r[y],t=y}r[t]=_}}function aM(o,t=1,r=!1){let d=1/0,f=1/0,_=-1/0,y=-1/0,b=o[0];for(let z=0;z<b.length;z++){let B=b[z];(!z||B.x<d)&&(d=B.x),(!z||B.y<f)&&(f=B.y),(!z||B.x>_)&&(_=B.x),(!z||B.y>y)&&(y=B.y)}let w=Math.min(_-d,y-f),S=w/2,P=new sM([],lM);if(w===0)return new $e(d,f);for(let z=d;z<_;z+=w)for(let B=f;B<y;B+=w)P.push(new Xd(z+S,B+S,S,o));let A=function(z){let B=0,U=0,W=0,ie=z[0];for(let pe=0,oe=ie.length,L=oe-1;pe<oe;L=pe++){let q=ie[pe],ae=ie[L],Te=q.x*ae.y-ae.x*q.y;U+=(q.x+ae.x)*Te,W+=(q.y+ae.y)*Te,B+=3*Te}return new Xd(U/B,W/B,0,z)}(o),O=P.length;for(;P.length;){let z=P.pop();(z.d>A.d||!A.d)&&(A=z,r&&console.log("found best %d after %d probes",Math.round(1e4*z.d)/1e4,O)),z.max-A.d<=t||(S=z.h/2,P.push(new Xd(z.p.x-S,z.p.y-S,S,o)),P.push(new Xd(z.p.x+S,z.p.y-S,S,o)),P.push(new Xd(z.p.x-S,z.p.y+S,S,o)),P.push(new Xd(z.p.x+S,z.p.y+S,S,o)),O+=4)}return r&&(console.log(`num probes: ${O}`),console.log(`best distance: ${A.d}`)),A.p}function lM(o,t){return t.max-o.max}function Xd(o,t,r,d){this.p=new $e(o,t),this.h=r,this.d=function(f,_){let y=!1,b=1/0;for(let w=0;w<_.length;w++){let S=_[w];for(let P=0,A=S.length,O=A-1;P<A;O=P++){let z=S[P],B=S[O];z.y>f.y!=B.y>f.y&&f.x<(B.x-z.x)*(f.y-z.y)/(B.y-z.y)+z.x&&(y=!y),b=Math.min(b,Qy(f,z,B))}}return(y?1:-1)*Math.sqrt(b)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var nr;h.aB=void 0,(nr=h.aB||(h.aB={}))[nr.center=1]="center",nr[nr.left=2]="left",nr[nr.right=3]="right",nr[nr.top=4]="top",nr[nr.bottom=5]="bottom",nr[nr["top-left"]=6]="top-left",nr[nr["top-right"]=7]="top-right",nr[nr["bottom-left"]=8]="bottom-left",nr[nr["bottom-right"]=9]="bottom-right";let zl=7,__=Number.POSITIVE_INFINITY;function vb(o,t){return t[1]!==__?function(r,d,f){let _=0,y=0;switch(d=Math.abs(d),f=Math.abs(f),r){case"top-right":case"top-left":case"top":y=f-zl;break;case"bottom-right":case"bottom-left":case"bottom":y=-f+zl}switch(r){case"top-right":case"bottom-right":case"right":_=-d;break;case"top-left":case"bottom-left":case"left":_=d}return[_,y]}(o,t[0],t[1]):function(r,d){let f=0,_=0;d<0&&(d=0);let y=d/Math.SQRT2;switch(r){case"top-right":case"top-left":_=y-zl;break;case"bottom-right":case"bottom-left":_=-y+zl;break;case"bottom":_=-d+zl;break;case"top":_=d-zl}switch(r){case"top-right":case"bottom-right":f=-y;break;case"top-left":case"bottom-left":f=y;break;case"left":f=d;break;case"right":f=-d}return[f,_]}(o,t[0])}function bb(o,t,r){var d;let f=o.layout,_=(d=f.get("text-variable-anchor-offset"))===null||d===void 0?void 0:d.evaluate(t,{},r);if(_){let b=_.values,w=[];for(let S=0;S<b.length;S+=2){let P=w[S]=b[S],A=b[S+1].map(O=>O*In);P.startsWith("top")?A[1]-=zl:P.startsWith("bottom")&&(A[1]+=zl),w[S+1]=A}return new Zn(w)}let y=f.get("text-variable-anchor");if(y){let b;b=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(t,{},r)*In,__]:f.get("text-offset").evaluate(t,{},r).map(S=>S*In);let w=[];for(let S of y)w.push(S,vb(S,b));return new Zn(w)}return null}function y_(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cM(o,t,r,d,f,_,y,b,w,S,P,A){let O=_.textMaxSize.evaluate(t,{});O===void 0&&(O=y);let z=o.layers[0].layout,B=z.get("icon-offset").evaluate(t,{},P),U=wb(r.horizontal),W=y/24,ie=o.tilePixelRatio*W,pe=o.tilePixelRatio*O/24,oe=o.tilePixelRatio*b,L=o.tilePixelRatio*z.get("symbol-spacing"),q=z.get("text-padding")*o.tilePixelRatio,ae=function(gt,pt,at,Yt=1){let Qi=gt.get("icon-padding").evaluate(pt,{},at),Pn=Qi&&Qi.values;return[Pn[0]*Yt,Pn[1]*Yt,Pn[2]*Yt,Pn[3]*Yt]}(z,t,P,o.tilePixelRatio),Te=z.get("text-max-angle")/180*Math.PI,Ve=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point",Ie=z.get("icon-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",Fe=z.get("symbol-placement"),He=L/2,je=z.get("icon-text-fit"),Ze;d&&je!=="none"&&(o.allowVerticalPlacement&&r.vertical&&(Ze=Gv(d,r.vertical,je,z.get("icon-text-fit-padding"),B,W)),U&&(d=Gv(d,U,je,z.get("icon-text-fit-padding"),B,W)));let ze=P?A.line.getGranularityForZoomLevel(P.z):1,nt=(gt,pt)=>{pt.x<0||pt.x>=ci||pt.y<0||pt.y>=ci||function(at,Yt,Qi,Pn,rr,_o,zr,Wn,Xi,Bn,Xn,Yn,Mr,yo,Nn,Br,kn,Vn,jn,yn,Fi,ms,Yd,gs,hM){let Kd=at.addToLineVertexArray(Yt,Qi),jc,Qd,Jd,eu,Tb=0,Eb=0,Ib=0,Pb=0,T_=-1,E_=-1,Ba={},kb=ps("");if(at.allowVerticalPlacement&&Pn.vertical){let fr=Wn.layout.get("text-rotate").evaluate(Fi,{},gs)+90;Jd=new vf(Xi,Yt,Bn,Xn,Yn,Pn.vertical,Mr,yo,Nn,fr),zr&&(eu=new vf(Xi,Yt,Bn,Xn,Yn,zr,kn,Vn,Nn,fr))}if(rr){let fr=Wn.layout.get("icon-rotate").evaluate(Fi,{}),vo=Wn.layout.get("icon-text-fit")!=="none",Uc=_b(rr,fr,Yd,vo),ys=zr?_b(zr,fr,Yd,vo):void 0;Qd=new vf(Xi,Yt,Bn,Xn,Yn,rr,kn,Vn,!1,fr),Tb=4*Uc.length;let $c=at.iconSizeData,Ys=null;$c.kind==="source"?(Ys=[Xs*Wn.layout.get("icon-size").evaluate(Fi,{})],Ys[0]>Ol&&Cn(`${at.layerIds[0]}: Value for "icon-size" is >= ${Ch}. Reduce your "icon-size".`)):$c.kind==="composite"&&(Ys=[Xs*ms.compositeIconSizes[0].evaluate(Fi,{},gs),Xs*ms.compositeIconSizes[1].evaluate(Fi,{},gs)],(Ys[0]>Ol||Ys[1]>Ol)&&Cn(`${at.layerIds[0]}: Value for "icon-size" is >= ${Ch}. Reduce your "icon-size".`)),at.addSymbols(at.icon,Uc,Ys,yn,jn,Fi,h.al.none,Yt,Kd.lineStartIndex,Kd.lineLength,-1,gs),T_=at.icon.placedSymbolArray.length-1,ys&&(Eb=4*ys.length,at.addSymbols(at.icon,ys,Ys,yn,jn,Fi,h.al.vertical,Yt,Kd.lineStartIndex,Kd.lineLength,-1,gs),E_=at.icon.placedSymbolArray.length-1)}let Ab=Object.keys(Pn.horizontal);for(let fr of Ab){let vo=Pn.horizontal[fr];if(!jc){kb=ps(vo.text);let ys=Wn.layout.get("text-rotate").evaluate(Fi,{},gs);jc=new vf(Xi,Yt,Bn,Xn,Yn,vo,Mr,yo,Nn,ys)}let Uc=vo.positionedLines.length===1;if(Ib+=xb(at,Yt,vo,_o,Wn,Nn,Fi,Br,Kd,Pn.vertical?h.al.horizontal:h.al.horizontalOnly,Uc?Ab:[fr],Ba,T_,ms,gs),Uc)break}Pn.vertical&&(Pb+=xb(at,Yt,Pn.vertical,_o,Wn,Nn,Fi,Br,Kd,h.al.vertical,["vertical"],Ba,E_,ms,gs));let pM=jc?jc.boxStartIndex:at.collisionBoxArray.length,fM=jc?jc.boxEndIndex:at.collisionBoxArray.length,mM=Jd?Jd.boxStartIndex:at.collisionBoxArray.length,gM=Jd?Jd.boxEndIndex:at.collisionBoxArray.length,_M=Qd?Qd.boxStartIndex:at.collisionBoxArray.length,yM=Qd?Qd.boxEndIndex:at.collisionBoxArray.length,vM=eu?eu.boxStartIndex:at.collisionBoxArray.length,bM=eu?eu.boxEndIndex:at.collisionBoxArray.length,_s=-1,xf=(fr,vo)=>fr&&fr.circleDiameter?Math.max(fr.circleDiameter,vo):vo;_s=xf(jc,_s),_s=xf(Jd,_s),_s=xf(Qd,_s),_s=xf(eu,_s);let Db=_s>-1?1:0;Db&&(_s*=hM/In),at.glyphOffsetArray.length>=qd.MAX_GLYPHS&&Cn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fi.sortKey!==void 0&&at.addToSortKeyRanges(at.symbolInstances.length,Fi.sortKey);let xM=bb(Wn,Fi,gs),[wM,CM]=function(fr,vo){let Uc=fr.length,ys=vo?.values;if(ys?.length>0)for(let $c=0;$c<ys.length;$c+=2){let Ys=ys[$c+1];fr.emplaceBack(h.aB[ys[$c]],Ys[0],Ys[1])}return[Uc,fr.length]}(at.textAnchorOffsets,xM);at.symbolInstances.emplaceBack(Yt.x,Yt.y,Ba.right>=0?Ba.right:-1,Ba.center>=0?Ba.center:-1,Ba.left>=0?Ba.left:-1,Ba.vertical||-1,T_,E_,kb,pM,fM,mM,gM,_M,yM,vM,bM,Bn,Ib,Pb,Tb,Eb,Db,0,Mr,_s,wM,CM)}(o,pt,gt,r,d,f,Ze,o.layers[0],o.collisionBoxArray,t.index,t.sourceLayerIndex,o.index,ie,[q,q,q,q],Ve,w,oe,ae,Ie,B,t,_,S,P,y)};if(Fe==="line")for(let gt of ub(t.geometry,0,0,ci,ci)){let pt=Vc(gt,ze),at=oM(pt,L,Te,r.vertical||U,d,24,pe,o.overscaling,ci);for(let Yt of at)U&&dM(o,U.text,He,Yt)||nt(pt,Yt)}else if(Fe==="line-center"){for(let gt of t.geometry)if(gt.length>1){let pt=Vc(gt,ze),at=rM(pt,Te,r.vertical||U,d,24,pe);at&&nt(pt,at)}}else if(t.type==="Polygon")for(let gt of wa(t.geometry,0)){let pt=aM(gt,16);nt(Vc(gt[0],ze,!0),new Ll(pt.x,pt.y,0))}else if(t.type==="LineString")for(let gt of t.geometry){let pt=Vc(gt,ze);nt(pt,new Ll(pt[0].x,pt[0].y,0))}else if(t.type==="Point")for(let gt of t.geometry)for(let pt of gt)nt([pt],new Ll(pt.x,pt.y,0))}function xb(o,t,r,d,f,_,y,b,w,S,P,A,O,z,B){let U=function(pe,oe,L,q,ae,Te,Ve,Ie){let Fe=q.layout.get("text-rotate").evaluate(Te,{})*Math.PI/180,He=[];for(let je of oe.positionedLines)for(let Ze of je.positionedGlyphs){if(!Ze.rect)continue;let ze=Ze.rect||{},nt=z2+1,gt=!0,pt=1,at=0,Yt=(ae||Ie)&&Ze.vertical,Qi=Ze.metrics.advance*Ze.scale/2;if(Ie&&oe.verticalizable&&(at=je.lineOffset/2-(Ze.imageName?-(In-Ze.metrics.width*Ze.scale)/2:(Ze.scale-1)*In)),Ze.imageName){let Vn=Ve[Ze.imageName];gt=Vn.sdf,pt=Vn.pixelRatio,nt=Lr/pt}let Pn=ae?[Ze.x+Qi,Ze.y]:[0,0],rr=ae?[0,0]:[Ze.x+Qi+L[0],Ze.y+L[1]-at],_o=[0,0];Yt&&(_o=rr,rr=[0,0]);let zr=Ze.metrics.isDoubleResolution?2:1,Wn=(Ze.metrics.left-nt)*Ze.scale-Qi+rr[0],Xi=(-Ze.metrics.top-nt)*Ze.scale+rr[1],Bn=Wn+ze.w/zr*Ze.scale/pt,Xn=Xi+ze.h/zr*Ze.scale/pt,Yn=new $e(Wn,Xi),Mr=new $e(Bn,Xi),yo=new $e(Wn,Xn),Nn=new $e(Bn,Xn);if(Yt){let Vn=new $e(-Qi,Qi-uf),jn=-Math.PI/2,yn=In/2-Qi,Fi=new $e(5-uf-yn,-(Ze.imageName?yn:0)),ms=new $e(..._o);Yn._rotateAround(jn,Vn)._add(Fi)._add(ms),Mr._rotateAround(jn,Vn)._add(Fi)._add(ms),yo._rotateAround(jn,Vn)._add(Fi)._add(ms),Nn._rotateAround(jn,Vn)._add(Fi)._add(ms)}if(Fe){let Vn=Math.sin(Fe),jn=Math.cos(Fe),yn=[jn,-Vn,Vn,jn];Yn._matMult(yn),Mr._matMult(yn),yo._matMult(yn),Nn._matMult(yn)}let Br=new $e(0,0),kn=new $e(0,0);He.push({tl:Yn,tr:Mr,bl:yo,br:Nn,tex:ze,writingMode:oe.writingMode,glyphOffset:Pn,sectionIndex:Ze.sectionIndex,isSDF:gt,pixelOffsetTL:Br,pixelOffsetBR:kn,minFontScaleX:0,minFontScaleY:0})}return He}(0,r,b,f,_,y,d,o.allowVerticalPlacement),W=o.textSizeData,ie=null;W.kind==="source"?(ie=[Xs*f.layout.get("text-size").evaluate(y,{})],ie[0]>Ol&&Cn(`${o.layerIds[0]}: Value for "text-size" is >= ${Ch}. Reduce your "text-size".`)):W.kind==="composite"&&(ie=[Xs*z.compositeTextSizes[0].evaluate(y,{},B),Xs*z.compositeTextSizes[1].evaluate(y,{},B)],(ie[0]>Ol||ie[1]>Ol)&&Cn(`${o.layerIds[0]}: Value for "text-size" is >= ${Ch}. Reduce your "text-size".`)),o.addSymbols(o.text,U,ie,b,_,y,S,t,w.lineStartIndex,w.lineLength,O,B);for(let pe of P)A[pe]=o.text.placedSymbolArray.length-1;return 4*U.length}function wb(o){for(let t in o)return o[t];return null}function dM(o,t,r,d){let f=o.compareText;if(t in f){let _=f[t];for(let y=_.length-1;y>=0;y--)if(d.dist(_[y])<r)return!0}else f[t]=[];return f[t].push(d),!1}let Cb=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class v_{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,d]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let f=d>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);let _=Cb[15&d];if(!_)throw new Error("Unrecognized array type.");let[y]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new v_(b,y,_,t)}constructor(t,r=64,d=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=d,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let _=Cb.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-b%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${d}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+b+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){let d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=t,this.coords[this._pos++]=r,d}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return b_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,d,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:_,coords:y,nodeSize:b}=this,w=[0,_.length-1,0],S=[];for(;w.length;){let P=w.pop()||0,A=w.pop()||0,O=w.pop()||0;if(A-O<=b){for(let W=O;W<=A;W++){let ie=y[2*W],pe=y[2*W+1];ie>=t&&ie<=d&&pe>=r&&pe<=f&&S.push(_[W])}continue}let z=O+A>>1,B=y[2*z],U=y[2*z+1];B>=t&&B<=d&&U>=r&&U<=f&&S.push(_[z]),(P===0?t<=B:r<=U)&&(w.push(O),w.push(z-1),w.push(1-P)),(P===0?d>=B:f>=U)&&(w.push(z+1),w.push(A),w.push(1-P))}return S}within(t,r,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:f,coords:_,nodeSize:y}=this,b=[0,f.length-1,0],w=[],S=d*d;for(;b.length;){let P=b.pop()||0,A=b.pop()||0,O=b.pop()||0;if(A-O<=y){for(let W=O;W<=A;W++)Sb(_[2*W],_[2*W+1],t,r)<=S&&w.push(f[W]);continue}let z=O+A>>1,B=_[2*z],U=_[2*z+1];Sb(B,U,t,r)<=S&&w.push(f[z]),(P===0?t-d<=B:r-d<=U)&&(b.push(O),b.push(z-1),b.push(1-P)),(P===0?t+d>=B:r+d>=U)&&(b.push(z+1),b.push(A),b.push(1-P))}return w}}function b_(o,t,r,d,f,_){if(f-d<=r)return;let y=d+f>>1;Mb(o,t,y,d,f,_),b_(o,t,r,d,y-1,1-_),b_(o,t,r,y+1,f,1-_)}function Mb(o,t,r,d,f,_){for(;f>d;){if(f-d>600){let S=f-d+1,P=r-d+1,A=Math.log(S),O=.5*Math.exp(2*A/3),z=.5*Math.sqrt(A*O*(S-O)/S)*(P-S/2<0?-1:1);Mb(o,t,r,Math.max(d,Math.floor(r-P*O/S+z)),Math.min(f,Math.floor(r+(S-P)*O/S+z)),_)}let y=t[2*r+_],b=d,w=f;for(Th(o,t,d,r),t[2*f+_]>y&&Th(o,t,d,f);b<w;){for(Th(o,t,b,w),b++,w--;t[2*b+_]<y;)b++;for(;t[2*w+_]>y;)w--}t[2*d+_]===y?Th(o,t,d,w):(w++,Th(o,t,w,f)),w<=r&&(d=w+1),r<=w&&(f=w-1)}}function Th(o,t,r,d){x_(o,r,d),x_(t,2*r,2*d),x_(t,2*r+1,2*d+1)}function x_(o,t,r){let d=o[t];o[t]=o[r],o[r]=d}function Sb(o,t,r,d){let f=o-r,_=t-d;return f*f+_*_}var w_;h.co=void 0,(w_=h.co||(h.co={})).create="create",w_.load="load",w_.fullLoad="fullLoad";let bf=null,Eh=[],C_=1e3/60,M_="loadTime",S_="fullLoadTime",uM={mark(o){performance.mark(o)},frame(o){let t=o;bf!=null&&Eh.push(t-bf),bf=t},clearMetrics(){bf=null,Eh=[],performance.clearMeasures(M_),performance.clearMeasures(S_);for(let o in h.co)performance.clearMarks(h.co[o])},getPerformanceMetrics(){performance.measure(M_,h.co.create,h.co.load),performance.measure(S_,h.co.create,h.co.fullLoad);let o=performance.getEntriesByName(M_)[0].duration,t=performance.getEntriesByName(S_)[0].duration,r=Eh.length,d=1/(Eh.reduce((_,y)=>_+y,0)/r/1e3),f=Eh.filter(_=>_>C_).reduce((_,y)=>_+(y-C_)/C_,0);return{loadTime:o,fullLoadTime:t,fps:d,percentDroppedFrames:f/(r+f)*100,totalFrames:r}}};h.$=Mh,h.A=mi,h.B=Xr,h.C=Ri,h.D=dt,h.E=fe,h.F=Ag,h.G=function(o){if(nn==null){let t=o.navigator?o.navigator.userAgent:null;nn=!!o.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return nn},h.H=class{constructor(o,t){this.target=o,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new tM(()=>this.process()),this.subscription=Ao(this.target,"message",r=>this.receive(r),!1),this.globalScope=Zr(self)?o:window}registerMessageHandler(o,t){this.messageHandlers[o]=t}sendAsync(o,t){return new Promise((r,d)=>{let f=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=t?Ao(t.signal,"abort",()=>{_?.unsubscribe(),delete this.resolveRejects[f];let w={id:f,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},iM):null;this.resolveRejects[f]={resolve:w=>{_?.unsubscribe(),r(w)},reject:w=>{_?.unsubscribe(),d(w)}};let y=[],b=Object.assign(Object.assign({},o),{id:f,sourceMapId:this.mapId,origin:location.origin,data:kl(o.data,y)});this.target.postMessage(b,{transfer:y})})}receive(o){let t=o.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];let d=this.abortControllers[r];return delete this.abortControllers[r],void(d&&d.abort())}if(Zr(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;let o=this.taskQueue.shift(),t=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(o,t)}processTask(o,t){return s(this,void 0,void 0,function*(){if(t.type==="<response>"){let f=this.resolveRejects[o];return delete this.resolveRejects[o],f?void(t.error?f.reject(Ic(t.error)):f.resolve(Ic(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let r=Ic(t.data),d=new AbortController;this.abortControllers[o]=d;try{let f=yield this.messageHandlers[t.type](t.sourceMapId,r,d);this.completeTask(o,null,f)}catch(f){this.completeTask(o,f)}})}completeTask(o,t,r){let d=[];delete this.abortControllers[o];let f={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?kl(t):null,data:kl(r,d)};this.target.postMessage(f,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},h.I=s_,h.J=qr,h.K=function(){var o=new mi(16);return mi!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},h.L=function(o,t,r){var d,f,_,y,b,w,S,P,A,O,z,B,U=r[0],W=r[1],ie=r[2];return t===o?(o[12]=t[0]*U+t[4]*W+t[8]*ie+t[12],o[13]=t[1]*U+t[5]*W+t[9]*ie+t[13],o[14]=t[2]*U+t[6]*W+t[10]*ie+t[14],o[15]=t[3]*U+t[7]*W+t[11]*ie+t[15]):(f=t[1],_=t[2],y=t[3],b=t[4],w=t[5],S=t[6],P=t[7],A=t[8],O=t[9],z=t[10],B=t[11],o[0]=d=t[0],o[1]=f,o[2]=_,o[3]=y,o[4]=b,o[5]=w,o[6]=S,o[7]=P,o[8]=A,o[9]=O,o[10]=z,o[11]=B,o[12]=d*U+b*W+A*ie+t[12],o[13]=f*U+w*W+O*ie+t[13],o[14]=_*U+S*W+z*ie+t[14],o[15]=y*U+P*W+B*ie+t[15]),o},h.M=function(o,t,r){var d=r[0],f=r[1],_=r[2];return o[0]=t[0]*d,o[1]=t[1]*d,o[2]=t[2]*d,o[3]=t[3]*d,o[4]=t[4]*f,o[5]=t[5]*f,o[6]=t[6]*f,o[7]=t[7]*f,o[8]=t[8]*_,o[9]=t[9]*_,o[10]=t[10]*_,o[11]=t[11]*_,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},h.N=function(o,t,r){var d=t[0],f=t[1],_=t[2],y=t[3],b=t[4],w=t[5],S=t[6],P=t[7],A=t[8],O=t[9],z=t[10],B=t[11],U=t[12],W=t[13],ie=t[14],pe=t[15],oe=r[0],L=r[1],q=r[2],ae=r[3];return o[0]=oe*d+L*b+q*A+ae*U,o[1]=oe*f+L*w+q*O+ae*W,o[2]=oe*_+L*S+q*z+ae*ie,o[3]=oe*y+L*P+q*B+ae*pe,o[4]=(oe=r[4])*d+(L=r[5])*b+(q=r[6])*A+(ae=r[7])*U,o[5]=oe*f+L*w+q*O+ae*W,o[6]=oe*_+L*S+q*z+ae*ie,o[7]=oe*y+L*P+q*B+ae*pe,o[8]=(oe=r[8])*d+(L=r[9])*b+(q=r[10])*A+(ae=r[11])*U,o[9]=oe*f+L*w+q*O+ae*W,o[10]=oe*_+L*S+q*z+ae*ie,o[11]=oe*y+L*P+q*B+ae*pe,o[12]=(oe=r[12])*d+(L=r[13])*b+(q=r[14])*A+(ae=r[15])*U,o[13]=oe*f+L*w+q*O+ae*W,o[14]=oe*_+L*S+q*z+ae*ie,o[15]=oe*y+L*P+q*B+ae*pe,o},h.O=function(o,t){let r={};for(let d=0;d<t.length;d++){let f=t[d];f in o&&(r[f]=o[f])}return r},h.P=$e,h.Q=Fl,h.R=mo,h.S=eb,h.T=Kp,h.U=Jv,h.V=vi,h.W=bi,h.X=Mn,h.Y=go,h.Z=ci,h._=s,h.a=kr,h.a$=function(o,t,r){var d=Math.sin(r),f=Math.cos(r),_=t[4],y=t[5],b=t[6],w=t[7],S=t[8],P=t[9],A=t[10],O=t[11];return t!==o&&(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[4]=_*f+S*d,o[5]=y*f+P*d,o[6]=b*f+A*d,o[7]=w*f+O*d,o[8]=S*f-_*d,o[9]=P*f-y*d,o[10]=A*f-b*d,o[11]=O*f-w*d,o},h.a0=25,h.a1=g_,h.a2=o=>{let t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(let d of o){let f=window.document.createElement("source");ve(d)||(t.crossOrigin="Anonymous"),f.src=d,t.appendChild(f)}})},h.a3=De,h.a4=function(){return Yo++},h.a5=te,h.a6=qd,h.a7=Ra,h.a8=zc,h.a9=ab,h.aA=function(o,t,r,d,f=!1){if(!r[0]&&!r[1])return[0,0];let _=f?d==="map"?-o.bearingInRadians:0:d==="viewport"?o.bearingInRadians:0;if(_){let y=Math.sin(_),b=Math.cos(_);r=[r[0]*b-r[1]*y,r[0]*y+r[1]*b]}return[f?r[0]:ro(t,r[0],o.zoom),f?r[1]:ro(t,r[1],o.zoom)]},h.aC=c_,h.aD=y_,h.aE=l_,h.aF=v_,h.aG=Hi,h.aH=lf,h.aI=Re,h.aJ=ui,h.aK=di,h.aL=ar,h.aM=on,h.aN=ib,h.aO=function(o,t,r){return o[0]=t[0]*r,o[1]=t[1]*r,o[2]=t[2]*r,o},h.aP=function(o,t,r){return o[0]=t[0]+r[0],o[1]=t[1]+r[1],o[2]=t[2]+r[2],o},h.aQ=function(o){var t=new mi(3);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t},h.aR=function(o,t,r){return o[0]=t[0]*r[0],o[1]=t[1]*r[1],o[2]=t[2]*r[2],o[3]=t[3]*r[3],o},h.aS=function(o,t,r){return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],o},h.aT=function(o,t){var r=t[0],d=t[1],f=t[2],_=r*r+d*d+f*f;return _>0&&(_=1/Math.sqrt(_)),o[0]=t[0]*_,o[1]=t[1]*_,o[2]=t[2]*_,o},h.aU=function(o,t,r){var d=t[0],f=t[1],_=t[2],y=r[0],b=r[1],w=r[2];return o[0]=f*w-_*b,o[1]=_*y-d*w,o[2]=d*b-f*y,o},h.aV=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]},h.aW=rb,h.aX=Wd,h.aY=function(o,t,r,d,f){var _,y=1/Math.tan(t/2);return o[0]=y/r,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=y,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,f!=null&&f!==1/0?(o[10]=(f+d)*(_=1/(d-f)),o[14]=2*f*d*_):(o[10]=-1,o[14]=-2*d),o},h.aZ=function(o){var t=new mi(16);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},h.a_=function(o,t,r){var d=Math.sin(r),f=Math.cos(r),_=t[0],y=t[1],b=t[2],w=t[3],S=t[4],P=t[5],A=t[6],O=t[7];return t!==o&&(o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=_*f+S*d,o[1]=y*f+P*d,o[2]=b*f+A*d,o[3]=w*f+O*d,o[4]=S*f-_*d,o[5]=P*f-y*d,o[6]=A*f-b*d,o[7]=O*f-w*d,o},h.aa=function(o){let t={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,d,f,_)=>{let y=f||_;return t[d]=!y||y.toLowerCase(),""}),t["max-age"]){let r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},h.ab=Xt,h.ac=function(o){return Math.pow(2,o)},h.ad=li,h.ae=xn,h.af=85.051129,h.ag=tb,h.ah=function(o){return Math.log(o)/Math.LN2},h.ai=function(o){var t=o[0],r=o[1];return t*t+r*r},h.aj=function(o,t){let r=[];for(let d in o)d in t||r.push(d);return r},h.ak=function(o,t){let r=0,d=0;if(o.kind==="constant")d=o.layoutSize;else if(o.kind!=="source"){let{interpolationType:f,minZoom:_,maxZoom:y}=o,b=f?xn(Ln.interpolationFactor(f,t,_,y),0,1):0;o.kind==="camera"?d=Xr.number(o.minSize,o.maxSize,b):r=b}return{uSizeT:r,uSize:d}},h.am=function(o,{uSize:t,uSizeT:r},{lowerSize:d,upperSize:f}){return o.kind==="source"?d/Xs:o.kind==="composite"?Xr.number(d/Xs,f/Xs,r):t},h.an=function(o,t){var r=t[0],d=t[1],f=t[2],_=t[3],y=t[4],b=t[5],w=t[6],S=t[7],P=t[8],A=t[9],O=t[10],z=t[11],B=t[12],U=t[13],W=t[14],ie=t[15],pe=r*b-d*y,oe=r*w-f*y,L=r*S-_*y,q=d*w-f*b,ae=d*S-_*b,Te=f*S-_*w,Ve=P*U-A*B,Ie=P*W-O*B,Fe=P*ie-z*B,He=A*W-O*U,je=A*ie-z*U,Ze=O*ie-z*W,ze=pe*Ze-oe*je+L*He+q*Fe-ae*Ie+Te*Ve;return ze?(o[0]=(b*Ze-w*je+S*He)*(ze=1/ze),o[1]=(f*je-d*Ze-_*He)*ze,o[2]=(U*Te-W*ae+ie*q)*ze,o[3]=(O*ae-A*Te-z*q)*ze,o[4]=(w*Fe-y*Ze-S*Ie)*ze,o[5]=(r*Ze-f*Fe+_*Ie)*ze,o[6]=(W*L-B*Te-ie*oe)*ze,o[7]=(P*Te-O*L+z*oe)*ze,o[8]=(y*je-b*Fe+S*Ve)*ze,o[9]=(d*Fe-r*je-_*Ve)*ze,o[10]=(B*ae-U*L+ie*pe)*ze,o[11]=(A*L-P*ae-z*pe)*ze,o[12]=(b*Ie-y*He-w*Ve)*ze,o[13]=(r*He-d*Ie+f*Ve)*ze,o[14]=(U*oe-B*q-W*pe)*ze,o[15]=(P*q-A*oe+O*pe)*ze,o):null},h.ao=Ss,h.ap=function(o){return Math.hypot(o[0],o[1])},h.aq=function(o){return o[0]=0,o[1]=0,o},h.ar=function(o,t,r){return o[0]=t[0]*r,o[1]=t[1]*r,o},h.as=d_,h.at=Tt,h.au=function(o,t,r,d){let f=t.y-o.y,_=t.x-o.x,y=d.y-r.y,b=d.x-r.x,w=y*_-b*f;if(w===0)return null;let S=(b*(o.y-r.y)-y*(o.x-r.x))/w;return new $e(o.x+S*_,o.y+S*f)},h.av=ub,h.aw=Yy,h.ax=function(o){let t=1/0,r=1/0,d=-1/0,f=-1/0;for(let _ of o)t=Math.min(t,_.x),r=Math.min(r,_.y),d=Math.max(d,_.x),f=Math.max(f,_.y);return[t,r,d,f]},h.ay=In,h.az=ro,h.b=rn,h.b$=class extends j{},h.b0=function(){let o=new Float32Array(16);return li(o),o},h.b1=function(){let o=new Float64Array(16);return li(o),o},h.b2=function(){return new Float64Array(16)},h.b3=function(o,t,r){let d=new Float64Array(4);return function(f,_,y,b){var w=.5*Math.PI/180;_*=w,y*=w,b*=w;var S=Math.sin(_),P=Math.cos(_),A=Math.sin(y),O=Math.cos(y),z=Math.sin(b),B=Math.cos(b);f[0]=S*O*B-P*A*z,f[1]=P*A*B+S*O*z,f[2]=P*O*z-S*A*B,f[3]=P*O*B+S*A*z}(d,o,t-90,r),d},h.b4=function(o,t,r,d){var f,_,y,b,w,S=t[0],P=t[1],A=t[2],O=t[3],z=r[0],B=r[1],U=r[2],W=r[3];return(_=S*z+P*B+A*U+O*W)<0&&(_=-_,z=-z,B=-B,U=-U,W=-W),1-_>Et?(f=Math.acos(_),y=Math.sin(f),b=Math.sin((1-d)*f)/y,w=Math.sin(d*f)/y):(b=1-d,w=d),o[0]=b*S+w*z,o[1]=b*P+w*B,o[2]=b*A+w*U,o[3]=b*O+w*W,o},h.b5=function(o){let t=new Float64Array(9);var r,d,f,_,y,b,w,S,P,A,O,z,B,U,W,ie,pe,oe;A=(f=(d=o)[0])*(w=f+f),O=(_=d[1])*w,B=(y=d[2])*w,U=y*(S=_+_),ie=(b=d[3])*w,pe=b*S,oe=b*(P=y+y),(r=t)[0]=1-(z=_*S)-(W=y*P),r[3]=O-oe,r[6]=B+pe,r[1]=O+oe,r[4]=1-A-W,r[7]=U-ie,r[2]=B-pe,r[5]=U+ie,r[8]=1-A-z;let L=on(-Math.asin(xn(t[2],-1,1))),q,ae;return Math.hypot(t[5],t[8])<.001?(q=0,ae=-on(Math.atan2(t[3],t[4]))):(q=on(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ae=on(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:q,pitch:L+90,bearing:ae}},h.b6=function(o,t){return o.roll==t.roll&&o.pitch==t.pitch&&o.bearing==t.bearing},h.b7=Vt,h.b8=jd,h.b9=Hd,h.bA=function(o){if(o.type==="custom")return new eM(o);switch(o.type){case"background":return new K2(o);case"circle":return new ZC(o);case"fill":return new u2(o);case"fill-extrusion":return new v2(o);case"heatmap":return new WC(o);case"hillshade":return new YC(o);case"line":return new E2(o);case"raster":return new J2(o);case"symbol":return new mf(o)}},h.bB=lr,h.bC=function(o,t){if(!o)return[{command:"setStyle",args:[t]}];let r=[];try{if(!we(o.version,t.version))return[{command:"setStyle",args:[t]}];we(o.center,t.center)||r.push({command:"setCenter",args:[t.center]}),we(o.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),we(o.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),we(o.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),we(o.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),we(o.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),we(o.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),we(o.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),we(o.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),we(o.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),we(o.light,t.light)||r.push({command:"setLight",args:[t.light]}),we(o.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),we(o.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),we(o.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});let d={},f=[];(function(y,b,w,S){let P;for(P in b=b||{},y=y||{})Object.prototype.hasOwnProperty.call(y,P)&&(Object.prototype.hasOwnProperty.call(b,P)||Ne(P,w,S));for(P in b)Object.prototype.hasOwnProperty.call(b,P)&&(Object.prototype.hasOwnProperty.call(y,P)?we(y[P],b[P])||(y[P].type==="geojson"&&b[P].type==="geojson"&&Qe(y,b,P)?Ee(w,{command:"setGeoJSONSourceData",args:[P,b[P].data]}):We(P,b,w,S)):xe(P,b,w))})(o.sources,t.sources,f,d);let _=[];o.layers&&o.layers.forEach(y=>{"source"in y&&d[y.source]?r.push({command:"removeLayer",args:[y.id]}):_.push(y)}),r=r.concat(f),function(y,b,w){b=b||[];let S=(y=y||[]).map(It),P=b.map(It),A=y.reduce(wt,{}),O=b.reduce(wt,{}),z=S.slice(),B=Object.create(null),U,W,ie,pe,oe;for(let L=0,q=0;L<S.length;L++)U=S[L],Object.prototype.hasOwnProperty.call(O,U)?q++:(Ee(w,{command:"removeLayer",args:[U]}),z.splice(z.indexOf(U,q),1));for(let L=0,q=0;L<P.length;L++)U=P[P.length-1-L],z[z.length-1-L]!==U&&(Object.prototype.hasOwnProperty.call(A,U)?(Ee(w,{command:"removeLayer",args:[U]}),z.splice(z.lastIndexOf(U,z.length-q),1)):q++,pe=z[z.length-L],Ee(w,{command:"addLayer",args:[O[U],pe]}),z.splice(z.length-L,0,U),B[U]=!0);for(let L=0;L<P.length;L++)if(U=P[L],W=A[U],ie=O[U],!B[U]&&!we(W,ie))if(we(W.source,ie.source)&&we(W["source-layer"],ie["source-layer"])&&we(W.type,ie.type)){for(oe in ht(W.layout,ie.layout,w,U,null,"setLayoutProperty"),ht(W.paint,ie.paint,w,U,null,"setPaintProperty"),we(W.filter,ie.filter)||Ee(w,{command:"setFilter",args:[U,ie.filter]}),we(W.minzoom,ie.minzoom)&&we(W.maxzoom,ie.maxzoom)||Ee(w,{command:"setLayerZoomRange",args:[U,ie.minzoom,ie.maxzoom]}),W)Object.prototype.hasOwnProperty.call(W,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?ht(W[oe],ie[oe],w,U,oe.slice(6),"setPaintProperty"):we(W[oe],ie[oe])||Ee(w,{command:"setLayerProperty",args:[U,oe,ie[oe]]}));for(oe in ie)Object.prototype.hasOwnProperty.call(ie,oe)&&!Object.prototype.hasOwnProperty.call(W,oe)&&oe!=="layout"&&oe!=="paint"&&oe!=="filter"&&oe!=="metadata"&&oe!=="minzoom"&&oe!=="maxzoom"&&(oe.indexOf("paint.")===0?ht(W[oe],ie[oe],w,U,oe.slice(6),"setPaintProperty"):we(W[oe],ie[oe])||Ee(w,{command:"setLayerProperty",args:[U,oe,ie[oe]]}))}else Ee(w,{command:"removeLayer",args:[U]}),pe=z[z.lastIndexOf(U)+1],Ee(w,{command:"addLayer",args:[ie,pe]})}(_,t.layers,r)}catch(d){console.warn("Unable to compute style diff:",d),r=[{command:"setStyle",args:[t]}]}return r},h.bD=function(o){let t=[],r=o.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),o.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},h.bE=function o(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let d=0;d<t.length;d++)if(!o(t[d],r[d]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(let d in t)if(!o(t[d],r[d]))return!1;return!0}return t===r},h.bF=Hr,h.bG=Ko,h.bH=class extends Oi{constructor(o,t){super(o,t),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},h.bI=nf,h.bJ=class extends Oi{constructor(o,t){super(o,t),this.current=zg}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let t=1;t<16;t++)if(o[t]!==this.current[t]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},h.bK=tf,h.bL=class extends Oi{constructor(o,t){super(o,t),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},h.bM=class extends Oi{constructor(o,t){super(o,t),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},h.bN=Yi,h.bO=function(o,t){var r=Math.sin(t),d=Math.cos(t);return o[0]=d,o[1]=r,o[2]=0,o[3]=-r,o[4]=d,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},h.bP=function(o,t,r){var d=t[0],f=t[1],_=t[2];return o[0]=d*r[0]+f*r[3]+_*r[6],o[1]=d*r[1]+f*r[4]+_*r[7],o[2]=d*r[2]+f*r[5]+_*r[8],o},h.bQ=function(o,t,r,d,f,_,y){var b=1/(t-r),w=1/(d-f),S=1/(_-y);return o[0]=-2*b,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*w,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*S,o[11]=0,o[12]=(t+r)*b,o[13]=(f+d)*w,o[14]=(y+_)*S,o[15]=1,o},h.bR=class extends Oi{constructor(o,t){super(o,t),this.current=new Array}set(o){if(o!=this.current){this.current=o;let t=new Float32Array(4*o.length);for(let r=0;r<o.length;r++)t[4*r]=o[r].r,t[4*r+1]=o[r].g,t[4*r+2]=o[r].b,t[4*r+3]=o[r].a;this.gl.uniform4fv(this.location,t)}}},h.bS=class extends Oi{constructor(o,t){super(o,t),this.current=new Array}set(o){if(o!=this.current){this.current=o;let t=new Float32Array(o);this.gl.uniform1fv(this.location,t)}}},h.bT=class extends g{},h.bU=A2,h.bV=class extends x{},h.bW=Gg,h.bX=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},h.bY=sv,h.bZ=function(o,t,r){var d=t[0],f=t[1],_=t[2],y=r[3]*d+r[7]*f+r[11]*_+r[15];return o[0]=(r[0]*d+r[4]*f+r[8]*_+r[12])/(y=y||1),o[1]=(r[1]*d+r[5]*f+r[9]*_+r[13])/y,o[2]=(r[2]*d+r[6]*f+r[10]*_+r[14])/y,o},h.b_=class extends Fa{},h.ba=gh,h.bb=Gd,h.bc=oo,h.bd=tn,h.be=er,h.bf=function(o,t,r,d,f){return oo(d,f,xn((o-t)/(r-t),0,1))},h.bg=vr,h.bh=function(){return new Float64Array(3)},h.bi=function(o,t,r,d){return o[0]=t[0]+r[0]*d,o[1]=t[1]+r[1]*d,o[2]=t[2]+r[2]*d,o},h.bj=Bi,h.bk=function(){return new Float64Array(4)},h.bl=function(o,t,r,d){var f=[],_=[];return f[0]=t[0]-r[0],f[1]=t[1]-r[1],f[2]=t[2]-r[2],_[0]=f[0]*Math.cos(d)-f[1]*Math.sin(d),_[1]=f[0]*Math.sin(d)+f[1]*Math.cos(d),_[2]=f[2],o[0]=_[0]+r[0],o[1]=_[1]+r[1],o[2]=_[2]+r[2],o},h.bm=function(o,t,r,d){var f=[],_=[];return f[0]=t[0]-r[0],f[1]=t[1]-r[1],f[2]=t[2]-r[2],_[0]=f[0],_[1]=f[1]*Math.cos(d)-f[2]*Math.sin(d),_[2]=f[1]*Math.sin(d)+f[2]*Math.cos(d),o[0]=_[0]+r[0],o[1]=_[1]+r[1],o[2]=_[2]+r[2],o},h.bn=function(o,t,r,d){var f=[],_=[];return f[0]=t[0]-r[0],f[1]=t[1]-r[1],f[2]=t[2]-r[2],_[0]=f[2]*Math.sin(d)+f[0]*Math.cos(d),_[1]=f[1],_[2]=f[2]*Math.cos(d)-f[0]*Math.sin(d),o[0]=_[0]+r[0],o[1]=_[1]+r[1],o[2]=_[2]+r[2],o},h.bo=Ms,h.bp=function(o,t,r){var d=Math.sin(r),f=Math.cos(r),_=t[0],y=t[1],b=t[2],w=t[3],S=t[8],P=t[9],A=t[10],O=t[11];return t!==o&&(o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=_*f-S*d,o[1]=y*f-P*d,o[2]=b*f-A*d,o[3]=w*f-O*d,o[8]=_*d+S*f,o[9]=y*d+P*f,o[10]=b*d+A*f,o[11]=w*d+O*f,o},h.bq=function(o,t){let r=vr(o,360),d=vr(t,360),f=d-r,_=d>r?f-360:f+360;return Math.abs(f)<Math.abs(_)?f:_},h.br=function(o){return o[0]=0,o[1]=0,o[2]=0,o},h.bs=function(o,t,r,d){let f=Math.sqrt(o*o+t*t),_=Math.sqrt(r*r+d*d);o/=f,t/=f,r/=_,d/=_;let y=Math.acos(o*r+t*d);return-t*r+o*d>0?y:-y},h.bt=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]},h.bu=f_,h.bv=function(o,t){let r=vr(o,2*Math.PI),d=vr(t,2*Math.PI);return Math.min(Math.abs(r-d),Math.abs(r-d+2*Math.PI),Math.abs(r-d-2*Math.PI))},h.bw=function(){let o={},t=X.$version;for(let r in X.$root){let d=X.$root[r];if(d.required){let f=null;f=r==="version"?t:d.type==="array"?[]:{},f!=null&&(o[r]=f)}}return o},h.bx=Qu,h.by=Qn,h.bz=function(o){o=o.slice();let t=Object.create(null);for(let r=0;r<o.length;r++)t[o[r].id]=o[r];for(let r=0;r<o.length;r++)"ref"in o[r]&&(o[r]=ye(o[r],t[o[r].ref]));return o},h.c=Ai,h.c0=function(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]&&o[4]===t[4]&&o[5]===t[5]&&o[6]===t[6]&&o[7]===t[7]&&o[8]===t[8]&&o[9]===t[9]&&o[10]===t[10]&&o[11]===t[11]&&o[12]===t[12]&&o[13]===t[13]&&o[14]===t[14]&&o[15]===t[15]},h.c1=function(o,t){var r=o[0],d=o[1],f=o[2],_=o[3],y=o[4],b=o[5],w=o[6],S=o[7],P=o[8],A=o[9],O=o[10],z=o[11],B=o[12],U=o[13],W=o[14],ie=o[15],pe=t[0],oe=t[1],L=t[2],q=t[3],ae=t[4],Te=t[5],Ve=t[6],Ie=t[7],Fe=t[8],He=t[9],je=t[10],Ze=t[11],ze=t[12],nt=t[13],gt=t[14],pt=t[15];return Math.abs(r-pe)<=Et*Math.max(1,Math.abs(r),Math.abs(pe))&&Math.abs(d-oe)<=Et*Math.max(1,Math.abs(d),Math.abs(oe))&&Math.abs(f-L)<=Et*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(_-q)<=Et*Math.max(1,Math.abs(_),Math.abs(q))&&Math.abs(y-ae)<=Et*Math.max(1,Math.abs(y),Math.abs(ae))&&Math.abs(b-Te)<=Et*Math.max(1,Math.abs(b),Math.abs(Te))&&Math.abs(w-Ve)<=Et*Math.max(1,Math.abs(w),Math.abs(Ve))&&Math.abs(S-Ie)<=Et*Math.max(1,Math.abs(S),Math.abs(Ie))&&Math.abs(P-Fe)<=Et*Math.max(1,Math.abs(P),Math.abs(Fe))&&Math.abs(A-He)<=Et*Math.max(1,Math.abs(A),Math.abs(He))&&Math.abs(O-je)<=Et*Math.max(1,Math.abs(O),Math.abs(je))&&Math.abs(z-Ze)<=Et*Math.max(1,Math.abs(z),Math.abs(Ze))&&Math.abs(B-ze)<=Et*Math.max(1,Math.abs(B),Math.abs(ze))&&Math.abs(U-nt)<=Et*Math.max(1,Math.abs(U),Math.abs(nt))&&Math.abs(W-gt)<=Et*Math.max(1,Math.abs(W),Math.abs(gt))&&Math.abs(ie-pt)<=Et*Math.max(1,Math.abs(ie),Math.abs(pt))},h.c2=function(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},h.c3=o=>o.type==="symbol",h.c4=o=>o.type==="circle",h.c5=o=>o.type==="heatmap",h.c6=o=>o.type==="line",h.c7=o=>o.type==="fill",h.c8=o=>o.type==="fill-extrusion",h.c9=o=>o.type==="hillshade",h.cA=Xg,h.cB=e_,h.cC=yh,h.cD=r_,h.cE=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},h.cF=function(o,t,r,d,f){return s(this,void 0,void 0,function*(){if(bi())try{return yield Mn(o,t,r,d,f)}catch{}return function(_,y,b,w,S){let P=_.width,A=_.height;Rn&&Pr||(Rn=new OffscreenCanvas(P,A),Pr=Rn.getContext("2d",{willReadFrequently:!0})),Rn.width=P,Rn.height=A,Pr.drawImage(_,0,0,P,A);let O=Pr.getImageData(y,b,w,S);return Pr.clearRect(0,0,P,A),O.data}(o,t,r,d,f)})},h.cG=ob,h.cH=T,h.cI=Ce,h.cJ=Cv,h.cK=Fv,h.cL=vl,h.cM=hs,h.ca=o=>o.type==="raster",h.cb=o=>o.type==="background",h.cc=o=>o.type==="custom",h.cd=so,h.ce=function(o,t,r){let d=Ts(t.x-r.x,t.y-r.y),f=Ts(o.x-r.x,o.y-r.y);var _,y;return on(Math.atan2(d[0]*f[1]-d[1]*f[0],(_=d)[0]*(y=f)[0]+_[1]*y[1]))},h.cf=bn,h.cg=function(o,t){return br[t]&&(o instanceof MouseEvent||o instanceof WheelEvent)},h.ch=function(o,t){return cr[t]&&"touches"in o},h.ci=function(o){return cr[o]||br[o]},h.cj=function(o,t,r){var d=t[0],f=t[1];return o[0]=r[0]*d+r[4]*f+r[12],o[1]=r[1]*d+r[5]*f+r[13],o},h.ck=function(o,t){let{x:r,y:d}=Mh.fromLngLat(t);return!(o<0||o>25||d<0||d>=1||r<0||r>=1)},h.cl=function(o,t){return o[0]=t[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=t[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=t[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},h.cm=class extends Rc{},h.cn=uM,h.cp=function(o){return o.message===Ni},h.cq=Ei,h.cr=function(o,t){kr.REGISTERED_PROTOCOLS[o]=t},h.cs=function(o){delete kr.REGISTERED_PROTOCOLS[o]},h.ct=function(o,t){let r={};for(let f=0;f<o.length;f++){let _=t&&t[o[f].id]||Oe(o[f]);t&&(t[o[f].id]=_);let y=r[_];y||(y=r[_]=[]),y.push(o[f])}let d=[];for(let f in r)d.push(r[f]);return d},h.cu=tt,h.cv=sb,h.cw=lb,h.cx=zv,h.cy=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=ci/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;let t=o.bucket.layers[0],r=t.layout,d=t._unevaluatedLayout._values,f={layoutIconSize:d["icon-size"].possiblyEvaluate(new Ri(o.bucket.zoom+1),o.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new Ri(o.bucket.zoom+1),o.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new Ri(18))};if(o.bucket.textSizeData.kind==="composite"){let{minZoom:S,maxZoom:P}=o.bucket.textSizeData;f.compositeTextSizes=[d["text-size"].possiblyEvaluate(new Ri(S),o.canonical),d["text-size"].possiblyEvaluate(new Ri(P),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){let{minZoom:S,maxZoom:P}=o.bucket.iconSizeData;f.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new Ri(S),o.canonical),d["icon-size"].possiblyEvaluate(new Ri(P),o.canonical)]}let _=r.get("text-line-height")*In,y=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",b=r.get("text-keep-upright"),w=r.get("text-size");for(let S of o.bucket.features){let P=r.get("text-font").evaluate(S,{},o.canonical).join(","),A=w.evaluate(S,{},o.canonical),O=f.layoutTextSize.evaluate(S,{},o.canonical),z=f.layoutIconSize.evaluate(S,{},o.canonical),B={horizontal:{},vertical:void 0},U=S.text,W,ie=[0,0];if(U){let L=U.toString(),q=r.get("text-letter-spacing").evaluate(S,{},o.canonical)*In,ae=Dg(L)?q:0,Te=r.get("text-anchor").evaluate(S,{},o.canonical),Ve=bb(t,S,o.canonical);if(!Ve){let je=r.get("text-radial-offset").evaluate(S,{},o.canonical);ie=je?vb(Te,[je*In,__]):r.get("text-offset").evaluate(S,{},o.canonical).map(Ze=>Ze*In)}let Ie=y?"center":r.get("text-justify").evaluate(S,{},o.canonical),Fe=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(S,{},o.canonical)*In:1/0,He=()=>{o.bucket.allowVerticalPlacement&&zd(L)&&(B.vertical=hf(U,o.glyphMap,o.glyphPositions,o.imagePositions,P,Fe,_,Te,"left",ae,ie,h.al.vertical,!0,O,A))};if(!y&&Ve){let je=new Set;if(Ie==="auto")for(let ze=0;ze<Ve.values.length;ze+=2)je.add(y_(Ve.values[ze]));else je.add(Ie);let Ze=!1;for(let ze of je)if(!B.horizontal[ze])if(Ze)B.horizontal[ze]=B.horizontal[0];else{let nt=hf(U,o.glyphMap,o.glyphPositions,o.imagePositions,P,Fe,_,"center",ze,ae,ie,h.al.horizontal,!1,O,A);nt&&(B.horizontal[ze]=nt,Ze=nt.positionedLines.length===1)}He()}else{Ie==="auto"&&(Ie=y_(Te));let je=hf(U,o.glyphMap,o.glyphPositions,o.imagePositions,P,Fe,_,Te,Ie,ae,ie,h.al.horizontal,!1,O,A);je&&(B.horizontal[Ie]=je),He(),zd(L)&&y&&b&&(B.vertical=hf(U,o.glyphMap,o.glyphPositions,o.imagePositions,P,Fe,_,Te,Ie,ae,ie,h.al.vertical,!1,O,A))}}let pe=!1;if(S.icon&&S.icon.name){let L=o.imageMap[S.icon.name];L&&(W=Z2(o.imagePositions[S.icon.name],r.get("icon-offset").evaluate(S,{},o.canonical),r.get("icon-anchor").evaluate(S,{},o.canonical)),pe=!!L.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=pe:o.bucket.sdfIcons!==pe&&Cn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(L.pixelRatio!==o.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}let oe=wb(B.horizontal)||B.vertical;o.bucket.iconsInText=!!oe&&oe.iconsInText,(oe||W)&&cM(o.bucket,S,B,W,o.imageMap,f,O,z,ie,pe,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},h.cz=t_,h.d=ve,h.e=wn,h.f=o=>s(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));let t=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),h.g=ao,h.h=o=>new Promise((t,r)=>{let d=new Image;d.onload=()=>{t(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame(()=>{d.src=na})},d.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let f=new Blob([new Uint8Array(o)],{type:"image/png"});d.src=o.byteLength?URL.createObjectURL(f):na}),h.i=Zr,h.j=(o,t)=>xr(wn(o,{type:"json"}),t),h.k=se,h.l=Q,h.m=xr,h.n=(o,t)=>xr(wn(o,{type:"arrayBuffer"}),t),h.o=function(o){return new r_(o).readFields(O2,[])},h.p=Lv,h.q=uh,h.r=mn,h.s=Ao,h.t=Rd,h.u=Ht,h.v=X,h.w=Cn,h.x=Ku,h.y=Il,h.z=function([o,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:o*Math.cos(t)*Math.sin(r),y:o*Math.sin(t)*Math.sin(r),z:o*Math.cos(r)}}}),i("worker",["./shared"],function(h){"use strict";class s{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,Z){for(let se of H){this._layerConfigs[se.id]=se;let fe=this._layers[se.id]=h.bA(se);fe._featureFilter=h.a7(fe.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(let se of Z)delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se];this.familiesBySource={};let Q=h.ct(Object.values(this._layerConfigs),this.keyCache);for(let se of Q){let fe=se.map(xe=>this._layers[xe.id]),X=fe[0];if(X.visibility==="none")continue;let Me=X.source||"",ye=this.familiesBySource[Me];ye||(ye=this.familiesBySource[Me]={});let we=X.sourceLayer||"_geojsonTileLayer",Ee=ye[we];Ee||(Ee=ye[we]=[]),Ee.push(fe)}}}class T{constructor(H){let Z={},Q=[];for(let Me in H){let ye=H[Me],we=Z[Me]={};for(let Ee in ye){let xe=ye[+Ee];if(!xe||xe.bitmap.width===0||xe.bitmap.height===0)continue;let Ne={x:0,y:0,w:xe.bitmap.width+2,h:xe.bitmap.height+2};Q.push(Ne),we[Ee]={rect:Ne,metrics:xe.metrics}}}let{w:se,h:fe}=h.p(Q),X=new h.q({width:se||1,height:fe||1});for(let Me in H){let ye=H[Me];for(let we in ye){let Ee=ye[+we];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;let xe=Z[Me][we].rect;h.q.copy(Ee.bitmap,X,{x:0,y:0},{x:xe.x+1,y:xe.y+1},Ee.bitmap)}}this.image=X,this.positions=Z}}h.cu("GlyphAtlas",T);class Y{constructor(H){this.tileID=new h.Y(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId,this.inFlightDependencies=[]}parse(H,Z,Q,se,fe){return h._(this,void 0,void 0,function*(){this.status="parsing",this.data=H,this.collisionBoxArray=new h.a5;let X=new h.cv(Object.keys(H.layers).sort()),Me=new h.cw(this.tileID,this.promoteId);Me.bucketLayerIDs=[];let ye={},we={featureIndex:Me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Q,subdivisionGranularity:fe},Ee=Z.familiesBySource[this.source];for(let xt in Ee){let Be=H.layers[xt];if(!Be)continue;Be.version===1&&h.w(`Vector tile source "${this.source}" layer "${xt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let mt=X.encode(xt),Pt=[];for(let St=0;St<Be.length;St++){let Vi=Be.feature(St),Jn=Me.getId(Vi,xt);Pt.push({feature:Vi,id:Jn,index:St,sourceLayerIndex:mt})}for(let St of Ee[xt]){let Vi=St[0];Vi.source!==this.source&&h.w(`layer.source = ${Vi.source} does not equal this.source = ${this.source}`),Vi.minzoom&&this.zoom<Math.floor(Vi.minzoom)||Vi.maxzoom&&this.zoom>=Vi.maxzoom||Vi.visibility!=="none"&&(K(St,this.zoom,Q),(ye[Vi.id]=Vi.createBucket({index:Me.bucketLayerIDs.length,layers:St,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mt,sourceID:this.source})).populate(Pt,we,this.tileID.canonical),Me.bucketLayerIDs.push(St.map(Jn=>Jn.id)))}}let xe=h.bF(we.glyphDependencies,xt=>Object.keys(xt).map(Number));this.inFlightDependencies.forEach(xt=>xt?.abort()),this.inFlightDependencies=[];let Ne=Promise.resolve({});if(Object.keys(xe).length){let xt=new AbortController;this.inFlightDependencies.push(xt),Ne=se.sendAsync({type:"GG",data:{stacks:xe,source:this.source,tileID:this.tileID,type:"glyphs"}},xt)}let We=Object.keys(we.iconDependencies),Qe=Promise.resolve({});if(We.length){let xt=new AbortController;this.inFlightDependencies.push(xt),Qe=se.sendAsync({type:"GI",data:{icons:We,source:this.source,tileID:this.tileID,type:"icons"}},xt)}let ht=Object.keys(we.patternDependencies),It=Promise.resolve({});if(ht.length){let xt=new AbortController;this.inFlightDependencies.push(xt),It=se.sendAsync({type:"GI",data:{icons:ht,source:this.source,tileID:this.tileID,type:"patterns"}},xt)}let[wt,De,ni]=yield Promise.all([Ne,Qe,It]),Bt=new T(wt),ri=new h.cx(De,ni);for(let xt in ye){let Be=ye[xt];Be instanceof h.a6?(K(Be.layers,this.zoom,Q),h.cy({bucket:Be,glyphMap:wt,glyphPositions:Bt.positions,imageMap:De,imagePositions:ri.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:we.subdivisionGranularity})):Be.hasPattern&&(Be instanceof h.cz||Be instanceof h.cA||Be instanceof h.cB)&&(K(Be.layers,this.zoom,Q),Be.addFeatures(we,this.tileID.canonical,ri.patternPositions))}return this.status="done",{buckets:Object.values(ye).filter(xt=>!xt.isEmpty()),featureIndex:Me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Bt.image,imageAtlas:ri,glyphMap:this.returnDependencies?wt:null,iconMap:this.returnDependencies?De:null,glyphPositions:this.returnDependencies?Bt.positions:null}})}}function K(ve,H,Z){let Q=new h.C(H);for(let se of ve)se.recalculate(Q,Z)}class Ce{constructor(H,Z,Q){this.actor=H,this.layerIndex=Z,this.availableImages=Q,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(H,Z){return h._(this,void 0,void 0,function*(){let Q=yield h.n(H.request,Z);try{return{vectorTile:new h.cC.VectorTile(new h.cD(Q.data)),rawData:Q.data,cacheControl:Q.cacheControl,expires:Q.expires}}catch(se){let fe=new Uint8Array(Q.data),X=`Unable to parse the tile at ${H.request.url}, `;throw X+=fe[0]===31&&fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${se.message}`,new Error(X)}})}loadTile(H){return h._(this,void 0,void 0,function*(){let Z=H.uid,Q=!!(H&&H.request&&H.request.collectResourceTiming)&&new h.cE(H.request),se=new Y(H);this.loading[Z]=se;let fe=new AbortController;se.abort=fe;try{let X=yield this.loadVectorTile(H,fe);if(delete this.loading[Z],!X)return null;let Me=X.rawData,ye={};X.expires&&(ye.expires=X.expires),X.cacheControl&&(ye.cacheControl=X.cacheControl);let we={};if(Q){let xe=Q.finish();xe&&(we.resourceTiming=JSON.parse(JSON.stringify(xe)))}se.vectorTile=X.vectorTile;let Ee=se.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity);this.loaded[Z]=se,this.fetching[Z]={rawTileData:Me,cacheControl:ye,resourceTiming:we};try{let xe=yield Ee;return h.e({rawTileData:Me.slice(0)},xe,ye,we)}finally{delete this.fetching[Z]}}catch(X){throw delete this.loading[Z],se.status="done",this.loaded[Z]=se,X}})}reloadTile(H){return h._(this,void 0,void 0,function*(){let Z=H.uid;if(!this.loaded||!this.loaded[Z])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let Q=this.loaded[Z];if(Q.showCollisionBoxes=H.showCollisionBoxes,Q.status==="parsing"){let se=yield Q.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity),fe;if(this.fetching[Z]){let{rawTileData:X,cacheControl:Me,resourceTiming:ye}=this.fetching[Z];delete this.fetching[Z],fe=h.e({rawTileData:X.slice(0)},se,Me,ye)}else fe=se;return fe}if(Q.status==="done"&&Q.vectorTile)return Q.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity)})}abortTile(H){return h._(this,void 0,void 0,function*(){let Z=this.loading,Q=H.uid;Z&&Z[Q]&&Z[Q].abort&&(Z[Q].abort.abort(),delete Z[Q])})}removeTile(H){return h._(this,void 0,void 0,function*(){this.loaded&&this.loaded[H.uid]&&delete this.loaded[H.uid]})}}class be{constructor(){this.loaded={}}loadTile(H){return h._(this,void 0,void 0,function*(){let{uid:Z,encoding:Q,rawImageData:se,redFactor:fe,greenFactor:X,blueFactor:Me,baseShift:ye}=H,we=se.width+2,Ee=se.height+2,xe=h.b(se)?new h.R({width:we,height:Ee},yield h.cF(se,-1,-1,we,Ee)):se,Ne=new h.cG(Z,xe,Q,fe,X,Me,ye);return this.loaded=this.loaded||{},this.loaded[Z]=Ne,Ne})}removeTile(H){let Z=this.loaded,Q=H.uid;Z&&Z[Q]&&delete Z[Q]}}var G,$e,ft=function(){if($e)return G;function ve(Z,Q){if(Z.length!==0){H(Z[0],Q);for(var se=1;se<Z.length;se++)H(Z[se],!Q)}}function H(Z,Q){for(var se=0,fe=0,X=0,Me=Z.length,ye=Me-1;X<Me;ye=X++){var we=(Z[X][0]-Z[ye][0])*(Z[ye][1]+Z[X][1]),Ee=se+we;fe+=Math.abs(se)>=Math.abs(we)?se-Ee+we:we-Ee+se,se=Ee}se+fe>=0!=!!Q&&Z.reverse()}return $e=1,G=function Z(Q,se){var fe,X=Q&&Q.type;if(X==="FeatureCollection")for(fe=0;fe<Q.features.length;fe++)Z(Q.features[fe],se);else if(X==="GeometryCollection")for(fe=0;fe<Q.geometries.length;fe++)Z(Q.geometries[fe],se);else if(X==="Feature")Z(Q.geometry,se);else if(X==="Polygon")ve(Q.coordinates,se);else if(X==="MultiPolygon")for(fe=0;fe<Q.coordinates.length;fe++)ve(Q.coordinates[fe],se);return Q}}(),Ct=h.cH(ft);let ut=h.cC.VectorTileFeature.prototype.toGeoJSON;class lt{constructor(H){this._feature=H,this.extent=h.Z,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(this._feature.type===1){let H=[];for(let Z of this._feature.geometry)H.push([new h.P(Z[0],Z[1])]);return H}{let H=[];for(let Z of this._feature.geometry){let Q=[];for(let se of Z)Q.push(new h.P(se[0],se[1]));H.push(Q)}return H}}toGeoJSON(H,Z,Q){return ut.call(this,H,Z,Q)}}class vi{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.Z,this.length=H.length,this._features=H}feature(H){return new lt(this._features[H])}}var bi,Et,mi,Yi={exports:{}},li=function(){if(mi)return Yi.exports;mi=1;var ve=h.cK(),H=function(){if(Et)return bi;Et=1;var Ee=h.cI(),xe=h.cJ().VectorTileFeature;function Ne(Qe,ht){this.options=ht||{},this.features=Qe,this.length=Qe.length}function We(Qe,ht){this.id=typeof Qe.id=="number"?Qe.id:void 0,this.type=Qe.type,this.rawGeometry=Qe.type===1?[Qe.geometry]:Qe.geometry,this.properties=Qe.tags,this.extent=ht||4096}return bi=Ne,Ne.prototype.feature=function(Qe){return new We(this.features[Qe],this.options.extent)},We.prototype.loadGeometry=function(){var Qe=this.rawGeometry;this.geometry=[];for(var ht=0;ht<Qe.length;ht++){for(var It=Qe[ht],wt=[],De=0;De<It.length;De++)wt.push(new Ee(It[De][0],It[De][1]));this.geometry.push(wt)}return this.geometry},We.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Qe=this.geometry,ht=1/0,It=-1/0,wt=1/0,De=-1/0,ni=0;ni<Qe.length;ni++)for(var Bt=Qe[ni],ri=0;ri<Bt.length;ri++){var xt=Bt[ri];ht=Math.min(ht,xt.x),It=Math.max(It,xt.x),wt=Math.min(wt,xt.y),De=Math.max(De,xt.y)}return[ht,wt,It,De]},We.prototype.toGeoJSON=xe.prototype.toGeoJSON,bi}();function Z(Ee){var xe=new ve;return function(Ne,We){for(var Qe in Ne.layers)We.writeMessage(3,Q,Ne.layers[Qe])}(Ee,xe),xe.finish()}function Q(Ee,xe){var Ne;xe.writeVarintField(15,Ee.version||1),xe.writeStringField(1,Ee.name||""),xe.writeVarintField(5,Ee.extent||4096);var We={keys:[],values:[],keycache:{},valuecache:{}};for(Ne=0;Ne<Ee.length;Ne++)We.feature=Ee.feature(Ne),xe.writeMessage(2,se,We);var Qe=We.keys;for(Ne=0;Ne<Qe.length;Ne++)xe.writeStringField(3,Qe[Ne]);var ht=We.values;for(Ne=0;Ne<ht.length;Ne++)xe.writeMessage(4,we,ht[Ne])}function se(Ee,xe){var Ne=Ee.feature;Ne.id!==void 0&&xe.writeVarintField(1,Ne.id),xe.writeMessage(2,fe,Ee),xe.writeVarintField(3,Ne.type),xe.writeMessage(4,ye,Ne)}function fe(Ee,xe){var Ne=Ee.feature,We=Ee.keys,Qe=Ee.values,ht=Ee.keycache,It=Ee.valuecache;for(var wt in Ne.properties){var De=Ne.properties[wt],ni=ht[wt];if(De!==null){ni===void 0&&(We.push(wt),ht[wt]=ni=We.length-1),xe.writeVarint(ni);var Bt=typeof De;Bt!=="string"&&Bt!=="boolean"&&Bt!=="number"&&(De=JSON.stringify(De));var ri=Bt+":"+De,xt=It[ri];xt===void 0&&(Qe.push(De),It[ri]=xt=Qe.length-1),xe.writeVarint(xt)}}}function X(Ee,xe){return(xe<<3)+(7&Ee)}function Me(Ee){return Ee<<1^Ee>>31}function ye(Ee,xe){for(var Ne=Ee.loadGeometry(),We=Ee.type,Qe=0,ht=0,It=Ne.length,wt=0;wt<It;wt++){var De=Ne[wt],ni=1;We===1&&(ni=De.length),xe.writeVarint(X(1,ni));for(var Bt=We===3?De.length-1:De.length,ri=0;ri<Bt;ri++){ri===1&&We!==1&&xe.writeVarint(X(2,Bt-1));var xt=De[ri].x-Qe,Be=De[ri].y-ht;xe.writeVarint(Me(xt)),xe.writeVarint(Me(Be)),Qe+=xt,ht+=Be}We===3&&xe.writeVarint(X(7,1))}}function we(Ee,xe){var Ne=typeof Ee;Ne==="string"?xe.writeStringField(1,Ee):Ne==="boolean"?xe.writeBooleanField(7,Ee):Ne==="number"&&(Ee%1!=0?xe.writeDoubleField(3,Ee):Ee<0?xe.writeSVarintField(6,Ee):xe.writeVarintField(5,Ee))}return Yi.exports=Z,Yi.exports.fromVectorTileJs=Z,Yi.exports.fromGeojsonVt=function(Ee,xe){xe=xe||{};var Ne={};for(var We in Ee)Ne[We]=new H(Ee[We].features,xe),Ne[We].name=We,Ne[We].version=xe.version,Ne[We].extent=xe.extent;return Z({layers:Ne})},Yi.exports.GeoJSONWrapper=H,Yi.exports}(),Ir=h.cH(li);let Ms={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ve=>ve},Gi=Math.fround||(Kn=new Float32Array(1),ve=>(Kn[0]=+ve,Kn[0]));var Kn;let Bi=3,Tt=5,Gr=6;class Ss{constructor(H){this.options=Object.assign(Object.create(Ms),H),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(H){let{log:Z,minZoom:Q,maxZoom:se}=this.options;Z&&console.time("total time");let fe=`prepare ${H.length} points`;Z&&console.time(fe),this.points=H;let X=[];for(let ye=0;ye<H.length;ye++){let we=H[ye];if(!we.geometry)continue;let[Ee,xe]=we.geometry.coordinates,Ne=Gi(ro(Ee)),We=Gi(vr(xe));X.push(Ne,We,1/0,ye,-1,1),this.options.reduce&&X.push(0)}let Me=this.trees[se+1]=this._createTree(X);Z&&console.timeEnd(fe);for(let ye=se;ye>=Q;ye--){let we=+Date.now();Me=this.trees[ye]=this._createTree(this._cluster(Me,ye)),Z&&console.log("z%d: %d clusters in %dms",ye,Me.numItems,+Date.now()-we)}return Z&&console.timeEnd("total time"),this}getClusters(H,Z){let Q=((H[0]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,H[1])),fe=H[2]===180?180:((H[2]+180)%360+360)%360-180,X=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)Q=-180,fe=180;else if(Q>fe){let xe=this.getClusters([Q,se,180,X],Z),Ne=this.getClusters([-180,se,fe,X],Z);return xe.concat(Ne)}let Me=this.trees[this._limitZoom(Z)],ye=Me.range(ro(Q),vr(X),ro(fe),vr(se)),we=Me.data,Ee=[];for(let xe of ye){let Ne=this.stride*xe;Ee.push(we[Ne+Tt]>1?Ts(we,Ne,this.clusterProps):this.points[we[Ne+Bi]])}return Ee}getChildren(H){let Z=this._getOriginId(H),Q=this._getOriginZoom(H),se="No cluster with the specified id.",fe=this.trees[Q];if(!fe)throw new Error(se);let X=fe.data;if(Z*this.stride>=X.length)throw new Error(se);let Me=this.options.radius/(this.options.extent*Math.pow(2,Q-1)),ye=fe.within(X[Z*this.stride],X[Z*this.stride+1],Me),we=[];for(let Ee of ye){let xe=Ee*this.stride;X[xe+4]===H&&we.push(X[xe+Tt]>1?Ts(X,xe,this.clusterProps):this.points[X[xe+Bi]])}if(we.length===0)throw new Error(se);return we}getLeaves(H,Z,Q){let se=[];return this._appendLeaves(se,H,Z=Z||10,Q=Q||0,0),se}getTile(H,Z,Q){let se=this.trees[this._limitZoom(H)],fe=Math.pow(2,H),{extent:X,radius:Me}=this.options,ye=Me/X,we=(Q-ye)/fe,Ee=(Q+1+ye)/fe,xe={features:[]};return this._addTileFeatures(se.range((Z-ye)/fe,we,(Z+1+ye)/fe,Ee),se.data,Z,Q,fe,xe),Z===0&&this._addTileFeatures(se.range(1-ye/fe,we,1,Ee),se.data,fe,Q,fe,xe),Z===fe-1&&this._addTileFeatures(se.range(0,we,ye/fe,Ee),se.data,-1,Q,fe,xe),xe.features.length?xe:null}getClusterExpansionZoom(H){let Z=this._getOriginZoom(H)-1;for(;Z<=this.options.maxZoom;){let Q=this.getChildren(H);if(Z++,Q.length!==1)break;H=Q[0].properties.cluster_id}return Z}_appendLeaves(H,Z,Q,se,fe){let X=this.getChildren(Z);for(let Me of X){let ye=Me.properties;if(ye&&ye.cluster?fe+ye.point_count<=se?fe+=ye.point_count:fe=this._appendLeaves(H,ye.cluster_id,Q,se,fe):fe<se?fe++:H.push(Me),H.length===Q)break}return fe}_createTree(H){let Z=new h.aF(H.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Q=0;Q<H.length;Q+=this.stride)Z.add(H[Q],H[Q+1]);return Z.finish(),Z.data=H,Z}_addTileFeatures(H,Z,Q,se,fe,X){for(let Me of H){let ye=Me*this.stride,we=Z[ye+Tt]>1,Ee,xe,Ne;if(we)Ee=ci(Z,ye,this.clusterProps),xe=Z[ye],Ne=Z[ye+1];else{let ht=this.points[Z[ye+Bi]];Ee=ht.properties;let[It,wt]=ht.geometry.coordinates;xe=ro(It),Ne=vr(wt)}let We={type:1,geometry:[[Math.round(this.options.extent*(xe*fe-Q)),Math.round(this.options.extent*(Ne*fe-se))]],tags:Ee},Qe;Qe=we||this.options.generateId?Z[ye+Bi]:this.points[Z[ye+Bi]].id,Qe!==void 0&&(We.id=Qe),X.features.push(We)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,Z){let{radius:Q,extent:se,reduce:fe,minPoints:X}=this.options,Me=Q/(se*Math.pow(2,Z)),ye=H.data,we=[],Ee=this.stride;for(let xe=0;xe<ye.length;xe+=Ee){if(ye[xe+2]<=Z)continue;ye[xe+2]=Z;let Ne=ye[xe],We=ye[xe+1],Qe=H.within(ye[xe],ye[xe+1],Me),ht=ye[xe+Tt],It=ht;for(let wt of Qe){let De=wt*Ee;ye[De+2]>Z&&(It+=ye[De+Tt])}if(It>ht&&It>=X){let wt,De=Ne*ht,ni=We*ht,Bt=-1,ri=((xe/Ee|0)<<5)+(Z+1)+this.points.length;for(let xt of Qe){let Be=xt*Ee;if(ye[Be+2]<=Z)continue;ye[Be+2]=Z;let mt=ye[Be+Tt];De+=ye[Be]*mt,ni+=ye[Be+1]*mt,ye[Be+4]=ri,fe&&(wt||(wt=this._map(ye,xe,!0),Bt=this.clusterProps.length,this.clusterProps.push(wt)),fe(wt,this._map(ye,Be)))}ye[xe+4]=ri,we.push(De/It,ni/It,1/0,ri,-1,It),fe&&we.push(Bt)}else{for(let wt=0;wt<Ee;wt++)we.push(ye[xe+wt]);if(It>1)for(let wt of Qe){let De=wt*Ee;if(!(ye[De+2]<=Z)){ye[De+2]=Z;for(let ni=0;ni<Ee;ni++)we.push(ye[De+ni])}}}}return we}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,Z,Q){if(H[Z+Tt]>1){let X=this.clusterProps[H[Z+Gr]];return Q?Object.assign({},X):X}let se=this.points[H[Z+Bi]].properties,fe=this.options.map(se);return Q&&fe===se?Object.assign({},fe):fe}}function Ts(ve,H,Z){return{type:"Feature",id:ve[H+Bi],properties:ci(ve,H,Z),geometry:{type:"Point",coordinates:[(Q=ve[H],360*(Q-.5)),oo(ve[H+1])]}};var Q}function ci(ve,H,Z){let Q=ve[H+Tt],se=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q,fe=ve[H+Gr],X=fe===-1?{}:Object.assign({},Z[fe]);return Object.assign(X,{cluster:!0,cluster_id:ve[H+Bi],point_count:Q,point_count_abbreviated:se})}function ro(ve){return ve/360+.5}function vr(ve){let H=Math.sin(ve*Math.PI/180),Z=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return Z<0?0:Z>1?1:Z}function oo(ve){let H=(180-360*ve)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function tn(ve,H,Z,Q){let se=Q,fe=H+(Z-H>>1),X,Me=Z-H,ye=ve[H],we=ve[H+1],Ee=ve[Z],xe=ve[Z+1];for(let Ne=H+3;Ne<Z;Ne+=3){let We=so(ve[Ne],ve[Ne+1],ye,we,Ee,xe);if(We>se)X=Ne,se=We;else if(We===se){let Qe=Math.abs(Ne-fe);Qe<Me&&(X=Ne,Me=Qe)}}se>Q&&(X-H>3&&tn(ve,H,X,Q),ve[X+2]=se,Z-X>3&&tn(ve,X,Z,Q))}function so(ve,H,Z,Q,se,fe){let X=se-Z,Me=fe-Q;if(X!==0||Me!==0){let ye=((ve-Z)*X+(H-Q)*Me)/(X*X+Me*Me);ye>1?(Z=se,Q=fe):ye>0&&(Z+=X*ye,Q+=Me*ye)}return X=ve-Z,Me=H-Q,X*X+Me*Me}function bn(ve,H,Z,Q){let se={id:ve??null,type:H,geometry:Z,tags:Q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(H==="Point"||H==="MultiPoint"||H==="LineString")xn(se,Z);else if(H==="Polygon")xn(se,Z[0]);else if(H==="MultiLineString")for(let fe of Z)xn(se,fe);else if(H==="MultiPolygon")for(let fe of Z)xn(se,fe[0]);return se}function xn(ve,H){for(let Z=0;Z<H.length;Z+=3)ve.minX=Math.min(ve.minX,H[Z]),ve.minY=Math.min(ve.minY,H[Z+1]),ve.maxX=Math.max(ve.maxX,H[Z]),ve.maxY=Math.max(ve.maxY,H[Z+1])}function ar(ve,H,Z,Q){if(!H.geometry)return;let se=H.geometry.coordinates;if(se&&se.length===0)return;let fe=H.geometry.type,X=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2),Me=[],ye=H.id;if(Z.promoteId?ye=H.properties[Z.promoteId]:Z.generateId&&(ye=Q||0),fe==="Point")wn(se,Me);else if(fe==="MultiPoint")for(let we of se)wn(we,Me);else if(fe==="LineString")Yo(se,Me,X,!1);else if(fe==="MultiLineString"){if(Z.lineMetrics){for(let we of se)Me=[],Yo(we,Me,X,!1),ve.push(bn(ye,"LineString",Me,H.properties));return}Hr(se,Me,X,!1)}else if(fe==="Polygon")Hr(se,Me,X,!0);else{if(fe!=="MultiPolygon"){if(fe==="GeometryCollection"){for(let we of H.geometry.geometries)ar(ve,{id:ye,geometry:we,properties:H.properties},Z,Q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let we of se){let Ee=[];Hr(we,Ee,X,!0),Me.push(Ee)}}ve.push(bn(ye,fe,Me,H.properties))}function wn(ve,H){H.push(Ko(ve[0]),lr(ve[1]),0)}function Yo(ve,H,Z,Q){let se,fe,X=0;for(let ye=0;ye<ve.length;ye++){let we=Ko(ve[ye][0]),Ee=lr(ve[ye][1]);H.push(we,Ee,0),ye>0&&(X+=Q?(se*Ee-we*fe)/2:Math.sqrt(Math.pow(we-se,2)+Math.pow(Ee-fe,2))),se=we,fe=Ee}let Me=H.length-3;H[2]=1,tn(H,0,Me,Z),H[Me+2]=1,H.size=Math.abs(X),H.start=0,H.end=H.size}function Hr(ve,H,Z,Q){for(let se=0;se<ve.length;se++){let fe=[];Yo(ve[se],fe,Z,Q),H.push(fe)}}function Ko(ve){return ve/360+.5}function lr(ve){let H=Math.sin(ve*Math.PI/180),Z=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return Z<0?0:Z>1?1:Z}function $n(ve,H,Z,Q,se,fe,X,Me){if(Q/=H,fe>=(Z/=H)&&X<Q)return ve;if(X<Z||fe>=Q)return null;let ye=[];for(let we of ve){let Ee=we.geometry,xe=we.type,Ne=se===0?we.minX:we.minY,We=se===0?we.maxX:we.maxY;if(Ne>=Z&&We<Q){ye.push(we);continue}if(We<Z||Ne>=Q)continue;let Qe=[];if(xe==="Point"||xe==="MultiPoint")Cn(Ee,Qe,Z,Q,se);else if(xe==="LineString")gi(Ee,Qe,Z,Q,se,!1,Me.lineMetrics);else if(xe==="MultiLineString")nn(Ee,Qe,Z,Q,se,!1);else if(xe==="Polygon")nn(Ee,Qe,Z,Q,se,!0);else if(xe==="MultiPolygon")for(let ht of Ee){let It=[];nn(ht,It,Z,Q,se,!0),It.length&&Qe.push(It)}if(Qe.length){if(Me.lineMetrics&&xe==="LineString"){for(let ht of Qe)ye.push(bn(we.id,xe,ht,we.tags));continue}xe!=="LineString"&&xe!=="MultiLineString"||(Qe.length===1?(xe="LineString",Qe=Qe[0]):xe="MultiLineString"),xe!=="Point"&&xe!=="MultiPoint"||(xe=Qe.length===3?"Point":"MultiPoint"),ye.push(bn(we.id,xe,Qe,we.tags))}}return ye.length?ye:null}function Cn(ve,H,Z,Q,se){for(let fe=0;fe<ve.length;fe+=3){let X=ve[fe+se];X>=Z&&X<=Q&&rn(H,ve[fe],ve[fe+1],ve[fe+2])}}function gi(ve,H,Z,Q,se,fe,X){let Me=Zr(ve),ye=se===0?na:Mn,we,Ee,xe=ve.start;for(let It=0;It<ve.length-3;It+=3){let wt=ve[It],De=ve[It+1],ni=ve[It+2],Bt=ve[It+3],ri=ve[It+4],xt=se===0?wt:De,Be=se===0?Bt:ri,mt=!1;X&&(we=Math.sqrt(Math.pow(wt-Bt,2)+Math.pow(De-ri,2))),xt<Z?Be>Z&&(Ee=ye(Me,wt,De,Bt,ri,Z),X&&(Me.start=xe+we*Ee)):xt>Q?Be<Q&&(Ee=ye(Me,wt,De,Bt,ri,Q),X&&(Me.start=xe+we*Ee)):rn(Me,wt,De,ni),Be<Z&&xt>=Z&&(Ee=ye(Me,wt,De,Bt,ri,Z),mt=!0),Be>Q&&xt<=Q&&(Ee=ye(Me,wt,De,Bt,ri,Q),mt=!0),!fe&&mt&&(X&&(Me.end=xe+we*Ee),H.push(Me),Me=Zr(ve)),X&&(xe+=we)}let Ne=ve.length-3,We=ve[Ne],Qe=ve[Ne+1],ht=se===0?We:Qe;ht>=Z&&ht<=Q&&rn(Me,We,Qe,ve[Ne+2]),Ne=Me.length-3,fe&&Ne>=3&&(Me[Ne]!==Me[0]||Me[Ne+1]!==Me[1])&&rn(Me,Me[0],Me[1],Me[2]),Me.length&&H.push(Me)}function Zr(ve){let H=[];return H.size=ve.size,H.start=ve.start,H.end=ve.end,H}function nn(ve,H,Z,Q,se,fe){for(let X of ve)gi(X,H,Z,Q,se,fe,!1)}function rn(ve,H,Z,Q){ve.push(H,Z,Q)}function na(ve,H,Z,Q,se,fe){let X=(fe-H)/(Q-H);return rn(ve,fe,Z+(se-Z)*X,1),X}function Mn(ve,H,Z,Q,se,fe){let X=(fe-Z)/(se-Z);return rn(ve,H+(Q-H)*X,fe,1),X}function Rn(ve,H){let Z=[];for(let Q=0;Q<ve.length;Q++){let se=ve[Q],fe=se.type,X;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")X=Pr(se.geometry,H);else if(fe==="MultiLineString"||fe==="Polygon"){X=[];for(let Me of se.geometry)X.push(Pr(Me,H))}else if(fe==="MultiPolygon"){X=[];for(let Me of se.geometry){let ye=[];for(let we of Me)ye.push(Pr(we,H));X.push(ye)}}Z.push(bn(se.id,fe,X,se.tags))}return Z}function Pr(ve,H){let Z=[];Z.size=ve.size,ve.start!==void 0&&(Z.start=ve.start,Z.end=ve.end);for(let Q=0;Q<ve.length;Q+=3)Z.push(ve[Q]+H,ve[Q+1],ve[Q+2]);return Z}function Ao(ve,H){if(ve.transformed)return ve;let Z=1<<ve.z,Q=ve.x,se=ve.y;for(let fe of ve.features){let X=fe.geometry,Me=fe.type;if(fe.geometry=[],Me===1)for(let ye=0;ye<X.length;ye+=2)fe.geometry.push(Xt(X[ye],X[ye+1],H,Z,Q,se));else for(let ye=0;ye<X.length;ye++){let we=[];for(let Ee=0;Ee<X[ye].length;Ee+=2)we.push(Xt(X[ye][Ee],X[ye][Ee+1],H,Z,Q,se));fe.geometry.push(we)}}return ve.transformed=!0,ve}function Xt(ve,H,Z,Q,se,fe){return[Math.round(Z*(ve*Q-se)),Math.round(Z*(H*Q-fe))]}function on(ve,H,Z,Q,se){let fe=H===se.maxZoom?0:se.tolerance/((1<<H)*se.extent),X={features:[],numPoints:0,numSimplified:0,numFeatures:ve.length,source:null,x:Z,y:Q,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let Me of ve)cr(X,Me,fe,se);return X}function cr(ve,H,Z,Q){let se=H.geometry,fe=H.type,X=[];if(ve.minX=Math.min(ve.minX,H.minX),ve.minY=Math.min(ve.minY,H.minY),ve.maxX=Math.max(ve.maxX,H.maxX),ve.maxY=Math.max(ve.maxY,H.maxY),fe==="Point"||fe==="MultiPoint")for(let Me=0;Me<se.length;Me+=3)X.push(se[Me],se[Me+1]),ve.numPoints++,ve.numSimplified++;else if(fe==="LineString")br(X,se,ve,Z,!1,!1);else if(fe==="MultiLineString"||fe==="Polygon")for(let Me=0;Me<se.length;Me++)br(X,se[Me],ve,Z,fe==="Polygon",Me===0);else if(fe==="MultiPolygon")for(let Me=0;Me<se.length;Me++){let ye=se[Me];for(let we=0;we<ye.length;we++)br(X,ye[we],ve,Z,!0,we===0)}if(X.length){let Me=H.tags||null;if(fe==="LineString"&&Q.lineMetrics){Me={};for(let we in H.tags)Me[we]=H.tags[we];Me.mapbox_clip_start=se.start/se.size,Me.mapbox_clip_end=se.end/se.size}let ye={geometry:X,type:fe==="Polygon"||fe==="MultiPolygon"?3:fe==="LineString"||fe==="MultiLineString"?2:1,tags:Me};H.id!==null&&(ye.id=H.id),ve.features.push(ye)}}function br(ve,H,Z,Q,se,fe){let X=Q*Q;if(Q>0&&H.size<(se?X:Q))return void(Z.numPoints+=H.length/3);let Me=[];for(let ye=0;ye<H.length;ye+=3)(Q===0||H[ye+2]>X)&&(Z.numSimplified++,Me.push(H[ye],H[ye+1])),Z.numPoints++;se&&function(ye,we){let Ee=0;for(let xe=0,Ne=ye.length,We=Ne-2;xe<Ne;We=xe,xe+=2)Ee+=(ye[xe]-ye[We])*(ye[xe+1]+ye[We+1]);if(Ee>0===we)for(let xe=0,Ne=ye.length;xe<Ne/2;xe+=2){let We=ye[xe],Qe=ye[xe+1];ye[xe]=ye[Ne-2-xe],ye[xe+1]=ye[Ne-1-xe],ye[Ne-2-xe]=We,ye[Ne-1-xe]=Qe}}(Me,fe),ve.push(Me)}let Ni={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ai{constructor(H,Z){let Q=(Z=this.options=function(fe,X){for(let Me in X)fe[Me]=X[Me];return fe}(Object.create(Ni),Z)).debug;if(Q&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");let se=function(fe,X){let Me=[];if(fe.type==="FeatureCollection")for(let ye=0;ye<fe.features.length;ye++)ar(Me,fe.features[ye],X,ye);else ar(Me,fe.type==="Feature"?fe:{geometry:fe},X);return Me}(H,Z);this.tiles={},this.tileCoords=[],Q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),se=function(fe,X){let Me=X.buffer/X.extent,ye=fe,we=$n(fe,1,-1-Me,Me,0,-1,2,X),Ee=$n(fe,1,1-Me,2+Me,0,-1,2,X);return(we||Ee)&&(ye=$n(fe,1,-Me,1+Me,0,-1,2,X)||[],we&&(ye=Rn(we,1).concat(ye)),Ee&&(ye=ye.concat(Rn(Ee,-1)))),ye}(se,Z),se.length&&this.splitTile(se,0,0,0),Q&&(se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(H,Z,Q,se,fe,X,Me){let ye=[H,Z,Q,se],we=this.options,Ee=we.debug;for(;ye.length;){se=ye.pop(),Q=ye.pop(),Z=ye.pop(),H=ye.pop();let xe=1<<Z,Ne=kr(Z,Q,se),We=this.tiles[Ne];if(!We&&(Ee>1&&console.time("creation"),We=this.tiles[Ne]=on(H,Z,Q,se,we),this.tileCoords.push({z:Z,x:Q,y:se}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,Q,se,We.numFeatures,We.numPoints,We.numSimplified),console.timeEnd("creation"));let mt=`z${Z}`;this.stats[mt]=(this.stats[mt]||0)+1,this.total++}if(We.source=H,fe==null){if(Z===we.indexMaxZoom||We.numPoints<=we.indexMaxPoints)continue}else{if(Z===we.maxZoom||Z===fe)continue;if(fe!=null){let mt=fe-Z;if(Q!==X>>mt||se!==Me>>mt)continue}}if(We.source=null,H.length===0)continue;Ee>1&&console.time("clipping");let Qe=.5*we.buffer/we.extent,ht=.5-Qe,It=.5+Qe,wt=1+Qe,De=null,ni=null,Bt=null,ri=null,xt=$n(H,xe,Q-Qe,Q+It,0,We.minX,We.maxX,we),Be=$n(H,xe,Q+ht,Q+wt,0,We.minX,We.maxX,we);H=null,xt&&(De=$n(xt,xe,se-Qe,se+It,1,We.minY,We.maxY,we),ni=$n(xt,xe,se+ht,se+wt,1,We.minY,We.maxY,we),xt=null),Be&&(Bt=$n(Be,xe,se-Qe,se+It,1,We.minY,We.maxY,we),ri=$n(Be,xe,se+ht,se+wt,1,We.minY,We.maxY,we),Be=null),Ee>1&&console.timeEnd("clipping"),ye.push(De||[],Z+1,2*Q,2*se),ye.push(ni||[],Z+1,2*Q,2*se+1),ye.push(Bt||[],Z+1,2*Q+1,2*se),ye.push(ri||[],Z+1,2*Q+1,2*se+1)}}getTile(H,Z,Q){H=+H,Z=+Z,Q=+Q;let se=this.options,{extent:fe,debug:X}=se;if(H<0||H>24)return null;let Me=1<<H,ye=kr(H,Z=Z+Me&Me-1,Q);if(this.tiles[ye])return Ao(this.tiles[ye],fe);X>1&&console.log("drilling down to z%d-%d-%d",H,Z,Q);let we,Ee=H,xe=Z,Ne=Q;for(;!we&&Ee>0;)Ee--,xe>>=1,Ne>>=1,we=this.tiles[kr(Ee,xe,Ne)];return we&&we.source?(X>1&&(console.log("found parent tile z%d-%d-%d",Ee,xe,Ne),console.time("drilling down")),this.splitTile(we.source,Ee,xe,Ne,H,Z,Q),X>1&&console.timeEnd("drilling down"),this.tiles[ye]?Ao(this.tiles[ye],fe):null):null}}function kr(ve,H,Z){return 32*((1<<ve)*Z+H)+ve}function ao(ve,H){return H?ve.properties[H]:ve.id}function qr(ve,H){if(ve==null)return!0;if(ve.type==="Feature")return ao(ve,H)!=null;if(ve.type==="FeatureCollection"){let Z=new Set;for(let Q of ve.features){let se=ao(Q,H);if(se==null||Z.has(se))return!1;Z.add(se)}return!0}return!1}function Ei(ve,H){let Z=new Map;if(ve!=null)if(ve.type==="Feature")Z.set(ao(ve,H),ve);else for(let Q of ve.features)Z.set(ao(Q,H),Q);return Z}class Qn extends Ce{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(H,Z){return h._(this,void 0,void 0,function*(){let Q=H.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let se=this._geoJSONIndex.getTile(Q.z,Q.x,Q.y);if(!se)return null;let fe=new vi(se.features),X=Ir(fe);return X.byteOffset===0&&X.byteLength===X.buffer.byteLength||(X=new Uint8Array(X)),{vectorTile:fe,rawData:X.buffer}})}loadData(H){return h._(this,void 0,void 0,function*(){var Z;(Z=this._pendingRequest)===null||Z===void 0||Z.abort();let Q=!!(H&&H.request&&H.request.collectResourceTiming)&&new h.cE(H.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(H,this._pendingRequest),this._geoJSONIndex=H.cluster?new Ss(function({superclusterOptions:X,clusterProperties:Me}){if(!Me||!X)return X;let ye={},we={},Ee={accumulated:null,zoom:0},xe={properties:null},Ne=Object.keys(Me);for(let We of Ne){let[Qe,ht]=Me[We],It=h.cL(ht),wt=h.cL(typeof Qe=="string"?[Qe,["accumulated"],["get",We]]:Qe);ye[We]=It.value,we[We]=wt.value}return X.map=We=>{xe.properties=We;let Qe={};for(let ht of Ne)Qe[ht]=ye[ht].evaluate(Ee,xe);return Qe},X.reduce=(We,Qe)=>{xe.properties=Qe;for(let ht of Ne)Ee.accumulated=We[ht],We[ht]=we[ht].evaluate(Ee,xe)},X}(H)).load((yield this._pendingData).features):(se=yield this._pendingData,new Ai(se,H.geojsonVtOptions)),this.loaded={};let fe={};if(Q){let X=Q.finish();X&&(fe.resourceTiming={},fe.resourceTiming[H.source]=JSON.parse(JSON.stringify(X)))}return fe}catch(fe){if(delete this._pendingRequest,h.cp(fe))return{abandoned:!0};throw fe}var se})}getData(){return h._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(H){let Z=this.loaded;return Z&&Z[H.uid]?super.reloadTile(H):this.loadTile(H)}loadAndProcessGeoJSON(H,Z){return h._(this,void 0,void 0,function*(){let Q=yield this.loadGeoJSON(H,Z);if(delete this._pendingRequest,typeof Q!="object")throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`);if(Ct(Q,!0),H.filter){let se=h.cL(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(se.result==="error")throw new Error(se.value.map(X=>`${X.key}: ${X.message}`).join(", "));Q={type:"FeatureCollection",features:Q.features.filter(X=>se.value.evaluate({zoom:0},X))}}return Q})}loadGeoJSON(H,Z){return h._(this,void 0,void 0,function*(){let{promoteId:Q}=H;if(H.request){let se=yield h.j(H.request,Z);return this._dataUpdateable=qr(se.data,Q)?Ei(se.data,Q):void 0,se.data}if(typeof H.data=="string")try{let se=JSON.parse(H.data);return this._dataUpdateable=qr(se,Q)?Ei(se,Q):void 0,se}catch{throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`)}if(!H.dataDiff)throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${H.source}`);return function(se,fe,X){var Me,ye,we,Ee;if(fe.removeAll&&se.clear(),fe.remove)for(let xe of fe.remove)se.delete(xe);if(fe.add)for(let xe of fe.add){let Ne=ao(xe,X);Ne!=null&&se.set(Ne,xe)}if(fe.update)for(let xe of fe.update){let Ne=se.get(xe.id);if(Ne==null)continue;let We=!xe.removeAllProperties&&(((Me=xe.removeProperties)===null||Me===void 0?void 0:Me.length)>0||((ye=xe.addOrUpdateProperties)===null||ye===void 0?void 0:ye.length)>0);if((xe.newGeometry||xe.removeAllProperties||We)&&(Ne=Object.assign({},Ne),se.set(xe.id,Ne),We&&(Ne.properties=Object.assign({},Ne.properties))),xe.newGeometry&&(Ne.geometry=xe.newGeometry),xe.removeAllProperties)Ne.properties={};else if(((we=xe.removeProperties)===null||we===void 0?void 0:we.length)>0)for(let Qe of xe.removeProperties)Object.prototype.hasOwnProperty.call(Ne.properties,Qe)&&delete Ne.properties[Qe];if(((Ee=xe.addOrUpdateProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(let{key:Qe,value:ht}of xe.addOrUpdateProperties)Ne.properties[Qe]=ht}}(this._dataUpdateable,H.dataDiff,Q),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(H){return h._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(H){return this._geoJSONIndex.getClusterExpansionZoom(H.clusterId)}getClusterChildren(H){return this._geoJSONIndex.getChildren(H.clusterId)}getClusterLeaves(H){return this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset)}}class xr{constructor(H){this.self=H,this.actor=new h.H(H),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Z,Q)=>{if(this.externalWorkerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.externalWorkerSourceTypes[Z]=Q},this.self.addProtocol=h.cr,this.self.removeProtocol=h.cs,this.self.registerRTLTextPlugin=Z=>{h.cM.setMethods(Z)},this.actor.registerMessageHandler("LDT",(Z,Q)=>this._getDEMWorkerSource(Z,Q.source).loadTile(Q)),this.actor.registerMessageHandler("RDT",(Z,Q)=>h._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Z,Q.source).removeTile(Q)})),this.actor.registerMessageHandler("GCEZ",(Z,Q)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,Q.type,Q.source).getClusterExpansionZoom(Q)})),this.actor.registerMessageHandler("GCC",(Z,Q)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,Q.type,Q.source).getClusterChildren(Q)})),this.actor.registerMessageHandler("GCL",(Z,Q)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,Q.type,Q.source).getClusterLeaves(Q)})),this.actor.registerMessageHandler("LD",(Z,Q)=>this._getWorkerSource(Z,Q.type,Q.source).loadData(Q)),this.actor.registerMessageHandler("GD",(Z,Q)=>this._getWorkerSource(Z,Q.type,Q.source).getData()),this.actor.registerMessageHandler("LT",(Z,Q)=>this._getWorkerSource(Z,Q.type,Q.source).loadTile(Q)),this.actor.registerMessageHandler("RT",(Z,Q)=>this._getWorkerSource(Z,Q.type,Q.source).reloadTile(Q)),this.actor.registerMessageHandler("AT",(Z,Q)=>this._getWorkerSource(Z,Q.type,Q.source).abortTile(Q)),this.actor.registerMessageHandler("RMT",(Z,Q)=>this._getWorkerSource(Z,Q.type,Q.source).removeTile(Q)),this.actor.registerMessageHandler("RS",(Z,Q)=>h._(this,void 0,void 0,function*(){if(!this.workerSources[Z]||!this.workerSources[Z][Q.type]||!this.workerSources[Z][Q.type][Q.source])return;let se=this.workerSources[Z][Q.type][Q.source];delete this.workerSources[Z][Q.type][Q.source],se.removeSource!==void 0&&se.removeSource(Q)})),this.actor.registerMessageHandler("RM",Z=>h._(this,void 0,void 0,function*(){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z]})),this.actor.registerMessageHandler("SR",(Z,Q)=>h._(this,void 0,void 0,function*(){this.referrer=Q})),this.actor.registerMessageHandler("SRPS",(Z,Q)=>this._syncRTLPluginState(Z,Q)),this.actor.registerMessageHandler("IS",(Z,Q)=>h._(this,void 0,void 0,function*(){this.self.importScripts(Q)})),this.actor.registerMessageHandler("SI",(Z,Q)=>this._setImages(Z,Q)),this.actor.registerMessageHandler("UL",(Z,Q)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(Z).update(Q.layers,Q.removedIds)})),this.actor.registerMessageHandler("SL",(Z,Q)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(Z).replace(Q)}))}_setImages(H,Z){return h._(this,void 0,void 0,function*(){this.availableImages[H]=Z;for(let Q in this.workerSources[H]){let se=this.workerSources[H][Q];for(let fe in se)se[fe].availableImages=Z}})}_syncRTLPluginState(H,Z){return h._(this,void 0,void 0,function*(){return yield h.cM.syncState(Z,this.self.importScripts)})}_getAvailableImages(H){let Z=this.availableImages[H];return Z||(Z=[]),Z}_getLayerIndex(H){let Z=this.layerIndexes[H];return Z||(Z=this.layerIndexes[H]=new s),Z}_getWorkerSource(H,Z,Q){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][Z]||(this.workerSources[H][Z]={}),!this.workerSources[H][Z][Q]){let se={sendAsync:(fe,X)=>(fe.targetMapId=H,this.actor.sendAsync(fe,X))};switch(Z){case"vector":this.workerSources[H][Z][Q]=new Ce(se,this._getLayerIndex(H),this._getAvailableImages(H));break;case"geojson":this.workerSources[H][Z][Q]=new Qn(se,this._getLayerIndex(H),this._getAvailableImages(H));break;default:this.workerSources[H][Z][Q]=new this.externalWorkerSourceTypes[Z](se,this._getLayerIndex(H),this._getAvailableImages(H))}}return this.workerSources[H][Z][Q]}_getDEMWorkerSource(H,Z){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][Z]||(this.demWorkerSources[H][Z]=new be),this.demWorkerSources[H][Z]}}return h.i(self)&&(self.worker=new xr(self)),xr}),i("index",["exports","./shared"],function(h,s){"use strict";var T="5.5.0";function Y(){var m=new s.A(4);return s.A!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m}let K,Ce,be={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(m,e,n){let u=requestAnimationFrame(g=>{p(),e(g)}),{unsubscribe:p}=s.s(m.signal,"abort",()=>{p(),cancelAnimationFrame(u),n(s.c())},!1)},frameAsync(m){return new Promise((e,n)=>{this.frame(m,e,n)})},getImageData(m,e=0){return this.getImageCanvasContext(m).getImageData(-e,-e,m.width+2*e,m.height+2*e)},getImageCanvasContext(m){let e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=m.width,e.height=m.height,n.drawImage(m,0,0,m.width,m.height),n},resolveURL:m=>(K||(K=document.createElement("a")),K.href=m,K.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ce==null&&(Ce=matchMedia("(prefers-reduced-motion: reduce)")),Ce.matches)}};class G{static testProp(e){if(!G.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in G.docStyle)return e[n];return e[0]}static create(e,n,u){let p=window.document.createElement(e);return n!==void 0&&(p.className=n),u&&u.appendChild(p),p}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){G.docStyle&&G.selectProp&&(G.userSelect=G.docStyle[G.selectProp],G.docStyle[G.selectProp]="none")}static enableDrag(){G.docStyle&&G.selectProp&&(G.docStyle[G.selectProp]=G.userSelect)}static setTransform(e,n){e.style[G.transformProp]=n}static addEventListener(e,n,u,p={}){e.addEventListener(n,u,"passive"in p?p:p.capture)}static removeEventListener(e,n,u,p={}){e.removeEventListener(n,u,"passive"in p?p:p.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",G.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",G.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",G.suppressClickInternal,!0)},0)}static getScale(e){let n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,u){let p=n.boundingClientRect;return new s.P((u.clientX-p.left)/n.x-e.clientLeft,(u.clientY-p.top)/n.y-e.clientTop)}static mousePos(e,n){let u=G.getScale(e);return G.getPoint(e,u,n)}static touchPos(e,n){let u=[],p=G.getScale(e);for(let g=0;g<n.length;g++)u.push(G.getPoint(e,p,n[g]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){let n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),u=n.querySelectorAll("script");for(let p of u)p.remove();return G.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){let u=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!u.includes("javascript:")&&!u.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){let n=e.children;for(let u of n)G.removeAttributes(u),G.clean(u)}static removeAttributes(e){for(let{name:n,value:u}of e.attributes)G.isPossiblyDangerous(n,u)&&e.removeAttribute(n)}}G.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,G.selectProp=G.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),G.transformProp=G.testProp(["transform","WebkitTransform"]);let $e={supported:!1,testSupport:function(m){!ut&&Ct&&(lt?vi(m):ft=m)}},ft,Ct,ut=!1,lt=!1;function vi(m){let e=m.createTexture();m.bindTexture(m.TEXTURE_2D,e);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,Ct),m.isContextLost())return;$e.supported=!0}catch{}m.deleteTexture(e),ut=!0}var bi;typeof document<"u"&&(Ct=document.createElement("img"),Ct.onload=()=>{ft&&vi(ft),ft=null,lt=!0},Ct.onerror=()=>{ut=!0,ft=null},Ct.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let e,n,u,p;m.resetRequestQueue=()=>{e=[],n=0,u=0,p={}},m.addThrottleControl=C=>{let I=u++;return p[I]=C,I},m.removeThrottleControl=C=>{delete p[C],v()},m.getImage=(C,I,k=!0)=>new Promise((R,D)=>{$e.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),s.e(C,{type:"image"}),e.push({abortController:I,requestParameters:C,supportImageRefresh:k,state:"queued",onError:N=>{D(N)},onSuccess:N=>{R(N)}}),v()});let g=C=>s._(this,void 0,void 0,function*(){C.state="running";let{requestParameters:I,supportImageRefresh:k,onError:R,onSuccess:D,abortController:N}=C,j=k===!1&&!s.i(self)&&!s.g(I.url)&&(!I.headers||Object.keys(I.headers).reduce((te,re)=>te&&re==="accept",!0));n++;let ee=j?x(I,N):s.m(I,N);try{let te=yield ee;delete C.abortController,C.state="completed",te.data instanceof HTMLImageElement||s.b(te.data)?D(te):te.data&&D({data:yield(J=te.data,typeof createImageBitmap=="function"?s.f(J):s.h(J)),cacheControl:te.cacheControl,expires:te.expires})}catch(te){delete C.abortController,R(te)}finally{n--,v()}var J}),v=()=>{let C=(()=>{for(let I of Object.keys(p))if(p[I]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=n;I<C&&e.length>0;I++){let k=e.shift();k.abortController.signal.aborted?I--:g(k)}},x=(C,I)=>new Promise((k,R)=>{let D=new Image,N=C.url,j=C.credentials;j&&j==="include"?D.crossOrigin="use-credentials":(j&&j==="same-origin"||!s.d(N))&&(D.crossOrigin="anonymous"),I.signal.addEventListener("abort",()=>{D.src="",R(s.c())}),D.fetchPriority="high",D.onload=()=>{D.onerror=D.onload=null,k({data:D})},D.onerror=()=>{D.onerror=D.onload=null,I.signal.aborted||R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},D.src=N})}(bi||(bi={})),bi.resetRequestQueue();class Et{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function mi(m){let e=[];if(typeof m=="string")e.push({id:"default",url:m});else if(m&&m.length>0){let n=[];for(let{id:u,url:p}of m){let g=`${u}${p}`;n.indexOf(g)===-1&&(n.push(g),e.push({id:u,url:p}))}}return e}function Yi(m,e,n){try{let u=new URL(m);return u.pathname+=`${e}${n}`,u.toString()}catch{throw new Error(`Invalid sprite URL "${m}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class li{constructor(e,n,u,p){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(n,p)}update(e,n,u){let{width:p,height:g}=e,v=!(this.size&&this.size[0]===p&&this.size[1]===g||u),{context:x}=this,{gl:C}=x;if(this.useMipmap=!!(n&&n.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!n||n.premultiply!==!1)),v)this.size=[p,g],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||s.b(e)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,e):C.texImage2D(C.TEXTURE_2D,0,this.format,p,g,0,this.format,C.UNSIGNED_BYTE,e.data);else{let{x:I,y:k}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||s.b(e)?C.texSubImage2D(C.TEXTURE_2D,0,I,k,C.RGBA,C.UNSIGNED_BYTE,e):C.texSubImage2D(C.TEXTURE_2D,0,I,k,p,g,C.RGBA,C.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D),x.pixelStoreUnpackFlipY.setDefault(),x.pixelStoreUnpack.setDefault(),x.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,u){let{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),e!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||e),this.filter=e),n!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Ir(m){let{userImage:e}=m;return!!(e&&e.render&&e.render())&&(m.data.replace(new Uint8Array(e.data.buffer)),!0)}class Ms extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:n,promiseResolve:u}of this.requestors)u(this._getImagesForIds(n));this.requestors=[]}}getImage(e){let n=this.images[e];if(n&&!n.data&&n.spriteData){let u=n.spriteData;n.data=new s.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let u=!0,p=n.data||n.spriteData;return this._validateStretch(n.stretchX,p&&p.width)||(this.fire(new s.k(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(n.stretchY,p&&p.height)||(this.fire(new s.k(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(n.content,n)||(this.fire(new s.k(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,n){if(!e)return!0;let u=0;for(let p of e){if(p[0]<u||p[1]<p[0]||n<p[1])return!1;u=p[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;let u=n.spriteData,p=u&&u.width||n.data.width,g=u&&u.height||n.data.height;return!(e[0]<0||p<e[0]||e[1]<0||g<e[1]||e[2]<0||p<e[2]||e[3]<0||g<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,u=!0){let p=this.getImage(e);if(u&&(p.data.width!==n.data.width||p.data.height!==n.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=p.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){let n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,u)=>{let p=!0;if(!this.isLoaded())for(let g of e)this.images[g]||(p=!1);this.isLoaded()||p?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){let n={};for(let u of e){let p=this.getImage(u);p||(this.fire(new s.l("styleimagemissing",{id:u})),p=this.getImage(u)),p?n[u]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,textFitWidth:p.textFitWidth,textFitHeight:p.textFitHeight,hasRenderCallback:!!(p.userImage&&p.userImage.render)}:s.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){let{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){let n=this.patterns[e],u=this.getImage(e);if(!u)return null;if(n&&n.position.version===u.version)return n.position;if(n)n.position.version=u.version;else{let p={w:u.data.width+2,h:u.data.height+2,x:0,y:0},g=new s.I(p,u);this.patterns[e]={bin:p,position:g}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new li(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let g in this.patterns)e.push(this.patterns[g].bin);let{w:n,h:u}=s.p(e),p=this.atlasImage;p.resize({width:n||1,height:u||1});for(let g in this.patterns){let{bin:v}=this.patterns[g],x=v.x+1,C=v.y+1,I=this.getImage(g).data,k=I.width,R=I.height;s.R.copy(I,p,{x:0,y:0},{x,y:C},{width:k,height:R}),s.R.copy(I,p,{x:0,y:R-1},{x,y:C-1},{width:k,height:1}),s.R.copy(I,p,{x:0,y:0},{x,y:C+R},{width:k,height:1}),s.R.copy(I,p,{x:k-1,y:0},{x:x-1,y:C},{width:1,height:R}),s.R.copy(I,p,{x:0,y:0},{x:x+k,y:C},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;let u=this.getImage(n);u||s.w(`Image with ID: "${n}" was not found`),Ir(u)&&this.updateImage(n,u)}}}let Gi=1e20;function Kn(m,e,n,u,p,g,v,x,C){for(let I=e;I<e+u;I++)Bi(m,n*g+I,g,p,v,x,C);for(let I=n;I<n+p;I++)Bi(m,I*g+e,1,u,v,x,C)}function Bi(m,e,n,u,p,g,v){g[0]=0,v[0]=-1e20,v[1]=Gi,p[0]=m[e];for(let x=1,C=0,I=0;x<u;x++){p[x]=m[e+x*n];let k=x*x;do{let R=g[C];I=(p[x]-p[R]+k-R*R)/(x-R)/2}while(I<=v[C]&&--C>-1);C++,g[C]=x,v[C]=I,v[C+1]=Gi}for(let x=0,C=0;x<u;x++){for(;v[C+1]<x;)C++;let I=g[C],k=x-I;m[e+x*n]=p[I]+k*k}}class Tt{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return s._(this,void 0,void 0,function*(){let n=[];for(let g in e)for(let v of e[g])n.push(this._getAndCacheGlyphsPromise(g,v));let u=yield Promise.all(n),p={};for(let{stack:g,id:v,glyph:x}of u)p[g]||(p[g]={}),p[g][v]=x&&{id:x.id,bitmap:x.bitmap.clone(),metrics:x.metrics};return p})}_getAndCacheGlyphsPromise(e,n){return s._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let p=u.glyphs[n];if(p!==void 0)return{stack:e,id:n,glyph:p};if(p=this._tinySDF(u,e,n),p)return u.glyphs[n]=p,{stack:e,id:n,glyph:p};let g=Math.floor(n/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[g])return{stack:e,id:n,glyph:p};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[g]){let x=Tt.loadGlyphRange(e,g,this.url,this.requestManager);u.requests[g]=x}let v=yield u.requests[g];for(let x in v)this._doesCharSupportLocalGlyph(+x)||(u.glyphs[+x]=v[+x]);return u.ranges[g]=!0,{stack:e,id:n,glyph:v[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||s.u["CJK Unified Ideographs"](e)||s.u["Hangul Syllables"](e)||s.u.Hiragana(e)||s.u.Katakana(e)||s.u["CJK Symbols and Punctuation"](e)||s.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,n,u){let p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let g=e.tinySDF;if(!g){let x="400";/bold/i.test(n)?x="900":/medium/i.test(n)?x="500":/light/i.test(n)&&(x="200"),g=e.tinySDF=new Tt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:p,fontWeight:x})}let v=g.draw(String.fromCharCode(u));return{id:u,bitmap:new s.q({width:v.width||60,height:v.height||60},v.data),metrics:{width:v.glyphWidth/2||24,height:v.glyphHeight/2||24,left:v.glyphLeft/2+.5||0,top:v.glyphTop/2-27.5||-8,advance:v.glyphAdvance/2||24,isDoubleResolution:!0}}}}Tt.loadGlyphRange=function(m,e,n,u){return s._(this,void 0,void 0,function*(){let p=256*e,g=p+255,v=u.transformRequest(n.replace("{fontstack}",m).replace("{range}",`${p}-${g}`),"Glyphs"),x=yield s.n(v,new AbortController);if(!x||!x.data)throw new Error(`Could not load glyph range. range: ${e}, ${p}-${g}`);let C={};for(let I of s.o(x.data))C[I.id]=I;return C})},Tt.TinySDF=class{constructor({fontSize:m=24,buffer:e=3,radius:n=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=n;let x=this.size=m+4*e,C=this._createCanvas(x),I=this.ctx=C.getContext("2d",{willReadFrequently:!0});I.font=`${v} ${g} ${m}px ${p}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(m){let e=document.createElement("canvas");return e.width=e.height=m,e}draw(m){let{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(m),v=Math.ceil(n),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-p))),C=Math.min(this.size-this.buffer,v+Math.ceil(u)),I=x+2*this.buffer,k=C+2*this.buffer,R=Math.max(I*k,0),D=new Uint8ClampedArray(R),N={data:D,width:I,height:k,glyphWidth:x,glyphHeight:C,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(x===0||C===0)return N;let{ctx:j,buffer:ee,gridInner:J,gridOuter:te}=this;j.clearRect(ee,ee,x,C),j.fillText(m,ee,ee+v);let re=j.getImageData(ee,ee,x,C);te.fill(Gi,0,R),J.fill(0,0,R);for(let de=0;de<C;de++)for(let ce=0;ce<x;ce++){let ue=re.data[4*(de*x+ce)+3]/255;if(ue===0)continue;let ge=(de+ee)*I+ce+ee;if(ue===1)te[ge]=0,J[ge]=Gi;else{let he=.5-ue;te[ge]=he>0?he*he:0,J[ge]=he<0?he*he:0}}Kn(te,0,0,I,k,I,this.f,this.v,this.z),Kn(J,ee,ee,x,C,I,this.f,this.v,this.z);for(let de=0;de<R;de++){let ce=Math.sqrt(te[de])-Math.sqrt(J[de]);D[de]=Math.round(255-255*(ce/this.radius+this.cutoff))}return N}};class Gr{constructor(){this.specification=s.v.light.position}possiblyEvaluate(e,n){return s.z(e.expression.evaluate(n))}interpolate(e,n,u){return{x:s.B.number(e.x,n.x,u),y:s.B.number(e.y,n.y,u),z:s.B.number(e.z,n.z,u)}}}let Ss;class Ts extends s.E{constructor(e){super(),Ss=Ss||new s.r({anchor:new s.D(s.v.light.anchor),position:new Gr,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.T(Ss),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(s.t,e,n))for(let u in e){let p=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,u){return(!u||u.validate!==!1)&&s.x(this,e.call(s.y,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}let ci=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class ro extends s.E{constructor(e){super(),this._transitionable=new s.T(ci),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.C(0))}setSky(e,n={}){if(!this._validate(s.F,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(let u in e){let p=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,u={}){return u?.validate!==!1&&s.x(this,e.call(s.y,s.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class vr{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){let u=e.join(",")+String(n);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,n)),this.dashEntry[u]}getDashRanges(e,n,u){let p=[],g=e.length%2==1?-e[e.length-1]*u:0,v=e[0]*u,x=!0;p.push({left:g,right:v,isDash:x,zeroLength:e[0]===0});let C=e[0];for(let I=1;I<e.length;I++){x=!x;let k=e[I];g=C*u,C+=k,v=C*u,p.push({left:g,right:v,isDash:x,zeroLength:k===0})}return p}addRoundDash(e,n,u){let p=n/2;for(let g=-u;g<=u;g++){let v=this.width*(this.nextRow+u+g),x=0,C=e[x];for(let I=0;I<this.width;I++){I/C.right>1&&(C=e[++x]);let k=Math.abs(I-C.left),R=Math.abs(I-C.right),D=Math.min(k,R),N,j=g/u*(p+1);if(C.isDash){let ee=p-Math.abs(j);N=Math.sqrt(D*D+ee*ee)}else N=p-Math.sqrt(D*D+j*j);this.data[v+I]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(e){for(let x=e.length-1;x>=0;--x){let C=e[x],I=e[x+1];C.zeroLength?e.splice(x,1):I&&I.isDash===C.isDash&&(I.left=C.left,e.splice(x,1))}let n=e[0],u=e[e.length-1];n.isDash===u.isDash&&(n.left=u.left-this.width,u.right=n.right+this.width);let p=this.width*this.nextRow,g=0,v=e[g];for(let x=0;x<this.width;x++){x/v.right>1&&(v=e[++g]);let C=Math.abs(x-v.left),I=Math.abs(x-v.right),k=Math.min(C,I);this.data[p+x]=Math.max(0,Math.min(255,(v.isDash?k:-k)+128))}}addDash(e,n){let u=n?7:0,p=2*u+1;if(this.nextRow+p>this.height)return s.w("LineAtlas out of space"),null;let g=0;for(let x=0;x<e.length;x++)g+=e[x];if(g!==0){let x=this.width/g,C=this.getDashRanges(e,this.width,x);n?this.addRoundDash(C,x,u):this.addRegularDash(C)}let v={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:g};return this.nextRow+=p,this.dirty=!0,v}bind(e){let n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}let oo="maplibre_preloaded_worker_pool";class tn{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<tn.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[oo]}numActive(){return Object.keys(this.active).length}}let so=Math.floor(be.hardwareConcurrency/2),bn,xn;function ar(){return bn||(bn=new tn),bn}tn.workerCount=s.G(globalThis)?Math.max(Math.min(so,3),1):1;class wn{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;let u=this.workerPool.acquire(n);for(let p=0;p<u.length;p++){let g=new s.H(u[p],n);g.name=`Worker ${p}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){let u=[];for(let p of this.actors)u.push(p.sendAsync({type:e,data:n}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(let u of this.actors)u.registerMessageHandler(e,n)}}function Yo(){return xn||(xn=new wn(ar(),s.J),xn.registerMessageHandler("GR",(m,e,n)=>s.m(e,n))),xn}function Hr(m,e){let n=s.K();return s.L(n,n,[1,1,0]),s.M(n,n,[.5*m.width,.5*m.height,1]),m.calculatePosMatrix?s.N(n,n,m.calculatePosMatrix(e.toUnwrapped())):n}function Ko(m,e,n,u,p,g,v){var x;let C=function(D,N,j){if(D)for(let ee of D){let J=N[ee];if(J&&J.source===j&&J.type==="fill-extrusion")return!0}else for(let ee in N){let J=N[ee];if(J.source===j&&J.type==="fill-extrusion")return!0}return!1}((x=p?.layers)!==null&&x!==void 0?x:null,e,m.id),I=g.maxPitchScaleFactor(),k=m.tilesIn(u,I,C);k.sort(lr);let R=[];for(let D of k)R.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,n,m._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,p,g,I,Hr(m.transform,D.tileID),v?(N,j)=>v(D.tileID,N,j):void 0)});return function(D,N){for(let j in D)for(let ee of D[j])$n(ee,N);return D}(function(D){let N={},j={};for(let ee of D){let J=ee.queryResults,te=ee.wrappedTileID,re=j[te]=j[te]||{};for(let de in J){let ce=J[de],ue=re[de]=re[de]||{},ge=N[de]=N[de]||[];for(let he of ce)ue[he.featureIndex]||(ue[he.featureIndex]=!0,ge.push(he))}}return N}(R),m)}function lr(m,e){let n=m.tileID,u=e.tileID;return n.overscaledZ-u.overscaledZ||n.canonical.y-u.canonical.y||n.wrap-u.wrap||n.canonical.x-u.canonical.x}function $n(m,e){let n=m.feature,u=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=u}function Cn(m,e,n){return s._(this,void 0,void 0,function*(){let u=m;if(m.url?u=(yield s.j(e.transformRequest(m.url,"Source"),n)).data:yield be.frameAsync(n),!u)return null;let p=s.O(s.e(u,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(p.vectorLayerIds=u.vector_layers.map(g=>g.id)),p})}class gi{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof s.Q?new s.Q(e.lng,e.lat):s.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof s.Q?new s.Q(e.lng,e.lat):s.Q.convert(e),this}extend(e){let n=this._sw,u=this._ne,p,g;if(e instanceof s.Q)p=e,g=e;else{if(!(e instanceof gi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(gi.convert(e)):this.extend(s.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(s.Q.convert(e)):this;if(p=e._sw,g=e._ne,!p||!g)return this}return n||u?(n.lng=Math.min(p.lng,n.lng),n.lat=Math.min(p.lat,n.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new s.Q(p.lng,p.lat),this._ne=new s.Q(g.lng,g.lat)),this}getCenter(){return new s.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.Q(this.getWest(),this.getNorth())}getSouthEast(){return new s.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:n,lat:u}=s.Q.convert(e),p=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(e){return e instanceof gi?e:e&&new gi(e)}static fromLngLat(e,n=0){let u=360*n/40075017,p=u/Math.cos(Math.PI/180*e.lat);return new gi(new s.Q(e.lng-p,e.lat-u),new s.Q(e.lng+p,e.lat+u))}adjustAntiMeridian(){let e=new s.Q(this._sw.lng,this._sw.lat),n=new s.Q(this._ne.lng,this._ne.lat);return new gi(e,e.lng>n.lng?new s.Q(n.lng+360,n.lat):n)}}class Zr{constructor(e,n,u){this.bounds=gi.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){let n=Math.pow(2,e.z),u=Math.floor(s.U(this.bounds.getWest())*n),p=Math.floor(s.S(this.bounds.getNorth())*n),g=Math.ceil(s.U(this.bounds.getEast())*n),v=Math.ceil(s.S(this.bounds.getSouth())*n);return e.x>=u&&e.x<g&&e.y>=p&&e.y<v}}class nn extends s.E{constructor(e,n,u,p){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.O(n,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=yield Cn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(s.e(this,e),e.bounds&&(this.tileBounds=new Zr(e.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new s.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.request.collectResourceTiming=this._collectResourceTiming;let p="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((g,v)=>{e.reloadPromise={resolve:g,reject:v}})}else e.actor=this.dispatcher.getActor(),p="LT";e.abortController=new AbortController;try{let g=yield e.actor.sendAsync({type:p,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,g)}catch(g){if(delete e.abortController,e.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){let u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class rn extends s.E{constructor(e,n,u,p){super(),this.id=e,this.dispatcher=u,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},n),s.e(this,s.O(n,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let n=yield Cn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(s.e(this,n),n.bounds&&(this.tileBounds=new Zr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new s.k(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return s.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let u=yield bi.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&(u.cacheControl||u.expires)&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});let p=this.map.painter.context,g=p.gl,v=u.data;e.texture=this.map.painter.getTileTexture(v.width),e.texture?e.texture.update(v,{useMipmap:!0}):(e.texture=new li(p,v,g.RGBA,{useMipmap:!0}),e.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class na extends rn{constructor(e,n,u,p){super(e,n,u,p),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let p=yield bi.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(p&&p.data){let g=p.data;this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&e.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});let v=s.b(g)&&s.V()?g:yield this.readImageNow(g),x={type:this.type,uid:e.uid,source:this.id,rawImageData:v,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let C=yield e.actor.sendAsync({type:"LDT",data:x});e.dem=C,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(p){if(delete e.abortController,e.aborted)e.state="unloaded";else if(p)throw e.state="errored",p}})}readImageNow(e){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.W()){let n=e.width+2,u=e.height+2;try{return new s.R({width:n,height:u},yield s.X(e,-1,-1,n,u))}catch{}}return be.getImageData(e,1)})}_getNeighboringTiles(e){let n=e.canonical,u=Math.pow(2,n.z),p=(n.x-1+u)%u,g=n.x===0?e.wrap-1:e.wrap,v=(n.x+1+u)%u,x=n.x+1===u?e.wrap+1:e.wrap,C={};return C[new s.Y(e.overscaledZ,g,n.z,p,n.y).key]={backfilled:!1},C[new s.Y(e.overscaledZ,x,n.z,v,n.y).key]={backfilled:!1},n.y>0&&(C[new s.Y(e.overscaledZ,g,n.z,p,n.y-1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,x,n.z,v,n.y-1).key]={backfilled:!1}),n.y+1<u&&(C[new s.Y(e.overscaledZ,g,n.z,p,n.y+1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,x,n.z,v,n.y+1).key]={backfilled:!1}),C}unloadTile(e){return s._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Mn extends s.E{constructor(e,n,u,p){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(p),this._data=n.data,this._options=s.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:s.Z,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:s.Z,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(s.Z/this.tileSize)}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return s._(this,void 0,void 0,function*(){let e=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(n=>n.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){let e=new gi,n=yield this.getData(),u;switch(n.type){case"FeatureCollection":u=n.features.map(p=>this.getCoordinatesFromGeometry(p.geometry)).flat(1/0);break;case"Feature":u=this.getCoordinatesFromGeometry(n.geometry);break;default:u=this.getCoordinatesFromGeometry(n)}if(u.length==0)return e;for(let p=0;p<u.length-1;p+=2)e.extend([u[p],u[p+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:u}})}_updateWorkerData(e){return s._(this,void 0,void 0,function*(){let n=s.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(be.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.l("dataloading",{dataType:"source"}));try{let u=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));let p=null;u.resourceTiming&&u.resourceTiming[this.id]&&(p=u.resourceTiming[this.id].slice(0));let g={dataType:"source"};this._collectResourceTiming&&p&&p.length>0&&s.e(g,{resourceTiming:p}),this.fire(new s.l("data",Object.assign(Object.assign({},g),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},g),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.actor?"RT":"LT";e.actor=this.actor;let u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;let p=yield this.actor.sendAsync({type:n,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(p,this.map.painter,n==="RT")})}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Rn extends s.E{constructor(e,n,u,p){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=u,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=n}load(e){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let n=yield bi.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new s.k(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let n=e.map(s.$.fromLngLat);var u;return this.tileID=function(p){let g=1/0,v=1/0,x=-1/0,C=-1/0;for(let D of p)g=Math.min(g,D.x),v=Math.min(v,D.y),x=Math.max(x,D.x),C=Math.max(C,D.y);let I=Math.max(x-g,C-v),k=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),R=Math.pow(2,k);return new s.a1(k,Math.floor((g+x)/2*R),Math.floor((v+C)/2*R))}(n),this.terrainTileRanges=this._getOverlappingTileRanges(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(p=>this.tileID.getTilePoint(p)._round()),this.flippedWindingOrder=((u=this.tileCoords)[1].x-u[0].x)*(u[2].y-u[0].y)-(u[1].y-u[0].y)*(u[2].x-u[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new li(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let u=!1;for(let p in this.tiles){let g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let n=1/0,u=1/0,p=-1/0,g=-1/0;for(let x of e)n=Math.min(n,x.x),u=Math.min(u,x.y),p=Math.max(p,x.x),g=Math.max(g,x.y);let v={};for(let x=0;x<=s.a0;x++){let C=Math.pow(2,x),I=Math.floor(n*C),k=Math.floor(u*C),R=Math.floor(p*C),D=Math.floor(g*C);v[x]={minTileX:I,minTileY:k,maxTileX:R,maxTileY:D}}return v}}class Pr extends Rn{constructor(e,n,u,p){super(e,n,u,p),this.roundZoom=!0,this.type="video",this.options=n}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;let e=this.options;this.urls=[];for(let n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{let n=yield s.a2(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new s.k(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new s.k(new s.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new li(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let u=!1;for(let p in this.tiles){let g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ao extends Rn{constructor(e,n,u,p){super(e,n,u,p),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new s.k(new s.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a3(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new s.k(new s.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let n=this.map.painter.context,u=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new li(n,this.canvas,u.RGBA,{premultiply:!0});let p=!1;for(let g in this.tiles){let v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}let Xt={},on=m=>{switch(m){case"geojson":return Mn;case"image":return Rn;case"raster":return rn;case"raster-dem":return na;case"vector":return nn;case"video":return Pr;case"canvas":return Ao}return Xt[m]},cr="RTLPluginLoaded";class br extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Yo()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return s._(this,arguments,void 0,function*(n,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=be.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(cr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ni=null;function Ai(){return Ni||(Ni=new br),Ni}class kr{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=s.a4(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(p,g){let v={};if(!g)return v;for(let x of p){let C=x.layerIds.map(I=>g.getLayer(I)).filter(Boolean);if(C.length!==0){x.layers=C,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(I=>C.filter(k=>k.id===I)[0]));for(let I of C)v[I.id]=x}}return v}(e.buckets,n?.style),this.hasSymbolBuckets=!1;for(let p in this.buckets){let g=this.buckets[p];if(g instanceof s.a6){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let p in this.buckets){let g=this.buckets[p];if(g instanceof s.a6&&g.hasRTLText){this.hasRTLText=!0,Ai().lazyLoad();break}}this.queryPadding=0;for(let p in this.buckets){let g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(p).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s.a5}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let u in this.buckets){let p=this.buckets[u];p.uploadPending()&&p.upload(e)}let n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new li(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new li(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,u,p,g,v,x,C,I,k,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:v,tileSize:this.tileSize,pixelPosMatrix:k,transform:C,params:x,queryPadding:this.queryPadding*I,getElevation:R},e,n,u):{}}querySourceFeatures(e,n){let u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;let p=u.loadVTLayers(),g=n&&n.sourceLayer?n.sourceLayer:"",v=p._geojsonTileLayer||p[g];if(!v)return;let x=s.a7(n&&n.filter),{z:C,x:I,y:k}=this.tileID.canonical,R={z:C,x:I,y:k};for(let D=0;D<v.length;D++){let N=v.feature(D);if(x.needGeometry){let J=s.a8(N,!0);if(!x.filter(new s.C(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!x.filter(new s.C(this.tileID.overscaledZ),N))continue;let j=u.getId(N,g),ee=new s.a9(N,C,I,k,j);ee.tile=R,e.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let n=this.expirationTime;if(e.cacheControl){let u=s.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let u=Date.now(),p=!1;if(this.expirationTime>u)p=!1;else if(n)if(this.expirationTime<n)p=!0;else{let g=this.expirationTime-n;g?this.expirationTime=u+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let u=this.latestFeatureIndex.loadVTLayers();for(let p in this.buckets){if(!n.style.hasLayer(p))continue;let g=this.buckets[p],v=g.layers[0].sourceLayer||"_geojsonTileLayer",x=u[v],C=e[v];if(!x||!C||Object.keys(C).length===0)continue;g.update(C,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});let I=n&&n.style&&n.style.getLayer(p);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<be.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=be.now()+e}setDependencies(e,n){let u={};for(let p of n)u[p]=!0;this.dependencies[e]=u}hasDependency(e,n){for(let u of e){let p=this.dependencies[u];if(p){for(let g of n)if(p[g])return!0}}return!1}}class ao{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(let e in this.data)for(let n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,u){let p=e.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);let g={value:n,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(e,g)},u)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){let v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){let n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;let u=e.wrapped().key,p=n===void 0?0:this.data[u].indexOf(n),g=this.data[u][p];return this.data[u].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){let n=[];for(let u in this.data)for(let p of this.data[u])e(p.value)||n.push(p);for(let u of n)this.remove(u.value.tileID,u)}}class qr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,u){let p=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][p]=this.stateChanges[e][p]||{},s.e(this.stateChanges[e][p],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(let g in this.state[e])g!==p&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][p]===null){this.deletedStates[e][p]={};for(let g in this.state[e][p])u[g]||(this.deletedStates[e][p][g]=null)}else for(let g in u)this.deletedStates[e]&&this.deletedStates[e][p]&&this.deletedStates[e][p][g]===null&&delete this.deletedStates[e][p][g]}removeFeatureState(e,n,u){if(this.deletedStates[e]===null)return;let p=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&n!==void 0)this.deletedStates[e][p]!==null&&(this.deletedStates[e][p]=this.deletedStates[e][p]||{},this.deletedStates[e][p][u]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][p])for(u in this.deletedStates[e][p]={},this.stateChanges[e][p])this.deletedStates[e][p][u]=null;else this.deletedStates[e][p]=null;else this.deletedStates[e]=null}getState(e,n){let u=String(n),p=s.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let g=this.deletedStates[e][n];if(g===null)return{};for(let v in g)delete p[v]}return p}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){let u={};for(let p in this.stateChanges){this.state[p]=this.state[p]||{};let g={};for(let v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),s.e(this.state[p][v],this.stateChanges[p][v]),g[v]=this.state[p][v];u[p]=g}for(let p in this.deletedStates){this.state[p]=this.state[p]||{};let g={};if(this.deletedStates[p]===null)for(let v in this.state[p])g[v]={},this.state[p][v]={};else for(let v in this.deletedStates[p]){if(this.deletedStates[p][v]===null)this.state[p][v]={};else for(let x of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][x];g[v]=this.state[p][v]}u[p]=u[p]||{},s.e(u[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(let p in e)e[p].setFeatureState(u,n)}}let Ei=89.25;function Qn(m,e){let n=s.ae(e.lat,-85.051129,s.af);return new s.P(s.U(e.lng)*m,s.S(n)*m)}function xr(m,e){return new s.$(e.x/m,e.y/m).toLngLat()}function ve(m){return m.cameraToCenterDistance*Math.min(.85*Math.tan(s.ab(90-m.pitch)),Math.tan(s.ab(Ei-m.pitch)))}function H(m,e){let n=m.canonical,u=e/s.ac(n.z),p=n.x+Math.pow(2,n.z)*m.wrap,g=s.ad(new Float64Array(16));return s.L(g,g,[p*u,n.y*u,0]),s.M(g,g,[u/s.Z,u/s.Z,1]),g}function Z(m,e,n,u,p){let g=s.$.fromLngLat(m,e),v=p*s.ag(1,m.lat),x=v*Math.cos(s.ab(n)),C=Math.sqrt(v*v-x*x),I=C*Math.sin(s.ab(-u)),k=C*Math.cos(s.ab(-u));return new s.$(g.x+I,g.y+k,g.z+x)}function Q(m,e,n){let u=e.intersectsFrustum(m);if(!n)return u;let p=e.intersectsPlane(n);return u===0||p===0?0:u===2&&p===2?2:1}function se(m,e,n){let u=0,p=(n-e)/10;for(let g=0;g<10;g++)u+=p*Math.pow(Math.cos(e+(g+.5)/10*(n-e)),m);return u}function fe(m,e){return function(n,u,p,g,v){let x=2*((m-1)/s.ah(Math.cos(s.ab(Ei-v))/Math.cos(s.ab(Ei)))-1),C=Math.acos(p/g),I=2*se(x-1,0,s.ab(v/2)),k=Math.min(s.ab(Ei),C+s.ab(v/2)),R=se(x-1,Math.min(k,C-s.ab(v/2)),k),D=Math.atan(u/p),N=Math.hypot(u,p),j=n;return j+=s.ah(g/N/Math.max(.5,Math.cos(s.ab(v/2)))),j+=x*s.ah(Math.cos(D))/2,j-=s.ah(Math.max(1,R/I/e))/2,j}}let X=fe(9.314,3);function Me(m,e){let n=(e.roundZoom?Math.round:Math.floor)(m.zoom+s.ah(m.tileSize/e.tileSize));return Math.max(0,n)}function ye(m,e){let n=m.getCameraFrustum(),u=m.getClippingPlane(),p=m.screenPointToMercatorCoordinate(m.getCameraPoint()),g=s.$.fromLngLat(m.center,m.elevation);p.z=g.z+Math.cos(m.pitchInRadians)*m.cameraToCenterDistance/m.worldSize;let v=m.getCoveringTilesDetailsProvider(),x=v.allowVariableZoom(m,e),C=Me(m,e),I=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:m.maxZoom,R=Math.min(Math.max(0,C),k),D=Math.pow(2,R),N=[D*p.x,D*p.y,0],j=[D*g.x,D*g.y,0],ee=Math.hypot(g.x-p.x,g.y-p.y),J=Math.abs(g.z-p.z),te=Math.hypot(ee,J),re=ue=>({zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),de=[],ce=[];if(m.renderWorldCopies&&v.allowWorldCopies())for(let ue=1;ue<=3;ue++)de.push(re(-ue)),de.push(re(ue));for(de.push(re(0));de.length>0;){let ue=de.pop(),ge=ue.x,he=ue.y,Se=ue.fullyVisible,Le={x:ge,y:he,z:ue.zoom},ke=v.getTileAABB(Le,ue.wrap,m.elevation,e);if(!Se){let Xe=Q(n,ke,u);if(Xe===0)continue;Se=Xe===2}let Ae=v.distanceToTile2d(p.x,p.y,Le,ke),Re=C;x&&(Re=(e.calculateTileZoom||X)(m.zoom+s.ah(m.tileSize/e.tileSize),Ae,J,te,m.fov)),Re=(e.roundZoom?Math.round:Math.floor)(Re),Re=Math.max(0,Re);let Ke=Math.min(Re,k);if(ue.wrap=v.getWrap(g,Le,ue.wrap),ue.zoom>=Ke){if(ue.zoom<I)continue;let Xe=R-ue.zoom,Ue=N[0]-.5-(ge<<Xe),st=N[1]-.5-(he<<Xe),Ot=e.reparseOverscaled?Math.max(ue.zoom,Re):ue.zoom;ce.push({tileID:new s.Y(ue.zoom===k?Ot:ue.zoom,ue.wrap,ue.zoom,ge,he),distanceSq:s.ai([j[0]-.5-ge,j[1]-.5-he]),tileDistanceToCamera:Math.sqrt(Ue*Ue+st*st)})}else for(let Xe=0;Xe<4;Xe++)de.push({zoom:ue.zoom+1,x:(ge<<1)+Xe%2,y:(he<<1)+(Xe>>1),wrap:ue.wrap,fullyVisible:Se})}return ce.sort((ue,ge)=>ue.distanceSq-ge.distanceSq).map(ue=>ue.tileID)}class we extends s.E{constructor(e,n,u){super(),this.id=e,this.dispatcher=u,this.on("data",p=>this._dataHandler(p)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((p,g,v,x)=>{let C=new(on(g.type))(p,g,v,x);if(C.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${C.id}`);return C})(e,n,u,this),this._tiles={},this._cache=new ao(0,p=>this._unloadTile(p)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new qr,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let e in this._tiles){let n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,u){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,u)}catch(p){e.state="errored",p.status!==404?this._source.fire(new s.k(p,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new s.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let n in this._tiles){let u=this._tiles[n];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Ee).map(e=>e.key)}getRenderableIds(e){let n=[];for(let u in this._tiles)this._isIdRenderable(u,e)&&n.push(this._tiles[u]);return e?n.sort((u,p)=>{let g=u.tileID,v=p.tileID,x=new s.P(g.canonical.x,g.canonical.y)._rotate(-this.transform.bearingInRadians),C=new s.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians);return g.overscaledZ-v.overscaledZ||C.y-x.y||C.x-x.x}).map(u=>u.tileID.key):n.map(u=>u.tileID).sort(Ee).map(u=>u.key)}hasRenderableParent(e){let n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return s._(this,void 0,void 0,function*(){let u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=n),yield this._loadTile(u,e,n))})}_tileLoaded(e,n,u){e.timeAdded=be.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let n=this.getRenderableIds();for(let p=0;p<n.length;p++){let g=n[p];if(e.neighboringTiles&&e.neighboringTiles[g]){let v=this.getTileByID(g);u(e,v),u(v,e)}}function u(p,g){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let v=g.tileID.canonical.x-p.tileID.canonical.x,x=g.tileID.canonical.y-p.tileID.canonical.y,C=Math.pow(2,p.tileID.canonical.z),I=g.tileID.key;v===0&&x===0||Math.abs(x)>1||(Math.abs(v)>1&&(Math.abs(v+C)===1?v+=C:Math.abs(v-C)===1&&(v-=C)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,v,x),p.neighboringTiles&&p.neighboringTiles[I]&&(p.neighboringTiles[I].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,u,p){for(let g in this._tiles){let v=this._tiles[g];if(p[g]||!v.hasData()||v.tileID.overscaledZ<=n||v.tileID.overscaledZ>u)continue;let x=v.tileID;for(;v&&v.tileID.overscaledZ>n+1;){let I=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[I.key],v&&v.hasData()&&(x=I)}let C=x;for(;C.overscaledZ>n;)if(C=C.scaledTo(C.overscaledZ-1),e[C.key]||e[C.canonical.key]){p[x.key]=x;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){let u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=n?u:null}for(let u=e.overscaledZ-1;u>=n;u--){let p=e.scaledTo(u),g=this._getLoadedTile(p);if(g)return g}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){let n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let n=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,p=Math.floor(n*u*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(e){let n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){let u={};for(let p in this._tiles){let g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+n),u[g.tileID.key]=g}this._tiles=u;for(let p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(let p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}_updateCoveredAndRetainedTiles(e,n,u,p,g,v){let x={},C={},I=Object.keys(e),k=be.now();for(let R of I){let D=e[R],N=this._tiles[R];if(!N||N.fadeEndTime!==0&&N.fadeEndTime<=k)continue;let j=this.findLoadedParent(D,n),ee=this.findLoadedSibling(D),J=j||ee||null;J&&(this._addTile(J.tileID),x[J.tileID.key]=J.tileID),C[R]=D}this._retainLoadedChildren(C,p,u,e);for(let R in x)e[R]||(this._coveredTiles[R]=!0,e[R]=x[R]);if(v){let R={},D={};for(let N of g)this._tiles[N.key].hasData()?R[N.key]=N:D[N.key]=N;for(let N in D){let j=D[N].children(this._source.maxzoom);this._tiles[j[0].key]&&this._tiles[j[1].key]&&this._tiles[j[2].key]&&this._tiles[j[3].key]&&(R[j[0].key]=e[j[0].key]=j[0],R[j[1].key]=e[j[1].key]=j[1],R[j[2].key]=e[j[2].key]=j[2],R[j[3].key]=e[j[3].key]=j[3],delete D[N])}for(let N in D){let j=D[N],ee=this.findLoadedParent(j,this._source.minzoom),J=this.findLoadedSibling(j),te=ee||J||null;if(te){R[te.tileID.key]=e[te.tileID.key]=te.tileID;for(let re in R)R[re].isChildOf(te.tileID)&&delete R[re]}}for(let N in this._tiles)R[N]||(this._coveredTiles[N]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new s.Y(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(u=ye(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(u=u.filter(k=>this._source.hasTile(k)))):u=[];let p=Me(e,this._source),g=Math.max(p-we.maxOverzooming,this._source.minzoom),v=Math.max(p+we.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let k={};for(let R of u)if(R.canonical.z>this._source.minzoom){let D=R.scaledTo(R.canonical.z-1);k[D.key]=D;let N=R.scaledTo(Math.max(this._source.minzoom,Math.min(R.canonical.z,5)));k[N.key]=N}u=u.concat(Object.values(k))}let x=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let C=this._updateRetainedTiles(u,p);xe(this._source.type)&&this._updateCoveredAndRetainedTiles(C,g,v,p,u,n);for(let k in C)this._tiles[k].clearFadeHold();let I=s.aj(this._tiles,C);for(let k of I){let R=this._tiles[k];R.hasSymbolBuckets&&!R.holdingForFade()?R.setHoldDuration(this.map._fadeDuration):R.hasSymbolBuckets&&!R.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var u;let p={},g={},v=Math.max(n-we.maxOverzooming,this._source.minzoom),x=Math.max(n+we.maxUnderzooming,this._source.minzoom),C={};for(let I of e){let k=this._addTile(I);p[I.key]=I,k.hasData()||n<this._source.maxzoom&&(C[I.key]=I)}this._retainLoadedChildren(C,n,x,p);for(let I of e){let k=this._tiles[I.key];if(k.hasData())continue;if(n+1>this._source.maxzoom){let D=I.children(this._source.maxzoom)[0],N=this.getTile(D);if(N&&N.hasData()){p[D.key]=D;continue}}else{let D=I.children(this._source.maxzoom);if(p[D[0].key]&&p[D[1].key]&&p[D[2].key]&&p[D[3].key])continue}let R=k.wasRequested();for(let D=I.overscaledZ-1;D>=v;--D){let N=I.scaledTo(D);if(g[N.key])break;if(g[N.key]=!0,k=this.getTile(N),!k&&R&&(k=this._addTile(N)),k){let j=k.hasData();if((j||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||R)&&(p[N.key]=N),R=k.wasRequested(),j)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let n=[],u,p=this._tiles[e].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}n.push(p.key);let g=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;p=g}for(let g of n)this._loadedParentTiles[g]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(let e in this._tiles){let n=this._tiles[e].tileID,u=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=u}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));let u=n;return n||(n=new kr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,u||this._source.fire(new s.l("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let u=n.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}refreshTiles(e){for(let n in this._tiles)this._isIdRenderable(n)&&e.some(u=>u.equals(this._tiles[n].tileID.canonical))&&this._reloadTile(n,"expired")}_removeTile(e){let n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){let n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,u){let p=[],g=this.transform;if(!g)return p;let v=u?g.getCameraQueryGeometry(e):e,x=e.map(j=>g.screenPointToMercatorCoordinate(j,this.terrain)),C=v.map(j=>g.screenPointToMercatorCoordinate(j,this.terrain)),I=this.getIds(),k=1/0,R=1/0,D=-1/0,N=-1/0;for(let j of C)k=Math.min(k,j.x),R=Math.min(R,j.y),D=Math.max(D,j.x),N=Math.max(N,j.y);for(let j=0;j<I.length;j++){let ee=this._tiles[I[j]];if(ee.holdingForFade())continue;let J=g.getCoveringTilesDetailsProvider().allowWorldCopies()?ee.tileID:ee.tileID.unwrapTo(0),te=Math.pow(2,g.zoom-ee.tileID.overscaledZ),re=n*ee.queryPadding*s.Z/ee.tileSize/te,de=[J.getTilePoint(new s.$(k,R)),J.getTilePoint(new s.$(D,N))];if(de[0].x-re<s.Z&&de[0].y-re<s.Z&&de[1].x+re>=0&&de[1].y+re>=0){let ce=x.map(ge=>J.getTilePoint(ge)),ue=C.map(ge=>J.getTilePoint(ge));p.push({tile:ee,tileID:J,queryGeometry:ce,cameraQueryGeometry:ue,scale:te})}}return p}getVisibleCoordinates(e){let n=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(xe(this._source.type)){let e=be.now();for(let n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,u){this._state.updateState(e=e||"_geojsonTileLayer",n,u)}removeFeatureState(e,n,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,u)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,u){let p=this._tiles[e];p&&p.setDependencies(n,u)}reloadTilesForDependencies(e,n){for(let u in this._tiles)this._tiles[u].hasDependency(e,n)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,n))}}function Ee(m,e){let n=Math.abs(2*m.wrap)-+(m.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return m.overscaledZ-e.overscaledZ||u-n||e.canonical.y-m.canonical.y||e.canonical.x-m.canonical.x}function xe(m){return m==="raster"||m==="image"||m==="video"}we.maxOverzooming=10,we.maxUnderzooming=3;class Ne{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=s.ae(e,0,1);let n=1,u=this._distances[n],p=e*this.paddedLength+this.padding;for(;u<p&&n<this._distances.length;)u=this._distances[++n];let g=n-1,v=this._distances[g],x=u-v,C=x>0?(p-v)/x:0;return this.points[g].mult(1-C).add(this.points[n].mult(C))}}function We(m,e){let n=!0;return m==="always"||m!=="never"&&e!=="never"||(n=!1),n}class Qe{constructor(e,n,u){let p=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(n/u);for(let v=0;v<this.xCellCount*this.yCellCount;v++)p.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,u,p,g){this._forEachCell(n,u,p,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(g)}insertCircle(e,n,u,p){this._forEachCell(n-p,u-p,n+p,u+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(u),this.circles.push(p)}_insertBoxCell(e,n,u,p,g,v){this.boxCells[g].push(v)}_insertCircleCell(e,n,u,p,g,v){this.circleCells[g].push(v)}_query(e,n,u,p,g,v,x){if(u<0||e>this.width||p<0||n>this.height)return[];let C=[];if(e<=0&&n<=0&&this.width<=u&&this.height<=p){if(g)return[{key:null,x1:e,y1:n,x2:u,y2:p}];for(let I=0;I<this.boxKeys.length;I++)C.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){let k=this.circles[3*I],R=this.circles[3*I+1],D=this.circles[3*I+2];C.push({key:this.circleKeys[I],x1:k-D,y1:R-D,x2:k+D,y2:R+D})}}else this._forEachCell(e,n,u,p,this._queryCell,C,{hitTest:g,overlapMode:v,seenUids:{box:{},circle:{}}},x);return C}query(e,n,u,p){return this._query(e,n,u,p,!1,null)}hitTest(e,n,u,p,g,v){return this._query(e,n,u,p,!0,g,v).length>0}hitTestCircle(e,n,u,p,g){let v=e-u,x=e+u,C=n-u,I=n+u;if(x<0||v>this.width||I<0||C>this.height)return!1;let k=[];return this._forEachCell(v,C,x,I,this._queryCellCircle,k,{hitTest:!0,overlapMode:p,circle:{x:e,y:n,radius:u},seenUids:{box:{},circle:{}}},g),k.length>0}_queryCell(e,n,u,p,g,v,x,C){let{seenUids:I,hitTest:k,overlapMode:R}=x,D=this.boxCells[g];if(D!==null){let j=this.bboxes;for(let ee of D)if(!I.box[ee]){I.box[ee]=!0;let J=4*ee,te=this.boxKeys[ee];if(e<=j[J+2]&&n<=j[J+3]&&u>=j[J+0]&&p>=j[J+1]&&(!C||C(te))&&(!k||!We(R,te.overlapMode))&&(v.push({key:te,x1:j[J],y1:j[J+1],x2:j[J+2],y2:j[J+3]}),k))return!0}}let N=this.circleCells[g];if(N!==null){let j=this.circles;for(let ee of N)if(!I.circle[ee]){I.circle[ee]=!0;let J=3*ee,te=this.circleKeys[ee];if(this._circleAndRectCollide(j[J],j[J+1],j[J+2],e,n,u,p)&&(!C||C(te))&&(!k||!We(R,te.overlapMode))){let re=j[J],de=j[J+1],ce=j[J+2];if(v.push({key:te,x1:re-ce,y1:de-ce,x2:re+ce,y2:de+ce}),k)return!0}}}return!1}_queryCellCircle(e,n,u,p,g,v,x,C){let{circle:I,seenUids:k,overlapMode:R}=x,D=this.boxCells[g];if(D!==null){let j=this.bboxes;for(let ee of D)if(!k.box[ee]){k.box[ee]=!0;let J=4*ee,te=this.boxKeys[ee];if(this._circleAndRectCollide(I.x,I.y,I.radius,j[J+0],j[J+1],j[J+2],j[J+3])&&(!C||C(te))&&!We(R,te.overlapMode))return v.push(!0),!0}}let N=this.circleCells[g];if(N!==null){let j=this.circles;for(let ee of N)if(!k.circle[ee]){k.circle[ee]=!0;let J=3*ee,te=this.circleKeys[ee];if(this._circlesCollide(j[J],j[J+1],j[J+2],I.x,I.y,I.radius)&&(!C||C(te))&&!We(R,te.overlapMode))return v.push(!0),!0}}}_forEachCell(e,n,u,p,g,v,x,C){let I=this._convertToXCellCoord(e),k=this._convertToYCellCoord(n),R=this._convertToXCellCoord(u),D=this._convertToYCellCoord(p);for(let N=I;N<=R;N++)for(let j=k;j<=D;j++)if(g.call(this,e,n,u,p,this.xCellCount*j+N,v,x,C))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,u,p,g,v){let x=p-e,C=g-n,I=u+v;return I*I>x*x+C*C}_circleAndRectCollide(e,n,u,p,g,v,x){let C=(v-p)/2,I=Math.abs(e-(p+C));if(I>C+u)return!1;let k=(x-g)/2,R=Math.abs(n-(g+k));if(R>k+u)return!1;if(I<=C||R<=k)return!0;let D=I-C,N=R-k;return D*D+N*N<=u*u}}function ht(m,e,n){let u=s.K();if(!m){let{vecSouth:R,vecEast:D}=wt(e),N=Y();N[0]=D[0],N[1]=D[1],N[2]=R[0],N[3]=R[1],p=N,(k=(v=(g=N)[0])*(I=g[3])-(C=g[2])*(x=g[1]))&&(p[0]=I*(k=1/k),p[1]=-x*k,p[2]=-C*k,p[3]=v*k),u[0]=N[0],u[1]=N[1],u[4]=N[2],u[5]=N[3]}var p,g,v,x,C,I,k;return s.M(u,u,[1/n,1/n,1]),u}function It(m,e,n,u){if(m){let p=s.K();if(!e){let{vecSouth:g,vecEast:v}=wt(n);p[0]=v[0],p[1]=v[1],p[4]=g[0],p[5]=g[1]}return s.M(p,p,[u,u,1]),p}return n.pixelsToClipSpaceMatrix}function wt(m){let e=Math.cos(m.rollInRadians),n=Math.sin(m.rollInRadians),u=Math.cos(m.pitchInRadians),p=Math.cos(m.bearingInRadians),g=Math.sin(m.bearingInRadians),v=s.ao();v[0]=-p*u*n-g*e,v[1]=-g*u*n+p*e;let x=s.ap(v);x<1e-9?s.aq(v):s.ar(v,v,1/x);let C=s.ao();C[0]=p*u*e-g*n,C[1]=g*u*e+p*n;let I=s.ap(C);return I<1e-9?s.aq(C):s.ar(C,C,1/I),{vecEast:C,vecSouth:v}}function De(m,e,n,u){let p;u?(p=[m,e,u(m,e),1],s.at(p,p,n)):(p=[m,e,0,1],Do(p,p,n));let g=p[3];return{point:new s.P(p[0]/g,p[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function ni(m,e){return .5+m/e*.5}function Bt(m,e){return m.x>=-e[0]&&m.x<=e[0]&&m.y>=-e[1]&&m.y<=e[1]}function ri(m,e,n,u,p,g,v,x,C,I,k,R,D){let N=n?m.textSizeData:m.iconSizeData,j=s.ak(N,e.transform.zoom),ee=[256/e.width*2+1,256/e.height*2+1],J=n?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;J.clear();let te=m.lineVertexArray,re=n?m.text.placedSymbolArray:m.icon.placedSymbolArray,de=e.transform.width/e.transform.height,ce=!1;for(let ue=0;ue<re.length;ue++){let ge=re.get(ue);if(ge.hidden||ge.writingMode===s.al.vertical&&!ce){dr(ge.numGlyphs,J);continue}ce=!1;let he=new s.P(ge.anchorX,ge.anchorY),Se={getElevation:D,pitchedLabelPlaneMatrix:u,lineVertexArray:te,pitchWithMap:g,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:he,unwrappedTileID:C,width:I,height:k,translation:R},Le=At(ge.anchorX,ge.anchorY,Se);if(!Bt(Le.point,ee)){dr(ge.numGlyphs,J);continue}let ke=ni(e.transform.cameraToCenterDistance,Le.signedDistanceFromCamera),Ae=s.am(N,j,ge),Re=g?Ae*e.transform.getPitchedTextCorrection(ge.anchorX,ge.anchorY,C)/ke:Ae*ke,Ke=mt({projectionContext:Se,pitchedLabelPlaneMatrixInverse:p,symbol:ge,fontSize:Re,flip:!1,keepUpright:v,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:J,aspectRatio:de,rotateToLine:x});ce=Ke.useVertical,(Ke.notEnoughRoom||ce||Ke.needsFlipping&&mt({projectionContext:Se,pitchedLabelPlaneMatrixInverse:p,symbol:ge,fontSize:Re,flip:!0,keepUpright:v,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:J,aspectRatio:de,rotateToLine:x}).notEnoughRoom)&&dr(ge.numGlyphs,J)}n?m.text.dynamicLayoutVertexBuffer.updateData(J):m.icon.dynamicLayoutVertexBuffer.updateData(J)}function xt(m,e,n,u,p,g,v,x){let C=g.glyphStartIndex+g.numGlyphs,I=g.lineStartIndex,k=g.lineStartIndex+g.lineLength,R=e.getoffsetX(g.glyphStartIndex),D=e.getoffsetX(C-1),N=Qo(m*R,n,u,p,g.segment,I,k,x,v);if(!N)return null;let j=Qo(m*D,n,u,p,g.segment,I,k,x,v);return j?x.projectionCache.anyProjectionOccluded?null:{first:N,last:j}:null}function Be(m,e,n,u){return m===s.al.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*u?{useVertical:!0}:(m===s.al.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function mt(m){let{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:u,fontSize:p,flip:g,keepUpright:v,glyphOffsetArray:x,dynamicLayoutVertexArray:C,aspectRatio:I,rotateToLine:k}=m,R=p/24,D=u.lineOffsetX*R,N=u.lineOffsetY*R,j;if(u.numGlyphs>1){let ee=u.glyphStartIndex+u.numGlyphs,J=u.lineStartIndex,te=u.lineStartIndex+u.lineLength,re=xt(R,x,D,N,g,u,k,e);if(!re)return{notEnoughRoom:!0};let de=Jn(re.first.point.x,re.first.point.y,e,n),ce=Jn(re.last.point.x,re.last.point.y,e,n);if(v&&!g){let ue=Be(u.writingMode,de,ce,I);if(ue)return ue}j=[re.first];for(let ue=u.glyphStartIndex+1;ue<ee-1;ue++)j.push(Qo(R*x.getoffsetX(ue),D,N,g,u.segment,J,te,e,k));j.push(re.last)}else{if(v&&!g){let J=Vi(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,te=u.lineStartIndex+u.segment+1,re=new s.P(e.lineVertexArray.getx(te),e.lineVertexArray.gety(te)),de=Vi(re.x,re.y,e),ce=de.signedDistanceFromCamera>0?de.point:Pt(e.tileAnchorPoint,re,J,1,e),ue=Jn(J.x,J.y,e,n),ge=Jn(ce.x,ce.y,e,n),he=Be(u.writingMode,ue,ge,I);if(he)return he}let ee=Qo(R*x.getoffsetX(u.glyphStartIndex),D,N,g,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,e,k);if(!ee||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};j=[ee]}for(let ee of j)s.as(C,ee.point,ee.angle);return{}}function Pt(m,e,n,u,p){let g=m.add(m.sub(e)._unit()),v=Vi(g.x,g.y,p).point,x=n.sub(v);return n.add(x._mult(u/x.mag()))}function St(m,e,n){let u=e.projectionCache;if(u.projections[m])return u.projections[m];let p=new s.P(e.lineVertexArray.getx(m),e.lineVertexArray.gety(m)),g=Vi(p.x,p.y,e);if(g.signedDistanceFromCamera>0)return u.projections[m]=g.point,u.anyProjectionOccluded=u.anyProjectionOccluded||g.isOccluded,g.point;let v=m-n.direction;return Pt(n.distanceFromAnchor===0?e.tileAnchorPoint:new s.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),p,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function Vi(m,e,n){let u=m+n.translation[0],p=e+n.translation[1],g;return n.pitchWithMap?(g=De(u,p,n.pitchedLabelPlaneMatrix,n.getElevation),g.isOccluded=!1):(g=n.transform.projectTileCoordinates(u,p,n.unwrappedTileID,n.getElevation),g.point.x=(.5*g.point.x+.5)*n.width,g.point.y=(.5*-g.point.y+.5)*n.height),g}function Jn(m,e,n,u){if(n.pitchWithMap){let p=[m,e,0,1];return s.at(p,p,u),n.transform.projectTileCoordinates(p[0]/p[3],p[1]/p[3],n.unwrappedTileID,n.getElevation).point}return{x:m/n.width*2-1,y:e/n.height*2-1}}function At(m,e,n){return n.transform.projectTileCoordinates(m,e,n.unwrappedTileID,n.getElevation)}function Es(m,e,n){return m._unit()._perp()._mult(e*n)}function ra(m,e,n,u,p,g,v,x,C){if(x.projectionCache.offsets[m])return x.projectionCache.offsets[m];let I=n.add(e);if(m+C.direction<u||m+C.direction>=p)return x.projectionCache.offsets[m]=I,I;let k=St(m+C.direction,x,C),R=Es(k.sub(n),v,C.direction),D=n.add(R),N=k.add(R);return x.projectionCache.offsets[m]=s.au(g,I,D,N)||I,x.projectionCache.offsets[m]}function Qo(m,e,n,u,p,g,v,x,C){let I=u?m-e:m+e,k=I>0?1:-1,R=0;u&&(k*=-1,R=Math.PI),k<0&&(R+=Math.PI);let D,N=k>0?g+p:g+p+1;x.projectionCache.cachedAnchorPoint?D=x.projectionCache.cachedAnchorPoint:(D=Vi(x.tileAnchorPoint.x,x.tileAnchorPoint.y,x).point,x.projectionCache.cachedAnchorPoint=D);let j,ee,J=D,te=D,re=0,de=0,ce=Math.abs(I),ue=[],ge;for(;re+de<=ce;){if(N+=k,N<g||N>=v)return null;re+=de,te=J,ee=j;let Le={absOffsetX:ce,direction:k,distanceFromAnchor:re,previousVertex:te};if(J=St(N,x,Le),n===0)ue.push(te),ge=J.sub(te);else{let ke,Ae=J.sub(te);ke=Ae.mag()===0?Es(St(N+k,x,Le).sub(J),n,k):Es(Ae,n,k),ee||(ee=te.add(ke)),j=ra(N,ke,J,g,v,ee,n,x,Le),ue.push(ee),ge=j.sub(ee)}de=ge.mag()}let he=ge._mult((ce-re)/de)._add(ee||te),Se=R+Math.atan2(J.y-te.y,J.x-te.x);return ue.push(he),{point:he,angle:C?Se:0,path:ue}}let Jo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function dr(m,e){for(let n=0;n<m;n++){let u=e.length;e.resize(u+4),e.float32.set(Jo,3*u)}}function Do(m,e,n){let u=e[0],p=e[1];return m[0]=n[0]*u+n[4]*p+n[12],m[1]=n[1]*u+n[5]*p+n[13],m[3]=n[3]*u+n[7]*p+n[15],m}let Di=100;class ai{constructor(e,n=new Qe(e.width+200,e.height+200,25),u=new Qe(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=u,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Di,this.screenBottomBoundary=e.height+Di,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,u,p,g,v,x,C,I,k,R,D){let N=this.projectAndGetPerspectiveRatio(e.anchorPointX+C[0],e.anchorPointY+C[1],g,k,D),j=u*N.perspectiveRatio,ee;if(v||x)ee=this._projectCollisionBox(e,j,p,g,v,x,C,N,k,R,D);else{let ge=N.x+(R?R.x*j:0),he=N.y+(R?R.y*j:0);ee={allPointsOccluded:!1,box:[ge+e.x1*j,he+e.y1*j,ge+e.x2*j,he+e.y2*j]}}let[J,te,re,de]=ee.box,ce=v?ee.allPointsOccluded:N.isOccluded,ue=ce;return ue||(ue=N.perspectiveRatio<this.perspectiveRatioCutoff),ue||(ue=!this.isInsideGrid(J,te,re,de)),ue||n!=="always"&&this.grid.hitTest(J,te,re,de,n,I)?{box:[J,te,re,de],placeable:!1,offscreen:!1,occluded:ce}:{box:[J,te,re,de],placeable:!0,offscreen:this.isOffscreen(J,te,re,de),occluded:ce}}placeCollisionCircles(e,n,u,p,g,v,x,C,I,k,R,D,N,j){let ee=[],J=new s.P(n.anchorX,n.anchorY),te=this.getPerspectiveRatio(J.x,J.y,v,j),re=(I?g*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,v)/te:g*te)/s.ay,de={getElevation:j,pitchedLabelPlaneMatrix:x,lineVertexArray:u,pitchWithMap:I,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:J,unwrappedTileID:v,width:this.transform.width,height:this.transform.height,translation:N},ce=xt(re,p,n.lineOffsetX*re,n.lineOffsetY*re,!1,n,!1,de),ue=!1,ge=!1,he=!0;if(ce){let Se=.5*R*te+D,Le=new s.P(-100,-100),ke=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Ae=new Ne,Re=ce.first,Ke=ce.last,Xe=[];for(let Ot=Re.path.length-1;Ot>=1;Ot--)Xe.push(Re.path[Ot]);for(let Ot=1;Ot<Ke.path.length;Ot++)Xe.push(Ke.path[Ot]);let Ue=2.5*Se;if(I){let Ot=this.projectPathToScreenSpace(Xe,de);Xe=Ot.some(ei=>ei.signedDistanceFromCamera<=0)?[]:Ot.map(ei=>ei.point)}let st=[];if(Xe.length>0){let Ot=Xe[0].clone(),ei=Xe[0].clone();for(let Zi=1;Zi<Xe.length;Zi++)Ot.x=Math.min(Ot.x,Xe[Zi].x),Ot.y=Math.min(Ot.y,Xe[Zi].y),ei.x=Math.max(ei.x,Xe[Zi].x),ei.y=Math.max(ei.y,Xe[Zi].y);st=Ot.x>=Le.x&&ei.x<=ke.x&&Ot.y>=Le.y&&ei.y<=ke.y?[Xe]:ei.x<Le.x||Ot.x>ke.x||ei.y<Le.y||Ot.y>ke.y?[]:s.av([Xe],Le.x,Le.y,ke.x,ke.y)}for(let Ot of st){Ae.reset(Ot,.25*Se);let ei=0;ei=Ae.length<=.5*Se?1:Math.ceil(Ae.paddedLength/Ue)+1;for(let Zi=0;Zi<ei;Zi++){let Si=Zi/Math.max(ei-1,1),qi=Ae.lerp(Si),Wi=qi.x+Di,Pi=qi.y+Di;ee.push(Wi,Pi,Se,0);let di=Wi-Se,En=Pi-Se,zn=Wi+Se,qn=Pi+Se;if(he=he&&this.isOffscreen(di,En,zn,qn),ge=ge||this.isInsideGrid(di,En,zn,qn),e!=="always"&&this.grid.hitTestCircle(Wi,Pi,Se,e,k)&&(ue=!0,!C))return{circles:[],offscreen:!1,collisionDetected:ue}}}}return{circles:!C&&ue||!ge||te<this.perspectiveRatioCutoff?[]:ee,offscreen:he,collisionDetected:ue}}projectPathToScreenSpace(e,n){let u=function(p,g){let v=s.K();return s.an(v,g.pitchedLabelPlaneMatrix),p.map(x=>{let C=De(x.x,x.y,v,g.getElevation),I=g.transform.projectTileCoordinates(C.point.x,C.point.y,g.unwrappedTileID,g.getElevation);return I.point.x=(.5*I.point.x+.5)*g.width,I.point.y=(.5*-I.point.y+.5)*g.height,I})}(e,n);return function(p){let g=0,v=0,x=0,C=0;for(let I=0;I<p.length;I++)p[I].isOccluded?(x=I+1,C=0):(C++,C>v&&(v=C,g=x));return p.slice(g,g+v)}(u)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let n=[],u=1/0,p=1/0,g=-1/0,v=-1/0;for(let k of e){let R=new s.P(k.x+Di,k.y+Di);u=Math.min(u,R.x),p=Math.min(p,R.y),g=Math.max(g,R.x),v=Math.max(v,R.y),n.push(R)}let x=this.grid.query(u,p,g,v).concat(this.ignoredGrid.query(u,p,g,v)),C={},I={};for(let k of x){let R=k.key;if(C[R.bucketInstanceId]===void 0&&(C[R.bucketInstanceId]={}),C[R.bucketInstanceId][R.featureIndex])continue;let D=[new s.P(k.x1,k.y1),new s.P(k.x2,k.y1),new s.P(k.x2,k.y2),new s.P(k.x1,k.y2)];s.aw(n,D)&&(C[R.bucketInstanceId][R.featureIndex]=!0,I[R.bucketInstanceId]===void 0&&(I[R.bucketInstanceId]=[]),I[R.bucketInstanceId].push(R.featureIndex))}return I}insertCollisionBox(e,n,u,p,g,v){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,u,p,g,v){let x=u?this.ignoredGrid:this.grid,C={bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:n};for(let I=0;I<e.length;I+=4)x.insertCircle(C,e[I],e[I+1],e[I+2])}projectAndGetPerspectiveRatio(e,n,u,p,g){if(g){let v;p?(v=[e,n,p(e,n),1],s.at(v,v,g)):(v=[e,n,0,1],Do(v,v,g));let x=v[3];return{x:(v[0]/x+1)/2*this.transform.width+Di,y:(-v[1]/x+1)/2*this.transform.height+Di,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x*.5,isOccluded:!1,signedDistanceFromCamera:x}}{let v=this.transform.projectTileCoordinates(e,n,u,p);return{x:(v.point.x+1)/2*this.transform.width+Di,y:(1-v.point.y)/2*this.transform.height+Di,perspectiveRatio:.5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5,isOccluded:v.isOccluded,signedDistanceFromCamera:v.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,u,p){let g=this.transform.projectTileCoordinates(e,n,u,p);return .5+this.transform.cameraToCenterDistance/g.signedDistanceFromCamera*.5}isOffscreen(e,n,u,p){return u<Di||e>=this.screenRightBoundary||p<Di||n>this.screenBottomBoundary}isInsideGrid(e,n,u,p){return u>=0&&e<this.gridRightBoundary&&p>=0&&n<this.gridBottomBoundary}getViewportMatrix(){let e=s.ad([]);return s.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,u,p,g,v,x,C,I,k,R){let D=1,N=0,j=0,ee=1,J=e.anchorPointX+x[0],te=e.anchorPointY+x[1];if(v&&!g){let Xe=this.projectAndGetPerspectiveRatio(J+1,te,p,I,R),Ue=Xe.x-C.x,st=Math.atan((Xe.y-C.y)/Ue)+(Ue<0?Math.PI:0),Ot=Math.sin(st),ei=Math.cos(st);D=ei,N=Ot,j=-Ot,ee=ei}else if(!v&&g){let Xe=wt(this.transform);D=Xe.vecEast[0],N=Xe.vecEast[1],j=Xe.vecSouth[0],ee=Xe.vecSouth[1]}let re=C.x,de=C.y,ce=n;g&&(re=J,de=te,ce=Math.pow(2,-(this.transform.zoom-u.overscaledZ)),ce*=this.transform.getPitchedTextCorrection(J,te,p),k||(ce*=s.ae(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(re+=D*k.x*ce+j*k.y*ce,de+=N*k.x*ce+ee*k.y*ce);let ue=e.x1*ce,ge=e.x2*ce,he=(ue+ge)/2,Se=e.y1*ce,Le=e.y2*ce,ke=(Se+Le)/2,Ae=[{offsetX:ue,offsetY:Se},{offsetX:he,offsetY:Se},{offsetX:ge,offsetY:Se},{offsetX:ge,offsetY:ke},{offsetX:ge,offsetY:Le},{offsetX:he,offsetY:Le},{offsetX:ue,offsetY:Le},{offsetX:ue,offsetY:ke}],Re=[];for(let{offsetX:Xe,offsetY:Ue}of Ae)Re.push(new s.P(re+D*Xe+j*Ue,de+N*Xe+ee*Ue));let Ke=!1;if(g){let Xe=Re.map(Ue=>this.projectAndGetPerspectiveRatio(Ue.x,Ue.y,p,I,R));Ke=Xe.some(Ue=>!Ue.isOccluded),Re=Xe.map(Ue=>new s.P(Ue.x,Ue.y))}else Ke=!0;return{box:s.ax(Re),allPointsOccluded:!Ke}}}class Ii{constructor(e,n,u,p){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):p&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class oa{constructor(e,n,u,p,g){this.text=new Ii(e?e.text:null,n,u,g),this.icon=new Ii(e?e.icon:null,n,p,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Is{constructor(e,n,u){this.text=e,this.icon=n,this.skipFade=u}}class Ja{constructor(e,n,u,p,g){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=u,this.bucketIndex=p,this.tileID=g}}class Ro{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:u=>u.collisionGroupID===n}}return this.collisionGroups[e]}}function lo(m,e,n,u,p){let{horizontalAlign:g,verticalAlign:v}=s.aE(m);return new s.P(-(g-.5)*e+u[0]*p,-(v-.5)*n+u[1]*p)}class ld{constructor(e,n,u,p,g){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new ai(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Ro(p),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){let n=this.terrain;return n?(u,p)=>n.getElevation(e,u,p):null}getBucketParts(e,n,u,p){let g=u.getBucket(n),v=u.latestFeatureIndex;if(!g||!v||n.id!==g.layerIds[0])return;let x=u.collisionBoxArray,C=g.layers[0].layout,I=g.layers[0].paint,k=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),R=u.tileSize/s.Z,D=u.tileID.toUnwrapped(),N=C.get("text-rotation-alignment")==="map",j=s.az(u,1,this.transform.zoom),ee=s.aA(this.collisionIndex.transform,u,I.get("text-translate"),I.get("text-translate-anchor")),J=s.aA(this.collisionIndex.transform,u,I.get("icon-translate"),I.get("icon-translate-anchor")),te=ht(N,this.transform,j);this.retainedQueryData[g.bucketInstanceId]=new Ja(g.bucketInstanceId,v,g.sourceLayerIndex,g.index,u.tileID);let re={bucket:g,layout:C,translationText:ee,translationIcon:J,unwrappedTileID:D,pitchedLabelPlaneMatrix:te,scale:k,textPixelRatio:R,holdingForFade:u.holdingForFade(),collisionBoxArray:x,partiallyEvaluatedTextSize:s.ak(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(p)for(let de of g.sortKeyRanges){let{sortKey:ce,symbolInstanceStart:ue,symbolInstanceEnd:ge}=de;e.push({sortKey:ce,symbolInstanceStart:ue,symbolInstanceEnd:ge,parameters:re})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:re})}attemptAnchorPlacement(e,n,u,p,g,v,x,C,I,k,R,D,N,j,ee,J,te,re,de,ce){let ue=s.aB[e.textAnchor],ge=[e.textOffset0,e.textOffset1],he=lo(ue,u,p,ge,g),Se=this.collisionIndex.placeCollisionBox(n,D,C,I,k,x,v,J,R.predicate,de,he,ce);if((!re||this.collisionIndex.placeCollisionBox(re,D,C,I,k,x,v,te,R.predicate,de,he,ce).placeable)&&Se.placeable){let Le;if(this.prevPlacement&&this.prevPlacement.variableOffsets[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID].text&&(Le=this.prevPlacement.variableOffsets[N.crossTileID].anchor),N.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[N.crossTileID]={textOffset:ge,width:u,height:p,anchor:ue,textBoxScale:g,prevAnchor:Le},this.markUsedJustification(j,ue,N,ee),j.allowVerticalPlacement&&(this.markUsedOrientation(j,ee,N),this.placedOrientations[N.crossTileID]=ee),{shift:he,placedGlyphBoxes:Se}}}placeLayerBucketPart(e,n,u){let{bucket:p,layout:g,translationText:v,translationIcon:x,unwrappedTileID:C,pitchedLabelPlaneMatrix:I,textPixelRatio:k,holdingForFade:R,collisionBoxArray:D,partiallyEvaluatedTextSize:N,collisionGroup:j}=e.parameters,ee=g.get("text-optional"),J=g.get("icon-optional"),te=s.aC(g,"text-overlap","text-allow-overlap"),re=te==="always",de=s.aC(g,"icon-overlap","icon-allow-overlap"),ce=de==="always",ue=g.get("text-rotation-alignment")==="map",ge=g.get("text-pitch-alignment")==="map",he=g.get("icon-text-fit")!=="none",Se=g.get("symbol-z-order")==="viewport-y",Le=re&&(ce||!p.hasIconData()||J),ke=ce&&(re||!p.hasTextData()||ee);!p.collisionArrays&&D&&p.deserializeCollisionBoxes(D);let Ae=this.retainedQueryData[p.bucketInstanceId].tileID,Re=this._getTerrainElevationFunc(Ae),Ke=this.transform.getFastPathSimpleProjectionMatrix(Ae),Xe=(Ue,st,Ot)=>{var ei,Zi;if(n[Ue.crossTileID])return;if(R)return void(this.placements[Ue.crossTileID]=new Is(!1,!1,!1));let Si=!1,qi=!1,Wi=!0,Pi=null,di={box:null,placeable:!1,offscreen:null,occluded:!1},En={placeable:!1},zn=null,qn=null,ui=null,$s=0,jo=0,Gs=0;st.textFeatureIndex?$s=st.textFeatureIndex:Ue.useRuntimeCollisionCircles&&($s=Ue.featureIndex),st.verticalTextFeatureIndex&&(jo=st.verticalTextFeatureIndex);let La=st.textBox;if(La){let Fr=gn=>{let _n=s.al.horizontal;if(p.allowVerticalPlacement&&!gn&&this.prevPlacement){let pr=this.prevPlacement.placedOrientations[Ue.crossTileID];pr&&(this.placedOrientations[Ue.crossTileID]=pr,_n=pr,this.markUsedOrientation(p,_n,Ue))}return _n},Zs=(gn,_n)=>{if(p.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&st.verticalTextBox){for(let pr of p.writingModes)if(pr===s.al.vertical?(di=_n(),En=di):di=gn(),di&&di.placeable)break}else di=gn()},ps=Ue.textAnchorOffsetStartIndex,qs=Ue.textAnchorOffsetEndIndex;if(qs===ps){let gn=(_n,pr)=>{let Oi=this.collisionIndex.placeCollisionBox(_n,te,k,Ae,C,ge,ue,v,j.predicate,Re,void 0,Ke);return Oi&&Oi.placeable&&(this.markUsedOrientation(p,pr,Ue),this.placedOrientations[Ue.crossTileID]=pr),Oi};Zs(()=>gn(La,s.al.horizontal),()=>{let _n=st.verticalTextBox;return p.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&_n?gn(_n,s.al.vertical):{box:null,offscreen:null}}),Fr(di&&di.placeable)}else{let gn=s.aB[(Zi=(ei=this.prevPlacement)===null||ei===void 0?void 0:ei.variableOffsets[Ue.crossTileID])===null||Zi===void 0?void 0:Zi.anchor],_n=(Oi,jd,tf)=>{let nf=Oi.x2-Oi.x1,zg=Oi.y2-Oi.y1,lh=Ue.textBoxScale,Fc=he&&de==="never"?jd:null,Jr=null,Uo=te==="never"?1:2,eo="never";gn&&Uo++;for(let fs=0;fs<Uo;fs++){for(let Ud=ps;Ud<qs;Ud++){let Ws=p.textAnchorOffsets.get(Ud);if(gn&&Ws.textAnchor!==gn)continue;let ch=this.attemptAnchorPlacement(Ws,Oi,nf,zg,lh,ue,ge,k,Ae,C,j,eo,Ue,p,tf,v,x,Fc,Re);if(ch&&(Jr=ch.placedGlyphBoxes,Jr&&Jr.placeable))return Si=!0,Pi=ch.shift,Jr}gn?gn=null:eo=te}return u&&!Jr&&(Jr={box:this.collisionIndex.placeCollisionBox(La,"always",k,Ae,C,ge,ue,v,j.predicate,Re,void 0,Ke).box,offscreen:!1,placeable:!1,occluded:!1}),Jr};Zs(()=>_n(La,st.iconBox,s.al.horizontal),()=>{let Oi=st.verticalTextBox;return p.allowVerticalPlacement&&(!di||!di.placeable)&&Ue.numVerticalGlyphVertices>0&&Oi?_n(Oi,st.verticalIconBox,s.al.vertical):{box:null,occluded:!0,offscreen:null}}),di&&(Si=di.placeable,Wi=di.offscreen);let pr=Fr(di&&di.placeable);if(!Si&&this.prevPlacement){let Oi=this.prevPlacement.variableOffsets[Ue.crossTileID];Oi&&(this.variableOffsets[Ue.crossTileID]=Oi,this.markUsedJustification(p,Oi.anchor,Ue,pr))}}}if(zn=di,Si=zn&&zn.placeable,Wi=zn&&zn.offscreen,Ue.useRuntimeCollisionCircles){let Fr=p.text.placedSymbolArray.get(Ue.centerJustifiedTextSymbolIndex),Zs=s.am(p.textSizeData,N,Fr),ps=g.get("text-padding");qn=this.collisionIndex.placeCollisionCircles(te,Fr,p.lineVertexArray,p.glyphOffsetArray,Zs,C,I,u,ge,j.predicate,Ue.collisionCircleDiameter,ps,v,Re),qn.circles.length&&qn.collisionDetected&&!u&&s.w("Collisions detected, but collision boxes are not shown"),Si=re||qn.circles.length>0&&!qn.collisionDetected,Wi=Wi&&qn.offscreen}if(st.iconFeatureIndex&&(Gs=st.iconFeatureIndex),st.iconBox){let Fr=Zs=>this.collisionIndex.placeCollisionBox(Zs,de,k,Ae,C,ge,ue,x,j.predicate,Re,he&&Pi?Pi:void 0,Ke);En&&En.placeable&&st.verticalIconBox?(ui=Fr(st.verticalIconBox),qi=ui.placeable):(ui=Fr(st.iconBox),qi=ui.placeable),Wi=Wi&&ui.offscreen}let Oc=ee||Ue.numHorizontalGlyphVertices===0&&Ue.numVerticalGlyphVertices===0,Hs=J||Ue.numIconVertices===0;Oc||Hs?Hs?Oc||(qi=qi&&Si):Si=qi&&Si:qi=Si=qi&&Si;let za=qi&&ui.placeable;if(Si&&zn.placeable&&this.collisionIndex.insertCollisionBox(zn.box,te,g.get("text-ignore-placement"),p.bucketInstanceId,En&&En.placeable&&jo?jo:$s,j.ID),za&&this.collisionIndex.insertCollisionBox(ui.box,de,g.get("icon-ignore-placement"),p.bucketInstanceId,Gs,j.ID),qn&&Si&&this.collisionIndex.insertCollisionCircles(qn.circles,te,g.get("text-ignore-placement"),p.bucketInstanceId,$s,j.ID),u&&this.storeCollisionData(p.bucketInstanceId,Ot,st,zn,ui,qn),Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ue.crossTileID]=new Is((Si||Le)&&!zn?.occluded,(qi||ke)&&!ui?.occluded,Wi||p.justReloaded),n[Ue.crossTileID]=!0};if(Se){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let Ue=p.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let st=Ue.length-1;st>=0;--st){let Ot=Ue[st];Xe(p.symbolInstances.get(Ot),p.collisionArrays[Ot],Ot)}}else for(let Ue=e.symbolInstanceStart;Ue<e.symbolInstanceEnd;Ue++)Xe(p.symbolInstances.get(Ue),p.collisionArrays[Ue],Ue);p.justReloaded=!1}storeCollisionData(e,n,u,p,g,v){if(u.textBox||u.iconBox){let x,C;this.collisionBoxArrays.has(e)?x=this.collisionBoxArrays.get(e):(x=new Map,this.collisionBoxArrays.set(e,x)),x.has(n)?C=x.get(n):(C={text:null,icon:null},x.set(n,C)),u.textBox&&(C.text=p.box),u.iconBox&&(C.icon=g.box)}if(v){let x=this.collisionCircleArrays[e];x===void 0&&(x=this.collisionCircleArrays[e]=[]);for(let C=0;C<v.circles.length;C+=4)x.push(v.circles[C+0]-Di),x.push(v.circles[C+1]-Di),x.push(v.circles[C+2]),x.push(v.collisionDetected?1:0)}}markUsedJustification(e,n,u,p){let g;g=p===s.al.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[s.aD(n)];let v=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(let x of v)x>=0&&(e.text.placedSymbolArray.get(x).crossTileID=g>=0&&x!==g?0:u.crossTileID)}markUsedOrientation(e,n,u){let p=n===s.al.horizontal||n===s.al.horizontalOnly?n:0,g=n===s.al.vertical?n:0,v=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(let x of v)e.text.placedSymbolArray.get(x).placedOrientation=p;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let n=this.prevPlacement,u=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;let p=n?n.symbolFadeChange(e):1,g=n?n.opacities:{},v=n?n.variableOffsets:{},x=n?n.placedOrientations:{};for(let C in this.placements){let I=this.placements[C],k=g[C];k?(this.opacities[C]=new oa(k,p,I.text,I.icon),u=u||I.text!==k.text.placed||I.icon!==k.icon.placed):(this.opacities[C]=new oa(null,p,I.text,I.icon,I.skipFade),u=u||I.text||I.icon)}for(let C in g){let I=g[C];if(!this.opacities[C]){let k=new oa(I,p,!1,!1);k.isHidden()||(this.opacities[C]=k,u=u||I.text.placed||I.icon.placed)}}for(let C in v)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=v[C]);for(let C in x)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=x[C]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){let u={};for(let p of n){let g=p.getBucket(e);g&&p.latestFeatureIndex&&e.id===g.layerIds[0]&&this.updateBucketOpacities(g,p.tileID,u,p.collisionBoxArray)}}updateBucketOpacities(e,n,u,p){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let g=e.layers[0],v=g.layout,x=new oa(null,0,!1,!1,!0),C=v.get("text-allow-overlap"),I=v.get("icon-allow-overlap"),k=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),R=v.get("text-rotation-alignment")==="map",D=v.get("text-pitch-alignment")==="map",N=v.get("icon-text-fit")!=="none",j=new oa(null,0,C&&(I||!e.hasIconData()||v.get("icon-optional")),I&&(C||!e.hasTextData()||v.get("text-optional")),!0);!e.collisionArrays&&p&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(p);let ee=(te,re,de)=>{for(let ce=0;ce<re/4;ce++)te.opacityVertexArray.emplaceBack(de);te.hasVisibleVertices=te.hasVisibleVertices||de!==ts},J=this.collisionBoxArrays.get(e.bucketInstanceId);for(let te=0;te<e.symbolInstances.length;te++){let re=e.symbolInstances.get(te),{numHorizontalGlyphVertices:de,numVerticalGlyphVertices:ce,crossTileID:ue}=re,ge=this.opacities[ue];u[ue]?ge=x:ge||(ge=j,this.opacities[ue]=ge),u[ue]=!0;let he=re.numIconVertices>0,Se=this.placedOrientations[re.crossTileID],Le=Se===s.al.vertical,ke=Se===s.al.horizontal||Se===s.al.horizontalOnly;if(de>0||ce>0){let Re=tl(ge.text);ee(e.text,de,Le?ts:Re),ee(e.text,ce,ke?ts:Re);let Ke=ge.text.isHidden();[re.rightJustifiedTextSymbolIndex,re.centerJustifiedTextSymbolIndex,re.leftJustifiedTextSymbolIndex].forEach(st=>{st>=0&&(e.text.placedSymbolArray.get(st).hidden=Ke||Le?1:0)}),re.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(re.verticalPlacedTextSymbolIndex).hidden=Ke||ke?1:0);let Xe=this.variableOffsets[re.crossTileID];Xe&&this.markUsedJustification(e,Xe.anchor,re,Se);let Ue=this.placedOrientations[re.crossTileID];Ue&&(this.markUsedJustification(e,"left",re,Ue),this.markUsedOrientation(e,Ue,re))}if(he){let Re=tl(ge.icon),Ke=!(N&&re.verticalPlacedIconSymbolIndex&&Le);re.placedIconSymbolIndex>=0&&(ee(e.icon,re.numIconVertices,Ke?Re:ts),e.icon.placedSymbolArray.get(re.placedIconSymbolIndex).hidden=ge.icon.isHidden()),re.verticalPlacedIconSymbolIndex>=0&&(ee(e.icon,re.numVerticalIconVertices,Ke?ts:Re),e.icon.placedSymbolArray.get(re.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}let Ae=J&&J.has(te)?J.get(te):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let Re=e.collisionArrays[te];if(Re){let Ke=new s.P(0,0);if(Re.textBox||Re.verticalTextBox){let Xe=!0;if(k){let Ue=this.variableOffsets[ue];Ue?(Ke=lo(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textBoxScale),R&&Ke._rotate(D?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Xe=!1}if(Re.textBox||Re.verticalTextBox){let Ue;Re.textBox&&(Ue=Le),Re.verticalTextBox&&(Ue=ke),el(e.textCollisionBox.collisionVertexArray,ge.text.placed,!Xe||Ue,Ae.text,Ke.x,Ke.y)}}if(Re.iconBox||Re.verticalIconBox){let Xe=!!(!ke&&Re.verticalIconBox),Ue;Re.iconBox&&(Ue=Xe),Re.verticalIconBox&&(Ue=!Xe),el(e.iconCollisionBox.collisionVertexArray,ge.icon.placed,Ue,Ae.icon,N?Ke.x:0,N?Ke.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){let u=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function el(m,e,n,u,p,g){u&&u.length!==0||(u=[0,0,0,0]);let v=u[0]-Di,x=u[1]-Di,C=u[2]-Di,I=u[3]-Di;m.emplaceBack(e?1:0,n?1:0,p||0,g||0,v,x),m.emplaceBack(e?1:0,n?1:0,p||0,g||0,C,x),m.emplaceBack(e?1:0,n?1:0,p||0,g||0,C,I),m.emplaceBack(e?1:0,n?1:0,p||0,g||0,v,I)}let cd=Math.pow(2,25),es=Math.pow(2,24),dd=Math.pow(2,17),ac=Math.pow(2,16),ud=Math.pow(2,9),hd=Math.pow(2,8),lc=Math.pow(2,1);function tl(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;let e=m.placed?1:0,n=Math.floor(127*m.opacity);return n*cd+e*es+n*dd+e*ac+n*ud+e*hd+n*lc+e}let ts=0;class cc{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,u,p,g){let v=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(v,p,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((x,C)=>x.sortKey-C.sortKey));this._currentPartIndex<v.length;)if(n.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,g())return!0;return!1}}class sa{constructor(e,n,u,p,g,v,x,C){this.placement=new ld(e,n,v,x,C),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(e,n,u){let p=be.now(),g=()=>!this._forceFullPlacement&&be.now()-p>2;for(;this._currentPlacementIndex>=0;){let v=n[e[this._currentPlacementIndex]],x=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=x)&&(!v.maxzoom||v.maxzoom>x)){if(this._inProgressLayer||(this._inProgressLayer=new cc(v)),this._inProgressLayer.continuePlacement(u[v.source],this.placement,this._showCollisionBoxes,v,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}let Wr=512/s.Z/2;class Ps{constructor(e,n,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};let p=new Map;for(let g=0;g<n.length;g++){let v=n.get(g),x=v.key,C=p.get(x);C?C.push(v):p.set(x,[v])}for(let[g,v]of p){let x={positions:v.map(C=>({x:Math.floor(C.anchorX*Wr),y:Math.floor(C.anchorY*Wr)})),crossTileIDs:v.map(C=>C.crossTileID)};if(x.positions.length>128){let C=new s.aF(x.positions.length,16,Uint16Array);for(let{x:I,y:k}of x.positions)C.add(I,k);C.finish(),delete x.positions,x.index=C}this._symbolsByKey[g]=x}}getScaledCoordinates(e,n){let{x:u,y:p,z:g}=this.tileID.canonical,{x:v,y:x,z:C}=n.canonical,I=Wr/Math.pow(2,C-g),k=(x*s.Z+e.anchorY)*I,R=p*s.Z*Wr;return{x:Math.floor((v*s.Z+e.anchorX)*I-u*s.Z*Wr),y:Math.floor(k-R)}}findMatches(e,n,u){let p=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let g=0;g<e.length;g++){let v=e.get(g);if(v.crossTileID)continue;let x=this._symbolsByKey[v.key];if(!x)continue;let C=this.getScaledCoordinates(v,n);if(x.index){let I=x.index.range(C.x-p,C.y-p,C.x+p,C.y+p).sort();for(let k of I){let R=x.crossTileIDs[k];if(!u[R]){u[R]=!0,v.crossTileID=R;break}}}else if(x.positions)for(let I=0;I<x.positions.length;I++){let k=x.positions[I],R=x.crossTileIDs[I];if(Math.abs(k.x-C.x)<=p&&Math.abs(k.y-C.y)<=p&&!u[R]){u[R]=!0,v.crossTileID=R;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class pd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class aa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let n=Math.round((e-this.lng)/360);if(n!==0)for(let u in this.indexes){let p=this.indexes[u],g={};for(let v in p){let x=p[v];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+n),g[x.tileID.key]=x}this.indexes[u]=g}this.lng=e}addBucket(e,n,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let g=0;g<n.symbolInstances.length;g++)n.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let p=this.usedCrossTileIDs[e.overscaledZ];for(let g in this.indexes){let v=this.indexes[g];if(Number(g)>e.overscaledZ)for(let x in v){let C=v[x];C.tileID.isChildOf(e)&&C.findMatches(n.symbolInstances,e,p)}else{let x=v[e.scaledTo(Number(g)).key];x&&x.findMatches(n.symbolInstances,e,p)}}for(let g=0;g<n.symbolInstances.length;g++){let v=n.symbolInstances.get(g);v.crossTileID||(v.crossTileID=u.generate(),p[v.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ps(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(let u of n.getCrossTileIDsLists())for(let p of u)delete this.usedCrossTileIDs[e][p]}removeStaleBuckets(e){let n=!1;for(let u in this.indexes){let p=this.indexes[u];for(let g in p)e[p[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,p[g]),delete p[g],n=!0)}return n}}class la{constructor(){this.layerIndexes={},this.crossTileIDs=new pd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,u){let p=this.layerIndexes[e.id];p===void 0&&(p=this.layerIndexes[e.id]=new aa);let g=!1,v={};p.handleWrapJump(u);for(let x of n){let C=x.getBucket(e);C&&e.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(x.tileID,C,this.crossTileIDs)&&(g=!0),v[C.bucketInstanceId]=!0)}return p.removeStaleBuckets(v)&&(g=!0),g}pruneUnusedLayers(e){let n={};e.forEach(u=>{n[u]=!0});for(let u in this.layerIndexes)n[u]||delete this.layerIndexes[u]}}var dc="void main() {fragColor=vec4(1.0);}";let Gn={prelude:Qt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Qt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Qt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Qt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Qt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Qt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Qt(dc,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Qt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Qt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Qt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Qt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Qt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Qt(dc,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Qt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Qt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Qt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Qt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Qt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Qt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Qt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Qt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Qt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Qt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Qt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Qt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Qt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Qt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Qt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Qt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Qt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Qt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Qt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Qt(m,e){let n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/in ([\w]+) ([\w]+)/g),p=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=g?g.concat(p):p,x={};return{fragmentSource:m=m.replace(n,(C,I,k,R,D)=>(x[D]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${D}
in ${k} ${R} ${D};
#else
uniform ${k} ${R} u_${D};
#endif
`:`
#ifdef HAS_UNIFORM_u_${D}
    ${k} ${R} ${D} = u_${D};
#endif
`)),vertexSource:e=e.replace(n,(C,I,k,R,D)=>{let N=R==="float"?"vec2":"vec4",j=D.match(/color/)?"color":N;return x[D]?I==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${k} ${N} a_${D};
out ${k} ${R} ${D};
#else
uniform ${k} ${R} u_${D};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = a_${D};
#else
    ${k} ${R} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = unpack_mix_${j}(a_${D}, u_${D}_t);
#else
    ${k} ${R} ${D} = u_${D};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${k} ${N} a_${D};
#else
uniform ${k} ${R} u_${D};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${k} ${R} ${D} = a_${D};
#else
    ${k} ${R} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${k} ${R} ${D} = unpack_mix_${j}(a_${D}, u_${D}_t);
#else
    ${k} ${R} ${D} = u_${D};
#endif
`}),staticAttributes:u,staticUniforms:v}}class ks{constructor(e,n,u){this.vertexBuffer=e,this.indexBuffer=n,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var On=s.aG([{name:"a_pos",type:"Int16",components:2}]);let is="#define PROJECTION_MERCATOR",Vt="mercator";class ca{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Vt}get shaderDefine(){return is}get shaderPreludeCode(){return Gn.projectionMercator}get vertexShaderPreludeCode(){return Gn.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,u,p,g){if(this._cachedMesh)return this._cachedMesh;let v=new s.aI;v.emplaceBack(0,0),v.emplaceBack(s.Z,0),v.emplaceBack(0,s.Z),v.emplaceBack(s.Z,s.Z);let x=e.createVertexBuffer(v,On.members),C=s.aJ.simpleSegment(0,0,4,2),I=new s.aK;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3);let k=e.createIndexBuffer(I);return this._cachedMesh=new ks(x,k,C),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class da{constructor(e=0,n=0,u=0,p=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(u)||u<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=u,this.right=p}interpolate(e,n,u){return n.top!=null&&e.top!=null&&(this.top=s.B.number(e.top,n.top,u)),n.bottom!=null&&e.bottom!=null&&(this.bottom=s.B.number(e.bottom,n.bottom,u)),n.left!=null&&e.left!=null&&(this.left=s.B.number(e.left,n.left,u)),n.right!=null&&e.right!=null&&(this.right=s.B.number(e.right,n.right,u)),this}getCenter(e,n){let u=s.ae((this.left+e-this.right)/2,0,e),p=s.ae((this.top+n-this.bottom)/2,0,n);return new s.P(u,p)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new da(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ar(m,e){if(!m.renderWorldCopies||m.lngRange)return;let n=e.lng-m.center.lng;e.lng+=n>180?-360:n<-180?360:0}function Hn(m){return Math.max(0,Math.floor(m))}class Sn{constructor(e,n,u,p,g,v){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=p??0,this._maxPitch=g??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Hn(this._zoom),this._scale=s.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new da,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,u){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Hn(this._zoom),this._scale=s.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new da(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!u&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){let n=s.aL(e,-180,180)*Math.PI/180;var u,p,g,v,x,C,I,k,R;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=Y(),u=this._rotationMatrix,g=-this._bearingInRadians,v=(p=this._rotationMatrix)[0],x=p[1],C=p[2],I=p[3],k=Math.sin(g),R=Math.cos(g),u[0]=v*R+C*k,u[1]=x*R+I*k,u[2]=v*-k+C*R,u[3]=x*-k+I*R)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){let n=s.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){let n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aM(this._fovInRadians)}setFov(e){e=s.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=s.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){let n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=s.ac(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,u){this._unmodified=!1,this._edgeInsets.interpolate(e,n,u),this._constrain(),this._calcMatrices()}resize(e,n,u=!0){this._width=e,this._height=n,u&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new gi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,s.af])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let u=e.x,p=e.y,g=e.x,v=e.y;for(let x of n)u=Math.min(u,x.x),p=Math.min(p,x.y),g=Math.max(g,x.x),v=Math.max(v,x.y);return[new s.P(u,p),new s.P(g,p),new s.P(g,v),new s.P(u,v),new s.P(u,p)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:n,zoom:u}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(u),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=s.ad(new Float64Array(16));s.M(e,e,[this._width/2,-this._height/2,1]),s.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=s.ad(new Float64Array(16)),s.M(e,e,[1,-1,1]),s.L(e,e,[-1,-1,0]),s.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,u,p){let g=u!==void 0?u:this.bearing,v=p=p!==void 0?p:this.pitch,x=s.$.fromLngLat(e,n),C=-Math.cos(s.ab(v)),I=Math.sin(s.ab(v)),k=I*Math.sin(s.ab(g)),R=-I*Math.cos(s.ab(g)),D=this.elevation,N=n-D,j;C*N>=0||Math.abs(C)<.1?(j=1e4,D=n+j*C):j=-N/C;let ee,J,te=s.aN(1,x.y),re=0;do{if(re+=1,re>10)break;J=j/te,ee=new s.$(x.x+k*J,x.y+R*J),te=1/ee.meterInMercatorCoordinateUnits()}while(Math.abs(j-J*te)>1e-12);return{center:ee.toLngLat(),elevation:D,zoom:s.ah(this.height/2/Math.tan(this.fovInRadians/2)/J/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;let n=s.ag(1,this.center.lat)*this.worldSize,u=this.cameraToCenterDistance/n,p=s.$.fromLngLat(this.center,this.elevation),g=Z(this.center,this.elevation,this.pitch,this.bearing,u);this._elevation=e;let v=this.calculateCenterFromCameraLngLatAlt(g.toLngLat(),s.aN(g.z,p.y),this.bearing,this.pitch);this._elevation=v.elevation,this._center=v.center,this.setZoom(v.zoom)}getCameraPoint(){let e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){let e=s.ag(1,this.center.lat)*this.worldSize;return Z(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];let n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/s.Z,1/n/s.Z]}}class ji{constructor(e,n){this.min=e,this.max=n,this.center=s.aO([],s.aP([],this.min,this.max),.5)}quadrant(e){let n=[e%2==0,e<2],u=s.aQ(this.min),p=s.aQ(this.max);for(let g=0;g<n.length;g++)u[g]=n[g]?this.min[g]:this.center[g],p[g]=n[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new ji(u,p)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let u=0;u<e.planes.length;u++){let p=this.intersectsPlane(e.planes[u]);if(p===0)return 0;p===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],u=e[3];for(let p=0;p<3;p++)e[p]>0?(n+=e[p]*this.min[p],u+=e[p]*this.max[p]):(u+=e[p]*this.min[p],n+=e[p]*this.max[p]);return n>=0?2:u<0?0:1}}class hn{distanceToTile2d(e,n,u,p){let g=p.distanceX([e,n]),v=p.distanceY([e,n]);return Math.hypot(g,v)}getWrap(e,n,u){return u}getTileAABB(e,n,u,p){var g,v;let x=u,C=u;if(p.terrain){let k=new s.Y(e.z,n,e.z,e.x,e.y),R=p.terrain.getMinMaxElevation(k);x=(g=R.minElevation)!==null&&g!==void 0?g:u,C=(v=R.maxElevation)!==null&&v!==void 0?v:u}let I=1<<e.z;return new ji([n+e.x/I,e.y/I,x],[n+(e.x+1)/I,(e.y+1)/I,C])}allowVariableZoom(e,n){let u=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,p=s.ae(78.5-u/2,0,60);return!!n.terrain||e.pitch>p}allowWorldCopies(){return!0}recalculateCache(){}}class Mi{constructor(e,n,u){this.points=e,this.planes=n,this.aabb=u}static fromInvProjectionMatrix(e,n=1,u=0){let p=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{let k=1/(I=s.at([],I,e))[3]/n*p;return s.aR(I,I,[k,k,1/I[3],k])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{let k=s.aS([],g[I[0]],g[I[1]]),R=s.aS([],g[I[2]],g[I[1]]),D=s.aT([],s.aU([],k,R)),N=-s.aV(D,g[I[1]]);return D.concat(N)}),x=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],C=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let I of g)for(let k=0;k<3;k++)x[k]=Math.min(x[k],I[k]),C[k]=Math.max(C[k],I[k]);return new Mi(g,v,new ji(x,C))}}class As{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,u){return this._helper.interpolatePadding(e,n,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,u=!0){this._helper.resize(e,n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,u,p,g){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(v,x)=>this.getConstrained(v,x)},e,n,u,p,g),this._coveringTilesDetailsProvider=new hn}clone(){let e=new As;return e.apply(this),e}apply(e,n,u){this._helper.apply(e,n,u)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){let n=[new s.aW(0,e)];if(this._helper._renderWorldCopies){let u=this.screenPointToMercatorCoordinate(new s.P(0,0)),p=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),g=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),v=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),x=Math.floor(Math.min(u.x,p.x,g.x,v.x)),C=Math.floor(Math.max(u.x,p.x,g.x,v.x)),I=1;for(let k=x-I;k<=C+I;k++)k!==0&&n.push(new s.aW(k,e))}return n}getCameraFrustum(){return Mi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){let n=this.screenPointToLocation(this.centerPoint,e),u=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(u)}setLocationAtPoint(e,n){let u=s.ag(this.elevation,this.center.lat),p=this.screenPointToMercatorCoordinateAtZ(n,u),g=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,u),v=s.$.fromLngLat(e),x=new s.$(v.x-(p.x-g.x),v.y-(p.y-g.y));this.setCenter(x?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(s.$.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.$.fromLngLat(e))}screenPointToLocation(e,n){var u;return(u=this.screenPointToMercatorCoordinate(e,n))===null||u===void 0?void 0:u.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){let u=n.pointCoordinate(e);if(u!=null)return u}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){let u=n||0,p=[e.x,e.y,0,1],g=[e.x,e.y,1,1];s.at(p,p,this._pixelMatrixInverse),s.at(g,g,this._pixelMatrixInverse);let v=p[3],x=g[3],C=p[1]/v,I=g[1]/x,k=p[2]/v,R=g[2]/x,D=k===R?0:(u-k)/(R-k);return new s.$(s.B.number(p[0]/v,g[0]/x,D)/this.worldSize,s.B.number(C,I,D)/this.worldSize,u)}coordinatePoint(e,n=0,u=this._pixelMatrix){let p=[e.x*this.worldSize,e.y*this.worldSize,n,1];return s.at(p,p,u),new s.P(p[0]/p[3],p[1]/p[3])}getBounds(){let e=Math.max(0,this._helper._height/2-ve(this));return new gi().extend(this.screenPointToLocation(new s.P(0,e))).extend(this.screenPointToLocation(new s.P(this._helper._width,e))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-ve(this)}calculatePosMatrix(e,n=!1,u){var p;let g=(p=e.key)!==null&&p!==void 0?p:s.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),v=n?this._alignedPosMatrixCache:this._posMatrixCache;if(v.has(g)){let I=v.get(g);return u?I.f32:I.f64}let x=H(e,this.worldSize);s.N(x,n?this._alignedProjMatrix:this._viewProjMatrix,x);let C={f64:x,f32:new Float32Array(x)};return v.set(g,C),u?C.f32:C.f64}calculateFogMatrix(e){let n=e.key,u=this._fogMatrixCacheF32;if(u.has(n))return u.get(n);let p=H(e,this.worldSize);return s.N(p,this._fogMatrix,p),u.set(n,new Float32Array(p)),u.get(n)}getConstrained(e,n){n=s.ae(+n,this.minZoom,this.maxZoom);let u={center:new s.Q(e.lng,e.lat),zoom:n},p=this._helper._lngRange;this._helper._renderWorldCopies||p!==null||(p=[-179.9999999999,180-1e-10]);let g=this.tileSize*s.ac(u.zoom),v=0,x=g,C=0,I=g,k=0,R=0,{x:D,y:N}=this.size;if(this._helper._latRange){let de=this._helper._latRange;v=s.S(de[1])*g,x=s.S(de[0])*g,x-v<N&&(k=N/(x-v))}p&&(C=s.aL(s.U(p[0])*g,0,g),I=s.aL(s.U(p[1])*g,0,g),I<C&&(I+=g),I-C<D&&(R=D/(I-C)));let{x:j,y:ee}=Qn(g,e),J,te,re=Math.max(R||0,k||0);if(re){let de=new s.P(R?(I+C)/2:j,k?(x+v)/2:ee);return u.center=xr(g,de).wrap(),u.zoom+=s.ah(re),u}if(this._helper._latRange){let de=N/2;ee-de<v&&(te=v+de),ee+de>x&&(te=x-de)}if(p){let de=(C+I)/2,ce=j;this._helper._renderWorldCopies&&(ce=s.aL(j,de-g/2,de+g/2));let ue=D/2;ce-ue<C&&(J=C+ue),ce+ue>I&&(J=I-ue)}if(J!==void 0||te!==void 0){let de=new s.P(J??j,te??ee);u.center=xr(g,de).wrap()}return u}calculateCenterFromCameraLngLatAlt(e,n,u,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,u,p)}_calculateNearFarZIfNeeded(e,n,u){if(!this._helper.autoCalculateNearFarZ)return;let p=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),g=e-p*this._helper._pixelPerMeter/Math.cos(n),v=p<0?g:e,x=Math.PI/2+this.pitchInRadians,C=s.ab(this.fov)*(Math.abs(Math.cos(s.ab(this.roll)))*this.height+Math.abs(Math.sin(s.ab(this.roll)))*this.width)/this.height*(.5+u.y/this.height),I=Math.sin(C)*v/Math.sin(s.ae(Math.PI-x-C,.01,Math.PI-.01)),k=ve(this),R=Math.atan(k/this._helper.cameraToCenterDistance),D=s.ab(.75),N=R>D?2*R*(.5+u.y/(2*k)):D,j=Math.sin(N)*v/Math.sin(s.ae(Math.PI-x-N,.01,Math.PI-.01)),ee=Math.min(I,j);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*ee+v),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;let e=this.centerOffset,n=Qn(this.worldSize,this.center),u=n.x,p=n.y;this._helper._pixelPerMeter=s.ag(1,this.center.lat)*this.worldSize;let g=s.ab(Math.min(this.pitch,Ei)),v=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(g)),x;this._calculateNearFarZIfNeeded(v,g,e),x=new Float64Array(16),s.aY(x,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.an(this._invProjMatrix,x),x[8]=2*-e.x/this._helper._width,x[9]=2*e.y/this._helper._height,this._projectionMatrix=s.aZ(x),s.M(x,x,[1,-1,1]),s.L(x,x,[0,0,-this._helper.cameraToCenterDistance]),s.a_(x,x,-this.rollInRadians),s.a$(x,x,this.pitchInRadians),s.a_(x,x,-this.bearingInRadians),s.L(x,x,[-u,-p,0]),this._mercatorMatrix=s.M([],x,[this.worldSize,this.worldSize,this.worldSize]),s.M(x,x,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x),s.L(x,x,[0,0,-this.elevation]),this._viewProjMatrix=x,this._invViewProjMatrix=s.an([],x);let C=[0,0,-1,1];s.at(C,C,this._invViewProjMatrix),this._cameraPosition=[C[0]/C[3],C[1]/C[3],C[2]/C[3]],this._fogMatrix=new Float64Array(16),s.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,v,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,s.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.L(this._fogMatrix,this._fogMatrix,[-u,-p,0]),s.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x);let I=this._helper._width%2/2,k=this._helper._height%2/2,R=Math.cos(this.bearingInRadians),D=Math.sin(-this.bearingInRadians),N=u-Math.round(u)+R*I+D*k,j=p-Math.round(p)+R*k+D*I,ee=new Float64Array(x);if(s.L(ee,ee,[N>.5?N-1:N,j>.5?j-1:j,0]),this._alignedProjMatrix=ee,x=s.an(new Float64Array(16),this._pixelMatrix),!x)throw new Error("failed to invert matrix");this._pixelMatrixInverse=x,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;let e=this.screenPointToMercatorCoordinate(new s.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return s.at(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){let e=s.ag(1,this.center.lat)*this.worldSize;return Z(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){let u=s.$.fromLngLat(e),p=[u.x*this.worldSize,u.y*this.worldSize,n,1];return s.at(p,p,this._viewProjMatrix),p[2]/p[3]}getProjectionData(e){let{overscaledTileID:n,aligned:u,applyTerrainMatrix:p}=e,g=this._helper.getMercatorTileCoordinates(n),v=n?this.calculatePosMatrix(n,u,!0):null,x;return x=n&&n.terrainRttPosMatrix32f&&p?n.terrainRttPosMatrix32f:v||s.b0(),{mainMatrix:x,tileMercatorCoords:g,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:x}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,u){return 1}transformLightDirection(e){return s.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,u,p){let g=this.calculatePosMatrix(u),v;p?(v=[e,n,p(e,n),1],s.at(v,v,g)):(v=[e,n,0,1],Do(v,v,g));let x=v[3];return{point:new s.P(v[0]/x,v[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}populateCache(e){for(let n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){let u=s.$.fromLngLat(e,n),p=u.meterInMercatorCoordinateUnits(),g=s.b1();return s.L(g,g,[u.x,u.y,u.z]),s.a_(g,g,Math.PI),s.a$(g,g,Math.PI/2),s.M(g,g,[-p,p,p]),g}getProjectionDataForCustomLayer(e=!0){let n=new s.Y(0,0,0,0,0),u=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),p=H(n,this.worldSize);s.N(p,this._viewProjMatrix,p),u.tileMercatorCoords=[0,0,1,1];let g=[s.Z,s.Z,this.worldSize/this._helper.pixelsPerMeter],v=s.b2();return s.M(v,p,g),u.fallbackMatrix=v,u.mainMatrix=v,u}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Zn(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ur(m){if(m.useSlerp)if(m.k<1){let e=s.b3(m.startEulerAngles.roll,m.startEulerAngles.pitch,m.startEulerAngles.bearing),n=s.b3(m.endEulerAngles.roll,m.endEulerAngles.pitch,m.endEulerAngles.bearing),u=new Float64Array(4);s.b4(u,e,n,m.k);let p=s.b5(u);m.tr.setRoll(p.roll),m.tr.setPitch(p.pitch),m.tr.setBearing(p.bearing)}else m.tr.setRoll(m.endEulerAngles.roll),m.tr.setPitch(m.endEulerAngles.pitch),m.tr.setBearing(m.endEulerAngles.bearing);else m.tr.setRoll(s.B.number(m.startEulerAngles.roll,m.endEulerAngles.roll,m.k)),m.tr.setPitch(s.B.number(m.startEulerAngles.pitch,m.endEulerAngles.pitch,m.k)),m.tr.setBearing(s.B.number(m.startEulerAngles.bearing,m.endEulerAngles.bearing,m.k))}function er(m,e,n,u,p){let g=p.padding,v=Qn(p.worldSize,n.getNorthWest()),x=Qn(p.worldSize,n.getNorthEast()),C=Qn(p.worldSize,n.getSouthEast()),I=Qn(p.worldSize,n.getSouthWest()),k=s.ab(-u),R=v.rotate(k),D=x.rotate(k),N=C.rotate(k),j=I.rotate(k),ee=new s.P(Math.max(R.x,D.x,j.x,N.x),Math.max(R.y,D.y,j.y,N.y)),J=new s.P(Math.min(R.x,D.x,j.x,N.x),Math.min(R.y,D.y,j.y,N.y)),te=ee.sub(J),re=(p.width-(g.left+g.right+e.left+e.right))/te.x,de=(p.height-(g.top+g.bottom+e.top+e.bottom))/te.y;if(de<0||re<0)return void Zn();let ce=Math.min(s.ah(p.scale*Math.min(re,de)),m.maxZoom),ue=s.P.convert(m.offset),ge=new s.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(s.ab(u)),he=ue.add(ge).mult(p.scale/s.ac(ce));return{center:xr(p.worldSize,v.add(C).div(2).sub(he)),zoom:ce,bearing:u}}class ua{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,u){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(u,e.around)}cameraForBoxAndBearing(e,n,u,p,g){return er(e,n,u,p,g)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(s.Q.convert(n.center))}handleEaseTo(e,n){let u=e.zoom,p=e.padding,g={roll:e.roll,pitch:e.pitch,bearing:e.bearing},v={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},x=n.zoom!==void 0,C=!e.isPaddingEqual(n.padding),I=!1,k=x?+n.zoom:e.zoom,R=e.centerPoint.add(n.offsetAsPoint),D=e.screenPointToLocation(R),{center:N,zoom:j}=e.getConstrained(s.Q.convert(n.center||D),k??u);Ar(e,N);let ee=Qn(e.worldSize,D),J=Qn(e.worldSize,N).sub(ee),te=s.ac(j-u);return I=j!==u,{easeFunc:re=>{if(I&&e.setZoom(s.B.number(u,j,re)),s.b6(g,v)||ur({startEulerAngles:g,endEulerAngles:v,tr:e,k:re,useSlerp:g.roll!=v.roll}),C&&(e.interpolatePadding(p,n.padding,re),R=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{let de=s.ac(e.zoom-u),ce=j>u?Math.min(2,te):Math.max(.5,te),ue=Math.pow(ce,1-re),ge=xr(e.worldSize,ee.add(J.mult(re*ue)).mult(de));e.setLocationAtPoint(e.renderWorldCopies?ge.wrap():ge,R)}},isZooming:I,elevationCenter:N}}handleFlyTo(e,n){let u=n.zoom!==void 0,p=e.zoom,g=e.getConstrained(s.Q.convert(n.center||n.locationAtOffset),u?+n.zoom:p),v=g.center,x=g.zoom;Ar(e,v);let C=Qn(e.worldSize,n.locationAtOffset),I=Qn(e.worldSize,v).sub(C),k=I.mag(),R=s.ac(x-p),D;if(n.minZoom!==void 0){let N=Math.min(+n.minZoom,p,x),j=e.getConstrained(v,N).zoom;D=s.ac(j-p)}return{easeFunc:(N,j,ee,J)=>{e.setZoom(N===1?x:p+s.ah(j));let te=N===1?v:xr(e.worldSize,C.add(I.mult(ee)).mult(j));e.setLocationAtPoint(e.renderWorldCopies?te.wrap():te,J)},scaleOfZoom:R,targetCenter:v,scaleOfMinZoom:D,pixelPathLength:k}}}class oi{constructor(e,n,u){this.blendFunction=e,this.blendColor=n,this.mask=u}}oi.Replace=[1,0],oi.disabled=new oi(oi.Replace,s.b7.transparent,[!1,!1,!1,!1]),oi.unblended=new oi(oi.Replace,s.b7.transparent,[!0,!0,!0,!0]),oi.alphaBlended=new oi([1,771],s.b7.transparent,[!0,!0,!0,!0]);let Ui=2305;class jt{constructor(e,n,u){this.enable=e,this.mode=n,this.frontFace=u}}jt.disabled=new jt(!1,1029,Ui),jt.backCCW=new jt(!0,1029,Ui),jt.frontCCW=new jt(!0,1028,Ui);class Mt{constructor(e,n,u){this.func=e,this.mask=n,this.range=u}}Mt.ReadOnly=!1,Mt.ReadWrite=!0,Mt.disabled=new Mt(519,Mt.ReadOnly,[0,1]);let Ds=7680;class Dt{constructor(e,n,u,p,g,v){this.test=e,this.ref=n,this.mask=u,this.fail=p,this.depthFail=g,this.pass=v}}Dt.disabled=new Dt({func:519,mask:0},0,0,Ds,Ds,Ds);let il=new WeakMap;function Fn(m){var e;if(il.has(m))return il.get(m);{let n=(e=m.getParameter(m.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return il.set(m,n),n}}class uc{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;let n=e.context,u=n.gl;this._texFormat=u.RGBA,this._texType=u.UNSIGNED_BYTE;let p=new s.aI;p.emplaceBack(-1,-1),p.emplaceBack(2,-1),p.emplaceBack(-1,2);let g=new s.aK;g.emplaceBack(0,1,2),this._fullscreenTriangle=new ks(n.createVertexBuffer(p,On.members),n.createIndexBuffer(g),s.aJ.simpleSegment(0,0,p.length,g.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(u.TEXTURE1);let v=u.createTexture();u.bindTexture(u.TEXTURE_2D,v),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texImage2D(u.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(v),Fn(u)&&(this._pbo=u.createBuffer(),u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.bufferData(u.PIXEL_PACK_BUFFER,4,u.STREAM_READ),u.bindBuffer(u.PIXEL_PACK_BUFFER,null))}destroy(){let e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){let u=this._updateCount;return this._readbackQueue?u>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():u>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){let e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){let u=this._cachedRenderContext.context,p=u.gl;if(this._bindFramebuffer(),u.viewport.set([0,0,this._texWidth,this._texHeight]),u.clear({color:s.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(u,p.TRIANGLES,Mt.disabled,Dt.disabled,oi.unblended,jt.disabled,((g,v)=>({u_input:g,u_output_expected:v}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Fn(p)){p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.readBuffer(p.COLOR_ATTACHMENT0),p.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),p.bindBuffer(p.PIXEL_PACK_BUFFER,null);let g=p.fenceSync(p.SYNC_GPU_COMMANDS_COMPLETE,0);p.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:g}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){let e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Fn(e)){let n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=uc._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}let hc=s.Z/128;function ha(m,e){let n=m.granularity!==void 0?Math.max(m.granularity,1):1,u=n+(m.generateBorders?2:0),p=n+(m.extendToNorthPole||m.generateBorders?1:0)+(m.extendToSouthPole||m.generateBorders?1:0),g=u+1,v=p+1,x=m.generateBorders?-1:0,C=m.generateBorders||m.extendToNorthPole?-1:0,I=n+(m.generateBorders?1:0),k=n+(m.generateBorders||m.extendToSouthPole?1:0),R=g*v,D=u*p*6,N=g*v>65536;if(N&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");let j=N||e==="32bit",ee=new Int16Array(2*R),J=0;for(let de=C;de<=k;de++)for(let ce=x;ce<=I;ce++){let ue=ce/n*s.Z;ce===-1&&(ue=-64),ce===n+1&&(ue=s.Z+hc);let ge=de/n*s.Z;de===-1&&(ge=m.extendToNorthPole?s.b9:-64),de===n+1&&(ge=m.extendToSouthPole?s.ba:s.Z+hc),ee[J++]=ue,ee[J++]=ge}let te=j?new Uint32Array(D):new Uint16Array(D),re=0;for(let de=0;de<p;de++)for(let ce=0;ce<u;ce++){let ue=ce+1+de*g,ge=ce+(de+1)*g,he=ce+1+(de+1)*g;te[re++]=ce+de*g,te[re++]=ge,te[re++]=ue,te[re++]=ue,te[re++]=ge,te[re++]=he}return{vertices:ee.buffer.slice(0),indices:te.buffer.slice(0),uses32bitIndices:j}}let Dr=new s.aH({fill:new s.bb(128,2),line:new s.bb(512,0),tile:new s.bb(128,32),stencil:new s.bb(128,1),circle:3});class pa{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Gn.projectionGlobe}get vertexShaderPreludeCode(){return Gn.projectionMercator.vertexSource}get subdivisionGranularity(){return Dr}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new uc(e));let n=s.S(this._errorQueryLatitudeDegrees),u=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,p=this._errorMeasurement.updateErrorLoop(n,u),g=be.now();p!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=p,this._errorMeasurementLastChangeTime=g);let v=Math.min(Math.max((g-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bd(v))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,u,p,g){let v=(g==="stencil"?Dr.stencil:Dr.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:v,generateBorders:u,extendToNorthPole:n.y===0&&p,extendToSouthPole:n.y===(1<<n.z)-1&&p})}_getMesh(e,n){let u=this._getMeshKey(n);if(u in this._tileMeshCache)return this._tileMeshCache[u];let p=function(g,v){let x=ha(v,"16bit"),C=s.aI.deserialize({arrayBuffer:x.vertices,length:x.vertices.byteLength/2/2}),I=s.aK.deserialize({arrayBuffer:x.indices,length:x.indices.byteLength/2/3});return new ks(g.createVertexBuffer(C,On.members),g.createIndexBuffer(I),s.aJ.simpleSegment(0,0,C.length,I.length))}(e,n);return this._tileMeshCache[u]=p,p}recalculate(e){}hasTransition(){let e=be.now(),n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}let pc=new s.r({type:new s.D(s.v.projection.type)});class fa extends s.E{constructor(e){super(),this._transitionable=new s.T(pc),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.C(0)),this._mercatorProjection=new ca,this._verticalPerspectiveProjection=new pa}get transitionState(){let e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof s.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,u,p,g){return this.currentProjection.getMeshFromTileID(e,n,u,p,g)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function ma(m){let e=Oo(m.worldSize,m.center.lat);return 2*Math.PI*e}function tr(m,e,n,u,p){let g=1/(1<<p),v=e/s.Z*g+u*g,x=s.bg((m/s.Z*g+n*g)*Math.PI*2+Math.PI,2*Math.PI),C=2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI,I=Math.cos(C),k=new Float64Array(3);return k[0]=Math.sin(x)*I,k[1]=Math.sin(C),k[2]=Math.cos(x)*I,k}function pn(m){return function(e,n){let u=Math.cos(n),p=new Float64Array(3);return p[0]=Math.sin(e)*u,p[1]=Math.sin(n),p[2]=Math.cos(e)*u,p}(m.lng*Math.PI/180,m.lat*Math.PI/180)}function Oo(m,e){return m/(2*Math.PI)/Math.cos(e*Math.PI/180)}function co(m){let e=Math.asin(m[1])/Math.PI*180,n=Math.sqrt(m[0]*m[0]+m[2]*m[2]);if(n>1e-6){let u=m[0]/n,p=Math.acos(m[2]/n),g=(u>0?p:-p)/Math.PI*180;return new s.Q(s.aL(g,-180,180),e)}return new s.Q(0,e)}function Fo(m){return Math.cos(m*Math.PI/180)}function fn(m,e){let n=Fo(m),u=Fo(e);return s.ah(u/n)}function nl(m,e){let n=m.rotate(e.bearingInRadians),u=e.zoom+fn(e.center.lat,0),p=s.bc(1/Fo(e.center.lat),1/Fo(Math.min(Math.abs(e.center.lat),60)),s.bf(u,7,3,0,1)),g=360/ma({worldSize:e.worldSize,center:{lat:e.center.lat}});return new s.Q(e.center.lng-n.x*g*p,s.ae(e.center.lat+n.y*g,-85.051129,s.af))}function ga(m){let e=.5*m,n=Math.sin(e),u=Math.cos(e);return Math.log(n+u)-Math.log(u-n)}function ns(m,e,n,u){let p=m.lat+n*u;if(Math.abs(n)>1){let g=(Math.sign(m.lat+n)!==Math.sign(m.lat)?-Math.abs(m.lat):Math.abs(m.lat))*Math.PI/180,v=Math.abs(m.lat+n)*Math.PI/180,x=ga(g+u*(v-g)),C=ga(g),I=ga(v);return new s.Q(m.lng+e*((x-C)/(I-C)),p)}return new s.Q(m.lng+e*u,p)}class Du{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;let e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,u,p){let g=`${e.z}_${e.x}_${e.y}`,v=this._cache.get(g);if(v)return v;let x=this._cachePrevious.get(g);if(x)return this._cache.set(g,x),x;let C=this._aabbFactory(e,n,u,p);return this._cache.set(g,C),this._hadAnyChanges=!0,C}}function Ln(m,e,n){let u=m-e;return u<0?-u:Math.max(0,u-n)}function _a(m,e,n,u,p){let g=m-n,v;return v=g<0?Math.min(-g,1+g-p):g>1?Math.min(Math.max(g-p,0),1-g):0,Math.max(v,Ln(e,u,p))}class Xr{constructor(){this._aabbCache=new Du(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,u,p){let g=1<<u.z,v=1/g,x=u.x/g,C=u.y/g,I=2;return I=Math.min(I,_a(e,n,x,C,v)),I=Math.min(I,_a(e,n,x+.5,-C-v,v)),I=Math.min(I,_a(e,n,x+.5,2-C-v,v)),I}getWrap(e,n,u){let p=1<<n.z,g=1/p,v=n.x/p,x=Ln(e.x,v,g),C=Ln(e.x,v-1,g),I=Ln(e.x,v+1,g),k=Math.min(x,C,I);return k===I?1:k===C?-1:0}allowVariableZoom(e,n){return Me(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,u,p){return this._aabbCache.getTileAABB(e,n,u,p)}_computeTileAABB(e,n,u,p){if(e.z<=0)return new ji([-1,-1,-1],[1,1,1]);if(e.z===1)return new ji([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{let g=[tr(0,0,e.x,e.y,e.z),tr(s.Z,0,e.x,e.y,e.z),tr(s.Z,s.Z,e.x,e.y,e.z),tr(0,s.Z,e.x,e.y,e.z)],v=[1,1,1],x=[-1,-1,-1];for(let C of g)for(let I=0;I<3;I++)v[I]=Math.min(v[I],C[I]),x[I]=Math.max(x[I],C[I]);if(e.y===0||e.y===(1<<e.z)-1){let C=[0,e.y===0?1:-1,0];for(let I=0;I<3;I++)v[I]=Math.min(v[I],C[I]),x[I]=Math.max(x[I],C[I])}return new ji(v,x)}}}class rs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,u){return this._helper.interpolatePadding(e,n,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=s.bk(),this._projectionMatrix=s.b1(),this._globeViewProjMatrix32f=s.b0(),this._globeViewProjMatrixNoCorrection=s.b1(),this._globeViewProjMatrixNoCorrectionInverted=s.b1(),this._globeProjMatrixInverted=s.b1(),this._cameraPosition=s.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new Xr}clone(){let e=new rs;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){let e=s.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){let{overscaledTileID:n,applyGlobeMatrix:u}=e,p=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:p,clippingPlane:this._cachedClippingPlane,projectionTransition:u?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){let n=this.pitchInRadians,u=this.cameraToCenterDistance/e,p=Math.sin(n)*u,g=Math.cos(n)*u+1,v=1/Math.sqrt(p*p+g*g)*1,x=-p,C=g,I=Math.sqrt(x*x+C*C);x/=I,C/=I;let k=[0,x,C];s.bl(k,k,[0,0,0],-this.bearingInRadians),s.bm(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),s.bn(k,k,[0,0,0],this.center.lng*Math.PI/180);let R=1/s.bo(k);return s.aO(k,k,R),[...k,-v*R]}isLocationOccluded(e){return!this.isSurfacePointVisible(pn(e))}transformLightDirection(e){let n=this._helper._center.lng*Math.PI/180,u=this._helper._center.lat*Math.PI/180,p=Math.cos(u),g=[Math.sin(n)*p,Math.sin(u),Math.cos(n)*p],v=[g[2],0,-g[0]],x=[0,0,0];s.aU(x,v,g),s.aT(v,v),s.aT(x,x);let C=[0,0,0];return s.aT(C,[v[0]*e[0]+x[0]*e[1]+g[0]*e[2],v[1]*e[0]+x[1]*e[1]+g[1]*e[2],v[2]*e[0]+x[2]*e[1]+g[2]*e[2]]),C}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,u){let p=function(x,C,I){let k=1/(1<<I.z);return new s.$(x/s.Z*k+I.x*k,C/s.Z*k+I.y*k)}(e,n,u.canonical),g=(v=p.y,[s.bg(p.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI]);var v;return this.getCircleRadiusCorrection()/Math.cos(g[1])}projectTileCoordinates(e,n,u,p){let g=u.canonical,v=tr(e,n,g.x,g.y,g.z),x=1+(p?p(e,n):0)/s.bu,C=[v[0]*x,v[1]*x,v[2]*x,1];s.at(C,C,this._globeViewProjMatrixNoCorrection);let I=this._cachedClippingPlane,k=I[0]*v[0]+I[1]*v[1]+I[2]*v[2]+I[3]<0;return{point:new s.P(C[0]/C[3],C[1]/C[3]),signedDistanceFromCamera:C[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;let e=Oo(this.worldSize,this.center.lat),n=s.b2(),u=s.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),s.aY(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);let p=this.centerOffset;n[8]=2*-p.x/this._helper._width,n[9]=2*p.y/this._helper._height,this._projectionMatrix=s.aZ(n),this._globeProjMatrixInverted=s.b2(),s.an(this._globeProjMatrixInverted,n),s.L(n,n,[0,0,-this.cameraToCenterDistance]),s.a_(n,n,this.rollInRadians),s.a$(n,n,-this.pitchInRadians),s.a_(n,n,this.bearingInRadians),s.L(n,n,[0,0,-e]);let g=s.bh();g[0]=e,g[1]=e,g[2]=e,s.a$(u,n,this.center.lat*Math.PI/180),s.bp(u,u,-this.center.lng*Math.PI/180),s.M(u,u,g),this._globeViewProjMatrixNoCorrection=u,s.a$(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.bp(n,n,-this.center.lng*Math.PI/180),s.M(n,n,g),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=s.b2(),s.an(this._globeViewProjMatrixNoCorrectionInverted,u);let v=s.bh();this._cameraPosition=s.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,s.bl(this._cameraPosition,this._cameraPosition,v,-this.rollInRadians),s.bm(this._cameraPosition,this._cameraPosition,v,this.pitchInRadians),s.bl(this._cameraPosition,this._cameraPosition,v,-this.bearingInRadians),s.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bm(this._cameraPosition,this._cameraPosition,v,-this.center.lat*Math.PI/180),s.bn(this._cameraPosition,this._cameraPosition,v,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);let x=s.aZ(this._globeViewProjMatrixNoCorrectionInverted);s.M(x,x,[1,1,-1]),this._cachedFrustum=Mi.fromInvProjectionMatrix(x)}calculateFogMatrix(e){s.w("calculateFogMatrix is not supported on globe projection.");let n=s.b2();return s.ad(n),n}getVisibleUnwrappedCoordinates(e){return[new s.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;let u=pn(e);s.aO(u,u,1+n/s.bu);let p=s.bk();return s.at(p,[u[0],u[1],u[2],1],this._globeViewProjMatrixNoCorrection),p[2]/p[3]}populateCache(e){}getBounds(){let e=.5*this.width,n=.5*this.height,u=[new s.P(0,0),new s.P(e,0),new s.P(this.width,0),new s.P(this.width,n),new s.P(this.width,this.height),new s.P(e,this.height),new s.P(0,this.height),new s.P(0,n)],p=[];for(let R of u)p.push(this.unprojectScreenPoint(R));let g=0,v=0,x=0,C=0,I=this.center;for(let R of p){let D=s.bq(I.lng,R.lng),N=s.bq(I.lat,R.lat);D<v&&(v=D),D>g&&(g=D),N<C&&(C=N),N>x&&(x=N)}let k=[I.lng+v,I.lat+C,I.lng+g,I.lat+x];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new gi(k)}getConstrained(e,n){let u=s.ae(e.lat,-85.051129,s.af),p=s.ae(+n,this.minZoom+fn(0,u),this.maxZoom);return{center:new s.Q(e.lng,u),zoom:p}}calculateCenterFromCameraLngLatAlt(e,n,u,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,u,p)}setLocationAtPoint(e,n){let u=pn(this.unprojectScreenPoint(n)),p=pn(e),g=s.bh();s.br(g);let v=s.bh();s.bn(v,u,g,-this.center.lng*Math.PI/180),s.bm(v,v,g,this.center.lat*Math.PI/180);let x=p[0]*p[0]+p[2]*p[2],C=v[0]*v[0];if(x<C)return;let I=Math.sqrt(x-C),k=-I,R=s.bs(p[0],p[2],v[0],I),D=s.bs(p[0],p[2],v[0],k),N=s.bh();s.bn(N,p,g,-R);let j=s.bs(N[1],N[2],v[1],v[2]),ee=s.bh();s.bn(ee,p,g,-D);let J=s.bs(ee[1],ee[2],v[1],v[2]),te=.5*Math.PI,re=j>=-te&&j<=te,de=J>=-te&&J<=te,ce,ue;if(re&&de){let Le=this.center.lng*Math.PI/180,ke=this.center.lat*Math.PI/180;s.bv(R,Le)+s.bv(j,ke)<s.bv(D,Le)+s.bv(J,ke)?(ce=R,ue=j):(ce=D,ue=J)}else if(re)ce=R,ue=j;else{if(!de)return;ce=D,ue=J}let ge=ce/Math.PI*180,he=ue/Math.PI*180,Se=this.center.lat;this.setCenter(new s.Q(ge,s.ae(he,-90,90))),this.setZoom(this.zoom+fn(Se,this.center.lat))}locationToScreenPoint(e,n){let u=pn(e);if(n){let p=n.getElevationForLngLatZoom(e,this._helper._tileZoom);s.aO(u,u,1+p/s.bu)}return this._projectSurfacePointToScreen(u)}_projectSurfacePointToScreen(e){let n=s.bk();return s.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new s.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){let u=n.pointCoordinate(e);if(u)return u}return s.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var u;return(u=this.screenPointToMercatorCoordinate(e,n))===null||u===void 0?void 0:u.toLngLat()}isPointOnMapSurface(e,n){let u=this._cameraPosition,p=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(u,p)}getRayDirectionFromPixel(e){let n=s.bk();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,s.at(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];let u=s.bh();u[0]=n[0]-this._cameraPosition[0],u[1]=n[1]-this._cameraPosition[1],u[2]=n[2]-this._cameraPosition[2];let p=s.bh();return s.aT(p,u),p}isSurfacePointVisible(e){let n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;let n=s.bk();return s.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){let u=s.aV(e,n),p=s.bh(),g=s.bh();s.aO(g,n,u),s.aS(p,e,g);let v=1-s.aV(p,p);if(v<0)return null;let x=s.aV(e,e)-1,C=-u+(u<0?1:-1)*Math.sqrt(v),I=x/C,k=C;return{tMin:Math.min(I,k),tMax:Math.max(I,k)}}unprojectScreenPoint(e){let n=this._cameraPosition,u=this.getRayDirectionFromPixel(e),p=this.rayPlanetIntersection(n,u);if(p){let k=s.bh();s.aP(k,n,[u[0]*p.tMin,u[1]*p.tMin,u[2]*p.tMin]);let R=s.bh();return s.aT(R,k),co(R)}let g=this._cachedClippingPlane,v=g[0]*u[0]+g[1]*u[1]+g[2]*u[2],x=-s.bt(g,n)/v,C=s.bh();if(x>0)s.aP(C,n,[u[0]*x,u[1]*x,u[2]*x]);else{let k=s.bh();s.aP(k,n,[2*u[0],2*u[1],2*u[2]]);let R=s.bt(this._cachedClippingPlane,k);s.aS(C,k,[this._cachedClippingPlane[0]*R,this._cachedClippingPlane[1]*R,this._cachedClippingPlane[2]*R])}let I=function(k){let R=s.bh();return R[0]=k[0]*-k[3],R[1]=k[1]*-k[3],R[2]=k[2]*-k[3],{center:R,radius:Math.sqrt(1-k[3]*k[3])}}(g);return co(function(k,R,D){let N=s.bh();s.aS(N,D,k);let j=s.bh();return s.bi(j,k,N,R/s.bj(N)),j}(I.center,I.radius,C))}getMatrixForModel(e,n){let u=s.Q.convert(e),p=1/s.bu,g=s.b1();return s.bp(g,g,u.lng/180*Math.PI),s.a$(g,g,-u.lat/180*Math.PI),s.L(g,g,[0,0,1+n/s.bu]),s.a$(g,g,.5*Math.PI),s.M(g,g,[p,p,p]),g}getProjectionDataForCustomLayer(e=!0){let n=this.getProjectionData({overscaledTileID:new s.Y(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class ya{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,u){return this._helper.interpolatePadding(e,n,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,u=!0){this._helper.resize(e,n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new As,this._verticalPerspectiveTransform=new rs}clone(){let e=new ya;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){let n=this._mercatorTransform.getProjectionData(e),u=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?u.mainMatrix:n.mainMatrix,clippingPlane:u.clippingPlane,tileMercatorCoords:u.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return s.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,u){let p=this._mercatorTransform.getPitchedTextCorrection(e,n,u),g=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,u);return s.bc(p,g,this._globeness)}projectTileCoordinates(e,n,u,p){return this.currentTransform.projectTileCoordinates(e,n,u,p)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,u,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,u,p)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){let n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;let u=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return u.fallbackMatrix=n.mainMatrix,u}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class wr{get useGlobeControls(){return!0}handlePanInertia(e,n){let u=nl(e,n);return Math.abs(u.lng-n.center.lng)>180&&(u.lng=n.center.lng+179.5*Math.sign(u.lng-n.center.lng)),{easingCenter:u,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){let u=e.around,p=n.screenPointToLocation(u);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);let g=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);let v=n.zoom-g;if(v===0)return;let x=s.bq(n.center.lng,p.lng),C=x/(Math.abs(x/180)+1),I=s.bq(n.center.lat,p.lat),k=n.getRayDirectionFromPixel(u),R=n.cameraPosition,D=-1*s.aV(R,k),N=s.bh();s.aP(N,R,[k[0]*D,k[1]*D,k[2]*D]);let j=s.bo(N)-1,ee=Math.exp(.5*-Math.max(j-.3,0)),J=Oo(n.worldSize,n.center.lat)/Math.min(n.width,n.height),te=s.bf(J,.9,.5,1,.25),re=(1-s.ac(-v))*Math.min(ee,te),de=n.center.lat,ce=n.zoom,ue=new s.Q(n.center.lng+C*re,s.ae(n.center.lat+I*re,-85.051129,s.af));n.setLocationAtPoint(p,u);let ge=n.center,he=s.bf(Math.abs(x),45,85,0,1),Se=s.bf(J,.75,.35,0,1),Le=Math.pow(Math.max(he,Se),.25),ke=s.bq(ge.lng,ue.lng),Ae=s.bq(ge.lat,ue.lat);n.setCenter(new s.Q(ge.lng+ke*Le,ge.lat+Ae*Le).wrap()),n.setZoom(ce+fn(de,n.center.lat))}handleMapControlsPan(e,n,u){if(!e.panDelta)return;let p=n.center.lat,g=n.zoom;n.setCenter(nl(e.panDelta,n).wrap()),n.setZoom(g+fn(p,n.center.lat))}cameraForBoxAndBearing(e,n,u,p,g){let v=er(e,n,u,p,g),x=n.left/g.width*2-1,C=(g.width-n.right)/g.width*2-1,I=n.top/g.height*-2+1,k=(g.height-n.bottom)/g.height*-2+1,R=s.bq(u.getWest(),u.getEast())<0,D=R?u.getEast():u.getWest(),N=R?u.getWest():u.getEast(),j=Math.max(u.getNorth(),u.getSouth()),ee=Math.min(u.getNorth(),u.getSouth()),J=D+.5*s.bq(D,N),te=j+.5*s.bq(j,ee),re=g.clone();re.setCenter(v.center),re.setBearing(v.bearing),re.setPitch(0),re.setRoll(0),re.setZoom(v.zoom);let de=re.modelViewProjectionMatrix,ce=[pn(u.getNorthWest()),pn(u.getNorthEast()),pn(u.getSouthWest()),pn(u.getSouthEast()),pn(new s.Q(N,te)),pn(new s.Q(D,te)),pn(new s.Q(J,j)),pn(new s.Q(J,ee))],ue=pn(v.center),ge=Number.POSITIVE_INFINITY;for(let he of ce)x<0&&(ge=wr.getLesserNonNegativeNonNull(ge,wr.solveVectorScale(he,ue,de,"x",x))),C>0&&(ge=wr.getLesserNonNegativeNonNull(ge,wr.solveVectorScale(he,ue,de,"x",C))),I>0&&(ge=wr.getLesserNonNegativeNonNull(ge,wr.solveVectorScale(he,ue,de,"y",I))),k<0&&(ge=wr.getLesserNonNegativeNonNull(ge,wr.solveVectorScale(he,ue,de,"y",k)));if(Number.isFinite(ge)&&ge!==0)return v.zoom=re.zoom+s.ah(ge),v;Zn()}handleJumpToCenterZoom(e,n){let u=e.center.lat,p=e.getConstrained(n.center?s.Q.convert(n.center):e.center,e.zoom).center;e.setCenter(p.wrap());let g=n.zoom!==void 0?+n.zoom:e.zoom+fn(u,p.lat);e.zoom!==g&&e.setZoom(g)}handleEaseTo(e,n){let u=e.zoom,p=e.center,g=e.padding,v={roll:e.roll,pitch:e.pitch,bearing:e.bearing},x={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},C=n.zoom!==void 0,I=!e.isPaddingEqual(n.padding),k=!1,R=n.center?s.Q.convert(n.center):p,D=e.getConstrained(R,u).center;Ar(e,D);let N=e.clone();N.setCenter(D),N.setZoom(C?+n.zoom:u+fn(p.lat,R.lat)),N.setBearing(n.bearing);let j=new s.P(s.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),s.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));N.setLocationAtPoint(D,j);let ee=(n.offset&&n.offsetAsPoint.mag())>0?N.center:D,J=C?+n.zoom:u+fn(p.lat,ee.lat),te=u+fn(p.lat,0),re=J+fn(ee.lat,0),de=s.bq(p.lng,ee.lng),ce=s.bq(p.lat,ee.lat),ue=s.ac(re-te);return k=J!==u,{easeFunc:ge=>{if(s.b6(v,x)||ur({startEulerAngles:v,endEulerAngles:x,tr:e,k:ge,useSlerp:v.roll!=x.roll}),I&&e.interpolatePadding(g,n.padding,ge),n.around)s.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{let he=re>te?Math.min(2,ue):Math.max(.5,ue),Se=Math.pow(he,1-ge),Le=ns(p,de,ce,ge*Se);e.setCenter(Le.wrap())}if(k){let he=s.B.number(te,re,ge)+fn(0,e.center.lat);e.setZoom(he)}},isZooming:k,elevationCenter:ee}}handleFlyTo(e,n){let u=n.zoom!==void 0,p=e.center,g=e.zoom,v=e.padding,x=!e.isPaddingEqual(n.padding),C=e.getConstrained(s.Q.convert(n.center||n.locationAtOffset),g).center,I=u?+n.zoom:e.zoom+fn(e.center.lat,C.lat),k=e.clone();k.setCenter(C),k.setZoom(I),k.setBearing(n.bearing);let R=new s.P(s.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),s.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(C,R);let D=k.center;Ar(e,D);let N=function(ce,ue,ge){let he=pn(ue),Se=pn(ge),Le=s.aV(he,Se),ke=Math.acos(Le),Ae=ma(ce);return ke/(2*Math.PI)*Ae}(e,p,D),j=g+fn(p.lat,0),ee=I+fn(D.lat,0),J=s.ac(ee-j),te;if(typeof n.minZoom=="number"){let ce=+n.minZoom+fn(D.lat,0),ue=Math.min(ce,j,ee)+fn(0,D.lat),ge=e.getConstrained(D,ue).zoom+fn(D.lat,0);te=s.ac(ge-j)}let re=s.bq(p.lng,D.lng),de=s.bq(p.lat,D.lat);return{easeFunc:(ce,ue,ge,he)=>{let Se=ns(p,re,de,ge);x&&e.interpolatePadding(v,n.padding,ce);let Le=ce===1?D:Se;e.setCenter(Le.wrap());let ke=j+s.ah(ue);e.setZoom(ce===1?I:ke+fn(0,Le.lat))},scaleOfZoom:J,targetCenter:D,scaleOfMinZoom:te,pixelPathLength:N}}static solveVectorScale(e,n,u,p,g){let v=p==="x"?[u[0],u[4],u[8],u[12]]:[u[1],u[5],u[9],u[13]],x=[u[3],u[7],u[11],u[15]],C=e[0]*v[0]+e[1]*v[1]+e[2]*v[2],I=e[0]*x[0]+e[1]*x[1]+e[2]*x[2],k=n[0]*v[0]+n[1]*v[1]+n[2]*v[2],R=n[0]*x[0]+n[1]*x[1]+n[2]*x[2];return k+g*I===C+g*R||x[3]*(C-k)+v[3]*(R-I)+C*R==k*I?null:(k+v[3]-g*R-g*x[3])/(k-C-g*R+g*I)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class os{constructor(e){this._globe=e,this._mercatorCameraHelper=new ua,this._verticalPerspectiveCameraHelper=new wr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,u){this.currentHelper.handleMapControlsPan(e,n,u)}cameraForBoxAndBearing(e,n,u,p,g){return this.currentHelper.cameraForBoxAndBearing(e,n,u,p,g)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}let rl=(m,e)=>s.x(m,e&&e.filter(n=>n.identifier!=="source.canvas")),Ru=s.bw();class Rs extends s.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(let u in this.sourceCaches){let p=this.sourceCaches[u].getSource().type;p!=="vector"&&p!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new wn(ar(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,p)=>this.getGlyphs(u,p)),this.dispatcher.registerMessageHandler("GI",(u,p)=>this.getImages(u,p)),this.imageManager=new Ms,this.imageManager.setEventedParent(this),this.glyphManager=new Tt(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new vr(256,512),this.crossTileSymbolIndex=new la,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",s.by()),Ai().on(cr,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;let p=this.sourceCaches[u.sourceId];if(!p)return;let g=p.getSource();if(g&&g.vectorLayerIds)for(let v in this._layers){let x=this._layers[v];x.source===g.id&&this._validateLayer(x)}})}loadURL(e,n={},u){this.fire(new s.l("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;let p=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;let g=this._loadStyleRequest;s.j(p,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,n,u)}).catch(v=>{this._loadStyleRequest=null,v&&!g.signal.aborted&&this.fire(new s.k(v))})}loadJSON(e,n={},u){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,be.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,u)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(Ru,{validate:!1})}_load(e,n,u){var p,g;let v=n.transformStyle?n.transformStyle(u,e):e;if(!n.validate||!rl(this,s.y(v))){this._loaded=!0,this.stylesheet=v;for(let x in v.sources)this.addSource(x,v.sources[x],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Ts(this.stylesheet.light),this._setProjectionInternal(((p=this.stylesheet.projection)===null||p===void 0?void 0:p.type)||"mercator"),this.sky=new ro(this.stylesheet.sky),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){let e=s.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(let n of e){let u=s.bA(n);u.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=u}}_loadSprite(e,n=!1,u=void 0){let p;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(g,v,x,C){return s._(this,void 0,void 0,function*(){let I=mi(g),k=x>1?"@2x":"",R={},D={};for(let{id:N,url:j}of I){let ee=v.transformRequest(Yi(j,k,".json"),"SpriteJSON");R[N]=s.j(ee,C);let J=v.transformRequest(Yi(j,k,".png"),"SpriteImage");D[N]=bi.getImage(J,C)}return yield Promise.all([...Object.values(R),...Object.values(D)]),function(N,j){return s._(this,void 0,void 0,function*(){let ee={};for(let J in N){ee[J]={};let te=be.getImageCanvasContext((yield j[J]).data),re=(yield N[J]).data;for(let de in re){let{width:ce,height:ue,x:ge,y:he,sdf:Se,pixelRatio:Le,stretchX:ke,stretchY:Ae,content:Re,textFitWidth:Ke,textFitHeight:Xe}=re[de];ee[J][de]={data:null,pixelRatio:Le,sdf:Se,stretchX:ke,stretchY:Ae,content:Re,textFitWidth:Ke,textFitHeight:Xe,spriteData:{width:ce,height:ue,x:ge,y:he,context:te}}}}return ee})}(R,D)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(g=>{if(this._spriteRequest=null,g)for(let v in g){this._spritesImagesIds[v]=[];let x=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter(C=>!(C in g)):[];for(let C of x)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(let C in g[v]){let I=v==="default"?C:`${v}:${C}`;this._spritesImagesIds[v].push(I),I in this.imageManager.images?this.imageManager.updateImage(I,g[v][C],!1):this.imageManager.addImage(I,g[v][C]),n&&(this._changedImages[I]=!0)}}}).catch(g=>{this._spriteRequest=null,p=g,this.fire(new s.k(p))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),u&&u(p)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(e){let n=this.sourceCaches[e.source];if(!n)return;let u=e.sourceLayer;if(!u)return;let p=n.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(u)===-1)&&this.fire(new s.k(new Error(`Source layer "${u}" does not exist on source "${p.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){let u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?s.bB(u):u);let p=[];for(let g of e)if(u[g]){let v=n?s.bB(u[g]):u[g];p.push(v)}return p}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let n=Object.keys(this._layers);for(let u of n){let p=this._layers[u];p.type!=="custom"&&(e[u]=p.serialize())}return e}hasTransitions(){var e,n,u;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((u=this.projection)===null||u===void 0)&&u.hasTransition())return!0;for(let p in this.sourceCaches)if(this.sourceCaches[p].hasTransition())return!0;for(let p in this._layers)if(this._layers[p].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let n=this._changed;if(n){let p=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(p.length||g.length)&&this._updateWorkerLayers(p,g);for(let v in this._updatedSources){let x=this._updatedSources[v];if(x==="reload")this._reloadSource(v);else{if(x!=="clear")throw new Error(`Invalid action ${x}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let v in this._updatedPaintProps)this._layers[v].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}let u={};for(let p in this.sourceCaches){let g=this.sourceCaches[p];u[p]=g.used,g.used=!1}for(let p of this._order){let g=this._layers[p];g.recalculate(e,this._availableImages),!g.isHidden(e.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(let p in u){let g=this.sourceCaches[p];!!u[p]!=!!g.used&&g.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var u;this._checkLoaded();let p=this.serialize();if(e=n.transformStyle?n.transformStyle(p,e):e,((u=n.validate)===null||u===void 0||u)&&rl(this,s.y(e)))return!1;(e=s.bB(e)).layers=s.bz(e.layers);let g=s.bC(p,e),v=this._getOperationsToPerform(g);if(v.unimplemented.length>0)throw new Error(`Unimplemented: ${v.unimplemented.join(", ")}.`);if(v.operations.length===0)return!1;for(let x of v.operations)x();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let n=[],u=[];for(let p of e)switch(p.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,p.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,p.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,p.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,p.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,p.args));break;case"addSource":n.push(()=>this.addSource.apply(this,p.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,p.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,p.args));break;case"setLight":n.push(()=>this.setLight.apply(this,p.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,p.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,p.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,p.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,p.args));break;case"setSky":n.push(()=>this.setSky.apply(this,p.args));break;case"setProjection":this.setProjection.apply(this,p.args);break;case"setTransition":n.push(()=>{});break;default:u.push(p.command)}return{operations:n,unimplemented:u}}addImage(e,n){if(this.getImage(e))return this.fire(new s.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new s.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(s.y.source,`sources.${e}`,n,null,u))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);let p=this.sourceCaches[e]=new we(e,n,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:e})),p.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let u in this._layers)if(this._layers[u].source===e)return this.fire(new s.k(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));let n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);let u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,u={}){this._checkLoaded();let p=e.id;if(this.getLayer(p))return void this.fire(new s.k(new Error(`Layer "${p}" already exists on this map.`)));let g;if(e.type==="custom"){if(rl(this,s.bD(e)))return;g=s.bA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(p,e.source),e=s.bB(e),e=s.e(e,{source:p})),this._validate(s.y.layer,`layers.${p}`,e,{arrayIndex:-1},u))return;g=s.bA(e),this._validateLayer(g),g.setEventedParent(this,{layer:{id:p}})}let v=n?this._order.indexOf(n):this._order.length;if(n&&v===-1)this.fire(new s.k(new Error(`Cannot add layer "${p}" before non-existing layer "${n}".`)));else{if(this._order.splice(v,0,p),this._layerOrderChanged=!0,this._layers[p]=g,this._removedLayers[p]&&g.source&&g.type!=="custom"){let x=this._removedLayers[p];delete this._removedLayers[p],x.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new s.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;let u=this._order.indexOf(e);this._order.splice(u,1);let p=n?this._order.indexOf(n):this._order.length;n&&p===-1?this.fire(new s.k(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(p,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();let n=this._layers[e];if(!n)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);let u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,u){this._checkLoaded();let p=this.getLayer(e);p?p.minzoom===n&&p.maxzoom===u||(n!=null&&(p.minzoom=n),u!=null&&(p.maxzoom=u),this._updateLayer(p)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,u={}){this._checkLoaded();let p=this.getLayer(e);if(p){if(!s.bE(p.filter,n))return n==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(s.y.filter,`layers.${p.id}.filter`,n,null,u)||(p.filter=s.bB(n),this._updateLayer(p)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return s.bB(this.getLayer(e).filter)}setLayoutProperty(e,n,u,p={}){this._checkLoaded();let g=this.getLayer(e);g?s.bE(g.getLayoutProperty(n),u)||(g.setLayoutProperty(n,u,p),this._updateLayer(g)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){let u=this.getLayer(e);if(u)return u.getLayoutProperty(n);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,u,p={}){this._checkLoaded();let g=this.getLayer(e);g?s.bE(g.getPaintProperty(n),u)||(g.setPaintProperty(n,u,p)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new s.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();let u=e.source,p=e.sourceLayer,g=this.sourceCaches[u];if(g===void 0)return void this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)));let v=g.getSource().type;v==="geojson"&&p?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||p?(e.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),g.setFeatureState(p,e.id,n)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();let u=e.source,p=this.sourceCaches[u];if(p===void 0)return void this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)));let g=p.getSource().type,v=g==="vector"?e.sourceLayer:void 0;g!=="vector"||v?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(v,e.id,n):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();let n=e.source,u=e.sourceLayer,p=this.sourceCaches[n];if(p!==void 0)return p.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),p.getFeatureState(u,e.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=s.bF(this.sourceCaches,g=>g.serialize()),n=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,p=this.stylesheet;return s.bG({version:p.version,name:p.name,metadata:p.metadata,light:p.light,sky:p.sky,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,projection:p.projection,sources:e,layers:n,terrain:u},g=>g!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let n=v=>this._layers[v].type==="fill-extrusion",u={},p=[];for(let v=this._order.length-1;v>=0;v--){let x=this._order[v];if(n(x)){u[x]=v;for(let C of e){let I=C[x];if(I)for(let k of I)p.push(k)}}}p.sort((v,x)=>x.intersectionZ-v.intersectionZ);let g=[];for(let v=this._order.length-1;v>=0;v--){let x=this._order[v];if(n(x))for(let C=p.length-1;C>=0;C--){let I=p[C].feature;if(u[I.layer.id]<v)break;g.push(I),p.pop()}else for(let C of e){let I=C[x];if(I)for(let k of I)g.push(k.feature)}}return g}queryRenderedFeatures(e,n,u){n&&n.filter&&this._validate(s.y.filter,"queryRenderedFeatures.filter",n.filter,null,n);let p={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(let I of n.layers){let k=this._layers[I];if(!k)return this.fire(new s.k(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];p[k.source]=!0}}let g=[];n.availableImages=this._availableImages;let v=this._serializedAllLayers(),x=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,C=Object.assign(Object.assign({},n),{layers:x});for(let I in this.sourceCaches)n.layers&&!p[I]||g.push(Ko(this.sourceCaches[I],this._layers,v,e,C,u,this.map.terrain?(k,R,D)=>this.map.terrain.getElevation(k,R,D):void 0));return this.placement&&g.push(function(I,k,R,D,N,j,ee){let J={},te=j.queryRenderedSymbols(D),re=[];for(let de of Object.keys(te).map(Number))re.push(ee[de]);re.sort(lr);for(let de of re){let ce=de.featureIndex.lookupSymbolFeatures(te[de.bucketInstanceId],k,de.bucketIndex,de.sourceLayerIndex,N.filter,N.layers,N.availableImages,I);for(let ue in ce){let ge=J[ue]=J[ue]||[],he=ce[ue];he.sort((Se,Le)=>{let ke=de.featureSortOrder;if(ke){let Ae=ke.indexOf(Se.featureIndex);return ke.indexOf(Le.featureIndex)-Ae}return Le.featureIndex-Se.featureIndex});for(let Se of he)ge.push(Se)}}return function(de,ce,ue){for(let ge in de)for(let he of de[ge])$n(he,ue[ce[ge].source]);return de}(J,I,R)}(this._layers,v,this.sourceCaches,e,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(e,n){n&&n.filter&&this._validate(s.y.filter,"querySourceFeatures.filter",n.filter,null,n);let u=this.sourceCaches[e];return u?function(p,g){let v=p.getRenderableIds().map(I=>p.getTileByID(I)),x=[],C={};for(let I=0;I<v.length;I++){let k=v[I],R=k.tileID.canonical.key;C[R]||(C[R]=!0,k.querySourceFeatures(x,g))}return x}(u,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();let u=this.light.getLight(),p=!1;for(let v in e)if(!s.bE(e[v],u[v])){p=!0;break}if(!p)return;let g={now:be.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(g)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();let u=this.getSky(),p=!1;if(!e&&!u)return;if(e&&!u)p=!0;else if(!e&&u)p=!0;else for(let v in e)if(!s.bE(e[v],u[v])){p=!0;break}if(!p)return;let g={now:be.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(g)}_setProjectionInternal(e){let n=function(u){if(Array.isArray(u)){let p=new fa({type:u});return{projection:p,transform:new ya,cameraHelper:new os(p)}}switch(u){case"mercator":return{projection:new ca,transform:new As,cameraHelper:new ua};case"globe":{let p=new fa({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:p,transform:new ya,cameraHelper:new os(p)}}case"vertical-perspective":return{projection:new pa,transform:new rs,cameraHelper:new wr};default:return s.w(`Unknown projection name: ${u}. Falling back to mercator projection.`),{projection:new ca,transform:new As,cameraHelper:new ua}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(let u in this.sourceCaches)this.sourceCaches[u].reload()}_validate(e,n,u,p,g={}){return(!g||g.validate!==!1)&&rl(this,e.call(s.y,s.e({key:n,style:this.serialize(),value:u,styleSpec:s.v},p)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ai().off(cr,this._rtlPluginLoaded);for(let n in this._layers)this._layers[n].setEventedParent(null);for(let n in this.sourceCaches){let u=this.sourceCaches[n];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,u,p,g=!1){let v=!1,x=!1,C={};for(let I of this._order){let k=this._layers[I];if(k.type!=="symbol")continue;if(!C[k.source]){let D=this.sourceCaches[k.source];C[k.source]=D.getRenderableIds(!0).map(N=>D.getTileByID(N)).sort((N,j)=>j.tileID.overscaledZ-N.tileID.overscaledZ||(N.tileID.isLessThan(j.tileID)?-1:1))}let R=this.crossTileSymbolIndex.addLayer(k,C[k.source],e.center.lng);v=v||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(be.now(),e.zoom))&&(this.pauseablePlacement=new sa(e,this.map.terrain,this._order,g,n,u,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(be.now()),x=!0),v&&this.pauseablePlacement.placement.setStale()),x||v)for(let I of this._order){let k=this._layers[I];k.type==="symbol"&&this.placement.updateLayerOpacities(k,C[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(be.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return s._(this,void 0,void 0,function*(){let u=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();let p=this.sourceCaches[n.source];return p&&p.setDependencies(n.tileID.key,n.type,n.icons),u})}getGlyphs(e,n){return s._(this,void 0,void 0,function*(){let u=yield this.glyphManager.getGlyphs(n.stacks),p=this.sourceCaches[n.source];return p&&p.setDependencies(n.tileID.key,n.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(s.y.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,u={},p){this._checkLoaded();let g=[{id:e,url:n}],v=[...mi(this.stylesheet.sprite),...g];this._validate(s.y.sprite,"sprite",v,null,u)||(this.stylesheet.sprite=v,this._loadSprite(g,!0,p))}removeSprite(e){this._checkLoaded();let n=mi(this.stylesheet.sprite);if(n.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(let u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;n.splice(n.findIndex(u=>u.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return mi(this.stylesheet.sprite)}setSprite(e,n={},u){this._checkLoaded(),e&&this._validate(s.y.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var fd=s.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ou{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,u,p,g,v,x,C,I){this.context=e;let k=this.boundPaintVertexBuffers.length!==p.length;for(let R=0;!k&&R<p.length;R++)this.boundPaintVertexBuffers[R]!==p[R]&&(k=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==u||k||this.boundIndexBuffer!==g||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==x||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==I?this.freshBind(n,u,p,g,v,x,C,I):(e.bindVertexArray.set(this.vao),x&&x.bind(),g&&g.dynamicDraw&&g.bind(),C&&C.bind(),I&&I.bind())}freshBind(e,n,u,p,g,v,x,C){let I=e.numAttributes,k=this.context,R=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=p,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=x,this.boundDynamicVertexBuffer3=C,n.enableAttributes(R,e);for(let D of u)D.enableAttributes(R,e);v&&v.enableAttributes(R,e),x&&x.enableAttributes(R,e),C&&C.enableAttributes(R,e),n.bind(),n.setVertexAttribPointers(R,e,g);for(let D of u)D.bind(),D.setVertexAttribPointers(R,e,g);v&&(v.bind(),v.setVertexAttribPointers(R,e,g)),p&&p.bind(),x&&(x.bind(),x.setVertexAttribPointers(R,e,g)),C&&(C.bind(),C.setVertexAttribPointers(R,e,g)),k.currentNumAttributes=I}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let Fu=(m,e,n,u,p)=>({u_texture:0,u_ele_delta:m,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):s.b7.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:p?0:n?n.calculateFogBlendOpacity(u):0,u_horizon_color:n?n.properties.get("horizon-color"):s.b7.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:p?1:0}),ol={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ss(m){let e=[];for(let n=0;n<m.length;n++){if(m[n]===null)continue;let u=m[n].split(" ");e.push(u.pop())}return e}class sl{constructor(e,n,u,p,g,v,x,C,I=[]){let k=e.gl;this.program=k.createProgram();let R=ss(n.staticAttributes),D=u?u.getBinderAttributes():[],N=R.concat(D),j=Gn.prelude.staticUniforms?ss(Gn.prelude.staticUniforms):[],ee=x.staticUniforms?ss(x.staticUniforms):[],J=n.staticUniforms?ss(n.staticUniforms):[],te=u?u.getBinderUniforms():[],re=j.concat(ee).concat(J).concat(te),de=[];for(let ke of re)de.indexOf(ke)<0&&de.push(ke);let ce=u?u.defines():[];Fn(k)&&ce.unshift("#version 300 es"),g&&ce.push("#define OVERDRAW_INSPECTOR;"),v&&ce.push("#define TERRAIN3D;"),C&&ce.push(C),I&&ce.push(...I);let ue=ce.concat(Gn.prelude.fragmentSource,x.fragmentSource,n.fragmentSource).join(`
`),ge=ce.concat(Gn.prelude.vertexSource,x.vertexSource,n.vertexSource).join(`
`);Fn(k)||(ue=function(ke){return ke.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ue),ge=function(ke){return ke.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ge));let he=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(he,ue),k.compileShader(he),!k.getShaderParameter(he,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(he)}`);k.attachShader(this.program,he);let Se=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(Se,ge),k.compileShader(Se),!k.getShaderParameter(Se,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(Se)}`);k.attachShader(this.program,Se),this.attributes={};let Le={};this.numAttributes=N.length;for(let ke=0;ke<this.numAttributes;ke++)N[ke]&&(k.bindAttribLocation(this.program,ke,N[ke]),this.attributes[N[ke]]=ke);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(Se),k.deleteShader(he);for(let ke=0;ke<de.length;ke++){let Ae=de[ke];if(Ae&&!Le[Ae]){let Re=k.getUniformLocation(this.program,Ae);Re&&(Le[Ae]=Re)}}this.fixedUniforms=p(e,Le),this.terrainUniforms=((ke,Ae)=>({u_depth:new s.bH(ke,Ae.u_depth),u_terrain:new s.bH(ke,Ae.u_terrain),u_terrain_dim:new s.b8(ke,Ae.u_terrain_dim),u_terrain_matrix:new s.bJ(ke,Ae.u_terrain_matrix),u_terrain_unpack:new s.bK(ke,Ae.u_terrain_unpack),u_terrain_exaggeration:new s.b8(ke,Ae.u_terrain_exaggeration)}))(e,Le),this.projectionUniforms=((ke,Ae)=>({u_projection_matrix:new s.bJ(ke,Ae.u_projection_matrix),u_projection_tile_mercator_coords:new s.bK(ke,Ae.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bK(ke,Ae.u_projection_clipping_plane),u_projection_transition:new s.b8(ke,Ae.u_projection_transition),u_projection_fallback_matrix:new s.bJ(ke,Ae.u_projection_fallback_matrix)}))(e,Le),this.binderUniforms=u?u.getUniforms(e,Le):[]}draw(e,n,u,p,g,v,x,C,I,k,R,D,N,j,ee,J,te,re,de){let ce=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(p),e.setColorMode(g),e.setCullFace(v),C){e.activeTexture.set(ce.TEXTURE2),ce.bindTexture(ce.TEXTURE_2D,C.depthTexture),e.activeTexture.set(ce.TEXTURE3),ce.bindTexture(ce.TEXTURE_2D,C.texture);for(let ge in this.terrainUniforms)this.terrainUniforms[ge].set(C[ge])}if(I)for(let ge in I)this.projectionUniforms[ol[ge]].set(I[ge]);if(x)for(let ge in this.fixedUniforms)this.fixedUniforms[ge].set(x[ge]);J&&J.setUniforms(e,this.binderUniforms,j,{zoom:ee});let ue=0;switch(n){case ce.LINES:ue=2;break;case ce.TRIANGLES:ue=3;break;case ce.LINE_STRIP:ue=1}for(let ge of N.get()){let he=ge.vaos||(ge.vaos={});(he[k]||(he[k]=new Ou)).bind(e,this,R,J?J.getPaintVertexBuffers():[],D,ge.vertexOffset,te,re,de),ce.drawElements(n,ge.primitiveLength*ue,ce.UNSIGNED_SHORT,ge.primitiveOffset*ue*2)}}}function Os(m,e,n){let u=1/s.az(n,1,e.transform.tileZoom),p=Math.pow(2,n.tileID.overscaledZ),g=n.tileSize*Math.pow(2,e.transform.tileZoom)/p,v=g*(n.tileID.canonical.x+n.tileID.wrap*p),x=g*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[u,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[v>>16,x>>16],u_pixel_coord_lower:[65535&v,65535&x]}}let va=(m,e,n,u)=>{let p=m.style.light,g=p.properties.get("position"),v=[g.x,g.y,g.z],x=s.bN();p.properties.get("anchor")==="viewport"&&s.bO(x,m.transform.bearingInRadians),s.bP(v,v,x);let C=m.transform.transformLightDirection(v),I=p.properties.get("color");return{u_lightpos:v,u_lightpos_globe:C,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:u}},Rr=(m,e,n,u,p,g,v)=>s.e(va(m,e,n,u),Os(g,m,v),{u_height_factor:-Math.pow(2,p.overscaledZ)/v.tileSize/8}),al=(m,e,n,u)=>s.e(Os(e,m,n),{u_fill_translate:u}),Fs=(m,e)=>({u_world:m,u_fill_translate:e}),ba=(m,e,n,u,p)=>s.e(al(m,e,n,p),{u_world:u}),Ls=(m,e,n,u,p)=>{let g=m.transform,v,x,C=0;if(n.paint.get("circle-pitch-alignment")==="map"){let I=s.az(e,1,g.zoom);v=!0,x=[I,I],C=I/(s.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*p}else v=!1,x=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+v,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:x,u_globe_extrude_scale:C,u_translate:u}},md=m=>({u_pixel_extrude_scale:[1/m.width,1/m.height]}),xa=m=>({u_viewport_size:[m.width,m.height]}),fc=(m,e=1)=>({u_color:m,u_overlay:0,u_overlay_scale:e}),Lo=(m,e,n,u)=>{let p=s.az(m,1,e)/(s.Z*Math.pow(2,m.tileID.overscaledZ))*2*Math.PI*u;return{u_extrude_scale:s.az(m,1,e),u_intensity:n,u_globe_extrude_scale:p}},mc=(m,e,n,u)=>{let p=s.K();s.bQ(p,0,m.width,m.height,0,0,1);let g=m.context.gl;return{u_matrix:p,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:n,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}},gc=(m,e,n)=>{let u=n.paint.get("hillshade-accent-color"),p;switch(n.paint.get("hillshade-method")){case"basic":p=4;break;case"combined":p=1;break;case"igor":p=2;break;case"multidirectional":p=3;break;default:p=0}let g=n.getIlluminationProperties();for(let v=0;v<g.directionRadians.length;v++)n.paint.get("hillshade-illumination-anchor")==="viewport"&&(g.directionRadians[v]+=m.transform.bearingInRadians);return{u_image:0,u_latrange:_c(0,e.tileID),u_exaggeration:n.paint.get("hillshade-exaggeration"),u_altitudes:g.altitudeRadians,u_azimuths:g.directionRadians,u_accent:u,u_method:p,u_highlights:g.highlightColor,u_shadows:g.shadowColor}},gd=(m,e)=>{let n=e.stride,u=s.K();return s.bQ(u,0,s.Z,-8192,0,0,1),s.L(u,u,[0,-8192,0]),{u_matrix:u,u_image:1,u_dimension:[n,n],u_zoom:m.overscaledZ,u_unpack:e.getUnpackVector()}};function _c(m,e){let n=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new s.$(0,u/n).toLngLat().lat,new s.$(0,(u+1)/n).toLngLat().lat]}let Yr=(m,e,n,u)=>{let p=m.transform;return{u_translation:uo(m,e,n),u_ratio:u/s.az(e,1,p.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},_d=(m,e,n,u,p)=>s.e(Yr(m,e,n,u),{u_image:0,u_image_height:p}),yd=(m,e,n,u,p)=>{let g=m.transform,v=ll(e,g);return{u_translation:uo(m,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:u/s.az(e,1,g.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[v,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},vd=(m,e,n,u,p,g)=>{let v=m.lineAtlas,x=ll(e,m.transform),C=n.layout.get("line-cap")==="round",I=v.getDash(p.from,C),k=v.getDash(p.to,C),R=I.width*g.fromScale,D=k.width*g.toScale;return s.e(Yr(m,e,n,u),{u_patternscale_a:[x/R,-I.height/2],u_patternscale_b:[x/D,-k.height/2],u_sdfgamma:v.width/(256*Math.min(R,D)*m.pixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:k.y,u_mix:g.t})};function ll(m,e){return 1/s.az(m,1,e.tileZoom)}function uo(m,e,n){return s.aA(m.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}let yc=(m,e,n,u,p)=>{return{u_tl_parent:m,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(v=u.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(g=u.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:bd(u.paint.get("raster-hue-rotate")),u_coords_top:[p[0].x,p[0].y,p[1].x,p[1].y],u_coords_bottom:[p[3].x,p[3].y,p[2].x,p[2].y]};var g,v};function bd(m){m*=Math.PI/180;let e=Math.sin(m),n=Math.cos(m);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}let zs=(m,e,n,u,p,g,v,x,C,I,k,R,D)=>{let N=v.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:N.cameraToCenterDistance,u_pitch:N.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:N.width/N.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_label_plane_matrix:x,u_coord_matrix:C,u_is_text:+k,u_pitch_with_map:+u,u_is_along_line:p,u_is_variable_anchor:g,u_texsize:R,u_texture:0,u_translation:I,u_pitched_scale:D}},xd=(m,e,n,u,p,g,v,x,C,I,k,R,D,N)=>{let j=v.transform;return s.e(zs(m,e,n,u,p,g,v,x,C,I,k,R,N),{u_gamma_scale:u?Math.cos(j.pitch*Math.PI/180)*j.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:1})},wa=(m,e,n,u,p,g,v,x,C,I,k,R,D)=>s.e(xd(m,e,n,u,p,g,v,x,C,I,!0,k,0,D),{u_texsize_icon:R,u_texture_icon:1}),wd=(m,e)=>({u_opacity:m,u_color:e}),Lu=(m,e,n,u,p)=>s.e(function(g,v,x,C){let I=x.imageManager.getPattern(g.from.toString()),k=x.imageManager.getPattern(g.to.toString()),{width:R,height:D}=x.imageManager.getPixelSize(),N=Math.pow(2,C.tileID.overscaledZ),j=C.tileSize*Math.pow(2,x.transform.tileZoom)/N,ee=j*(C.tileID.canonical.x+C.tileID.wrap*N),J=j*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[R,D],u_mix:v.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/s.az(C,1,x.transform.tileZoom),u_pixel_coord_upper:[ee>>16,J>>16],u_pixel_coord_lower:[65535&ee,65535&J]}}(n,p,e,u),{u_opacity:m}),cl=(m,e)=>{},Cd={fillExtrusion:(m,e)=>({u_lightpos:new s.bL(m,e.u_lightpos),u_lightpos_globe:new s.bL(m,e.u_lightpos_globe),u_lightintensity:new s.b8(m,e.u_lightintensity),u_lightcolor:new s.bL(m,e.u_lightcolor),u_vertical_gradient:new s.b8(m,e.u_vertical_gradient),u_opacity:new s.b8(m,e.u_opacity),u_fill_translate:new s.bM(m,e.u_fill_translate)}),fillExtrusionPattern:(m,e)=>({u_lightpos:new s.bL(m,e.u_lightpos),u_lightpos_globe:new s.bL(m,e.u_lightpos_globe),u_lightintensity:new s.b8(m,e.u_lightintensity),u_lightcolor:new s.bL(m,e.u_lightcolor),u_vertical_gradient:new s.b8(m,e.u_vertical_gradient),u_height_factor:new s.b8(m,e.u_height_factor),u_opacity:new s.b8(m,e.u_opacity),u_fill_translate:new s.bM(m,e.u_fill_translate),u_image:new s.bH(m,e.u_image),u_texsize:new s.bM(m,e.u_texsize),u_pixel_coord_upper:new s.bM(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(m,e.u_pixel_coord_lower),u_scale:new s.bL(m,e.u_scale),u_fade:new s.b8(m,e.u_fade)}),fill:(m,e)=>({u_fill_translate:new s.bM(m,e.u_fill_translate)}),fillPattern:(m,e)=>({u_image:new s.bH(m,e.u_image),u_texsize:new s.bM(m,e.u_texsize),u_pixel_coord_upper:new s.bM(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(m,e.u_pixel_coord_lower),u_scale:new s.bL(m,e.u_scale),u_fade:new s.b8(m,e.u_fade),u_fill_translate:new s.bM(m,e.u_fill_translate)}),fillOutline:(m,e)=>({u_world:new s.bM(m,e.u_world),u_fill_translate:new s.bM(m,e.u_fill_translate)}),fillOutlinePattern:(m,e)=>({u_world:new s.bM(m,e.u_world),u_image:new s.bH(m,e.u_image),u_texsize:new s.bM(m,e.u_texsize),u_pixel_coord_upper:new s.bM(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(m,e.u_pixel_coord_lower),u_scale:new s.bL(m,e.u_scale),u_fade:new s.b8(m,e.u_fade),u_fill_translate:new s.bM(m,e.u_fill_translate)}),circle:(m,e)=>({u_camera_to_center_distance:new s.b8(m,e.u_camera_to_center_distance),u_scale_with_map:new s.bH(m,e.u_scale_with_map),u_pitch_with_map:new s.bH(m,e.u_pitch_with_map),u_extrude_scale:new s.bM(m,e.u_extrude_scale),u_device_pixel_ratio:new s.b8(m,e.u_device_pixel_ratio),u_globe_extrude_scale:new s.b8(m,e.u_globe_extrude_scale),u_translate:new s.bM(m,e.u_translate)}),collisionBox:(m,e)=>({u_pixel_extrude_scale:new s.bM(m,e.u_pixel_extrude_scale)}),collisionCircle:(m,e)=>({u_viewport_size:new s.bM(m,e.u_viewport_size)}),debug:(m,e)=>({u_color:new s.bI(m,e.u_color),u_overlay:new s.bH(m,e.u_overlay),u_overlay_scale:new s.b8(m,e.u_overlay_scale)}),depth:cl,clippingMask:cl,heatmap:(m,e)=>({u_extrude_scale:new s.b8(m,e.u_extrude_scale),u_intensity:new s.b8(m,e.u_intensity),u_globe_extrude_scale:new s.b8(m,e.u_globe_extrude_scale)}),heatmapTexture:(m,e)=>({u_matrix:new s.bJ(m,e.u_matrix),u_world:new s.bM(m,e.u_world),u_image:new s.bH(m,e.u_image),u_color_ramp:new s.bH(m,e.u_color_ramp),u_opacity:new s.b8(m,e.u_opacity)}),hillshade:(m,e)=>({u_image:new s.bH(m,e.u_image),u_latrange:new s.bM(m,e.u_latrange),u_exaggeration:new s.b8(m,e.u_exaggeration),u_altitudes:new s.bS(m,e.u_altitudes),u_azimuths:new s.bS(m,e.u_azimuths),u_accent:new s.bI(m,e.u_accent),u_method:new s.bH(m,e.u_method),u_shadows:new s.bR(m,e.u_shadows),u_highlights:new s.bR(m,e.u_highlights)}),hillshadePrepare:(m,e)=>({u_matrix:new s.bJ(m,e.u_matrix),u_image:new s.bH(m,e.u_image),u_dimension:new s.bM(m,e.u_dimension),u_zoom:new s.b8(m,e.u_zoom),u_unpack:new s.bK(m,e.u_unpack)}),line:(m,e)=>({u_translation:new s.bM(m,e.u_translation),u_ratio:new s.b8(m,e.u_ratio),u_device_pixel_ratio:new s.b8(m,e.u_device_pixel_ratio),u_units_to_pixels:new s.bM(m,e.u_units_to_pixels)}),lineGradient:(m,e)=>({u_translation:new s.bM(m,e.u_translation),u_ratio:new s.b8(m,e.u_ratio),u_device_pixel_ratio:new s.b8(m,e.u_device_pixel_ratio),u_units_to_pixels:new s.bM(m,e.u_units_to_pixels),u_image:new s.bH(m,e.u_image),u_image_height:new s.b8(m,e.u_image_height)}),linePattern:(m,e)=>({u_translation:new s.bM(m,e.u_translation),u_texsize:new s.bM(m,e.u_texsize),u_ratio:new s.b8(m,e.u_ratio),u_device_pixel_ratio:new s.b8(m,e.u_device_pixel_ratio),u_image:new s.bH(m,e.u_image),u_units_to_pixels:new s.bM(m,e.u_units_to_pixels),u_scale:new s.bL(m,e.u_scale),u_fade:new s.b8(m,e.u_fade)}),lineSDF:(m,e)=>({u_translation:new s.bM(m,e.u_translation),u_ratio:new s.b8(m,e.u_ratio),u_device_pixel_ratio:new s.b8(m,e.u_device_pixel_ratio),u_units_to_pixels:new s.bM(m,e.u_units_to_pixels),u_patternscale_a:new s.bM(m,e.u_patternscale_a),u_patternscale_b:new s.bM(m,e.u_patternscale_b),u_sdfgamma:new s.b8(m,e.u_sdfgamma),u_image:new s.bH(m,e.u_image),u_tex_y_a:new s.b8(m,e.u_tex_y_a),u_tex_y_b:new s.b8(m,e.u_tex_y_b),u_mix:new s.b8(m,e.u_mix)}),raster:(m,e)=>({u_tl_parent:new s.bM(m,e.u_tl_parent),u_scale_parent:new s.b8(m,e.u_scale_parent),u_buffer_scale:new s.b8(m,e.u_buffer_scale),u_fade_t:new s.b8(m,e.u_fade_t),u_opacity:new s.b8(m,e.u_opacity),u_image0:new s.bH(m,e.u_image0),u_image1:new s.bH(m,e.u_image1),u_brightness_low:new s.b8(m,e.u_brightness_low),u_brightness_high:new s.b8(m,e.u_brightness_high),u_saturation_factor:new s.b8(m,e.u_saturation_factor),u_contrast_factor:new s.b8(m,e.u_contrast_factor),u_spin_weights:new s.bL(m,e.u_spin_weights),u_coords_top:new s.bK(m,e.u_coords_top),u_coords_bottom:new s.bK(m,e.u_coords_bottom)}),symbolIcon:(m,e)=>({u_is_size_zoom_constant:new s.bH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bH(m,e.u_is_size_feature_constant),u_size_t:new s.b8(m,e.u_size_t),u_size:new s.b8(m,e.u_size),u_camera_to_center_distance:new s.b8(m,e.u_camera_to_center_distance),u_pitch:new s.b8(m,e.u_pitch),u_rotate_symbol:new s.bH(m,e.u_rotate_symbol),u_aspect_ratio:new s.b8(m,e.u_aspect_ratio),u_fade_change:new s.b8(m,e.u_fade_change),u_label_plane_matrix:new s.bJ(m,e.u_label_plane_matrix),u_coord_matrix:new s.bJ(m,e.u_coord_matrix),u_is_text:new s.bH(m,e.u_is_text),u_pitch_with_map:new s.bH(m,e.u_pitch_with_map),u_is_along_line:new s.bH(m,e.u_is_along_line),u_is_variable_anchor:new s.bH(m,e.u_is_variable_anchor),u_texsize:new s.bM(m,e.u_texsize),u_texture:new s.bH(m,e.u_texture),u_translation:new s.bM(m,e.u_translation),u_pitched_scale:new s.b8(m,e.u_pitched_scale)}),symbolSDF:(m,e)=>({u_is_size_zoom_constant:new s.bH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bH(m,e.u_is_size_feature_constant),u_size_t:new s.b8(m,e.u_size_t),u_size:new s.b8(m,e.u_size),u_camera_to_center_distance:new s.b8(m,e.u_camera_to_center_distance),u_pitch:new s.b8(m,e.u_pitch),u_rotate_symbol:new s.bH(m,e.u_rotate_symbol),u_aspect_ratio:new s.b8(m,e.u_aspect_ratio),u_fade_change:new s.b8(m,e.u_fade_change),u_label_plane_matrix:new s.bJ(m,e.u_label_plane_matrix),u_coord_matrix:new s.bJ(m,e.u_coord_matrix),u_is_text:new s.bH(m,e.u_is_text),u_pitch_with_map:new s.bH(m,e.u_pitch_with_map),u_is_along_line:new s.bH(m,e.u_is_along_line),u_is_variable_anchor:new s.bH(m,e.u_is_variable_anchor),u_texsize:new s.bM(m,e.u_texsize),u_texture:new s.bH(m,e.u_texture),u_gamma_scale:new s.b8(m,e.u_gamma_scale),u_device_pixel_ratio:new s.b8(m,e.u_device_pixel_ratio),u_is_halo:new s.bH(m,e.u_is_halo),u_translation:new s.bM(m,e.u_translation),u_pitched_scale:new s.b8(m,e.u_pitched_scale)}),symbolTextAndIcon:(m,e)=>({u_is_size_zoom_constant:new s.bH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bH(m,e.u_is_size_feature_constant),u_size_t:new s.b8(m,e.u_size_t),u_size:new s.b8(m,e.u_size),u_camera_to_center_distance:new s.b8(m,e.u_camera_to_center_distance),u_pitch:new s.b8(m,e.u_pitch),u_rotate_symbol:new s.bH(m,e.u_rotate_symbol),u_aspect_ratio:new s.b8(m,e.u_aspect_ratio),u_fade_change:new s.b8(m,e.u_fade_change),u_label_plane_matrix:new s.bJ(m,e.u_label_plane_matrix),u_coord_matrix:new s.bJ(m,e.u_coord_matrix),u_is_text:new s.bH(m,e.u_is_text),u_pitch_with_map:new s.bH(m,e.u_pitch_with_map),u_is_along_line:new s.bH(m,e.u_is_along_line),u_is_variable_anchor:new s.bH(m,e.u_is_variable_anchor),u_texsize:new s.bM(m,e.u_texsize),u_texsize_icon:new s.bM(m,e.u_texsize_icon),u_texture:new s.bH(m,e.u_texture),u_texture_icon:new s.bH(m,e.u_texture_icon),u_gamma_scale:new s.b8(m,e.u_gamma_scale),u_device_pixel_ratio:new s.b8(m,e.u_device_pixel_ratio),u_is_halo:new s.bH(m,e.u_is_halo),u_translation:new s.bM(m,e.u_translation),u_pitched_scale:new s.b8(m,e.u_pitched_scale)}),background:(m,e)=>({u_opacity:new s.b8(m,e.u_opacity),u_color:new s.bI(m,e.u_color)}),backgroundPattern:(m,e)=>({u_opacity:new s.b8(m,e.u_opacity),u_image:new s.bH(m,e.u_image),u_pattern_tl_a:new s.bM(m,e.u_pattern_tl_a),u_pattern_br_a:new s.bM(m,e.u_pattern_br_a),u_pattern_tl_b:new s.bM(m,e.u_pattern_tl_b),u_pattern_br_b:new s.bM(m,e.u_pattern_br_b),u_texsize:new s.bM(m,e.u_texsize),u_mix:new s.b8(m,e.u_mix),u_pattern_size_a:new s.bM(m,e.u_pattern_size_a),u_pattern_size_b:new s.bM(m,e.u_pattern_size_b),u_scale_a:new s.b8(m,e.u_scale_a),u_scale_b:new s.b8(m,e.u_scale_b),u_pixel_coord_upper:new s.bM(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(m,e.u_pixel_coord_lower),u_tile_units_to_pixels:new s.b8(m,e.u_tile_units_to_pixels)}),terrain:(m,e)=>({u_texture:new s.bH(m,e.u_texture),u_ele_delta:new s.b8(m,e.u_ele_delta),u_fog_matrix:new s.bJ(m,e.u_fog_matrix),u_fog_color:new s.bI(m,e.u_fog_color),u_fog_ground_blend:new s.b8(m,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.b8(m,e.u_fog_ground_blend_opacity),u_horizon_color:new s.bI(m,e.u_horizon_color),u_horizon_fog_blend:new s.b8(m,e.u_horizon_fog_blend),u_is_globe_mode:new s.b8(m,e.u_is_globe_mode)}),terrainDepth:(m,e)=>({u_ele_delta:new s.b8(m,e.u_ele_delta)}),terrainCoords:(m,e)=>({u_texture:new s.bH(m,e.u_texture),u_terrain_coords_id:new s.b8(m,e.u_terrain_coords_id),u_ele_delta:new s.b8(m,e.u_ele_delta)}),projectionErrorMeasurement:(m,e)=>({u_input:new s.b8(m,e.u_input),u_output_expected:new s.b8(m,e.u_output_expected)}),atmosphere:(m,e)=>({u_sun_pos:new s.bL(m,e.u_sun_pos),u_atmosphere_blend:new s.b8(m,e.u_atmosphere_blend),u_globe_position:new s.bL(m,e.u_globe_position),u_globe_radius:new s.b8(m,e.u_globe_radius),u_inv_proj_matrix:new s.bJ(m,e.u_inv_proj_matrix)}),sky:(m,e)=>({u_sky_color:new s.bI(m,e.u_sky_color),u_horizon_color:new s.bI(m,e.u_horizon_color),u_horizon:new s.bM(m,e.u_horizon),u_horizon_normal:new s.bM(m,e.u_horizon_normal),u_sky_horizon_blend:new s.b8(m,e.u_sky_horizon_blend),u_sky_blend:new s.b8(m,e.u_sky_blend)})};class vc{constructor(e,n,u){this.context=e;let p=e.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let Ca={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Md{constructor(e,n,u,p){this.length=n.length,this.attributes=u,this.itemSize=n.bytesPerElement,this.dynamicDraw=p,this.context=e;let g=e.gl;this.buffer=g.createBuffer(),e.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);let n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let u=0;u<this.attributes.length;u++){let p=n.attributes[this.attributes[u].name];p!==void 0&&e.enableVertexAttribArray(p)}}setVertexAttribPointers(e,n,u){for(let p=0;p<this.attributes.length;p++){let g=this.attributes[p],v=n.attributes[g.name];v!==void 0&&e.vertexAttribPointer(v,g.components,e[Ca[g.type]],!1,this.itemSize,g.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ti{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ho extends ti{getDefault(){return s.b7.transparent}set(e){let n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class bc extends ti{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Bs extends ti{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class xc extends ti{getDefault(){return[!0,!0,!0,!0]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Sd extends ti{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class wc extends ti{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class as extends ti{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class dl extends ti{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class zu extends ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class Bu extends ti{getDefault(){return[0,1]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Nu extends ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class Vu extends ti{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Cc extends ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class Td extends ti{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ed extends ti{getDefault(){return s.b7.transparent}set(e){let n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ul extends ti{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class hl extends ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class Ma extends ti{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Sa extends ti{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ls extends ti{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class pl extends ti{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Ns extends ti{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Or extends ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ju extends ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Uu extends ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Mc extends ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class cs extends ti{getDefault(){return null}set(e){let n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ta extends ti{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;let u=this.gl;Fn(u)?u.bindVertexArray(e):(n=u.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class fl extends ti{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Ea extends ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ml extends ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class gl extends ti{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class Vs extends gl{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class js extends gl{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Id extends gl{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}let _l="Framebuffer is not complete";class Nt{constructor(e,n,u,p,g){this.context=e,this.width=n,this.height=u;let v=e.gl,x=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new Vs(e,x),p)this.depthAttachment=g?new Id(e,x):new js(e,x);else if(g)throw new Error("Stencil cannot be set without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error(_l)}destroy(){let e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){let u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class Kr{constructor(e){var n,u;if(this.gl=e,this.clearColor=new ho(this),this.clearDepth=new bc(this),this.clearStencil=new Bs(this),this.colorMask=new xc(this),this.depthMask=new Sd(this),this.stencilMask=new wc(this),this.stencilFunc=new as(this),this.stencilOp=new dl(this),this.stencilTest=new zu(this),this.depthRange=new Bu(this),this.depthTest=new Nu(this),this.depthFunc=new Vu(this),this.blend=new Cc(this),this.blendFunc=new Td(this),this.blendColor=new Ed(this),this.blendEquation=new ul(this),this.cullFace=new hl(this),this.cullFaceSide=new Ma(this),this.frontFace=new Sa(this),this.program=new ls(this),this.activeTexture=new pl(this),this.viewport=new Ns(this),this.bindFramebuffer=new Or(this),this.bindRenderbuffer=new ju(this),this.bindTexture=new Uu(this),this.bindVertexBuffer=new Mc(this),this.bindElementBuffer=new cs(this),this.bindVertexArray=new Ta(this),this.pixelStoreUnpack=new fl(this),this.pixelStoreUnpackPremultiplyAlpha=new Ea(this),this.pixelStoreUnpackFlipY=new ml(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Fn(e)){this.HALF_FLOAT=e.HALF_FLOAT;let p=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:p?.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:p?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let p=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=p?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new vc(this,e,n)}createVertexBuffer(e,n,u){return new Md(this,e,n,u)}createRenderbuffer(e,n,u){let p=this.gl,g=p.createRenderbuffer();return this.bindRenderbuffer.set(g),p.renderbufferStorage(p.RENDERBUFFER,e,n,u),this.bindRenderbuffer.set(null),g}createFramebuffer(e,n,u,p){return new Nt(this,e,n,u,p)}clear({color:e,depth:n,stencil:u}){let p=this.gl,g=0;e&&(g|=p.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(g|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),u!==void 0&&(g|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),p.clear(g)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){s.bE(e.blendFunction,oi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Fn(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return Fn(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Ia;function Sc(m,e,n,u,p){let g=m.context,v=m.transform,x=g.gl,C=m.useProgram("collisionBox"),I=[],k=0,R=0;for(let te=0;te<u.length;te++){let re=u[te],de=e.getTile(re).getBucket(n);if(!de)continue;let ce=p?de.textCollisionBox:de.iconCollisionBox,ue=de.collisionCircleArray;ue.length>0&&(I.push({circleArray:ue,circleOffset:R,coord:re}),k+=ue.length/4,R=k),ce&&C.draw(g,x.LINES,Mt.disabled,Dt.disabled,m.colorModeForRenderPass(),jt.disabled,md(m.transform),m.style.map.terrain&&m.style.map.terrain.getTerrainData(re),v.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,null,m.transform.zoom,null,null,ce.collisionVertexBuffer)}if(!p||!I.length)return;let D=m.useProgram("collisionCircle"),N=new s.bT;N.resize(4*k),N._trim();let j=0;for(let te of I)for(let re=0;re<te.circleArray.length/4;re++){let de=4*re,ce=te.circleArray[de+0],ue=te.circleArray[de+1],ge=te.circleArray[de+2],he=te.circleArray[de+3];N.emplace(j++,ce,ue,ge,he,0),N.emplace(j++,ce,ue,ge,he,1),N.emplace(j++,ce,ue,ge,he,2),N.emplace(j++,ce,ue,ge,he,3)}(!Ia||Ia.length<2*k)&&(Ia=function(te){let re=2*te,de=new s.bV;de.resize(re),de._trim();for(let ce=0;ce<re;ce++){let ue=6*ce;de.uint16[ue+0]=4*ce+0,de.uint16[ue+1]=4*ce+1,de.uint16[ue+2]=4*ce+2,de.uint16[ue+3]=4*ce+2,de.uint16[ue+4]=4*ce+3,de.uint16[ue+5]=4*ce+0}return de}(k));let ee=g.createIndexBuffer(Ia,!0),J=g.createVertexBuffer(N,s.bU.members,!0);for(let te of I){let re=xa(m.transform);D.draw(g,x.TRIANGLES,Mt.disabled,Dt.disabled,m.colorModeForRenderPass(),jt.disabled,re,m.style.map.terrain&&m.style.map.terrain.getTerrainData(te.coord),null,n.id,J,ee,s.aJ.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,m.transform.zoom,null,null,null)}J.destroy(),ee.destroy()}let zo=s.ad(new Float32Array(16));function $u(m,e,n,u,p,g){let{horizontalAlign:v,verticalAlign:x}=s.aE(m);return new s.P((-(v-.5)*e/p+u[0])*g,(-(x-.5)*n/p+u[1])*g)}function Gu(m,e,n,u,p,g){let v=e.tileAnchorPoint.add(new s.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let x=u.mult(g);n||(x=x.rotate(-p));let C=v.add(x);return De(C.x,C.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){let x=Vi(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(m),C=Math.atan(x.y/x.x)+(x.x<0?Math.PI:0);return m.add(u.rotate(C))}return m.add(u)}function Pd(m,e,n,u,p,g,v,x,C,I,k,R){let D=m.text.placedSymbolArray,N=m.text.dynamicLayoutVertexArray,j=m.icon.dynamicLayoutVertexArray,ee={};N.clear();for(let J=0;J<D.length;J++){let te=D.get(J),re=te.hidden||!te.crossTileID||m.allowVerticalPlacement&&!te.placedOrientation?null:u[te.crossTileID];if(re){let de=new s.P(te.anchorX,te.anchorY),ce={getElevation:R,width:p.width,height:p.height,pitchedLabelPlaneMatrix:g,pitchWithMap:n,transform:p,tileAnchorPoint:de,translation:I,unwrappedTileID:k},ue=n?At(de.x,de.y,ce):Vi(de.x,de.y,ce),ge=ni(p.cameraToCenterDistance,ue.signedDistanceFromCamera),he=s.am(m.textSizeData,x,te)*ge/s.ay;n&&(he*=m.tilePixelRatio/v);let{width:Se,height:Le,anchor:ke,textOffset:Ae,textBoxScale:Re}=re,Ke=$u(ke,Se,Le,Ae,Re,he),Xe=p.getPitchedTextCorrection(de.x+I[0],de.y+I[1],k),Ue=Gu(ue.point,ce,e,Ke,-p.bearingInRadians,Xe),st=m.allowVerticalPlacement&&te.placedOrientation===s.al.vertical?Math.PI/2:0;for(let Ot=0;Ot<te.numGlyphs;Ot++)s.as(N,Ue,st);C&&te.associatedIconIndex>=0&&(ee[te.associatedIconIndex]={shiftedAnchor:Ue,angle:st})}else dr(te.numGlyphs,N)}if(C){j.clear();let J=m.icon.placedSymbolArray;for(let te=0;te<J.length;te++){let re=J.get(te);if(re.hidden)dr(re.numGlyphs,j);else{let de=ee[te];if(de)for(let ce=0;ce<re.numGlyphs;ce++)s.as(j,de.shiftedAnchor,de.angle);else dr(re.numGlyphs,j)}}m.icon.dynamicLayoutVertexBuffer.updateData(j)}m.text.dynamicLayoutVertexBuffer.updateData(N)}function kd(m,e,n){return n.iconsInText&&e?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function yl(m,e,n,u,p,g,v,x,C,I,k,R,D){let N=m.context,j=N.gl,ee=m.transform,J=x==="map",te=C==="map",re=x!=="viewport"&&n.layout.get("symbol-placement")!=="point",de=J&&!te&&!re,ce=!n.layout.get("symbol-sort-key").isConstant(),ue=!1,ge=m.getDepthModeForSublayer(0,Mt.ReadOnly),he=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Se=[],Le=ee.getCircleRadiusCorrection();for(let ke of u){let Ae=e.getTile(ke),Re=Ae.getBucket(n);if(!Re)continue;let Ke=p?Re.text:Re.icon;if(!Ke||!Ke.segments.get().length||!Ke.hasVisibleVertices)continue;let Xe=Ke.programConfigurations.get(n.id),Ue=p||Re.sdfIcons,st=p?Re.textSizeData:Re.iconSizeData,Ot=te||ee.pitch!==0,ei=m.useProgram(kd(Ue,p,Re),Xe),Zi=s.ak(st,ee.zoom),Si=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ke),qi,Wi,Pi,di,En=[0,0],zn=null;if(p)Wi=Ae.glyphAtlasTexture,Pi=j.LINEAR,qi=Ae.glyphAtlasTexture.size,Re.iconsInText&&(En=Ae.imageAtlasTexture.size,zn=Ae.imageAtlasTexture,di=Ot||m.options.rotating||m.options.zooming||st.kind==="composite"||st.kind==="camera"?j.LINEAR:j.NEAREST);else{let gn=n.layout.get("icon-size").constantOr(0)!==1||Re.iconsNeedLinear;Wi=Ae.imageAtlasTexture,Pi=Ue||m.options.rotating||m.options.zooming||gn||Ot?j.LINEAR:j.NEAREST,qi=Ae.imageAtlasTexture.size}let qn=s.az(Ae,1,m.transform.zoom),ui=ht(J,m.transform,qn),$s=s.K();s.an($s,ui);let jo=It(te,J,m.transform,qn),Gs=s.aA(ee,Ae,g,v),La=ee.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),Oc=he&&Re.hasTextData(),Hs=n.layout.get("icon-text-fit")!=="none"&&Oc&&Re.hasIconData();if(re){let gn=m.style.map.terrain?(pr,Oi)=>m.style.map.terrain.getElevation(ke,pr,Oi):null,_n=n.layout.get("text-rotation-alignment")==="map";ri(Re,m,p,ui,$s,te,I,_n,ke.toUnwrapped(),ee.width,ee.height,Gs,gn)}let za=p&&he||Hs,Fr=re||za?zo:te?ui:m.transform.clipSpaceToPixelsMatrix,Zs=Ue&&n.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ps;ps=Ue?Re.iconsInText?wa(st.kind,Zi,de,te,re,za,m,Fr,jo,Gs,qi,En,Le):xd(st.kind,Zi,de,te,re,za,m,Fr,jo,Gs,p,qi,0,Le):zs(st.kind,Zi,de,te,re,za,m,Fr,jo,Gs,p,qi,Le);let qs={program:ei,buffers:Ke,uniformValues:ps,projectionData:La,atlasTexture:Wi,atlasTextureIcon:zn,atlasInterpolation:Pi,atlasInterpolationIcon:di,isSDF:Ue,hasHalo:Zs};if(ce&&Re.canOverlap){ue=!0;let gn=Ke.segments.get();for(let _n of gn)Se.push({segments:new s.aJ([_n]),sortKey:_n.sortKey,state:qs,terrainData:Si})}else Se.push({segments:Ke.segments,sortKey:0,state:qs,terrainData:Si})}ue&&Se.sort((ke,Ae)=>ke.sortKey-Ae.sortKey);for(let ke of Se){let Ae=ke.state;if(N.activeTexture.set(j.TEXTURE0),Ae.atlasTexture.bind(Ae.atlasInterpolation,j.CLAMP_TO_EDGE),Ae.atlasTextureIcon&&(N.activeTexture.set(j.TEXTURE1),Ae.atlasTextureIcon&&Ae.atlasTextureIcon.bind(Ae.atlasInterpolationIcon,j.CLAMP_TO_EDGE)),Ae.isSDF){let Re=Ae.uniformValues;Ae.hasHalo&&(Re.u_is_halo=1,Pa(Ae.buffers,ke.segments,n,m,Ae.program,ge,k,R,Re,Ae.projectionData,ke.terrainData)),Re.u_is_halo=0}Pa(Ae.buffers,ke.segments,n,m,Ae.program,ge,k,R,Ae.uniformValues,Ae.projectionData,ke.terrainData)}}function Pa(m,e,n,u,p,g,v,x,C,I,k){let R=u.context;p.draw(R,R.gl.TRIANGLES,g,v,x,jt.backCCW,C,k,I,n.id,m.layoutVertexBuffer,m.indexBuffer,e,n.paint,u.transform.zoom,m.programConfigurations.get(n.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function vl(m,e,n,u,p){let g=m.context,v=g.gl,x=Dt.disabled,C=new oi([v.ONE,v.ONE],s.b7.transparent,[!0,!0,!0,!0]),I=e.getBucket(n);if(!I)return;let k=u.key,R=n.heatmapFbos.get(k);R||(R=ds(g,e.tileSize,e.tileSize),n.heatmapFbos.set(k,R)),g.bindFramebuffer.set(R.framebuffer),g.viewport.set([0,0,e.tileSize,e.tileSize]),g.clear({color:s.b7.transparent});let D=I.programConfigurations.get(n.id),N=m.useProgram("heatmap",D,!p),j=m.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ee=m.style.map.terrain.getTerrainData(u);N.draw(g,v.TRIANGLES,Mt.disabled,x,C,jt.disabled,Lo(e,m.transform.zoom,n.paint.get("heatmap-intensity"),1),ee,j,n.id,I.layoutVertexBuffer,I.indexBuffer,I.segments,n.paint,m.transform.zoom,D)}function Cr(m,e,n,u,p){let g=m.context,v=g.gl,x=m.transform;g.setColorMode(m.colorModeForRenderPass());let C=$i(g,e),I=n.key,k=e.heatmapFbos.get(I);if(!k)return;g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,k.colorAttachment.get()),g.activeTexture.set(v.TEXTURE1),C.bind(v.LINEAR,v.CLAMP_TO_EDGE);let R=x.getProjectionData({overscaledTileID:n,applyTerrainMatrix:p,applyGlobeMatrix:!u});m.useProgram("heatmapTexture").draw(g,v.TRIANGLES,Mt.disabled,Dt.disabled,m.colorModeForRenderPass(),jt.disabled,mc(m,e,0,1),null,R,e.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments,e.paint,x.zoom),k.destroy(),e.heatmapFbos.delete(I)}function ds(m,e,n){var u,p;let g=m.gl,v=g.createTexture();g.bindTexture(g.TEXTURE_2D,v),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);let x=(u=m.HALF_FLOAT)!==null&&u!==void 0?u:g.UNSIGNED_BYTE,C=(p=m.RGBA16F)!==null&&p!==void 0?p:g.RGBA;g.texImage2D(g.TEXTURE_2D,0,C,e,n,0,g.RGBA,x,null);let I=m.createFramebuffer(e,n,!1,!1);return I.colorAttachment.set(v),I}function $i(m,e){return e.colorRampTexture||(e.colorRampTexture=new li(m,e.colorRamp,m.gl.RGBA)),e.colorRampTexture}function ka(m,e,n,u,p){if(!n||!u||!u.imageAtlas)return;let g=u.imageAtlas.patternPositions,v=g[n.to.toString()],x=g[n.from.toString()];if(!v&&x&&(v=x),!x&&v&&(x=v),!v||!x){let C=p.getPaintProperty(e);v=g[C],x=g[C]}v&&x&&m.setConstantPatternPositions(v,x)}function Aa(m,e,n,u,p,g,v,x){let C=m.context.gl,I="fill-pattern",k=n.paint.get(I),R=k&&k.constantOr(1),D=n.getCrossfadeParameters(),N,j,ee,J,te,re=m.transform,de=n.paint.get("fill-translate"),ce=n.paint.get("fill-translate-anchor");v?(j=R&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=C.LINES):(j=R?"fillPattern":"fill",N=C.TRIANGLES);let ue=k.constantOr(null);for(let ge of u){let he=e.getTile(ge);if(R&&!he.patternsLoaded())continue;let Se=he.getBucket(n);if(!Se)continue;let Le=Se.programConfigurations.get(n.id),ke=m.useProgram(j,Le),Ae=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ge);R&&(m.context.activeTexture.set(C.TEXTURE0),he.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Le.updatePaintBuffers(D)),ka(Le,I,ue,he,n);let Re=re.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!x,applyTerrainMatrix:!0}),Ke=s.aA(re,he,de,ce);if(v){J=Se.indexBuffer2,te=Se.segments2;let Ue=[C.drawingBufferWidth,C.drawingBufferHeight];ee=j==="fillOutlinePattern"&&R?ba(m,D,he,Ue,Ke):Fs(Ue,Ke)}else J=Se.indexBuffer,te=Se.segments,ee=R?al(m,D,he,Ke):{u_fill_translate:Ke};let Xe=m.stencilModeForClipping(ge);ke.draw(m.context,N,p,Xe,g,jt.backCCW,ee,Ae,Re,n.id,Se.layoutVertexBuffer,J,te,n.paint,m.transform.zoom,Le)}}function Da(m,e,n,u,p,g,v,x){let C=m.context,I=C.gl,k="fill-extrusion-pattern",R=n.paint.get(k),D=R.constantOr(1),N=n.getCrossfadeParameters(),j=n.paint.get("fill-extrusion-opacity"),ee=R.constantOr(null),J=m.transform;for(let te of u){let re=e.getTile(te),de=re.getBucket(n);if(!de)continue;let ce=m.style.map.terrain&&m.style.map.terrain.getTerrainData(te),ue=de.programConfigurations.get(n.id),ge=m.useProgram(D?"fillExtrusionPattern":"fillExtrusion",ue);D&&(m.context.activeTexture.set(I.TEXTURE0),re.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ue.updatePaintBuffers(N));let he=J.getProjectionData({overscaledTileID:te,applyGlobeMatrix:!x,applyTerrainMatrix:!0});ka(ue,k,ee,re,n);let Se=s.aA(J,re,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Le=n.paint.get("fill-extrusion-vertical-gradient"),ke=D?Rr(m,Le,j,Se,te,N,re):va(m,Le,j,Se);ge.draw(C,C.gl.TRIANGLES,p,g,v,jt.backCCW,ke,ce,he,n.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,n.paint,m.transform.zoom,ue,m.style.map.terrain&&de.centroidVertexBuffer)}}function Tc(m,e,n,u,p,g,v,x,C){var I;let k=m.style.projection,R=m.context,D=m.transform,N=R.gl,j=[`#define NUM_ILLUMINATION_SOURCES ${n.paint.get("hillshade-highlight-color").values.length}`],ee=m.useProgram("hillshade",null,!1,j),J=!m.options.moving;for(let te of u){let re=e.getTile(te),de=re.fbo;if(!de)continue;let ce=k.getMeshFromTileID(R,te.canonical,x,!0,"raster"),ue=(I=m.style.map.terrain)===null||I===void 0?void 0:I.getTerrainData(te);R.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,de.colorAttachment.get());let ge=D.getProjectionData({overscaledTileID:te,aligned:J,applyGlobeMatrix:!C,applyTerrainMatrix:!0});ee.draw(R,N.TRIANGLES,g,p[te.overscaledZ],v,jt.backCCW,gc(m,re,n),ue,ge,n.id,ce.vertexBuffer,ce.indexBuffer,ce.segments)}}let Ra=[new s.P(0,0),new s.P(s.Z,0),new s.P(s.Z,s.Z),new s.P(0,s.Z)];function bl(m,e,n,u,p,g,v,x,C=!1,I=!1){let k=u[u.length-1].overscaledZ,R=m.context,D=R.gl,N=m.useProgram("raster"),j=m.transform,ee=m.style.projection,J=m.colorModeForRenderPass(),te=!m.options.moving;for(let re of u){let de=m.getDepthModeForSublayer(re.overscaledZ-k,n.paint.get("raster-opacity")===1?Mt.ReadWrite:Mt.ReadOnly,D.LESS),ce=e.getTile(re);ce.registerFadeDuration(n.paint.get("raster-fade-duration"));let ue=e.findLoadedParent(re,0),ge=e.findLoadedSibling(re),he=Ad(ce,ue||ge||null,e,n,m.transform,m.style.map.terrain),Se,Le,ke=n.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;R.activeTexture.set(D.TEXTURE0),ce.texture.bind(ke,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(D.TEXTURE1),ue?(ue.texture.bind(ke,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Se=Math.pow(2,ue.tileID.overscaledZ-ce.tileID.overscaledZ),Le=[ce.tileID.canonical.x*Se%1,ce.tileID.canonical.y*Se%1]):ce.texture.bind(ke,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),ce.texture.useMipmap&&R.extTextureFilterAnisotropic&&m.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);let Ae=m.style.map.terrain&&m.style.map.terrain.getTerrainData(re),Re=j.getProjectionData({overscaledTileID:re,aligned:te,applyGlobeMatrix:!I,applyTerrainMatrix:!0}),Ke=yc(Le||[0,0],Se||1,he,n,x),Xe=ee.getMeshFromTileID(R,re.canonical,g,v,"raster");N.draw(R,D.TRIANGLES,de,p?p[re.overscaledZ]:Dt.disabled,J,C?jt.frontCCW:jt.backCCW,Ke,Ae,Re,n.id,Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}}function Ad(m,e,n,u,p,g){let v=u.paint.get("raster-fade-duration");if(!g&&v>0){let x=be.now(),C=(x-m.timeAdded)/v,I=e?(x-e.timeAdded)/v:-1,k=n.getSource(),R=Me(p,{tileSize:k.tileSize,roundZoom:k.roundZoom}),D=!e||Math.abs(e.tileID.overscaledZ-R)>Math.abs(m.tileID.overscaledZ-R),N=D&&m.refreshedUponExpiration?1:s.ae(D?C:1-I,0,1);return m.refreshedUponExpiration&&C>=1&&(m.refreshedUponExpiration=!1),e?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}let xl=new s.b7(1,0,0,1),Us=new s.b7(0,1,0,1),M=new s.b7(0,0,1,1),E=new s.b7(1,0,1,1),F=new s.b7(0,1,1,1);function ne(m,e,n,u){et(m,0,e+n/2,m.transform.width,n,u)}function Oe(m,e,n,u){et(m,e-n/2,0,n,m.transform.height,u)}function et(m,e,n,u,p,g){let v=m.context,x=v.gl;x.enable(x.SCISSOR_TEST),x.scissor(e*m.pixelRatio,n*m.pixelRatio,u*m.pixelRatio,p*m.pixelRatio),v.clear({color:g}),x.disable(x.SCISSOR_TEST)}function yt(m,e,n){let u=m.context,p=u.gl,g=m.useProgram("debug"),v=Mt.disabled,x=Dt.disabled,C=m.colorModeForRenderPass(),I="$debug",k=m.style.map.terrain&&m.style.map.terrain.getTerrainData(n);u.activeTexture.set(p.TEXTURE0);let R=e.getTileByID(n.key).latestRawTileData,D=Math.floor((R&&R.byteLength||0)/1024),N=e.getTile(n).tileSize,j=512/Math.min(N,512)*(n.overscaledZ/m.transform.zoom)*.5,ee=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(ee+=` => ${n.overscaledZ}`),function(te,re){te.initDebugOverlayCanvas();let de=te.debugOverlayCanvas,ce=te.context.gl,ue=te.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,de.width,de.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(re,5,5),ue.strokeText(re,5,5),te.debugOverlayTexture.update(de),te.debugOverlayTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)}(m,`${ee} ${D}kB`);let J=m.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(u,p.TRIANGLES,v,x,oi.alphaBlended,jt.disabled,fc(s.b7.transparent,j),null,J,I,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),g.draw(u,p.LINE_STRIP,v,x,C,jt.disabled,fc(s.b7.red),k,J,I,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function Jt(m,e,n,u){let{isRenderingGlobe:p}=u,g=m.context,v=g.gl,x=m.transform,C=m.colorModeForRenderPass(),I=m.getDepthModeFor3D(),k=m.useProgram("terrain");g.bindFramebuffer.set(null),g.viewport.set([0,0,m.width,m.height]);for(let R of n){let D=e.getTerrainMesh(R.tileID),N=m.renderToTexture.getTexture(R),j=e.getTerrainData(R.tileID);g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,N.texture);let ee=e.getMeshFrameDelta(x.zoom),J=x.calculateFogMatrix(R.tileID.toUnwrapped()),te=Fu(ee,J,m.style.sky,x.pitch,p),re=x.getProjectionData({overscaledTileID:R.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(g,v.TRIANGLES,I,Dt.disabled,C,jt.backCCW,te,j,re,"terrain",D.vertexBuffer,D.indexBuffer,D.segments)}}function ii(m,e){if(!e.mesh){let n=new s.aI;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);let u=new s.aK;u.emplaceBack(0,1,2),u.emplaceBack(0,2,3),e.mesh=new ks(m.createVertexBuffer(n,On.members),m.createIndexBuffer(u),s.aJ.simpleSegment(0,0,n.length,u.length))}return e.mesh}class Bo{constructor(e,n){this.context=new Kr(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=we.maxUnderzooming+we.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new la}resize(e,n,u){if(this.width=Math.floor(e*u),this.height=Math.floor(n*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let p of this.style._order)this.style._layers[p].resize()}setup(){let e=this.context,n=new s.aI;n.emplaceBack(0,0),n.emplaceBack(s.Z,0),n.emplaceBack(0,s.Z),n.emplaceBack(s.Z,s.Z),this.tileExtentBuffer=e.createVertexBuffer(n,On.members),this.tileExtentSegments=s.aJ.simpleSegment(0,0,4,2);let u=new s.aI;u.emplaceBack(0,0),u.emplaceBack(s.Z,0),u.emplaceBack(0,s.Z),u.emplaceBack(s.Z,s.Z),this.debugBuffer=e.createVertexBuffer(u,On.members),this.debugSegments=s.aJ.simpleSegment(0,0,4,5);let p=new s.b_;p.emplaceBack(0,0,0,0),p.emplaceBack(s.Z,0,s.Z,0),p.emplaceBack(0,s.Z,0,s.Z),p.emplaceBack(s.Z,s.Z,s.Z,s.Z),this.rasterBoundsBuffer=e.createVertexBuffer(p,fd.members),this.rasterBoundsSegments=s.aJ.simpleSegment(0,0,4,2);let g=new s.aI;g.emplaceBack(0,0),g.emplaceBack(s.Z,0),g.emplaceBack(0,s.Z),g.emplaceBack(s.Z,s.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(g,On.members),this.rasterBoundsSegmentsPosOnly=s.aJ.simpleSegment(0,0,4,5);let v=new s.aI;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(v,On.members),this.viewportSegments=s.aJ.simpleSegment(0,0,4,2);let x=new s.b$;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(x);let C=new s.aK;C.emplaceBack(1,0,2),C.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(C);let I=this.context.gl;this.stencilClearMode=new Dt({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.tileExtentMesh=new ks(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){let e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let u=s.K();s.bQ(u,0,this.width,this.height,0,0,1),s.M(u,u,[n.drawingBufferWidth,n.drawingBufferHeight,0]);let p={mainMatrix:u,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:u};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,Mt.disabled,this.stencilClearMode,oi.disabled,jt.disabled,null,null,p,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,u){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();let p=this.context;p.setColorMode(oi.disabled),p.setDepthMode(Mt.disabled);let g={};for(let v of n)g[v.key]=this.nextStencilID++;this._renderTileMasks(g,n,u,!0),this._renderTileMasks(g,n,u,!1),this._tileClippingMaskIDs=g}_renderTileMasks(e,n,u,p){let g=this.context,v=g.gl,x=this.style.projection,C=this.transform,I=this.useProgram("clippingMask");for(let k of n){let R=e[k.key],D=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),N=x.getMeshFromTileID(this.context,k.canonical,p,!0,"stencil"),j=C.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!u,applyTerrainMatrix:!0});I.draw(g,v.TRIANGLES,Mt.disabled,new Dt({func:v.ALWAYS,mask:0},R,255,v.KEEP,v.KEEP,v.REPLACE),oi.disabled,u?jt.disabled:jt.backCCW,null,D,j,"$clipping",N.vertexBuffer,N.indexBuffer,N.segments)}}_renderTilesDepthBuffer(){let e=this.context,n=e.gl,u=this.style.projection,p=this.transform,g=this.useProgram("depth"),v=this.getDepthModeFor3D(),x=ye(p,{tileSize:p.tileSize});for(let C of x){let I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(C),k=u.getMeshFromTileID(this.context,C.canonical,!0,!0,"raster"),R=p.getProjectionData({overscaledTileID:C,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(e,n.TRIANGLES,v,Dt.disabled,oi.disabled,jt.backCCW,null,I,R,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,n=this.context.gl;return new Dt({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){let n=this.context.gl;return new Dt({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){let n=this.context.gl,u=e.sort((v,x)=>x.overscaledZ-v.overscaledZ),p=u[u.length-1].overscaledZ,g=u[0].overscaledZ-p+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();let v={};for(let x=0;x<g;x++)v[x+p]=new Dt({func:n.GEQUAL,mask:255},x+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=g,[v,u]}return[{[p]:Dt.disabled},u]}stencilConfigForOverlapTwoPass(e){let n=this.context.gl,u=e.sort((v,x)=>x.overscaledZ-v.overscaledZ),p=u[u.length-1].overscaledZ,g=u[0].overscaledZ-p+1;if(this.clearStencil(),g>1){let v={},x={};for(let C=0;C<g;C++)v[C+p]=new Dt({func:n.GREATER,mask:255},g+1+C,255,n.KEEP,n.KEEP,n.REPLACE),x[C+p]=new Dt({func:n.GREATER,mask:255},1+C,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*g+1,[v,x,u]}return this.nextStencilID=3,[{[p]:new Dt({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[p]:new Dt({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},u]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new oi([e.CONSTANT_COLOR,e.ONE],new s.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?oi.unblended:oi.alphaBlended}getDepthModeForSublayer(e,n,u){if(!this.opaquePassEnabledForLayer())return Mt.disabled;let p=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Mt(u||this.context.gl.LEQUAL,n,[p,p])}getDepthModeFor3D(){return new Mt(this.context.gl.LEQUAL,Mt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var u,p;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(be.now()),this.imageManager.beginFrame();let g=this.style._order,v=this.style.sourceCaches,x={},C={},I={},k={isRenderingToTexture:!1,isRenderingGlobe:((u=e.projection)===null||u===void 0?void 0:u.transitionState)>0};for(let D in v){let N=v[D];N.used&&N.prepare(this.context),x[D]=N.getVisibleCoordinates(!1),C[D]=x[D].slice().reverse(),I[D]=N.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let D=0;D<g.length;D++)if(this.style._layers[g[D]].is3D()){this.opaquePassCutoff=D;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let D of g){let N=this.style._layers[D];if(!N.hasOffscreenPass()||N.isHidden(this.transform.zoom))continue;let j=C[N.source];(N.type==="custom"||j.length)&&this.renderLayer(this,v[N.source],N,j,k)}if((p=this.style.projection)===null||p===void 0||p.updateGPUdependent({context:this.context,useProgram:D=>this.useProgram(D)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?s.b7.black:s.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(D,N){let j=D.context,ee=j.gl,J=((ge,he,Se)=>{let Le=Math.cos(he.rollInRadians),ke=Math.sin(he.rollInRadians),Ae=ve(he),Re=he.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ge.properties.get("sky-color"),u_horizon_color:ge.properties.get("horizon-color"),u_horizon:[(he.width/2-Ae*ke)*Se,(he.height/2+Ae*Le)*Se],u_horizon_normal:[-ke,Le],u_sky_horizon_blend:ge.properties.get("sky-horizon-blend")*he.height/2*Se,u_sky_blend:Re}})(N,D.style.map.transform,D.pixelRatio),te=new Mt(ee.LEQUAL,Mt.ReadWrite,[0,1]),re=Dt.disabled,de=D.colorModeForRenderPass(),ce=D.useProgram("sky"),ue=ii(j,N);ce.draw(j,ee.TRIANGLES,te,re,de,jt.disabled,J,null,void 0,"sky",ue.vertexBuffer,ue.indexBuffer,ue.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){let D=this.style._layers[g[this.currentLayer]],N=v[D.source],j=x[D.source];this._renderTileClippingMasks(D,j,!1),this.renderLayer(this,N,D,j,k)}this.renderPass="translucent";let R=!1;for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){let D=this.style._layers[g[this.currentLayer]],N=v[D.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(D,k))continue;this.opaquePassEnabledForLayer()||R||(R=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());let j=(D.type==="symbol"?I:C)[D.source];this._renderTileClippingMasks(D,x[D.source],!!this.renderToTexture),this.renderLayer(this,N,D,j,k)}if(k.isRenderingGlobe&&function(D,N,j){let ee=D.context,J=ee.gl,te=D.useProgram("atmosphere"),re=new Mt(J.LEQUAL,Mt.ReadOnly,[0,1]),de=D.transform,ce=function(Re,Ke){let Xe=Re.properties.get("position"),Ue=[-Xe.x,-Xe.y,-Xe.z],st=s.ad(new Float64Array(16));return Re.properties.get("anchor")==="map"&&(s.a_(st,st,Ke.rollInRadians),s.a$(st,st,-Ke.pitchInRadians),s.a_(st,st,Ke.bearingInRadians),s.a$(st,st,Ke.center.lat*Math.PI/180),s.bp(st,st,-Ke.center.lng*Math.PI/180)),s.bZ(Ue,Ue,st),Ue}(j,D.transform),ue=de.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ge=N.properties.get("atmosphere-blend")*ue.projectionTransition;if(ge===0)return;let he=Oo(de.worldSize,de.center.lat),Se=de.inverseProjectionMatrix,Le=new Float64Array(4);Le[3]=1,s.at(Le,Le,de.modelViewProjectionMatrix),Le[0]/=Le[3],Le[1]/=Le[3],Le[2]/=Le[3],Le[3]=1,s.at(Le,Le,Se),Le[0]/=Le[3],Le[1]/=Le[3],Le[2]/=Le[3],Le[3]=1;let ke=((Re,Ke,Xe,Ue,st)=>({u_sun_pos:Re,u_atmosphere_blend:Ke,u_globe_position:Xe,u_globe_radius:Ue,u_inv_proj_matrix:st}))(ce,ge,[Le[0],Le[1],Le[2]],he,Se),Ae=ii(ee,N);te.draw(ee,J.TRIANGLES,re,Dt.disabled,oi.alphaBlended,jt.disabled,ke,null,null,"atmosphere",Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){let D=function(N,j){let ee=null,J=Object.values(N._layers).flatMap(ce=>ce.source&&!ce.isHidden(j)?[N.sourceCaches[ce.source]]:[]),te=J.filter(ce=>ce.getSource().type==="vector"),re=J.filter(ce=>ce.getSource().type!=="vector"),de=ce=>{(!ee||ee.getSource().maxzoom<ce.getSource().maxzoom)&&(ee=ce)};return te.forEach(ce=>de(ce)),ee||re.forEach(ce=>de(ce)),ee}(this.style,this.transform.zoom);D&&function(N,j,ee){for(let J=0;J<ee.length;J++)yt(N,j,ee[J])}(this,D,D.getVisibleCoordinates())}this.options.showPadding&&function(D){let N=D.transform.padding;ne(D,D.transform.height-(N.top||0),3,xl),ne(D,N.bottom||0,3,Us),Oe(D,N.left||0,3,M),Oe(D,D.transform.width-(N.right||0),3,E);let j=D.transform.centerPoint;(function(ee,J,te,re){et(ee,J-1,te-10,2,20,re),et(ee,J-10,te-1,20,2,re)})(D,j.x,D.transform.height-j.y,F)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let n=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix,p=this.terrainFacilitator.dirty;p||(p=e?!s.c0(n,u):!s.c1(n,u)),p||(p=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),p&&(s.c2(n,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(g,v){let x=g.context,C=x.gl,I=g.transform,k=oi.unblended,R=new Mt(C.LEQUAL,Mt.ReadWrite,[0,1]),D=v.sourceCache.getRenderableTiles(),N=g.useProgram("terrainDepth");x.bindFramebuffer.set(v.getFramebuffer("depth").framebuffer),x.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),x.clear({color:s.b7.transparent,depth:1});for(let j of D){let ee=v.getTerrainMesh(j.tileID),J=v.getTerrainData(j.tileID),te=I.getProjectionData({overscaledTileID:j.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),re={u_ele_delta:v.getMeshFrameDelta(I.zoom)};N.draw(x,C.TRIANGLES,R,Dt.disabled,k,jt.backCCW,re,J,te,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}x.bindFramebuffer.set(null),x.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain),function(g,v){let x=g.context,C=x.gl,I=g.transform,k=oi.unblended,R=new Mt(C.LEQUAL,Mt.ReadWrite,[0,1]),D=v.getCoordsTexture(),N=v.sourceCache.getRenderableTiles(),j=g.useProgram("terrainCoords");x.bindFramebuffer.set(v.getFramebuffer("coords").framebuffer),x.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),x.clear({color:s.b7.transparent,depth:1}),v.coordsIndex=[];for(let ee of N){let J=v.getTerrainMesh(ee.tileID),te=v.getTerrainData(ee.tileID);x.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,D.texture);let re={u_terrain_coords_id:(255-v.coordsIndex.length)/255,u_texture:0,u_ele_delta:v.getMeshFrameDelta(I.zoom)},de=I.getProjectionData({overscaledTileID:ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(x,C.TRIANGLES,R,Dt.disabled,k,jt.backCCW,re,te,de,"terrain",J.vertexBuffer,J.indexBuffer,J.segments),v.coordsIndex.push(ee.tileID.key)}x.bindFramebuffer.set(null),x.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain))}renderLayer(e,n,u,p,g){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(p||[]).length)&&(this.id=u.id,s.c3(u)?function(v,x,C,I,k,R){if(v.renderPass!=="translucent")return;let{isRenderingToTexture:D}=R,N=Dt.disabled,j=v.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ee,J,te,re,de,ce,ue,ge,he){let Se=J.transform,Le=J.style.map.terrain,ke=de==="map",Ae=ce==="map";for(let Re of ee){let Ke=re.getTile(Re),Xe=Ke.getBucket(te);if(!Xe||!Xe.text||!Xe.text.segments.get().length)continue;let Ue=s.ak(Xe.textSizeData,Se.zoom),st=s.az(Ke,1,J.transform.zoom),Ot=ht(ke,J.transform,st),ei=te.layout.get("icon-text-fit")!=="none"&&Xe.hasIconData();if(Ue){let Zi=Math.pow(2,Se.zoom-Ke.tileID.overscaledZ),Si=Le?(qi,Wi)=>Le.getElevation(Re,qi,Wi):null;Pd(Xe,ke,Ae,he,Se,Ot,Zi,Ue,ei,s.aA(Se,Ke,ue,ge),Re.toUnwrapped(),Si)}}}(I,v,C,x,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),k),C.paint.get("icon-opacity").constantOr(1)!==0&&yl(v,x,C,I,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),N,j,D),C.paint.get("text-opacity").constantOr(1)!==0&&yl(v,x,C,I,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),N,j,D),x.map.showCollisionBoxes&&(Sc(v,x,C,I,!0),Sc(v,x,C,I,!1))}(e,n,u,p,this.style.placement.variableOffsets,g):s.c4(u)?function(v,x,C,I,k){if(v.renderPass!=="translucent")return;let{isRenderingToTexture:R}=k,D=C.paint.get("circle-opacity"),N=C.paint.get("circle-stroke-width"),j=C.paint.get("circle-stroke-opacity"),ee=!C.layout.get("circle-sort-key").isConstant();if(D.constantOr(1)===0&&(N.constantOr(1)===0||j.constantOr(1)===0))return;let J=v.context,te=J.gl,re=v.transform,de=v.getDepthModeForSublayer(0,Mt.ReadOnly),ce=Dt.disabled,ue=v.colorModeForRenderPass(),ge=[],he=re.getCircleRadiusCorrection();for(let Se=0;Se<I.length;Se++){let Le=I[Se],ke=x.getTile(Le),Ae=ke.getBucket(C);if(!Ae)continue;let Re=C.paint.get("circle-translate"),Ke=C.paint.get("circle-translate-anchor"),Xe=s.aA(re,ke,Re,Ke),Ue=Ae.programConfigurations.get(C.id),st=v.useProgram("circle",Ue),Ot=Ae.layoutVertexBuffer,ei=Ae.indexBuffer,Zi=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Le),Si={programConfiguration:Ue,program:st,layoutVertexBuffer:Ot,indexBuffer:ei,uniformValues:Ls(v,ke,C,Xe,he),terrainData:Zi,projectionData:re.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!R,applyTerrainMatrix:!0})};if(ee){let qi=Ae.segments.get();for(let Wi of qi)ge.push({segments:new s.aJ([Wi]),sortKey:Wi.sortKey,state:Si})}else ge.push({segments:Ae.segments,sortKey:0,state:Si})}ee&&ge.sort((Se,Le)=>Se.sortKey-Le.sortKey);for(let Se of ge){let{programConfiguration:Le,program:ke,layoutVertexBuffer:Ae,indexBuffer:Re,uniformValues:Ke,terrainData:Xe,projectionData:Ue}=Se.state;ke.draw(J,te.TRIANGLES,de,ce,ue,jt.backCCW,Ke,Xe,Ue,C.id,Ae,Re,Se.segments,C.paint,v.transform.zoom,Le)}}(e,n,u,p,g):s.c5(u)?function(v,x,C,I,k){if(C.paint.get("heatmap-opacity")===0)return;let R=v.context,{isRenderingToTexture:D,isRenderingGlobe:N}=k;if(v.style.map.terrain){for(let j of I){let ee=x.getTile(j);x.hasRenderableParent(j)||(v.renderPass==="offscreen"?vl(v,ee,C,j,N):v.renderPass==="translucent"&&Cr(v,C,j,D,N))}R.viewport.set([0,0,v.width,v.height])}else v.renderPass==="offscreen"?function(j,ee,J,te){let re=j.context,de=re.gl,ce=j.transform,ue=Dt.disabled,ge=new oi([de.ONE,de.ONE],s.b7.transparent,[!0,!0,!0,!0]);(function(he,Se,Le){let ke=he.gl;he.activeTexture.set(ke.TEXTURE1),he.viewport.set([0,0,Se.width/4,Se.height/4]);let Ae=Le.heatmapFbos.get(s.bW);Ae?(ke.bindTexture(ke.TEXTURE_2D,Ae.colorAttachment.get()),he.bindFramebuffer.set(Ae.framebuffer)):(Ae=ds(he,Se.width/4,Se.height/4),Le.heatmapFbos.set(s.bW,Ae))})(re,j,J),re.clear({color:s.b7.transparent});for(let he=0;he<te.length;he++){let Se=te[he];if(ee.hasRenderableParent(Se))continue;let Le=ee.getTile(Se),ke=Le.getBucket(J);if(!ke)continue;let Ae=ke.programConfigurations.get(J.id),Re=j.useProgram("heatmap",Ae),Ke=ce.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Xe=ce.getCircleRadiusCorrection();Re.draw(re,de.TRIANGLES,Mt.disabled,ue,ge,jt.backCCW,Lo(Le,ce.zoom,J.paint.get("heatmap-intensity"),Xe),null,Ke,J.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,J.paint,ce.zoom,Ae)}re.viewport.set([0,0,j.width,j.height])}(v,x,C,I):v.renderPass==="translucent"&&function(j,ee){let J=j.context,te=J.gl;J.setColorMode(j.colorModeForRenderPass());let re=ee.heatmapFbos.get(s.bW);re&&(J.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,re.colorAttachment.get()),J.activeTexture.set(te.TEXTURE1),$i(J,ee).bind(te.LINEAR,te.CLAMP_TO_EDGE),j.useProgram("heatmapTexture").draw(J,te.TRIANGLES,Mt.disabled,Dt.disabled,j.colorModeForRenderPass(),jt.disabled,mc(j,ee,0,1),null,null,ee.id,j.viewportBuffer,j.quadTriangleIndexBuffer,j.viewportSegments,ee.paint,j.transform.zoom))}(v,C)}(e,n,u,p,g):s.c6(u)?function(v,x,C,I,k){if(v.renderPass!=="translucent")return;let{isRenderingToTexture:R}=k,D=C.paint.get("line-opacity"),N=C.paint.get("line-width");if(D.constantOr(1)===0||N.constantOr(1)===0)return;let j=v.getDepthModeForSublayer(0,Mt.ReadOnly),ee=v.colorModeForRenderPass(),J=C.paint.get("line-dasharray"),te=C.paint.get("line-pattern"),re=te.constantOr(1),de=C.paint.get("line-gradient"),ce=C.getCrossfadeParameters(),ue=re?"linePattern":J?"lineSDF":de?"lineGradient":"line",ge=v.context,he=ge.gl,Se=v.transform,Le=!0;for(let ke of I){let Ae=x.getTile(ke);if(re&&!Ae.patternsLoaded())continue;let Re=Ae.getBucket(C);if(!Re)continue;let Ke=Re.programConfigurations.get(C.id),Xe=v.context.program.get(),Ue=v.useProgram(ue,Ke),st=Le||Ue.program!==Xe,Ot=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ke),ei=te.constantOr(null);if(ei&&Ae.imageAtlas){let Pi=Ae.imageAtlas,di=Pi.patternPositions[ei.to.toString()],En=Pi.patternPositions[ei.from.toString()];di&&En&&Ke.setConstantPatternPositions(di,En)}let Zi=Se.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),Si=Se.getPixelScale(),qi=re?yd(v,Ae,C,Si,ce):J?vd(v,Ae,C,Si,J,ce):de?_d(v,Ae,C,Si,Re.lineClipsArray.length):Yr(v,Ae,C,Si);if(re)ge.activeTexture.set(he.TEXTURE0),Ae.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),Ke.updatePaintBuffers(ce);else if(J&&(st||v.lineAtlas.dirty))ge.activeTexture.set(he.TEXTURE0),v.lineAtlas.bind(ge);else if(de){let Pi=Re.gradients[C.id],di=Pi.texture;if(C.gradientVersion!==Pi.version){let En=256;if(C.stepInterpolant){let zn=x.getSource().maxzoom,qn=ke.canonical.z===zn?Math.ceil(1<<v.transform.maxZoom-ke.canonical.z):1;En=s.ae(s.bX(Re.maxLineLength/s.Z*1024*qn),256,ge.maxTextureSize)}Pi.gradient=s.bY({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:En,image:Pi.gradient||void 0,clips:Re.lineClipsArray}),Pi.texture?Pi.texture.update(Pi.gradient):Pi.texture=new li(ge,Pi.gradient,he.RGBA),Pi.version=C.gradientVersion,di=Pi.texture}ge.activeTexture.set(he.TEXTURE0),di.bind(C.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}let Wi=v.stencilModeForClipping(ke);Ue.draw(ge,he.TRIANGLES,j,Wi,ee,jt.disabled,qi,Ot,Zi,C.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,C.paint,v.transform.zoom,Ke,Re.layoutVertexBuffer2),Le=!1}}(e,n,u,p,g):s.c7(u)?function(v,x,C,I,k){let R=C.paint.get("fill-color"),D=C.paint.get("fill-opacity");if(D.constantOr(1)===0)return;let{isRenderingToTexture:N}=k,j=v.colorModeForRenderPass(),ee=C.paint.get("fill-pattern"),J=v.opaquePassEnabledForLayer()&&!ee.constantOr(1)&&R.constantOr(s.b7.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===J){let te=v.getDepthModeForSublayer(1,v.renderPass==="opaque"?Mt.ReadWrite:Mt.ReadOnly);Aa(v,x,C,I,te,j,!1,N)}if(v.renderPass==="translucent"&&C.paint.get("fill-antialias")){let te=v.getDepthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Mt.ReadOnly);Aa(v,x,C,I,te,j,!0,N)}}(e,n,u,p,g):s.c8(u)?function(v,x,C,I,k){let R=C.paint.get("fill-extrusion-opacity");if(R===0)return;let{isRenderingToTexture:D}=k;if(v.renderPass==="translucent"){let N=new Mt(v.context.gl.LEQUAL,Mt.ReadWrite,v.depthRangeFor3D);if(R!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))Da(v,x,C,I,N,Dt.disabled,oi.disabled,D),Da(v,x,C,I,N,v.stencilModeFor3D(),v.colorModeForRenderPass(),D);else{let j=v.colorModeForRenderPass();Da(v,x,C,I,N,Dt.disabled,j,D)}}}(e,n,u,p,g):s.c9(u)?function(v,x,C,I,k){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;let{isRenderingToTexture:R}=k,D=v.context,N=v.style.projection.useSubdivision,j=v.getDepthModeForSublayer(0,Mt.ReadOnly),ee=v.colorModeForRenderPass();if(v.renderPass==="offscreen")(function(J,te,re,de,ce,ue,ge){let he=J.context,Se=he.gl;for(let Le of re){let ke=te.getTile(Le),Ae=ke.dem;if(!Ae||!Ae.data||!ke.needsHillshadePrepare)continue;let Re=Ae.dim,Ke=Ae.stride,Xe=Ae.getPixels();if(he.activeTexture.set(Se.TEXTURE1),he.pixelStoreUnpackPremultiplyAlpha.set(!1),ke.demTexture=ke.demTexture||J.getTileTexture(Ke),ke.demTexture){let st=ke.demTexture;st.update(Xe,{premultiply:!1}),st.bind(Se.NEAREST,Se.CLAMP_TO_EDGE)}else ke.demTexture=new li(he,Xe,Se.RGBA,{premultiply:!1}),ke.demTexture.bind(Se.NEAREST,Se.CLAMP_TO_EDGE);he.activeTexture.set(Se.TEXTURE0);let Ue=ke.fbo;if(!Ue){let st=new li(he,{width:Re,height:Re,data:null},Se.RGBA);st.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),Ue=ke.fbo=he.createFramebuffer(Re,Re,!0,!1),Ue.colorAttachment.set(st.texture)}he.bindFramebuffer.set(Ue.framebuffer),he.viewport.set([0,0,Re,Re]),J.useProgram("hillshadePrepare").draw(he,Se.TRIANGLES,ce,ue,ge,jt.disabled,gd(ke.tileID,Ae),null,null,de.id,J.rasterBoundsBuffer,J.quadTriangleIndexBuffer,J.rasterBoundsSegments),ke.needsHillshadePrepare=!1}})(v,x,I,C,j,Dt.disabled,ee),D.viewport.set([0,0,v.width,v.height]);else if(v.renderPass==="translucent")if(N){let[J,te,re]=v.stencilConfigForOverlapTwoPass(I);Tc(v,x,C,re,J,j,ee,!1,R),Tc(v,x,C,re,te,j,ee,!0,R)}else{let[J,te]=v.getStencilConfigForOverlapAndUpdateStencilID(I);Tc(v,x,C,te,J,j,ee,!1,R)}}(e,n,u,p,g):s.ca(u)?function(v,x,C,I,k){if(v.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!I.length)return;let{isRenderingToTexture:R}=k,D=x.getSource(),N=v.style.projection.useSubdivision;if(D instanceof Rn)bl(v,x,C,I,null,!1,!1,D.tileCoords,D.flippedWindingOrder,R);else if(N){let[j,ee,J]=v.stencilConfigForOverlapTwoPass(I);bl(v,x,C,J,j,!1,!0,Ra,!1,R),bl(v,x,C,J,ee,!0,!0,Ra,!1,R)}else{let[j,ee]=v.getStencilConfigForOverlapAndUpdateStencilID(I);bl(v,x,C,ee,j,!1,!0,Ra,!1,R)}}(e,n,u,p,g):s.cb(u)?function(v,x,C,I,k){let R=C.paint.get("background-color"),D=C.paint.get("background-opacity");if(D===0)return;let{isRenderingToTexture:N}=k,j=v.context,ee=j.gl,J=v.style.projection,te=v.transform,re=te.tileSize,de=C.paint.get("background-pattern");if(v.isPatternMissing(de))return;let ce=!de&&R.a===1&&D===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==ce)return;let ue=Dt.disabled,ge=v.getDepthModeForSublayer(0,ce==="opaque"?Mt.ReadWrite:Mt.ReadOnly),he=v.colorModeForRenderPass(),Se=v.useProgram(de?"backgroundPattern":"background"),Le=I||ye(te,{tileSize:re,terrain:v.style.map.terrain});de&&(j.activeTexture.set(ee.TEXTURE0),v.imageManager.bind(v.context));let ke=C.getCrossfadeParameters();for(let Ae of Le){let Re=te.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),Ke=de?Lu(D,v,de,{tileID:Ae,tileSize:re},ke):wd(D,R),Xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ae),Ue=J.getMeshFromTileID(j,Ae.canonical,!1,!0,"raster");Se.draw(j,ee.TRIANGLES,ge,ue,he,jt.backCCW,Ke,Xe,Re,C.id,Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}}(e,0,u,p,g):s.cc(u)&&function(v,x,C,I){let{isRenderingGlobe:k}=I,R=v.context,D=C.implementation,N=v.style.projection,j=v.transform,ee=j.getProjectionDataForCustomLayer(k),J={farZ:j.farZ,nearZ:j.nearZ,fov:j.fov*Math.PI/180,modelViewProjectionMatrix:j.modelViewProjectionMatrix,projectionMatrix:j.projectionMatrix,shaderData:{variantName:N.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${N.shaderPreludeCode.vertexSource}`,define:N.shaderDefine},defaultProjectionData:ee},te=D.renderingMode?D.renderingMode:"2d";if(v.renderPass==="offscreen"){let re=D.prerender;re&&(v.setCustomLayerDefaults(),R.setColorMode(v.colorModeForRenderPass()),re.call(D,R.gl,J),R.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),R.setColorMode(v.colorModeForRenderPass()),R.setStencilMode(Dt.disabled);let re=te==="3d"?v.getDepthModeFor3D():v.getDepthModeForSublayer(0,Mt.ReadOnly);R.setDepthMode(re),D.render(R.gl,J),R.setDirty(),v.setBaseState(),R.bindFramebuffer.set(null)}}(e,0,u,g))}saveTileTexture(e){let n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let n=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!n||!u}useProgram(e,n,u=!1,p=[]){this.cache=this.cache||{};let g=!!this.style.map.terrain,v=this.style.projection,x=u?Gn.projectionMercator:v.shaderPreludeCode,C=u?is:v.shaderDefine,I=e+(n?n.cacheKey:"")+`/${u?Vt:v.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(g?"/terrain":"")+(p?`/${p.join("/")}`:"");return this.cache[I]||(this.cache[I]=new sl(this.context,Gn[e],n,Cd[e],this._showOverdrawInspector,g,x,C,p)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new li(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function us(m,e){let n,u=!1,p=null,g=null,v=()=>{p=null,u&&(m.apply(g,n),p=setTimeout(v,e),u=!1)};return(...x)=>(u=!0,g=this,n=x,p||v(),p)}class Hu{constructor(e){this._getCurrentHash=()=>{let n=window.location.hash.replace("#","");if(this._hashName){let u;return n.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(u=p)}),(u&&u[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{let n=this._getCurrentHash();if(!this._isValidHash(n))return!1;let u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:u,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{let n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{let n=this._getCurrentHash();if(n.length===0)return;let u=n.join("/"),p=u;p.split("&").length>0&&(p=p.split("&")[0]),this._hashName&&(p=`${this._hashName}=${u}`);let g=window.location.hash.replace(p,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let v=window.location.href.replace(/(#.+)?$/,g);v=v.replace("&&","&"),window.history.replaceState(window.history.state,null,v)},this._updateHash=us(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){let n=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,p=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,p),v=Math.round(n.lng*g)/g,x=Math.round(n.lat*g)/g,C=this._map.getBearing(),I=this._map.getPitch(),k="";if(k+=e?`/${v}/${x}/${u}`:`${u}/${x}/${v}`,(C||I)&&(k+="/"+Math.round(10*C)/10),I&&(k+=`/${Math.round(I)}`),this._hashName){let R=this._hashName,D=!1,N=window.location.hash.slice(1).split("&").map(j=>{let ee=j.split("=")[0];return ee===R?(D=!0,`${ee}=${k}`):j}).filter(j=>j);return D||N.push(`${R}=${k}`),`#${N.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new s.Q(+e[2],+e[1])}catch{return!1}let n=+e[0],u=+(e[3]||0),p=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&u>=-180&&u<=180&&p>=this._map.getMinPitch()&&p<=this._map.getMaxPitch()}}let No={linearity:.3,easing:s.cd(0,0,.3,1)},Zu=s.e({deceleration:2500,maxSpeed:1400},No),Ec=s.e({deceleration:20,maxSpeed:1400},No),qu=s.e({deceleration:1e3,maxSpeed:360},No),jp=s.e({deceleration:1e3,maxSpeed:90},No),Up=s.e({deceleration:1e3,maxSpeed:360},No);class $p{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:be.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,n=be.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let n={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:g}of this._inertiaBuffer)n.zoom+=g.zoomDelta||0,n.bearing+=g.bearingDelta||0,n.pitch+=g.pitchDelta||0,n.roll+=g.rollDelta||0,g.panDelta&&n.pan._add(g.panDelta),g.around&&(n.around=g.around),g.pinchAround&&(n.pinchAround=g.pinchAround);let u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(n.pan.mag()){let g=Cl(n.pan.mag(),u,s.e({},Zu,e||{})),v=n.pan.mult(g.amount/n.pan.mag()),x=this._map.cameraHelper.handlePanInertia(v,this._map.transform);p.center=x.easingCenter,p.offset=x.easingOffset,wl(p,g)}if(n.zoom){let g=Cl(n.zoom,u,Ec);p.zoom=this._map.transform.zoom+g.amount,wl(p,g)}if(n.bearing){let g=Cl(n.bearing,u,qu);p.bearing=this._map.transform.bearing+s.ae(g.amount,-179,179),wl(p,g)}if(n.pitch){let g=Cl(n.pitch,u,jp);p.pitch=this._map.transform.pitch+g.amount,wl(p,g)}if(n.roll){let g=Cl(n.roll,u,Up);p.roll=this._map.transform.roll+s.ae(g.amount,-179,179),wl(p,g)}if(p.zoom||p.bearing){let g=n.pinchAround===void 0?n.around:n.pinchAround;p.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),s.e(p,{noMoveStart:!0})}}function wl(m,e){(!m.duration||m.duration<e.duration)&&(m.duration=e.duration,m.easing=e.easing)}function Cl(m,e,n){let{maxSpeed:u,linearity:p,deceleration:g}=n,v=s.ae(m*p/(e/1e3),-u,u),x=Math.abs(v)/(g*p);return{easing:n.easing,duration:1e3*x,amount:v*(x/2)}}class Tn extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,u,p={}){u=u instanceof MouseEvent?u:new MouseEvent(e,u);let g=G.mousePos(n.getCanvas(),u),v=n.unproject(g);super(e,s.e({point:g,lngLat:v,originalEvent:u},p)),this._defaultPrevented=!1,this.target=n}}class Ml extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,u){let p=e==="touchend"?u.changedTouches:u.touches,g=G.touchPos(n.getCanvasContainer(),p),v=g.map(C=>n.unproject(C)),x=g.reduce((C,I,k,R)=>C.add(I.div(R.length)),new s.P(0,0));super(e,{points:g,point:x,lngLats:v,lngLat:n.unproject(x),originalEvent:u}),this._defaultPrevented=!1}}class Wu extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class Gp{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Wu(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new Tn(e.type,this._map,e))}mouseup(e){this._map.fire(new Tn(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new Tn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Tn(e.type,this._map,e))}mouseover(e){this._map.fire(new Tn(e.type,this._map,e))}mouseout(e){this._map.fire(new Tn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Ml(e.type,this._map,e))}touchmove(e){this._map.fire(new Ml(e.type,this._map,e))}touchend(e){this._map.fire(new Ml(e.type,this._map,e))}touchcancel(e){this._map.fire(new Ml(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hp{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Tn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Tn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Tn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Sl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(s.P.convert(e),this._map.terrain)}}class Xu{constructor(e,n){this._map=e,this._tr=new Sl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(G.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;let u=n;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;let p=this._startPos;this._lastPos=u,this._box||(this._box=G.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let g=Math.min(p.x,u.x),v=Math.max(p.x,u.x),x=Math.min(p.y,u.y),C=Math.max(p.y,u.y);G.setTransform(this._box,`translate(${g}px,${x}px)`),this._box.style.width=v-g+"px",this._box.style.height=C-x+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;let u=this._startPos,p=n;if(this.reset(),G.suppressClick(),u.x!==p.x||u.y!==p.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:e})),{cameraAnimation:g=>g.fitScreenCoordinates(u,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new s.l(e,{originalEvent:n}))}}function Dd(m,e){if(m.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${e.length}`);let n={};for(let u=0;u<m.length;u++)n[m[u].identifier]=e[u];return n}class Zp{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(p){let g=new s.P(0,0);for(let v of p)g._add(v);return g.div(p.length)}(n),this.touches=Dd(u,n)))}touchmove(e,n,u){if(this.aborted||!this.centroid)return;let p=Dd(u,n);for(let g in this.touches){let v=p[g];(!v||v.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(e,n,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){let p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Tl{constructor(e){this.singleTap=new Zp(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,u){this.singleTap.touchstart(e,n,u)}touchmove(e,n,u){this.singleTap.touchmove(e,n,u)}touchend(e,n,u){let p=this.singleTap.touchend(e,n,u);if(p){let g=e.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(p)<30;if(g&&v||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class qp{constructor(e){this._tr=new Sl(e),this._zoomIn=new Tl({numTouches:1,numTaps:2}),this._zoomOut=new Tl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,u){this._zoomIn.touchstart(e,n,u),this._zoomOut.touchstart(e,n,u)}touchmove(e,n,u){this._zoomIn.touchmove(e,n,u),this._zoomOut.touchmove(e,n,u)}touchend(e,n,u){let p=this._zoomIn.touchend(e,n,u),g=this._zoomOut.touchend(e,n,u),v=this._tr;return p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(p)},{originalEvent:e})}):g?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(g)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ir{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;let u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);let p=Array.isArray(n)?n[0]:n;return!this._moved&&p.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(u,p))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&G.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let po={0:1,2:2};class El{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let n=G.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,u){let p=po[u];return n.buttons===void 0||(n.buttons&p)!==p}(e,this._eventButton)}isValidEndEvent(e){return G.mouseButton(e)===this._eventButton}}class fo{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Il{constructor(e=new El({checkCorrectEvent:()=>!0}),n=new fo){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,u){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?u(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}let Rd=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=e=>{e.preventDefault()}};class Ag{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,u){return this._calculateTransform(e,n,u)}touchmove(e,n,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,n,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,u){this._calculateTransform(e,n,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,u){u.length>0&&(this._active=!0);let p=Dd(u,n),g=new s.P(0,0),v=new s.P(0,0),x=0;for(let I in p){let k=p[I],R=this._touches[I];R&&(g._add(k),v._add(k.sub(R)),x++,p[I]=k)}if(this._touches=p,this._shouldBePrevented(x)||!v.mag())return;let C=v.div(x);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(x),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,u){if(!this._firstTwoTouches)return;e.preventDefault();let[p,g]=this._firstTwoTouches,v=Od(u,n,p),x=Od(u,n,g);if(!v||!x)return;let C=this._aroundCenter?null:v.add(x).div(2);return this._move([v,x],C,e)}touchend(e,n,u){if(!this._firstTwoTouches)return;let[p,g]=this._firstTwoTouches,v=Od(u,n,p),x=Od(u,n,g);v&&x||(this._active&&G.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Od(m,e,n){for(let u=0;u<m.length;u++)if(m[u].identifier===n)return e[u]}function Ku(m,e){return Math.log(m/e)/Math.LN2}class Pl extends Yu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){let u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Ku(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ku(this._distance,u),pinchAround:n}}}function Vo(m,e){return 180*m.angleWith(e)/Math.PI}class tt extends Yu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,u){let p=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Vo(this._vector,p),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let n=25/(Math.PI*this._minDiameter)*360,u=Vo(e,this._startVector);return Math.abs(u)<n}}function Fd(m){return Math.abs(m.y)>Math.abs(m.x)}class Ld extends Yu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,u){super.touchstart(e,n,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,Fd(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let p=e[0].sub(this._lastPoints[0]),g=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,g,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(p.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,u){if(this._valid!==void 0)return this._valid;let p=e.mag()>=2,g=n.mag()>=2;if(!p&&!g)return;if(!p||!g)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;let v=e.y>0==n.y>0;return Fd(e)&&Fd(n)&&v}}let Wp={panStep:100,bearingStep:15,pitchStep:10};class kl{constructor(e){this._tr=new Sl(e);let n=Wp;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,u=0,p=0,g=0,v=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),g=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),g=1);break;case 38:e.shiftKey?p=1:(e.preventDefault(),v=-1);break;case 40:e.shiftKey?p=-1:(e.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(u=0,p=0),{cameraAnimation:x=>{let C=this._tr;x.easeTo({duration:300,easeId:"keyboardHandler",easing:Ic,zoom:n?Math.round(C.zoom)+n*(e.shiftKey?2:1):C.zoom,bearing:C.bearing+u*this._bearingStep,pitch:C.pitch+p*this._pitchStep,offset:[-g*this._panStep,-v*this._panStep],center:C.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ic(m){return m*(2-m)}let Qu=4.000244140625;class Ht{constructor(e,n){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new Sl(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,u=be.now(),p=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,n!==0&&n%Qu==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(p*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let n=G.mousePos(this._map.getCanvas(),e),u=this._tr;this._aroundPoint=this._aroundCenter?u.transform.locationToScreenPoint(s.Q.convert(u.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){let x=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=x),typeof this._targetZoom=="number"&&(this._targetZoom+=x)}if(this._delta!==0){let x=this._type==="wheel"&&Math.abs(this._delta)>Qu?this._wheelZoomRate:this._defaultZoomRate,C=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&C!==0&&(C=1/C);let I=typeof this._targetZoom!="number"?e.scale:s.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),s.ah(I*C)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,u=this._startZoom,p=this._easing,g,v=!1;if(this._type==="wheel"&&u&&p){let x=be.now()-this._lastWheelEventTime,C=Math.min((x+5)/200,1),I=p(C);g=s.B.number(u,n,I),C<1?this._frameId||(this._frameId=!0):v=!0}else g=n,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=g,{noInertia:!0,needsRenderFrame:!v,zoomDelta:g-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=s.cf;if(this._prevEase){let u=this._prevEase,p=(be.now()-u.start)/u.duration,g=u.easing(p+.01)-u.easing(p),v=.27/Math.sqrt(g*g+1e-4)*.01,x=Math.sqrt(.0729-v*v);n=s.cd(v,x,.25,1)}return this._prevEase={start:be.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class zd{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Dg{constructor(e){this._tr=new Sl(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ju{constructor(){this._tap=new Tl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,u){if(!this._swipePoint)if(this._tapTime){let p=n[0],g=e.timeStamp-this._tapTime<500,v=this._tapPoint.dist(p)<30;g&&v?u.length>0&&(this._swipePoint=p,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,n,u)}touchmove(e,n,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;let p=n[0],g=p.y-this._swipePoint.y;return this._swipePoint=p,e.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(e,n,u)}touchend(e,n,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{let p=this._tap.touchend(e,n,u);p&&(this._tapTime=e.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xp{constructor(e,n,u){this._el=e,this._mousePan=n,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yp{constructor(e,n,u,p){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=u,this._mouseRoll=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class eh{constructor(e,n,u,p){this._el=e,this._touchZoom=n,this._touchRotate=u,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Bd{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=G.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),p=document.createElement("div");p.className="maplibregl-desktop-message",p.textContent=n,this._container.appendChild(p);let g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=u,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(G.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let Pc=m=>m.zoom||m.drag||m.roll||m.pitch||m.rotate;class Rg extends s.l{}function Nd(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta||m.rollDelta}class Og{constructor(e,n){this.handleWindowEvent=p=>{this.handleEvent(p,`${p.type}Window`)},this.handleEvent=(p,g)=>{if(p.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let v=p.type==="renderFrame"?void 0:p,x={needsRenderFrame:!1},C={},I={};for(let{handlerName:D,handler:N,allowed:j}of this._handlers){if(!N.isEnabled())continue;let ee;if(this._blockedByActive(I,j,D))N.reset();else if(N[g||p.type]){if(s.cg(p,g||p.type)){let J=G.mousePos(this._map.getCanvas(),p);ee=N[g||p.type](p,J)}else if(s.ch(p,g||p.type)){let J=this._getMapTouches(p.touches),te=G.touchPos(this._map.getCanvas(),J);ee=N[g||p.type](p,te,J)}else s.ci(g||p.type)||(ee=N[g||p.type](p));this.mergeHandlerResult(x,C,ee,D,v),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()}(ee||N.isActive())&&(I[D]=N)}let k={};for(let D in this._previousActiveHandlers)I[D]||(k[D]=v);this._previousActiveHandlers=I,(Object.keys(k).length||Nd(x))&&(this._changes.push([x,C,k]),this._triggerRenderFrame()),(Object.keys(I).length||Nd(x))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:R}=x;R&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],R(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new $p(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);let u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(let[p,g,v]of this._listeners)G.addEventListener(p,g,p===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(let[e,n,u]of this._listeners)G.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){let n=this._map,u=n.getCanvasContainer();this._add("mapEvent",new Gp(n,e));let p=n.boxZoom=new Xu(n,e);this._add("boxZoom",p),e.interactive&&e.boxZoom&&p.enable();let g=n.cooperativeGestures=new Bd(n,e.cooperativeGestures);this._add("cooperativeGestures",g),e.cooperativeGestures&&g.enable();let v=new qp(n),x=new Dg(n);n.doubleClickZoom=new zd(x,v),this._add("tapZoom",v),this._add("clickZoom",x),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();let C=new Ju;this._add("tapDragZoom",C);let I=n.touchPitch=new Ld(n);this._add("touchPitch",I),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);let k=()=>n.project(n.getCenter()),R=function({enable:ce,clickTolerance:ue,aroundCenter:ge=!0,minPixelCenterThreshold:he=100,rotateDegreesPerPixelMoved:Se=.8},Le){let ke=new El({checkCorrectEvent:Ae=>G.mouseButton(Ae)===0&&Ae.ctrlKey||G.mouseButton(Ae)===2&&!Ae.ctrlKey});return new ir({clickTolerance:ue,move:(Ae,Re)=>{let Ke=Le();if(ge&&Math.abs(Ke.y-Ae.y)>he)return{bearingDelta:s.ce(new s.P(Ae.x,Re.y),Re,Ke)};let Xe=(Re.x-Ae.x)*Se;return ge&&Re.y<Ke.y&&(Xe=-Xe),{bearingDelta:Xe}},moveStateManager:ke,enable:ce,assignEvents:Rd})}(e,k),D=function({enable:ce,clickTolerance:ue,pitchDegreesPerPixelMoved:ge=-.5}){let he=new El({checkCorrectEvent:Se=>G.mouseButton(Se)===0&&Se.ctrlKey||G.mouseButton(Se)===2});return new ir({clickTolerance:ue,move:(Se,Le)=>({pitchDelta:(Le.y-Se.y)*ge}),moveStateManager:he,enable:ce,assignEvents:Rd})}(e),N=function({enable:ce,clickTolerance:ue,rollDegreesPerPixelMoved:ge=.3},he){let Se=new El({checkCorrectEvent:Le=>G.mouseButton(Le)===2&&Le.ctrlKey});return new ir({clickTolerance:ue,move:(Le,ke)=>{let Ae=he(),Re=(ke.x-Le.x)*ge;return ke.y<Ae.y&&(Re=-Re),{rollDelta:Re}},moveStateManager:Se,enable:ce,assignEvents:Rd})}(e,k);n.dragRotate=new Yp(e,R,D,N),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",D,["mouseRotate","mouseRoll"]),this._add("mouseRoll",N,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();let j=function({enable:ce,clickTolerance:ue}){let ge=new El({checkCorrectEvent:he=>G.mouseButton(he)===0&&!he.ctrlKey});return new ir({clickTolerance:ue,move:(he,Se)=>({around:Se,panDelta:Se.sub(he)}),activateOnStart:!0,moveStateManager:ge,enable:ce,assignEvents:Rd})}(e),ee=new Ag(e,n);n.dragPan=new Xp(u,j,ee),this._add("mousePan",j),this._add("touchPan",ee,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);let J=new tt,te=new Pl;n.touchZoomRotate=new eh(u,te,J,C),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);let re=n.scrollZoom=new Ht(n,()=>this._triggerRenderFrame());this._add("scrollZoom",re,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);let de=n.keyboard=new kl(n);this._add("keyboard",de),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new Hp(n))}_add(e,n,u){this._handlers.push({handlerName:e,handler:n,allowed:u}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(let{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Pc(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,u){for(let p in e)if(p!==u&&(!n||n.indexOf(p)<0))return!0;return!1}_getMapTouches(e){let n=[];for(let u of e)this._el.contains(u.target)&&n.push(u);return n}mergeHandlerResult(e,n,u,p,g){if(!u)return;s.e(e,u);let v={handlerName:p,originalEvent:u.originalEvent||g};u.zoomDelta!==void 0&&(n.zoom=v),u.panDelta!==void 0&&(n.drag=v),u.rollDelta!==void 0&&(n.roll=v),u.pitchDelta!==void 0&&(n.pitch=v),u.bearingDelta!==void 0&&(n.rotate=v)}_applyChanges(){let e={},n={},u={};for(let[p,g,v]of this._changes)p.panDelta&&(e.panDelta=(e.panDelta||new s.P(0,0))._add(p.panDelta)),p.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+p.pitchDelta),p.rollDelta&&(e.rollDelta=(e.rollDelta||0)+p.rollDelta),p.around!==void 0&&(e.around=p.around),p.pinchAround!==void 0&&(e.pinchAround=p.pinchAround),p.noInertia&&(e.noInertia=p.noInertia),s.e(n,g),s.e(u,v);this._updateMapTransform(e,n,u),this._changes=[]}_updateMapTransform(e,n,u){let p=this._map,g=p._getTransformForUpdate(),v=p.terrain;if(!(Nd(e)||v&&this._terrainMovement))return this._fireEvents(n,u,!0);p._stop(!0);let{panDelta:x,zoomDelta:C,bearingDelta:I,pitchDelta:k,rollDelta:R,around:D,pinchAround:N}=e;N!==void 0&&(D=N),D=D||p.transform.centerPoint,v&&!g.isPointOnMapSurface(D)&&(D=g.centerPoint);let j={panDelta:x,zoomDelta:C,rollDelta:R,pitchDelta:k,bearingDelta:I,around:D};this._map.cameraHelper.useGlobeControls&&!g.isPointOnMapSurface(D)&&(D=g.centerPoint);let ee=D.distSqr(g.centerPoint)<.01?g.center:g.screenPointToLocation(x?D.sub(x):D);v?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(j,g),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(x))):this._map.cameraHelper.handleMapControlsPan(j,g,ee):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(j,g,ee))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(j,g),this._map.cameraHelper.handleMapControlsPan(j,g,ee)),p._applyUpdatedTransform(g),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,u,!0)}_fireEvents(e,n,u){let p=Pc(this._eventsInProgress),g=Pc(e),v={};for(let R in e){let{originalEvent:D}=e[R];this._eventsInProgress[R]||(v[`${R}start`]=D),this._eventsInProgress[R]=e[R]}!p&&g&&this._fireEvent("movestart",g.originalEvent);for(let R in v)this._fireEvent(R,v[R]);g&&this._fireEvent("move",g.originalEvent);for(let R in e){let{originalEvent:D}=e[R];this._fireEvent(R,D)}let x={},C;for(let R in this._eventsInProgress){let{handlerName:D,originalEvent:N}=this._eventsInProgress[R];this._handlersById[D].isActive()||(delete this._eventsInProgress[R],C=n[D]||N,x[`${R}end`]=C)}for(let R in x)this._fireEvent(R,x[R]);let I=Pc(this._eventsInProgress),k=(p||g)&&!I;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let R=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&R.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(R)}if(u&&k){this._updatingCamera=!0;let R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),D=N=>N!==0&&-this._bearingSnap<N&&N<this._bearingSnap;!R||!R.essential&&be.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:C})),D(this._map.getBearing())&&this._map.resetNorth()):(D(R.bearing||this._map.getBearing())&&(R.bearing=0),R.freezeElevation=!0,this._map.easeTo(R,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new s.l(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Rg("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Fg extends s.E{constructor(e,n,u){super(),this._renderFrameCallback=()=>{let p=Math.min((be.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=u.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new s.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,u){return e=s.P.convert(e).mult(-1),this.panTo(this.transform.center,s.e({offset:e},n),u)}panTo(e,n,u){return this.easeTo(s.e({center:e},n),u)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,u){return this.easeTo(s.e({zoom:e},n),u)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new s.l("movestart",n)).fire(new s.l("move",n)).fire(new s.l("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,u){return this.easeTo(s.e({bearing:e},n),u)}resetNorth(e,n){return this.rotateTo(0,s.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=gi.convert(e).adjustAntiMeridian();let u=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,n)}_cameraForBoxAndBearing(e,n,u,p){let g={top:0,bottom:0,right:0,left:0};if(typeof(p=s.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){let I=p.padding;p.padding={top:I,bottom:I,right:I,left:I}}let v=s.e(g,p.padding);p.padding=v;let x=this.transform,C=new gi(e,n);return this.cameraHelper.cameraForBoxAndBearing(p,v,C,u,x)}fitBounds(e,n,u){return this._fitInternal(this.cameraForBounds(e,n),n,u)}fitScreenCoordinates(e,n,u,p,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(e)),this.transform.screenPointToLocation(s.P.convert(n)),u,p),p,g)}_fitInternal(e,n,u){return e?(delete(n=s.e(e,n)).padding,n.linear?this.easeTo(n,u):this.flyTo(n,u)):this}jumpTo(e,n){this.stop();let u=this._getTransformForUpdate(),p=!1,g=!1,v=!1,x=u.zoom;this.cameraHelper.handleJumpToCenterZoom(u,e);let C=u.zoom!==x;return"elevation"in e&&u.elevation!==+e.elevation&&u.setElevation(+e.elevation),"bearing"in e&&u.bearing!==+e.bearing&&(p=!0,u.setBearing(+e.bearing)),"pitch"in e&&u.pitch!==+e.pitch&&(g=!0,u.setPitch(+e.pitch)),"roll"in e&&u.roll!==+e.roll&&(v=!0,u.setRoll(+e.roll)),e.padding==null||u.isPaddingEqual(e.padding)||u.setPadding(e.padding),this._applyUpdatedTransform(u),this.fire(new s.l("movestart",n)).fire(new s.l("move",n)),C&&this.fire(new s.l("zoomstart",n)).fire(new s.l("zoom",n)).fire(new s.l("zoomend",n)),p&&this.fire(new s.l("rotatestart",n)).fire(new s.l("rotate",n)).fire(new s.l("rotateend",n)),g&&this.fire(new s.l("pitchstart",n)).fire(new s.l("pitch",n)).fire(new s.l("pitchend",n)),v&&this.fire(new s.l("rollstart",n)).fire(new s.l("roll",n)).fire(new s.l("rollend",n)),this.fire(new s.l("moveend",n))}calculateCameraOptionsFromTo(e,n,u,p=0){let g=s.$.fromLngLat(e,n),v=s.$.fromLngLat(u,p),x=v.x-g.x,C=v.y-g.y,I=v.z-g.z,k=Math.hypot(x,C,I);if(k===0)throw new Error("Can't calculate camera options with same From and To");let R=Math.hypot(x,C),D=s.ah(this.transform.cameraToCenterDistance/k/this.transform.tileSize),N=180*Math.atan2(x,-C)/Math.PI,j=180*Math.acos(R/k)/Math.PI;return j=I<0?90-j:90+j,{center:v.toLngLat(),elevation:p,zoom:D,pitch:j,bearing:N}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,u,p,g){let v=this.transform.calculateCenterFromCameraLngLatAlt(e,n,u,p);return{center:v.center,elevation:v.elevation,zoom:v.zoom,bearing:u,pitch:p,roll:g}}easeTo(e,n){this._stop(!1,e.easeId),((e=s.e({offset:[0,0],duration:500,easing:s.cf},e)).animate===!1||!e.essential&&be.prefersReducedMotion)&&(e.duration=0);let u=this._getTransformForUpdate(),p=this.getBearing(),g=u.pitch,v=u.roll,x="bearing"in e?this._normalizeBearing(e.bearing,p):p,C="pitch"in e?+e.pitch:g,I="roll"in e?this._normalizeBearing(e.roll,v):v,k="padding"in e?e.padding:u.padding,R=s.P.convert(e.offset),D,N;e.around&&(D=s.Q.convert(e.around),N=u.locationToScreenPoint(D));let j={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ee=this.cameraHelper.handleEaseTo(u,{bearing:x,pitch:C,roll:I,padding:k,around:D,aroundPoint:N,offsetAsPoint:R,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||p!==x,this._pitching=this._pitching||C!==g,this._rolling=this._rolling||I!==v,this._padding=!u.isPaddingEqual(k),this._zooming=this._zooming||ee.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,j),this.terrain&&this._prepareElevation(ee.elevationCenter),this._ease(J=>{ee.easeFunc(J),this.terrain&&!e.freezeElevation&&this._updateElevation(J),this._applyUpdatedTransform(u),this._fireMoveEvents(n)},J=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,J)},e),this}_prepareEase(e,n,u={}){this._moving=!0,n||u.moving||this.fire(new s.l("movestart",e)),this._zooming&&!u.zooming&&this.fire(new s.l("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new s.l("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new s.l("pitchstart",e)),this._rolling&&!u.rolling&&this.fire(new s.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));let n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){let u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(n-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(s.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};let n=e.getCameraLngLat(),u=e.getCameraAltitude(),p=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(u<p){let g=this.calculateCameraOptionsFromTo(n,p,e.center,e.elevation);return{pitch:g.pitch,zoom:g.zoom}}return{}}_applyUpdatedTransform(e){let n=[];if(n.push(p=>this._elevateCameraIfInsideTerrain(p)),this.transformCameraUpdate&&n.push(p=>this.transformCameraUpdate(p)),!n.length)return;let u=e.clone();for(let p of n){let g=u.clone(),{center:v,zoom:x,roll:C,pitch:I,bearing:k,elevation:R}=p(g);v&&g.setCenter(v),R!==void 0&&g.setElevation(R),x!==void 0&&g.setZoom(x),C!==void 0&&g.setRoll(C),I!==void 0&&g.setPitch(I),k!==void 0&&g.setBearing(k),u.apply(g)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new s.l("move",e)),this._zooming&&this.fire(new s.l("zoom",e)),this._rotating&&this.fire(new s.l("rotate",e)),this._pitching&&this.fire(new s.l("pitch",e)),this._rolling&&this.fire(new s.l("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;let u=this._zooming,p=this._rotating,g=this._pitching,v=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,u&&this.fire(new s.l("zoomend",e)),p&&this.fire(new s.l("rotateend",e)),g&&this.fire(new s.l("pitchend",e)),v&&this.fire(new s.l("rollend",e)),this.fire(new s.l("moveend",e))}flyTo(e,n){if(!e.essential&&be.prefersReducedMotion){let Re=s.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Re,n)}this.stop(),e=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cf},e);let u=this._getTransformForUpdate(),p=u.bearing,g=u.pitch,v=u.roll,x=u.padding,C="bearing"in e?this._normalizeBearing(e.bearing,p):p,I="pitch"in e?+e.pitch:g,k="roll"in e?this._normalizeBearing(e.roll,v):v,R="padding"in e?e.padding:u.padding,D=s.P.convert(e.offset),N=u.centerPoint.add(D),j=u.screenPointToLocation(N),ee=this.cameraHelper.handleFlyTo(u,{bearing:C,pitch:I,roll:k,padding:R,locationAtOffset:j,offsetAsPoint:D,center:e.center,minZoom:e.minZoom,zoom:e.zoom}),J=e.curve,te=Math.max(u.width,u.height),re=te/ee.scaleOfZoom,de=ee.pixelPathLength;typeof ee.scaleOfMinZoom=="number"&&(J=Math.sqrt(te/ee.scaleOfMinZoom/de*2));let ce=J*J;function ue(Re){let Ke=(re*re-te*te+(Re?-1:1)*ce*ce*de*de)/(2*(Re?re:te)*ce*de);return Math.log(Math.sqrt(Ke*Ke+1)-Ke)}function ge(Re){return(Math.exp(Re)-Math.exp(-Re))/2}function he(Re){return(Math.exp(Re)+Math.exp(-Re))/2}let Se=ue(!1),Le=function(Re){return he(Se)/he(Se+J*Re)},ke=function(Re){return te*((he(Se)*(ge(Ke=Se+J*Re)/he(Ke))-ge(Se))/ce)/de;var Ke},Ae=(ue(!0)-Se)/J;if(Math.abs(de)<2e-6||!isFinite(Ae)){if(Math.abs(te-re)<1e-6)return this.easeTo(e,n);let Re=re<te?-1:1;Ae=Math.abs(Math.log(re/te))/J,ke=()=>0,Le=Ke=>Math.exp(Re*J*Ke)}return e.duration="duration"in e?+e.duration:1e3*Ae/("screenSpeed"in e?+e.screenSpeed/J:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=p!==C,this._pitching=I!==g,this._rolling=k!==v,this._padding=!u.isPaddingEqual(R),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(ee.targetCenter),this._ease(Re=>{let Ke=Re*Ae,Xe=1/Le(Ke),Ue=ke(Ke);this._rotating&&u.setBearing(s.B.number(p,C,Re)),this._pitching&&u.setPitch(s.B.number(g,I,Re)),this._rolling&&u.setRoll(s.B.number(v,k,Re)),this._padding&&(u.interpolatePadding(x,R,Re),N=u.centerPoint.add(D)),ee.easeFunc(Re,Xe,Ue,N),this.terrain&&!e.freezeElevation&&this._updateElevation(Re),this._applyUpdatedTransform(u),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,n)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,n,u){u.animate===!1||u.duration===0?(e(1),n()):(this._easeStart=be.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=s.aL(e,-180,180);let u=Math.abs(e-n);return Math.abs(e-360-n)<u&&(e-=360),Math.abs(e+360-n)<u&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(s.Q.convert(e),this.transform.tileZoom):null}}let hs={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ri{constructor(e=hs){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=G.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=G.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,n){let u=this._map._getUIString(`AttributionControl.${n}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}let n=this._map.style.sourceCaches;for(let p in n){let g=n[p];if(g.used||g.usedForTerrain){let v=g.getSource();v.attribution&&e.indexOf(v.attribution)<0&&e.push(v.attribution)}}e=e.filter(p=>String(p).trim()),e.sort((p,g)=>p.length-g.length),e=e.filter((p,g)=>{for(let v=g+1;v<e.length;v++)if(e[v].indexOf(p)>=0)return!1;return!0});let u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=G.sanitize(u),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class kc{constructor(e={}){this._updateCompact=()=>{let n=this._container.children;if(n.length){let u=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=G.create("div","maplibregl-ctrl");let n=G.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){G.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class th{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){let n=this._currentlyRunning,u=n?this._queue.concat(n):this._queue;for(let p of u)if(p.id===e)return void(p.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let n=this._currentlyRunning=this._queue;this._queue=[];for(let u of n)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Kp=s.aG([{name:"a_pos3d",type:"Int16",components:3}]);class Qp extends s.E{constructor(e){super(),this._lastTilesetChange=be.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];let u={};for(let p of ye(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))u[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.terrainRttPosMatrix32f=new Float64Array(16),s.bQ(p.terrainRttPosMatrix32f,0,s.Z,s.Z,0,0,1),this._tiles[p.key]=new kr(p,this.tileSize),this._lastTilesetChange=be.now());for(let p in this._tiles)u[p]||delete this._tiles[p]}freeRtt(e){for(let n in this._tiles){let u=this._tiles[n];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,n){return n?this._getTerrainCoordsForTileRanges(e,n):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){let n={};for(let u of this._renderableTilesKeys){let p=this._tiles[u].tileID,g=e.clone(),v=s.b2();if(p.canonical.equals(e.canonical))s.bQ(v,0,s.Z,s.Z,0,0,1);else if(p.canonical.isChildOf(e.canonical)){let x=p.canonical.z-e.canonical.z,C=p.canonical.x-(p.canonical.x>>x<<x),I=p.canonical.y-(p.canonical.y>>x<<x),k=s.Z>>x;s.bQ(v,0,k,k,0,0,1),s.L(v,v,[-C*k,-I*k,0])}else{if(!e.canonical.isChildOf(p.canonical))continue;{let x=e.canonical.z-p.canonical.z,C=e.canonical.x-(e.canonical.x>>x<<x),I=e.canonical.y-(e.canonical.y>>x<<x),k=s.Z>>x;s.bQ(v,0,s.Z,s.Z,0,0,1),s.L(v,v,[C*k,I*k,0]),s.M(v,v,[1/2**x,1/2**x,0])}}g.terrainRttPosMatrix32f=new Float32Array(v),n[u]=g}return n}_getTerrainCoordsForTileRanges(e,n){let u={};for(let p of this._renderableTilesKeys){let g=this._tiles[p].tileID;if(!this._isWithinTileRanges(g,n))continue;let v=e.clone(),x=s.b2();if(g.canonical.z===e.canonical.z){let C=e.canonical.x-g.canonical.x,I=e.canonical.y-g.canonical.y;s.bQ(x,0,s.Z,s.Z,0,0,1),s.L(x,x,[C*s.Z,I*s.Z,0])}else if(g.canonical.z>e.canonical.z){let C=g.canonical.z-e.canonical.z,I=g.canonical.x-(g.canonical.x>>C<<C),k=g.canonical.y-(g.canonical.y>>C<<C),R=e.canonical.x-(g.canonical.x>>C),D=e.canonical.y-(g.canonical.y>>C),N=s.Z>>C;s.bQ(x,0,N,N,0,0,1),s.L(x,x,[-I*N+R*s.Z,-k*N+D*s.Z,0])}else{let C=e.canonical.z-g.canonical.z,I=e.canonical.x-(e.canonical.x>>C<<C),k=e.canonical.y-(e.canonical.y>>C<<C),R=(e.canonical.x>>C)-g.canonical.x,D=(e.canonical.y>>C)-g.canonical.y,N=s.Z<<C;s.bQ(x,0,N,N,0,0,1),s.L(x,x,[I*s.Z+R*N,k*s.Z+D*N,0])}v.terrainRttPosMatrix32f=new Float32Array(x),u[p]=v}return u}getSourceTile(e,n){let u=this.sourceCache._source,p=e.overscaledZ-this.deltaZoom;if(p>u.maxzoom&&(p=u.maxzoom),p<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(p).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!g||!g.dem)&&n)for(;p>=u.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(e.scaledTo(p--).key);return g}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,n){return n[e.canonical.z]&&e.canonical.x>=n[e.canonical.z].minTileX&&e.canonical.x<=n[e.canonical.z].maxTileX&&e.canonical.y>=n[e.canonical.z].minTileY&&e.canonical.y<=n[e.canonical.z].maxTileY}}class Jp{constructor(e,n,u){this._meshCache={},this.painter=e,this.sourceCache=new Qp(n),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,u,p=s.Z){var g;if(!(n>=0&&n<p&&u>=0&&u<p))return 0;let v=this.getTerrainData(e),x=(g=v.tile)===null||g===void 0?void 0:g.dem;if(!x)return 0;let C=s.cj([],[n/p*s.Z,u/p*s.Z],v.u_terrain_matrix),I=[C[0]*x.dim,C[1]*x.dim],k=Math.floor(I[0]),R=Math.floor(I[1]),D=I[0]-k,N=I[1]-R;return x.get(k,R)*(1-D)*(1-N)+x.get(k+1,R)*D*(1-N)+x.get(k,R+1)*(1-D)*N+x.get(k+1,R+1)*D*N}getElevationForLngLatZoom(e,n){if(!s.ck(n,e.wrap()))return 0;let{tileID:u,mercatorX:p,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(u,p%s.Z,g%s.Z,s.Z)}getElevation(e,n,u,p=s.Z){return this.getDEMElevation(e,n,u,p)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let p=this.painter.context,g=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new li(p,g,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new li(p,new s.R({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ad([])}let n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){let p=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new li(p,n.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),n.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}let u=n&&n+n.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){let p=this.sourceCache.sourceCache._source.maxzoom,g=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=p?g=e.canonical.z-p:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let v=e.canonical.x-(e.canonical.x>>g<<g),x=e.canonical.y-(e.canonical.y>>g<<g),C=s.cl(new Float64Array(16),[1/(s.Z<<g),1/(s.Z<<g),0]);s.L(C,C,[v*s.Z,x*s.Z,0]),this._demMatrixCache[e.key]={matrix:C,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){let n=this.painter,u=n.width/devicePixelRatio,p=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new li(n.context,{width:u,height:p,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new li(n.context,{width:u,height:p,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(u,p,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,u,p))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,v=0;g<this._coordsTextureSize;g++)for(let x=0;x<this._coordsTextureSize;x++,v+=4)n[v+0]=255&x,n[v+1]=255&g,n[v+2]=x>>8<<4|g>>8,n[v+3]=0;let u=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),p=new li(e,u,e.gl.RGBA,{premultiply:!1});return p.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let n=new Uint8Array(4),u=this.painter.context,p=u.gl,g=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),v=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),x=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(g,x-v-1,1,1,p.RGBA,p.UNSIGNED_BYTE,n),u.bindFramebuffer.set(null);let C=n[0]+(n[2]>>4<<8),I=n[1]+((15&n[2])<<8),k=this.coordsIndex[255-n[3]],R=k&&this.sourceCache.getTileByID(k);if(!R)return null;let D=this._coordsTextureSize,N=(1<<R.tileID.canonical.z)*D;return new s.$((R.tileID.canonical.x*D+C)/N+R.tileID.wrap,(R.tileID.canonical.y*D+I)/N,this.getElevation(R.tileID,C,I,D))}depthAtPoint(e){let n=new Uint8Array(4),u=this.painter.context,p=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),p.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,n),u.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;let u=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,p=u&&e.canonical.y===0,g=u&&e.canonical.y===(1<<e.canonical.z)-1,v=`m_${p?"n":""}_${g?"s":""}`;if(this._meshCache[v])return this._meshCache[v];let x=this.painter.context,C=new s.cm,I=new s.aK,k=this.meshSize,R=s.Z/k,D=k*k;for(let he=0;he<=k;he++)for(let Se=0;Se<=k;Se++)C.emplaceBack(Se*R,he*R,0);for(let he=0;he<D;he+=k+1)for(let Se=0;Se<k;Se++)I.emplaceBack(Se+he,k+Se+he+1,k+Se+he+2),I.emplaceBack(Se+he,k+Se+he+2,Se+he+1);let N=C.length,j=N+(k+1),ee=(k+1)*k,J=p?s.b9:0,te=p?0:1,re=g?s.ba:s.Z,de=g?0:1;for(let he=0;he<=k;he++)C.emplaceBack(he*R,J,te);for(let he=0;he<=k;he++)C.emplaceBack(he*R,re,de);for(let he=0;he<k;he++)I.emplaceBack(ee+he,j+he,j+he+1),I.emplaceBack(ee+he,j+he+1,ee+he+1),I.emplaceBack(0+he,N+he+1,N+he),I.emplaceBack(0+he,0+he+1,N+he+1);let ce=C.length,ue=ce+2*(k+1);for(let he of[0,1])for(let Se=0;Se<=k;Se++)for(let Le of[0,1])C.emplaceBack(he*s.Z,Se*R,Le);for(let he=0;he<2*k;he+=2)I.emplaceBack(ce+he,ce+he+1,ce+he+3),I.emplaceBack(ce+he,ce+he+3,ce+he+2),I.emplaceBack(ue+he,ue+he+3,ue+he+1),I.emplaceBack(ue+he,ue+he+2,ue+he+3);let ge=new ks(x.createVertexBuffer(C,Kp.members),x.createIndexBuffer(I),s.aJ.simpleSegment(0,0,C.length,I.length));return this._meshCache[v]=ge,ge}getMeshFrameDelta(e){return 2*Math.PI*s.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var u;let{tileID:p}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(u=this.getMinMaxElevation(p).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){let n=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return n&&n.dem&&(u.minElevation=n.dem.min*this.exaggeration,u.maxElevation=n.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,n){let u=s.$.fromLngLat(e.wrap()),p=(1<<n)*s.Z,g=u.x*p,v=u.y*p,x=Math.floor(g/s.Z),C=Math.floor(v/s.Z);return{tileID:new s.Y(n,0,n,x,C),mercatorX:g,mercatorY:v}}}class Lg{constructor(e,n,u){this._context=e,this._size=n,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new li(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(u.texture),{id:e,fbo:n,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}let hr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Vd{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new Lg(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(n)),this._coordsAscending={};for(let u in e.sourceCaches){this._coordsAscending[u]={};let p=e.sourceCaches[u].getVisibleCoordinates(),g=e.sourceCaches[u].getSource(),v=g instanceof Rn?g.terrainTileRanges:null;for(let x of p){let C=this.terrain.sourceCache.getTerrainCoords(x,v);for(let I in C)this._coordsAscending[u][I]||(this._coordsAscending[u][I]=[]),this._coordsAscending[u][I].push(C[I])}}this._coordsAscendingStr={};for(let u of e._order){let p=e._layers[u],g=p.source;if(hr[p.type]&&!this._coordsAscendingStr[g]){this._coordsAscendingStr[g]={};for(let v in this._coordsAscending[g])this._coordsAscendingStr[g][v]=this._coordsAscending[g][v].map(x=>x.key).sort().join()}}for(let u of this._renderableTiles)for(let p in this._coordsAscendingStr){let g=this._coordsAscendingStr[p][u.tileID.key];g&&g!==u.rttCoords[p]&&(u.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;let u=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),p=e.type,g=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(hr[p]&&(this._prevType&&hr[this._prevType]||this._stacks.push([]),this._prevType=p,this._stacks[this._stacks.length-1].push(e.id),!v))return!0;if(hr[this._prevType]||hr[p]&&v){this._prevType=p;let x=this._stacks.length-1,C=this._stacks[x]||[];for(let I of this._renderableTiles){if(this.pool.isFull()&&(Jt(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[x]){let R=this.pool.getObjectForId(I.rtt[x].id);if(R.stamp===I.rtt[x].stamp){this.pool.useObject(R);continue}}let k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),I.rtt[x]={id:k.id,stamp:k.stamp},g.context.bindFramebuffer.set(k.fbo.framebuffer),g.context.clear({color:s.b7.transparent,stencil:0}),g.currentStencilSource=void 0;for(let R=0;R<C.length;R++){let D=g.style._layers[C[R]],N=D.source?this._coordsAscending[D.source][I.tileID.key]:[I.tileID];g.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),g._renderTileClippingMasks(D,N,!0),g.renderLayer(g,g.style.sourceCaches[D.source],D,N,u),D.source&&(I.rttCoords[D.source]=this._coordsAscendingStr[D.source][I.tileID.key])}}return Jt(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects(),hr[p]}return!1}}let dt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},vt=T,Ac={hash:!1,interactive:!0,bearingSnap:7,attributionControl:hs,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ih={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class nh{constructor(e,n,u=!1){this.mousedown=g=>{this.startMove(g,G.mousePos(this.element,g)),G.addEventListener(window,"mousemove",this.mousemove),G.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=g=>{this.move(g,G.mousePos(this.element,g))},this.mouseup=g=>{this._rotatePitchHanlder.dragEnd(g),this.offTemp()},this.touchstart=g=>{g.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,g.targetTouches)[0],this.startMove(g,this._startPos),G.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.addEventListener(window,"touchend",this.touchend))},this.touchmove=g=>{g.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,g.targetTouches)[0],this.move(g,this._lastPos))},this.touchend=g=>{g.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;let p=new Il;this._rotatePitchHanlder=new ir({clickTolerance:3,move:(g,v)=>{let x=n.getBoundingClientRect(),C=new s.P((x.bottom-x.top)/2,(x.right-x.left)/2);return{bearingDelta:s.ce(new s.P(g.x,v.y),v,C),pitchDelta:u?-.5*(v.y-g.y):void 0}},moveStateManager:p,enable:!0,assignEvents:()=>{}}),this.map=e,G.addEventListener(n,"mousedown",this.mousedown),G.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),G.disableDrag()}move(e,n){let u=this.map,{bearingDelta:p,pitchDelta:g}=this._rotatePitchHanlder.dragMove(e,n)||{};p&&u.setBearing(u.getBearing()+p),g&&u.setPitch(u.getPitch()+g)}off(){let e=this.element;G.removeEventListener(e,"mousedown",this.mousedown),G.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend),G.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){G.enableDrag(),G.removeEventListener(window,"mousemove",this.mousemove),G.removeEventListener(window,"mouseup",this.mouseup),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend)}}let mn;function rh(m,e,n,u=!1){if(u||!n.getCoveringTilesDetailsProvider().allowWorldCopies())return m?.wrap();let p=new s.Q(m.lng,m.lat);if(m=new s.Q(m.lng,m.lat),e){let g=new s.Q(m.lng-360,m.lat),v=new s.Q(m.lng+360,m.lat),x=n.locationToScreenPoint(m).distSqr(e);n.locationToScreenPoint(g).distSqr(e)<x?m=g:n.locationToScreenPoint(v).distSqr(e)<x&&(m=v)}for(;Math.abs(m.lng-n.center.lng)>180;){let g=n.locationToScreenPoint(m);if(g.x>=0&&g.y>=0&&g.x<=n.width&&g.y<=n.height)break;m.lng>n.center.lng?m.lng-=360:m.lng+=360}return m.lng!==p.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(m))?m:p}let Qr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ef(m,e,n){let u=m.classList;for(let p in Qr)u.remove(`maplibregl-${n}-anchor-${p}`);u.add(`maplibregl-${n}-anchor-${e}`)}class Oa extends s.E{constructor(e){if(super(),this._onKeyPress=n=>{let u=n.code,p=n.charCode||n.keyCode;u!=="Space"&&u!=="Enter"&&p!==32&&p!==13||this.togglePopup()},this._onMapClick=n=>{let u=n.originalEvent.target,p=this._element;this._popup&&(u===p||p.contains(u))&&this.togglePopup()},this._update=n=>{if(!this._map)return;let u=this._map.loaded()&&!this._map.isMoving();(n?.type==="terrain"||n?.type==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=rh(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,`${Qr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${p}`),be.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){let u=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=s.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div");let n=G.createNS("http://www.w3.org/2000/svg","svg"),u=41,p=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${u}px`),n.setAttributeNS(null,"width",`${p}px`),n.setAttributeNS(null,"viewBox",`0 0 ${p} ${u}`);let g=G.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");let v=G.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");let x=G.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(3.0, 29.0)"),x.setAttributeNS(null,"fill","#000000");let C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let te of C){let re=G.createNS("http://www.w3.org/2000/svg","ellipse");re.setAttributeNS(null,"opacity","0.04"),re.setAttributeNS(null,"cx","10.5"),re.setAttributeNS(null,"cy","5.80029008"),re.setAttributeNS(null,"rx",te.rx),re.setAttributeNS(null,"ry",te.ry),x.appendChild(re)}let I=G.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill",this._color);let k=G.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),I.appendChild(k);let R=G.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");let D=G.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild(D);let N=G.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(6.0, 7.0)"),N.setAttributeNS(null,"fill","#FFFFFF");let j=G.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(8.0, 8.0)");let ee=G.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");let J=G.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#FFFFFF"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962"),j.appendChild(ee),j.appendChild(J),v.appendChild(x),v.appendChild(I),v.appendChild(R),v.appendChild(N),v.appendChild(j),n.appendChild(v),n.setAttributeNS(null,"height",u*this._scale+"px"),n.setAttributeNS(null,"width",p*this._scale+"px"),this._element.appendChild(n),this._offset=s.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),ef(this._element,this._anchor,"marker"),e&&e.className)for(let n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=s.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let p=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){let e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,u;let p=(n=this._map)===null||n===void 0?void 0:n.terrain,g=this._map.transform.isLocationOccluded(this._lngLat);if(!p||g){let N=g?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==N&&(this._element.style.opacity=N))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let v=this._map,x=v.terrain.depthAtPoint(this._pos),C=v.terrain.getElevationForLngLatZoom(this._lngLat,v.transform.tileZoom);if(v.transform.lngLatToCameraDepth(this._lngLat,C)-x<.006)return void(this._element.style.opacity=this._opacity);let I=-this._offset.y/v.transform.pixelsPerMeter,k=Math.sin(v.getPitch()*Math.PI/180)*I,R=v.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),D=v.transform.lngLatToCameraDepth(this._lngLat,C+k)-R>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&D&&this._popup.remove(),this._element.style.opacity=D?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=s.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return(this._opacity===void 0||e===void 0&&n===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}let Ki={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Hi=0,Al=!1,Dc={maxWidth:100,unit:"metric"};function Rc(m,e,n){let u=n&&n.maxWidth||100,p=m._container.clientHeight/2,g=m._container.clientWidth/2,v=m.unproject([g-u/2,p]),x=m.unproject([g+u/2,p]),C=Math.round(m.project(x).x-m.project(v).x),I=Math.min(u,C,m._container.clientWidth),k=v.distanceTo(x);if(n&&n.unit==="imperial"){let R=3.2808*k;R>5280?Fa(e,I,R/5280,m._getUIString("ScaleControl.Miles")):Fa(e,I,R,m._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Fa(e,I,k/1852,m._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Fa(e,I,k/1e3,m._getUIString("ScaleControl.Kilometers")):Fa(e,I,k,m._getUIString("ScaleControl.Meters"))}function Fa(m,e,n,u){let p=function(g){let v=Math.pow(10,`${Math.floor(g)}`.length-1),x=g/v;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:function(C){let I=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*I)/I}(x),v*x}(n);m.style.width=e*(p/n)+"px",m.innerHTML=`${p}&nbsp;${u}`}let oh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},sh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Dl(m){if(m){if(typeof m=="number"){let e=Math.round(Math.abs(m)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,m),"top-left":new s.P(e,e),"top-right":new s.P(-e,e),bottom:new s.P(0,-m),"bottom-left":new s.P(e,-e),"bottom-right":new s.P(-e,-e),left:new s.P(m,0),right:new s.P(-m,0)}}if(m instanceof s.P||Array.isArray(m)){let e=s.P.convert(m);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:s.P.convert(m.center||[0,0]),top:s.P.convert(m.top||[0,0]),"top-left":s.P.convert(m["top-left"]||[0,0]),"top-right":s.P.convert(m["top-right"]||[0,0]),bottom:s.P.convert(m.bottom||[0,0]),"bottom-left":s.P.convert(m["bottom-left"]||[0,0]),"bottom-right":s.P.convert(m["bottom-right"]||[0,0]),left:s.P.convert(m.left||[0,0]),right:s.P.convert(m.right||[0,0])}}return Dl(new s.P(0,0))}let ah=T;h.AJAXError=s.cq,h.Event=s.l,h.Evented=s.E,h.LngLat=s.Q,h.MercatorCoordinate=s.$,h.Point=s.P,h.addProtocol=s.cr,h.config=s.a,h.removeProtocol=s.cs,h.AttributionControl=Ri,h.BoxZoomHandler=Xu,h.CanvasSource=Ao,h.CooperativeGesturesHandler=Bd,h.DoubleClickZoomHandler=zd,h.DragPanHandler=Xp,h.DragRotateHandler=Yp,h.EdgeInsets=da,h.FullscreenControl=class extends s.E{constructor(m={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){G.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let m=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},h.GeoJSONSource=Mn,h.GeolocateControl=class extends s.E{constructor(m){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{let n=new s.Q(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,p=this._map.getBearing(),g=s.e({bearing:p},this.options.fitBoundsOptions),v=gi.fromLngLat(n,u);this._map.fitBounds(v,g,{geolocateSource:!0})},this._updateMarker=e=>{if(e){let n=new s.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Al)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");let n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{let n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Oa({element:this._dotElement}),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Oa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},Ki,m)}onAdd(m){return this._map=m,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(e=!1){if(mn!==void 0&&!e)return mn;if(window.navigator.permissions===void 0)return mn=!!window.navigator.geolocation,mn;try{mn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{mn=!!window.navigator.geolocation}return mn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Hi=0,Al=!1}_isOutOfMapMaxBounds(m){let e=this._map.getMaxBounds(),n=m.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let m=this._map.getBounds(),e=m.getSouthEast(),n=m.getNorthEast(),u=e.distanceTo(n),p=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Hi--,Al=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Hi++,Hi>1?(m={maximumAge:6e5,timeout:0},Al=!0):(m=this.options.positionOptions,Al=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},h.GlobeControl=class{constructor(){this._toggleProjection=()=>{var m;let e=(m=this._map.getProjection())===null||m===void 0?void 0:m.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var m;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((m=this._map.getProjection())===null||m===void 0?void 0:m.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(m){return this._map=m,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=G.create("button","maplibregl-ctrl-globe",this._container),G.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},h.Hash=Hu,h.ImageSource=Rn,h.KeyboardHandler=kl,h.LngLatBounds=gi,h.LogoControl=kc,h.Map=class extends Fg{constructor(m){var e,n;s.cn.mark(s.co.create);let u=Object.assign(Object.assign(Object.assign({},Ac),m),{canvasContextAttributes:Object.assign(Object.assign({},Ac.canvasContextAttributes),m.canvasContextAttributes)});if(u.minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");let p=new As,g=new ua;if(u.minZoom!==void 0&&p.setMinZoom(u.minZoom),u.maxZoom!==void 0&&p.setMaxZoom(u.maxZoom),u.minPitch!==void 0&&p.setMinPitch(u.minPitch),u.maxPitch!==void 0&&p.setMaxPitch(u.maxPitch),u.renderWorldCopies!==void 0&&p.setRenderWorldCopies(u.renderWorldCopies),super(p,g,{bearingSnap:u.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new th,this._controls=[],this._mapId=s.a4(),this._contextLost=x=>{x.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:x}))},this._contextRestored=x=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:x}))},this._onMapScroll=x=>{if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._maxTileCacheZoomLevels=u.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},u.canvasContextAttributes),this._trackResize=u.trackResize===!0,this._bearingSnap=u.bearingSnap,this._centerClampedToGround=u.centerClampedToGround,this._refreshExpiredTiles=u.refreshExpiredTiles===!0,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions===!0,this._collectResourceTiming=u.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},dt),u.locale),this._clickTolerance=u.clickTolerance,this._overridePixelRatio=u.pixelRatio,this._maxCanvasSize=u.maxCanvasSize,this.transformCameraUpdate=u.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=u.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=bi.addThrottleControl(()=>this.isMoving()),this._requestManager=new Et(u.transformRequest),typeof u.container=="string"){if(this._container=document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let x=!1,C=us(I=>{this._trackResize&&!this._removed&&(this.resize(I),this.redraw())},50);this._resizeObserver=new ResizeObserver(I=>{x?C(I):x=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Og(this,u),this._hash=u.hash&&new Hu(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,elevation:u.elevation,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,roll:u.roll}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,s.e({},u.fitBoundsOptions,{duration:0}))));let v=typeof u.style=="string"||((n=(e=u.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,v),this._localIdeographFontFamily=u.localIdeographFontFamily,this._validateStyle=u.validateStyle,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Ri(typeof u.attributionControl=="boolean"?void 0:u.attributionControl)),u.maplibreLogo&&this.addControl(new kc,u.logoPosition),this.on("style.load",()=>{if(v||this._resizeTransform(),this.transform.unmodified){let x=s.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(x)}}),this.on("data",x=>{this._update(x.dataType==="style"),this.fire(new s.l(`${x.dataType}data`,x))}),this.on("dataloading",x=>{this.fire(new s.l(`${x.dataType}dataloading`,x))}),this.on("dataabort",x=>{this.fire(new s.l("sourcedataabort",x))})}_getMapId(){return this._mapId}addControl(m,e){if(e===void 0&&(e=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let n=m.onAdd(this);this._controls.push(m);let u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(n,u.firstChild):u.appendChild(n),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let e=this._controls.indexOf(m);return e>-1&&this._controls.splice(e,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,e,n,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,e,n,u)}resize(m,e=!0){let[n,u]=this._containerDimensions(),p=this._getClampedPixelRatio(n,u);if(this._resizeCanvas(n,u,p),this.painter.resize(n,u,p),this.painter.overLimit()){let v=this.painter.context.gl;this._maxCanvasSize=[v.drawingBufferWidth,v.drawingBufferHeight];let x=this._getClampedPixelRatio(n,u);this._resizeCanvas(n,u,x),this.painter.resize(n,u,x)}this._resizeTransform(e);let g=!this._moving;return g&&(this.stop(),this.fire(new s.l("movestart",m)).fire(new s.l("move",m))),this.fire(new s.l("resize",m)),g&&this.fire(new s.l("moveend",m)),this}_resizeTransform(m=!0){var e;let[n,u]=this._containerDimensions();this.transform.resize(n,u,m),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,u,m)}_getClampedPixelRatio(m,e){let{0:n,1:u}=this._maxCanvasSize,p=this.getPixelRatio(),g=m*p,v=e*p;return Math.min(g>n?n/g:1,v>u?u/v:1)*p}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(gi.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.setMinZoom(m),this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.setMaxZoom(m),this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.setMinPitch(m),this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(m>=this.transform.minPitch)return this.transform.setMaxPitch(m),this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.setRenderWorldCopies(m),this._update()}project(m){return this.transform.locationToScreenPoint(s.Q.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.screenPointToLocation(s.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,e,n){if(m==="mouseenter"||m==="mouseover"){let u=!1;return{layers:e,listener:n,delegates:{mousemove:g=>{let v=e.filter(C=>this.getLayer(C)),x=v.length!==0?this.queryRenderedFeatures(g.point,{layers:v}):[];x.length?u||(u=!0,n.call(this,new Tn(m,this,g.originalEvent,{features:x}))):u=!1},mouseout:()=>{u=!1}}}}if(m==="mouseleave"||m==="mouseout"){let u=!1;return{layers:e,listener:n,delegates:{mousemove:v=>{let x=e.filter(C=>this.getLayer(C));(x.length!==0?this.queryRenderedFeatures(v.point,{layers:x}):[]).length?u=!0:u&&(u=!1,n.call(this,new Tn(m,this,v.originalEvent)))},mouseout:v=>{u&&(u=!1,n.call(this,new Tn(m,this,v.originalEvent)))}}}}{let u=p=>{let g=e.filter(x=>this.getLayer(x)),v=g.length!==0?this.queryRenderedFeatures(p.point,{layers:g}):[];v.length&&(p.features=v,n.call(this,p),delete p.features)};return{layers:e,listener:n,delegates:{[m]:u}}}}_saveDelegatedListener(m,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(e)}_removeDelegatedListener(m,e,n){if(!this._delegatedListeners||!this._delegatedListeners[m])return;let u=this._delegatedListeners[m];for(let p=0;p<u.length;p++){let g=u[p];if(g.listener===n&&g.layers.length===e.length&&g.layers.every(v=>e.includes(v))){for(let v in g.delegates)this.off(v,g.delegates[v]);return void u.splice(p,1)}}}on(m,e,n){if(n===void 0)return super.on(m,e);let u=typeof e=="string"?[e]:e,p=this._createDelegatedListener(m,u,n);this._saveDelegatedListener(m,p);for(let g in p.delegates)this.on(g,p.delegates[g]);return{unsubscribe:()=>{this._removeDelegatedListener(m,u,n)}}}once(m,e,n){if(n===void 0)return super.once(m,e);let u=typeof e=="string"?[e]:e,p=this._createDelegatedListener(m,u,n);for(let g in p.delegates){let v=p.delegates[g];p.delegates[g]=(...x)=>{this._removeDelegatedListener(m,u,n),v(...x)}}this._saveDelegatedListener(m,p);for(let g in p.delegates)this.once(g,p.delegates[g]);return this}off(m,e,n){return n===void 0?super.off(m,e):(this._removeDelegatedListener(m,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(m,e){if(!this.style)return[];let n,u=m instanceof s.P||Array.isArray(m),p=u?m:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:m)||{},p instanceof s.P||typeof p[0]=="number")n=[s.P.convert(p)];else{let g=s.P.convert(p[0]),v=s.P.convert(p[1]);n=[g,new s.P(v.x,g.y),v,new s.P(g.x,v.y),g]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(m,e){return this.style.querySourceFeatures(m,e)}setStyle(m,e){return(e=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(m,e))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){let e=this._locale[m];if(e==null)throw new Error(`Missing UI string '${m}'`);return e}_updateStyle(m,e){var n,u;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,e));let p=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new Rs(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,e,p):this.style.loadJSON(m,e,p),this):((u=(n=this.style)===null||n===void 0?void 0:n.projection)===null||u===void 0||u.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Rs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,e){if(typeof m=="string"){let n=this._requestManager.transformRequest(m,"Style");s.j(n,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new s.k(u))})}else typeof m=="object"&&this._updateDiff(m,e)}_updateDiff(m,e){try{this.style.setState(m,e)&&this._update(!0)}catch(n){s.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(m,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(m,e){return this._lazyInitEmptyStyle(),this.style.addSource(m,e),this._update(!0)}isSourceLoaded(m){let e=this.style&&this.style.sourceCaches[m];if(e!==void 0)return e.loaded();this.fire(new s.k(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){let e=this.style.sourceCaches[m.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&e.reload();for(let n in this.style._layers){let u=this.style._layers[n];u.type==="hillshade"&&u.source===m.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Jp(this.painter,e,m),this.painter.renderToTexture=new Vd(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{var u;n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==m.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((u=n.source)===null||u===void 0?void 0:u.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:m})),this}getTerrain(){var m,e;return(e=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&e!==void 0?e:null}areTilesLoaded(){let m=this.style&&this.style.sourceCaches;for(let e in m){let n=m[e]._tiles;for(let u in n){let p=n[u];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}setSourceTileLodParams(m,e,n){if(n){let u=this.getSource(n);if(!u)throw new Error(`There is no source with ID "${n}", cannot set LOD parameters`);u.calculateTileZoom=fe(Math.max(1,m),Math.max(1,e))}else for(let u in this.style.sourceCaches)this.style.sourceCaches[u].getSource().calculateTileZoom=fe(Math.max(1,m),Math.max(1,e));return this._update(!0),this}refreshTiles(m,e){let n=this.style.sourceCaches[m];if(!n)throw new Error(`There is no source cache with ID "${m}", cannot refresh tile`);e===void 0?n.reload():n.refreshTiles(e.map(u=>new s.a1(u.z,u.x,u.y)))}addImage(m,e,n={}){let{pixelRatio:u=1,sdf:p=!1,stretchX:g,stretchY:v,content:x,textFitWidth:C,textFitHeight:I}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||s.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:k,height:R,data:D}=e,N=e;return this.style.addImage(m,{data:new s.R({width:k,height:R},new Uint8Array(D)),pixelRatio:u,stretchX:g,stretchY:v,content:x,textFitWidth:C,textFitHeight:I,sdf:p,version:0,userImage:N}),N.onAdd&&N.onAdd(this,m),this}}{let{width:k,height:R,data:D}=be.getImageData(e);this.style.addImage(m,{data:new s.R({width:k,height:R},D),pixelRatio:u,stretchX:g,stretchY:v,content:x,textFitWidth:C,textFitHeight:I,sdf:p,version:0})}}updateImage(m,e){let n=this.style.getImage(m);if(!n)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let u=e instanceof HTMLImageElement||s.b(e)?be.getImageData(e):e,{width:p,height:g,data:v}=u;if(p===void 0||g===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==n.data.width||g!==n.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));let x=!(e instanceof HTMLImageElement||s.b(e));return n.data.replace(v,x),this.style.updateImage(m,n),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return bi.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,e){return this._lazyInitEmptyStyle(),this.style.addLayer(m,e),this._update(!0)}moveLayer(m,e){return this.style.moveLayer(m,e),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,e,n){return this.style.setLayerZoomRange(m,e,n),this._update(!0)}setFilter(m,e,n={}){return this.style.setFilter(m,e,n),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,e,n,u={}){return this.style.setPaintProperty(m,e,n,u),this._update(!0)}getPaintProperty(m,e){return this.style.getPaintProperty(m,e)}setLayoutProperty(m,e,n,u={}){return this.style.setLayoutProperty(m,e,n,u),this._update(!0)}getLayoutProperty(m,e){return this.style.getLayoutProperty(m,e)}setGlyphs(m,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,e,n,u=>{u||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,e,n=>{n||this._update(!0)}),this}setLight(m,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(m,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,e){return this.style.setFeatureState(m,e),this._update()}removeFeatureState(m,e){return this.style.removeFeatureState(m,e),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,e=0;return this._container&&(m=this._container.clientWidth||400,e=this._container.clientHeight||300),[m,e]}_setupContainer(){let m=this._container;m.classList.add("maplibregl-map");let e=this._canvasContainer=G.create("div","maplibregl-canvas-container",m);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let n=this._containerDimensions(),u=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],u);let p=this._controlContainer=G.create("div","maplibregl-control-container",m),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{g[v]=G.create("div",`maplibregl-ctrl-${v} `,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,e,n){this._canvas.width=Math.floor(n*m),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${e}px`}_setupPainter(){let m=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0}),e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:m},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,m):this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m),!n){let u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new Bo(n,this.transform),$e.testSupport(n)}migrateProjection(m,e){super.migrateProjection(m,e),this.painter.transform=m,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){var e,n,u,p,g;let v=this._idleTriggered?this._fadeDuration:0,x=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let R=this.transform.zoom,D=be.now();this.style.zoomHistory.update(R,D);let N=new s.C(R,{now:D,fadeDuration:v,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),j=N.crossFadingFactor();j===1&&j===this._crossFadingFactor||(C=!0,this._crossFadingFactor=j),this.style.update(N)}let I=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==x;(u=this.style.projection)===null||u===void 0||u.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((p=this.style.projection)===null||p===void 0?void 0:p.transitionState,(g=this.style.projection)===null||g===void 0?void 0:g.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||I)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,I),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cn.mark(s.co.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,s.cn.mark(s.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(let n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),bi.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();let e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),G.remove(this._canvasContainer),G.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cn.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,be.frame(this._frameRequest,m=>{s.cn.frame(m),this._frameRequest=null;try{this._render(m)}catch(e){if(!s.cp(e)&&!function(n){return n.message===_l}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return vt}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(m){return this._lazyInitEmptyStyle(),this.style.setProjection(m),this._update(!0)}},h.MapMouseEvent=Tn,h.MapTouchEvent=Ml,h.MapWheelEvent=Wu,h.Marker=Oa,h.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{let e=this._map.getZoom(),n=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{let u=this._map._getUIString(`NavigationControl.${n}`);e.title=u,e.setAttribute("aria-label",u)},this.options=s.e({},ih,m),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new nh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,e){let n=G.create("button",m,this._container);return n.type="button",n.addEventListener("click",e),n}},h.Popup=class extends s.E{constructor(m){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=G.create("div","maplibregl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let v of this.options.className.split(" "))this._container.classList.add(v);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=rh(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;let n=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let u=this.options.anchor,p=Dl(this.options.offset);if(!u){let v=this._container.offsetWidth,x=this._container.offsetHeight,C;C=n.y+p.bottom.y<x?["top"]:n.y>this._map.transform.height-x?["bottom"]:[],n.x<v/2?C.push("left"):n.x>this._map.transform.width-v/2&&C.push("right"),u=C.length===0?"bottom":C.join("-")}let g=n.add(p[u]);this.options.subpixelPositioning||(g=g.round()),G.setTransform(this._container,`${Qr[u]} translate(${g.x}px,${g.y}px)`),ef(this._container,u,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(oh),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=s.Q.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){let e=document.createDocumentFragment(),n=document.createElement("body"),u;for(n.innerHTML=m;u=n.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}_createCloseButton(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let m=this._container.querySelector(sh);m&&m.focus()}},h.RasterDEMTileSource=na,h.RasterTileSource=rn,h.ScaleControl=class{constructor(m){this._onMove=()=>{Rc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Rc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Dc),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},h.ScrollZoomHandler=Ht,h.Style=Rs,h.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=G.create("button","maplibregl-ctrl-terrain",this._container),G.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){G.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},h.TwoFingersTouchPitchHandler=Ld,h.TwoFingersTouchRotateHandler=tt,h.TwoFingersTouchZoomHandler=Pl,h.TwoFingersTouchZoomRotateHandler=eh,h.VectorTileSource=nn,h.VideoSource=Pr,h.addSourceType=(m,e)=>s._(void 0,void 0,void 0,function*(){if(on(m))throw new Error(`A source type called "${m}" already exists.`);((n,u)=>{Xt[n]=u})(m,e)}),h.clearPrewarmedResources=function(){let m=bn;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(oo),bn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},h.createTileMesh=ha,h.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},h.getRTLTextPluginStatus=function(){return Ai().getRTLTextPluginStatus()},h.getVersion=function(){return ah},h.getWorkerCount=function(){return tn.workerCount},h.getWorkerUrl=function(){return s.a.WORKER_URL},h.importScriptInWorkers=function(m){return Yo().broadcast("IS",m)},h.prewarm=function(){ar().acquire(oo)},h.setMaxParallelImageRequests=function(m){s.a.MAX_PARALLEL_IMAGE_REQUESTS=m},h.setRTLTextPlugin=function(m,e){return Ai().setRTLTextPlugin(m,e)},h.setWorkerCount=function(m){tn.workerCount=m},h.setWorkerUrl=function(m){s.a.WORKER_URL=m}});var l=c;return l})});var LC=Rb((ia,Hy)=>{"use strict";(function(c,a){typeof ia=="object"&&typeof Hy<"u"?Hy.exports=a():typeof define=="function"&&define.amd?define(a):(c=typeof globalThis<"u"?globalThis:c||self,c.Sweetalert2=a())})(ia,function(){"use strict";function c(M,E,F){if(typeof M=="function"?M===E:M.has(E))return arguments.length<3?E:F;throw new TypeError("Private element is not present on this object")}function a(M,E){if(E.has(M))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(M,E){return M.get(c(M,E))}function l(M,E,F){a(M,E),E.set(M,F)}function h(M,E,F){return M.set(c(M,E),F),F}let s=100,T={},Y=()=>{T.previousActiveElement instanceof HTMLElement?(T.previousActiveElement.focus(),T.previousActiveElement=null):document.body&&document.body.focus()},K=M=>new Promise(E=>{if(!M)return E();let F=window.scrollX,ne=window.scrollY;T.restoreFocusTimeout=setTimeout(()=>{Y(),E()},s),window.scrollTo(F,ne)}),Ce="swal2-",G=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"].reduce((M,E)=>(M[E]=Ce+E,M),{}),ft=["success","warning","info","question","error"].reduce((M,E)=>(M[E]=Ce+E,M),{}),Ct="SweetAlert2:",ut=M=>M.charAt(0).toUpperCase()+M.slice(1),lt=M=>{console.warn(`${Ct} ${typeof M=="object"?M.join(" "):M}`)},vi=M=>{console.error(`${Ct} ${M}`)},bi=[],Et=M=>{bi.includes(M)||(bi.push(M),lt(M))},mi=(M,E=null)=>{Et(`"${M}" is deprecated and will be removed in the next major release.${E?` Use "${E}" instead.`:""}`)},Yi=M=>typeof M=="function"?M():M,li=M=>M&&typeof M.toPromise=="function",Ir=M=>li(M)?M.toPromise():Promise.resolve(M),Ms=M=>M&&Promise.resolve(M)===M,Gi=()=>document.body.querySelector(`.${G.container}`),Kn=M=>{let E=Gi();return E?E.querySelector(M):null},Bi=M=>Kn(`.${M}`),Tt=()=>Bi(G.popup),Gr=()=>Bi(G.icon),Ss=()=>Bi(G["icon-content"]),Ts=()=>Bi(G.title),ci=()=>Bi(G["html-container"]),ro=()=>Bi(G.image),vr=()=>Bi(G["progress-steps"]),oo=()=>Bi(G["validation-message"]),tn=()=>Kn(`.${G.actions} .${G.confirm}`),so=()=>Kn(`.${G.actions} .${G.cancel}`),bn=()=>Kn(`.${G.actions} .${G.deny}`),xn=()=>Bi(G["input-label"]),ar=()=>Kn(`.${G.loader}`),wn=()=>Bi(G.actions),Yo=()=>Bi(G.footer),Hr=()=>Bi(G["timer-progress-bar"]),Ko=()=>Bi(G.close),lr=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,$n=()=>{let M=Tt();if(!M)return[];let E=M.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),F=Array.from(E).sort((et,yt)=>{let Jt=parseInt(et.getAttribute("tabindex")||"0"),ii=parseInt(yt.getAttribute("tabindex")||"0");return Jt>ii?1:Jt<ii?-1:0}),ne=M.querySelectorAll(lr),Oe=Array.from(ne).filter(et=>et.getAttribute("tabindex")!=="-1");return[...new Set(F.concat(Oe))].filter(et=>Ei(et))},Cn=()=>rn(document.body,G.shown)&&!rn(document.body,G["toast-shown"])&&!rn(document.body,G["no-backdrop"]),gi=()=>{let M=Tt();return M?rn(M,G.toast):!1},Zr=()=>{let M=Tt();return M?M.hasAttribute("data-loading"):!1},nn=(M,E)=>{if(M.textContent="",E){let ne=new DOMParser().parseFromString(E,"text/html"),Oe=ne.querySelector("head");Oe&&Array.from(Oe.childNodes).forEach(yt=>{M.appendChild(yt)});let et=ne.querySelector("body");et&&Array.from(et.childNodes).forEach(yt=>{yt instanceof HTMLVideoElement||yt instanceof HTMLAudioElement?M.appendChild(yt.cloneNode(!0)):M.appendChild(yt)})}},rn=(M,E)=>{if(!E)return!1;let F=E.split(/\s+/);for(let ne=0;ne<F.length;ne++)if(!M.classList.contains(F[ne]))return!1;return!0},na=(M,E)=>{Array.from(M.classList).forEach(F=>{!Object.values(G).includes(F)&&!Object.values(ft).includes(F)&&!Object.values(E.showClass||{}).includes(F)&&M.classList.remove(F)})},Mn=(M,E,F)=>{if(na(M,E),!E.customClass)return;let ne=E.customClass[F];if(ne){if(typeof ne!="string"&&!ne.forEach){lt(`Invalid type of customClass.${F}! Expected string or iterable object, got "${typeof ne}"`);return}Xt(M,ne)}},Rn=(M,E)=>{if(!E)return null;switch(E){case"select":case"textarea":case"file":return M.querySelector(`.${G.popup} > .${G[E]}`);case"checkbox":return M.querySelector(`.${G.popup} > .${G.checkbox} input`);case"radio":return M.querySelector(`.${G.popup} > .${G.radio} input:checked`)||M.querySelector(`.${G.popup} > .${G.radio} input:first-child`);case"range":return M.querySelector(`.${G.popup} > .${G.range} input`);default:return M.querySelector(`.${G.popup} > .${G.input}`)}},Pr=M=>{if(M.focus(),M.type!=="file"){let E=M.value;M.value="",M.value=E}},Ao=(M,E,F)=>{!M||!E||(typeof E=="string"&&(E=E.split(/\s+/).filter(Boolean)),E.forEach(ne=>{Array.isArray(M)?M.forEach(Oe=>{F?Oe.classList.add(ne):Oe.classList.remove(ne)}):F?M.classList.add(ne):M.classList.remove(ne)}))},Xt=(M,E)=>{Ao(M,E,!0)},on=(M,E)=>{Ao(M,E,!1)},cr=(M,E)=>{let F=Array.from(M.children);for(let ne=0;ne<F.length;ne++){let Oe=F[ne];if(Oe instanceof HTMLElement&&rn(Oe,E))return Oe}},br=(M,E,F)=>{F===`${parseInt(F)}`&&(F=parseInt(F)),F||parseInt(F)===0?M.style.setProperty(E,typeof F=="number"?`${F}px`:F):M.style.removeProperty(E)},Ni=(M,E="flex")=>{M&&(M.style.display=E)},Ai=M=>{M&&(M.style.display="none")},kr=(M,E="block")=>{M&&new MutationObserver(()=>{qr(M,M.innerHTML,E)}).observe(M,{childList:!0,subtree:!0})},ao=(M,E,F,ne)=>{let Oe=M.querySelector(E);Oe&&Oe.style.setProperty(F,ne)},qr=(M,E,F="flex")=>{E?Ni(M,F):Ai(M)},Ei=M=>!!(M&&(M.offsetWidth||M.offsetHeight||M.getClientRects().length)),Qn=()=>!Ei(tn())&&!Ei(bn())&&!Ei(so()),xr=M=>M.scrollHeight>M.clientHeight,ve=(M,E)=>{let F=M;for(;F&&F!==E;){if(xr(F))return!0;F=F.parentElement}return!1},H=M=>{let E=window.getComputedStyle(M),F=parseFloat(E.getPropertyValue("animation-duration")||"0"),ne=parseFloat(E.getPropertyValue("transition-duration")||"0");return F>0||ne>0},Z=(M,E=!1)=>{let F=Hr();F&&Ei(F)&&(E&&(F.style.transition="none",F.style.width="100%"),setTimeout(()=>{F.style.transition=`width ${M/1e3}s linear`,F.style.width="0%"},10))},Q=()=>{let M=Hr();if(!M)return;let E=parseInt(window.getComputedStyle(M).width);M.style.removeProperty("transition"),M.style.width="100%";let F=parseInt(window.getComputedStyle(M).width),ne=E/F*100;M.style.width=`${ne}%`},se=()=>typeof window>"u"||typeof document>"u",fe=`
 <div aria-labelledby="${G.title}" aria-describedby="${G["html-container"]}" class="${G.popup}" tabindex="-1">
   <button type="button" class="${G.close}"></button>
   <ul class="${G["progress-steps"]}"></ul>
   <div class="${G.icon}"></div>
   <img class="${G.image}" />
   <h2 class="${G.title}" id="${G.title}"></h2>
   <div class="${G["html-container"]}" id="${G["html-container"]}"></div>
   <input class="${G.input}" id="${G.input}" />
   <input type="file" class="${G.file}" />
   <div class="${G.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${G.select}" id="${G.select}"></select>
   <div class="${G.radio}"></div>
   <label class="${G.checkbox}">
     <input type="checkbox" id="${G.checkbox}" />
     <span class="${G.label}"></span>
   </label>
   <textarea class="${G.textarea}" id="${G.textarea}"></textarea>
   <div class="${G["validation-message"]}" id="${G["validation-message"]}"></div>
   <div class="${G.actions}">
     <div class="${G.loader}"></div>
     <button type="button" class="${G.confirm}"></button>
     <button type="button" class="${G.deny}"></button>
     <button type="button" class="${G.cancel}"></button>
   </div>
   <div class="${G.footer}"></div>
   <div class="${G["timer-progress-bar-container"]}">
     <div class="${G["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),X=()=>{let M=Gi();return M?(M.remove(),on([document.documentElement,document.body],[G["no-backdrop"],G["toast-shown"],G["has-column"]]),!0):!1},Me=()=>{T.currentInstance.resetValidationMessage()},ye=()=>{let M=Tt(),E=cr(M,G.input),F=cr(M,G.file),ne=M.querySelector(`.${G.range} input`),Oe=M.querySelector(`.${G.range} output`),et=cr(M,G.select),yt=M.querySelector(`.${G.checkbox} input`),Jt=cr(M,G.textarea);E.oninput=Me,F.onchange=Me,et.onchange=Me,yt.onchange=Me,Jt.oninput=Me,ne.oninput=()=>{Me(),Oe.value=ne.value},ne.onchange=()=>{Me(),Oe.value=ne.value}},we=M=>typeof M=="string"?document.querySelector(M):M,Ee=M=>{let E=Tt();E.setAttribute("role",M.toast?"alert":"dialog"),E.setAttribute("aria-live",M.toast?"polite":"assertive"),M.toast||E.setAttribute("aria-modal","true")},xe=M=>{window.getComputedStyle(M).direction==="rtl"&&Xt(Gi(),G.rtl)},Ne=M=>{let E=X();if(se()){vi("SweetAlert2 requires document to initialize");return}let F=document.createElement("div");F.className=G.container,E&&Xt(F,G["no-transition"]),nn(F,fe),F.dataset.swal2Theme=M.theme;let ne=we(M.target);ne.appendChild(F),M.topLayer&&(F.setAttribute("popover",""),F.showPopover()),Ee(M),xe(ne),ye()},We=(M,E)=>{M instanceof HTMLElement?E.appendChild(M):typeof M=="object"?Qe(M,E):M&&nn(E,M)},Qe=(M,E)=>{M.jquery?ht(E,M):nn(E,M.toString())},ht=(M,E)=>{if(M.textContent="",0 in E)for(let F=0;F in E;F++)M.appendChild(E[F].cloneNode(!0));else M.appendChild(E.cloneNode(!0))},It=(M,E)=>{let F=wn(),ne=ar();!F||!ne||(!E.showConfirmButton&&!E.showDenyButton&&!E.showCancelButton?Ai(F):Ni(F),Mn(F,E,"actions"),wt(F,ne,E),nn(ne,E.loaderHtml||""),Mn(ne,E,"loader"))};function wt(M,E,F){let ne=tn(),Oe=bn(),et=so();!ne||!Oe||!et||(Bt(ne,"confirm",F),Bt(Oe,"deny",F),Bt(et,"cancel",F),De(ne,Oe,et,F),F.reverseButtons&&(F.toast?(M.insertBefore(et,ne),M.insertBefore(Oe,ne)):(M.insertBefore(et,E),M.insertBefore(Oe,E),M.insertBefore(ne,E))))}function De(M,E,F,ne){if(!ne.buttonsStyling){on([M,E,F],G.styled);return}Xt([M,E,F],G.styled),ne.confirmButtonColor&&M.style.setProperty("--swal2-confirm-button-background-color",ne.confirmButtonColor),ne.denyButtonColor&&E.style.setProperty("--swal2-deny-button-background-color",ne.denyButtonColor),ne.cancelButtonColor&&F.style.setProperty("--swal2-cancel-button-background-color",ne.cancelButtonColor),ni(M),ni(E),ni(F)}function ni(M){let E=window.getComputedStyle(M);if(E.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;let F=E.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");M.style.setProperty("--swal2-action-button-focus-box-shadow",E.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${F}`))}function Bt(M,E,F){let ne=ut(E);qr(M,F[`show${ne}Button`],"inline-block"),nn(M,F[`${E}ButtonText`]||""),M.setAttribute("aria-label",F[`${E}ButtonAriaLabel`]||""),M.className=G[E],Mn(M,F,`${E}Button`)}let ri=(M,E)=>{let F=Ko();F&&(nn(F,E.closeButtonHtml||""),Mn(F,E,"closeButton"),qr(F,E.showCloseButton),F.setAttribute("aria-label",E.closeButtonAriaLabel||""))},xt=(M,E)=>{let F=Gi();F&&(Be(F,E.backdrop),mt(F,E.position),Pt(F,E.grow),Mn(F,E,"container"))};function Be(M,E){typeof E=="string"?M.style.background=E:E||Xt([document.documentElement,document.body],G["no-backdrop"])}function mt(M,E){E&&(E in G?Xt(M,G[E]):(lt('The "position" parameter is not valid, defaulting to "center"'),Xt(M,G.center)))}function Pt(M,E){E&&Xt(M,G[`grow-${E}`])}var St={innerParams:new WeakMap,domCache:new WeakMap};let Vi=["input","file","range","select","radio","checkbox","textarea"],Jn=(M,E)=>{let F=Tt();if(!F)return;let ne=St.innerParams.get(M),Oe=!ne||E.input!==ne.input;Vi.forEach(et=>{let yt=cr(F,G[et]);yt&&(ra(et,E.inputAttributes),yt.className=G[et],Oe&&Ai(yt))}),E.input&&(Oe&&At(E),Qo(E))},At=M=>{if(!M.input)return;if(!ai[M.input]){vi(`Unexpected type of input! Expected ${Object.keys(ai).join(" | ")}, got "${M.input}"`);return}let E=Do(M.input);if(!E)return;let F=ai[M.input](E,M);Ni(E),M.inputAutoFocus&&setTimeout(()=>{Pr(F)})},Es=M=>{for(let E=0;E<M.attributes.length;E++){let F=M.attributes[E].name;["id","type","value","style"].includes(F)||M.removeAttribute(F)}},ra=(M,E)=>{let F=Tt();if(!F)return;let ne=Rn(F,M);if(ne){Es(ne);for(let Oe in E)ne.setAttribute(Oe,E[Oe])}},Qo=M=>{if(!M.input)return;let E=Do(M.input);E&&Mn(E,M,"input")},Jo=(M,E)=>{!M.placeholder&&E.inputPlaceholder&&(M.placeholder=E.inputPlaceholder)},dr=(M,E,F)=>{if(F.inputLabel){let ne=document.createElement("label"),Oe=G["input-label"];ne.setAttribute("for",M.id),ne.className=Oe,typeof F.customClass=="object"&&Xt(ne,F.customClass.inputLabel),ne.innerText=F.inputLabel,E.insertAdjacentElement("beforebegin",ne)}},Do=M=>{let E=Tt();if(E)return cr(E,G[M]||G.input)},Di=(M,E)=>{["string","number"].includes(typeof E)?M.value=`${E}`:Ms(E)||lt(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof E}"`)},ai={};ai.text=ai.email=ai.password=ai.number=ai.tel=ai.url=ai.search=ai.date=ai["datetime-local"]=ai.time=ai.week=ai.month=(M,E)=>(Di(M,E.inputValue),dr(M,M,E),Jo(M,E),M.type=E.input,M),ai.file=(M,E)=>(dr(M,M,E),Jo(M,E),M),ai.range=(M,E)=>{let F=M.querySelector("input"),ne=M.querySelector("output");return Di(F,E.inputValue),F.type=E.input,Di(ne,E.inputValue),dr(F,M,E),M},ai.select=(M,E)=>{if(M.textContent="",E.inputPlaceholder){let F=document.createElement("option");nn(F,E.inputPlaceholder),F.value="",F.disabled=!0,F.selected=!0,M.appendChild(F)}return dr(M,M,E),M},ai.radio=M=>(M.textContent="",M),ai.checkbox=(M,E)=>{let F=Rn(Tt(),"checkbox");F.value="1",F.checked=!!E.inputValue;let ne=M.querySelector("span");return nn(ne,E.inputPlaceholder||E.inputLabel),F},ai.textarea=(M,E)=>{Di(M,E.inputValue),Jo(M,E),dr(M,M,E);let F=ne=>parseInt(window.getComputedStyle(ne).marginLeft)+parseInt(window.getComputedStyle(ne).marginRight);return setTimeout(()=>{if("MutationObserver"in window){let ne=parseInt(window.getComputedStyle(Tt()).width),Oe=()=>{if(!document.body.contains(M))return;let et=M.offsetWidth+F(M);et>ne?Tt().style.width=`${et}px`:br(Tt(),"width",E.width)};new MutationObserver(Oe).observe(M,{attributes:!0,attributeFilter:["style"]})}}),M};let Ii=(M,E)=>{let F=ci();F&&(kr(F),Mn(F,E,"htmlContainer"),E.html?(We(E.html,F),Ni(F,"block")):E.text?(F.textContent=E.text,Ni(F,"block")):Ai(F),Jn(M,E))},oa=(M,E)=>{let F=Yo();F&&(kr(F),qr(F,E.footer,"block"),E.footer&&We(E.footer,F),Mn(F,E,"footer"))},Is=(M,E)=>{let F=St.innerParams.get(M),ne=Gr();if(!ne)return;if(F&&E.icon===F.icon){el(ne,E),Ja(ne,E);return}if(!E.icon&&!E.iconHtml){Ai(ne);return}if(E.icon&&Object.keys(ft).indexOf(E.icon)===-1){vi(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${E.icon}"`),Ai(ne);return}Ni(ne),el(ne,E),Ja(ne,E),Xt(ne,E.showClass&&E.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",Ro)},Ja=(M,E)=>{for(let[F,ne]of Object.entries(ft))E.icon!==F&&on(M,ne);Xt(M,E.icon&&ft[E.icon]),cd(M,E),Ro(),Mn(M,E,"icon")},Ro=()=>{let M=Tt();if(!M)return;let E=window.getComputedStyle(M).getPropertyValue("background-color"),F=M.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let ne=0;ne<F.length;ne++)F[ne].style.backgroundColor=E},lo=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,ld=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,el=(M,E)=>{if(!E.icon&&!E.iconHtml)return;let F=M.innerHTML,ne="";E.iconHtml?ne=es(E.iconHtml):E.icon==="success"?(ne=lo,F=F.replace(/ style=".*?"/g,"")):E.icon==="error"?ne=ld:E.icon&&(ne=es({question:"?",warning:"!",info:"i"}[E.icon])),F.trim()!==ne.trim()&&nn(M,ne)},cd=(M,E)=>{if(E.iconColor){M.style.color=E.iconColor,M.style.borderColor=E.iconColor;for(let F of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])ao(M,F,"background-color",E.iconColor);ao(M,".swal2-success-ring","border-color",E.iconColor)}},es=M=>`<div class="${G["icon-content"]}">${M}</div>`,dd=(M,E)=>{let F=ro();if(F){if(!E.imageUrl){Ai(F);return}Ni(F,""),F.setAttribute("src",E.imageUrl),F.setAttribute("alt",E.imageAlt||""),br(F,"width",E.imageWidth),br(F,"height",E.imageHeight),F.className=G.image,Mn(F,E,"image")}},ac=!1,ud=0,hd=0,lc=0,tl=0,ts=M=>{M.addEventListener("mousedown",sa),document.body.addEventListener("mousemove",Wr),M.addEventListener("mouseup",Ps),M.addEventListener("touchstart",sa),document.body.addEventListener("touchmove",Wr),M.addEventListener("touchend",Ps)},cc=M=>{M.removeEventListener("mousedown",sa),document.body.removeEventListener("mousemove",Wr),M.removeEventListener("mouseup",Ps),M.removeEventListener("touchstart",sa),document.body.removeEventListener("touchmove",Wr),M.removeEventListener("touchend",Ps)},sa=M=>{let E=Tt();if(M.target===E||Gr().contains(M.target)){ac=!0;let F=pd(M);ud=F.clientX,hd=F.clientY,lc=parseInt(E.style.insetInlineStart)||0,tl=parseInt(E.style.insetBlockStart)||0,Xt(E,"swal2-dragging")}},Wr=M=>{let E=Tt();if(ac){let{clientX:F,clientY:ne}=pd(M);E.style.insetInlineStart=`${lc+(F-ud)}px`,E.style.insetBlockStart=`${tl+(ne-hd)}px`}},Ps=()=>{let M=Tt();ac=!1,on(M,"swal2-dragging")},pd=M=>{let E=0,F=0;return M.type.startsWith("mouse")?(E=M.clientX,F=M.clientY):M.type.startsWith("touch")&&(E=M.touches[0].clientX,F=M.touches[0].clientY),{clientX:E,clientY:F}},aa=(M,E)=>{let F=Gi(),ne=Tt();if(!(!F||!ne)){if(E.toast){br(F,"width",E.width),ne.style.width="100%";let Oe=ar();Oe&&ne.insertBefore(Oe,Gr())}else br(ne,"width",E.width);br(ne,"padding",E.padding),E.color&&(ne.style.color=E.color),E.background&&(ne.style.background=E.background),Ai(oo()),la(ne,E),E.draggable&&!E.toast?(Xt(ne,G.draggable),ts(ne)):(on(ne,G.draggable),cc(ne))}},la=(M,E)=>{let F=E.showClass||{};M.className=`${G.popup} ${Ei(M)?F.popup:""}`,E.toast?(Xt([document.documentElement,document.body],G["toast-shown"]),Xt(M,G.toast)):Xt(M,G.modal),Mn(M,E,"popup"),typeof E.customClass=="string"&&Xt(M,E.customClass),E.icon&&Xt(M,G[`icon-${E.icon}`])},dc=(M,E)=>{let F=vr();if(!F)return;let{progressSteps:ne,currentProgressStep:Oe}=E;if(!ne||ne.length===0||Oe===void 0){Ai(F);return}Ni(F),F.textContent="",Oe>=ne.length&&lt("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),ne.forEach((et,yt)=>{let Jt=Gn(et);if(F.appendChild(Jt),yt===Oe&&Xt(Jt,G["active-progress-step"]),yt!==ne.length-1){let ii=Qt(E);F.appendChild(ii)}})},Gn=M=>{let E=document.createElement("li");return Xt(E,G["progress-step"]),nn(E,M),E},Qt=M=>{let E=document.createElement("li");return Xt(E,G["progress-step-line"]),M.progressStepsDistance&&br(E,"width",M.progressStepsDistance),E},ks=(M,E)=>{let F=Ts();F&&(kr(F),qr(F,E.title||E.titleText,"block"),E.title&&We(E.title,F),E.titleText&&(F.innerText=E.titleText),Mn(F,E,"title"))},On=(M,E)=>{aa(M,E),xt(M,E),dc(M,E),Is(M,E),dd(M,E),ks(M,E),ri(M,E),Ii(M,E),It(M,E),oa(M,E);let F=Tt();typeof E.didRender=="function"&&F&&E.didRender(F),T.eventEmitter.emit("didRender",F)},is=()=>Ei(Tt()),Vt=()=>{var M;return(M=tn())===null||M===void 0?void 0:M.click()},ca=()=>{var M;return(M=bn())===null||M===void 0?void 0:M.click()},da=()=>{var M;return(M=so())===null||M===void 0?void 0:M.click()},Ar=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Hn=M=>{M.keydownTarget&&M.keydownHandlerAdded&&(M.keydownTarget.removeEventListener("keydown",M.keydownHandler,{capture:M.keydownListenerCapture}),M.keydownHandlerAdded=!1)},Sn=(M,E,F)=>{Hn(M),E.toast||(M.keydownHandler=ne=>As(E,ne,F),M.keydownTarget=E.keydownListenerCapture?window:Tt(),M.keydownListenerCapture=E.keydownListenerCapture,M.keydownTarget.addEventListener("keydown",M.keydownHandler,{capture:M.keydownListenerCapture}),M.keydownHandlerAdded=!0)},ji=(M,E)=>{var F;let ne=$n();if(ne.length){M=M+E,M===-2&&(M=ne.length-1),M===ne.length?M=0:M===-1&&(M=ne.length-1),ne[M].focus();return}(F=Tt())===null||F===void 0||F.focus()},hn=["ArrowRight","ArrowDown"],Mi=["ArrowLeft","ArrowUp"],As=(M,E,F)=>{M&&(E.isComposing||E.keyCode===229||(M.stopKeydownPropagation&&E.stopPropagation(),E.key==="Enter"?Zn(E,M):E.key==="Tab"?ur(E):[...hn,...Mi].includes(E.key)?er(E.key):E.key==="Escape"&&ua(E,M,F)))},Zn=(M,E)=>{if(!Yi(E.allowEnterKey))return;let F=Rn(Tt(),E.input);if(M.target&&F&&M.target instanceof HTMLElement&&M.target.outerHTML===F.outerHTML){if(["textarea","file"].includes(E.input))return;Vt(),M.preventDefault()}},ur=M=>{let E=M.target,F=$n(),ne=-1;for(let Oe=0;Oe<F.length;Oe++)if(E===F[Oe]){ne=Oe;break}M.shiftKey?ji(ne,-1):ji(ne,1),M.stopPropagation(),M.preventDefault()},er=M=>{let E=wn(),F=tn(),ne=bn(),Oe=so();if(!E||!F||!ne||!Oe)return;let et=[F,ne,Oe];if(document.activeElement instanceof HTMLElement&&!et.includes(document.activeElement))return;let yt=hn.includes(M)?"nextElementSibling":"previousElementSibling",Jt=document.activeElement;if(Jt){for(let ii=0;ii<E.children.length;ii++){if(Jt=Jt[yt],!Jt)return;if(Jt instanceof HTMLButtonElement&&Ei(Jt))break}Jt instanceof HTMLButtonElement&&Jt.focus()}},ua=(M,E,F)=>{Yi(E.allowEscapeKey)&&(M.preventDefault(),F(Ar.esc))};var oi={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};let Ui=()=>{let M=Gi();Array.from(document.body.children).forEach(F=>{F.contains(M)||(F.hasAttribute("aria-hidden")&&F.setAttribute("data-previous-aria-hidden",F.getAttribute("aria-hidden")||""),F.setAttribute("aria-hidden","true"))})},jt=()=>{Array.from(document.body.children).forEach(E=>{E.hasAttribute("data-previous-aria-hidden")?(E.setAttribute("aria-hidden",E.getAttribute("data-previous-aria-hidden")||""),E.removeAttribute("data-previous-aria-hidden")):E.removeAttribute("aria-hidden")})},Mt=typeof window<"u"&&!!window.GestureEvent,Ds=()=>{if(Mt&&!rn(document.body,G.iosfix)){let M=document.body.scrollTop;document.body.style.top=`${M*-1}px`,Xt(document.body,G.iosfix),Dt()}},Dt=()=>{let M=Gi();if(!M)return;let E;M.ontouchstart=F=>{E=il(F)},M.ontouchmove=F=>{E&&(F.preventDefault(),F.stopPropagation())}},il=M=>{let E=M.target,F=Gi(),ne=ci();return!F||!ne||Fn(M)||uc(M)?!1:E===F||!xr(F)&&E instanceof HTMLElement&&!ve(E,ne)&&E.tagName!=="INPUT"&&E.tagName!=="TEXTAREA"&&!(xr(ne)&&ne.contains(E))},Fn=M=>M.touches&&M.touches.length&&M.touches[0].touchType==="stylus",uc=M=>M.touches&&M.touches.length>1,hc=()=>{if(rn(document.body,G.iosfix)){let M=parseInt(document.body.style.top,10);on(document.body,G.iosfix),document.body.style.top="",document.body.scrollTop=M*-1}},ha=()=>{let M=document.createElement("div");M.className=G["scrollbar-measure"],document.body.appendChild(M);let E=M.getBoundingClientRect().width-M.clientWidth;return document.body.removeChild(M),E},Dr=null,pa=M=>{Dr===null&&(document.body.scrollHeight>window.innerHeight||M==="scroll")&&(Dr=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Dr+ha()}px`)},pc=()=>{Dr!==null&&(document.body.style.paddingRight=`${Dr}px`,Dr=null)};function fa(M,E,F,ne){gi()?ga(M,ne):(K(F).then(()=>ga(M,ne)),Hn(T)),Mt?(E.setAttribute("style","display:none !important"),E.removeAttribute("class"),E.innerHTML=""):E.remove(),Cn()&&(pc(),hc(),jt()),ma()}function ma(){on([document.documentElement,document.body],[G.shown,G["height-auto"],G["no-backdrop"],G["toast-shown"]])}function tr(M){M=Fo(M);let E=oi.swalPromiseResolve.get(this),F=pn(this);this.isAwaitingPromise?M.isDismissed||(co(this),E(M)):F&&E(M)}let pn=M=>{let E=Tt();if(!E)return!1;let F=St.innerParams.get(M);if(!F||rn(E,F.hideClass.popup))return!1;on(E,F.showClass.popup),Xt(E,F.hideClass.popup);let ne=Gi();return on(ne,F.showClass.backdrop),Xt(ne,F.hideClass.backdrop),fn(M,E,F),!0};function Oo(M){let E=oi.swalPromiseReject.get(this);co(this),E&&E(M)}let co=M=>{M.isAwaitingPromise&&(delete M.isAwaitingPromise,St.innerParams.get(M)||M._destroy())},Fo=M=>typeof M>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},M),fn=(M,E,F)=>{var ne;let Oe=Gi(),et=H(E);typeof F.willClose=="function"&&F.willClose(E),(ne=T.eventEmitter)===null||ne===void 0||ne.emit("willClose",E),et?nl(M,E,Oe,F.returnFocus,F.didClose):fa(M,Oe,F.returnFocus,F.didClose)},nl=(M,E,F,ne,Oe)=>{T.swalCloseEventFinishedCallback=fa.bind(null,M,F,ne,Oe);let et=function(yt){if(yt.target===E){var Jt;(Jt=T.swalCloseEventFinishedCallback)===null||Jt===void 0||Jt.call(T),delete T.swalCloseEventFinishedCallback,E.removeEventListener("animationend",et),E.removeEventListener("transitionend",et)}};E.addEventListener("animationend",et),E.addEventListener("transitionend",et)},ga=(M,E)=>{setTimeout(()=>{var F;typeof E=="function"&&E.bind(M.params)(),(F=T.eventEmitter)===null||F===void 0||F.emit("didClose"),M._destroy&&M._destroy()})},ns=M=>{let E=Tt();if(E||new Us,E=Tt(),!E)return;let F=ar();gi()?Ai(Gr()):Du(E,M),Ni(F),E.setAttribute("data-loading","true"),E.setAttribute("aria-busy","true"),E.focus()},Du=(M,E)=>{let F=wn(),ne=ar();!F||!ne||(!E&&Ei(tn())&&(E=tn()),Ni(F),E&&(Ai(E),ne.setAttribute("data-button-to-replace",E.className),F.insertBefore(ne,E)),Xt([M,F],G.loading))},Ln=(M,E)=>{E.input==="select"||E.input==="radio"?wr(M,E):["text","email","number","tel","textarea"].some(F=>F===E.input)&&(li(E.inputValue)||Ms(E.inputValue))&&(ns(tn()),os(M,E))},_a=(M,E)=>{let F=M.getInput();if(!F)return null;switch(E.input){case"checkbox":return Xr(F);case"radio":return rs(F);case"file":return ya(F);default:return E.inputAutoTrim?F.value.trim():F.value}},Xr=M=>M.checked?1:0,rs=M=>M.checked?M.value:null,ya=M=>M.files&&M.files.length?M.getAttribute("multiple")!==null?M.files:M.files[0]:null,wr=(M,E)=>{let F=Tt();if(!F)return;let ne=Oe=>{E.input==="select"?rl(F,Rs(Oe),E):E.input==="radio"&&Ru(F,Rs(Oe),E)};li(E.inputOptions)||Ms(E.inputOptions)?(ns(tn()),Ir(E.inputOptions).then(Oe=>{M.hideLoading(),ne(Oe)})):typeof E.inputOptions=="object"?ne(E.inputOptions):vi(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof E.inputOptions}`)},os=(M,E)=>{let F=M.getInput();F&&(Ai(F),Ir(E.inputValue).then(ne=>{F.value=E.input==="number"?`${parseFloat(ne)||0}`:`${ne}`,Ni(F),F.focus(),M.hideLoading()}).catch(ne=>{vi(`Error in inputValue promise: ${ne}`),F.value="",Ni(F),F.focus(),M.hideLoading()}))};function rl(M,E,F){let ne=cr(M,G.select);if(!ne)return;let Oe=(et,yt,Jt)=>{let ii=document.createElement("option");ii.value=Jt,nn(ii,yt),ii.selected=fd(Jt,F.inputValue),et.appendChild(ii)};E.forEach(et=>{let yt=et[0],Jt=et[1];if(Array.isArray(Jt)){let ii=document.createElement("optgroup");ii.label=yt,ii.disabled=!1,ne.appendChild(ii),Jt.forEach(Bo=>Oe(ii,Bo[1],Bo[0]))}else Oe(ne,Jt,yt)}),ne.focus()}function Ru(M,E,F){let ne=cr(M,G.radio);if(!ne)return;E.forEach(et=>{let yt=et[0],Jt=et[1],ii=document.createElement("input"),Bo=document.createElement("label");ii.type="radio",ii.name=G.radio,ii.value=yt,fd(yt,F.inputValue)&&(ii.checked=!0);let us=document.createElement("span");nn(us,Jt),us.className=G.label,Bo.appendChild(ii),Bo.appendChild(us),ne.appendChild(Bo)});let Oe=ne.querySelectorAll("input");Oe.length&&Oe[0].focus()}let Rs=M=>{let E=[];return M instanceof Map?M.forEach((F,ne)=>{let Oe=F;typeof Oe=="object"&&(Oe=Rs(Oe)),E.push([ne,Oe])}):Object.keys(M).forEach(F=>{let ne=M[F];typeof ne=="object"&&(ne=Rs(ne)),E.push([F,ne])}),E},fd=(M,E)=>!!E&&E.toString()===M.toString(),Ou=M=>{let E=St.innerParams.get(M);M.disableButtons(),E.input?ss(M,"confirm"):al(M,!0)},Fu=M=>{let E=St.innerParams.get(M);M.disableButtons(),E.returnInputValueOnDeny?ss(M,"deny"):Os(M,!1)},ol=(M,E)=>{M.disableButtons(),E(Ar.cancel)},ss=(M,E)=>{let F=St.innerParams.get(M);if(!F.input){vi(`The "input" parameter is needed to be set when using returnInputValueOn${ut(E)}`);return}let ne=M.getInput(),Oe=_a(M,F);F.inputValidator?sl(M,Oe,E):ne&&!ne.checkValidity()?(M.enableButtons(),M.showValidationMessage(F.validationMessage||ne.validationMessage)):E==="deny"?Os(M,Oe):al(M,Oe)},sl=(M,E,F)=>{let ne=St.innerParams.get(M);M.disableInput(),Promise.resolve().then(()=>Ir(ne.inputValidator(E,ne.validationMessage))).then(et=>{M.enableButtons(),M.enableInput(),et?M.showValidationMessage(et):F==="deny"?Os(M,E):al(M,E)})},Os=(M,E)=>{let F=St.innerParams.get(M||void 0);F.showLoaderOnDeny&&ns(bn()),F.preDeny?(M.isAwaitingPromise=!0,Promise.resolve().then(()=>Ir(F.preDeny(E,F.validationMessage))).then(Oe=>{Oe===!1?(M.hideLoading(),co(M)):M.close({isDenied:!0,value:typeof Oe>"u"?E:Oe})}).catch(Oe=>Rr(M||void 0,Oe))):M.close({isDenied:!0,value:E})},va=(M,E)=>{M.close({isConfirmed:!0,value:E})},Rr=(M,E)=>{M.rejectPromise(E)},al=(M,E)=>{let F=St.innerParams.get(M||void 0);F.showLoaderOnConfirm&&ns(),F.preConfirm?(M.resetValidationMessage(),M.isAwaitingPromise=!0,Promise.resolve().then(()=>Ir(F.preConfirm(E,F.validationMessage))).then(Oe=>{Ei(oo())||Oe===!1?(M.hideLoading(),co(M)):va(M,typeof Oe>"u"?E:Oe)}).catch(Oe=>Rr(M||void 0,Oe))):va(M,E)};function Fs(){let M=St.innerParams.get(this);if(!M)return;let E=St.domCache.get(this);Ai(E.loader),gi()?M.icon&&Ni(Gr()):ba(E),on([E.popup,E.actions],G.loading),E.popup.removeAttribute("aria-busy"),E.popup.removeAttribute("data-loading"),E.confirmButton.disabled=!1,E.denyButton.disabled=!1,E.cancelButton.disabled=!1}let ba=M=>{let E=M.popup.getElementsByClassName(M.loader.getAttribute("data-button-to-replace"));E.length?Ni(E[0],"inline-block"):Qn()&&Ai(M.actions)};function Ls(){let M=St.innerParams.get(this),E=St.domCache.get(this);return E?Rn(E.popup,M.input):null}function md(M,E,F){let ne=St.domCache.get(M);E.forEach(Oe=>{ne[Oe].disabled=F})}function xa(M,E){let F=Tt();if(!(!F||!M))if(M.type==="radio"){let ne=F.querySelectorAll(`[name="${G.radio}"]`);for(let Oe=0;Oe<ne.length;Oe++)ne[Oe].disabled=E}else M.disabled=E}function fc(){md(this,["confirmButton","denyButton","cancelButton"],!1)}function Lo(){md(this,["confirmButton","denyButton","cancelButton"],!0)}function mc(){xa(this.getInput(),!1)}function gc(){xa(this.getInput(),!0)}function gd(M){let E=St.domCache.get(this),F=St.innerParams.get(this);nn(E.validationMessage,M),E.validationMessage.className=G["validation-message"],F.customClass&&F.customClass.validationMessage&&Xt(E.validationMessage,F.customClass.validationMessage),Ni(E.validationMessage);let ne=this.getInput();ne&&(ne.setAttribute("aria-invalid","true"),ne.setAttribute("aria-describedby",G["validation-message"]),Pr(ne),Xt(ne,G.inputerror))}function _c(){let M=St.domCache.get(this);M.validationMessage&&Ai(M.validationMessage);let E=this.getInput();E&&(E.removeAttribute("aria-invalid"),E.removeAttribute("aria-describedby"),on(E,G.inputerror))}let Yr={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},_d=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],yd={allowEnterKey:void 0},vd=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],ll=M=>Object.prototype.hasOwnProperty.call(Yr,M),uo=M=>_d.indexOf(M)!==-1,yc=M=>yd[M],bd=M=>{ll(M)||lt(`Unknown parameter "${M}"`)},zs=M=>{vd.includes(M)&&lt(`The parameter "${M}" is incompatible with toasts`)},xd=M=>{let E=yc(M);E&&mi(M,E)},wa=M=>{M.backdrop===!1&&M.allowOutsideClick&&lt('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),M.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(M.theme)&&lt(`Invalid theme "${M.theme}"`);for(let E in M)bd(E),M.toast&&zs(E),xd(E)};function wd(M){let E=Gi(),F=Tt(),ne=St.innerParams.get(this);if(!F||rn(F,ne.hideClass.popup)){lt("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}let Oe=Lu(M),et=Object.assign({},ne,Oe);wa(et),E.dataset.swal2Theme=et.theme,On(this,et),St.innerParams.set(this,et),Object.defineProperties(this,{params:{value:Object.assign({},this.params,M),writable:!1,enumerable:!0}})}let Lu=M=>{let E={};return Object.keys(M).forEach(F=>{uo(F)?E[F]=M[F]:lt(`Invalid parameter to update: ${F}`)}),E};function cl(){let M=St.domCache.get(this),E=St.innerParams.get(this);if(!E){vc(this);return}M.popup&&T.swalCloseEventFinishedCallback&&(T.swalCloseEventFinishedCallback(),delete T.swalCloseEventFinishedCallback),typeof E.didDestroy=="function"&&E.didDestroy(),T.eventEmitter.emit("didDestroy"),Cd(this)}let Cd=M=>{vc(M),delete M.params,delete T.keydownHandler,delete T.keydownTarget,delete T.currentInstance},vc=M=>{M.isAwaitingPromise?(Ca(St,M),M.isAwaitingPromise=!0):(Ca(oi,M),Ca(St,M),delete M.isAwaitingPromise,delete M.disableButtons,delete M.enableButtons,delete M.getInput,delete M.disableInput,delete M.enableInput,delete M.hideLoading,delete M.disableLoading,delete M.showValidationMessage,delete M.resetValidationMessage,delete M.close,delete M.closePopup,delete M.closeModal,delete M.closeToast,delete M.rejectPromise,delete M.update,delete M._destroy)},Ca=(M,E)=>{for(let F in M)M[F].delete(E)};var Md=Object.freeze({__proto__:null,_destroy:cl,close:tr,closeModal:tr,closePopup:tr,closeToast:tr,disableButtons:Lo,disableInput:gc,disableLoading:Fs,enableButtons:fc,enableInput:mc,getInput:Ls,handleAwaitingPromise:co,hideLoading:Fs,rejectPromise:Oo,resetValidationMessage:_c,showValidationMessage:gd,update:wd});let ti=(M,E,F)=>{M.toast?ho(M,E,F):(xc(E),Sd(E),wc(M,E,F))},ho=(M,E,F)=>{E.popup.onclick=()=>{M&&(bc(M)||M.timer||M.input)||F(Ar.close)}},bc=M=>!!(M.showConfirmButton||M.showDenyButton||M.showCancelButton||M.showCloseButton),Bs=!1,xc=M=>{M.popup.onmousedown=()=>{M.container.onmouseup=function(E){M.container.onmouseup=()=>{},E.target===M.container&&(Bs=!0)}}},Sd=M=>{M.container.onmousedown=E=>{E.target===M.container&&E.preventDefault(),M.popup.onmouseup=function(F){M.popup.onmouseup=()=>{},(F.target===M.popup||F.target instanceof HTMLElement&&M.popup.contains(F.target))&&(Bs=!0)}}},wc=(M,E,F)=>{E.container.onclick=ne=>{if(Bs){Bs=!1;return}ne.target===E.container&&Yi(M.allowOutsideClick)&&F(Ar.backdrop)}},as=M=>typeof M=="object"&&M.jquery,dl=M=>M instanceof Element||as(M),zu=M=>{let E={};return typeof M[0]=="object"&&!dl(M[0])?Object.assign(E,M[0]):["title","html","icon"].forEach((F,ne)=>{let Oe=M[ne];typeof Oe=="string"||dl(Oe)?E[F]=Oe:Oe!==void 0&&vi(`Unexpected type of ${F}! Expected "string" or "Element", got ${typeof Oe}`)}),E};function Bu(...M){return new this(...M)}function Nu(M){class E extends this{_main(ne,Oe){return super._main(ne,Object.assign({},M,Oe))}}return E}let Vu=()=>T.timeout&&T.timeout.getTimerLeft(),Cc=()=>{if(T.timeout)return Q(),T.timeout.stop()},Td=()=>{if(T.timeout){let M=T.timeout.start();return Z(M),M}},Ed=()=>{let M=T.timeout;return M&&(M.running?Cc():Td())},ul=M=>{if(T.timeout){let E=T.timeout.increase(M);return Z(E,!0),E}},hl=()=>!!(T.timeout&&T.timeout.isRunning()),Ma=!1,Sa={};function ls(M="data-swal-template"){Sa[M]=this,Ma||(document.body.addEventListener("click",pl),Ma=!0)}let pl=M=>{for(let E=M.target;E&&E!==document;E=E.parentNode)for(let F in Sa){let ne=E.getAttribute(F);if(ne){Sa[F].fire({template:ne});return}}};class Ns{constructor(){this.events={}}_getHandlersByEventName(E){return typeof this.events[E]>"u"&&(this.events[E]=[]),this.events[E]}on(E,F){let ne=this._getHandlersByEventName(E);ne.includes(F)||ne.push(F)}once(E,F){let ne=(...Oe)=>{this.removeListener(E,ne),F.apply(this,Oe)};this.on(E,ne)}emit(E,...F){this._getHandlersByEventName(E).forEach(ne=>{try{ne.apply(this,F)}catch(Oe){console.error(Oe)}})}removeListener(E,F){let ne=this._getHandlersByEventName(E),Oe=ne.indexOf(F);Oe>-1&&ne.splice(Oe,1)}removeAllListeners(E){this.events[E]!==void 0&&(this.events[E].length=0)}reset(){this.events={}}}T.eventEmitter=new Ns;var Mc=Object.freeze({__proto__:null,argsToParams:zu,bindClickHandler:ls,clickCancel:da,clickConfirm:Vt,clickDeny:ca,enableLoading:ns,fire:Bu,getActions:wn,getCancelButton:so,getCloseButton:Ko,getConfirmButton:tn,getContainer:Gi,getDenyButton:bn,getFocusableElements:$n,getFooter:Yo,getHtmlContainer:ci,getIcon:Gr,getIconContent:Ss,getImage:ro,getInputLabel:xn,getLoader:ar,getPopup:Tt,getProgressSteps:vr,getTimerLeft:Vu,getTimerProgressBar:Hr,getTitle:Ts,getValidationMessage:oo,increaseTimer:ul,isDeprecatedParameter:yc,isLoading:Zr,isTimerRunning:hl,isUpdatableParameter:uo,isValidParameter:ll,isVisible:is,mixin:Nu,off:(M,E)=>{if(!M){T.eventEmitter.reset();return}E?T.eventEmitter.removeListener(M,E):T.eventEmitter.removeAllListeners(M)},on:(M,E)=>{T.eventEmitter.on(M,E)},once:(M,E)=>{T.eventEmitter.once(M,E)},resumeTimer:Td,showLoading:ns,stopTimer:Cc,toggleTimer:Ed});class cs{constructor(E,F){this.callback=E,this.remaining=F,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(E){let F=this.running;return F&&this.stop(),this.remaining+=E,F&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}let Ta=["swal-title","swal-html","swal-footer"],fl=M=>{let E=typeof M.template=="string"?document.querySelector(M.template):M.template;if(!E)return{};let F=E.content;return Nt(F),Object.assign(Ea(F),ml(F),gl(F),Vs(F),js(F),Id(F),_l(F,Ta))},Ea=M=>{let E={};return Array.from(M.querySelectorAll("swal-param")).forEach(ne=>{Kr(ne,["name","value"]);let Oe=ne.getAttribute("name"),et=ne.getAttribute("value");!Oe||!et||(typeof Yr[Oe]=="boolean"?E[Oe]=et!=="false":typeof Yr[Oe]=="object"?E[Oe]=JSON.parse(et):E[Oe]=et)}),E},ml=M=>{let E={};return Array.from(M.querySelectorAll("swal-function-param")).forEach(ne=>{let Oe=ne.getAttribute("name"),et=ne.getAttribute("value");!Oe||!et||(E[Oe]=new Function(`return ${et}`)())}),E},gl=M=>{let E={};return Array.from(M.querySelectorAll("swal-button")).forEach(ne=>{Kr(ne,["type","color","aria-label"]);let Oe=ne.getAttribute("type");!Oe||!["confirm","cancel","deny"].includes(Oe)||(E[`${Oe}ButtonText`]=ne.innerHTML,E[`show${ut(Oe)}Button`]=!0,ne.hasAttribute("color")&&(E[`${Oe}ButtonColor`]=ne.getAttribute("color")),ne.hasAttribute("aria-label")&&(E[`${Oe}ButtonAriaLabel`]=ne.getAttribute("aria-label")))}),E},Vs=M=>{let E={},F=M.querySelector("swal-image");return F&&(Kr(F,["src","width","height","alt"]),F.hasAttribute("src")&&(E.imageUrl=F.getAttribute("src")||void 0),F.hasAttribute("width")&&(E.imageWidth=F.getAttribute("width")||void 0),F.hasAttribute("height")&&(E.imageHeight=F.getAttribute("height")||void 0),F.hasAttribute("alt")&&(E.imageAlt=F.getAttribute("alt")||void 0)),E},js=M=>{let E={},F=M.querySelector("swal-icon");return F&&(Kr(F,["type","color"]),F.hasAttribute("type")&&(E.icon=F.getAttribute("type")),F.hasAttribute("color")&&(E.iconColor=F.getAttribute("color")),E.iconHtml=F.innerHTML),E},Id=M=>{let E={},F=M.querySelector("swal-input");F&&(Kr(F,["type","label","placeholder","value"]),E.input=F.getAttribute("type")||"text",F.hasAttribute("label")&&(E.inputLabel=F.getAttribute("label")),F.hasAttribute("placeholder")&&(E.inputPlaceholder=F.getAttribute("placeholder")),F.hasAttribute("value")&&(E.inputValue=F.getAttribute("value")));let ne=Array.from(M.querySelectorAll("swal-input-option"));return ne.length&&(E.inputOptions={},ne.forEach(Oe=>{Kr(Oe,["value"]);let et=Oe.getAttribute("value");if(!et)return;let yt=Oe.innerHTML;E.inputOptions[et]=yt})),E},_l=(M,E)=>{let F={};for(let ne in E){let Oe=E[ne],et=M.querySelector(Oe);et&&(Kr(et,[]),F[Oe.replace(/^swal-/,"")]=et.innerHTML.trim())}return F},Nt=M=>{let E=Ta.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(M.children).forEach(F=>{let ne=F.tagName.toLowerCase();E.includes(ne)||lt(`Unrecognized element <${ne}>`)})},Kr=(M,E)=>{Array.from(M.attributes).forEach(F=>{E.indexOf(F.name)===-1&&lt([`Unrecognized attribute "${F.name}" on <${M.tagName.toLowerCase()}>.`,`${E.length?`Allowed attributes are: ${E.join(", ")}`:"To set the value, use HTML within the element."}`])})},Ia=10,Sc=M=>{let E=Gi(),F=Tt();typeof M.willOpen=="function"&&M.willOpen(F),T.eventEmitter.emit("willOpen",F);let Oe=window.getComputedStyle(document.body).overflowY;Pd(E,F,M),setTimeout(()=>{$u(E,F)},Ia),Cn()&&(Gu(E,M.scrollbarPadding,Oe),Ui()),!gi()&&!T.previousActiveElement&&(T.previousActiveElement=document.activeElement),typeof M.didOpen=="function"&&setTimeout(()=>M.didOpen(F)),T.eventEmitter.emit("didOpen",F),on(E,G["no-transition"])},zo=M=>{let E=Tt();if(M.target!==E)return;let F=Gi();E.removeEventListener("animationend",zo),E.removeEventListener("transitionend",zo),F.style.overflowY="auto"},$u=(M,E)=>{H(E)?(M.style.overflowY="hidden",E.addEventListener("animationend",zo),E.addEventListener("transitionend",zo)):M.style.overflowY="auto"},Gu=(M,E,F)=>{Ds(),E&&F!=="hidden"&&pa(F),setTimeout(()=>{M.scrollTop=0})},Pd=(M,E,F)=>{Xt(M,F.showClass.backdrop),F.animation?(E.style.setProperty("opacity","0","important"),Ni(E,"grid"),setTimeout(()=>{Xt(E,F.showClass.popup),E.style.removeProperty("opacity")},Ia)):Ni(E,"grid"),Xt([document.documentElement,document.body],G.shown),F.heightAuto&&F.backdrop&&!F.toast&&Xt([document.documentElement,document.body],G["height-auto"])};var kd={email:(M,E)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(M)?Promise.resolve():Promise.resolve(E||"Invalid email address"),url:(M,E)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(M)?Promise.resolve():Promise.resolve(E||"Invalid URL")};function yl(M){M.inputValidator||(M.input==="email"&&(M.inputValidator=kd.email),M.input==="url"&&(M.inputValidator=kd.url))}function Pa(M){(!M.target||typeof M.target=="string"&&!document.querySelector(M.target)||typeof M.target!="string"&&!M.target.appendChild)&&(lt('Target parameter is not valid, defaulting to "body"'),M.target="body")}function vl(M){yl(M),M.showLoaderOnConfirm&&!M.preConfirm&&lt(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),Pa(M),typeof M.title=="string"&&(M.title=M.title.split(`
`).join("<br />")),Ne(M)}let Cr;var ds=new WeakMap;class $i{constructor(...E){if(l(this,ds,void 0),typeof window>"u")return;Cr=this;let F=Object.freeze(this.constructor.argsToParams(E));this.params=F,this.isAwaitingPromise=!1,h(ds,this,this._main(Cr.params))}_main(E,F={}){if(wa(Object.assign({},F,E)),T.currentInstance){let et=oi.swalPromiseResolve.get(T.currentInstance),{isAwaitingPromise:yt}=T.currentInstance;T.currentInstance._destroy(),yt||et({isDismissed:!0}),Cn()&&jt()}T.currentInstance=Cr;let ne=Aa(E,F);vl(ne),Object.freeze(ne),T.timeout&&(T.timeout.stop(),delete T.timeout),clearTimeout(T.restoreFocusTimeout);let Oe=Da(Cr);return On(Cr,ne),St.innerParams.set(Cr,ne),ka(Cr,Oe,ne)}then(E){return i(ds,this).then(E)}finally(E){return i(ds,this).finally(E)}}let ka=(M,E,F)=>new Promise((ne,Oe)=>{let et=yt=>{M.close({isDismissed:!0,dismiss:yt})};oi.swalPromiseResolve.set(M,ne),oi.swalPromiseReject.set(M,Oe),E.confirmButton.onclick=()=>{Ou(M)},E.denyButton.onclick=()=>{Fu(M)},E.cancelButton.onclick=()=>{ol(M,et)},E.closeButton.onclick=()=>{et(Ar.close)},ti(F,E,et),Sn(T,F,et),Ln(M,F),Sc(F),Tc(T,F,et),Ra(E,F),setTimeout(()=>{E.container.scrollTop=0})}),Aa=(M,E)=>{let F=fl(M),ne=Object.assign({},Yr,E,F,M);return ne.showClass=Object.assign({},Yr.showClass,ne.showClass),ne.hideClass=Object.assign({},Yr.hideClass,ne.hideClass),ne.animation===!1&&(ne.showClass={backdrop:"swal2-noanimation"},ne.hideClass={}),ne},Da=M=>{let E={popup:Tt(),container:Gi(),actions:wn(),confirmButton:tn(),denyButton:bn(),cancelButton:so(),loader:ar(),closeButton:Ko(),validationMessage:oo(),progressSteps:vr()};return St.domCache.set(M,E),E},Tc=(M,E,F)=>{let ne=Hr();Ai(ne),E.timer&&(M.timeout=new cs(()=>{F("timer"),delete M.timeout},E.timer),E.timerProgressBar&&(Ni(ne),Mn(ne,E,"timerProgressBar"),setTimeout(()=>{M.timeout&&M.timeout.running&&Z(E.timer)})))},Ra=(M,E)=>{if(!E.toast){if(!Yi(E.allowEnterKey)){mi("allowEnterKey"),xl();return}bl(M)||Ad(M,E)||ji(-1,1)}},bl=M=>{let E=Array.from(M.popup.querySelectorAll("[autofocus]"));for(let F of E)if(F instanceof HTMLElement&&Ei(F))return F.focus(),!0;return!1},Ad=(M,E)=>E.focusDeny&&Ei(M.denyButton)?(M.denyButton.focus(),!0):E.focusCancel&&Ei(M.cancelButton)?(M.cancelButton.focus(),!0):E.focusConfirm&&Ei(M.confirmButton)?(M.confirmButton.focus(),!0):!1,xl=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){let M=new Date,E=localStorage.getItem("swal-initiation");E?(M.getTime()-Date.parse(E))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";let F=document.createElement("audio");F.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",F.loop=!0,document.body.appendChild(F),setTimeout(()=>{F.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${M}`)}$i.prototype.disableButtons=Lo,$i.prototype.enableButtons=fc,$i.prototype.getInput=Ls,$i.prototype.disableInput=gc,$i.prototype.enableInput=mc,$i.prototype.hideLoading=Fs,$i.prototype.disableLoading=Fs,$i.prototype.showValidationMessage=gd,$i.prototype.resetValidationMessage=_c,$i.prototype.close=tr,$i.prototype.closePopup=tr,$i.prototype.closeModal=tr,$i.prototype.closeToast=tr,$i.prototype.rejectPromise=Oo,$i.prototype.update=wd,$i.prototype._destroy=cl,Object.assign($i,Mc),Object.keys(Md).forEach(M=>{$i[M]=function(...E){return Cr&&Cr[M]?Cr[M](...E):null}}),$i.DismissReason=Ar,$i.version="11.22.0";let Us=$i;return Us.default=Us,Us});typeof ia<"u"&&ia.Sweetalert2&&(ia.swal=ia.sweetAlert=ia.Swal=ia.SweetAlert=ia.Sweetalert2);typeof document<"u"&&function(c,a){var i=c.createElement("style");if(c.getElementsByTagName("head")[0].appendChild(i),i.styleSheet)i.styleSheet.disabled||(i.styleSheet.cssText=a);else try{i.innerHTML=a}catch{i.innerText=a}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}')});var $h=class{},qf=class{},xs=class c{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(a){a?typeof a=="string"?this.lazyInit=()=>{this.headers=new Map,a.split(`
`).forEach(i=>{let l=i.indexOf(":");if(l>0){let h=i.slice(0,l),s=i.slice(l+1).trim();this.addHeaderEntry(h,s)}})}:typeof Headers<"u"&&a instanceof Headers?(this.headers=new Map,a.forEach((i,l)=>{this.addHeaderEntry(l,i)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(a).forEach(([i,l])=>{this.setHeaderEntries(i,l)})}:this.headers=new Map}has(a){return this.init(),this.headers.has(a.toLowerCase())}get(a){this.init();let i=this.headers.get(a.toLowerCase());return i&&i.length>0?i[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(a){return this.init(),this.headers.get(a.toLowerCase())||null}append(a,i){return this.clone({name:a,value:i,op:"a"})}set(a,i){return this.clone({name:a,value:i,op:"s"})}delete(a,i){return this.clone({name:a,value:i,op:"d"})}maybeSetNormalizedName(a,i){this.normalizedNames.has(i)||this.normalizedNames.set(i,a)}init(){this.lazyInit&&(this.lazyInit instanceof c?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(a=>this.applyUpdate(a)),this.lazyUpdate=null))}copyFrom(a){a.init(),Array.from(a.headers.keys()).forEach(i=>{this.headers.set(i,a.headers.get(i)),this.normalizedNames.set(i,a.normalizedNames.get(i))})}clone(a){let i=new c;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof c?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([a]),i}applyUpdate(a){let i=a.name.toLowerCase();switch(a.op){case"a":case"s":let l=a.value;if(typeof l=="string"&&(l=[l]),l.length===0)return;this.maybeSetNormalizedName(a.name,i);let h=(a.op==="a"?this.headers.get(i):void 0)||[];h.push(...l),this.headers.set(i,h);break;case"d":let s=a.value;if(!s)this.headers.delete(i),this.normalizedNames.delete(i);else{let T=this.headers.get(i);if(!T)return;T=T.filter(Y=>s.indexOf(Y)===-1),T.length===0?(this.headers.delete(i),this.normalizedNames.delete(i)):this.headers.set(i,T)}break}}addHeaderEntry(a,i){let l=a.toLowerCase();this.maybeSetNormalizedName(a,l),this.headers.has(l)?this.headers.get(l).push(i):this.headers.set(l,[i])}setHeaderEntries(a,i){let l=(Array.isArray(i)?i:[i]).map(s=>s.toString()),h=a.toLowerCase();this.headers.set(h,l),this.maybeSetNormalizedName(a,h)}forEach(a){this.init(),Array.from(this.normalizedNames.keys()).forEach(i=>a(this.normalizedNames.get(i),this.headers.get(i)))}};var q_=class{encodeKey(a){return wx(a)}encodeValue(a){return wx(a)}decodeKey(a){return decodeURIComponent(a)}decodeValue(a){return decodeURIComponent(a)}};function SM(c,a){let i=new Map;return c.length>0&&c.replace(/^\?/,"").split("&").forEach(h=>{let s=h.indexOf("="),[T,Y]=s==-1?[a.decodeKey(h),""]:[a.decodeKey(h.slice(0,s)),a.decodeValue(h.slice(s+1))],K=i.get(T)||[];K.push(Y),i.set(T,K)}),i}var TM=/%(\d[a-f0-9])/gi,EM={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function wx(c){return encodeURIComponent(c).replace(TM,(a,i)=>EM[i]??a)}function Zf(c){return`${c}`}var Js=class c{map;encoder;updates=null;cloneFrom=null;constructor(a={}){if(this.encoder=a.encoder||new q_,a.fromString){if(a.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=SM(a.fromString,this.encoder)}else a.fromObject?(this.map=new Map,Object.keys(a.fromObject).forEach(i=>{let l=a.fromObject[i],h=Array.isArray(l)?l.map(Zf):[Zf(l)];this.map.set(i,h)})):this.map=null}has(a){return this.init(),this.map.has(a)}get(a){this.init();let i=this.map.get(a);return i?i[0]:null}getAll(a){return this.init(),this.map.get(a)||null}keys(){return this.init(),Array.from(this.map.keys())}append(a,i){return this.clone({param:a,value:i,op:"a"})}appendAll(a){let i=[];return Object.keys(a).forEach(l=>{let h=a[l];Array.isArray(h)?h.forEach(s=>{i.push({param:l,value:s,op:"a"})}):i.push({param:l,value:h,op:"a"})}),this.clone(i)}set(a,i){return this.clone({param:a,value:i,op:"s"})}delete(a,i){return this.clone({param:a,value:i,op:"d"})}toString(){return this.init(),this.keys().map(a=>{let i=this.encoder.encodeKey(a);return this.map.get(a).map(l=>i+"="+this.encoder.encodeValue(l)).join("&")}).filter(a=>a!=="").join("&")}clone(a){let i=new c({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(a),i}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(a=>this.map.set(a,this.cloneFrom.map.get(a))),this.updates.forEach(a=>{switch(a.op){case"a":case"s":let i=(a.op==="a"?this.map.get(a.param):void 0)||[];i.push(Zf(a.value)),this.map.set(a.param,i);break;case"d":if(a.value!==void 0){let l=this.map.get(a.param)||[],h=l.indexOf(Zf(a.value));h!==-1&&l.splice(h,1),l.length>0?this.map.set(a.param,l):this.map.delete(a.param)}else{this.map.delete(a.param);break}}}),this.cloneFrom=this.updates=null)}};var W_=class{map=new Map;set(a,i){return this.map.set(a,i),this}get(a){return this.map.has(a)||this.map.set(a,a.defaultValue()),this.map.get(a)}delete(a){return this.map.delete(a),this}has(a){return this.map.has(a)}keys(){return this.map.keys()}};function IM(c){switch(c){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Cx(c){return typeof ArrayBuffer<"u"&&c instanceof ArrayBuffer}function Mx(c){return typeof Blob<"u"&&c instanceof Blob}function Sx(c){return typeof FormData<"u"&&c instanceof FormData}function PM(c){return typeof URLSearchParams<"u"&&c instanceof URLSearchParams}var Uh=class c{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(a,i,l,h){this.url=i,this.method=a.toUpperCase();let s;if(IM(this.method)||h?(this.body=l!==void 0?l:null,s=h):s=l,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new xs,this.context??=new W_,!this.params)this.params=new Js,this.urlWithParams=i;else{let T=this.params.toString();if(T.length===0)this.urlWithParams=i;else{let Y=i.indexOf("?"),K=Y===-1?"?":Y<i.length-1?"&":"";this.urlWithParams=i+K+T}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Cx(this.body)||Mx(this.body)||Sx(this.body)||PM(this.body)?this.body:this.body instanceof Js?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Sx(this.body)?null:Mx(this.body)?this.body.type||null:Cx(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Js?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(a={}){let i=a.method||this.method,l=a.url||this.url,h=a.responseType||this.responseType,s=a.transferCache??this.transferCache,T=a.body!==void 0?a.body:this.body,Y=a.withCredentials??this.withCredentials,K=a.reportProgress??this.reportProgress,Ce=a.headers||this.headers,be=a.params||this.params,G=a.context??this.context;return a.setHeaders!==void 0&&(Ce=Object.keys(a.setHeaders).reduce(($e,ft)=>$e.set(ft,a.setHeaders[ft]),Ce)),a.setParams&&(be=Object.keys(a.setParams).reduce(($e,ft)=>$e.set(ft,a.setParams[ft]),be)),new c(i,l,T,{params:be,headers:Ce,context:G,reportProgress:K,responseType:h,withCredentials:Y,transferCache:s})}},ql=function(c){return c[c.Sent=0]="Sent",c[c.UploadProgress=1]="UploadProgress",c[c.ResponseHeader=2]="ResponseHeader",c[c.DownloadProgress=3]="DownloadProgress",c[c.Response=4]="Response",c[c.User=5]="User",c}(ql||{}),Gh=class{headers;status;statusText;url;ok;type;constructor(a,i=200,l="OK"){this.headers=a.headers||new xs,this.status=a.status!==void 0?a.status:i,this.statusText=a.statusText||l,this.url=a.url||null,this.ok=this.status>=200&&this.status<300}},Wf=class c extends Gh{constructor(a={}){super(a)}type=ql.ResponseHeader;clone(a={}){return new c({headers:a.headers||this.headers,status:a.status!==void 0?a.status:this.status,statusText:a.statusText||this.statusText,url:a.url||this.url||void 0})}},Hh=class c extends Gh{body;constructor(a={}){super(a),this.body=a.body!==void 0?a.body:null}type=ql.Response;clone(a={}){return new c({body:a.body!==void 0?a.body:this.body,headers:a.headers||this.headers,status:a.status!==void 0?a.status:this.status,statusText:a.statusText||this.statusText,url:a.url||this.url||void 0})}},Zl=class extends Gh{name="HttpErrorResponse";message;error;ok=!1;constructor(a){super(a,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${a.url||"(unknown url)"}`:this.message=`Http failure response for ${a.url||"(unknown url)"}: ${a.status} ${a.statusText}`,this.error=a.error||null}},kx=200,kM=204;function Z_(c,a){return{body:a,headers:c.headers,context:c.context,observe:c.observe,params:c.params,reportProgress:c.reportProgress,responseType:c.responseType,withCredentials:c.withCredentials,transferCache:c.transferCache}}var ws=(()=>{class c{handler;constructor(i){this.handler=i}request(i,l,h={}){let s;if(i instanceof Uh)s=i;else{let K;h.headers instanceof xs?K=h.headers:K=new xs(h.headers);let Ce;h.params&&(h.params instanceof Js?Ce=h.params:Ce=new Js({fromObject:h.params})),s=new Uh(i,l,h.body!==void 0?h.body:null,{headers:K,context:h.context,params:Ce,reportProgress:h.reportProgress,responseType:h.responseType||"json",withCredentials:h.withCredentials,transferCache:h.transferCache})}let T=bt(s).pipe(jl(K=>this.handler.handle(K)));if(i instanceof Uh||h.observe==="events")return T;let Y=T.pipe(vn(K=>K instanceof Hh));switch(h.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return Y.pipe(kt(K=>{if(K.body!==null&&!(K.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return K.body}));case"blob":return Y.pipe(kt(K=>{if(K.body!==null&&!(K.body instanceof Blob))throw new Error("Response is not a Blob.");return K.body}));case"text":return Y.pipe(kt(K=>{if(K.body!==null&&typeof K.body!="string")throw new Error("Response is not a string.");return K.body}));case"json":default:return Y.pipe(kt(K=>K.body))}case"response":return Y;default:throw new Error(`Unreachable: unhandled observe type ${h.observe}}`)}}delete(i,l={}){return this.request("DELETE",i,l)}get(i,l={}){return this.request("GET",i,l)}head(i,l={}){return this.request("HEAD",i,l)}jsonp(i,l){return this.request("JSONP",i,{params:new Js().append(l,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,l={}){return this.request("OPTIONS",i,l)}patch(i,l,h={}){return this.request("PATCH",i,Z_(h,l))}post(i,l,h={}){return this.request("POST",i,Z_(h,l))}put(i,l,h={}){return this.request("PUT",i,Z_(h,l))}static \u0275fac=function(l){return new(l||c)(zt($h))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),AM=/^\)\]\}',?\n/,DM="X-Request-URL";function Tx(c){if(c.url)return c.url;let a=DM.toLocaleLowerCase();return c.headers.get(a)}var RM=(()=>{class c{fetchImpl=me(X_,{optional:!0})?.fetch??((...i)=>globalThis.fetch(...i));ngZone=me(hi);handle(i){return new Na(l=>{let h=new AbortController;return this.doRequest(i,h.signal,l).then(Y_,s=>l.error(new Zl({error:s}))),()=>h.abort()})}doRequest(i,l,h){return tu(this,null,function*(){let s=this.createRequestInit(i),T;try{let ft=this.ngZone.runOutsideAngular(()=>this.fetchImpl(i.urlWithParams,Ye({signal:l},s)));OM(ft),h.next({type:ql.Sent}),T=yield ft}catch(ft){h.error(new Zl({error:ft,status:ft.status??0,statusText:ft.statusText,url:i.urlWithParams,headers:ft.headers}));return}let Y=new xs(T.headers),K=T.statusText,Ce=Tx(T)??i.urlWithParams,be=T.status,G=null;if(i.reportProgress&&h.next(new Wf({headers:Y,status:be,statusText:K,url:Ce})),T.body){let ft=T.headers.get("content-length"),Ct=[],ut=T.body.getReader(),lt=0,vi,bi,Et=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>tu(this,null,function*(){for(;;){let{done:Yi,value:li}=yield ut.read();if(Yi)break;if(Ct.push(li),lt+=li.length,i.reportProgress){bi=i.responseType==="text"?(bi??"")+(vi??=new TextDecoder).decode(li,{stream:!0}):void 0;let Ir=()=>h.next({type:ql.DownloadProgress,total:ft?+ft:void 0,loaded:lt,partialText:bi});Et?Et.run(Ir):Ir()}}}));let mi=this.concatChunks(Ct,lt);try{let Yi=T.headers.get("Content-Type")??"";G=this.parseBody(i,mi,Yi)}catch(Yi){h.error(new Zl({error:Yi,headers:new xs(T.headers),status:T.status,statusText:T.statusText,url:Tx(T)??i.urlWithParams}));return}}be===0&&(be=G?kx:0),be>=200&&be<300?(h.next(new Hh({body:G,headers:Y,status:be,statusText:K,url:Ce})),h.complete()):h.error(new Zl({error:G,headers:Y,status:be,statusText:K,url:Ce}))})}parseBody(i,l,h){switch(i.responseType){case"json":let s=new TextDecoder().decode(l).replace(AM,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(l);case"blob":return new Blob([l],{type:h});case"arraybuffer":return l.buffer}}createRequestInit(i){let l={},h=i.withCredentials?"include":void 0;if(i.headers.forEach((s,T)=>l[s]=T.join(",")),i.headers.has("Accept")||(l.Accept="application/json, text/plain, */*"),!i.headers.has("Content-Type")){let s=i.detectContentTypeHeader();s!==null&&(l["Content-Type"]=s)}return{body:i.serializeBody(),method:i.method,headers:l,credentials:h}}concatChunks(i,l){let h=new Uint8Array(l),s=0;for(let T of i)h.set(T,s),s+=T.length;return h}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),X_=class{};function Y_(){}function OM(c){c.then(Y_,Y_)}function Ax(c,a){return a(c)}function FM(c,a){return(i,l)=>a.intercept(i,{handle:h=>c(h,l)})}function LM(c,a,i){return(l,h)=>Go(i,()=>a(l,s=>c(s,h)))}var zM=new ct(""),K_=new ct(""),BM=new ct(""),Dx=new ct("",{providedIn:"root",factory:()=>!0});function NM(){let c=null;return(a,i)=>{c===null&&(c=(me(zM,{optional:!0})??[]).reduceRight(FM,Ax));let l=me(Rh);if(me(Dx)){let s=l.add();return c(a,i).pipe(Va(()=>l.remove(s)))}else return c(a,i)}}var Ex=(()=>{class c extends $h{backend;injector;chain=null;pendingTasks=me(Rh);contributeToStability=me(Dx);constructor(i,l){super(),this.backend=i,this.injector=l}handle(i){if(this.chain===null){let l=Array.from(new Set([...this.injector.get(K_),...this.injector.get(BM,[])]));this.chain=l.reduceRight((h,s)=>LM(h,s,this.injector),Ax)}if(this.contributeToStability){let l=this.pendingTasks.add();return this.chain(i,h=>this.backend.handle(h)).pipe(Va(()=>this.pendingTasks.remove(l)))}else return this.chain(i,l=>this.backend.handle(l))}static \u0275fac=function(l){return new(l||c)(zt(qf),zt(vs))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})();var VM=/^\)\]\}',?\n/;function jM(c){return"responseURL"in c&&c.responseURL?c.responseURL:/^X-Request-URL:/m.test(c.getAllResponseHeaders())?c.getResponseHeader("X-Request-URL"):null}var Ix=(()=>{class c{xhrFactory;constructor(i){this.xhrFactory=i}handle(i){if(i.method==="JSONP")throw new ki(-2800,!1);let l=this.xhrFactory;return(l.\u0275loadImpl?mr(l.\u0275loadImpl()):bt(null)).pipe(gr(()=>new Na(s=>{let T=l.build();if(T.open(i.method,i.urlWithParams),i.withCredentials&&(T.withCredentials=!0),i.headers.forEach((ut,lt)=>T.setRequestHeader(ut,lt.join(","))),i.headers.has("Accept")||T.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){let ut=i.detectContentTypeHeader();ut!==null&&T.setRequestHeader("Content-Type",ut)}if(i.responseType){let ut=i.responseType.toLowerCase();T.responseType=ut!=="json"?ut:"text"}let Y=i.serializeBody(),K=null,Ce=()=>{if(K!==null)return K;let ut=T.statusText||"OK",lt=new xs(T.getAllResponseHeaders()),vi=jM(T)||i.url;return K=new Wf({headers:lt,status:T.status,statusText:ut,url:vi}),K},be=()=>{let{headers:ut,status:lt,statusText:vi,url:bi}=Ce(),Et=null;lt!==kM&&(Et=typeof T.response>"u"?T.responseText:T.response),lt===0&&(lt=Et?kx:0);let mi=lt>=200&&lt<300;if(i.responseType==="json"&&typeof Et=="string"){let Yi=Et;Et=Et.replace(VM,"");try{Et=Et!==""?JSON.parse(Et):null}catch(li){Et=Yi,mi&&(mi=!1,Et={error:li,text:Et})}}mi?(s.next(new Hh({body:Et,headers:ut,status:lt,statusText:vi,url:bi||void 0})),s.complete()):s.error(new Zl({error:Et,headers:ut,status:lt,statusText:vi,url:bi||void 0}))},G=ut=>{let{url:lt}=Ce(),vi=new Zl({error:ut,status:T.status||0,statusText:T.statusText||"Unknown Error",url:lt||void 0});s.error(vi)},$e=!1,ft=ut=>{$e||(s.next(Ce()),$e=!0);let lt={type:ql.DownloadProgress,loaded:ut.loaded};ut.lengthComputable&&(lt.total=ut.total),i.responseType==="text"&&T.responseText&&(lt.partialText=T.responseText),s.next(lt)},Ct=ut=>{let lt={type:ql.UploadProgress,loaded:ut.loaded};ut.lengthComputable&&(lt.total=ut.total),s.next(lt)};return T.addEventListener("load",be),T.addEventListener("error",G),T.addEventListener("timeout",G),T.addEventListener("abort",G),i.reportProgress&&(T.addEventListener("progress",ft),Y!==null&&T.upload&&T.upload.addEventListener("progress",Ct)),T.send(Y),s.next({type:ql.Sent}),()=>{T.removeEventListener("error",G),T.removeEventListener("abort",G),T.removeEventListener("load",be),T.removeEventListener("timeout",G),i.reportProgress&&(T.removeEventListener("progress",ft),Y!==null&&T.upload&&T.upload.removeEventListener("progress",Ct)),T.readyState!==T.DONE&&T.abort()}})))}static \u0275fac=function(l){return new(l||c)(zt(Gf))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),Rx=new ct(""),UM="XSRF-TOKEN",$M=new ct("",{providedIn:"root",factory:()=>UM}),GM="X-XSRF-TOKEN",HM=new ct("",{providedIn:"root",factory:()=>GM}),Xf=class{},ZM=(()=>{class c{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(i,l,h){this.doc=i,this.platform=l,this.cookieName=h}getToken(){if(this.platform==="server")return null;let i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=Nf(i,this.cookieName),this.lastCookieString=i),this.lastToken}static \u0275fac=function(l){return new(l||c)(zt(fi),zt(ja),zt($M))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})();function qM(c,a){let i=c.url.toLowerCase();if(!me(Rx)||c.method==="GET"||c.method==="HEAD"||i.startsWith("http://")||i.startsWith("https://"))return a(c);let l=me(Xf).getToken(),h=me(HM);return l!=null&&!c.headers.has(h)&&(c=c.clone({headers:c.headers.set(h,l)})),a(c)}var Ox=function(c){return c[c.Interceptors=0]="Interceptors",c[c.LegacyInterceptors=1]="LegacyInterceptors",c[c.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",c[c.NoXsrfProtection=3]="NoXsrfProtection",c[c.JsonpSupport=4]="JsonpSupport",c[c.RequestsMadeViaParent=5]="RequestsMadeViaParent",c[c.Fetch=6]="Fetch",c}(Ox||{});function WM(c,a){return{\u0275kind:c,\u0275providers:a}}function Q_(...c){let a=[ws,Ix,Ex,{provide:$h,useExisting:Ex},{provide:qf,useFactory:()=>me(RM,{optional:!0})??me(Ix)},{provide:K_,useValue:qM,multi:!0},{provide:Rx,useValue:!0},{provide:Xf,useClass:ZM}];for(let i of c)a.push(...i.\u0275providers);return Hc(a)}var Px=new ct("");function XM(){return WM(Ox.LegacyInterceptors,[{provide:Px,useFactory:NM},{provide:K_,useExisting:Px,multi:!0}])}var Wl=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({providers:[Q_(XM())]})}return c})();var e0=class extends hx{supportsDOMEvents=!0},t0=class c extends e0{static makeCurrent(){ux(new c)}onAndCancel(a,i,l){return a.addEventListener(i,l),()=>{a.removeEventListener(i,l)}}dispatchEvent(a,i){a.dispatchEvent(i)}remove(a){a.remove()}createElement(a,i){return i=i||this.getDefaultDocument(),i.createElement(a)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(a){return a.nodeType===Node.ELEMENT_NODE}isShadowRoot(a){return a instanceof DocumentFragment}getGlobalEventTarget(a,i){return i==="window"?window:i==="document"?a:i==="body"?a.body:null}getBaseHref(a){let i=KM();return i==null?null:QM(i)}resetBaseElement(){Wh=null}getUserAgent(){return window.navigator.userAgent}getCookie(a){return Nf(document.cookie,a)}},Wh=null;function KM(){return Wh=Wh||document.querySelector("base"),Wh?Wh.getAttribute("href"):null}function QM(c){return new URL(c,document.baseURI).pathname}var JM=(()=>{class c{build(){return new XMLHttpRequest}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),i0=new ct(""),Nx=(()=>{class c{_zone;_plugins;_eventNameToPlugin=new Map;constructor(i,l){this._zone=l,i.forEach(h=>{h.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,l,h){return this._findPluginFor(l).addEventListener(i,l,h)}getZone(){return this._zone}_findPluginFor(i){let l=this._eventNameToPlugin.get(i);if(l)return l;if(l=this._plugins.find(s=>s.supports(i)),!l)throw new ki(5101,!1);return this._eventNameToPlugin.set(i,l),l}static \u0275fac=function(l){return new(l||c)(zt(i0),zt(hi))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),Yf=class{_doc;constructor(a){this._doc=a}manager},n0="ng-app-id";function Fx(c){for(let a of c)a.remove()}function Lx(c,a){let i=a.createElement("style");return i.textContent=c,i}function eS(c,a,i){let l=c.head?.querySelectorAll(`style[${n0}="${a}"]`);if(l)for(let h of l)h.textContent&&(h.removeAttribute(n0),i.set(h.textContent,{usage:0,elements:[h]}))}function r0(c,a){let i=a.createElement("link");return i.setAttribute("rel","stylesheet"),i.setAttribute("href",c),i}var Vx=(()=>{class c{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(i,l,h,s={}){this.doc=i,this.appId=l,this.nonce=h,this.isServer=$f(s),eS(i,l,this.inline),this.hosts.add(i.head)}addStyles(i,l){for(let h of i)this.addUsage(h,this.inline,Lx);l?.forEach(h=>this.addUsage(h,this.external,r0))}removeStyles(i,l){for(let h of i)this.removeUsage(h,this.inline);l?.forEach(h=>this.removeUsage(h,this.external))}addUsage(i,l,h){let s=l.get(i);s?s.usage++:l.set(i,{usage:1,elements:[...this.hosts].map(T=>this.addElement(T,h(i,this.doc)))})}removeUsage(i,l){let h=l.get(i);h&&(h.usage--,h.usage<=0&&(Fx(h.elements),l.delete(i)))}ngOnDestroy(){for(let[,{elements:i}]of[...this.inline,...this.external])Fx(i);this.hosts.clear()}addHost(i){this.hosts.add(i);for(let[l,{elements:h}]of this.inline)h.push(this.addElement(i,Lx(l,this.doc)));for(let[l,{elements:h}]of this.external)h.push(this.addElement(i,r0(l,this.doc)))}removeHost(i){this.hosts.delete(i)}addElement(i,l){return this.nonce&&l.setAttribute("nonce",this.nonce),this.isServer&&l.setAttribute(n0,this.appId),i.appendChild(l)}static \u0275fac=function(l){return new(l||c)(zt(fi),zt(Oh),zt(Fh,8),zt(ja))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),J_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},a0=/%COMP%/g,jx="%COMP%",tS=`_nghost-${jx}`,iS=`_ngcontent-${jx}`,nS=!0,rS=new ct("",{providedIn:"root",factory:()=>nS});function oS(c){return iS.replace(a0,c)}function sS(c){return tS.replace(a0,c)}function Ux(c,a){return a.map(i=>i.replace(a0,c))}var Kf=(()=>{class c{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(i,l,h,s,T,Y,K,Ce=null){this.eventManager=i,this.sharedStylesHost=l,this.appId=h,this.removeStylesOnCompDestroy=s,this.doc=T,this.platformId=Y,this.ngZone=K,this.nonce=Ce,this.platformIsServer=$f(Y),this.defaultRenderer=new Xh(i,T,K,this.platformIsServer)}createRenderer(i,l){if(!i||!l)return this.defaultRenderer;this.platformIsServer&&l.encapsulation===Lh.ShadowDom&&(l=si(Ye({},l),{encapsulation:Lh.Emulated}));let h=this.getOrCreateRenderer(i,l);return h instanceof Qf?h.applyToHost(i):h instanceof Yh&&h.applyStyles(),h}getOrCreateRenderer(i,l){let h=this.rendererByCompId,s=h.get(l.id);if(!s){let T=this.doc,Y=this.ngZone,K=this.eventManager,Ce=this.sharedStylesHost,be=this.removeStylesOnCompDestroy,G=this.platformIsServer;switch(l.encapsulation){case Lh.Emulated:s=new Qf(K,Ce,l,this.appId,be,T,Y,G);break;case Lh.ShadowDom:return new o0(K,Ce,i,l,T,Y,this.nonce,G);default:s=new Yh(K,Ce,l,be,T,Y,G);break}h.set(l.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static \u0275fac=function(l){return new(l||c)(zt(Nx),zt(Vx),zt(Oh),zt(rS),zt(fi),zt(ja),zt(hi),zt(Fh))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),Xh=class{eventManager;doc;ngZone;platformIsServer;data=Object.create(null);throwOnSyntheticProps=!0;constructor(a,i,l,h){this.eventManager=a,this.doc=i,this.ngZone=l,this.platformIsServer=h}destroy(){}destroyNode=null;createElement(a,i){return i?this.doc.createElementNS(J_[i]||i,a):this.doc.createElement(a)}createComment(a){return this.doc.createComment(a)}createText(a){return this.doc.createTextNode(a)}appendChild(a,i){(zx(a)?a.content:a).appendChild(i)}insertBefore(a,i,l){a&&(zx(a)?a.content:a).insertBefore(i,l)}removeChild(a,i){i.remove()}selectRootElement(a,i){let l=typeof a=="string"?this.doc.querySelector(a):a;if(!l)throw new ki(-5104,!1);return i||(l.textContent=""),l}parentNode(a){return a.parentNode}nextSibling(a){return a.nextSibling}setAttribute(a,i,l,h){if(h){i=h+":"+i;let s=J_[h];s?a.setAttributeNS(s,i,l):a.setAttribute(i,l)}else a.setAttribute(i,l)}removeAttribute(a,i,l){if(l){let h=J_[l];h?a.removeAttributeNS(h,i):a.removeAttribute(`${l}:${i}`)}else a.removeAttribute(i)}addClass(a,i){a.classList.add(i)}removeClass(a,i){a.classList.remove(i)}setStyle(a,i,l,h){h&(zh.DashCase|zh.Important)?a.style.setProperty(i,l,h&zh.Important?"important":""):a.style[i]=l}removeStyle(a,i,l){l&zh.DashCase?a.style.removeProperty(i):a.style[i]=""}setProperty(a,i,l){a!=null&&(a[i]=l)}setValue(a,i){a.nodeValue=i}listen(a,i,l){if(typeof a=="string"&&(a=lu().getGlobalEventTarget(this.doc,a),!a))throw new Error(`Unsupported event target ${a} for event ${i}`);return this.eventManager.addEventListener(a,i,this.decoratePreventDefault(l))}decoratePreventDefault(a){return i=>{if(i==="__ngUnwrap__")return a;(this.platformIsServer?this.ngZone.runGuarded(()=>a(i)):a(i))===!1&&i.preventDefault()}}};function zx(c){return c.tagName==="TEMPLATE"&&c.content!==void 0}var o0=class extends Xh{sharedStylesHost;hostEl;shadowRoot;constructor(a,i,l,h,s,T,Y,K){super(a,s,T,K),this.sharedStylesHost=i,this.hostEl=l,this.shadowRoot=l.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let Ce=Ux(h.id,h.styles);for(let G of Ce){let $e=document.createElement("style");Y&&$e.setAttribute("nonce",Y),$e.textContent=G,this.shadowRoot.appendChild($e)}let be=h.getExternalStyles?.();if(be)for(let G of be){let $e=r0(G,s);Y&&$e.setAttribute("nonce",Y),this.shadowRoot.appendChild($e)}}nodeOrShadowRoot(a){return a===this.hostEl?this.shadowRoot:a}appendChild(a,i){return super.appendChild(this.nodeOrShadowRoot(a),i)}insertBefore(a,i,l){return super.insertBefore(this.nodeOrShadowRoot(a),i,l)}removeChild(a,i){return super.removeChild(null,i)}parentNode(a){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(a)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Yh=class extends Xh{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(a,i,l,h,s,T,Y,K){super(a,s,T,Y),this.sharedStylesHost=i,this.removeStylesOnCompDestroy=h,this.styles=K?Ux(K,l.styles):l.styles,this.styleUrls=l.getExternalStyles?.(K)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Qf=class extends Yh{contentAttr;hostAttr;constructor(a,i,l,h,s,T,Y,K){let Ce=h+"-"+l.id;super(a,i,l,s,T,Y,K,Ce),this.contentAttr=oS(Ce),this.hostAttr=sS(Ce)}applyToHost(a){this.applyStyles(),this.setAttribute(a,this.hostAttr,"")}createElement(a,i){let l=super.createElement(a,i);return super.setAttribute(l,this.contentAttr,""),l}},aS=(()=>{class c extends Yf{constructor(i){super(i)}supports(i){return!0}addEventListener(i,l,h){return i.addEventListener(l,h,!1),()=>this.removeEventListener(i,l,h)}removeEventListener(i,l,h){return i.removeEventListener(l,h)}static \u0275fac=function(l){return new(l||c)(zt(fi))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),Bx=["alt","control","meta","shift"],lS={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},cS={alt:c=>c.altKey,control:c=>c.ctrlKey,meta:c=>c.metaKey,shift:c=>c.shiftKey},dS=(()=>{class c extends Yf{constructor(i){super(i)}supports(i){return c.parseEventName(i)!=null}addEventListener(i,l,h){let s=c.parseEventName(l),T=c.eventCallback(s.fullKey,h,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>lu().onAndCancel(i,s.domEventName,T))}static parseEventName(i){let l=i.toLowerCase().split("."),h=l.shift();if(l.length===0||!(h==="keydown"||h==="keyup"))return null;let s=c._normalizeKey(l.pop()),T="",Y=l.indexOf("code");if(Y>-1&&(l.splice(Y,1),T="code."),Bx.forEach(Ce=>{let be=l.indexOf(Ce);be>-1&&(l.splice(be,1),T+=Ce+".")}),T+=s,l.length!=0||s.length===0)return null;let K={};return K.domEventName=h,K.fullKey=T,K}static matchEventFullKeyCode(i,l){let h=lS[i.key]||i.key,s="";return l.indexOf("code.")>-1&&(h=i.code,s="code."),h==null||!h?!1:(h=h.toLowerCase(),h===" "?h="space":h==="."&&(h="dot"),Bx.forEach(T=>{if(T!==h){let Y=cS[T];Y(i)&&(s+=T+".")}}),s+=h,s===l)}static eventCallback(i,l,h){return s=>{c.matchEventFullKeyCode(s,i)&&h.runGuarded(()=>l(s))}}static _normalizeKey(i){return i==="esc"?"escape":i}static \u0275fac=function(l){return new(l||c)(zt(fi))};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})();function $x(c,a){return lx(Ye({rootComponent:c},uS(a)))}function uS(c){return{appProviders:[...gS,...c?.providers??[]],platformProviders:mS}}function hS(){t0.makeCurrent()}function pS(){return new qc}function fS(){return qb(document),document}var mS=[{provide:ja,useValue:_x},{provide:Wb,useValue:hS,multi:!0},{provide:fi,useFactory:fS,deps:[]}];var gS=[{provide:$b,useValue:"root"},{provide:qc,useFactory:pS,deps:[]},{provide:i0,useClass:aS,multi:!0,deps:[fi,hi,ja]},{provide:i0,useClass:dS,multi:!0,deps:[fi]},Kf,Vx,Nx,{provide:kf,useExisting:Kf},{provide:Gf,useClass:JM,deps:[]},[]];var Gx=(()=>{class c{_doc;constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}static \u0275fac=function(l){return new(l||c)(zt(fi))};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var l0=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:function(l){let h=null;return l?h=new(l||c):h=zt(_S),h},providedIn:"root"})}return c})(),_S=(()=>{class c extends l0{_doc;constructor(i){super(),this._doc=i}sanitize(i,l){if(l==null)return null;switch(i){case Co.NONE:return l;case Co.HTML:return ou(l,"HTML")?ru(l):tx(this._doc,String(l)).toString();case Co.STYLE:return ou(l,"Style")?ru(l):l;case Co.SCRIPT:if(ou(l,"Script"))return ru(l);throw new ki(5200,!1);case Co.URL:return ou(l,"URL")?ru(l):ex(String(l));case Co.RESOURCE_URL:if(ou(l,"ResourceURL"))return ru(l);throw new ki(5201,!1);default:throw new ki(5202,!1)}}bypassSecurityTrustHtml(i){return Xb(i)}bypassSecurityTrustStyle(i){return Yb(i)}bypassSecurityTrustScript(i){return Kb(i)}bypassSecurityTrustUrl(i){return Qb(i)}bypassSecurityTrustResourceUrl(i){return Jb(i)}static \u0275fac=function(l){return new(l||c)(zt(fi))};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var Kt="primary",hp=Symbol("RouteTitle"),p0=class{params;constructor(a){this.params=a||{}}has(a){return Object.prototype.hasOwnProperty.call(this.params,a)}get(a){if(this.has(a)){let i=this.params[a];return Array.isArray(i)?i[0]:i}return null}getAll(a){if(this.has(a)){let i=this.params[a];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}};function mu(c){return new p0(c)}function yS(c,a,i){let l=i.path.split("/");if(l.length>c.length||i.pathMatch==="full"&&(a.hasChildren()||l.length<c.length))return null;let h={};for(let s=0;s<l.length;s++){let T=l[s],Y=c[s];if(T[0]===":")h[T.substring(1)]=Y;else if(T!==Y.path)return null}return{consumed:c.slice(0,l.length),posParams:h}}function vS(c,a){if(c.length!==a.length)return!1;for(let i=0;i<c.length;++i)if(!ea(c[i],a[i]))return!1;return!0}function ea(c,a){let i=c?f0(c):void 0,l=a?f0(a):void 0;if(!i||!l||i.length!=l.length)return!1;let h;for(let s=0;s<i.length;s++)if(h=i[s],!iw(c[h],a[h]))return!1;return!0}function f0(c){return[...Object.keys(c),...Object.getOwnPropertySymbols(c)]}function iw(c,a){if(Array.isArray(c)&&Array.isArray(a)){if(c.length!==a.length)return!1;let i=[...c].sort(),l=[...a].sort();return i.every((h,s)=>l[s]===h)}else return c===a}function nw(c){return c.length>0?c[c.length-1]:null}function Yl(c){return Ih(c)?c:Df(c)?mr(Promise.resolve(c)):bt(c)}var bS={exact:ow,subset:sw},rw={exact:xS,subset:wS,ignored:()=>!0};function Zx(c,a,i){return bS[i.paths](c.root,a.root,i.matrixParams)&&rw[i.queryParams](c.queryParams,a.queryParams)&&!(i.fragment==="exact"&&c.fragment!==a.fragment)}function xS(c,a){return ea(c,a)}function ow(c,a,i){if(!Jc(c.segments,a.segments)||!tm(c.segments,a.segments,i)||c.numberOfChildren!==a.numberOfChildren)return!1;for(let l in a.children)if(!c.children[l]||!ow(c.children[l],a.children[l],i))return!1;return!0}function wS(c,a){return Object.keys(a).length<=Object.keys(c).length&&Object.keys(a).every(i=>iw(c[i],a[i]))}function sw(c,a,i){return aw(c,a,a.segments,i)}function aw(c,a,i,l){if(c.segments.length>i.length){let h=c.segments.slice(0,i.length);return!(!Jc(h,i)||a.hasChildren()||!tm(h,i,l))}else if(c.segments.length===i.length){if(!Jc(c.segments,i)||!tm(c.segments,i,l))return!1;for(let h in a.children)if(!c.children[h]||!sw(c.children[h],a.children[h],l))return!1;return!0}else{let h=i.slice(0,c.segments.length),s=i.slice(c.segments.length);return!Jc(c.segments,h)||!tm(c.segments,h,l)||!c.children[Kt]?!1:aw(c.children[Kt],a,s,l)}}function tm(c,a,i){return a.every((l,h)=>rw[i](c[h].parameters,l.parameters))}var Ha=class{root;queryParams;fragment;_queryParamMap;constructor(a=new Ti([],{}),i={},l=null){this.root=a,this.queryParams=i,this.fragment=l}get queryParamMap(){return this._queryParamMap??=mu(this.queryParams),this._queryParamMap}toString(){return SS.serialize(this)}},Ti=class{segments;children;parent=null;constructor(a,i){this.segments=a,this.children=i,Object.values(i).forEach(l=>l.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return im(this)}},Qc=class{path;parameters;_parameterMap;constructor(a,i){this.path=a,this.parameters=i}get parameterMap(){return this._parameterMap??=mu(this.parameters),this._parameterMap}toString(){return cw(this)}};function CS(c,a){return Jc(c,a)&&c.every((i,l)=>ea(i.parameters,a[l].parameters))}function Jc(c,a){return c.length!==a.length?!1:c.every((i,l)=>i.path===a[l].path)}function MS(c,a){let i=[];return Object.entries(c.children).forEach(([l,h])=>{l===Kt&&(i=i.concat(a(h,l)))}),Object.entries(c.children).forEach(([l,h])=>{l!==Kt&&(i=i.concat(a(h,l)))}),i}var pp=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:()=>new gu,providedIn:"root"})}return c})(),gu=class{parse(a){let i=new g0(a);return new Ha(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(a){let i=`/${Kh(a.root,!0)}`,l=IS(a.queryParams),h=typeof a.fragment=="string"?`#${TS(a.fragment)}`:"";return`${i}${l}${h}`}},SS=new gu;function im(c){return c.segments.map(a=>cw(a)).join("/")}function Kh(c,a){if(!c.hasChildren())return im(c);if(a){let i=c.children[Kt]?Kh(c.children[Kt],!1):"",l=[];return Object.entries(c.children).forEach(([h,s])=>{h!==Kt&&l.push(`${h}:${Kh(s,!1)}`)}),l.length>0?`${i}(${l.join("//")})`:i}else{let i=MS(c,(l,h)=>h===Kt?[Kh(c.children[Kt],!1)]:[`${h}:${Kh(l,!1)}`]);return Object.keys(c.children).length===1&&c.children[Kt]!=null?`${im(c)}/${i[0]}`:`${im(c)}/(${i.join("//")})`}}function lw(c){return encodeURIComponent(c).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Jf(c){return lw(c).replace(/%3B/gi,";")}function TS(c){return encodeURI(c)}function m0(c){return lw(c).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function nm(c){return decodeURIComponent(c)}function qx(c){return nm(c.replace(/\+/g,"%20"))}function cw(c){return`${m0(c.path)}${ES(c.parameters)}`}function ES(c){return Object.entries(c).map(([a,i])=>`;${m0(a)}=${m0(i)}`).join("")}function IS(c){let a=Object.entries(c).map(([i,l])=>Array.isArray(l)?l.map(h=>`${Jf(i)}=${Jf(h)}`).join("&"):`${Jf(i)}=${Jf(l)}`).filter(i=>i);return a.length?`?${a.join("&")}`:""}var PS=/^[^\/()?;#]+/;function c0(c){let a=c.match(PS);return a?a[0]:""}var kS=/^[^\/()?;=#]+/;function AS(c){let a=c.match(kS);return a?a[0]:""}var DS=/^[^=?&#]+/;function RS(c){let a=c.match(DS);return a?a[0]:""}var OS=/^[^&#]+/;function FS(c){let a=c.match(OS);return a?a[0]:""}var g0=class{url;remaining;constructor(a){this.url=a,this.remaining=a}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ti([],{}):new Ti([],this.parseChildren())}parseQueryParams(){let a={};if(this.consumeOptional("?"))do this.parseQueryParam(a);while(this.consumeOptional("&"));return a}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let a=[];for(this.peekStartsWith("(")||a.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),a.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let l={};return this.peekStartsWith("(")&&(l=this.parseParens(!1)),(a.length>0||Object.keys(i).length>0)&&(l[Kt]=new Ti(a,i)),l}parseSegment(){let a=c0(this.remaining);if(a===""&&this.peekStartsWith(";"))throw new ki(4009,!1);return this.capture(a),new Qc(nm(a),this.parseMatrixParams())}parseMatrixParams(){let a={};for(;this.consumeOptional(";");)this.parseParam(a);return a}parseParam(a){let i=AS(this.remaining);if(!i)return;this.capture(i);let l="";if(this.consumeOptional("=")){let h=c0(this.remaining);h&&(l=h,this.capture(l))}a[nm(i)]=nm(l)}parseQueryParam(a){let i=RS(this.remaining);if(!i)return;this.capture(i);let l="";if(this.consumeOptional("=")){let T=FS(this.remaining);T&&(l=T,this.capture(l))}let h=qx(i),s=qx(l);if(a.hasOwnProperty(h)){let T=a[h];Array.isArray(T)||(T=[T],a[h]=T),T.push(s)}else a[h]=s}parseParens(a){let i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let l=c0(this.remaining),h=this.remaining[l.length];if(h!=="/"&&h!==")"&&h!==";")throw new ki(4010,!1);let s;l.indexOf(":")>-1?(s=l.slice(0,l.indexOf(":")),this.capture(s),this.capture(":")):a&&(s=Kt);let T=this.parseChildren();i[s]=Object.keys(T).length===1?T[Kt]:new Ti([],T),this.consumeOptional("//")}return i}peekStartsWith(a){return this.remaining.startsWith(a)}consumeOptional(a){return this.peekStartsWith(a)?(this.remaining=this.remaining.substring(a.length),!0):!1}capture(a){if(!this.consumeOptional(a))throw new ki(4011,!1)}};function dw(c){return c.segments.length>0?new Ti([],{[Kt]:c}):c}function uw(c){let a={};for(let[l,h]of Object.entries(c.children)){let s=uw(h);if(l===Kt&&s.segments.length===0&&s.hasChildren())for(let[T,Y]of Object.entries(s.children))a[T]=Y;else(s.segments.length>0||s.hasChildren())&&(a[l]=s)}let i=new Ti(c.segments,a);return LS(i)}function LS(c){if(c.numberOfChildren===1&&c.children[Kt]){let a=c.children[Kt];return new Ti(c.segments.concat(a.segments),a.children)}return c}function np(c){return c instanceof Ha}function zS(c,a,i=null,l=null){let h=hw(c);return pw(h,a,i,l)}function hw(c){let a;function i(s){let T={};for(let K of s.children){let Ce=i(K);T[K.outlet]=Ce}let Y=new Ti(s.url,T);return s===c&&(a=Y),Y}let l=i(c.root),h=dw(l);return a??h}function pw(c,a,i,l){let h=c;for(;h.parent;)h=h.parent;if(a.length===0)return d0(h,h,h,i,l);let s=BS(a);if(s.toRoot())return d0(h,h,new Ti([],{}),i,l);let T=NS(s,h,c),Y=T.processChildren?ep(T.segmentGroup,T.index,s.commands):mw(T.segmentGroup,T.index,s.commands);return d0(h,T.segmentGroup,Y,i,l)}function rm(c){return typeof c=="object"&&c!=null&&!c.outlets&&!c.segmentPath}function rp(c){return typeof c=="object"&&c!=null&&c.outlets}function d0(c,a,i,l,h){let s={};l&&Object.entries(l).forEach(([K,Ce])=>{s[K]=Array.isArray(Ce)?Ce.map(be=>`${be}`):`${Ce}`});let T;c===a?T=i:T=fw(c,a,i);let Y=dw(uw(T));return new Ha(Y,s,h)}function fw(c,a,i){let l={};return Object.entries(c.children).forEach(([h,s])=>{s===a?l[h]=i:l[h]=fw(s,a,i)}),new Ti(c.segments,l)}var om=class{isAbsolute;numberOfDoubleDots;commands;constructor(a,i,l){if(this.isAbsolute=a,this.numberOfDoubleDots=i,this.commands=l,a&&l.length>0&&rm(l[0]))throw new ki(4003,!1);let h=l.find(rp);if(h&&h!==nw(l))throw new ki(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function BS(c){if(typeof c[0]=="string"&&c.length===1&&c[0]==="/")return new om(!0,0,c);let a=0,i=!1,l=c.reduce((h,s,T)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let Y={};return Object.entries(s.outlets).forEach(([K,Ce])=>{Y[K]=typeof Ce=="string"?Ce.split("/"):Ce}),[...h,{outlets:Y}]}if(s.segmentPath)return[...h,s.segmentPath]}return typeof s!="string"?[...h,s]:T===0?(s.split("/").forEach((Y,K)=>{K==0&&Y==="."||(K==0&&Y===""?i=!0:Y===".."?a++:Y!=""&&h.push(Y))}),h):[...h,s]},[]);return new om(i,a,l)}var hu=class{segmentGroup;processChildren;index;constructor(a,i,l){this.segmentGroup=a,this.processChildren=i,this.index=l}};function NS(c,a,i){if(c.isAbsolute)return new hu(a,!0,0);if(!i)return new hu(a,!1,NaN);if(i.parent===null)return new hu(i,!0,0);let l=rm(c.commands[0])?0:1,h=i.segments.length-1+l;return VS(i,h,c.numberOfDoubleDots)}function VS(c,a,i){let l=c,h=a,s=i;for(;s>h;){if(s-=h,l=l.parent,!l)throw new ki(4005,!1);h=l.segments.length}return new hu(l,!1,h-s)}function jS(c){return rp(c[0])?c[0].outlets:{[Kt]:c}}function mw(c,a,i){if(c??=new Ti([],{}),c.segments.length===0&&c.hasChildren())return ep(c,a,i);let l=US(c,a,i),h=i.slice(l.commandIndex);if(l.match&&l.pathIndex<c.segments.length){let s=new Ti(c.segments.slice(0,l.pathIndex),{});return s.children[Kt]=new Ti(c.segments.slice(l.pathIndex),c.children),ep(s,0,h)}else return l.match&&h.length===0?new Ti(c.segments,{}):l.match&&!c.hasChildren()?_0(c,a,i):l.match?ep(c,0,h):_0(c,a,i)}function ep(c,a,i){if(i.length===0)return new Ti(c.segments,{});{let l=jS(i),h={};if(Object.keys(l).some(s=>s!==Kt)&&c.children[Kt]&&c.numberOfChildren===1&&c.children[Kt].segments.length===0){let s=ep(c.children[Kt],a,i);return new Ti(c.segments,s.children)}return Object.entries(l).forEach(([s,T])=>{typeof T=="string"&&(T=[T]),T!==null&&(h[s]=mw(c.children[s],a,T))}),Object.entries(c.children).forEach(([s,T])=>{l[s]===void 0&&(h[s]=T)}),new Ti(c.segments,h)}}function US(c,a,i){let l=0,h=a,s={match:!1,pathIndex:0,commandIndex:0};for(;h<c.segments.length;){if(l>=i.length)return s;let T=c.segments[h],Y=i[l];if(rp(Y))break;let K=`${Y}`,Ce=l<i.length-1?i[l+1]:null;if(h>0&&K===void 0)break;if(K&&Ce&&typeof Ce=="object"&&Ce.outlets===void 0){if(!Xx(K,Ce,T))return s;l+=2}else{if(!Xx(K,{},T))return s;l++}h++}return{match:!0,pathIndex:h,commandIndex:l}}function _0(c,a,i){let l=c.segments.slice(0,a),h=0;for(;h<i.length;){let s=i[h];if(rp(s)){let K=$S(s.outlets);return new Ti(l,K)}if(h===0&&rm(i[0])){let K=c.segments[a];l.push(new Qc(K.path,Wx(i[0]))),h++;continue}let T=rp(s)?s.outlets[Kt]:`${s}`,Y=h<i.length-1?i[h+1]:null;T&&Y&&rm(Y)?(l.push(new Qc(T,Wx(Y))),h+=2):(l.push(new Qc(T,{})),h++)}return new Ti(l,{})}function $S(c){let a={};return Object.entries(c).forEach(([i,l])=>{typeof l=="string"&&(l=[l]),l!==null&&(a[i]=_0(new Ti([],{}),0,l))}),a}function Wx(c){let a={};return Object.entries(c).forEach(([i,l])=>a[i]=`${l}`),a}function Xx(c,a,i){return c==i.path&&ea(a,i.parameters)}var tp="imperative",sr=function(c){return c[c.NavigationStart=0]="NavigationStart",c[c.NavigationEnd=1]="NavigationEnd",c[c.NavigationCancel=2]="NavigationCancel",c[c.NavigationError=3]="NavigationError",c[c.RoutesRecognized=4]="RoutesRecognized",c[c.ResolveStart=5]="ResolveStart",c[c.ResolveEnd=6]="ResolveEnd",c[c.GuardsCheckStart=7]="GuardsCheckStart",c[c.GuardsCheckEnd=8]="GuardsCheckEnd",c[c.RouteConfigLoadStart=9]="RouteConfigLoadStart",c[c.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",c[c.ChildActivationStart=11]="ChildActivationStart",c[c.ChildActivationEnd=12]="ChildActivationEnd",c[c.ActivationStart=13]="ActivationStart",c[c.ActivationEnd=14]="ActivationEnd",c[c.Scroll=15]="Scroll",c[c.NavigationSkipped=16]="NavigationSkipped",c}(sr||{}),qo=class{id;url;constructor(a,i){this.id=a,this.url=i}},_u=class extends qo{type=sr.NavigationStart;navigationTrigger;restoredState;constructor(a,i,l="imperative",h=null){super(a,i),this.navigationTrigger=l,this.restoredState=h}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Za=class extends qo{urlAfterRedirects;type=sr.NavigationEnd;constructor(a,i,l){super(a,i),this.urlAfterRedirects=l}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Io=function(c){return c[c.Redirect=0]="Redirect",c[c.SupersededByNewNavigation=1]="SupersededByNewNavigation",c[c.NoDataFromResolver=2]="NoDataFromResolver",c[c.GuardRejected=3]="GuardRejected",c}(Io||{}),sm=function(c){return c[c.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",c[c.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",c}(sm||{}),Ga=class extends qo{reason;code;type=sr.NavigationCancel;constructor(a,i,l,h){super(a,i),this.reason=l,this.code=h}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Xl=class extends qo{reason;code;type=sr.NavigationSkipped;constructor(a,i,l,h){super(a,i),this.reason=l,this.code=h}},op=class extends qo{error;target;type=sr.NavigationError;constructor(a,i,l,h){super(a,i),this.error=l,this.target=h}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},am=class extends qo{urlAfterRedirects;state;type=sr.RoutesRecognized;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},y0=class extends qo{urlAfterRedirects;state;type=sr.GuardsCheckStart;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},v0=class extends qo{urlAfterRedirects;state;shouldActivate;type=sr.GuardsCheckEnd;constructor(a,i,l,h,s){super(a,i),this.urlAfterRedirects=l,this.state=h,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},b0=class extends qo{urlAfterRedirects;state;type=sr.ResolveStart;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},x0=class extends qo{urlAfterRedirects;state;type=sr.ResolveEnd;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},w0=class{route;type=sr.RouteConfigLoadStart;constructor(a){this.route=a}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},C0=class{route;type=sr.RouteConfigLoadEnd;constructor(a){this.route=a}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},M0=class{snapshot;type=sr.ChildActivationStart;constructor(a){this.snapshot=a}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},S0=class{snapshot;type=sr.ChildActivationEnd;constructor(a){this.snapshot=a}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},T0=class{snapshot;type=sr.ActivationStart;constructor(a){this.snapshot=a}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},E0=class{snapshot;type=sr.ActivationEnd;constructor(a){this.snapshot=a}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lm=class{routerEvent;position;anchor;type=sr.Scroll;constructor(a,i,l){this.routerEvent=a,this.position=i,this.anchor=l}toString(){let a=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${a}')`}},sp=class{},yu=class{url;navigationBehaviorOptions;constructor(a,i){this.url=a,this.navigationBehaviorOptions=i}};function GS(c,a){return c.providers&&!c._injector&&(c._injector=V_(c.providers,a,`Route: ${c.path}`)),c._injector??a}function Cs(c){return c.outlet||Kt}function HS(c,a){let i=c.filter(l=>Cs(l)===a);return i.push(...c.filter(l=>Cs(l)!==a)),i}function fp(c){if(!c)return null;if(c.routeConfig?._injector)return c.routeConfig._injector;for(let a=c.parent;a;a=a.parent){let i=a.routeConfig;if(i?._loadedInjector)return i._loadedInjector;if(i?._injector)return i._injector}return null}var I0=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return fp(this.route?.snapshot)??this.rootInjector}constructor(a){this.rootInjector=a,this.children=new mp(this.rootInjector)}},mp=(()=>{class c{rootInjector;contexts=new Map;constructor(i){this.rootInjector=i}onChildOutletCreated(i,l){let h=this.getOrCreateContext(i);h.outlet=l,this.contexts.set(i,h)}onChildOutletDestroyed(i){let l=this.getContext(i);l&&(l.outlet=null,l.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let l=this.getContext(i);return l||(l=new I0(this.rootInjector),this.contexts.set(i,l)),l}getContext(i){return this.contexts.get(i)||null}static \u0275fac=function(l){return new(l||c)(zt(vs))};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),cm=class{_root;constructor(a){this._root=a}get root(){return this._root.value}parent(a){let i=this.pathFromRoot(a);return i.length>1?i[i.length-2]:null}children(a){let i=P0(a,this._root);return i?i.children.map(l=>l.value):[]}firstChild(a){let i=P0(a,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(a){let i=k0(a,this._root);return i.length<2?[]:i[i.length-2].children.map(h=>h.value).filter(h=>h!==a)}pathFromRoot(a){return k0(a,this._root).map(i=>i.value)}};function P0(c,a){if(c===a.value)return a;for(let i of a.children){let l=P0(c,i);if(l)return l}return null}function k0(c,a){if(c===a.value)return[a];for(let i of a.children){let l=k0(c,i);if(l.length)return l.unshift(a),l}return[]}var Eo=class{value;children;constructor(a,i){this.value=a,this.children=i}toString(){return`TreeNode(${this.value})`}};function uu(c){let a={};return c&&c.children.forEach(i=>a[i.value.outlet]=i),a}var dm=class extends cm{snapshot;constructor(a,i){super(a),this.snapshot=i,N0(this,a)}toString(){return this.snapshot.toString()}};function gw(c){let a=ZS(c),i=new to([new Qc("",{})]),l=new to({}),h=new to({}),s=new to({}),T=new to(""),Y=new ed(i,l,s,T,h,Kt,c,a.root);return Y.snapshot=a.root,new dm(new Eo(Y,[]),a)}function ZS(c){let a={},i={},l={},h="",s=new pu([],a,l,h,i,Kt,c,null,{});return new hm("",new Eo(s,[]))}var ed=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(a,i,l,h,s,T,Y,K){this.urlSubject=a,this.paramsSubject=i,this.queryParamsSubject=l,this.fragmentSubject=h,this.dataSubject=s,this.outlet=T,this.component=Y,this._futureSnapshot=K,this.title=this.dataSubject?.pipe(kt(Ce=>Ce[hp]))??bt(void 0),this.url=a,this.params=i,this.queryParams=l,this.fragment=h,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(kt(a=>mu(a))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(kt(a=>mu(a))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function um(c,a,i="emptyOnly"){let l,{routeConfig:h}=c;return a!==null&&(i==="always"||h?.path===""||!a.component&&!a.routeConfig?.loadComponent)?l={params:Ye(Ye({},a.params),c.params),data:Ye(Ye({},a.data),c.data),resolve:Ye(Ye(Ye(Ye({},c.data),a.data),h?.data),c._resolvedData)}:l={params:Ye({},c.params),data:Ye({},c.data),resolve:Ye(Ye({},c.data),c._resolvedData??{})},h&&yw(h)&&(l.resolve[hp]=h.title),l}var pu=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[hp]}constructor(a,i,l,h,s,T,Y,K,Ce){this.url=a,this.params=i,this.queryParams=l,this.fragment=h,this.data=s,this.outlet=T,this.component=Y,this.routeConfig=K,this._resolve=Ce}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=mu(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=mu(this.queryParams),this._queryParamMap}toString(){let a=this.url.map(l=>l.toString()).join("/"),i=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${a}', path:'${i}')`}},hm=class extends cm{url;constructor(a,i){super(i),this.url=a,N0(this,i)}toString(){return _w(this._root)}};function N0(c,a){a.value._routerState=c,a.children.forEach(i=>N0(c,i))}function _w(c){let a=c.children.length>0?` { ${c.children.map(_w).join(", ")} } `:"";return`${c.value}${a}`}function u0(c){if(c.snapshot){let a=c.snapshot,i=c._futureSnapshot;c.snapshot=i,ea(a.queryParams,i.queryParams)||c.queryParamsSubject.next(i.queryParams),a.fragment!==i.fragment&&c.fragmentSubject.next(i.fragment),ea(a.params,i.params)||c.paramsSubject.next(i.params),vS(a.url,i.url)||c.urlSubject.next(i.url),ea(a.data,i.data)||c.dataSubject.next(i.data)}else c.snapshot=c._futureSnapshot,c.dataSubject.next(c._futureSnapshot.data)}function A0(c,a){let i=ea(c.params,a.params)&&CS(c.url,a.url),l=!c.parent!=!a.parent;return i&&!l&&(!c.parent||A0(c.parent,a.parent))}function yw(c){return typeof c.title=="string"||c.title===null}var qS=new ct(""),gp=(()=>{class c{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Kt;activateEvents=new xi;deactivateEvents=new xi;attachEvents=new xi;detachEvents=new xi;routerOutletData=Zb(void 0);parentContexts=me(mp);location=me(au);changeDetector=me(Ur);inputBinder=me(gm,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(i){if(i.name){let{firstChange:l,previousValue:h}=i.name;if(l)return;this.isTrackedInParentContexts(h)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(h)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ki(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ki(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ki(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,l){this.activated=i,this._activatedRoute=l,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,l){if(this.isActivated)throw new ki(4013,!1);this._activatedRoute=i;let h=this.location,T=i.snapshot.component,Y=this.parentContexts.getOrCreateContext(this.name).children,K=new D0(i,Y,h.injector,this.routerOutletData);this.activated=h.createComponent(T,{index:h.length,injector:K,environmentInjector:l}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Ho]})}return c})(),D0=class c{route;childContexts;parent;outletData;__ngOutletInjector(a){return new c(this.route,this.childContexts,a,this.outletData)}constructor(a,i,l,h){this.route=a,this.childContexts=i,this.parent=l,this.outletData=h}get(a,i){return a===ed?this.route:a===mp?this.childContexts:a===qS?this.outletData:this.parent.get(a,i)}},gm=new ct(""),Yx=(()=>{class c{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(i){this.unsubscribeFromRouteData(i),this.subscribeToRouteData(i)}unsubscribeFromRouteData(i){this.outletDataSubscriptions.get(i)?.unsubscribe(),this.outletDataSubscriptions.delete(i)}subscribeToRouteData(i){let{activatedRoute:l}=i,h=iu([l.queryParams,l.params,l.data]).pipe(gr(([s,T,Y],K)=>(Y=Ye(Ye(Ye({},s),T),Y),K===0?bt(Y):Promise.resolve(Y)))).subscribe(s=>{if(!i.isActivated||!i.activatedComponentRef||i.activatedRoute!==l||l.component===null){this.unsubscribeFromRouteData(i);return}let T=dx(l.component);if(!T){this.unsubscribeFromRouteData(i);return}for(let{templateName:Y}of T.inputs)i.activatedComponentRef.setInput(Y,s[Y])});this.outletDataSubscriptions.set(i,h)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})();function WS(c,a,i){let l=ap(c,a._root,i?i._root:void 0);return new dm(l,a)}function ap(c,a,i){if(i&&c.shouldReuseRoute(a.value,i.value.snapshot)){let l=i.value;l._futureSnapshot=a.value;let h=XS(c,a,i);return new Eo(l,h)}else{if(c.shouldAttach(a.value)){let s=c.retrieve(a.value);if(s!==null){let T=s.route;return T.value._futureSnapshot=a.value,T.children=a.children.map(Y=>ap(c,Y)),T}}let l=YS(a.value),h=a.children.map(s=>ap(c,s));return new Eo(l,h)}}function XS(c,a,i){return a.children.map(l=>{for(let h of i.children)if(c.shouldReuseRoute(l.value,h.value.snapshot))return ap(c,l,h);return ap(c,l)})}function YS(c){return new ed(new to(c.url),new to(c.params),new to(c.queryParams),new to(c.fragment),new to(c.data),c.outlet,c.component,c)}var lp=class{redirectTo;navigationBehaviorOptions;constructor(a,i){this.redirectTo=a,this.navigationBehaviorOptions=i}},vw="ngNavigationCancelingError";function pm(c,a){let{redirectTo:i,navigationBehaviorOptions:l}=np(a)?{redirectTo:a,navigationBehaviorOptions:void 0}:a,h=bw(!1,Io.Redirect);return h.url=i,h.navigationBehaviorOptions=l,h}function bw(c,a){let i=new Error(`NavigationCancelingError: ${c||""}`);return i[vw]=!0,i.cancellationCode=a,i}function KS(c){return xw(c)&&np(c.url)}function xw(c){return!!c&&c[vw]}var QS=(c,a,i,l)=>kt(h=>(new R0(a,h.targetRouterState,h.currentRouterState,i,l).activate(c),h)),R0=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(a,i,l,h,s){this.routeReuseStrategy=a,this.futureState=i,this.currState=l,this.forwardEvent=h,this.inputBindingEnabled=s}activate(a){let i=this.futureState._root,l=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,l,a),u0(this.futureState.root),this.activateChildRoutes(i,l,a)}deactivateChildRoutes(a,i,l){let h=uu(i);a.children.forEach(s=>{let T=s.value.outlet;this.deactivateRoutes(s,h[T],l),delete h[T]}),Object.values(h).forEach(s=>{this.deactivateRouteAndItsChildren(s,l)})}deactivateRoutes(a,i,l){let h=a.value,s=i?i.value:null;if(h===s)if(h.component){let T=l.getContext(h.outlet);T&&this.deactivateChildRoutes(a,i,T.children)}else this.deactivateChildRoutes(a,i,l);else s&&this.deactivateRouteAndItsChildren(i,l)}deactivateRouteAndItsChildren(a,i){a.value.component&&this.routeReuseStrategy.shouldDetach(a.value.snapshot)?this.detachAndStoreRouteSubtree(a,i):this.deactivateRouteAndOutlet(a,i)}detachAndStoreRouteSubtree(a,i){let l=i.getContext(a.value.outlet),h=l&&a.value.component?l.children:i,s=uu(a);for(let T of Object.values(s))this.deactivateRouteAndItsChildren(T,h);if(l&&l.outlet){let T=l.outlet.detach(),Y=l.children.onOutletDeactivated();this.routeReuseStrategy.store(a.value.snapshot,{componentRef:T,route:a,contexts:Y})}}deactivateRouteAndOutlet(a,i){let l=i.getContext(a.value.outlet),h=l&&a.value.component?l.children:i,s=uu(a);for(let T of Object.values(s))this.deactivateRouteAndItsChildren(T,h);l&&(l.outlet&&(l.outlet.deactivate(),l.children.onOutletDeactivated()),l.attachRef=null,l.route=null)}activateChildRoutes(a,i,l){let h=uu(i);a.children.forEach(s=>{this.activateRoutes(s,h[s.value.outlet],l),this.forwardEvent(new E0(s.value.snapshot))}),a.children.length&&this.forwardEvent(new S0(a.value.snapshot))}activateRoutes(a,i,l){let h=a.value,s=i?i.value:null;if(u0(h),h===s)if(h.component){let T=l.getOrCreateContext(h.outlet);this.activateChildRoutes(a,i,T.children)}else this.activateChildRoutes(a,i,l);else if(h.component){let T=l.getOrCreateContext(h.outlet);if(this.routeReuseStrategy.shouldAttach(h.snapshot)){let Y=this.routeReuseStrategy.retrieve(h.snapshot);this.routeReuseStrategy.store(h.snapshot,null),T.children.onOutletReAttached(Y.contexts),T.attachRef=Y.componentRef,T.route=Y.route.value,T.outlet&&T.outlet.attach(Y.componentRef,Y.route.value),u0(Y.route.value),this.activateChildRoutes(a,null,T.children)}else T.attachRef=null,T.route=h,T.outlet&&T.outlet.activateWith(h,T.injector),this.activateChildRoutes(a,null,T.children)}else this.activateChildRoutes(a,null,l)}},fm=class{path;route;constructor(a){this.path=a,this.route=this.path[this.path.length-1]}},fu=class{component;route;constructor(a,i){this.component=a,this.route=i}};function JS(c,a,i){let l=c._root,h=a?a._root:null;return Qh(l,h,i,[l.value])}function eT(c){let a=c.routeConfig?c.routeConfig.canActivateChild:null;return!a||a.length===0?null:{node:c,guards:a}}function bu(c,a){let i=Symbol(),l=a.get(c,i);return l===i?typeof c=="function"&&!Ub(c)?c:a.get(c):l}function Qh(c,a,i,l,h={canDeactivateChecks:[],canActivateChecks:[]}){let s=uu(a);return c.children.forEach(T=>{tT(T,s[T.value.outlet],i,l.concat([T.value]),h),delete s[T.value.outlet]}),Object.entries(s).forEach(([T,Y])=>ip(Y,i.getContext(T),h)),h}function tT(c,a,i,l,h={canDeactivateChecks:[],canActivateChecks:[]}){let s=c.value,T=a?a.value:null,Y=i?i.getContext(c.value.outlet):null;if(T&&s.routeConfig===T.routeConfig){let K=iT(T,s,s.routeConfig.runGuardsAndResolvers);K?h.canActivateChecks.push(new fm(l)):(s.data=T.data,s._resolvedData=T._resolvedData),s.component?Qh(c,a,Y?Y.children:null,l,h):Qh(c,a,i,l,h),K&&Y&&Y.outlet&&Y.outlet.isActivated&&h.canDeactivateChecks.push(new fu(Y.outlet.component,T))}else T&&ip(a,Y,h),h.canActivateChecks.push(new fm(l)),s.component?Qh(c,null,Y?Y.children:null,l,h):Qh(c,null,i,l,h);return h}function iT(c,a,i){if(typeof i=="function")return i(c,a);switch(i){case"pathParamsChange":return!Jc(c.url,a.url);case"pathParamsOrQueryParamsChange":return!Jc(c.url,a.url)||!ea(c.queryParams,a.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!A0(c,a)||!ea(c.queryParams,a.queryParams);case"paramsChange":default:return!A0(c,a)}}function ip(c,a,i){let l=uu(c),h=c.value;Object.entries(l).forEach(([s,T])=>{h.component?a?ip(T,a.children.getContext(s),i):ip(T,null,i):ip(T,a,i)}),h.component?a&&a.outlet&&a.outlet.isActivated?i.canDeactivateChecks.push(new fu(a.outlet.component,h)):i.canDeactivateChecks.push(new fu(null,h)):i.canDeactivateChecks.push(new fu(null,h))}function _p(c){return typeof c=="function"}function nT(c){return typeof c=="boolean"}function rT(c){return c&&_p(c.canLoad)}function oT(c){return c&&_p(c.canActivate)}function sT(c){return c&&_p(c.canActivateChild)}function aT(c){return c&&_p(c.canDeactivate)}function lT(c){return c&&_p(c.canMatch)}function ww(c){return c instanceof Fb||c?.name==="EmptyError"}var em=Symbol("INITIAL_VALUE");function vu(){return gr(c=>iu(c.map(a=>a.pipe(xo(1),Ks(em)))).pipe(kt(a=>{for(let i of a)if(i!==!0){if(i===em)return em;if(i===!1||cT(i))return i}return!0}),vn(a=>a!==em),xo(1)))}function cT(c){return np(c)||c instanceof lp}function dT(c,a){return bo(i=>{let{targetSnapshot:l,currentSnapshot:h,guards:{canActivateChecks:s,canDeactivateChecks:T}}=i;return T.length===0&&s.length===0?bt(si(Ye({},i),{guardsResult:!0})):uT(T,l,h,c).pipe(bo(Y=>Y&&nT(Y)?hT(l,s,c,a):bt(Y)),kt(Y=>si(Ye({},i),{guardsResult:Y})))})}function uT(c,a,i,l){return mr(c).pipe(bo(h=>_T(h.component,h.route,i,a,l)),Ul(h=>h!==!0,!0))}function hT(c,a,i,l){return mr(a).pipe(jl(h=>Cf(fT(h.route.parent,l),pT(h.route,l),gT(c,h.path,i),mT(c,h.route,i))),Ul(h=>h!==!0,!0))}function pT(c,a){return c!==null&&a&&a(new T0(c)),bt(!0)}function fT(c,a){return c!==null&&a&&a(new M0(c)),bt(!0)}function mT(c,a,i){let l=a.routeConfig?a.routeConfig.canActivate:null;if(!l||l.length===0)return bt(!0);let h=l.map(s=>Ph(()=>{let T=fp(a)??i,Y=bu(s,T),K=oT(Y)?Y.canActivate(a,c):Go(T,()=>Y(a,c));return Yl(K).pipe(Ul())}));return bt(h).pipe(vu())}function gT(c,a,i){let l=a[a.length-1],s=a.slice(0,a.length-1).reverse().map(T=>eT(T)).filter(T=>T!==null).map(T=>Ph(()=>{let Y=T.guards.map(K=>{let Ce=fp(T.node)??i,be=bu(K,Ce),G=sT(be)?be.canActivateChild(l,c):Go(Ce,()=>be(l,c));return Yl(G).pipe(Ul())});return bt(Y).pipe(vu())}));return bt(s).pipe(vu())}function _T(c,a,i,l,h){let s=a&&a.routeConfig?a.routeConfig.canDeactivate:null;if(!s||s.length===0)return bt(!0);let T=s.map(Y=>{let K=fp(a)??h,Ce=bu(Y,K),be=aT(Ce)?Ce.canDeactivate(c,a,i,l):Go(K,()=>Ce(c,a,i,l));return Yl(be).pipe(Ul())});return bt(T).pipe(vu())}function yT(c,a,i,l){let h=a.canLoad;if(h===void 0||h.length===0)return bt(!0);let s=h.map(T=>{let Y=bu(T,c),K=rT(Y)?Y.canLoad(a,i):Go(c,()=>Y(a,i));return Yl(K)});return bt(s).pipe(vu(),Cw(l))}function Cw(c){return Ob(Ji(a=>{if(typeof a!="boolean")throw pm(c,a)}),kt(a=>a===!0))}function vT(c,a,i,l){let h=a.canMatch;if(!h||h.length===0)return bt(!0);let s=h.map(T=>{let Y=bu(T,c),K=lT(Y)?Y.canMatch(a,i):Go(c,()=>Y(a,i));return Yl(K)});return bt(s).pipe(vu(),Cw(l))}var cp=class{segmentGroup;constructor(a){this.segmentGroup=a||null}},dp=class extends Error{urlTree;constructor(a){super(),this.urlTree=a}};function du(c){return Gc(new cp(c))}function bT(c){return Gc(new ki(4e3,!1))}function xT(c){return Gc(bw(!1,Io.GuardRejected))}var O0=class{urlSerializer;urlTree;constructor(a,i){this.urlSerializer=a,this.urlTree=i}lineralizeSegments(a,i){let l=[],h=i.root;for(;;){if(l=l.concat(h.segments),h.numberOfChildren===0)return bt(l);if(h.numberOfChildren>1||!h.children[Kt])return bT(`${a.redirectTo}`);h=h.children[Kt]}}applyRedirectCommands(a,i,l,h,s){if(typeof i!="string"){let Y=i,{queryParams:K,fragment:Ce,routeConfig:be,url:G,outlet:$e,params:ft,data:Ct,title:ut}=h,lt=Go(s,()=>Y({params:ft,data:Ct,queryParams:K,fragment:Ce,routeConfig:be,url:G,outlet:$e,title:ut}));if(lt instanceof Ha)throw new dp(lt);i=lt}let T=this.applyRedirectCreateUrlTree(i,this.urlSerializer.parse(i),a,l);if(i[0]==="/")throw new dp(T);return T}applyRedirectCreateUrlTree(a,i,l,h){let s=this.createSegmentGroup(a,i.root,l,h);return new Ha(s,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(a,i){let l={};return Object.entries(a).forEach(([h,s])=>{if(typeof s=="string"&&s[0]===":"){let Y=s.substring(1);l[h]=i[Y]}else l[h]=s}),l}createSegmentGroup(a,i,l,h){let s=this.createSegments(a,i.segments,l,h),T={};return Object.entries(i.children).forEach(([Y,K])=>{T[Y]=this.createSegmentGroup(a,K,l,h)}),new Ti(s,T)}createSegments(a,i,l,h){return i.map(s=>s.path[0]===":"?this.findPosParam(a,s,h):this.findOrReturn(s,l))}findPosParam(a,i,l){let h=l[i.path.substring(1)];if(!h)throw new ki(4001,!1);return h}findOrReturn(a,i){let l=0;for(let h of i){if(h.path===a.path)return i.splice(l),h;l++}return a}},F0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function wT(c,a,i,l,h){let s=Mw(c,a,i);return s.matched?(l=GS(a,l),vT(l,a,i,h).pipe(kt(T=>T===!0?s:Ye({},F0)))):bt(s)}function Mw(c,a,i){if(a.path==="**")return CT(i);if(a.path==="")return a.pathMatch==="full"&&(c.hasChildren()||i.length>0)?Ye({},F0):{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};let h=(a.matcher||yS)(i,c,a);if(!h)return Ye({},F0);let s={};Object.entries(h.posParams??{}).forEach(([Y,K])=>{s[Y]=K.path});let T=h.consumed.length>0?Ye(Ye({},s),h.consumed[h.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:h.consumed,remainingSegments:i.slice(h.consumed.length),parameters:T,positionalParamSegments:h.posParams??{}}}function CT(c){return{matched:!0,parameters:c.length>0?nw(c).parameters:{},consumedSegments:c,remainingSegments:[],positionalParamSegments:{}}}function Kx(c,a,i,l){return i.length>0&&TT(c,i,l)?{segmentGroup:new Ti(a,ST(l,new Ti(i,c.children))),slicedSegments:[]}:i.length===0&&ET(c,i,l)?{segmentGroup:new Ti(c.segments,MT(c,i,l,c.children)),slicedSegments:i}:{segmentGroup:new Ti(c.segments,c.children),slicedSegments:i}}function MT(c,a,i,l){let h={};for(let s of i)if(_m(c,a,s)&&!l[Cs(s)]){let T=new Ti([],{});h[Cs(s)]=T}return Ye(Ye({},l),h)}function ST(c,a){let i={};i[Kt]=a;for(let l of c)if(l.path===""&&Cs(l)!==Kt){let h=new Ti([],{});i[Cs(l)]=h}return i}function TT(c,a,i){return i.some(l=>_m(c,a,l)&&Cs(l)!==Kt)}function ET(c,a,i){return i.some(l=>_m(c,a,l))}function _m(c,a,i){return(c.hasChildren()||a.length>0)&&i.pathMatch==="full"?!1:i.path===""}function IT(c,a,i){return a.length===0&&!c.children[i]}var L0=class{};function PT(c,a,i,l,h,s,T="emptyOnly"){return new z0(c,a,i,l,h,T,s).recognize()}var kT=31,z0=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(a,i,l,h,s,T,Y){this.injector=a,this.configLoader=i,this.rootComponentType=l,this.config=h,this.urlTree=s,this.paramsInheritanceStrategy=T,this.urlSerializer=Y,this.applyRedirects=new O0(this.urlSerializer,this.urlTree)}noMatchError(a){return new ki(4002,`'${a.segmentGroup}'`)}recognize(){let a=Kx(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(a).pipe(kt(({children:i,rootSnapshot:l})=>{let h=new Eo(l,i),s=new hm("",h),T=zS(l,[],this.urlTree.queryParams,this.urlTree.fragment);return T.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(T),{state:s,tree:T}}))}match(a){let i=new pu([],Object.freeze({}),Object.freeze(Ye({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Kt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,a,Kt,i).pipe(kt(l=>({children:l,rootSnapshot:i})),Vl(l=>{if(l instanceof dp)return this.urlTree=l.urlTree,this.match(l.urlTree.root);throw l instanceof cp?this.noMatchError(l):l}))}processSegmentGroup(a,i,l,h,s){return l.segments.length===0&&l.hasChildren()?this.processChildren(a,i,l,s):this.processSegment(a,i,l,l.segments,h,!0,s).pipe(kt(T=>T instanceof Eo?[T]:[]))}processChildren(a,i,l,h){let s=[];for(let T of Object.keys(l.children))T==="primary"?s.unshift(T):s.push(T);return mr(s).pipe(jl(T=>{let Y=l.children[T],K=HS(i,T);return this.processSegmentGroup(a,K,Y,T,h)}),Nb((T,Y)=>(T.push(...Y),T)),D_(null),Bb(),bo(T=>{if(T===null)return du(l);let Y=Sw(T);return AT(Y),bt(Y)}))}processSegment(a,i,l,h,s,T,Y){return mr(i).pipe(jl(K=>this.processSegmentAgainstRoute(K._injector??a,i,K,l,h,s,T,Y).pipe(Vl(Ce=>{if(Ce instanceof cp)return bt(null);throw Ce}))),Ul(K=>!!K),Vl(K=>{if(ww(K))return IT(l,h,s)?bt(new L0):du(l);throw K}))}processSegmentAgainstRoute(a,i,l,h,s,T,Y,K){return Cs(l)!==T&&(T===Kt||!_m(h,s,l))?du(h):l.redirectTo===void 0?this.matchSegmentAgainstRoute(a,h,l,s,T,K):this.allowRedirects&&Y?this.expandSegmentAgainstRouteUsingRedirect(a,h,i,l,s,T,K):du(h)}expandSegmentAgainstRouteUsingRedirect(a,i,l,h,s,T,Y){let{matched:K,parameters:Ce,consumedSegments:be,positionalParamSegments:G,remainingSegments:$e}=Mw(i,h,s);if(!K)return du(i);typeof h.redirectTo=="string"&&h.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>kT&&(this.allowRedirects=!1));let ft=new pu(s,Ce,Object.freeze(Ye({},this.urlTree.queryParams)),this.urlTree.fragment,Qx(h),Cs(h),h.component??h._loadedComponent??null,h,Jx(h)),Ct=um(ft,Y,this.paramsInheritanceStrategy);ft.params=Object.freeze(Ct.params),ft.data=Object.freeze(Ct.data);let ut=this.applyRedirects.applyRedirectCommands(be,h.redirectTo,G,ft,a);return this.applyRedirects.lineralizeSegments(h,ut).pipe(bo(lt=>this.processSegment(a,l,i,lt.concat($e),T,!1,Y)))}matchSegmentAgainstRoute(a,i,l,h,s,T){let Y=wT(i,l,h,a,this.urlSerializer);return l.path==="**"&&(i.children={}),Y.pipe(gr(K=>K.matched?(a=l._injector??a,this.getChildConfig(a,l,h).pipe(gr(({routes:Ce})=>{let be=l._loadedInjector??a,{parameters:G,consumedSegments:$e,remainingSegments:ft}=K,Ct=new pu($e,G,Object.freeze(Ye({},this.urlTree.queryParams)),this.urlTree.fragment,Qx(l),Cs(l),l.component??l._loadedComponent??null,l,Jx(l)),ut=um(Ct,T,this.paramsInheritanceStrategy);Ct.params=Object.freeze(ut.params),Ct.data=Object.freeze(ut.data);let{segmentGroup:lt,slicedSegments:vi}=Kx(i,$e,ft,Ce);if(vi.length===0&&lt.hasChildren())return this.processChildren(be,Ce,lt,Ct).pipe(kt(Et=>new Eo(Ct,Et)));if(Ce.length===0&&vi.length===0)return bt(new Eo(Ct,[]));let bi=Cs(l)===s;return this.processSegment(be,Ce,lt,vi,bi?Kt:s,!0,Ct).pipe(kt(Et=>new Eo(Ct,Et instanceof Eo?[Et]:[])))}))):du(i)))}getChildConfig(a,i,l){return i.children?bt({routes:i.children,injector:a}):i.loadChildren?i._loadedRoutes!==void 0?bt({routes:i._loadedRoutes,injector:i._loadedInjector}):yT(a,i,l,this.urlSerializer).pipe(bo(h=>h?this.configLoader.loadChildren(a,i).pipe(Ji(s=>{i._loadedRoutes=s.routes,i._loadedInjector=s.injector})):xT(i))):bt({routes:[],injector:a})}};function AT(c){c.sort((a,i)=>a.value.outlet===Kt?-1:i.value.outlet===Kt?1:a.value.outlet.localeCompare(i.value.outlet))}function DT(c){let a=c.value.routeConfig;return a&&a.path===""}function Sw(c){let a=[],i=new Set;for(let l of c){if(!DT(l)){a.push(l);continue}let h=a.find(s=>l.value.routeConfig===s.value.routeConfig);h!==void 0?(h.children.push(...l.children),i.add(h)):a.push(l)}for(let l of i){let h=Sw(l.children);a.push(new Eo(l.value,h))}return a.filter(l=>!i.has(l))}function Qx(c){return c.data||{}}function Jx(c){return c.resolve||{}}function RT(c,a,i,l,h,s){return bo(T=>PT(c,a,i,l,T.extractedUrl,h,s).pipe(kt(({state:Y,tree:K})=>si(Ye({},T),{targetSnapshot:Y,urlAfterRedirects:K}))))}function OT(c,a){return bo(i=>{let{targetSnapshot:l,guards:{canActivateChecks:h}}=i;if(!h.length)return bt(i);let s=new Set(h.map(K=>K.route)),T=new Set;for(let K of s)if(!T.has(K))for(let Ce of Tw(K))T.add(Ce);let Y=0;return mr(T).pipe(jl(K=>s.has(K)?FT(K,l,c,a):(K.data=um(K,K.parent,c).resolve,bt(void 0))),Ji(()=>Y++),R_(1),bo(K=>Y===T.size?bt(i):Bl))})}function Tw(c){let a=c.children.map(i=>Tw(i)).flat();return[c,...a]}function FT(c,a,i,l){let h=c.routeConfig,s=c._resolve;return h?.title!==void 0&&!yw(h)&&(s[hp]=h.title),LT(s,c,a,l).pipe(kt(T=>(c._resolvedData=T,c.data=um(c,c.parent,i).resolve,null)))}function LT(c,a,i,l){let h=f0(c);if(h.length===0)return bt({});let s={};return mr(h).pipe(bo(T=>zT(c[T],a,i,l).pipe(Ul(),Ji(Y=>{if(Y instanceof lp)throw pm(new gu,Y);s[T]=Y}))),R_(1),zb(s),Vl(T=>ww(T)?Bl:Gc(T)))}function zT(c,a,i,l){let h=fp(a)??l,s=bu(c,h),T=s.resolve?s.resolve(a,i):Go(h,()=>s(a,i));return Yl(T)}function h0(c){return gr(a=>{let i=c(a);return i?mr(i).pipe(kt(()=>a)):bt(a)})}var Ew=(()=>{class c{buildTitle(i){let l,h=i.root;for(;h!==void 0;)l=this.getResolvedTitleForRoute(h)??l,h=h.children.find(s=>s.outlet===Kt);return l}getResolvedTitleForRoute(i){return i.data[hp]}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:()=>me(BT),providedIn:"root"})}return c})(),BT=(()=>{class c extends Ew{title;constructor(i){super(),this.title=i}updateTitle(i){let l=this.buildTitle(i);l!==void 0&&this.title.setTitle(l)}static \u0275fac=function(l){return new(l||c)(zt(Gx))};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),yp=new ct("",{providedIn:"root",factory:()=>({})}),NT=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],decls:1,vars:0,template:function(l,h){l&1&&Pe(0,"router-outlet")},dependencies:[gp],encapsulation:2})}return c})();function V0(c){let a=c.children&&c.children.map(V0),i=a?si(Ye({},c),{children:a}):Ye({},c);return!i.component&&!i.loadComponent&&(a||i.loadChildren)&&i.outlet&&i.outlet!==Kt&&(i.component=NT),i}var up=new ct(""),j0=(()=>{class c{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=me(zf);loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return bt(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let l=Yl(i.loadComponent()).pipe(kt(Iw),Ji(s=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s}),Va(()=>{this.componentLoaders.delete(i)})),h=new wf(l,()=>new Ut).pipe(P_());return this.componentLoaders.set(i,h),h}loadChildren(i,l){if(this.childrenLoaders.get(l))return this.childrenLoaders.get(l);if(l._loadedRoutes)return bt({routes:l._loadedRoutes,injector:l._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(l);let s=VT(l,this.compiler,i,this.onLoadEndListener).pipe(Va(()=>{this.childrenLoaders.delete(l)})),T=new wf(s,()=>new Ut).pipe(P_());return this.childrenLoaders.set(l,T),T}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function VT(c,a,i,l){return Yl(c.loadChildren()).pipe(kt(Iw),bo(h=>h instanceof rx||Array.isArray(h)?bt(h):mr(a.compileModuleAsync(h))),kt(h=>{l&&l(c);let s,T,Y=!1;return Array.isArray(h)?(T=h,Y=!0):(s=h.create(i).injector,T=s.get(up,[],{optional:!0,self:!0}).flat()),{routes:T.map(V0),injector:s}}))}function jT(c){return c&&typeof c=="object"&&"default"in c}function Iw(c){return jT(c)?c.default:c}var U0=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:()=>me(UT),providedIn:"root"})}return c})(),UT=(()=>{class c{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,l){return i}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Pw=new ct(""),kw=new ct("");function $T(c,a,i){let l=c.get(kw),h=c.get(fi);return c.get(hi).runOutsideAngular(()=>{if(!h.startViewTransition||l.skipNextTransition)return l.skipNextTransition=!1,new Promise(Ce=>setTimeout(Ce));let s,T=new Promise(Ce=>{s=Ce}),Y=h.startViewTransition(()=>(s(),GT(c))),{onViewTransitionCreated:K}=l;return K&&Go(c,()=>K({transition:Y,from:a,to:i})),T})}function GT(c){return new Promise(a=>{nu({read:()=>setTimeout(a)},{injector:c})})}var Aw=new ct(""),$0=(()=>{class c{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Ut;transitionAbortSubject=new Ut;configLoader=me(j0);environmentInjector=me(vs);urlSerializer=me(pp);rootContexts=me(mp);location=me(Yc);inputBindingEnabled=me(gm,{optional:!0})!==null;titleStrategy=me(Ew);options=me(yp,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=me(U0);createViewTransition=me(Pw,{optional:!0});navigationErrorHandler=me(Aw,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>bt(void 0);rootComponentType=null;constructor(){let i=h=>this.events.next(new w0(h)),l=h=>this.events.next(new C0(h));this.configLoader.onLoadEndListener=l,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let l=++this.navigationId;this.transitions?.next(si(Ye(Ye({},this.transitions.value),i),{id:l}))}setupNavigations(i,l,h){return this.transitions=new to({id:0,currentUrlTree:l,currentRawUrl:l,extractedUrl:this.urlHandlingStrategy.extract(l),urlAfterRedirects:this.urlHandlingStrategy.extract(l),rawUrl:l,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:tp,restoredState:null,currentSnapshot:h.snapshot,targetSnapshot:null,currentRouterState:h,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(vn(s=>s.id!==0),kt(s=>si(Ye({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),gr(s=>{let T=!1,Y=!1;return bt(s).pipe(gr(K=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Io.SupersededByNewNavigation),Bl;this.currentTransition=s,this.currentNavigation={id:K.id,initialUrl:K.rawUrl,extractedUrl:K.extractedUrl,targetBrowserUrl:typeof K.extras.browserUrl=="string"?this.urlSerializer.parse(K.extras.browserUrl):K.extras.browserUrl,trigger:K.source,extras:K.extras,previousNavigation:this.lastSuccessfulNavigation?si(Ye({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let Ce=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),be=K.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!Ce&&be!=="reload"){let G="";return this.events.next(new Xl(K.id,this.urlSerializer.serialize(K.rawUrl),G,sm.IgnoredSameUrlNavigation)),K.resolve(!1),Bl}if(this.urlHandlingStrategy.shouldProcessUrl(K.rawUrl))return bt(K).pipe(gr(G=>{let $e=this.transitions?.getValue();return this.events.next(new _u(G.id,this.urlSerializer.serialize(G.extractedUrl),G.source,G.restoredState)),$e!==this.transitions?.getValue()?Bl:Promise.resolve(G)}),RT(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),Ji(G=>{s.targetSnapshot=G.targetSnapshot,s.urlAfterRedirects=G.urlAfterRedirects,this.currentNavigation=si(Ye({},this.currentNavigation),{finalUrl:G.urlAfterRedirects});let $e=new am(G.id,this.urlSerializer.serialize(G.extractedUrl),this.urlSerializer.serialize(G.urlAfterRedirects),G.targetSnapshot);this.events.next($e)}));if(Ce&&this.urlHandlingStrategy.shouldProcessUrl(K.currentRawUrl)){let{id:G,extractedUrl:$e,source:ft,restoredState:Ct,extras:ut}=K,lt=new _u(G,this.urlSerializer.serialize($e),ft,Ct);this.events.next(lt);let vi=gw(this.rootComponentType).snapshot;return this.currentTransition=s=si(Ye({},K),{targetSnapshot:vi,urlAfterRedirects:$e,extras:si(Ye({},ut),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=$e,bt(s)}else{let G="";return this.events.next(new Xl(K.id,this.urlSerializer.serialize(K.extractedUrl),G,sm.IgnoredByUrlHandlingStrategy)),K.resolve(!1),Bl}}),Ji(K=>{let Ce=new y0(K.id,this.urlSerializer.serialize(K.extractedUrl),this.urlSerializer.serialize(K.urlAfterRedirects),K.targetSnapshot);this.events.next(Ce)}),kt(K=>(this.currentTransition=s=si(Ye({},K),{guards:JS(K.targetSnapshot,K.currentSnapshot,this.rootContexts)}),s)),dT(this.environmentInjector,K=>this.events.next(K)),Ji(K=>{if(s.guardsResult=K.guardsResult,K.guardsResult&&typeof K.guardsResult!="boolean")throw pm(this.urlSerializer,K.guardsResult);let Ce=new v0(K.id,this.urlSerializer.serialize(K.extractedUrl),this.urlSerializer.serialize(K.urlAfterRedirects),K.targetSnapshot,!!K.guardsResult);this.events.next(Ce)}),vn(K=>K.guardsResult?!0:(this.cancelNavigationTransition(K,"",Io.GuardRejected),!1)),h0(K=>{if(K.guards.canActivateChecks.length)return bt(K).pipe(Ji(Ce=>{let be=new b0(Ce.id,this.urlSerializer.serialize(Ce.extractedUrl),this.urlSerializer.serialize(Ce.urlAfterRedirects),Ce.targetSnapshot);this.events.next(be)}),gr(Ce=>{let be=!1;return bt(Ce).pipe(OT(this.paramsInheritanceStrategy,this.environmentInjector),Ji({next:()=>be=!0,complete:()=>{be||this.cancelNavigationTransition(Ce,"",Io.NoDataFromResolver)}}))}),Ji(Ce=>{let be=new x0(Ce.id,this.urlSerializer.serialize(Ce.extractedUrl),this.urlSerializer.serialize(Ce.urlAfterRedirects),Ce.targetSnapshot);this.events.next(be)}))}),h0(K=>{let Ce=be=>{let G=[];be.routeConfig?.loadComponent&&!be.routeConfig._loadedComponent&&G.push(this.configLoader.loadComponent(be.routeConfig).pipe(Ji($e=>{be.component=$e}),kt(()=>{})));for(let $e of be.children)G.push(...Ce($e));return G};return iu(Ce(K.targetSnapshot.root)).pipe(D_(null),xo(1))}),h0(()=>this.afterPreactivation()),gr(()=>{let{currentSnapshot:K,targetSnapshot:Ce}=s,be=this.createViewTransition?.(this.environmentInjector,K.root,Ce.root);return be?mr(be).pipe(kt(()=>s)):bt(s)}),kt(K=>{let Ce=WS(i.routeReuseStrategy,K.targetSnapshot,K.currentRouterState);return this.currentTransition=s=si(Ye({},K),{targetRouterState:Ce}),this.currentNavigation.targetRouterState=Ce,s}),Ji(()=>{this.events.next(new sp)}),QS(this.rootContexts,i.routeReuseStrategy,K=>this.events.next(K),this.inputBindingEnabled),xo(1),Ji({next:K=>{T=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Za(K.id,this.urlSerializer.serialize(K.extractedUrl),this.urlSerializer.serialize(K.urlAfterRedirects))),this.titleStrategy?.updateTitle(K.targetRouterState.snapshot),K.resolve(!0)},complete:()=>{T=!0}}),An(this.transitionAbortSubject.pipe(Ji(K=>{throw K}))),Va(()=>{!T&&!Y&&this.cancelNavigationTransition(s,"",Io.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Vl(K=>{if(Y=!0,xw(K))this.events.next(new Ga(s.id,this.urlSerializer.serialize(s.extractedUrl),K.message,K.cancellationCode)),KS(K)?this.events.next(new yu(K.url,K.navigationBehaviorOptions)):s.resolve(!1);else{let Ce=new op(s.id,this.urlSerializer.serialize(s.extractedUrl),K,s.targetSnapshot??void 0);try{let be=Go(this.environmentInjector,()=>this.navigationErrorHandler?.(Ce));if(be instanceof lp){let{message:G,cancellationCode:$e}=pm(this.urlSerializer,be);this.events.next(new Ga(s.id,this.urlSerializer.serialize(s.extractedUrl),G,$e)),this.events.next(new yu(be.redirectTo,be.navigationBehaviorOptions))}else throw this.events.next(Ce),K}catch(be){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(be)}}return Bl}))}))}cancelNavigationTransition(i,l,h){let s=new Ga(i.id,this.urlSerializer.serialize(i.extractedUrl),l,h);this.events.next(s),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let i=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),l=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return i.toString()!==l?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function HT(c){return c!==tp}var ZT=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:()=>me(qT),providedIn:"root"})}return c})(),B0=class{shouldDetach(a){return!1}store(a,i){}shouldAttach(a){return!1}retrieve(a){return null}shouldReuseRoute(a,i){return a.routeConfig===i.routeConfig}},qT=(()=>{class c extends B0{static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Dw=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:()=>me(WT),providedIn:"root"})}return c})(),WT=(()=>{class c extends Dw{location=me(Yc);urlSerializer=me(pp);options=me(yp,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=me(U0);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Ha;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=gw(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(l=>{l.type==="popstate"&&i(l.url,l.state)})}handleRouterEvent(i,l){if(i instanceof _u)this.stateMemento=this.createStateMemento();else if(i instanceof Xl)this.rawUrlTree=l.initialUrl;else if(i instanceof am){if(this.urlUpdateStrategy==="eager"&&!l.extras.skipLocationChange){let h=this.urlHandlingStrategy.merge(l.finalUrl,l.initialUrl);this.setBrowserUrl(l.targetBrowserUrl??h,l)}}else i instanceof sp?(this.currentUrlTree=l.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(l.finalUrl,l.initialUrl),this.routerState=l.targetRouterState,this.urlUpdateStrategy==="deferred"&&!l.extras.skipLocationChange&&this.setBrowserUrl(l.targetBrowserUrl??this.rawUrlTree,l)):i instanceof Ga&&(i.code===Io.GuardRejected||i.code===Io.NoDataFromResolver)?this.restoreHistory(l):i instanceof op?this.restoreHistory(l,!0):i instanceof Za&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,l){let h=i instanceof Ha?this.urlSerializer.serialize(i):i;if(this.location.isCurrentPathEqualTo(h)||l.extras.replaceUrl){let s=this.browserPageId,T=Ye(Ye({},l.extras.state),this.generateNgRouterState(l.id,s));this.location.replaceState(h,"",T)}else{let s=Ye(Ye({},l.extras.state),this.generateNgRouterState(l.id,this.browserPageId+1));this.location.go(h,"",s)}}restoreHistory(i,l=!1){if(this.canceledNavigationResolution==="computed"){let h=this.browserPageId,s=this.currentPageId-h;s!==0?this.location.historyGo(s):this.currentUrlTree===i.finalUrl&&s===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(l&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,l){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:l}:{navigationId:i}}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Jh=function(c){return c[c.COMPLETE=0]="COMPLETE",c[c.FAILED=1]="FAILED",c[c.REDIRECTING=2]="REDIRECTING",c}(Jh||{});function Rw(c,a){c.events.pipe(vn(i=>i instanceof Za||i instanceof Ga||i instanceof op||i instanceof Xl),kt(i=>i instanceof Za||i instanceof Xl?Jh.COMPLETE:(i instanceof Ga?i.code===Io.Redirect||i.code===Io.SupersededByNewNavigation:!1)?Jh.REDIRECTING:Jh.FAILED),vn(i=>i!==Jh.REDIRECTING),xo(1)).subscribe(()=>{a()})}var XT={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},YT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},no=(()=>{class c{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=me(Af);stateManager=me(Dw);options=me(yp,{optional:!0})||{};pendingTasks=me(Rh);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=me($0);urlSerializer=me(pp);location=me(Yc);urlHandlingStrategy=me(U0);_events=new Ut;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=me(ZT);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=me(up,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!me(gm,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Sr;subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(l=>{try{let h=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(h!==null&&s!==null){if(this.stateManager.handleRouterEvent(l,s),l instanceof Ga&&l.code!==Io.Redirect&&l.code!==Io.SupersededByNewNavigation)this.navigated=!0;else if(l instanceof Za)this.navigated=!0;else if(l instanceof yu){let T=l.navigationBehaviorOptions,Y=this.urlHandlingStrategy.merge(l.url,h.currentRawUrl),K=Ye({browserUrl:h.extras.browserUrl,info:h.extras.info,skipLocationChange:h.extras.skipLocationChange,replaceUrl:h.extras.replaceUrl||this.urlUpdateStrategy==="eager"||HT(h.source)},T);this.scheduleNavigation(Y,tp,null,K,{resolve:h.resolve,reject:h.reject,promise:h.promise})}}QT(l)&&this._events.next(l)}catch(h){this.navigationTransitions.transitionAbortSubject.next(h)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),tp,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,l)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",l)},0)})}navigateToSyncWithBrowser(i,l,h){let s={replaceUrl:!0},T=h?.navigationId?h:null;if(h){let K=Ye({},h);delete K.navigationId,delete K.\u0275routerPageId,Object.keys(K).length!==0&&(s.state=K)}let Y=this.parseUrl(i);this.scheduleNavigation(Y,l,T,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(V0),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,l={}){let{relativeTo:h,queryParams:s,fragment:T,queryParamsHandling:Y,preserveFragment:K}=l,Ce=K?this.currentUrlTree.fragment:T,be=null;switch(Y??this.options.defaultQueryParamsHandling){case"merge":be=Ye(Ye({},this.currentUrlTree.queryParams),s);break;case"preserve":be=this.currentUrlTree.queryParams;break;default:be=s||null}be!==null&&(be=this.removeEmptyProps(be));let G;try{let $e=h?h.snapshot:this.routerState.snapshot.root;G=hw($e)}catch{(typeof i[0]!="string"||i[0][0]!=="/")&&(i=[]),G=this.currentUrlTree.root}return pw(G,i,be,Ce??null)}navigateByUrl(i,l={skipLocationChange:!1}){let h=np(i)?i:this.parseUrl(i),s=this.urlHandlingStrategy.merge(h,this.rawUrlTree);return this.scheduleNavigation(s,tp,null,l)}navigate(i,l={skipLocationChange:!1}){return KT(i),this.navigateByUrl(this.createUrlTree(i,l),l)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,l){let h;if(l===!0?h=Ye({},XT):l===!1?h=Ye({},YT):h=l,np(i))return Zx(this.currentUrlTree,i,h);let s=this.parseUrl(i);return Zx(this.currentUrlTree,s,h)}removeEmptyProps(i){return Object.entries(i).reduce((l,[h,s])=>(s!=null&&(l[h]=s),l),{})}scheduleNavigation(i,l,h,s,T){if(this.disposed)return Promise.resolve(!1);let Y,K,Ce;T?(Y=T.resolve,K=T.reject,Ce=T.promise):Ce=new Promise((G,$e)=>{Y=G,K=$e});let be=this.pendingTasks.add();return Rw(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(be))}),this.navigationTransitions.handleNavigationRequest({source:l,restoredState:h,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:s,resolve:Y,reject:K,promise:Ce,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ce.catch(G=>Promise.reject(G))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function KT(c){for(let a=0;a<c.length;a++)if(c[a]==null)throw new ki(4008,!1)}function QT(c){return!(c instanceof sp)&&!(c instanceof yu)}var mm=class{};var JT=(()=>{class c{router;injector;preloadingStrategy;loader;subscription;constructor(i,l,h,s,T){this.router=i,this.injector=h,this.preloadingStrategy=s,this.loader=T}setUpPreloading(){this.subscription=this.router.events.pipe(vn(i=>i instanceof Za),jl(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,l){let h=[];for(let s of l){s.providers&&!s._injector&&(s._injector=V_(s.providers,i,`Route: ${s.path}`));let T=s._injector??i,Y=s._loadedInjector??T;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&h.push(this.preloadConfig(T,s)),(s.children||s._loadedRoutes)&&h.push(this.processRoutes(Y,s.children??s._loadedRoutes))}return mr(h).pipe(k_())}preloadConfig(i,l){return this.preloadingStrategy.preload(l,()=>{let h;l.loadChildren&&l.canLoad===void 0?h=this.loader.loadChildren(i,l):h=bt(null);let s=h.pipe(bo(T=>T===null?bt(void 0):(l._loadedRoutes=T.routes,l._loadedInjector=T.injector,this.processRoutes(T.injector??i,T.routes))));if(l.loadComponent&&!l._loadedComponent){let T=this.loader.loadComponent(l);return mr([s,T]).pipe(k_())}else return s})}static \u0275fac=function(l){return new(l||c)(zt(no),zt(zf),zt(vs),zt(mm),zt(j0))};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Ow=new ct(""),eE=(()=>{class c{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(i,l,h,s,T={}){this.urlSerializer=i,this.transitions=l,this.viewportScroller=h,this.zone=s,this.options=T,T.scrollPositionRestoration||="disabled",T.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof _u?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof Za?(this.lastId=i.id,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.urlAfterRedirects).fragment)):i instanceof Xl&&i.code===sm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof lm&&(i.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(i.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,l){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new lm(i,this.lastSource==="popstate"?this.store[this.restoredId]:null,l))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(l){If()};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})();function Fw(c,...a){return Hc([{provide:up,multi:!0,useValue:c},[],{provide:ed,useFactory:Lw,deps:[no]},{provide:Rf,multi:!0,useFactory:zw},a.map(i=>i.\u0275providers)])}function Lw(c){return c.routerState.root}function vp(c,a){return{\u0275kind:c,\u0275providers:a}}function zw(){let c=me(Tr);return a=>{let i=c.get(Gl);if(a!==i.components[0])return;let l=c.get(no),h=c.get(Bw);c.get(G0)===1&&l.initialNavigation(),c.get(Nw,null,L_.Optional)?.setUpPreloading(),c.get(Ow,null,L_.Optional)?.init(),l.resetRootComponentType(i.componentTypes[0]),h.closed||(h.next(),h.complete(),h.unsubscribe())}}var Bw=new ct("",{factory:()=>new Ut}),G0=new ct("",{providedIn:"root",factory:()=>1});function tE(){return vp(2,[{provide:G0,useValue:0},{provide:j_,multi:!0,deps:[Tr],useFactory:a=>{let i=a.get(px,Promise.resolve());return()=>i.then(()=>new Promise(l=>{let h=a.get(no),s=a.get(Bw);Rw(h,()=>{l(!0)}),a.get($0).afterPreactivation=()=>(l(!0),s.closed?bt(void 0):s),h.initialNavigation()}))}}])}function iE(){return vp(3,[{provide:j_,multi:!0,useFactory:()=>{let a=me(no);return()=>{a.setUpLocationChangeListener()}}},{provide:G0,useValue:2}])}var Nw=new ct("");function nE(c){return vp(0,[{provide:Nw,useExisting:JT},{provide:mm,useExisting:c}])}function rE(){return vp(8,[Yx,{provide:gm,useExisting:Yx}])}function oE(c){let a=[{provide:Pw,useValue:$T},{provide:kw,useValue:Ye({skipNextTransition:!!c?.skipInitialTransition},c)}];return vp(9,a)}var ew=new ct("ROUTER_FORROOT_GUARD"),sE=[Yc,{provide:pp,useClass:gu},no,mp,{provide:ed,useFactory:Lw,deps:[no]},j0,[]],Kl=(()=>{class c{constructor(i){}static forRoot(i,l){return{ngModule:c,providers:[sE,[],{provide:up,multi:!0,useValue:i},{provide:ew,useFactory:dE,deps:[[no,new Ah,new z_]]},l?.errorHandler?{provide:Aw,useValue:l.errorHandler}:[],{provide:yp,useValue:l||{}},l?.useHash?lE():cE(),aE(),l?.preloadingStrategy?nE(l.preloadingStrategy).\u0275providers:[],l?.initialNavigation?uE(l):[],l?.bindToComponentInputs?rE().\u0275providers:[],l?.enableViewTransitions?oE().\u0275providers:[],hE()]}}static forChild(i){return{ngModule:c,providers:[{provide:up,multi:!0,useValue:i}]}}static \u0275fac=function(l){return new(l||c)(zt(ew,8))};static \u0275mod=qt({type:c});static \u0275inj=Zt({})}return c})();function aE(){return{provide:Ow,useFactory:()=>{let c=me(vx),a=me(hi),i=me(yp),l=me($0),h=me(pp);return i.scrollOffset&&c.setOffset(i.scrollOffset),new eE(h,l,c,a,i)}}}function lE(){return{provide:H_,useClass:mx}}function cE(){return{provide:H_,useClass:fx}}function dE(c){return"guarded"}function uE(c){return[c.initialNavigation==="disabled"?iE().\u0275providers:[],c.initialNavigation==="enabledBlocking"?tE().\u0275providers:[]]}var tw=new ct("");function hE(){return[{provide:tw,useFactory:zw},{provide:Rf,multi:!0,useExisting:tw}]}var Xw=(()=>{class c{_renderer;_elementRef;onChange=i=>{};onTouched=()=>{};constructor(i,l){this._renderer=i,this._elementRef=l}setProperty(i,l){this._renderer.setProperty(this._elementRef.nativeElement,i,l)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}static \u0275fac=function(l){return new(l||c)(Ft(su),Ft(Ci))};static \u0275dir=Wt({type:c})}return c})(),Tm=(()=>{class c extends Xw{static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275dir=Wt({type:c,features:[Nr]})}return c})(),ec=new ct(""),pE={provide:ec,useExisting:$o(()=>Y0),multi:!0},Y0=(()=>{class c extends Tm{writeValue(i){this.setProperty("checked",i)}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275dir=Wt({type:c,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(l,h){l&1&&_t("change",function(T){return h.onChange(T.target.checked)})("blur",function(){return h.onTouched()})},standalone:!1,features:[Un([pE]),Nr]})}return c})(),fE={provide:ec,useExisting:$o(()=>tc),multi:!0};function mE(){let c=lu()?lu().getUserAgent():"";return/android (\d+)/.test(c.toLowerCase())}var gE=new ct(""),tc=(()=>{class c extends Xw{_compositionMode;_composing=!1;constructor(i,l,h){super(i,l),this._compositionMode=h,this._compositionMode==null&&(this._compositionMode=!mE())}writeValue(i){let l=i??"";this.setProperty("value",l)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}static \u0275fac=function(l){return new(l||c)(Ft(su),Ft(Ci),Ft(gE,8))};static \u0275dir=Wt({type:c,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(l,h){l&1&&_t("input",function(T){return h._handleInput(T.target.value)})("blur",function(){return h.onTouched()})("compositionstart",function(){return h._compositionStart()})("compositionend",function(T){return h._compositionEnd(T.target.value)})},standalone:!1,features:[Un([fE]),Nr]})}return c})();function Ql(c){return c==null||(typeof c=="string"||Array.isArray(c))&&c.length===0}function Yw(c){return c!=null&&typeof c.length=="number"}var Em=new ct(""),Im=new ct(""),_E=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Po=class{static min(a){return yE(a)}static max(a){return vE(a)}static required(a){return bE(a)}static requiredTrue(a){return xE(a)}static email(a){return wE(a)}static minLength(a){return CE(a)}static maxLength(a){return ME(a)}static pattern(a){return SE(a)}static nullValidator(a){return Kw(a)}static compose(a){return n1(a)}static composeAsync(a){return r1(a)}};function yE(c){return a=>{if(Ql(a.value)||Ql(c))return null;let i=parseFloat(a.value);return!isNaN(i)&&i<c?{min:{min:c,actual:a.value}}:null}}function vE(c){return a=>{if(Ql(a.value)||Ql(c))return null;let i=parseFloat(a.value);return!isNaN(i)&&i>c?{max:{max:c,actual:a.value}}:null}}function bE(c){return Ql(c.value)?{required:!0}:null}function xE(c){return c.value===!0?null:{required:!0}}function wE(c){return Ql(c.value)||_E.test(c.value)?null:{email:!0}}function CE(c){return a=>Ql(a.value)||!Yw(a.value)?null:a.value.length<c?{minlength:{requiredLength:c,actualLength:a.value.length}}:null}function ME(c){return a=>Yw(a.value)&&a.value.length>c?{maxlength:{requiredLength:c,actualLength:a.value.length}}:null}function SE(c){if(!c)return Kw;let a,i;return typeof c=="string"?(i="",c.charAt(0)!=="^"&&(i+="^"),i+=c,c.charAt(c.length-1)!=="$"&&(i+="$"),a=new RegExp(i)):(i=c.toString(),a=c),l=>{if(Ql(l.value))return null;let h=l.value;return a.test(h)?null:{pattern:{requiredPattern:i,actualValue:h}}}}function Kw(c){return null}function Qw(c){return c!=null}function Jw(c){return Df(c)?mr(c):c}function e1(c){let a={};return c.forEach(i=>{a=i!=null?Ye(Ye({},a),i):a}),Object.keys(a).length===0?null:a}function t1(c,a){return a.map(i=>i(c))}function TE(c){return!c.validate}function i1(c){return c.map(a=>TE(a)?a:i=>a.validate(i))}function n1(c){if(!c)return null;let a=c.filter(Qw);return a.length==0?null:function(i){return e1(t1(i,a))}}function K0(c){return c!=null?n1(i1(c)):null}function r1(c){if(!c)return null;let a=c.filter(Qw);return a.length==0?null:function(i){let l=t1(i,a).map(Jw);return Mf(l).pipe(kt(e1))}}function Q0(c){return c!=null?r1(i1(c)):null}function Vw(c,a){return c===null?[a]:Array.isArray(c)?[...c,a]:[c,a]}function o1(c){return c._rawValidators}function s1(c){return c._rawAsyncValidators}function H0(c){return c?Array.isArray(c)?c:[c]:[]}function vm(c,a){return Array.isArray(c)?c.includes(a):c===a}function jw(c,a){let i=H0(a);return H0(c).forEach(h=>{vm(i,h)||i.push(h)}),i}function Uw(c,a){return H0(a).filter(i=>!vm(c,i))}var bm=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(a){this._rawValidators=a||[],this._composedValidatorFn=K0(this._rawValidators)}_setAsyncValidators(a){this._rawAsyncValidators=a||[],this._composedAsyncValidatorFn=Q0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(a){this._onDestroyCallbacks.push(a)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(a=>a()),this._onDestroyCallbacks=[]}reset(a=void 0){this.control&&this.control.reset(a)}hasError(a,i){return this.control?this.control.hasError(a,i):!1}getError(a,i){return this.control?this.control.getError(a,i):null}},qa=class extends bm{name;get formDirective(){return null}get path(){return null}},Wa=class extends bm{_parent=null;name=null;valueAccessor=null},xm=class{_cd;constructor(a){this._cd=a}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},EE={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},QD=si(Ye({},EE),{"[class.ng-submitted]":"isSubmitted"}),ic=(()=>{class c extends xm{constructor(i){super(i)}static \u0275fac=function(l){return new(l||c)(Ft(Wa,2))};static \u0275dir=Wt({type:c,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(l,h){l&2&&wi("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)},standalone:!1,features:[Nr]})}return c})(),Pm=(()=>{class c extends xm{constructor(i){super(i)}static \u0275fac=function(l){return new(l||c)(Ft(qa,10))};static \u0275dir=Wt({type:c,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(l,h){l&2&&wi("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)("ng-submitted",h.isSubmitted)},standalone:!1,features:[Nr]})}return c})();var xp="VALID",ym="INVALID",xu="PENDING",wp="DISABLED",Jl=class{},wm=class extends Jl{value;source;constructor(a,i){super(),this.value=a,this.source=i}},Mp=class extends Jl{pristine;source;constructor(a,i){super(),this.pristine=a,this.source=i}},Sp=class extends Jl{touched;source;constructor(a,i){super(),this.touched=a,this.source=i}},wu=class extends Jl{status;source;constructor(a,i){super(),this.status=a,this.source=i}},Z0=class extends Jl{source;constructor(a){super(),this.source=a}},q0=class extends Jl{source;constructor(a){super(),this.source=a}};function J0(c){return(km(c)?c.validators:c)||null}function IE(c){return Array.isArray(c)?K0(c):c||null}function ey(c,a){return(km(a)?a.asyncValidators:c)||null}function PE(c){return Array.isArray(c)?Q0(c):c||null}function km(c){return c!=null&&!Array.isArray(c)&&typeof c=="object"}function a1(c,a,i){let l=c.controls;if(!(a?Object.keys(l):l).length)throw new ki(1e3,"");if(!l[i])throw new ki(1001,"")}function l1(c,a,i){c._forEachChild((l,h)=>{if(i[h]===void 0)throw new ki(1002,"")})}var Cu=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(a,i){this._assignValidators(a),this._assignAsyncValidators(i)}get validator(){return this._composedValidatorFn}set validator(a){this._rawValidators=this._composedValidatorFn=a}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(a){this._rawAsyncValidators=this._composedAsyncValidatorFn=a}get parent(){return this._parent}get status(){return bs(this.statusReactive)}set status(a){bs(()=>this.statusReactive.set(a))}_status=$a(()=>this.statusReactive());statusReactive=$l(void 0);get valid(){return this.status===xp}get invalid(){return this.status===ym}get pending(){return this.status==xu}get disabled(){return this.status===wp}get enabled(){return this.status!==wp}errors;get pristine(){return bs(this.pristineReactive)}set pristine(a){bs(()=>this.pristineReactive.set(a))}_pristine=$a(()=>this.pristineReactive());pristineReactive=$l(!0);get dirty(){return!this.pristine}get touched(){return bs(this.touchedReactive)}set touched(a){bs(()=>this.touchedReactive.set(a))}_touched=$a(()=>this.touchedReactive());touchedReactive=$l(!1);get untouched(){return!this.touched}_events=new Ut;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(a){this._assignValidators(a)}setAsyncValidators(a){this._assignAsyncValidators(a)}addValidators(a){this.setValidators(jw(a,this._rawValidators))}addAsyncValidators(a){this.setAsyncValidators(jw(a,this._rawAsyncValidators))}removeValidators(a){this.setValidators(Uw(a,this._rawValidators))}removeAsyncValidators(a){this.setAsyncValidators(Uw(a,this._rawAsyncValidators))}hasValidator(a){return vm(this._rawValidators,a)}hasAsyncValidator(a){return vm(this._rawAsyncValidators,a)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(a={}){let i=this.touched===!1;this.touched=!0;let l=a.sourceControl??this;this._parent&&!a.onlySelf&&this._parent.markAsTouched(si(Ye({},a),{sourceControl:l})),i&&a.emitEvent!==!1&&this._events.next(new Sp(!0,l))}markAllAsTouched(a={}){this.markAsTouched({onlySelf:!0,emitEvent:a.emitEvent,sourceControl:this}),this._forEachChild(i=>i.markAllAsTouched(a))}markAsUntouched(a={}){let i=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let l=a.sourceControl??this;this._forEachChild(h=>{h.markAsUntouched({onlySelf:!0,emitEvent:a.emitEvent,sourceControl:l})}),this._parent&&!a.onlySelf&&this._parent._updateTouched(a,l),i&&a.emitEvent!==!1&&this._events.next(new Sp(!1,l))}markAsDirty(a={}){let i=this.pristine===!0;this.pristine=!1;let l=a.sourceControl??this;this._parent&&!a.onlySelf&&this._parent.markAsDirty(si(Ye({},a),{sourceControl:l})),i&&a.emitEvent!==!1&&this._events.next(new Mp(!1,l))}markAsPristine(a={}){let i=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let l=a.sourceControl??this;this._forEachChild(h=>{h.markAsPristine({onlySelf:!0,emitEvent:a.emitEvent})}),this._parent&&!a.onlySelf&&this._parent._updatePristine(a,l),i&&a.emitEvent!==!1&&this._events.next(new Mp(!0,l))}markAsPending(a={}){this.status=xu;let i=a.sourceControl??this;a.emitEvent!==!1&&(this._events.next(new wu(this.status,i)),this.statusChanges.emit(this.status)),this._parent&&!a.onlySelf&&this._parent.markAsPending(si(Ye({},a),{sourceControl:i}))}disable(a={}){let i=this._parentMarkedDirty(a.onlySelf);this.status=wp,this.errors=null,this._forEachChild(h=>{h.disable(si(Ye({},a),{onlySelf:!0}))}),this._updateValue();let l=a.sourceControl??this;a.emitEvent!==!1&&(this._events.next(new wm(this.value,l)),this._events.next(new wu(this.status,l)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(si(Ye({},a),{skipPristineCheck:i}),this),this._onDisabledChange.forEach(h=>h(!0))}enable(a={}){let i=this._parentMarkedDirty(a.onlySelf);this.status=xp,this._forEachChild(l=>{l.enable(si(Ye({},a),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:a.emitEvent}),this._updateAncestors(si(Ye({},a),{skipPristineCheck:i}),this),this._onDisabledChange.forEach(l=>l(!1))}_updateAncestors(a,i){this._parent&&!a.onlySelf&&(this._parent.updateValueAndValidity(a),a.skipPristineCheck||this._parent._updatePristine({},i),this._parent._updateTouched({},i))}setParent(a){this._parent=a}getRawValue(){return this.value}updateValueAndValidity(a={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let l=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===xp||this.status===xu)&&this._runAsyncValidator(l,a.emitEvent)}let i=a.sourceControl??this;a.emitEvent!==!1&&(this._events.next(new wm(this.value,i)),this._events.next(new wu(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!a.onlySelf&&this._parent.updateValueAndValidity(si(Ye({},a),{sourceControl:i}))}_updateTreeValidity(a={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(a)),this.updateValueAndValidity({onlySelf:!0,emitEvent:a.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?wp:xp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(a,i){if(this.asyncValidator){this.status=xu,this._hasOwnPendingAsyncValidator={emitEvent:i!==!1};let l=Jw(this.asyncValidator(this));this._asyncValidationSubscription=l.subscribe(h=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(h,{emitEvent:i,shouldHaveEmitted:a})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let a=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,a}return!1}setErrors(a,i={}){this.errors=a,this._updateControlsErrors(i.emitEvent!==!1,this,i.shouldHaveEmitted)}get(a){let i=a;return i==null||(Array.isArray(i)||(i=i.split(".")),i.length===0)?null:i.reduce((l,h)=>l&&l._find(h),this)}getError(a,i){let l=i?this.get(i):this;return l&&l.errors?l.errors[a]:null}hasError(a,i){return!!this.getError(a,i)}get root(){let a=this;for(;a._parent;)a=a._parent;return a}_updateControlsErrors(a,i,l){this.status=this._calculateStatus(),a&&this.statusChanges.emit(this.status),(a||l)&&this._events.next(new wu(this.status,i)),this._parent&&this._parent._updateControlsErrors(a,i,l)}_initObservables(){this.valueChanges=new xi,this.statusChanges=new xi}_calculateStatus(){return this._allControlsDisabled()?wp:this.errors?ym:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xu)?xu:this._anyControlsHaveStatus(ym)?ym:xp}_anyControlsHaveStatus(a){return this._anyControls(i=>i.status===a)}_anyControlsDirty(){return this._anyControls(a=>a.dirty)}_anyControlsTouched(){return this._anyControls(a=>a.touched)}_updatePristine(a,i){let l=!this._anyControlsDirty(),h=this.pristine!==l;this.pristine=l,this._parent&&!a.onlySelf&&this._parent._updatePristine(a,i),h&&this._events.next(new Mp(this.pristine,i))}_updateTouched(a={},i){this.touched=this._anyControlsTouched(),this._events.next(new Sp(this.touched,i)),this._parent&&!a.onlySelf&&this._parent._updateTouched(a,i)}_onDisabledChange=[];_registerOnCollectionChange(a){this._onCollectionChange=a}_setUpdateStrategy(a){km(a)&&a.updateOn!=null&&(this._updateOn=a.updateOn)}_parentMarkedDirty(a){let i=this._parent&&this._parent.dirty;return!a&&!!i&&!this._parent._anyControlsDirty()}_find(a){return null}_assignValidators(a){this._rawValidators=Array.isArray(a)?a.slice():a,this._composedValidatorFn=IE(this._rawValidators)}_assignAsyncValidators(a){this._rawAsyncValidators=Array.isArray(a)?a.slice():a,this._composedAsyncValidatorFn=PE(this._rawAsyncValidators)}},Mu=class extends Cu{constructor(a,i,l){super(J0(i),ey(l,i)),this.controls=a,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(a,i){return this.controls[a]?this.controls[a]:(this.controls[a]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(a,i,l={}){this.registerControl(a,i),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}removeControl(a,i={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),delete this.controls[a],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(a,i,l={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),delete this.controls[a],i&&this.registerControl(a,i),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}contains(a){return this.controls.hasOwnProperty(a)&&this.controls[a].enabled}setValue(a,i={}){l1(this,!0,a),Object.keys(a).forEach(l=>{a1(this,!0,l),this.controls[l].setValue(a[l],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(a,i={}){a!=null&&(Object.keys(a).forEach(l=>{let h=this.controls[l];h&&h.patchValue(a[l],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(a={},i={}){this._forEachChild((l,h)=>{l.reset(a?a[h]:null,{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i,this),this._updateTouched(i,this),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(a,i,l)=>(a[l]=i.getRawValue(),a))}_syncPendingControls(){let a=this._reduceChildren(!1,(i,l)=>l._syncPendingControls()?!0:i);return a&&this.updateValueAndValidity({onlySelf:!0}),a}_forEachChild(a){Object.keys(this.controls).forEach(i=>{let l=this.controls[i];l&&a(l,i)})}_setUpControls(){this._forEachChild(a=>{a.setParent(this),a._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(a){for(let[i,l]of Object.entries(this.controls))if(this.contains(i)&&a(l))return!0;return!1}_reduceValue(){let a={};return this._reduceChildren(a,(i,l,h)=>((l.enabled||this.disabled)&&(i[h]=l.value),i))}_reduceChildren(a,i){let l=a;return this._forEachChild((h,s)=>{l=i(l,h,s)}),l}_allControlsDisabled(){for(let a of Object.keys(this.controls))if(this.controls[a].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(a){return this.controls.hasOwnProperty(a)?this.controls[a]:null}};var W0=class extends Mu{};var Ep=new ct("CallSetDisabledState",{providedIn:"root",factory:()=>Am}),Am="always";function c1(c,a){return[...a.path,c]}function Cm(c,a,i=Am){ty(c,a),a.valueAccessor.writeValue(c.value),(c.disabled||i==="always")&&a.valueAccessor.setDisabledState?.(c.disabled),AE(c,a),RE(c,a),DE(c,a),kE(c,a)}function $w(c,a,i=!0){let l=()=>{};a.valueAccessor&&(a.valueAccessor.registerOnChange(l),a.valueAccessor.registerOnTouched(l)),Sm(c,a),c&&(a._invokeOnDestroyCallbacks(),c._registerOnCollectionChange(()=>{}))}function Mm(c,a){c.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(a)})}function kE(c,a){if(a.valueAccessor.setDisabledState){let i=l=>{a.valueAccessor.setDisabledState(l)};c.registerOnDisabledChange(i),a._registerOnDestroy(()=>{c._unregisterOnDisabledChange(i)})}}function ty(c,a){let i=o1(c);a.validator!==null?c.setValidators(Vw(i,a.validator)):typeof i=="function"&&c.setValidators([i]);let l=s1(c);a.asyncValidator!==null?c.setAsyncValidators(Vw(l,a.asyncValidator)):typeof l=="function"&&c.setAsyncValidators([l]);let h=()=>c.updateValueAndValidity();Mm(a._rawValidators,h),Mm(a._rawAsyncValidators,h)}function Sm(c,a){let i=!1;if(c!==null){if(a.validator!==null){let h=o1(c);if(Array.isArray(h)&&h.length>0){let s=h.filter(T=>T!==a.validator);s.length!==h.length&&(i=!0,c.setValidators(s))}}if(a.asyncValidator!==null){let h=s1(c);if(Array.isArray(h)&&h.length>0){let s=h.filter(T=>T!==a.asyncValidator);s.length!==h.length&&(i=!0,c.setAsyncValidators(s))}}}let l=()=>{};return Mm(a._rawValidators,l),Mm(a._rawAsyncValidators,l),i}function AE(c,a){a.valueAccessor.registerOnChange(i=>{c._pendingValue=i,c._pendingChange=!0,c._pendingDirty=!0,c.updateOn==="change"&&d1(c,a)})}function DE(c,a){a.valueAccessor.registerOnTouched(()=>{c._pendingTouched=!0,c.updateOn==="blur"&&c._pendingChange&&d1(c,a),c.updateOn!=="submit"&&c.markAsTouched()})}function d1(c,a){c._pendingDirty&&c.markAsDirty(),c.setValue(c._pendingValue,{emitModelToViewChange:!1}),a.viewToModelUpdate(c._pendingValue),c._pendingChange=!1}function RE(c,a){let i=(l,h)=>{a.valueAccessor.writeValue(l),h&&a.viewToModelUpdate(l)};c.registerOnChange(i),a._registerOnDestroy(()=>{c._unregisterOnChange(i)})}function u1(c,a){c==null,ty(c,a)}function OE(c,a){return Sm(c,a)}function h1(c,a){if(!c.hasOwnProperty("model"))return!1;let i=c.model;return i.isFirstChange()?!0:!Object.is(a,i.currentValue)}function FE(c){return Object.getPrototypeOf(c.constructor)===Tm}function p1(c,a){c._syncPendingControls(),a.forEach(i=>{let l=i.control;l.updateOn==="submit"&&l._pendingChange&&(i.viewToModelUpdate(l._pendingValue),l._pendingChange=!1)})}function f1(c,a){if(!a)return null;Array.isArray(a);let i,l,h;return a.forEach(s=>{s.constructor===tc?i=s:FE(s)?l=s:h=s}),h||l||i||null}function LE(c,a){let i=c.indexOf(a);i>-1&&c.splice(i,1)}var zE={provide:qa,useExisting:$o(()=>iy)},Cp=Promise.resolve(),iy=(()=>{class c extends qa{callSetDisabledState;get submitted(){return bs(this.submittedReactive)}_submitted=$a(()=>this.submittedReactive());submittedReactive=$l(!1);_directives=new Set;form;ngSubmit=new xi;options;constructor(i,l,h){super(),this.callSetDisabledState=h,this.form=new Mu({},K0(i),Q0(l))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(i){Cp.then(()=>{let l=this._findContainer(i.path);i.control=l.registerControl(i.name,i.control),Cm(i.control,i,this.callSetDisabledState),i.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(i)})}getControl(i){return this.form.get(i.path)}removeControl(i){Cp.then(()=>{let l=this._findContainer(i.path);l&&l.removeControl(i.name),this._directives.delete(i)})}addFormGroup(i){Cp.then(()=>{let l=this._findContainer(i.path),h=new Mu({});u1(h,i),l.registerControl(i.name,h),h.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(i){Cp.then(()=>{let l=this._findContainer(i.path);l&&l.removeControl(i.name)})}getFormGroup(i){return this.form.get(i.path)}updateModel(i,l){Cp.then(()=>{this.form.get(i.path).setValue(l)})}setValue(i){this.control.setValue(i)}onSubmit(i){return this.submittedReactive.set(!0),p1(this.form,this._directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(i){return i.pop(),i.length?this.form.get(i):this.form}static \u0275fac=function(l){return new(l||c)(Ft(Em,10),Ft(Im,10),Ft(Ep,8))};static \u0275dir=Wt({type:c,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(l,h){l&1&&_t("submit",function(T){return h.onSubmit(T)})("reset",function(){return h.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Un([zE]),Nr]})}return c})();function Gw(c,a){let i=c.indexOf(a);i>-1&&c.splice(i,1)}function Hw(c){return typeof c=="object"&&c!==null&&Object.keys(c).length===2&&"value"in c&&"disabled"in c}var Tp=class extends Cu{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(a=null,i,l){super(J0(i),ey(l,i)),this._applyFormState(a),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),km(i)&&(i.nonNullable||i.initialValueIsDefault)&&(Hw(a)?this.defaultValue=a.value:this.defaultValue=a)}setValue(a,i={}){this.value=this._pendingValue=a,this._onChange.length&&i.emitModelToViewChange!==!1&&this._onChange.forEach(l=>l(this.value,i.emitViewToModelChange!==!1)),this.updateValueAndValidity(i)}patchValue(a,i={}){this.setValue(a,i)}reset(a=this.defaultValue,i={}){this._applyFormState(a),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(a){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(a){this._onChange.push(a)}_unregisterOnChange(a){Gw(this._onChange,a)}registerOnDisabledChange(a){this._onDisabledChange.push(a)}_unregisterOnDisabledChange(a){Gw(this._onDisabledChange,a)}_forEachChild(a){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(a){Hw(a)?(this.value=this._pendingValue=a.value,a.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=a}};var BE=c=>c instanceof Tp;var NE={provide:Wa,useExisting:$o(()=>td)},Zw=Promise.resolve(),td=(()=>{class c extends Wa{_changeDetectorRef;callSetDisabledState;control=new Tp;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new xi;constructor(i,l,h,s,T,Y){super(),this._changeDetectorRef=T,this.callSetDisabledState=Y,this._parent=i,this._setValidators(l),this._setAsyncValidators(h),this.valueAccessor=f1(this,s)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){let l=i.name.previousValue;this.formDirective.removeControl({name:l,path:this._getPath(l)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),h1(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Cm(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(i){Zw.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){let l=i.isDisabled.currentValue,h=l!==0&&pi(l);Zw.then(()=>{h&&!this.control.disabled?this.control.disable():!h&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?c1(i,this._parent):[i]}static \u0275fac=function(l){return new(l||c)(Ft(qa,9),Ft(Em,10),Ft(Im,10),Ft(ec,10),Ft(Ur,8),Ft(Ep,8))};static \u0275dir=Wt({type:c,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Un([NE]),Nr,Ho]})}return c})(),Dm=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return c})();var m1=new ct("");var VE={provide:qa,useExisting:$o(()=>id)},id=(()=>{class c extends qa{callSetDisabledState;get submitted(){return bs(this._submittedReactive)}set submitted(i){this._submittedReactive.set(i)}_submitted=$a(()=>this._submittedReactive());_submittedReactive=$l(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new xi;constructor(i,l,h){super(),this.callSetDisabledState=h,this._setValidators(i),this._setAsyncValidators(l)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Sm(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let l=this.form.get(i.path);return Cm(l,i,this.callSetDisabledState),l.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),l}getControl(i){return this.form.get(i.path)}removeControl(i){$w(i.control||null,i,!1),LE(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,l){this.form.get(i.path).setValue(l)}onSubmit(i){return this._submittedReactive.set(!0),p1(this.form,this.directives),this.ngSubmit.emit(i),this.form._events.next(new Z0(this.control)),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this._submittedReactive.set(!1),this.form._events.next(new q0(this.form))}_updateDomValue(){this.directives.forEach(i=>{let l=i.control,h=this.form.get(i.path);l!==h&&($w(l||null,i),BE(h)&&(Cm(h,i,this.callSetDisabledState),i.control=h))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let l=this.form.get(i.path);u1(l,i),l.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let l=this.form.get(i.path);l&&OE(l,i)&&l.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){ty(this.form,this),this._oldForm&&Sm(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(l){return new(l||c)(Ft(Em,10),Ft(Im,10),Ft(Ep,8))};static \u0275dir=Wt({type:c,selectors:[["","formGroup",""]],hostBindings:function(l,h){l&1&&_t("submit",function(T){return h.onSubmit(T)})("reset",function(){return h.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Un([VE]),Nr,Ho]})}return c})();var jE={provide:Wa,useExisting:$o(()=>Ip)},Ip=(()=>{class c extends Wa{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(i){}model;update=new xi;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(i,l,h,s,T){super(),this._ngModelWarningConfig=T,this._parent=i,this._setValidators(l),this._setAsyncValidators(h),this.valueAccessor=f1(this,s)}ngOnChanges(i){this._added||this._setUpControl(),h1(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return c1(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(l){return new(l||c)(Ft(qa,13),Ft(Em,10),Ft(Im,10),Ft(ec,10),Ft(m1,8))};static \u0275dir=Wt({type:c,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Un([jE]),Nr,Ho]})}return c})(),UE={provide:ec,useExisting:$o(()=>Su),multi:!0};function g1(c,a){return c==null?`${a}`:(a&&typeof a=="object"&&(a="Object"),`${c}: ${a}`.slice(0,50))}function $E(c){return c.split(":")[0]}var Su=(()=>{class c extends Tm{value;_optionMap=new Map;_idCounter=0;set compareWith(i){this._compareWith=i}_compareWith=Object.is;writeValue(i){this.value=i;let l=this._getOptionId(i),h=g1(l,i);this.setProperty("value",h)}registerOnChange(i){this.onChange=l=>{this.value=this._getOptionValue(l),i(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(i){for(let l of this._optionMap.keys())if(this._compareWith(this._optionMap.get(l),i))return l;return null}_getOptionValue(i){let l=$E(i);return this._optionMap.has(l)?this._optionMap.get(l):i}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275dir=Wt({type:c,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(l,h){l&1&&_t("change",function(T){return h.onChange(T.target.value)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Un([UE]),Nr]})}return c})(),Rm=(()=>{class c{_element;_renderer;_select;id;constructor(i,l,h){this._element=i,this._renderer=l,this._select=h,this._select&&(this.id=this._select._registerOption())}set ngValue(i){this._select!=null&&(this._select._optionMap.set(this.id,i),this._setElementValue(g1(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._setElementValue(i),this._select&&this._select.writeValue(this._select.value)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(l){return new(l||c)(Ft(Ci),Ft(su),Ft(Su,9))};static \u0275dir=Wt({type:c,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return c})(),GE={provide:ec,useExisting:$o(()=>_1),multi:!0};function qw(c,a){return c==null?`${a}`:(typeof a=="string"&&(a=`'${a}'`),a&&typeof a=="object"&&(a="Object"),`${c}: ${a}`.slice(0,50))}function HE(c){return c.split(":")[0]}var _1=(()=>{class c extends Tm{value;_optionMap=new Map;_idCounter=0;set compareWith(i){this._compareWith=i}_compareWith=Object.is;writeValue(i){this.value=i;let l;if(Array.isArray(i)){let h=i.map(s=>this._getOptionId(s));l=(s,T)=>{s._setSelected(h.indexOf(T.toString())>-1)}}else l=(h,s)=>{h._setSelected(!1)};this._optionMap.forEach(l)}registerOnChange(i){this.onChange=l=>{let h=[],s=l.selectedOptions;if(s!==void 0){let T=s;for(let Y=0;Y<T.length;Y++){let K=T[Y],Ce=this._getOptionValue(K.value);h.push(Ce)}}else{let T=l.options;for(let Y=0;Y<T.length;Y++){let K=T[Y];if(K.selected){let Ce=this._getOptionValue(K.value);h.push(Ce)}}}this.value=h,i(h)}}_registerOption(i){let l=(this._idCounter++).toString();return this._optionMap.set(l,i),l}_getOptionId(i){for(let l of this._optionMap.keys())if(this._compareWith(this._optionMap.get(l)._value,i))return l;return null}_getOptionValue(i){let l=HE(i);return this._optionMap.has(l)?this._optionMap.get(l)._value:i}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275dir=Wt({type:c,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(l,h){l&1&&_t("change",function(T){return h.onChange(T.target)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Un([GE]),Nr]})}return c})(),Om=(()=>{class c{_element;_renderer;_select;id;_value;constructor(i,l,h){this._element=i,this._renderer=l,this._select=h,this._select&&(this.id=this._select._registerOption(this))}set ngValue(i){this._select!=null&&(this._value=i,this._setElementValue(qw(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._select?(this._value=i,this._setElementValue(qw(this.id,i)),this._select.writeValue(this._select.value)):this._setElementValue(i)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}_setSelected(i){this._renderer.setProperty(this._element.nativeElement,"selected",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(l){return new(l||c)(Ft(Ci),Ft(su),Ft(_1,9))};static \u0275dir=Wt({type:c,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return c})();var y1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({})}return c})(),X0=class extends Cu{constructor(a,i,l){super(J0(i),ey(l,i)),this.controls=a,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(a){return this.controls[this._adjustIndex(a)]}push(a,i={}){this.controls.push(a),this._registerControl(a),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(a,i,l={}){this.controls.splice(a,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:l.emitEvent})}removeAt(a,i={}){let l=this._adjustIndex(a);l<0&&(l=0),this.controls[l]&&this.controls[l]._registerOnCollectionChange(()=>{}),this.controls.splice(l,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(a,i,l={}){let h=this._adjustIndex(a);h<0&&(h=0),this.controls[h]&&this.controls[h]._registerOnCollectionChange(()=>{}),this.controls.splice(h,1),i&&(this.controls.splice(h,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(a,i={}){l1(this,!1,a),a.forEach((l,h)=>{a1(this,!1,h),this.at(h).setValue(l,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(a,i={}){a!=null&&(a.forEach((l,h)=>{this.at(h)&&this.at(h).patchValue(l,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(a=[],i={}){this._forEachChild((l,h)=>{l.reset(a[h],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i,this),this._updateTouched(i,this),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(a=>a.getRawValue())}clear(a={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:a.emitEvent}))}_adjustIndex(a){return a<0?a+this.length:a}_syncPendingControls(){let a=this.controls.reduce((i,l)=>l._syncPendingControls()?!0:i,!1);return a&&this.updateValueAndValidity({onlySelf:!0}),a}_forEachChild(a){this.controls.forEach((i,l)=>{a(i,l)})}_updateValue(){this.value=this.controls.filter(a=>a.enabled||this.disabled).map(a=>a.value)}_anyControls(a){return this.controls.some(i=>i.enabled&&a(i))}_setUpControls(){this._forEachChild(a=>this._registerControl(a))}_allControlsDisabled(){for(let a of this.controls)if(a.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(a){a.setParent(this),a._registerOnCollectionChange(this._onCollectionChange)}_find(a){return this.at(a)??null}};function Ww(c){return!!c&&(c.asyncValidators!==void 0||c.validators!==void 0||c.updateOn!==void 0)}var Fm=(()=>{class c{useNonNullable=!1;get nonNullable(){let i=new c;return i.useNonNullable=!0,i}group(i,l=null){let h=this._reduceControls(i),s={};return Ww(l)?s=l:l!==null&&(s.validators=l.validator,s.asyncValidators=l.asyncValidator),new Mu(h,s)}record(i,l=null){let h=this._reduceControls(i);return new W0(h,l)}control(i,l,h){let s={};return this.useNonNullable?(Ww(l)?s=l:(s.validators=l,s.asyncValidators=h),new Tp(i,si(Ye({},s),{nonNullable:!0}))):new Tp(i,l,h)}array(i,l,h){let s=i.map(T=>this._createControl(T));return new X0(s,l,h)}_reduceControls(i){let l={};return Object.keys(i).forEach(h=>{l[h]=this._createControl(i[h])}),l}_createControl(i){if(i instanceof Tp)return i;if(i instanceof Cu)return i;if(Array.isArray(i)){let l=i[0],h=i.length>1?i[1]:null,s=i.length>2?i[2]:null;return this.control(l,h,s)}else return this.control(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var Tu=(()=>{class c{static withConfig(i){return{ngModule:c,providers:[{provide:Ep,useValue:i.callSetDisabledState??Am}]}}static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[y1]})}return c})(),Lm=(()=>{class c{static withConfig(i){return{ngModule:c,providers:[{provide:m1,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:Ep,useValue:i.callSetDisabledState??Am}]}}static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[y1]})}return c})();var Bm=class c{constructor(a,i){this.http=a;this.router=i}apiUrl="http://flask-fiware.apps.preprodalcaldia.medellin.gov.co/api/keycloak/login";login(a){return this.http.post(this.apiUrl,a).pipe(Ji(i=>{localStorage.setItem("access_token",i.access_token),this.router.navigate(["/inicio"])}))}logout(){localStorage.removeItem("access_token"),this.router.navigate(["/login"])}isLoggedIn(){return!!localStorage.getItem("access_token")}static \u0275fac=function(i){return new(i||c)(zt(ws),zt(no))};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})};function qE(c,a){if(c&1&&(V(0,"p",9),le(1),$()),c&2){let i=Je();_e(),Lt(i.errorMsg)}}var Pp=class c{constructor(a,i){this.fb=a;this.auth=i;this.loginForm=this.fb.group({username:["",Po.required],password:["",Po.required]})}loginForm;errorMsg="";onSubmit(){this.loginForm.valid&&this.auth.login(this.loginForm.value).subscribe({next:()=>{},error:a=>{console.error(a),this.errorMsg="Usuario o contrase\xF1a incorrectos"}})}static \u0275fac=function(i){return new(i||c)(Ft(Fm),Ft(Bm))};static \u0275cmp=rt({type:c,selectors:[["app-login"]],decls:14,vars:2,consts:[[1,"login-wrapper"],[1,"login-card"],[1,"logo"],["src","https://www.fiware.org/custom/brand-guide/img/logo/fiware/primary/jpg/logo-fiware.jpg?","alt","Logo Alcald\xEDa de Medell\xEDn",1,"login-logo"],[3,"ngSubmit","formGroup"],["type","text","formControlName","username","placeholder","Usuario"],["type","password","formControlName","password","placeholder","Contrase\xF1a"],["type","submit"],["class","error",4,"ngIf"],[1,"error"]],template:function(i,l){i&1&&(V(0,"div",0)(1,"div",1)(2,"h1",2),le(3,"Medell\xEDn "),V(4,"span"),le(5,"Inteligente"),$()(),V(6,"div",2),Pe(7,"img",3),$(),V(8,"form",4),_t("ngSubmit",function(){return l.onSubmit()}),Pe(9,"input",5)(10,"input",6),V(11,"button",7),le(12,"Iniciar Sesi\xF3n"),$()(),it(13,qE,2,1,"p",8),$()()),i&2&&(_e(8),Ge("formGroup",l.loginForm),_e(5),Ge("ngIf",l.errorMsg))},dependencies:[$r,Qs,Lm,Dm,tc,ic,Pm,id,Ip,Wl,Kl],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;height:100vh;width:100%;background:linear-gradient(135deg,#ffffffe6,#f5f5f5e6);display:flex;justify-content:center;align-items:center;perspective:1000px}.login-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:90%;max-width:400px;padding:2rem}.login-card[_ngcontent-%COMP%]{background:#ffffffbf;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border-radius:20px;padding:2rem;width:100%;box-shadow:0 15px 30px #0000001a,inset 0 0 60px #ffffff4d;transform-style:preserve-3d;transition:transform .6s cubic-bezier(.4,0,.2,1);border:1.5px solid rgba(200,200,200,.4);animation:_ngcontent-%COMP%_fadeInGlass 1.2s ease forwards}.login-card[_ngcontent-%COMP%]:hover{transform:rotateY(8deg) rotateX(8deg) translateZ(10px);box-shadow:0 25px 40px #00000026,inset 0 0 70px #fff6}.logo[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.login-logo[_ngcontent-%COMP%]{max-width:150px;height:auto;filter:drop-shadow(0 0 6px rgba(0,0,0,.12))}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.8rem;border:none;border-radius:12px;background:#ffffffd9;color:#334155;outline:none;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:inset 0 0 8px #fffc,0 4px 10px #0000000d;transition:background .3s ease,box-shadow .3s ease,color .3s ease}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#64748b}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:#fff;color:#1e293b;box-shadow:0 0 12px 3px #38bdf880,inset 0 0 15px #ffffffe6;transform:translateZ(5px)}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem;border-radius:12px;background:#fff3;border:2px solid rgba(128,128,128,.6);color:#334155;font-weight:700;cursor:pointer;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 6px 10px #0000001f,inset 0 0 15px #ffffff80;transition:transform .3s ease,box-shadow .3s ease,background .3s ease;transform-style:preserve-3d}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#fff6;border-color:#646464e6;box-shadow:0 10px 18px #00000040,inset 0 0 20px #ffffffb3;transform:scale(1.08) translateZ(8px)}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{transform:scale(.97) translateZ(0);box-shadow:0 4px 6px #00000026,inset 0 0 12px #fff6}.error[_ngcontent-%COMP%]{color:#ef4444;text-align:center;margin-top:1rem;animation:_ngcontent-%COMP%_pulseRed 2s infinite}@keyframes _ngcontent-%COMP%_fadeInGlass{0%{opacity:0;transform:translateY(40px) scale(.85) rotateX(10deg)}to{opacity:1;transform:translateY(0) scale(1) rotateX(0)}}@keyframes _ngcontent-%COMP%_glow{0%{text-shadow:0 0 6px #38bdf8,0 0 12px #38bdf8}to{text-shadow:0 0 14px #a78bfa,0 0 28px #a78bfa}}@keyframes _ngcontent-%COMP%_pulseRed{0%,to{opacity:1}50%{opacity:.6}}@media (max-width: 600px){.login-card[_ngcontent-%COMP%]{padding:1.5rem;border-radius:16px}.logo[_ngcontent-%COMP%]{font-size:1.5rem}form[_ngcontent-%COMP%]{gap:.8rem}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.9rem}}']})};var ry;try{ry=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ry=!1}var yr=(()=>{class c{_platformId=me(ja);isBrowser=this._platformId?yx(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||ry)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var kp;function WE(){if(kp==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>kp=!0}))}finally{kp=kp||!1}return kp}function Eu(c){return WE()?c:!!c.capture}var nd;function oy(){if(nd==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return nd=!1,nd;if("scrollBehavior"in document.documentElement.style)nd=!0;else{let c=Element.prototype.scrollTo;c?nd=!/\{\s*\[native code\]\s*\}/.test(c.toString()):nd=!1}}return nd}var ny;function XE(){if(ny==null){let c=typeof document<"u"?document.head:null;ny=!!(c&&(c.createShadowRoot||c.attachShadow))}return ny}function v1(c){if(XE()){let a=c.getRootNode?c.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&a instanceof ShadowRoot)return a}return null}function Wo(c){return c.composedPath?c.composedPath()[0]:c.target}function sy(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var Nm=new WeakMap,Xa=(()=>{class c{_appRef;_injector=me(Tr);_environmentInjector=me(vs);load(i){let l=this._appRef=this._appRef||this._injector.get(Gl),h=Nm.get(l);h||(h={loaders:new Set,refs:[]},Nm.set(l,h),l.onDestroy(()=>{Nm.get(l)?.refs.forEach(s=>s.destroy()),Nm.delete(l)})),h.loaders.has(i)||(h.loaders.add(i),h.refs.push(Bf(i,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),b1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(l,h){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}"],encapsulation:2,changeDetection:0})}return c})();function Ya(c,...a){return a.length?a.some(i=>c[i]):c.altKey||c.shiftKey||c.ctrlKey||c.metaKey}function x1(c){return c!=null&&`${c}`!="false"}function Iu(c){return Array.isArray(c)?c:[c]}function Dn(c){return c==null?"":typeof c=="string"?c:`${c}px`}function Ka(c){return c instanceof Ci?c.nativeElement:c}var YE=(()=>{class c{create(i){return typeof MutationObserver>"u"?null:new MutationObserver(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var w1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({providers:[YE]})}return c})();var C1=new Set,rd,KE=(()=>{class c{_platform=me(yr);_nonce=me(Fh,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):JE}matchMedia(i){return(this._platform.WEBKIT||this._platform.BLINK)&&QE(i,this._nonce),this._matchMedia(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function QE(c,a){if(!C1.has(c))try{rd||(rd=document.createElement("style"),a&&rd.setAttribute("nonce",a),rd.setAttribute("type","text/css"),document.head.appendChild(rd)),rd.sheet&&(rd.sheet.insertRule(`@media ${c} {body{ }}`,0),C1.add(c))}catch(i){console.error(i)}}function JE(c){return{matches:c==="all"||c==="",media:c,addListener:()=>{},removeListener:()=>{}}}var S1=(()=>{class c{_mediaMatcher=me(KE);_zone=me(hi);_queries=new Map;_destroySubject=new Ut;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(i){return M1(Iu(i)).some(h=>this._registerQuery(h).mql.matches)}observe(i){let h=M1(Iu(i)).map(T=>this._registerQuery(T).observable),s=iu(h);return s=Cf(s.pipe(xo(1)),s.pipe(Tf(1),Sf(0))),s.pipe(kt(T=>{let Y={matches:!1,breakpoints:{}};return T.forEach(({matches:K,query:Ce})=>{Y.matches=Y.matches||K,Y.breakpoints[Ce]=K}),Y}))}_registerQuery(i){if(this._queries.has(i))return this._queries.get(i);let l=this._mediaMatcher.matchMedia(i),s={observable:new Na(T=>{let Y=K=>this._zone.run(()=>T.next(K));return l.addListener(Y),()=>{l.removeListener(Y)}}).pipe(Ks(l),kt(({matches:T})=>({query:i,matches:T})),An(this._destroySubject)),mql:l};return this._queries.set(i,s),s}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function M1(c){return c.map(a=>a.split(",")).reduce((a,i)=>a.concat(i)).map(a=>a.trim())}var I1=" ";function P1(c,a,i){let l=k1(c,a);i=i.trim(),!l.some(h=>h.trim()===i)&&(l.push(i),c.setAttribute(a,l.join(I1)))}function hy(c,a,i){let l=k1(c,a);i=i.trim();let h=l.filter(s=>s!==i);h.length?c.setAttribute(a,h.join(I1)):c.removeAttribute(a)}function k1(c,a){return c.getAttribute(a)?.match(/\S+/g)??[]}var pI=200,cy=class{_letterKeyStream=new Ut;_items=[];_selectedItemIndex=-1;_pressedLetters=[];_skipPredicateFn;_selectedItem=new Ut;selectedItem=this._selectedItem;constructor(a,i){let l=typeof i?.debounceInterval=="number"?i.debounceInterval:pI;i?.skipPredicate&&(this._skipPredicateFn=i.skipPredicate),this.setItems(a),this._setupKeyHandler(l)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(a){this._selectedItemIndex=a}setItems(a){this._items=a}handleKey(a){let i=a.keyCode;a.key&&a.key.length===1?this._letterKeyStream.next(a.key.toLocaleUpperCase()):(i>=65&&i<=90||i>=48&&i<=57)&&this._letterKeyStream.next(String.fromCharCode(i))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(a){this._letterKeyStream.pipe(Ji(i=>this._pressedLetters.push(i)),Sf(a),vn(()=>this._pressedLetters.length>0),kt(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(i=>{for(let l=1;l<this._items.length+1;l++){let h=(this._selectedItemIndex+l)%this._items.length,s=this._items[h];if(!this._skipPredicateFn?.(s)&&s.getLabel?.().toLocaleUpperCase().trim().indexOf(i)===0){this._selectedItem.next(s);break}}this._pressedLetters=[]})}},dy=class{_items;_activeItemIndex=-1;_activeItem=$l(null);_wrap=!1;_typeaheadSubscription=Sr.EMPTY;_itemChangesSubscription;_vertical=!0;_horizontal;_allowedModifierKeys=[];_homeAndEnd=!1;_pageUpAndDown={enabled:!1,delta:10};_effectRef;_typeahead;_skipPredicateFn=a=>a.disabled;constructor(a,i){this._items=a,a instanceof B_?this._itemChangesSubscription=a.changes.subscribe(l=>this._itemsChanged(l.toArray())):Bh(a)&&(this._effectRef=cx(()=>this._itemsChanged(a()),{injector:i}))}tabOut=new Ut;change=new Ut;skipPredicate(a){return this._skipPredicateFn=a,this}withWrap(a=!0){return this._wrap=a,this}withVerticalOrientation(a=!0){return this._vertical=a,this}withHorizontalOrientation(a){return this._horizontal=a,this}withAllowedModifierKeys(a){return this._allowedModifierKeys=a,this}withTypeAhead(a=200){this._typeaheadSubscription.unsubscribe();let i=this._getItemsArray();return this._typeahead=new cy(i,{debounceInterval:typeof a=="number"?a:void 0,skipPredicate:l=>this._skipPredicateFn(l)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(l=>{this.setActiveItem(l)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(a=!0){return this._homeAndEnd=a,this}withPageUpDown(a=!0,i=10){return this._pageUpAndDown={enabled:a,delta:i},this}setActiveItem(a){let i=this._activeItem();this.updateActiveItem(a),this._activeItem()!==i&&this.change.next(this._activeItemIndex)}onKeydown(a){let i=a.keyCode,h=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!a[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(i){case 9:this.tabOut.next();return;case 40:if(this._vertical&&h){this.setNextItemActive();break}else return;case 38:if(this._vertical&&h){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&h){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&h){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&h){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&h){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&h){let s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&h){let s=this._activeItemIndex+this._pageUpAndDown.delta,T=this._getItemsArray().length;this._setActiveItemByIndex(s<T?s:T-1,-1);break}else return;default:(h||Ya(a,"shiftKey"))&&this._typeahead?.handleKey(a);return}this._typeahead?.reset(),a.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem()}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(a){let i=this._getItemsArray(),l=typeof a=="number"?a:i.indexOf(a),h=i[l];this._activeItem.set(h??null),this._activeItemIndex=l,this._typeahead?.setCurrentSelectedItemIndex(l)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(a){this._wrap?this._setActiveInWrapMode(a):this._setActiveInDefaultMode(a)}_setActiveInWrapMode(a){let i=this._getItemsArray();for(let l=1;l<=i.length;l++){let h=(this._activeItemIndex+a*l+i.length)%i.length,s=i[h];if(!this._skipPredicateFn(s)){this.setActiveItem(h);return}}}_setActiveInDefaultMode(a){this._setActiveItemByIndex(this._activeItemIndex+a,a)}_setActiveItemByIndex(a,i){let l=this._getItemsArray();if(l[a]){for(;this._skipPredicateFn(l[a]);)if(a+=i,!l[a])return;this.setActiveItem(a)}}_getItemsArray(){return Bh(this._items)?this._items():this._items instanceof B_?this._items.toArray():this._items}_itemsChanged(a){this._typeahead?.setItems(a);let i=this._activeItem();if(i){let l=a.indexOf(i);l>-1&&l!==this._activeItemIndex&&(this._activeItemIndex=l,this._typeahead?.setCurrentSelectedItemIndex(l))}}},Um=class extends dy{setActiveItem(a){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(a),this.activeItem&&this.activeItem.setActiveStyles()}};function py(c){return c.buttons===0||c.detail===0}function fy(c){let a=c.touches&&c.touches[0]||c.changedTouches&&c.changedTouches[0];return!!a&&a.identifier===-1&&(a.radiusX==null||a.radiusX===1)&&(a.radiusY==null||a.radiusY===1)}var fI=new ct("cdk-input-modality-detector-options"),mI={ignoreKeys:[18,17,224,91,16]},A1=650,Pu=Eu({passive:!0,capture:!0}),gI=(()=>{class c{_platform=me(yr);modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new to(null);_options;_lastTouchMs=0;_onKeydown=i=>{this._options?.ignoreKeys?.some(l=>l===i.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Wo(i))};_onMousedown=i=>{Date.now()-this._lastTouchMs<A1||(this._modality.next(py(i)?"keyboard":"mouse"),this._mostRecentTarget=Wo(i))};_onTouchstart=i=>{if(fy(i)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Wo(i)};constructor(){let i=me(hi),l=me(fi),h=me(fI,{optional:!0});this._options=Ye(Ye({},mI),h),this.modalityDetected=this._modality.pipe(Tf(1)),this.modalityChanged=this.modalityDetected.pipe(kh()),this._platform.isBrowser&&i.runOutsideAngular(()=>{l.addEventListener("keydown",this._onKeydown,Pu),l.addEventListener("mousedown",this._onMousedown,Pu),l.addEventListener("touchstart",this._onTouchstart,Pu)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Pu),document.removeEventListener("mousedown",this._onMousedown,Pu),document.removeEventListener("touchstart",this._onTouchstart,Pu))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),_I=new ct("liveAnnouncerElement",{providedIn:"root",factory:yI});function yI(){return null}var vI=new ct("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),bI=0,D1=(()=>{class c{_ngZone=me(hi);_defaultOptions=me(vI,{optional:!0});_liveElement;_document=me(fi);_previousTimeout;_currentPromise;_currentResolve;constructor(){let i=me(_I,{optional:!0});this._liveElement=i||this._createLiveElement()}announce(i,...l){let h=this._defaultOptions,s,T;return l.length===1&&typeof l[0]=="number"?T=l[0]:[s,T]=l,this.clear(),clearTimeout(this._previousTimeout),s||(s=h&&h.politeness?h.politeness:"polite"),T==null&&h&&(T=h.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(Y=>this._currentResolve=Y)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=i,typeof T=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),T)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let i="cdk-live-announcer-element",l=this._document.getElementsByClassName(i),h=this._document.createElement("div");for(let s=0;s<l.length;s++)l[s].remove();return h.classList.add(i),h.classList.add("cdk-visually-hidden"),h.setAttribute("aria-atomic","true"),h.setAttribute("aria-live","polite"),h.id=`cdk-live-announcer-${bI++}`,this._document.body.appendChild(h),h}_exposeAnnouncerToModals(i){let l=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let h=0;h<l.length;h++){let s=l[h],T=s.getAttribute("aria-owns");T?T.indexOf(i)===-1&&s.setAttribute("aria-owns",T+" "+i):s.setAttribute("aria-owns",i)}}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var jm=function(c){return c[c.IMMEDIATE=0]="IMMEDIATE",c[c.EVENTUAL=1]="EVENTUAL",c}(jm||{}),xI=new ct("cdk-focus-monitor-default-options"),Vm=Eu({passive:!0,capture:!0}),R1=(()=>{class c{_ngZone=me(hi);_platform=me(yr);_inputModalityDetector=me(gI);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=me(fi,{optional:!0});_stopInputModalityDetector=new Ut;constructor(){let i=me(xI,{optional:!0});this._detectionMode=i?.detectionMode||jm.IMMEDIATE}_rootNodeFocusAndBlurListener=i=>{let l=Wo(i);for(let h=l;h;h=h.parentElement)i.type==="focus"?this._onFocus(i,h):this._onBlur(i,h)};monitor(i,l=!1){let h=Ka(i);if(!this._platform.isBrowser||h.nodeType!==1)return bt();let s=v1(h)||this._getDocument(),T=this._elementInfo.get(h);if(T)return l&&(T.checkChildren=!0),T.subject;let Y={checkChildren:l,subject:new Ut,rootNode:s};return this._elementInfo.set(h,Y),this._registerGlobalListeners(Y),Y.subject}stopMonitoring(i){let l=Ka(i),h=this._elementInfo.get(l);h&&(h.subject.complete(),this._setClasses(l),this._elementInfo.delete(l),this._removeGlobalListeners(h))}focusVia(i,l,h){let s=Ka(i),T=this._getDocument().activeElement;s===T?this._getClosestElementsInfo(s).forEach(([Y,K])=>this._originChanged(Y,l,K)):(this._setOrigin(l),typeof s.focus=="function"&&s.focus(h))}ngOnDestroy(){this._elementInfo.forEach((i,l)=>this.stopMonitoring(l))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(i){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(i)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:i&&this._isLastInteractionFromInputLabel(i)?"mouse":"program"}_shouldBeAttributedToTouch(i){return this._detectionMode===jm.EVENTUAL||!!i?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(i,l){i.classList.toggle("cdk-focused",!!l),i.classList.toggle("cdk-touch-focused",l==="touch"),i.classList.toggle("cdk-keyboard-focused",l==="keyboard"),i.classList.toggle("cdk-mouse-focused",l==="mouse"),i.classList.toggle("cdk-program-focused",l==="program")}_setOrigin(i,l=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=i,this._originFromTouchInteraction=i==="touch"&&l,this._detectionMode===jm.IMMEDIATE){clearTimeout(this._originTimeoutId);let h=this._originFromTouchInteraction?A1:1;this._originTimeoutId=setTimeout(()=>this._origin=null,h)}})}_onFocus(i,l){let h=this._elementInfo.get(l),s=Wo(i);!h||!h.checkChildren&&l!==s||this._originChanged(l,this._getFocusOrigin(s),h)}_onBlur(i,l){let h=this._elementInfo.get(l);!h||h.checkChildren&&i.relatedTarget instanceof Node&&l.contains(i.relatedTarget)||(this._setClasses(l),this._emitOrigin(h,null))}_emitOrigin(i,l){i.subject.observers.length&&this._ngZone.run(()=>i.subject.next(l))}_registerGlobalListeners(i){if(!this._platform.isBrowser)return;let l=i.rootNode,h=this._rootNodeFocusListenerCount.get(l)||0;h||this._ngZone.runOutsideAngular(()=>{l.addEventListener("focus",this._rootNodeFocusAndBlurListener,Vm),l.addEventListener("blur",this._rootNodeFocusAndBlurListener,Vm)}),this._rootNodeFocusListenerCount.set(l,h+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(An(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(i){let l=i.rootNode;if(this._rootNodeFocusListenerCount.has(l)){let h=this._rootNodeFocusListenerCount.get(l);h>1?this._rootNodeFocusListenerCount.set(l,h-1):(l.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Vm),l.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Vm),this._rootNodeFocusListenerCount.delete(l))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(i,l,h){this._setClasses(i,l),this._emitOrigin(h,l),this._lastFocusOrigin=l}_getClosestElementsInfo(i){let l=[];return this._elementInfo.forEach((h,s)=>{(s===i||h.checkChildren&&s.contains(i))&&l.push([s,h])}),l}_isLastInteractionFromInputLabel(i){let{_mostRecentTarget:l,mostRecentModality:h}=this._inputModalityDetector;if(h!=="mouse"||!l||l===i||i.nodeName!=="INPUT"&&i.nodeName!=="TEXTAREA"||i.disabled)return!1;let s=i.labels;if(s){for(let T=0;T<s.length;T++)if(s[T].contains(l))return!0}return!1}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var od=function(c){return c[c.NONE=0]="NONE",c[c.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",c[c.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",c}(od||{}),T1="cdk-high-contrast-black-on-white",E1="cdk-high-contrast-white-on-black",ay="cdk-high-contrast-active",O1=(()=>{class c{_platform=me(yr);_hasCheckedHighContrastMode;_document=me(fi);_breakpointSubscription;constructor(){this._breakpointSubscription=me(S1).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return od.NONE;let i=this._document.createElement("div");i.style.backgroundColor="rgb(1,2,3)",i.style.position="absolute",this._document.body.appendChild(i);let l=this._document.defaultView||window,h=l&&l.getComputedStyle?l.getComputedStyle(i):null,s=(h&&h.backgroundColor||"").replace(/ /g,"");switch(i.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return od.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return od.BLACK_ON_WHITE}return od.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let i=this._document.body.classList;i.remove(ay,T1,E1),this._hasCheckedHighContrastMode=!0;let l=this.getHighContrastMode();l===od.BLACK_ON_WHITE?i.add(ay,T1):l===od.WHITE_ON_BLACK&&i.add(ay,E1)}}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var ly={},Xo=(()=>{class c{_appId=me(Oh);getId(i){return this._appId!=="ng"&&(i+=this._appId),ly.hasOwnProperty(i)||(ly[i]=0),`${i}${ly[i]++}`}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var wI=new ct("cdk-dir-doc",{providedIn:"root",factory:CI});function CI(){return me(fi)}var MI=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function SI(c){let a=c?.toLowerCase()||"";return a==="auto"&&typeof navigator<"u"&&navigator?.language?MI.test(navigator.language)?"rtl":"ltr":a==="rtl"?"rtl":"ltr"}var ta=(()=>{class c{value="ltr";change=new xi;constructor(){let i=me(wI,{optional:!0});if(i){let l=i.body?i.body.dir:null,h=i.documentElement?i.documentElement.dir:null;this.value=SI(l||h||"ltr")}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var nc=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({})}return c})();var TI=["text"],EI=[[["mat-icon"]],"*"],II=["mat-icon","*"];function PI(c,a){if(c&1&&Pe(0,"mat-pseudo-checkbox",1),c&2){let i=Je();Ge("disabled",i.disabled)("state",i.selected?"checked":"unchecked")}}function kI(c,a){if(c&1&&Pe(0,"mat-pseudo-checkbox",3),c&2){let i=Je();Ge("disabled",i.disabled)}}function AI(c,a){if(c&1&&(V(0,"span",4),le(1),$()),c&2){let i=Je();_e(),ln("(",i.group.label,")")}}var un=(()=>{class c{constructor(){me(O1)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[nc,nc]})}return c})(),Hm=class{_defaultMatcher;ngControl;_parentFormGroup;_parentForm;_stateChanges;errorState=!1;matcher;constructor(a,i,l,h,s){this._defaultMatcher=a,this.ngControl=i,this._parentFormGroup=l,this._parentForm=h,this._stateChanges=s}updateErrorState(){let a=this.errorState,i=this._parentFormGroup||this._parentForm,l=this.matcher||this._defaultMatcher,h=this.ngControl?this.ngControl.control:null,s=l?.isErrorState(h,i)??!1;s!==a&&(this.errorState=s,this._stateChanges.next())}};var V1=(()=>{class c{isErrorState(i,l){return!!(i&&i.invalid&&(i.touched||l&&l.submitted))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Zm=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["structural-styles"]],decls:0,vars:0,template:function(l,h){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}'],encapsulation:2,changeDetection:0})}return c})();var ko=function(c){return c[c.FADING_IN=0]="FADING_IN",c[c.VISIBLE=1]="VISIBLE",c[c.FADING_OUT=2]="FADING_OUT",c[c.HIDDEN=3]="HIDDEN",c}(ko||{}),my=class{_renderer;element;config;_animationForciblyDisabledThroughCss;state=ko.HIDDEN;constructor(a,i,l,h=!1){this._renderer=a,this.element=i,this.config=l,this._animationForciblyDisabledThroughCss=h}fadeOut(){this._renderer.fadeOutRipple(this)}},F1=Eu({passive:!0,capture:!0}),gy=class{_events=new Map;addHandler(a,i,l,h){let s=this._events.get(i);if(s){let T=s.get(l);T?T.add(h):s.set(l,new Set([h]))}else this._events.set(i,new Map([[l,new Set([h])]])),a.runOutsideAngular(()=>{document.addEventListener(i,this._delegateEventHandler,F1)})}removeHandler(a,i,l){let h=this._events.get(a);if(!h)return;let s=h.get(i);s&&(s.delete(l),s.size===0&&h.delete(i),h.size===0&&(this._events.delete(a),document.removeEventListener(a,this._delegateEventHandler,F1)))}_delegateEventHandler=a=>{let i=Wo(a);i&&this._events.get(a.type)?.forEach((l,h)=>{(h===i||h.contains(i))&&l.forEach(s=>s.handleEvent(a))})}},L1={enterDuration:225,exitDuration:150},DI=800,z1=Eu({passive:!0,capture:!0}),B1=["mousedown","touchstart"],N1=["mouseup","mouseleave","touchend","touchcancel"],RI=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(l,h){},styles:[".mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}"],encapsulation:2,changeDetection:0})}return c})(),_y=class c{_target;_ngZone;_platform;_containerElement;_triggerElement;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect;static _eventManager=new gy;constructor(a,i,l,h,s){this._target=a,this._ngZone=i,this._platform=h,h.isBrowser&&(this._containerElement=Ka(l)),s&&s.get(Xa).load(RI)}fadeInRipple(a,i,l={}){let h=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Ye(Ye({},L1),l.animation);l.centered&&(a=h.left+h.width/2,i=h.top+h.height/2);let T=l.radius||OI(a,i,h),Y=a-h.left,K=i-h.top,Ce=s.enterDuration,be=document.createElement("div");be.classList.add("mat-ripple-element"),be.style.left=`${Y-T}px`,be.style.top=`${K-T}px`,be.style.height=`${T*2}px`,be.style.width=`${T*2}px`,l.color!=null&&(be.style.backgroundColor=l.color),be.style.transitionDuration=`${Ce}ms`,this._containerElement.appendChild(be);let G=window.getComputedStyle(be),$e=G.transitionProperty,ft=G.transitionDuration,Ct=$e==="none"||ft==="0s"||ft==="0s, 0s"||h.width===0&&h.height===0,ut=new my(this,be,l,Ct);be.style.transform="scale3d(1, 1, 1)",ut.state=ko.FADING_IN,l.persistent||(this._mostRecentTransientRipple=ut);let lt=null;return!Ct&&(Ce||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let vi=()=>{lt&&(lt.fallbackTimer=null),clearTimeout(Et),this._finishRippleTransition(ut)},bi=()=>this._destroyRipple(ut),Et=setTimeout(bi,Ce+100);be.addEventListener("transitionend",vi),be.addEventListener("transitioncancel",bi),lt={onTransitionEnd:vi,onTransitionCancel:bi,fallbackTimer:Et}}),this._activeRipples.set(ut,lt),(Ct||!Ce)&&this._finishRippleTransition(ut),ut}fadeOutRipple(a){if(a.state===ko.FADING_OUT||a.state===ko.HIDDEN)return;let i=a.element,l=Ye(Ye({},L1),a.config.animation);i.style.transitionDuration=`${l.exitDuration}ms`,i.style.opacity="0",a.state=ko.FADING_OUT,(a._animationForciblyDisabledThroughCss||!l.exitDuration)&&this._finishRippleTransition(a)}fadeOutAll(){this._getActiveRipples().forEach(a=>a.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(a=>{a.config.persistent||a.fadeOut()})}setupTriggerEvents(a){let i=Ka(a);!this._platform.isBrowser||!i||i===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=i,B1.forEach(l=>{c._eventManager.addHandler(this._ngZone,l,i,this)}))}handleEvent(a){a.type==="mousedown"?this._onMousedown(a):a.type==="touchstart"?this._onTouchStart(a):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{N1.forEach(i=>{this._triggerElement.addEventListener(i,this,z1)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(a){a.state===ko.FADING_IN?this._startFadeOutTransition(a):a.state===ko.FADING_OUT&&this._destroyRipple(a)}_startFadeOutTransition(a){let i=a===this._mostRecentTransientRipple,{persistent:l}=a.config;a.state=ko.VISIBLE,!l&&(!i||!this._isPointerDown)&&a.fadeOut()}_destroyRipple(a){let i=this._activeRipples.get(a)??null;this._activeRipples.delete(a),this._activeRipples.size||(this._containerRect=null),a===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),a.state=ko.HIDDEN,i!==null&&(a.element.removeEventListener("transitionend",i.onTransitionEnd),a.element.removeEventListener("transitioncancel",i.onTransitionCancel),i.fallbackTimer!==null&&clearTimeout(i.fallbackTimer)),a.element.remove()}_onMousedown(a){let i=py(a),l=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+DI;!this._target.rippleDisabled&&!i&&!l&&(this._isPointerDown=!0,this.fadeInRipple(a.clientX,a.clientY,this._target.rippleConfig))}_onTouchStart(a){if(!this._target.rippleDisabled&&!fy(a)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let i=a.changedTouches;if(i)for(let l=0;l<i.length;l++)this.fadeInRipple(i[l].clientX,i[l].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(a=>{let i=a.state===ko.VISIBLE||a.config.terminateOnPointerUp&&a.state===ko.FADING_IN;!a.config.persistent&&i&&a.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let a=this._triggerElement;a&&(B1.forEach(i=>c._eventManager.removeHandler(i,a,this)),this._pointerUpEventsRegistered&&(N1.forEach(i=>a.removeEventListener(i,this,z1)),this._pointerUpEventsRegistered=!1))}};function OI(c,a,i){let l=Math.max(Math.abs(c-i.left),Math.abs(c-i.right)),h=Math.max(Math.abs(a-i.top),Math.abs(a-i.bottom));return Math.sqrt(l*l+h*h)}var j1=new ct("mat-ripple-global-options"),qm=(()=>{class c{_elementRef=me(Ci);_animationMode=me(wo,{optional:!0});color;unbounded;centered;radius=0;animation;get disabled(){return this._disabled}set disabled(i){i&&this.fadeOutAllNonPersistent(),this._disabled=i,this._setupTriggerEventsIfEnabled()}_disabled=!1;get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(i){this._trigger=i,this._setupTriggerEventsIfEnabled()}_trigger;_rippleRenderer;_globalOptions;_isInitialized=!1;constructor(){let i=me(hi),l=me(yr),h=me(j1,{optional:!0}),s=me(Tr);this._globalOptions=h||{},this._rippleRenderer=new _y(this,i,this._elementRef,l,s)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Ye(Ye(Ye({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(i,l=0,h){return typeof i=="number"?this._rippleRenderer.fadeInRipple(i,l,Ye(Ye({},this.rippleConfig),h)):this._rippleRenderer.fadeInRipple(0,0,Ye(Ye({},this.rippleConfig),i))}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(l,h){l&2&&wi("mat-ripple-unbounded",h.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return c})(),Fp=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un,un]})}return c})(),vy=(()=>{class c{_animationMode=me(wo,{optional:!0});state="unchecked";disabled=!1;appearance="full";constructor(){}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(l,h){l&2&&wi("mat-pseudo-checkbox-indeterminate",h.state==="indeterminate")("mat-pseudo-checkbox-checked",h.state==="checked")("mat-pseudo-checkbox-disabled",h.disabled)("mat-pseudo-checkbox-minimal",h.appearance==="minimal")("mat-pseudo-checkbox-full",h.appearance==="full")("_mat-animation-noopable",h._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(l,h){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-primary))}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color, var(--mat-sys-on-surface-variant));border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color, var(--mat-sys-primary));border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-on-primary))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color, var(--mat-sys-surface))}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}return c})(),FI=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un]})}return c})(),by=new ct("MAT_OPTION_PARENT_COMPONENT"),xy=new ct("MatOptgroup");var yy=class{source;isUserInput;constructor(a,i=!1){this.source=a,this.isUserInput=i}},Wm=(()=>{class c{_element=me(Ci);_changeDetectorRef=me(Ur);_parent=me(by,{optional:!0});group=me(xy,{optional:!0});_signalDisableRipple=!1;_selected=!1;_active=!1;_disabled=!1;_mostRecentViewValue="";get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}value;id=me(Xo).getId("mat-option-");get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(i){this._disabled=i}get disableRipple(){return this._signalDisableRipple?this._parent.disableRipple():!!this._parent?.disableRipple}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}onSelectionChange=new xi;_text;_stateChanges=new Ut;constructor(){me(Xa).load(Zm),me(Xa).load(b1),this._signalDisableRipple=!!this._parent&&Bh(this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(i=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}deselect(i=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}focus(i,l){let h=this._getHostElement();typeof h.focus=="function"&&h.focus(l)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(i){(i.keyCode===13||i.keyCode===32)&&!Ya(i)&&(this._selectViaInteraction(),i.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let i=this.viewValue;i!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=i)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(i=!1){this.onSelectionChange.emit(new yy(this,i))}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-option"]],viewQuery:function(l,h){if(l&1&&an(TI,7),l&2){let s;_i(s=yi())&&(h._text=s.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(l,h){l&1&&_t("click",function(){return h._selectViaInteraction()})("keydown",function(T){return h._handleKeydown(T)}),l&2&&(Ff("id",h.id),en("aria-selected",h.selected)("aria-disabled",h.disabled.toString()),wi("mdc-list-item--selected",h.selected)("mat-mdc-option-multiple",h.multiple)("mat-mdc-option-active",h.active)("mdc-list-item--disabled",h.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",pi]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],features:[or],ngContentSelectors:II,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(l,h){l&1&&(Er(EI),it(0,PI,1,2,"mat-pseudo-checkbox",1),zi(1),V(2,"span",2,0),zi(4,1),$(),it(5,kI,1,1,"mat-pseudo-checkbox",3)(6,AI,2,1,"span",4),Pe(7,"div",5)),l&2&&(sn(h.multiple?0:-1),_e(5),sn(!h.multiple&&h.selected&&!h.hideSingleSelectionIndicator?5:-1),_e(),sn(h.group&&h.group._inert?6:-1),_e(),Ge("matRippleTrigger",h._getHostElement())("matRippleDisabled",h.disabled||h.disableRipple))},dependencies:[vy,qm],styles:['.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color, var(--mat-sys-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}@media(forced-colors: active){.mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{right:auto;left:16px}}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return c})();function U1(c,a,i){if(i.length){let l=a.toArray(),h=i.toArray(),s=0;for(let T=0;T<c+1;T++)l[T].group&&l[T].group===h[s]&&s++;return s}return 0}function $1(c,a,i,l){return c<i?c:c+a>i+l?Math.max(0,c-l+a):i}var wy=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[Fp,un,FI]})}return c})();var zI=["*"],Xm;function BI(){if(Xm===void 0&&(Xm=null,typeof window<"u")){let c=window;c.trustedTypes!==void 0&&(Xm=c.trustedTypes.createPolicy("angular#components",{createHTML:a=>a}))}return Xm}function Lp(c){return BI()?.createHTML(c)||c}function G1(c){return Error(`Unable to find icon with the name "${c}"`)}function NI(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function H1(c){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${c}".`)}function Z1(c){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${c}".`)}var Qa=class{url;svgText;options;svgElement;constructor(a,i,l){this.url=a,this.svgText=i,this.options=l}},VI=(()=>{class c{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(i,l,h,s){this._httpClient=i,this._sanitizer=l,this._errorHandler=s,this._document=h}addSvgIcon(i,l,h){return this.addSvgIconInNamespace("",i,l,h)}addSvgIconLiteral(i,l,h){return this.addSvgIconLiteralInNamespace("",i,l,h)}addSvgIconInNamespace(i,l,h,s){return this._addSvgIconConfig(i,l,new Qa(h,null,s))}addSvgIconResolver(i){return this._resolvers.push(i),this}addSvgIconLiteralInNamespace(i,l,h,s){let T=this._sanitizer.sanitize(Co.HTML,h);if(!T)throw Z1(h);let Y=Lp(T);return this._addSvgIconConfig(i,l,new Qa("",Y,s))}addSvgIconSet(i,l){return this.addSvgIconSetInNamespace("",i,l)}addSvgIconSetLiteral(i,l){return this.addSvgIconSetLiteralInNamespace("",i,l)}addSvgIconSetInNamespace(i,l,h){return this._addSvgIconSetConfig(i,new Qa(l,null,h))}addSvgIconSetLiteralInNamespace(i,l,h){let s=this._sanitizer.sanitize(Co.HTML,l);if(!s)throw Z1(l);let T=Lp(s);return this._addSvgIconSetConfig(i,new Qa("",T,h))}registerFontClassAlias(i,l=i){return this._fontCssClassesByAlias.set(i,l),this}classNameForFontAlias(i){return this._fontCssClassesByAlias.get(i)||i}setDefaultFontSetClass(...i){return this._defaultFontSetClass=i,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(i){let l=this._sanitizer.sanitize(Co.RESOURCE_URL,i);if(!l)throw H1(i);let h=this._cachedIconsByUrl.get(l);return h?bt(Ym(h)):this._loadSvgIconFromConfig(new Qa(i,null)).pipe(Ji(s=>this._cachedIconsByUrl.set(l,s)),kt(s=>Ym(s)))}getNamedSvgIcon(i,l=""){let h=q1(l,i),s=this._svgIconConfigs.get(h);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(l,i),s)return this._svgIconConfigs.set(h,s),this._getSvgFromConfig(s);let T=this._iconSetConfigs.get(l);return T?this._getSvgFromIconSetConfigs(i,T):Gc(G1(h))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(i){return i.svgText?bt(Ym(this._svgElementFromConfig(i))):this._loadSvgIconFromConfig(i).pipe(kt(l=>Ym(l)))}_getSvgFromIconSetConfigs(i,l){let h=this._extractIconWithNameFromAnySet(i,l);if(h)return bt(h);let s=l.filter(T=>!T.svgText).map(T=>this._loadSvgIconSetFromConfig(T).pipe(Vl(Y=>{let Ce=`Loading icon set URL: ${this._sanitizer.sanitize(Co.RESOURCE_URL,T.url)} failed: ${Y.message}`;return this._errorHandler.handleError(new Error(Ce)),bt(null)})));return Mf(s).pipe(kt(()=>{let T=this._extractIconWithNameFromAnySet(i,l);if(!T)throw G1(i);return T}))}_extractIconWithNameFromAnySet(i,l){for(let h=l.length-1;h>=0;h--){let s=l[h];if(s.svgText&&s.svgText.toString().indexOf(i)>-1){let T=this._svgElementFromConfig(s),Y=this._extractSvgIconFromSet(T,i,s.options);if(Y)return Y}}return null}_loadSvgIconFromConfig(i){return this._fetchIcon(i).pipe(Ji(l=>i.svgText=l),kt(()=>this._svgElementFromConfig(i)))}_loadSvgIconSetFromConfig(i){return i.svgText?bt(null):this._fetchIcon(i).pipe(Ji(l=>i.svgText=l))}_extractSvgIconFromSet(i,l,h){let s=i.querySelector(`[id="${l}"]`);if(!s)return null;let T=s.cloneNode(!0);if(T.removeAttribute("id"),T.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(T,h);if(T.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(T),h);let Y=this._svgElementFromString(Lp("<svg></svg>"));return Y.appendChild(T),this._setSvgAttributes(Y,h)}_svgElementFromString(i){let l=this._document.createElement("DIV");l.innerHTML=i;let h=l.querySelector("svg");if(!h)throw Error("<svg> tag not found");return h}_toSvgElement(i){let l=this._svgElementFromString(Lp("<svg></svg>")),h=i.attributes;for(let s=0;s<h.length;s++){let{name:T,value:Y}=h[s];T!=="id"&&l.setAttribute(T,Y)}for(let s=0;s<i.childNodes.length;s++)i.childNodes[s].nodeType===this._document.ELEMENT_NODE&&l.appendChild(i.childNodes[s].cloneNode(!0));return l}_setSvgAttributes(i,l){return i.setAttribute("fit",""),i.setAttribute("height","100%"),i.setAttribute("width","100%"),i.setAttribute("preserveAspectRatio","xMidYMid meet"),i.setAttribute("focusable","false"),l&&l.viewBox&&i.setAttribute("viewBox",l.viewBox),i}_fetchIcon(i){let{url:l,options:h}=i,s=h?.withCredentials??!1;if(!this._httpClient)throw NI();if(l==null)throw Error(`Cannot fetch icon from URL "${l}".`);let T=this._sanitizer.sanitize(Co.RESOURCE_URL,l);if(!T)throw H1(l);let Y=this._inProgressUrlFetches.get(T);if(Y)return Y;let K=this._httpClient.get(T,{responseType:"text",withCredentials:s}).pipe(kt(Ce=>Lp(Ce)),Va(()=>this._inProgressUrlFetches.delete(T)),Vb());return this._inProgressUrlFetches.set(T,K),K}_addSvgIconConfig(i,l,h){return this._svgIconConfigs.set(q1(i,l),h),this}_addSvgIconSetConfig(i,l){let h=this._iconSetConfigs.get(i);return h?h.push(l):this._iconSetConfigs.set(i,[l]),this}_svgElementFromConfig(i){if(!i.svgElement){let l=this._svgElementFromString(i.svgText);this._setSvgAttributes(l,i.options),i.svgElement=l}return i.svgElement}_getIconConfigFromResolvers(i,l){for(let h=0;h<this._resolvers.length;h++){let s=this._resolvers[h](l,i);if(s)return jI(s)?new Qa(s.url,null,s.options):new Qa(s,null)}}static \u0275fac=function(l){return new(l||c)(zt(ws,8),zt(l0),zt(fi,8),zt(qc))};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function Ym(c){return c.cloneNode(!0)}function q1(c,a){return c+":"+a}function jI(c){return!!(c.url&&c.options)}var UI=new ct("MAT_ICON_DEFAULT_OPTIONS"),$I=new ct("mat-icon-location",{providedIn:"root",factory:GI});function GI(){let c=me(fi),a=c?c.location:null;return{getPathname:()=>a?a.pathname+a.search:""}}var W1=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],HI=W1.map(c=>`[${c}]`).join(", "),ZI=/^url\(['"]?#(.*?)['"]?\)$/,rc=(()=>{class c{_elementRef=me(Ci);_iconRegistry=me(VI);_location=me($I);_errorHandler=me(qc);_defaultColor;get color(){return this._color||this._defaultColor}set color(i){this._color=i}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(i){i!==this._svgIcon&&(i?this._updateSvgIcon(i):this._svgIcon&&this._clearSvgElement(),this._svgIcon=i)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(i){let l=this._cleanupFontValue(i);l!==this._fontSet&&(this._fontSet=l,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(i){let l=this._cleanupFontValue(i);l!==this._fontIcon&&(this._fontIcon=l,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Sr.EMPTY;constructor(){let i=me(new Zc("aria-hidden"),{optional:!0}),l=me(UI,{optional:!0});l&&(l.color&&(this.color=this._defaultColor=l.color),l.fontSet&&(this.fontSet=l.fontSet)),i||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(i){if(!i)return["",""];let l=i.split(":");switch(l.length){case 1:return["",l[0]];case 2:return l;default:throw Error(`Invalid icon name: "${i}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let i=this._elementsWithExternalReferences;if(i&&i.size){let l=this._location.getPathname();l!==this._previousPath&&(this._previousPath=l,this._prependPathToReferences(l))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(i){this._clearSvgElement();let l=this._location.getPathname();this._previousPath=l,this._cacheChildrenWithExternalReferences(i),this._prependPathToReferences(l),this._elementRef.nativeElement.appendChild(i)}_clearSvgElement(){let i=this._elementRef.nativeElement,l=i.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();l--;){let h=i.childNodes[l];(h.nodeType!==1||h.nodeName.toLowerCase()==="svg")&&h.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let i=this._elementRef.nativeElement,l=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(h=>h.length>0);this._previousFontSetClass.forEach(h=>i.classList.remove(h)),l.forEach(h=>i.classList.add(h)),this._previousFontSetClass=l,this.fontIcon!==this._previousFontIconClass&&!l.includes("mat-ligature-font")&&(this._previousFontIconClass&&i.classList.remove(this._previousFontIconClass),this.fontIcon&&i.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(i){return typeof i=="string"?i.trim().split(" ")[0]:i}_prependPathToReferences(i){let l=this._elementsWithExternalReferences;l&&l.forEach((h,s)=>{h.forEach(T=>{s.setAttribute(T.name,`url('${i}#${T.value}')`)})})}_cacheChildrenWithExternalReferences(i){let l=i.querySelectorAll(HI),h=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<l.length;s++)W1.forEach(T=>{let Y=l[s],K=Y.getAttribute(T),Ce=K?K.match(ZI):null;if(Ce){let be=h.get(Y);be||(be=[],h.set(Y,be)),be.push({name:T,value:Ce[1]})}})}_updateSvgIcon(i){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),i){let[l,h]=this._splitIconName(i);l&&(this._svgNamespace=l),h&&(this._svgName=h),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(h,l).pipe(xo(1)).subscribe(s=>this._setSvgElement(s),s=>{let T=`Error retrieving icon ${l}:${h}! ${s.message}`;this._errorHandler.handleError(new Error(T))})}}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(l,h){l&2&&(en("data-mat-icon-type",h._usingFontIcon()?"font":"svg")("data-mat-icon-name",h._svgName||h.fontIcon)("data-mat-icon-namespace",h._svgNamespace||h.fontSet)("fontIcon",h._usingFontIcon()?h.fontIcon:null),Nh(h.color?"mat-"+h.color:""),wi("mat-icon-inline",h.inline)("mat-icon-no-color",h.color!=="primary"&&h.color!=="accent"&&h.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",pi],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[or],ngContentSelectors:zI,decls:1,vars:0,template:function(l,h){l&1&&(Er(),zi(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return c})(),oc=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un,un]})}return c})();function qI(c,a){if(c&1&&(V(0,"mat-icon"),le(1),$()),c&2){let i=Je().$implicit,l=Je();_e(),Lt(l.isAbierto(i)?"expand_less":"expand_more")}}function WI(c,a){if(c&1&&(V(0,"mat-icon"),le(1),$()),c&2){let i=Je().$implicit,l=Je(3);_e(),Lt(l.isAbierto(i)?"expand_less":"expand_more")}}function XI(c,a){if(c&1){let i=Li();V(0,"li")(1,"a",9),_t("click",function(){let h=$t(i).$implicit,s=Je(5);return Gt(s.navegar(h.ruta))}),V(2,"mat-icon"),le(3),$(),V(4,"span"),le(5),$()()()}if(c&2){let i=a.$implicit;_e(3),Lt(i.icono),_e(2),Lt(i.texto)}}function YI(c,a){if(c&1&&(V(0,"ul",8),it(1,XI,6,2,"li",4),$()),c&2){let i=Je().$implicit;_e(),Ge("ngForOf",i.hijos)}}function KI(c,a){if(c&1){let i=Li();U_(0),V(1,"li")(2,"a",5),_t("click",function(){let h=$t(i).$implicit,s=Je(3);return Gt(h.hijos?s.toggle(h):s.navegar(h.ruta))}),V(3,"mat-icon"),le(4),$(),V(5,"span"),le(6),$(),it(7,WI,2,1,"mat-icon",6),$(),it(8,YI,2,1,"ul",7),$(),$_()}if(c&2){let i=a.$implicit,l=Je(3);_e(4),Lt(i.icono),_e(2),Lt(i.texto),_e(),Ge("ngIf",i.hijos),_e(),Ge("ngIf",i.hijos&&l.isAbierto(i))}}function QI(c,a){if(c&1&&(V(0,"ul",8),it(1,KI,9,4,"ng-container",4),$()),c&2){let i=Je().$implicit;_e(),Ge("ngForOf",i.hijos)}}function JI(c,a){if(c&1){let i=Li();U_(0),V(1,"li")(2,"a",5),_t("click",function(){let h=$t(i).$implicit,s=Je();return Gt(h.hijos?s.toggle(h):s.navegar(h.ruta))}),V(3,"mat-icon"),le(4),$(),V(5,"span"),le(6),$(),it(7,qI,2,1,"mat-icon",6),$(),it(8,QI,2,1,"ul",7),$(),$_()}if(c&2){let i=a.$implicit,l=Je();_e(4),Lt(i.icono),_e(2),Lt(i.texto),_e(),Ge("ngIf",i.hijos),_e(),Ge("ngIf",i.hijos&&l.isAbierto(i))}}var ku=class c{constructor(a){this.router=a}menu=[{icono:"eco",texto:"Ambiente",hijos:[{icono:"recycling",texto:"Gesti\xF3n de Recursos",ruta:"/ambiente/recursos"},{icono:"cloud",texto:"Calidad Ambiental",hijos:[{icono:"dashboard",texto:"Tablero de Control Sensores Ruido",ruta:"/ambiente/calidad/ruido/dashboard"},{icono:"map",texto:"Mapa Sensores Ruido",ruta:"/ambiente/calidad/ruido/mapa"},{icono:"dashboard_customize",texto:"Tablero de Control SIATA",ruta:"/ambiente/calidad/siata/dashboard"},{icono:"map",texto:"Mapa SIATA",ruta:"/ambiente/calidad/siata/mapa"}]},{icono:"warning",texto:"Gesti\xF3n del Riesgo",ruta:"/ambiente/riesgo"},{icono:"delete",texto:"Gesti\xF3n de Residuos",hijos:[{icono:"dashboard",texto:"Tablero de Control Camiones EMVARIAS",ruta:"/ambiente/residuos/camiones/dashboard"},{icono:"map",texto:"Mapa Camiones EMVARIAS",ruta:"/ambiente/residuos/camiones/mapa"}]},{icono:"public",texto:"Cambio Clim\xE1tico",ruta:"/ambiente/cambioclimatico"}]},{icono:"home_work",texto:"H\xE1bitat",hijos:[{icono:"domain",texto:"Infraestructura",ruta:"/habitat/infraestructura"},{icono:"commute",texto:"Movilidad Inteligente",hijos:[{icono:"dashboard",texto:"Tablero de Control Movilidad",ruta:"/habitat/movilidad/dashboard"},{icono:"map",texto:"Mapa Movilidad",ruta:"/habitat/movilidad/mapa"},{icono:"dashboard_customize",texto:"Tablero de Control VamosMED",ruta:"/habitat/movilidad/vamosmed/dashboard"},{icono:"map",texto:"Mapa VamosMED",ruta:"/habitat/movilidad/vamosmed/mapa"}]},{icono:"build",texto:"Servicios P\xFAblicos",ruta:"/habitat/servicios-publicos"}]},{icono:"trending_up",texto:"Desarrollo Econ\xF3mico",hijos:[{icono:"lightbulb",texto:"Emprendimiento e Innovaci\xF3n",ruta:"/economico/emprendimiento"},{icono:"school",texto:"Econom\xEDa del conocimiento",ruta:"/economico/conocimiento"},{icono:"business",texto:"Entorno Productivo y Competitivo",ruta:"/economico/entorno"},{icono:"engineering",texto:"Empleo",ruta:"/economico/empleo"},{icono:"wifi",texto:"Transformaci\xF3n Digital",hijos:[{icono:"dashboard",texto:"Tablero de Control Puntos WiFi",ruta:"/economico/digital/wifi/dashboard"},{icono:"map",texto:"Mapa Puntos WiFi",ruta:"/economico/digital/wifi/mapa"}]},{icono:"recycle",texto:"Econom\xEDa Circular",ruta:"/economico/circular"},{icono:"agriculture",texto:"Agricultura",ruta:"/economico/agricultura"}]},{icono:"groups",texto:"Ciudadan\xEDa",hijos:[{icono:"school",texto:"Educaci\xF3n",ruta:"/ciudadania/educacion"},{icono:"diversity_1",texto:"Equidad",ruta:"/ciudadania/equidad"},{icono:"accessible",texto:"Sociedad Incluyente",ruta:"/ciudadania/incluyente"},{icono:"emoji_people",texto:"Cultura Ciudadana",ruta:"/ciudadania/cultura"},{icono:"diversity_3",texto:"Cohesi\xF3n social",ruta:"/ciudadania/cohesion"}]},{icono:"health_and_safety",texto:"Calidad de Vida",hijos:[{icono:"sentiment_satisfied",texto:"Bienestar",ruta:"/calidad/bienestar"},{icono:"security",texto:"Seguridad",ruta:"/calidad/seguridad"},{icono:"healing",texto:"Salud",ruta:"/calidad/salud"},{icono:"map",texto:"Ocio y Turismo",hijos:[{icono:"dashboard",texto:"Tablero de Control Turismo",ruta:"/calidad/turismo/dashboard"},{icono:"map",texto:"Mapa Turismo",ruta:"/calidad/turismo/mapa"}]}]},{icono:"gavel",texto:"Gobernanza",hijos:[{icono:"how_to_vote",texto:"Participaci\xF3n Ciudadana",hijos:[{icono:"dashboard",texto:"Tablero de Control ReportesMED",ruta:"/gobernanza/participacion/reportesmed/dashboard"},{icono:"map",texto:"Mapa Reportes MED",ruta:"/gobernanza/participacion/reportesmed/mapa"},{icono:"dashboard_customize",texto:"Tablero de Control PQRS",ruta:"/gobernanza/participacion/pqrs/dashboard"},{icono:"map",texto:"Mapa PQRS",ruta:"/gobernanza/participacion/pqrs/mapa"}]},{icono:"account_balance",texto:"Gobernanza",ruta:"/gobernanza/gobernanza"},{icono:"public",texto:"Colaboraci\xF3n entre Ciudades y Territorios",ruta:"/gobernanza/colaboracion"},{icono:"computer",texto:"Gobierno Digital",ruta:"/gobernanza/digital"}]}];nivelesAbiertos={};navegar(a){a&&this.router.navigateByUrl(a)}toggle(a){let i=a.texto;this.nivelesAbiertos[i]=!this.nivelesAbiertos[i]}isAbierto(a){return this.nivelesAbiertos[a.texto]}static \u0275fac=function(i){return new(i||c)(Ft(no))};static \u0275cmp=rt({type:c,selectors:[["app-menu-opciones"]],decls:5,vars:1,consts:[[1,"menu-container"],["src","https://i.ibb.co/Ksh0J2w/alcaldia-Medellin.png","alt","Logo Alcald\xEDa de Medell\xEDn",1,"menu-logo"],["src","https://www.fiware.org/custom/brand-guide/img/logo/fiware/primary/png/logo-fiware-blue.png?","alt","Logo FIWARE",1,"menu-logon"],[1,"menu-list"],[4,"ngFor","ngForOf"],[1,"menu-item","submenu-toggle",3,"click"],[4,"ngIf"],["class","submenu",4,"ngIf"],[1,"submenu"],[1,"menu-item",3,"click"]],template:function(i,l){i&1&&(V(0,"div",0),Pe(1,"img",1)(2,"img",2),V(3,"ul",3),it(4,JI,9,4,"ng-container",4),$()()),i&2&&(_e(4),Ge("ngForOf",l.menu))},dependencies:[$r,Hl,Qs,oc,rc],styles:['@charset "UTF-8";.menu-container[_ngcontent-%COMP%]{position:fixed;top:0;left:-20px;width:260px;height:100vh;background:linear-gradient(145deg,#fffc,#f0f0f099);-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);padding:20px;box-shadow:4px 0 20px #0006,inset -4px 0 15px #ffffff4d;border-right:1px solid rgba(255,255,255,.25);overflow-y:auto;z-index:1000;transition:transform .3s ease-in-out}.menu-logon[_ngcontent-%COMP%]{display:block;max-width:120px;height:auto;margin:0 auto 10px;border-radius:15px;box-shadow:0 4px 10px #0003,inset 0 2px 6px #fff6;transition:transform .3s ease,box-shadow .4s ease,filter .4s ease}.menu-logo[_ngcontent-%COMP%]{display:block;max-width:103%;margin:0 auto 20px;background-color:#fff;transition:transform .3s ease,box-shadow .4s ease,filter .4s ease}.menu-list[_ngcontent-%COMP%], .submenu[_ngcontent-%COMP%]{list-style-type:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;text-decoration:none;color:#000;background:linear-gradient(145deg,#fffc,#e6e6e699);border:1px solid rgba(200,200,200,.4);border-radius:16px;padding:10px 18px;margin-bottom:10px;margin-left:-8px;box-shadow:0 8px 15px #0000004d,inset 0 3px 6px #fff6;transition:all .3s ease-in-out;transform:perspective(500px) rotateY(0)}.menu-item[_ngcontent-%COMP%]:hover{background:linear-gradient(145deg,#ffffffe6,#e6e6e6cc);transform:translateY(-5px) scale(1.08) rotateY(10deg);box-shadow:0 10px 20px #0006,inset 0 4px 10px #ffffff80;filter:brightness(1.1)}mat-icon[_ngcontent-%COMP%]{margin-right:15px;font-size:24px;color:#333;text-shadow:1px 1px 5px rgba(0,0,0,.3),0 0 10px rgba(0,255,255,.8);transition:color .3s ease,transform .3s ease,text-shadow .4s ease}.menu-item[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{color:#000;transform:scale(1.3);text-shadow:0 0 15px rgba(0,255,255,.8),0 0 25px rgba(0,255,255,.6),0 0 30px rgba(0,255,255,.5)}']})};var Qm=class c{constructor(a){this.router=a}irAPerfil(){this.router.navigate(["perfil/usuarios"])}static \u0275fac=function(i){return new(i||c)(Ft(no))};static \u0275cmp=rt({type:c,selectors:[["app-header"]],decls:14,vars:0,consts:[[1,"header"],[1,"header-container"],[1,"logo"],["src","https://www.fiware.org/custom/brand-guide/img/logo/fiware/primary/jpg/logo-fiware.jpg?","alt","Logo Alcald\xEDa de Medell\xEDn",1,"menu-logo",2,"background-color","rgb(250, 250, 250)"],[1,"user-info"],[1,"profile-dropdown"],[1,"profile-button"],[1,"profile-icon"],[1,"dropdown-menu"],[3,"click"],["href","#"]],template:function(i,l){i&1&&(V(0,"header",0)(1,"div",1)(2,"div",2),Pe(3,"img",3),$(),V(4,"div",4)(5,"div",5)(6,"button",6)(7,"mat-icon",7),le(8,"account_circle"),$()(),V(9,"div",8)(10,"a",9),_t("click",function(){return l.irAPerfil()}),le(11,"Perfil"),$(),V(12,"a",10),le(13,"Cerrar sesi\xF3n"),$()()()()()())},dependencies:[Kl,oc,rc],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{margin:0;font-family:Arial,sans-serif;background-color:#f8f9fa}.menu-logo[_ngcontent-%COMP%]{display:block;max-width:120px;height:auto;margin:0 auto 10px;transition:transform .3s ease,box-shadow .4s ease,filter .4s ease}.header[_ngcontent-%COMP%]{background:#fff;width:calc(100% - 390px);max-width:none;height:75px;padding:12px 25px;display:flex;justify-content:space-between;align-items:center;color:#333;border-radius:18px;box-shadow:0 4px 12px #0003;margin-left:330px;margin-top:20px;position:relative;z-index:1000;opacity:0;transform:translateY(-15px);animation:_ngcontent-%COMP%_fadeIn .4s ease-out forwards}.main[_ngcontent-%COMP%]{margin-top:120px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.header[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 8px 20px #0000004d}.header-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;align-items:center}.logo[_ngcontent-%COMP%]{font-size:26px;font-weight:700;color:#5d4037}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.profile-dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block}.profile-button[_ngcontent-%COMP%]{background:none;border:none;color:#5d4037;font-size:16px;display:flex;align-items:center;cursor:pointer;transition:transform .2s ease-in-out}.profile-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.profile-icon[_ngcontent-%COMP%]{font-size:40px;transition:color .3s ease}.profile-button[_ngcontent-%COMP%]:hover   .profile-icon[_ngcontent-%COMP%]{color:#4a90e2}.dropdown-menu[_ngcontent-%COMP%]{display:none;position:absolute;right:0;background:#fff;box-shadow:0 5px 15px #00000026;border-radius:10px;overflow:hidden;min-width:160px;opacity:0;transform:translateY(10px);transition:all .3s ease-in-out}.profile-dropdown[_ngcontent-%COMP%]:hover   .dropdown-menu[_ngcontent-%COMP%]{display:block;opacity:1;transform:translateY(0)}.dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:12px;color:#333;text-decoration:none;font-weight:500;transition:background .3s ease}.dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#f0f0f0}']})};var Jm=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-layout"]],decls:3,vars:0,template:function(i,l){i&1&&Pe(0,"app-header")(1,"app-menu-opciones")(2,"router-outlet")},dependencies:[$r,ku,Qm,Kl,gp],encapsulation:2})};var eg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-inicio"]],decls:12,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733868035919&to=1734472835919&viewPanel=73&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733890467754&to=1734495267754&viewPanel=74&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733891497815&to=1734496297815&viewPanel=75&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733891690672&to=1734496490672&viewPanel=76&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733891734324&to=1734496534324&viewPanel=79&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733892371283&to=1734497171283&viewPanel=80&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Inicio"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4),$(),V(6,"div",2),Pe(7,"iframe",5)(8,"iframe",6),$(),V(9,"div",2),Pe(10,"iframe",7)(11,"iframe",8),$()())},styles:[".iframe-container[_ngcontent-%COMP%]{width:75%;height:50%;display:flex;margin-left:25%;justify-content:right}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{border:none;width:60%;height:800px}","body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column;font-family:Arial,sans-serif;background-color:#f4f4f4}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:300px;border:none;border-radius:8px;box-shadow:0 4px 12px #0000001a}iframe[_ngcontent-%COMP%]:hover{transform:scale(1.02)}"]})};var tg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:11,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1734455124927&to=1734498324927&viewPanel=16&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1740352844880&to=1740396044880&viewPanel=10&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1740352870706&to=1740396070706&viewPanel=13&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1740352901739&to=1740396101739&viewPanel=9&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Camiones"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3),$(),V(5,"div",2),Pe(6,"iframe",4),$(),V(7,"div",2),Pe(8,"iframe",5),$(),V(9,"div",2),Pe(10,"iframe",6),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}"]})};var ig=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-sensores-ruido"]],decls:5,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/ce9a9bd3-6b1e-48bc-8fab-cc6a042f6f5b/ambience-dashboard?orgId=1&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Sensores de Ruido"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin-left:300px;margin-bottom:20px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px}.iframe-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:920px;border:none}"]})};var ng=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:10,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row","small-iframes"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734607826803&to=1735212626803&viewPanel=2&kiosk`],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734613212216&to=1735218012216&viewPanel=3&kiosk`],[1,"iframe-row","large-iframe"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734613644066&to=1735218444067&viewPanel=56&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734613814858&to=1735218614858&viewPanel=57&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Reportes M\xE9dicos"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4),$(),V(6,"div",5),Pe(7,"iframe",6),$(),V(8,"div",5),Pe(9,"iframe",7),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-row[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.small-iframes[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;max-width:48%}.large-iframe[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:500px;max-width:80%}@media (max-width: 1200px){.small-iframes[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%], .large-iframe[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{max-width:100%}}"]})};var rg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:12,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732686476511&to=1735278476511&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732687115885&to=1735279115885&viewPanel=4&kiosk`,"allowfullscreen",""],[1,"iframe-column"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732711995953&to=1735303995953&viewPanel=33&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712398666&to=1735304398666&viewPanel=34&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712155294&to=1735304155295&viewPanel=6&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712771842&to=1735304771842&viewPanel=8&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712873380&to=1735304873380&viewPanel=20&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Puntos Wi-Fi"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4),$(),V(6,"div",5),Pe(7,"iframe",6)(8,"iframe",7)(9,"iframe",8)(10,"iframe",9)(11,"iframe",10),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.iframe-column[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:600px;border:none}"]})};var og=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:9,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/be4206a5-5095-46c2-8ad6-459879f8b397/evolucion-temporal?orgId=1&var-time_interval=week&var-modo_transporte=%27EnBici%27&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/c4aa4e46-0aeb-4e56-b272-bd96329b9f92/impacto-ambiental?orgId=1&kiosk`,"allowfullscreen",""],[1,"iframe-column"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/d57d13d8-5b6d-48e4-88fc-12d9d874e8dc/travels-kilometers?orgId=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/ba00627d-90a1-485c-a088-16a037d56c33/calories?orgId=1&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Vamos Medell\xEDn"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4),$(),V(6,"div",5),Pe(7,"iframe",6)(8,"iframe",7),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:500px;border:none}.iframe-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.iframe-column[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var sg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-pqrsd"]],decls:25,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793439047&to=1740398239047&viewPanel=55&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793492783&to=1740398292783&viewPanel=56&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793532582&to=1740398332582&viewPanel=57&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793599303&to=1740398399303&viewPanel=75&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793702223&to=1740398502223&viewPanel=76&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793898080&to=1740398698081&viewPanel=67&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794045244&to=1740398845245&viewPanel=69&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794083995&to=1740398883995&viewPanel=64&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794190362&to=1740398990362&viewPanel=72&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794256564&to=1740399056565&viewPanel=65&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794325102&to=1740399125102&viewPanel=68&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Ciudad Inteligente - PQRSD"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),$(),V(7,"div",2),Pe(8,"iframe",6),$(),V(9,"div",2),Pe(10,"iframe",7),$(),V(11,"div",2),Pe(12,"iframe",7),$(),V(13,"div",2),Pe(14,"iframe",8),$(),V(15,"div",2),Pe(16,"iframe",9),$(),V(17,"div",2),Pe(18,"iframe",10),$(),V(19,"div",2),Pe(20,"iframe",11),$(),V(21,"div",2),Pe(22,"iframe",12),$(),V(23,"div",2),Pe(24,"iframe",13),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]:first-child   iframe[_ngcontent-%COMP%]{flex:1}iframe[_ngcontent-%COMP%]{width:100%;height:400px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var ag=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:7,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/wa_ta/whatsapp?orgId=1&from=1739548898783&to=1740153698783&viewPanel=5&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/wa_ta/whatsapp?orgId=1&from=1739548919606&to=1740153719607&viewPanel=8&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/wa_ta/whatsapp?orgId=1&from=1739542345631&to=1740147145631&viewPanel=6&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"WhatsApp"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var lg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:17,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708535530544&to=1740157930544&theme=light&viewPanel=17&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708535597310&to=1740157997310&theme=light&viewPanel=18&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708535622443&to=1740158022443&viewPanel=19&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536018076&to=1740158418076&viewPanel=22&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536115554&to=1740158515554&viewPanel=5&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536157330&to=1740158557330&viewPanel=13&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536248147&to=1740158648147&viewPanel=14&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Turismo"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),$()(),V(7,"div",1),Pe(8,"iframe",6),$(),V(9,"div",1),Pe(10,"iframe",7),$(),V(11,"div",1),Pe(12,"iframe",6),$(),V(13,"div",1),Pe(14,"iframe",8),$(),V(15,"div",1),Pe(16,"iframe",9),$())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var cg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:22,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739554343770&to=1740159143771&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739554430452&to=1740159230452&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739554718561&to=1740159518561&viewPanel=48&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739567093188&to=1740171893188&theme=light&viewPanel=49&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739567465205&to=1740172265205&viewPanel=45&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739567516412&to=1740172316412&viewPanel=34&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739568570628&to=1740173370628&viewPanel=35&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739568941480&to=1740173741480&viewPanel=36&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739653662249&to=1740258462249&viewPanel=37&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739655373761&to=1740260173761&viewPanel=38&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Siata"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4),$()(),V(6,"div",1),Pe(7,"iframe",5),$(),V(8,"div",1),Pe(9,"iframe",6),$(),V(10,"div",1),Pe(11,"iframe",7),$(),V(12,"div",1),Pe(13,"iframe",8),$(),V(14,"div",1),Pe(15,"iframe",9),$(),V(16,"div",1),Pe(17,"iframe",10),$(),V(18,"div",1),Pe(19,"iframe",11),$(),V(20,"div",1),Pe(21,"iframe",12),$())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var dg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:10,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740169770252&to=1740256170252&viewPanel=10&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740169943092&to=1740256343092&viewPanel=11&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740174676193&to=1740261076193&viewPanel=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740170890221&to=1740257290221&viewPanel=16&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Ciudad Inteligente - Camiones EMVARIAS"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4),$()(),V(6,"div",1),Pe(7,"iframe",5),$(),V(8,"div",1),Pe(9,"iframe",6),$())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}"]})};var ug=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:11,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674305894&to=1740279105894&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674463402&to=1740279263402&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674645460&to=1740279445460&viewPanel=9&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674694900&to=1740279494900&viewPanel=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674790949&to=1740279590950&viewPanel=6&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Ciudad Inteligente - Camiones EMVARIAS"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),$()(),V(7,"div",1),Pe(8,"iframe",6),$(),V(9,"div",1),Pe(10,"iframe",7),$())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}"]})};var eP=["*"];var tP=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],iP=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],nP=new ct("MAT_CARD_CONFIG"),X1=(()=>{class c{appearance;constructor(){let i=me(nP,{optional:!0});this.appearance=i?.appearance||"raised"}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(l,h){l&2&&wi("mat-mdc-card-outlined",h.appearance==="outlined")("mdc-card--outlined",h.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:eP,decls:1,vars:0,template:function(l,h){l&1&&(Er(),zi(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return c})(),Y1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]})}return c})();var K1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return c})(),Q1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]})}return c})();var J1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:iP,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(l,h){l&1&&(Er(tP),zi(0),V(1,"div",0),zi(2,1),$(),zi(3,2))},encapsulation:2,changeDetection:0})}return c})();var eC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un,un]})}return c})();var Au=class{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new Ut;constructor(a=!1,i,l=!0,h){this._multiple=a,this._emitChanges=l,this.compareWith=h,i&&i.length&&(a?i.forEach(s=>this._markSelected(s)):this._markSelected(i[0]),this._selectedToEmit.length=0)}select(...a){this._verifyValueAssignment(a),a.forEach(l=>this._markSelected(l));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}deselect(...a){this._verifyValueAssignment(a),a.forEach(l=>this._unmarkSelected(l));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}setSelection(...a){this._verifyValueAssignment(a);let i=this.selected,l=new Set(a);a.forEach(s=>this._markSelected(s)),i.filter(s=>!l.has(this._getConcreteValue(s,l))).forEach(s=>this._unmarkSelected(s));let h=this._hasQueuedChanges();return this._emitChangeEvent(),h}toggle(a){return this.isSelected(a)?this.deselect(a):this.select(a)}clear(a=!0){this._unmarkAll();let i=this._hasQueuedChanges();return a&&this._emitChangeEvent(),i}isSelected(a){return this._selection.has(this._getConcreteValue(a))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(a){this._multiple&&this.selected&&this._selected.sort(a)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(a){a=this._getConcreteValue(a),this.isSelected(a)||(this._multiple||this._unmarkAll(),this.isSelected(a)||this._selection.add(a),this._emitChanges&&this._selectedToEmit.push(a))}_unmarkSelected(a){a=this._getConcreteValue(a),this.isSelected(a)&&(this._selection.delete(a),this._emitChanges&&this._deselectedToEmit.push(a))}_unmarkAll(){this.isEmpty()||this._selection.forEach(a=>this._unmarkSelected(a))}_verifyValueAssignment(a){a.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(a,i){if(this.compareWith){i=i??this._selection;for(let l of i)if(this.compareWith(a,l))return l;return a}else return a}};var oP=20,tC=(()=>{class c{_ngZone=me(hi);_platform=me(yr);_document=me(fi,{optional:!0});constructor(){}_scrolled=new Ut;_globalSubscription=null;_scrolledCount=0;scrollContainers=new Map;register(i){this.scrollContainers.has(i)||this.scrollContainers.set(i,i.elementScrolled().subscribe(()=>this._scrolled.next(i)))}deregister(i){let l=this.scrollContainers.get(i);l&&(l.unsubscribe(),this.scrollContainers.delete(i))}scrolled(i=oP){return this._platform.isBrowser?new Na(l=>{this._globalSubscription||this._addGlobalListener();let h=i>0?this._scrolled.pipe(A_(i)).subscribe(l):this._scrolled.subscribe(l);return this._scrolledCount++,()=>{h.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):bt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((i,l)=>this.deregister(l)),this._scrolled.complete()}ancestorScrolled(i,l){let h=this.getAncestorScrollContainers(i);return this.scrolled(l).pipe(vn(s=>!s||h.indexOf(s)>-1))}getAncestorScrollContainers(i){let l=[];return this.scrollContainers.forEach((h,s)=>{this._scrollableContainsElement(s,i)&&l.push(s)}),l}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(i,l){let h=Ka(l),s=i.getElementRef().nativeElement;do if(h==s)return!0;while(h=h.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let i=this._getWindow();return Lb(i.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var sP=20,zp=(()=>{class c{_platform=me(yr);_viewportSize;_change=new Ut;_changeListener=i=>{this._change.next(i)};_document=me(fi,{optional:!0});constructor(){me(hi).runOutsideAngular(()=>{if(this._platform.isBrowser){let l=this._getWindow();l.addEventListener("resize",this._changeListener),l.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let i=this._getWindow();i.removeEventListener("resize",this._changeListener),i.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let i={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),i}getViewportRect(){let i=this.getViewportScrollPosition(),{width:l,height:h}=this.getViewportSize();return{top:i.top,left:i.left,bottom:i.top+h,right:i.left+l,height:h,width:l}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let i=this._document,l=this._getWindow(),h=i.documentElement,s=h.getBoundingClientRect(),T=-s.top||i.body.scrollTop||l.scrollY||h.scrollTop||0,Y=-s.left||i.body.scrollLeft||l.scrollX||h.scrollLeft||0;return{top:T,left:Y}}change(i=sP){return i>0?this._change.pipe(A_(i)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let i=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:i.innerWidth,height:i.innerHeight}:{width:0,height:0}}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var hg=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({})}return c})(),Cy=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[nc,hg,nc,hg]})}return c})();var Bp=class{_attachedHost;attach(a){return this._attachedHost=a,a.attach(this)}detach(){let a=this._attachedHost;a!=null&&(this._attachedHost=null,a.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(a){this._attachedHost=a}},My=class extends Bp{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(a,i,l,h,s){super(),this.component=a,this.viewContainerRef=i,this.injector=l,this.projectableNodes=s}},Np=class extends Bp{templateRef;viewContainerRef;context;injector;constructor(a,i,l,h){super(),this.templateRef=a,this.viewContainerRef=i,this.context=l,this.injector=h}get origin(){return this.templateRef.elementRef}attach(a,i=this.context){return this.context=i,super.attach(a)}detach(){return this.context=void 0,super.detach()}},Sy=class extends Bp{element;constructor(a){super(),this.element=a instanceof Ci?a.nativeElement:a}},Ty=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(a){if(a instanceof My)return this._attachedPortal=a,this.attachComponentPortal(a);if(a instanceof Np)return this._attachedPortal=a,this.attachTemplatePortal(a);if(this.attachDomPortal&&a instanceof Sy)return this._attachedPortal=a,this.attachDomPortal(a)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(a){this._disposeFn=a}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var pg=class extends Ty{outletElement;_appRef;_defaultInjector;_document;constructor(a,i,l,h,s){super(),this.outletElement=a,this._appRef=l,this._defaultInjector=h,this._document=s}attachComponentPortal(a){let i;if(a.viewContainerRef){let l=a.injector||a.viewContainerRef.injector,h=l.get(nx,null,{optional:!0})||void 0;i=a.viewContainerRef.createComponent(a.component,{index:a.viewContainerRef.length,injector:l,ngModuleRef:h,projectableNodes:a.projectableNodes||void 0}),this.setDisposeFn(()=>i.destroy())}else i=Bf(a.component,{elementInjector:a.injector||this._defaultInjector||Tr.NULL,environmentInjector:this._appRef.injector,projectableNodes:a.projectableNodes||void 0}),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(i.hostView),i.destroy()});return this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=a,i}attachTemplatePortal(a){let i=a.viewContainerRef,l=i.createEmbeddedView(a.templateRef,a.context,{injector:a.injector});return l.rootNodes.forEach(h=>this.outletElement.appendChild(h)),l.detectChanges(),this.setDisposeFn(()=>{let h=i.indexOf(l);h!==-1&&i.remove(h)}),this._attachedPortal=a,l}attachDomPortal=a=>{let i=a.element;i.parentNode;let l=this._document.createComment("dom-portal");i.parentNode.insertBefore(l,i),this.outletElement.appendChild(i),this._attachedPortal=a,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(i,l)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(a){return a.hostView.rootNodes[0]}};var iC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({})}return c})();var nC=oy(),Ey=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(a,i){this._viewportRuler=a,this._document=i}attach(){}enable(){if(this._canBeEnabled()){let a=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=a.style.left||"",this._previousHTMLStyles.top=a.style.top||"",a.style.left=Dn(-this._previousScrollPosition.left),a.style.top=Dn(-this._previousScrollPosition.top),a.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let a=this._document.documentElement,i=this._document.body,l=a.style,h=i.style,s=l.scrollBehavior||"",T=h.scrollBehavior||"";this._isEnabled=!1,l.left=this._previousHTMLStyles.left,l.top=this._previousHTMLStyles.top,a.classList.remove("cdk-global-scrollblock"),nC&&(l.scrollBehavior=h.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),nC&&(l.scrollBehavior=s,h.scrollBehavior=T)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let i=this._document.body,l=this._viewportRuler.getViewportSize();return i.scrollHeight>l.height||i.scrollWidth>l.width}};var Iy=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(a,i,l,h){this._scrollDispatcher=a,this._ngZone=i,this._viewportRuler=l,this._config=h}attach(a){this._overlayRef,this._overlayRef=a}enable(){if(this._scrollSubscription)return;let a=this._scrollDispatcher.scrolled(0).pipe(vn(i=>!i||!this._overlayRef.overlayElement.contains(i.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=a.subscribe(()=>{let i=this._viewportRuler.getViewportScrollPosition().top;Math.abs(i-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=a.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}},fg=class{enable(){}disable(){}attach(){}};function Py(c,a){return a.some(i=>{let l=c.bottom<i.top,h=c.top>i.bottom,s=c.right<i.left,T=c.left>i.right;return l||h||s||T})}function rC(c,a){return a.some(i=>{let l=c.top<i.top,h=c.bottom>i.bottom,s=c.left<i.left,T=c.right>i.right;return l||h||s||T})}var ky=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(a,i,l,h){this._scrollDispatcher=a,this._viewportRuler=i,this._ngZone=l,this._config=h}attach(a){this._overlayRef,this._overlayRef=a}enable(){if(!this._scrollSubscription){let a=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(a).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let i=this._overlayRef.overlayElement.getBoundingClientRect(),{width:l,height:h}=this._viewportRuler.getViewportSize();Py(i,[{width:l,height:h,bottom:h,right:l,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},lP=(()=>{class c{_scrollDispatcher=me(tC);_viewportRuler=me(zp);_ngZone=me(hi);_document=me(fi);constructor(){}noop=()=>new fg;close=i=>new Iy(this._scrollDispatcher,this._ngZone,this._viewportRuler,i);block=()=>new Ey(this._viewportRuler,this._document);reposition=i=>new ky(this._scrollDispatcher,this._viewportRuler,this._ngZone,i);static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),mg=class{positionStrategy;scrollStrategy=new fg;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(a){if(a){let i=Object.keys(a);for(let l of i)a[l]!==void 0&&(this[l]=a[l])}}};var Ay=class{connectionPair;scrollableViewProperties;constructor(a,i){this.connectionPair=a,this.scrollableViewProperties=i}};var dC=(()=>{class c{_attachedOverlays=[];_document=me(fi);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(i){this.remove(i),this._attachedOverlays.push(i)}remove(i){let l=this._attachedOverlays.indexOf(i);l>-1&&this._attachedOverlays.splice(l,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),cP=(()=>{class c extends dC{_ngZone=me(hi,{optional:!0});add(i){super.add(i),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}_keydownListener=i=>{let l=this._attachedOverlays;for(let h=l.length-1;h>-1;h--)if(l[h]._keydownEvents.observers.length>0){let s=l[h]._keydownEvents;this._ngZone?this._ngZone.run(()=>s.next(i)):s.next(i);break}};static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),dP=(()=>{class c extends dC{_platform=me(yr);_ngZone=me(hi,{optional:!0});_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;add(i){if(super.add(i),!this._isAttached){let l=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(l)):this._addEventListeners(l),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=l.style.cursor,l.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let i=this._document.body;i.removeEventListener("pointerdown",this._pointerDownListener,!0),i.removeEventListener("click",this._clickListener,!0),i.removeEventListener("auxclick",this._clickListener,!0),i.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(i.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(i){i.addEventListener("pointerdown",this._pointerDownListener,!0),i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0)}_pointerDownListener=i=>{this._pointerDownEventTarget=Wo(i)};_clickListener=i=>{let l=Wo(i),h=i.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:l;this._pointerDownEventTarget=null;let s=this._attachedOverlays.slice();for(let T=s.length-1;T>-1;T--){let Y=s[T];if(Y._outsidePointerEvents.observers.length<1||!Y.hasAttached())continue;if(oC(Y.overlayElement,l)||oC(Y.overlayElement,h))break;let K=Y._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>K.next(i)):K.next(i)}};static \u0275fac=(()=>{let i;return function(h){return(i||(i=Zo(c)))(h||c)}})();static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function oC(c,a){let i=typeof ShadowRoot<"u"&&ShadowRoot,l=a;for(;l;){if(l===c)return!0;l=i&&l instanceof ShadowRoot?l.host:l.parentNode}return!1}var uC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(l,h){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}"],encapsulation:2,changeDetection:0})}return c})(),hC=(()=>{class c{_platform=me(yr);_containerElement;_document=me(fi);_styleLoader=me(Xa);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let i="cdk-overlay-container";if(this._platform.isBrowser||sy()){let h=this._document.querySelectorAll(`.${i}[platform="server"], .${i}[platform="test"]`);for(let s=0;s<h.length;s++)h[s].remove()}let l=this._document.createElement("div");l.classList.add(i),sy()?l.setAttribute("platform","test"):this._platform.isBrowser||l.setAttribute("platform","server"),this._document.body.appendChild(l),this._containerElement=l}_loadStyles(){this._styleLoader.load(uC)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Dy=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_backdropElement=null;_backdropTimeout;_backdropClick=new Ut;_attachments=new Ut;_detachments=new Ut;_positionStrategy;_scrollStrategy;_locationChanges=Sr.EMPTY;_backdropClickHandler=a=>this._backdropClick.next(a);_backdropTransitionendHandler=a=>{this._disposeBackdrop(a.target)};_previousHostParent;_keydownEvents=new Ut;_outsidePointerEvents=new Ut;_renders=new Ut;_afterRenderRef;_afterNextRenderRef;constructor(a,i,l,h,s,T,Y,K,Ce,be=!1,G){this._portalOutlet=a,this._host=i,this._pane=l,this._config=h,this._ngZone=s,this._keyboardDispatcher=T,this._document=Y,this._location=K,this._outsideClickDispatcher=Ce,this._animationsDisabled=be,this._injector=G,h.scrollStrategy&&(this._scrollStrategy=h.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=h.positionStrategy,this._afterRenderRef=bs(()=>Ef(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(a){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let i=this._portalOutlet.attach(a);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=nu(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof i?.onDestroy=="function"&&i.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),i}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let a=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),a}dispose(){let a=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,a&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(a){a!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=a,this.hasAttached()&&(a.attach(this),this.updatePosition()))}updateSize(a){this._config=Ye(Ye({},this._config),a),this._updateElementSize()}setDirection(a){this._config=si(Ye({},this._config),{direction:a}),this._updateElementDirection()}addPanelClass(a){this._pane&&this._toggleClasses(this._pane,a,!0)}removePanelClass(a){this._pane&&this._toggleClasses(this._pane,a,!1)}getDirection(){let a=this._config.direction;return a?typeof a=="string"?a:a.value:"ltr"}updateScrollStrategy(a){a!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=a,this.hasAttached()&&(a.attach(this),a.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let a=this._pane.style;a.width=Dn(this._config.width),a.height=Dn(this._config.height),a.minWidth=Dn(this._config.minWidth),a.minHeight=Dn(this._config.minHeight),a.maxWidth=Dn(this._config.maxWidth),a.maxHeight=Dn(this._config.maxHeight)}_togglePointerEvents(a){this._pane.style.pointerEvents=a?"":"none"}_attachBackdrop(){let a="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(a)})}):this._backdropElement.classList.add(a)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let a=this._backdropElement;if(a){if(this._animationsDisabled){this._disposeBackdrop(a);return}a.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{a.addEventListener("transitionend",this._backdropTransitionendHandler)}),a.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(a)},500))}}_toggleClasses(a,i,l){let h=Iu(i||[]).filter(s=>!!s);h.length&&(l?a.classList.add(...h):a.classList.remove(...h))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let a=this._renders.pipe(An(Nl(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),a.unsubscribe())})})}_disposeScrollStrategy(){let a=this._scrollStrategy;a&&(a.disable(),a.detach&&a.detach())}_disposeBackdrop(a){a&&(a.removeEventListener("click",this._backdropClickHandler),a.removeEventListener("transitionend",this._backdropTransitionendHandler),a.remove(),this._backdropElement===a&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},sC="cdk-overlay-connected-position-bounding-box",uP=/([A-Za-z%]+)$/,Ry=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new Ut;_resizeSubscription=Sr.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(a,i,l,h,s){this._viewportRuler=i,this._document=l,this._platform=h,this._overlayContainer=s,this.setOrigin(a)}attach(a){this._overlayRef&&this._overlayRef,this._validatePositions(),a.hostElement.classList.add(sC),this._overlayRef=a,this._boundingBox=a.hostElement,this._pane=a.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let a=this._originRect,i=this._overlayRect,l=this._viewportRect,h=this._containerRect,s=[],T;for(let Y of this._preferredPositions){let K=this._getOriginPoint(a,h,Y),Ce=this._getOverlayPoint(K,i,Y),be=this._getOverlayFit(Ce,i,l,Y);if(be.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(Y,K);return}if(this._canFitWithFlexibleDimensions(be,Ce,l)){s.push({position:Y,origin:K,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(K,Y)});continue}(!T||T.overlayFit.visibleArea<be.visibleArea)&&(T={overlayFit:be,overlayPoint:Ce,originPoint:K,position:Y,overlayRect:i})}if(s.length){let Y=null,K=-1;for(let Ce of s){let be=Ce.boundingBoxRect.width*Ce.boundingBoxRect.height*(Ce.position.weight||1);be>K&&(K=be,Y=Ce)}this._isPushed=!1,this._applyPosition(Y.position,Y.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(T.position,T.originPoint);return}this._applyPosition(T.position,T.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&sd(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(sC),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let a=this._lastPosition;if(a){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._getOriginPoint(this._originRect,this._containerRect,a);this._applyPosition(a,i)}else this.apply()}withScrollableContainers(a){return this._scrollables=a,this}withPositions(a){return this._preferredPositions=a,a.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(a){return this._viewportMargin=a,this}withFlexibleDimensions(a=!0){return this._hasFlexibleDimensions=a,this}withGrowAfterOpen(a=!0){return this._growAfterOpen=a,this}withPush(a=!0){return this._canPush=a,this}withLockedPosition(a=!0){return this._positionLocked=a,this}setOrigin(a){return this._origin=a,this}withDefaultOffsetX(a){return this._offsetX=a,this}withDefaultOffsetY(a){return this._offsetY=a,this}withTransformOriginOn(a){return this._transformOriginSelector=a,this}_getOriginPoint(a,i,l){let h;if(l.originX=="center")h=a.left+a.width/2;else{let T=this._isRtl()?a.right:a.left,Y=this._isRtl()?a.left:a.right;h=l.originX=="start"?T:Y}i.left<0&&(h-=i.left);let s;return l.originY=="center"?s=a.top+a.height/2:s=l.originY=="top"?a.top:a.bottom,i.top<0&&(s-=i.top),{x:h,y:s}}_getOverlayPoint(a,i,l){let h;l.overlayX=="center"?h=-i.width/2:l.overlayX==="start"?h=this._isRtl()?-i.width:0:h=this._isRtl()?0:-i.width;let s;return l.overlayY=="center"?s=-i.height/2:s=l.overlayY=="top"?0:-i.height,{x:a.x+h,y:a.y+s}}_getOverlayFit(a,i,l,h){let s=lC(i),{x:T,y:Y}=a,K=this._getOffset(h,"x"),Ce=this._getOffset(h,"y");K&&(T+=K),Ce&&(Y+=Ce);let be=0-T,G=T+s.width-l.width,$e=0-Y,ft=Y+s.height-l.height,Ct=this._subtractOverflows(s.width,be,G),ut=this._subtractOverflows(s.height,$e,ft),lt=Ct*ut;return{visibleArea:lt,isCompletelyWithinViewport:s.width*s.height===lt,fitsInViewportVertically:ut===s.height,fitsInViewportHorizontally:Ct==s.width}}_canFitWithFlexibleDimensions(a,i,l){if(this._hasFlexibleDimensions){let h=l.bottom-i.y,s=l.right-i.x,T=aC(this._overlayRef.getConfig().minHeight),Y=aC(this._overlayRef.getConfig().minWidth),K=a.fitsInViewportVertically||T!=null&&T<=h,Ce=a.fitsInViewportHorizontally||Y!=null&&Y<=s;return K&&Ce}return!1}_pushOverlayOnScreen(a,i,l){if(this._previousPushAmount&&this._positionLocked)return{x:a.x+this._previousPushAmount.x,y:a.y+this._previousPushAmount.y};let h=lC(i),s=this._viewportRect,T=Math.max(a.x+h.width-s.width,0),Y=Math.max(a.y+h.height-s.height,0),K=Math.max(s.top-l.top-a.y,0),Ce=Math.max(s.left-l.left-a.x,0),be=0,G=0;return h.width<=s.width?be=Ce||-T:be=a.x<this._viewportMargin?s.left-l.left-a.x:0,h.height<=s.height?G=K||-Y:G=a.y<this._viewportMargin?s.top-l.top-a.y:0,this._previousPushAmount={x:be,y:G},{x:a.x+be,y:a.y+G}}_applyPosition(a,i){if(this._setTransformOrigin(a),this._setOverlayElementStyles(i,a),this._setBoundingBoxStyles(i,a),a.panelClass&&this._addPanelClasses(a.panelClass),this._positionChanges.observers.length){let l=this._getScrollVisibility();if(a!==this._lastPosition||!this._lastScrollVisibility||!hP(this._lastScrollVisibility,l)){let h=new Ay(a,l);this._positionChanges.next(h)}this._lastScrollVisibility=l}this._lastPosition=a,this._isInitialRender=!1}_setTransformOrigin(a){if(!this._transformOriginSelector)return;let i=this._boundingBox.querySelectorAll(this._transformOriginSelector),l,h=a.overlayY;a.overlayX==="center"?l="center":this._isRtl()?l=a.overlayX==="start"?"right":"left":l=a.overlayX==="start"?"left":"right";for(let s=0;s<i.length;s++)i[s].style.transformOrigin=`${l} ${h}`}_calculateBoundingBoxRect(a,i){let l=this._viewportRect,h=this._isRtl(),s,T,Y;if(i.overlayY==="top")T=a.y,s=l.height-T+this._viewportMargin;else if(i.overlayY==="bottom")Y=l.height-a.y+this._viewportMargin*2,s=l.height-Y+this._viewportMargin;else{let ft=Math.min(l.bottom-a.y+l.top,a.y),Ct=this._lastBoundingBoxSize.height;s=ft*2,T=a.y-ft,s>Ct&&!this._isInitialRender&&!this._growAfterOpen&&(T=a.y-Ct/2)}let K=i.overlayX==="start"&&!h||i.overlayX==="end"&&h,Ce=i.overlayX==="end"&&!h||i.overlayX==="start"&&h,be,G,$e;if(Ce)$e=l.width-a.x+this._viewportMargin*2,be=a.x-this._viewportMargin;else if(K)G=a.x,be=l.right-a.x;else{let ft=Math.min(l.right-a.x+l.left,a.x),Ct=this._lastBoundingBoxSize.width;be=ft*2,G=a.x-ft,be>Ct&&!this._isInitialRender&&!this._growAfterOpen&&(G=a.x-Ct/2)}return{top:T,left:G,bottom:Y,right:$e,width:be,height:s}}_setBoundingBoxStyles(a,i){let l=this._calculateBoundingBoxRect(a,i);!this._isInitialRender&&!this._growAfterOpen&&(l.height=Math.min(l.height,this._lastBoundingBoxSize.height),l.width=Math.min(l.width,this._lastBoundingBoxSize.width));let h={};if(this._hasExactPosition())h.top=h.left="0",h.bottom=h.right=h.maxHeight=h.maxWidth="",h.width=h.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,T=this._overlayRef.getConfig().maxWidth;h.height=Dn(l.height),h.top=Dn(l.top),h.bottom=Dn(l.bottom),h.width=Dn(l.width),h.left=Dn(l.left),h.right=Dn(l.right),i.overlayX==="center"?h.alignItems="center":h.alignItems=i.overlayX==="end"?"flex-end":"flex-start",i.overlayY==="center"?h.justifyContent="center":h.justifyContent=i.overlayY==="bottom"?"flex-end":"flex-start",s&&(h.maxHeight=Dn(s)),T&&(h.maxWidth=Dn(T))}this._lastBoundingBoxSize=l,sd(this._boundingBox.style,h)}_resetBoundingBoxStyles(){sd(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){sd(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(a,i){let l={},h=this._hasExactPosition(),s=this._hasFlexibleDimensions,T=this._overlayRef.getConfig();if(h){let be=this._viewportRuler.getViewportScrollPosition();sd(l,this._getExactOverlayY(i,a,be)),sd(l,this._getExactOverlayX(i,a,be))}else l.position="static";let Y="",K=this._getOffset(i,"x"),Ce=this._getOffset(i,"y");K&&(Y+=`translateX(${K}px) `),Ce&&(Y+=`translateY(${Ce}px)`),l.transform=Y.trim(),T.maxHeight&&(h?l.maxHeight=Dn(T.maxHeight):s&&(l.maxHeight="")),T.maxWidth&&(h?l.maxWidth=Dn(T.maxWidth):s&&(l.maxWidth="")),sd(this._pane.style,l)}_getExactOverlayY(a,i,l){let h={top:"",bottom:""},s=this._getOverlayPoint(i,this._overlayRect,a);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,l)),a.overlayY==="bottom"){let T=this._document.documentElement.clientHeight;h.bottom=`${T-(s.y+this._overlayRect.height)}px`}else h.top=Dn(s.y);return h}_getExactOverlayX(a,i,l){let h={left:"",right:""},s=this._getOverlayPoint(i,this._overlayRect,a);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,l));let T;if(this._isRtl()?T=a.overlayX==="end"?"left":"right":T=a.overlayX==="end"?"right":"left",T==="right"){let Y=this._document.documentElement.clientWidth;h.right=`${Y-(s.x+this._overlayRect.width)}px`}else h.left=Dn(s.x);return h}_getScrollVisibility(){let a=this._getOriginRect(),i=this._pane.getBoundingClientRect(),l=this._scrollables.map(h=>h.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:rC(a,l),isOriginOutsideView:Py(a,l),isOverlayClipped:rC(i,l),isOverlayOutsideView:Py(i,l)}}_subtractOverflows(a,...i){return i.reduce((l,h)=>l-Math.max(h,0),a)}_getNarrowedViewportRect(){let a=this._document.documentElement.clientWidth,i=this._document.documentElement.clientHeight,l=this._viewportRuler.getViewportScrollPosition();return{top:l.top+this._viewportMargin,left:l.left+this._viewportMargin,right:l.left+a-this._viewportMargin,bottom:l.top+i-this._viewportMargin,width:a-2*this._viewportMargin,height:i-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(a,i){return i==="x"?a.offsetX==null?this._offsetX:a.offsetX:a.offsetY==null?this._offsetY:a.offsetY}_validatePositions(){}_addPanelClasses(a){this._pane&&Iu(a).forEach(i=>{i!==""&&this._appliedPanelClasses.indexOf(i)===-1&&(this._appliedPanelClasses.push(i),this._pane.classList.add(i))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(a=>{this._pane.classList.remove(a)}),this._appliedPanelClasses=[])}_getOriginRect(){let a=this._origin;if(a instanceof Ci)return a.nativeElement.getBoundingClientRect();if(a instanceof Element)return a.getBoundingClientRect();let i=a.width||0,l=a.height||0;return{top:a.y,bottom:a.y+l,left:a.x,right:a.x+i,height:l,width:i}}};function sd(c,a){for(let i in a)a.hasOwnProperty(i)&&(c[i]=a[i]);return c}function aC(c){if(typeof c!="number"&&c!=null){let[a,i]=c.split(uP);return!i||i==="px"?parseFloat(a):null}return c||null}function lC(c){return{top:Math.floor(c.top),right:Math.floor(c.right),bottom:Math.floor(c.bottom),left:Math.floor(c.left),width:Math.floor(c.width),height:Math.floor(c.height)}}function hP(c,a){return c===a?!0:c.isOriginClipped===a.isOriginClipped&&c.isOriginOutsideView===a.isOriginOutsideView&&c.isOverlayClipped===a.isOverlayClipped&&c.isOverlayOutsideView===a.isOverlayOutsideView}var cC="cdk-global-overlay-wrapper",Oy=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(a){let i=a.getConfig();this._overlayRef=a,this._width&&!i.width&&a.updateSize({width:this._width}),this._height&&!i.height&&a.updateSize({height:this._height}),a.hostElement.classList.add(cC),this._isDisposed=!1}top(a=""){return this._bottomOffset="",this._topOffset=a,this._alignItems="flex-start",this}left(a=""){return this._xOffset=a,this._xPosition="left",this}bottom(a=""){return this._topOffset="",this._bottomOffset=a,this._alignItems="flex-end",this}right(a=""){return this._xOffset=a,this._xPosition="right",this}start(a=""){return this._xOffset=a,this._xPosition="start",this}end(a=""){return this._xOffset=a,this._xPosition="end",this}width(a=""){return this._overlayRef?this._overlayRef.updateSize({width:a}):this._width=a,this}height(a=""){return this._overlayRef?this._overlayRef.updateSize({height:a}):this._height=a,this}centerHorizontally(a=""){return this.left(a),this._xPosition="center",this}centerVertically(a=""){return this.top(a),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let a=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement.style,l=this._overlayRef.getConfig(),{width:h,height:s,maxWidth:T,maxHeight:Y}=l,K=(h==="100%"||h==="100vw")&&(!T||T==="100%"||T==="100vw"),Ce=(s==="100%"||s==="100vh")&&(!Y||Y==="100%"||Y==="100vh"),be=this._xPosition,G=this._xOffset,$e=this._overlayRef.getConfig().direction==="rtl",ft="",Ct="",ut="";K?ut="flex-start":be==="center"?(ut="center",$e?Ct=G:ft=G):$e?be==="left"||be==="end"?(ut="flex-end",ft=G):(be==="right"||be==="start")&&(ut="flex-start",Ct=G):be==="left"||be==="start"?(ut="flex-start",ft=G):(be==="right"||be==="end")&&(ut="flex-end",Ct=G),a.position=this._cssPosition,a.marginLeft=K?"0":ft,a.marginTop=Ce?"0":this._topOffset,a.marginBottom=this._bottomOffset,a.marginRight=K?"0":Ct,i.justifyContent=ut,i.alignItems=Ce?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let a=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement,l=i.style;i.classList.remove(cC),l.justifyContent=l.alignItems=a.marginTop=a.marginBottom=a.marginLeft=a.marginRight=a.position="",this._overlayRef=null,this._isDisposed=!0}},pP=(()=>{class c{_viewportRuler=me(zp);_document=me(fi);_platform=me(yr);_overlayContainer=me(hC);constructor(){}global(){return new Oy}flexibleConnectedTo(i){return new Ry(i,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),ad=(()=>{class c{scrollStrategies=me(lP);_overlayContainer=me(hC);_positionBuilder=me(pP);_keyboardDispatcher=me(cP);_injector=me(Tr);_ngZone=me(hi);_document=me(fi);_directionality=me(ta);_location=me(Yc);_outsideClickDispatcher=me(dP);_animationsModuleType=me(wo,{optional:!0});_idGenerator=me(Xo);_appRef;_styleLoader=me(Xa);constructor(){}create(i){this._styleLoader.load(uC);let l=this._createHostElement(),h=this._createPaneElement(l),s=this._createPortalOutlet(h),T=new mg(i);return T.direction=T.direction||this._directionality.value,new Dy(s,l,h,T,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(vs))}position(){return this._positionBuilder}_createPaneElement(i){let l=this._document.createElement("div");return l.id=this._idGenerator.getId("cdk-overlay-"),l.classList.add("cdk-overlay-pane"),i.appendChild(l),l}_createHostElement(){let i=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalOutlet(i){return this._appRef||(this._appRef=this._injector.get(Gl)),new pg(i,null,this._appRef,this._injector,this._document)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),fP=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],pC=new ct("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let c=me(ad);return()=>c.scrollStrategies.reposition()}}),Vp=(()=>{class c{elementRef=me(Ci);constructor(){}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]})}return c})(),Fy=(()=>{class c{_overlay=me(ad);_dir=me(ta,{optional:!0});_overlayRef;_templatePortal;_backdropSubscription=Sr.EMPTY;_attachSubscription=Sr.EMPTY;_detachSubscription=Sr.EMPTY;_positionSubscription=Sr.EMPTY;_offsetX;_offsetY;_position;_scrollStrategyFactory=me(pC);_disposeOnNavigation=!1;_ngZone=me(hi);origin;positions;positionStrategy;get offsetX(){return this._offsetX}set offsetX(i){this._offsetX=i,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(i){this._offsetY=i,this._position&&this._updatePositionStrategy(this._position)}width;height;minWidth;minHeight;backdropClass;panelClass;viewportMargin=0;scrollStrategy;open=!1;disableClose=!1;transformOriginSelector;hasBackdrop=!1;lockPosition=!1;flexibleDimensions=!1;growAfterOpen=!1;push=!1;get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(i){this._disposeOnNavigation=i}backdropClick=new xi;positionChange=new xi;attach=new xi;detach=new xi;overlayKeydown=new xi;overlayOutsideClick=new xi;constructor(){let i=me(Pf),l=me(au);this._templatePortal=new Np(i,l),this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(i){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),i.origin&&this.open&&this._position.apply()),i.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=fP);let i=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=i.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=i.detachments().subscribe(()=>this.detach.emit()),i.keydownEvents().subscribe(l=>{this.overlayKeydown.next(l),l.keyCode===27&&!this.disableClose&&!Ya(l)&&(l.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(l=>{let h=this._getOriginElement(),s=Wo(l);(!h||h!==s&&!h.contains(s))&&this.overlayOutsideClick.next(l)})}_buildConfig(){let i=this._position=this.positionStrategy||this._createPositionStrategy(),l=new mg({direction:this._dir||"ltr",positionStrategy:i,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(l.width=this.width),(this.height||this.height===0)&&(l.height=this.height),(this.minWidth||this.minWidth===0)&&(l.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(l.minHeight=this.minHeight),this.backdropClass&&(l.backdropClass=this.backdropClass),this.panelClass&&(l.panelClass=this.panelClass),l}_updatePositionStrategy(i){let l=this.positions.map(h=>({originX:h.originX,originY:h.originY,overlayX:h.overlayX,overlayY:h.overlayY,offsetX:h.offsetX||this.offsetX,offsetY:h.offsetY||this.offsetY,panelClass:h.panelClass||void 0}));return i.setOrigin(this._getOrigin()).withPositions(l).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let i=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(i),i}_getOrigin(){return this.origin instanceof Vp?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof Vp?this.origin.elementRef.nativeElement:this.origin instanceof Ci?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(i=>{this.backdropClick.emit(i)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(jb(()=>this.positionChange.observers.length>0)).subscribe(i=>{this._ngZone.run(()=>this.positionChange.emit(i)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",pi],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",pi],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",pi],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",pi],push:[2,"cdkConnectedOverlayPush","push",pi],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",pi]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[or,Ho]})}return c})();function mP(c){return()=>c.scrollStrategies.reposition()}var gP={provide:pC,deps:[ad],useFactory:mP},fC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({providers:[ad,gP],imports:[nc,iC,Cy,Cy]})}return c})();var Ly=class{_box;_destroyed=new Ut;_resizeSubject=new Ut;_resizeObserver;_elementObservables=new Map;constructor(a){this._box=a,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(i=>this._resizeSubject.next(i)))}observe(a){return this._elementObservables.has(a)||this._elementObservables.set(a,new Na(i=>{let l=this._resizeSubject.subscribe(i);return this._resizeObserver?.observe(a,{box:this._box}),()=>{this._resizeObserver?.unobserve(a),l.unsubscribe(),this._elementObservables.delete(a)}}).pipe(vn(i=>i.some(l=>l.target===a)),F_({bufferSize:1,refCount:!0}),An(this._destroyed))),this._elementObservables.get(a)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},mC=(()=>{class c{_observers=new Map;_ngZone=me(hi);constructor(){typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,i]of this._observers)i.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(i,l){let h=l?.box||"content-box";return this._observers.has(h)||this._observers.set(h,new Ly(h)),this._observers.get(h).observe(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=ot({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var _P=["notch"],yP=["matFormFieldNotchedOutline",""],vP=["*"],bP=["textField"],xP=["iconPrefixContainer"],wP=["textPrefixContainer"],CP=["iconSuffixContainer"],MP=["textSuffixContainer"],SP=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],TP=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function EP(c,a){c&1&&Pe(0,"span",21)}function IP(c,a){if(c&1&&(V(0,"label",20),zi(1,1),it(2,EP,1,0,"span",21),$()),c&2){let i=Je(2);Ge("floating",i._shouldLabelFloat())("monitorResize",i._hasOutline())("id",i._labelId),en("for",i._control.disableAutomaticLabeling?null:i._control.id),_e(2),sn(!i.hideRequiredMarker&&i._control.required?2:-1)}}function PP(c,a){if(c&1&&it(0,IP,3,5,"label",20),c&2){let i=Je();sn(i._hasFloatingLabel()?0:-1)}}function kP(c,a){c&1&&Pe(0,"div",7)}function AP(c,a){}function DP(c,a){if(c&1&&it(0,AP,0,0,"ng-template",13),c&2){Je(2);let i=Ua(1);Ge("ngTemplateOutlet",i)}}function RP(c,a){if(c&1&&(V(0,"div",9),it(1,DP,1,1,null,13),$()),c&2){let i=Je();Ge("matFormFieldNotchedOutlineOpen",i._shouldLabelFloat()),_e(),sn(i._forceDisplayInfixLabel()?-1:1)}}function OP(c,a){c&1&&(V(0,"div",10,2),zi(2,2),$())}function FP(c,a){c&1&&(V(0,"div",11,3),zi(2,3),$())}function LP(c,a){}function zP(c,a){if(c&1&&it(0,LP,0,0,"ng-template",13),c&2){Je();let i=Ua(1);Ge("ngTemplateOutlet",i)}}function BP(c,a){c&1&&(V(0,"div",14,4),zi(2,4),$())}function NP(c,a){c&1&&(V(0,"div",15,5),zi(2,5),$())}function VP(c,a){c&1&&Pe(0,"div",16)}function jP(c,a){if(c&1&&(V(0,"div",18),zi(1,6),$()),c&2){let i=Je();Ge("@transitionMessages",i._subscriptAnimationState)}}function UP(c,a){if(c&1&&(V(0,"mat-hint",22),le(1),$()),c&2){let i=Je(2);Ge("id",i._hintLabelId),_e(),Lt(i.hintLabel)}}function $P(c,a){if(c&1&&(V(0,"div",19),it(1,UP,2,2,"mat-hint",22),zi(2,7),Pe(3,"div",23),zi(4,8),$()),c&2){let i=Je();Ge("@transitionMessages",i._subscriptAnimationState),_e(),sn(i.hintLabel?1:-1)}}var _g=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["mat-label"]]})}return c})(),GP=new ct("MatError");var gC=(()=>{class c{align="start";id=me(Xo).getId("mat-mdc-hint-");static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(l,h){l&2&&(Ff("id",h.id),en("align",null),wi("mat-mdc-form-field-hint-end",h.align==="end"))},inputs:{align:"align",id:"id"}})}return c})(),HP=new ct("MatPrefix");var ZP=new ct("MatSuffix");var CC=new ct("FloatingLabelParent"),_C=(()=>{class c{_elementRef=me(Ci);get floating(){return this._floating}set floating(i){this._floating=i,this.monitorResize&&this._handleResize()}_floating=!1;get monitorResize(){return this._monitorResize}set monitorResize(i){this._monitorResize=i,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}_monitorResize=!1;_resizeObserver=me(mC);_ngZone=me(hi);_parent=me(CC);_resizeSubscription=new Sr;constructor(){}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return qP(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(l,h){l&2&&wi("mdc-floating-label--float-above",h.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return c})();function qP(c){let a=c;if(a.offsetParent!==null)return a.scrollWidth;let i=a.cloneNode(!0);i.style.setProperty("position","absolute"),i.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(i);let l=i.scrollWidth;return i.remove(),l}var yC="mdc-line-ripple--active",gg="mdc-line-ripple--deactivating",vC=(()=>{class c{_elementRef=me(Ci);constructor(){me(hi).runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let i=this._elementRef.nativeElement.classList;i.remove(gg),i.add(yC)}deactivate(){this._elementRef.nativeElement.classList.add(gg)}_handleTransitionEnd=i=>{let l=this._elementRef.nativeElement.classList,h=l.contains(gg);i.propertyName==="opacity"&&h&&l.remove(yC,gg)};ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return c})(),bC=(()=>{class c{_elementRef=me(Ci);_ngZone=me(hi);open=!1;_notch;constructor(){}ngAfterViewInit(){let i=this._elementRef.nativeElement.querySelector(".mdc-floating-label");i?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(i.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>i.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(i){!this.open||!i?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${i}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(l,h){if(l&1&&an(_P,5),l&2){let s;_i(s=yi())&&(h._notch=s.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(l,h){l&2&&wi("mdc-notched-outline--notched",h.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},attrs:yP,ngContentSelectors:vP,decls:5,vars:0,consts:[["notch",""],[1,"mat-mdc-notch-piece","mdc-notched-outline__leading"],[1,"mat-mdc-notch-piece","mdc-notched-outline__notch"],[1,"mat-mdc-notch-piece","mdc-notched-outline__trailing"]],template:function(l,h){l&1&&(Er(),Pe(0,"div",1),V(1,"div",2,0),zi(3),$(),Pe(4,"div",3))},encapsulation:2,changeDetection:0})}return c})(),WP={transitionMessages:Vh("transitionMessages",[Hf("enter",Kc({opacity:1,transform:"translateY(0%)"})),cu("void => enter",[Kc({opacity:0,transform:"translateY(-5px)"}),jh("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},zy=(()=>{class c{value;stateChanges;id;placeholder;ngControl;focused;empty;shouldLabelFloat;required;disabled;errorState;controlType;autofilled;userAriaDescribedBy;disableAutomaticLabeling;static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c})}return c})();var By=new ct("MatFormField"),XP=new ct("MAT_FORM_FIELD_DEFAULT_OPTIONS"),xC="fill",YP="auto",wC="fixed",KP="translateY(-50%)",MC=(()=>{class c{_elementRef=me(Ci);_changeDetectorRef=me(Ur);_dir=me(ta);_platform=me(yr);_idGenerator=me(Xo);_defaults=me(XP,{optional:!0});_animationMode=me(wo,{optional:!0});_textField;_iconPrefixContainer;_textPrefixContainer;_iconSuffixContainer;_textSuffixContainer;_floatingLabel;_notchedOutline;_lineRipple;_formFieldControl;_prefixChildren;_suffixChildren;_errorChildren;_hintChildren;_labelChild=ix(_g);get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(i){this._hideRequiredMarker=x1(i)}_hideRequiredMarker=!1;color="primary";get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||YP}set floatLabel(i){i!==this._floatLabel&&(this._floatLabel=i,this._changeDetectorRef.markForCheck())}_floatLabel;get appearance(){return this._appearance}set appearance(i){let l=this._appearance,h=i||this._defaults?.appearance||xC;this._appearance=h,this._appearance==="outline"&&this._appearance!==l&&(this._needsOutlineLabelOffsetUpdate=!0)}_appearance=xC;get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||wC}set subscriptSizing(i){this._subscriptSizing=i||this._defaults?.subscriptSizing||wC}_subscriptSizing=null;get hintLabel(){return this._hintLabel}set hintLabel(i){this._hintLabel=i,this._processHints()}_hintLabel="";_hasIconPrefix=!1;_hasTextPrefix=!1;_hasIconSuffix=!1;_hasTextSuffix=!1;_labelId=this._idGenerator.getId("mat-mdc-form-field-label-");_hintLabelId=this._idGenerator.getId("mat-mdc-hint-");_subscriptAnimationState="";get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(i){this._explicitFormFieldControl=i}_destroyed=new Ut;_isFocused=null;_explicitFormFieldControl;_needsOutlineLabelOffsetUpdate=!1;_previousControl=null;_stateChanges;_valueChanges;_describedByChanges;_injector=me(Tr);constructor(){let i=this._defaults;i&&(i.appearance&&(this.appearance=i.appearance),this._hideRequiredMarker=!!i?.hideRequiredMarker,i.color&&(this.color=i.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl(),this._control!==this._previousControl&&(this._initializeControl(this._previousControl),this._previousControl=this._control)}ngOnDestroy(){this._stateChanges?.unsubscribe(),this._valueChanges?.unsubscribe(),this._describedByChanges?.unsubscribe(),this._destroyed.next(),this._destroyed.complete()}getLabelId=$a(()=>this._hasFloatingLabel()?this._labelId:null);getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(i){let l=this._control,h="mat-mdc-form-field-type-";i&&this._elementRef.nativeElement.classList.remove(h+i.controlType),l.controlType&&this._elementRef.nativeElement.classList.add(h+l.controlType),this._stateChanges?.unsubscribe(),this._stateChanges=l.stateChanges.subscribe(()=>{this._updateFocusState(),this._changeDetectorRef.markForCheck()}),this._describedByChanges?.unsubscribe(),this._describedByChanges=l.stateChanges.pipe(Ks([void 0,void 0]),kt(()=>[l.errorState,l.userAriaDescribedBy]),O_(),vn(([[s,T],[Y,K]])=>s!==Y||T!==K)).subscribe(()=>this._syncDescribedByIds()),this._valueChanges?.unsubscribe(),l.ngControl&&l.ngControl.valueChanges&&(this._valueChanges=l.ngControl.valueChanges.pipe(An(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()))}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(i=>!i._isText),this._hasTextPrefix=!!this._prefixChildren.find(i=>i._isText),this._hasIconSuffix=!!this._suffixChildren.find(i=>!i._isText),this._hasTextSuffix=!!this._suffixChildren.find(i=>i._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Nl(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),Ef(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(An(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel=$a(()=>!!this._labelChild());_shouldLabelFloat(){return this._hasFloatingLabel()?this._control.shouldLabelFloat||this._shouldAlwaysFloat():!1}_shouldForward(i){let l=this._control?this._control.ngControl:null;return l&&l[i]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let i=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&i.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let l=this._hintChildren?this._hintChildren.find(s=>s.align==="start"):null,h=this._hintChildren?this._hintChildren.find(s=>s.align==="end"):null;l?i.push(l.id):this._hintLabel&&i.push(this._hintLabelId),h&&i.push(h.id)}else this._errorChildren&&i.push(...this._errorChildren.map(l=>l.id));this._control.setDescribedByIds(i)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;let i=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){i.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdate=!0;return}let l=this._iconPrefixContainer?.nativeElement,h=this._textPrefixContainer?.nativeElement,s=this._iconSuffixContainer?.nativeElement,T=this._textSuffixContainer?.nativeElement,Y=l?.getBoundingClientRect().width??0,K=h?.getBoundingClientRect().width??0,Ce=s?.getBoundingClientRect().width??0,be=T?.getBoundingClientRect().width??0,G=this._dir.value==="rtl"?"-1":"1",$e=`${Y+K}px`,Ct=`calc(${G} * (${$e} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;i.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${KP} translateX(${Ct})
    )`;let ut=Y+K+Ce+be;this._elementRef.nativeElement.style.setProperty("--mat-form-field-notch-max-width",`calc(100% - ${ut}px)`)}_isAttachedToDom(){let i=this._elementRef.nativeElement;if(i.getRootNode){let l=i.getRootNode();return l&&l!==i}return document.documentElement.contains(i)}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-form-field"]],contentQueries:function(l,h,s){if(l&1&&(sx(s,h._labelChild,_g,5),io(s,zy,5),io(s,HP,5),io(s,ZP,5),io(s,GP,5),io(s,gC,5)),l&2){ax();let T;_i(T=yi())&&(h._formFieldControl=T.first),_i(T=yi())&&(h._prefixChildren=T),_i(T=yi())&&(h._suffixChildren=T),_i(T=yi())&&(h._errorChildren=T),_i(T=yi())&&(h._hintChildren=T)}},viewQuery:function(l,h){if(l&1&&(an(bP,5),an(xP,5),an(wP,5),an(CP,5),an(MP,5),an(_C,5),an(bC,5),an(vC,5)),l&2){let s;_i(s=yi())&&(h._textField=s.first),_i(s=yi())&&(h._iconPrefixContainer=s.first),_i(s=yi())&&(h._textPrefixContainer=s.first),_i(s=yi())&&(h._iconSuffixContainer=s.first),_i(s=yi())&&(h._textSuffixContainer=s.first),_i(s=yi())&&(h._floatingLabel=s.first),_i(s=yi())&&(h._notchedOutline=s.first),_i(s=yi())&&(h._lineRipple=s.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(l,h){l&2&&wi("mat-mdc-form-field-label-always-float",h._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",h._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",h._hasIconSuffix)("mat-form-field-invalid",h._control.errorState)("mat-form-field-disabled",h._control.disabled)("mat-form-field-autofilled",h._control.autofilled)("mat-form-field-no-animations",h._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",h.appearance=="fill")("mat-form-field-appearance-outline",h.appearance=="outline")("mat-form-field-hide-placeholder",h._hasFloatingLabel()&&!h._shouldLabelFloat())("mat-focused",h._control.focused)("mat-primary",h.color!=="accent"&&h.color!=="warn")("mat-accent",h.color==="accent")("mat-warn",h.color==="warn")("ng-untouched",h._shouldForward("untouched"))("ng-touched",h._shouldForward("touched"))("ng-pristine",h._shouldForward("pristine"))("ng-dirty",h._shouldForward("dirty"))("ng-valid",h._shouldForward("valid"))("ng-invalid",h._shouldForward("invalid"))("ng-pending",h._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Un([{provide:By,useExisting:c},{provide:CC,useExisting:c}])],ngContentSelectors:TP,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],["textSuffixContainer",""],["iconSuffixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(l,h){if(l&1){let s=Li();Er(SP),it(0,PP,1,1,"ng-template",null,0,Lf),V(2,"div",6,1),_t("click",function(Y){return $t(s),Gt(h._control.onContainerClick(Y))}),it(4,kP,1,0,"div",7),V(5,"div",8),it(6,RP,2,2,"div",9)(7,OP,3,0,"div",10)(8,FP,3,0,"div",11),V(9,"div",12),it(10,zP,1,1,null,13),zi(11),$(),it(12,BP,3,0,"div",14)(13,NP,3,0,"div",15),$(),it(14,VP,1,0,"div",16),$(),V(15,"div",17),it(16,jP,2,1,"div",18)(17,$P,5,2,"div",19),$()}if(l&2){let s;_e(2),wi("mdc-text-field--filled",!h._hasOutline())("mdc-text-field--outlined",h._hasOutline())("mdc-text-field--no-label",!h._hasFloatingLabel())("mdc-text-field--disabled",h._control.disabled)("mdc-text-field--invalid",h._control.errorState),_e(2),sn(!h._hasOutline()&&!h._control.disabled?4:-1),_e(2),sn(h._hasOutline()?6:-1),_e(),sn(h._hasIconPrefix?7:-1),_e(),sn(h._hasTextPrefix?8:-1),_e(2),sn(!h._hasOutline()||h._forceDisplayInfixLabel()?10:-1),_e(2),sn(h._hasTextSuffix?12:-1),_e(),sn(h._hasIconSuffix?13:-1),_e(),sn(h._hasOutline()?-1:14),_e(),wi("mat-mdc-form-field-subscript-dynamic-size",h.subscriptSizing==="dynamic"),_e(),sn((s=h._getDisplayedMessages())==="error"?16:s==="hint"?17:-1)}},dependencies:[_C,bC,Vf,vC,gC],styles:['.mdc-text-field{display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field__input{width:100%;min-width:0;border:none;border-radius:0;background:none;padding:0;-moz-appearance:none;-webkit-appearance:none;height:28px}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input::placeholder{opacity:0}.mdc-text-field__input::-moz-placeholder{opacity:0}.mdc-text-field__input::-webkit-input-placeholder{opacity:0}.mdc-text-field__input:-ms-input-placeholder{opacity:0}.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-moz-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-webkit-input-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive:-ms-input-placeholder{opacity:0}.mdc-text-field--outlined .mdc-text-field__input,.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-filled-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-outlined-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}}.mdc-text-field--filled{height:56px;border-bottom-right-radius:0;border-bottom-left-radius:0;border-top-left-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small));border-top-right-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color, var(--mat-sys-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 4%, transparent))}.mdc-text-field--outlined{height:56px;overflow:visible;padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)));padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px)}[dir=rtl] .mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px);padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}.mdc-floating-label{position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:auto}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:auto;right:4px}.mdc-text-field--filled .mdc-floating-label{left:16px;right:auto}[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:auto;right:16px}.mdc-text-field--disabled .mdc-floating-label{cursor:default}@media(forced-colors: active){.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-filled-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-filled-text-field-hover-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-filled-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-filled-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-filled-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-filled-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-filled-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-filled-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-outlined-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-outlined-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-outlined-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-outlined-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-outlined-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-outlined-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-floating-label--float-above{cursor:auto;transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1);font-size:.75rem}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mat-mdc-notch-piece{box-sizing:border-box;height:100%;pointer-events:none;border-top:1px solid;border-bottom:1px solid}.mdc-text-field--focused .mat-mdc-notch-piece{border-width:2px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-outline-color, var(--mat-sys-outline));border-width:var(--mdc-outlined-text-field-outline-width, 1px)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-hover-outline-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-focus-outline-color, var(--mat-sys-primary))}.mdc-text-field--outlined.mdc-text-field--disabled .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-notched-outline .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-hover-outline-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-focus-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mat-mdc-notch-piece{border-width:var(--mdc-outlined-text-field-focus-outline-width, 2px)}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__trailing{flex-grow:1;border-left:none;border-right:1px solid;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:min(var(--mat-form-field-notch-max-width, 100%),100% - max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))*2)}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none;--mat-form-field-notch-max-width: 100%}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1;border-bottom-width:var(--mdc-filled-text-field-active-indicator-height, 1px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color, var(--mat-sys-on-surface))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color, var(--mat-sys-on-error-container))}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height, 2px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color, var(--mat-sys-primary))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color, var(--mat-sys-error))}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-text-field--disabled{pointer-events:none}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height, 56px);padding-top:var(--mat-form-field-filled-with-label-container-padding-top, 24px);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom, 8px)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding, 16px);padding-bottom:var(--mat-form-field-container-vertical-padding, 16px)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height, 56px)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height, 56px) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color, var(--mat-sys-error))}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-form-field-subscript-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-form-field-subscript-text-size, var(--mat-sys-body-small-size));letter-spacing:var(--mat-form-field-subscript-text-tracking, var(--mat-sys-body-small-tracking));font-weight:var(--mat-form-field-subscript-text-weight, var(--mat-sys-body-small-weight))}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color, var(--mat-sys-on-surface))}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity, 0)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color, var(--mat-sys-neutral10))}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color, color-mix(in srgb, var(--mat-sys-neutral10) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}@media(forced-colors: active){.mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}}@media(forced-colors: active){.mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-form-field-container-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-form-field-container-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-form-field-container-text-tracking, var(--mat-sys-body-large-tracking));font-weight:var(--mat-form-field-container-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color, var(--mat-sys-error))}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color, var(--mat-sys-on-error-container))}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color, var(--mat-sys-error))}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field-infix:has(textarea[cols]){width:auto}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-moz-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-webkit-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[WP.transitionMessages]},changeDetection:0})}return c})(),SC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un,w1,un]})}return c})();var JP=["trigger"],ek=["panel"],tk=[[["mat-select-trigger"]],"*"],ik=["mat-select-trigger","*"];function nk(c,a){if(c&1&&(V(0,"span",4),le(1),$()),c&2){let i=Je();_e(),Lt(i.placeholder)}}function rk(c,a){c&1&&zi(0)}function ok(c,a){if(c&1&&(V(0,"span",11),le(1),$()),c&2){let i=Je(2);_e(),Lt(i.triggerValue)}}function sk(c,a){if(c&1&&(V(0,"span",5),it(1,rk,1,0)(2,ok,2,1,"span",11),$()),c&2){let i=Je();_e(),sn(i.customTrigger?1:2)}}function ak(c,a){if(c&1){let i=Li();V(0,"div",12,1),_t("@transformPanel.done",function(h){$t(i);let s=Je();return Gt(s._panelDoneAnimatingStream.next(h.toState))})("keydown",function(h){$t(i);let s=Je();return Gt(s._handleKeydown(h))}),zi(2,1),$()}if(c&2){let i=Je();ox("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",i._getPanelTheme(),""),Ge("ngClass",i.panelClass)("@transformPanel","showing"),en("id",i.id+"-panel")("aria-multiselectable",i.multiple)("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby())}}var lk={transformPanelWrap:Vh("transformPanelWrap",[cu("* => void",xx("@transformPanel",[bx()],{optional:!0}))]),transformPanel:Vh("transformPanel",[Hf("void",Kc({opacity:0,transform:"scale(1, 0.8)"})),cu("void => showing",jh("120ms cubic-bezier(0, 0, 0.2, 1)",Kc({opacity:1,transform:"scale(1, 1)"}))),cu("* => void",jh("100ms linear",Kc({opacity:0})))])};var TC=new ct("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let c=me(ad);return()=>c.scrollStrategies.reposition()}});function ck(c){return()=>c.scrollStrategies.reposition()}var dk=new ct("MAT_SELECT_CONFIG"),uk={provide:TC,deps:[ad],useFactory:ck},hk=new ct("MatSelectTrigger"),Ny=class{source;value;constructor(a,i){this.source=a,this.value=i}},EC=(()=>{class c{_viewportRuler=me(zp);_changeDetectorRef=me(Ur);_elementRef=me(Ci);_dir=me(ta,{optional:!0});_idGenerator=me(Xo);_parentFormField=me(By,{optional:!0});ngControl=me(Wa,{self:!0,optional:!0});_liveAnnouncer=me(D1);_defaultOptions=me(dk,{optional:!0});_initialized=new Ut;options;optionGroups;customTrigger;_positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}];_scrollOptionIntoView(i){let l=this.options.toArray()[i];if(l){let h=this.panel.nativeElement,s=U1(i,this.options,this.optionGroups),T=l._getHostElement();i===0&&s===1?h.scrollTop=0:h.scrollTop=$1(T.offsetTop,T.offsetHeight,h.scrollTop,h.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(i){return new Ny(this,i)}_scrollStrategyFactory=me(TC);_panelOpen=!1;_compareWith=(i,l)=>i===l;_uid=this._idGenerator.getId("mat-select-");_triggerAriaLabelledBy=null;_previousControl;_destroy=new Ut;_errorStateTracker;stateChanges=new Ut;disableAutomaticLabeling=!0;userAriaDescribedBy;_selectionModel;_keyManager;_preferredOverlayOrigin;_overlayWidth;_onChange=()=>{};_onTouched=()=>{};_valueId=this._idGenerator.getId("mat-select-value-");_panelDoneAnimatingStream=new Ut;_scrollStrategy;_overlayPanelClass=this._defaultOptions?.overlayPanelClass||"";get focused(){return this._focused||this._panelOpen}_focused=!1;controlType="mat-select";trigger;panel;_overlayDir;panelClass;disabled=!1;disableRipple=!1;tabIndex=0;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._syncParentProperties()}_hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get placeholder(){return this._placeholder}set placeholder(i){this._placeholder=i,this.stateChanges.next()}_placeholder;get required(){return this._required??this.ngControl?.control?.hasValidator(Po.required)??!1}set required(i){this._required=i,this.stateChanges.next()}_required;get multiple(){return this._multiple}set multiple(i){this._selectionModel,this._multiple=i}_multiple=!1;disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1;get compareWith(){return this._compareWith}set compareWith(i){this._compareWith=i,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(i){this._assignValue(i)&&this._onChange(i)}_value;ariaLabel="";ariaLabelledby;get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(i){this._errorStateTracker.matcher=i}typeaheadDebounceInterval;sortComparator;get id(){return this._id}set id(i){this._id=i||this._uid,this.stateChanges.next()}_id;get errorState(){return this._errorStateTracker.errorState}set errorState(i){this._errorStateTracker.errorState=i}panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto";canSelectNullableOptions=this._defaultOptions?.canSelectNullableOptions??!1;optionSelectionChanges=Ph(()=>{let i=this.options;return i?i.changes.pipe(Ks(i),gr(()=>Nl(...i.map(l=>l.onSelectionChange)))):this._initialized.pipe(gr(()=>this.optionSelectionChanges))});openedChange=new xi;_openedStream=this.openedChange.pipe(vn(i=>i),kt(()=>{}));_closedStream=this.openedChange.pipe(vn(i=>!i),kt(()=>{}));selectionChange=new xi;valueChange=new xi;constructor(){let i=me(V1),l=me(iy,{optional:!0}),h=me(id,{optional:!0}),s=me(new Zc("tabindex"),{optional:!0});this.ngControl&&(this.ngControl.valueAccessor=this),this._defaultOptions?.typeaheadDebounceInterval!=null&&(this.typeaheadDebounceInterval=this._defaultOptions.typeaheadDebounceInterval),this._errorStateTracker=new Hm(i,this.ngControl,h,l,this.stateChanges),this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=s==null?0:parseInt(s)||0,this.id=this.id}ngOnInit(){this._selectionModel=new Au(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(kh(),An(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen)),this._viewportRuler.change().pipe(An(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(An(this._destroy)).subscribe(i=>{i.added.forEach(l=>l.select()),i.removed.forEach(l=>l.deselect())}),this.options.changes.pipe(Ks(null),An(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){let i=this._getTriggerAriaLabelledby(),l=this.ngControl;if(i!==this._triggerAriaLabelledBy){let h=this._elementRef.nativeElement;this._triggerAriaLabelledBy=i,i?h.setAttribute("aria-labelledby",i):h.removeAttribute("aria-labelledby")}l&&(this._previousControl!==l.control&&(this._previousControl!==void 0&&l.disabled!==null&&l.disabled!==this.disabled&&(this.disabled=l.disabled),this._previousControl=l.control),this.updateErrorState())}ngOnChanges(i){(i.disabled||i.userAriaDescribedBy)&&this.stateChanges.next(),i.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_trackedModal=null;_applyModalPanelOwnership(){let i=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!i)return;let l=`${this.id}-panel`;this._trackedModal&&hy(this._trackedModal,"aria-owns",l),P1(i,"aria-owns",l),this._trackedModal=i}_clearFromModal(){if(!this._trackedModal)return;let i=`${this.id}-panel`;hy(this._trackedModal,"aria-owns",i),this._trackedModal=null}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next())}writeValue(i){this._assignValue(i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){let i=this._selectionModel.selected.map(l=>l.viewValue);return this._isRtl()&&i.reverse(),i.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return this._dir?this._dir.value==="rtl":!1}_handleKeydown(i){this.disabled||(this.panelOpen?this._handleOpenKeydown(i):this._handleClosedKeydown(i))}_handleClosedKeydown(i){let l=i.keyCode,h=l===40||l===38||l===37||l===39,s=l===13||l===32,T=this._keyManager;if(!T.isTyping()&&s&&!Ya(i)||(this.multiple||i.altKey)&&h)i.preventDefault(),this.open();else if(!this.multiple){let Y=this.selected;T.onKeydown(i);let K=this.selected;K&&Y!==K&&this._liveAnnouncer.announce(K.viewValue,1e4)}}_handleOpenKeydown(i){let l=this._keyManager,h=i.keyCode,s=h===40||h===38,T=l.isTyping();if(s&&i.altKey)i.preventDefault(),this.close();else if(!T&&(h===13||h===32)&&l.activeItem&&!Ya(i))i.preventDefault(),l.activeItem._selectViaInteraction();else if(!T&&this._multiple&&h===65&&i.ctrlKey){i.preventDefault();let Y=this.options.some(K=>!K.disabled&&!K.selected);this.options.forEach(K=>{K.disabled||(Y?K.select():K.deselect())})}else{let Y=l.activeItemIndex;l.onKeydown(i),this._multiple&&s&&i.shiftKey&&l.activeItem&&l.activeItemIndex!==Y&&l.activeItem._selectViaInteraction()}}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(xo(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(i){if(this.options.forEach(l=>l.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&i)Array.isArray(i),i.forEach(l=>this._selectOptionByValue(l)),this._sortValues();else{let l=this._selectOptionByValue(i);l?this._keyManager.updateActiveItem(l):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(i){let l=this.options.find(h=>{if(this._selectionModel.isSelected(h))return!1;try{return(h.value!=null||this.canSelectNullableOptions)&&this._compareWith(h.value,i)}catch{return!1}});return l&&this._selectionModel.select(l),l}_assignValue(i){return i!==this._value||this._multiple&&Array.isArray(i)?(this.options&&this._setSelectionByValue(i),this._value=i,!0):!1}_skipPredicate=i=>this.panelOpen?!1:i.disabled;_getOverlayWidth(i){return this.panelWidth==="auto"?(i instanceof Vp?i.elementRef:i||this._elementRef).nativeElement.getBoundingClientRect().width:this.panelWidth===null?"":this.panelWidth}_syncParentProperties(){if(this.options)for(let i of this.options)i._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new Um(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){let i=Nl(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(An(i)).subscribe(l=>{this._onSelect(l.source,l.isUserInput),l.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Nl(...this.options.map(l=>l._stateChanges)).pipe(An(i)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(i,l){let h=this._selectionModel.isSelected(i);!this.canSelectNullableOptions&&i.value==null&&!this._multiple?(i.deselect(),this._selectionModel.clear(),this.value!=null&&this._propagateChanges(i.value)):(h!==i.selected&&(i.selected?this._selectionModel.select(i):this._selectionModel.deselect(i)),l&&this._keyManager.setActiveItem(i),this.multiple&&(this._sortValues(),l&&this.focus())),h!==this._selectionModel.isSelected(i)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){let i=this.options.toArray();this._selectionModel.sort((l,h)=>this.sortComparator?this.sortComparator(l,h,i):i.indexOf(l)-i.indexOf(h)),this.stateChanges.next()}}_propagateChanges(i){let l;this.multiple?l=this.selected.map(h=>h.value):l=this.selected?this.selected.value:i,this._value=l,this.valueChange.emit(l),this._onChange(l),this.selectionChange.emit(this._getChangeEvent(l)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let i=-1;for(let l=0;l<this.options.length;l++)if(!this.options.get(l).disabled){i=l;break}this._keyManager.setActiveItem(i)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(i){this._elementRef.nativeElement.focus(i)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId()||null,l=i?i+" ":"";return this.ariaLabelledby?l+this.ariaLabelledby:i}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId(),l=(i?i+" ":"")+this._valueId;return this.ariaLabelledby&&(l+=" "+this.ariaLabelledby),l}_panelDoneAnimating(i){this.openedChange.emit(i)}setDescribedByIds(i){i.length?this._elementRef.nativeElement.setAttribute("aria-describedby",i.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-select"]],contentQueries:function(l,h,s){if(l&1&&(io(s,hk,5),io(s,Wm,5),io(s,xy,5)),l&2){let T;_i(T=yi())&&(h.customTrigger=T.first),_i(T=yi())&&(h.options=T),_i(T=yi())&&(h.optionGroups=T)}},viewQuery:function(l,h){if(l&1&&(an(JP,5),an(ek,5),an(Fy,5)),l&2){let s;_i(s=yi())&&(h.trigger=s.first),_i(s=yi())&&(h.panel=s.first),_i(s=yi())&&(h._overlayDir=s.first)}},hostAttrs:["role","combobox","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(l,h){l&1&&_t("keydown",function(T){return h._handleKeydown(T)})("focus",function(){return h._onFocus()})("blur",function(){return h._onBlur()}),l&2&&(en("id",h.id)("tabindex",h.disabled?-1:h.tabIndex)("aria-controls",h.panelOpen?h.id+"-panel":null)("aria-expanded",h.panelOpen)("aria-label",h.ariaLabel||null)("aria-required",h.required.toString())("aria-disabled",h.disabled.toString())("aria-invalid",h.errorState)("aria-activedescendant",h._getAriaActiveDescendant()),wi("mat-mdc-select-disabled",h.disabled)("mat-mdc-select-invalid",h.errorState)("mat-mdc-select-required",h.required)("mat-mdc-select-empty",h.empty)("mat-mdc-select-multiple",h.multiple))},inputs:{userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[2,"disabled","disabled",pi],disableRipple:[2,"disableRipple","disableRipple",pi],tabIndex:[2,"tabIndex","tabIndex",i=>i==null?0:Xc(i)],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",pi],placeholder:"placeholder",required:[2,"required","required",pi],multiple:[2,"multiple","multiple",pi],disableOptionCentering:[2,"disableOptionCentering","disableOptionCentering",pi],compareWith:"compareWith",value:"value",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[2,"typeaheadDebounceInterval","typeaheadDebounceInterval",Xc],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth",canSelectNullableOptions:[2,"canSelectNullableOptions","canSelectNullableOptions",pi]},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Un([{provide:zy,useExisting:c},{provide:by,useExisting:c}]),or,Ho],ngContentSelectors:ik,decls:11,vars:8,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","attach","detach","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(l,h){if(l&1){let s=Li();Er(tk),V(0,"div",2,0),_t("click",function(){return $t(s),Gt(h.open())}),V(3,"div",3),it(4,nk,2,1,"span",4)(5,sk,3,1,"span",5),$(),V(6,"div",6)(7,"div",7),Dh(),V(8,"svg",8),Pe(9,"path",9),$()()()(),it(10,ak,3,9,"ng-template",10),_t("backdropClick",function(){return $t(s),Gt(h.close())})("attach",function(){return $t(s),Gt(h._onAttached())})("detach",function(){return $t(s),Gt(h.close())})}if(l&2){let s=Ua(1);_e(3),en("id",h._valueId),_e(),sn(h.empty?4:5),_e(6),Ge("cdkConnectedOverlayPanelClass",h._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",h._scrollStrategy)("cdkConnectedOverlayOrigin",h._preferredOverlayOrigin||s)("cdkConnectedOverlayOpen",h.panelOpen)("cdkConnectedOverlayPositions",h._positions)("cdkConnectedOverlayWidth",h._overlayWidth)}},dependencies:[Vp,Fy,gx],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color, var(--mat-sys-on-surface));font-family:var(--mat-select-trigger-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-select-trigger-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-select-trigger-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-select-trigger-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-select-trigger-text-tracking, var(--mat-sys-body-large-tracking))}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color, var(--mat-sys-error))}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color, var(--mat-sys-on-surface-variant))}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}@media(forced-colors: active){.mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .mat-mdc-select-arrow svg{fill:GrayText}}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-select-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color, var(--mat-sys-on-surface-variant))}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform, translateY(-8px))}'],encapsulation:2,data:{animation:[lk.transformPanel]},changeDetection:0})}return c})();var IC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({providers:[uk],imports:[fC,wy,un,hg,SC,wy,un]})}return c})();var PC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un,Fp]})}return c})();var fk=["button"],mk=["*"];function gk(c,a){if(c&1&&(V(0,"div",2),Pe(1,"mat-pseudo-checkbox",6),$()),c&2){let i=Je();_e(),Ge("disabled",i.disabled)}}var kC=new ct("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS",{providedIn:"root",factory:_k});function _k(){return{hideSingleSelectionIndicator:!1,hideMultipleSelectionIndicator:!1,disabledInteractive:!1}}var AC=new ct("MatButtonToggleGroup"),yk={provide:ec,useExisting:$o(()=>Vy),multi:!0},yg=class{source;value;constructor(a,i){this.source=a,this.value=i}},Vy=(()=>{class c{_changeDetector=me(Ur);_dir=me(ta,{optional:!0});_multiple=!1;_disabled=!1;_disabledInteractive=!1;_selectionModel;_rawValue;_controlValueAccessorChangeFn=()=>{};_onTouched=()=>{};_buttonToggles;appearance;get name(){return this._name}set name(i){this._name=i,this._markButtonsForCheck()}_name=me(Xo).getId("mat-button-toggle-group-");vertical;get value(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i.map(l=>l.value):i[0]?i[0].value:void 0}set value(i){this._setSelectionByValue(i),this.valueChange.emit(this.value)}valueChange=new xi;get selected(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i:i[0]||null}get multiple(){return this._multiple}set multiple(i){this._multiple=i,this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(i){this._disabled=i,this._markButtonsForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(i){this._disabledInteractive=i,this._markButtonsForCheck()}get dir(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}change=new xi;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._markButtonsForCheck()}_hideSingleSelectionIndicator;get hideMultipleSelectionIndicator(){return this._hideMultipleSelectionIndicator}set hideMultipleSelectionIndicator(i){this._hideMultipleSelectionIndicator=i,this._markButtonsForCheck()}_hideMultipleSelectionIndicator;constructor(){let i=me(kC,{optional:!0});this.appearance=i&&i.appearance?i.appearance:"standard",this.hideSingleSelectionIndicator=i?.hideSingleSelectionIndicator??!1,this.hideMultipleSelectionIndicator=i?.hideMultipleSelectionIndicator??!1}ngOnInit(){this._selectionModel=new Au(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(i=>i.checked)),this.multiple||this._initializeTabIndex()}writeValue(i){this.value=i,this._changeDetector.markForCheck()}registerOnChange(i){this._controlValueAccessorChangeFn=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i}_keydown(i){if(this.multiple||this.disabled)return;let h=i.target.id,s=this._buttonToggles.toArray().findIndex(Y=>Y.buttonId===h),T=null;switch(i.keyCode){case 32:case 13:T=this._buttonToggles.get(s)||null;break;case 38:T=this._getNextButton(s,-1);break;case 37:T=this._getNextButton(s,this.dir==="ltr"?-1:1);break;case 40:T=this._getNextButton(s,1);break;case 39:T=this._getNextButton(s,this.dir==="ltr"?1:-1);break;default:return}T&&(i.preventDefault(),T._onButtonClick(),T.focus())}_emitChangeEvent(i){let l=new yg(i,this.value);this._rawValue=l.value,this._controlValueAccessorChangeFn(l.value),this.change.emit(l)}_syncButtonToggle(i,l,h=!1,s=!1){!this.multiple&&this.selected&&!i.checked&&(this.selected.checked=!1),this._selectionModel?l?this._selectionModel.select(i):this._selectionModel.deselect(i):s=!0,s?Promise.resolve().then(()=>this._updateModelValue(i,h)):this._updateModelValue(i,h)}_isSelected(i){return this._selectionModel&&this._selectionModel.isSelected(i)}_isPrechecked(i){return typeof this._rawValue>"u"?!1:this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(l=>i.value!=null&&l===i.value):i.value===this._rawValue}_initializeTabIndex(){if(this._buttonToggles.forEach(i=>{i.tabIndex=-1}),this.selected)this.selected.tabIndex=0;else for(let i=0;i<this._buttonToggles.length;i++){let l=this._buttonToggles.get(i);if(!l.disabled){l.tabIndex=0;break}}this._markButtonsForCheck()}_getNextButton(i,l){let h=this._buttonToggles;for(let s=1;s<=h.length;s++){let T=(i+l*s+h.length)%h.length,Y=h.get(T);if(Y&&!Y.disabled)return Y}return null}_setSelectionByValue(i){if(this._rawValue=i,!this._buttonToggles)return;let l=this._buttonToggles.toArray();if(this.multiple&&i?(Array.isArray(i),this._clearSelection(),i.forEach(h=>this._selectValue(h,l))):(this._clearSelection(),this._selectValue(i,l)),!this.multiple&&l.every(h=>h.tabIndex===-1)){for(let h of l)if(!h.disabled){h.tabIndex=0;break}}}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(i=>{i.checked=!1,this.multiple||(i.tabIndex=-1)})}_selectValue(i,l){for(let h of l)if(h.value!=null&&h.value===i){h.checked=!0,this._selectionModel.select(h),this.multiple||(h.tabIndex=0);break}}_updateModelValue(i,l){l&&this._emitChangeEvent(i),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(i=>i._markForCheck())}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Wt({type:c,selectors:[["mat-button-toggle-group"]],contentQueries:function(l,h,s){if(l&1&&io(s,vg,5),l&2){let T;_i(T=yi())&&(h._buttonToggles=T)}},hostAttrs:[1,"mat-button-toggle-group"],hostVars:6,hostBindings:function(l,h){l&1&&_t("keydown",function(T){return h._keydown(T)}),l&2&&(en("role",h.multiple?"group":"radiogroup")("aria-disabled",h.disabled),wi("mat-button-toggle-vertical",h.vertical)("mat-button-toggle-group-appearance-standard",h.appearance==="standard"))},inputs:{appearance:"appearance",name:"name",vertical:[2,"vertical","vertical",pi],value:"value",multiple:[2,"multiple","multiple",pi],disabled:[2,"disabled","disabled",pi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",pi],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",pi],hideMultipleSelectionIndicator:[2,"hideMultipleSelectionIndicator","hideMultipleSelectionIndicator",pi]},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[Un([yk,{provide:AC,useExisting:c}]),or]})}return c})(),vg=(()=>{class c{_changeDetectorRef=me(Ur);_elementRef=me(Ci);_focusMonitor=me(R1);_idGenerator=me(Xo);_animationMode=me(wo,{optional:!0});_checked=!1;ariaLabel;ariaLabelledby=null;_buttonElement;buttonToggleGroup;get buttonId(){return`${this.id}-button`}id;name;value;get tabIndex(){return this._tabIndex}set tabIndex(i){i!==this._tabIndex&&(this._tabIndex=i,this._markForCheck())}_tabIndex;disableRipple;get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(i){this._appearance=i}_appearance;get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(i){i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(i){this._disabled=i}_disabled=!1;get disabledInteractive(){return this._disabledInteractive||this.buttonToggleGroup!==null&&this.buttonToggleGroup.disabledInteractive}set disabledInteractive(i){this._disabledInteractive=i}_disabledInteractive;change=new xi;constructor(){me(Xa).load(Zm);let i=me(AC,{optional:!0}),l=me(new Zc("tabindex"),{optional:!0})||"",h=me(kC,{optional:!0});this._tabIndex=parseInt(l)||0,this.buttonToggleGroup=i,this.appearance=h&&h.appearance?h.appearance:"standard",this.disabledInteractive=h?.disabledInteractive??!1}ngOnInit(){let i=this.buttonToggleGroup;this.id=this.id||this._idGenerator.getId("mat-button-toggle-"),i&&(i._isPrechecked(this)?this.checked=!0:i._isSelected(this)!==this._checked&&i._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._animationMode!=="NoopAnimations"&&this._elementRef.nativeElement.classList.add("mat-button-toggle-animations-enabled"),this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){let i=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),i&&i._isSelected(this)&&i._syncButtonToggle(this,!1,!1,!0)}focus(i){this._buttonElement.nativeElement.focus(i)}_onButtonClick(){if(this.disabled)return;let i=this.isSingleSelector()?!0:!this._checked;if(i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.isSingleSelector()){let l=this.buttonToggleGroup._buttonToggles.find(h=>h.tabIndex===0);l&&(l.tabIndex=-1),this.tabIndex=0}this.change.emit(new yg(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this.isSingleSelector()?this.buttonToggleGroup.name:this.name||null}isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-button-toggle"]],viewQuery:function(l,h){if(l&1&&an(fk,5),l&2){let s;_i(s=yi())&&(h._buttonElement=s.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:14,hostBindings:function(l,h){l&1&&_t("focus",function(){return h.focus()}),l&2&&(en("aria-label",null)("aria-labelledby",null)("id",h.id)("name",null),wi("mat-button-toggle-standalone",!h.buttonToggleGroup)("mat-button-toggle-checked",h.checked)("mat-button-toggle-disabled",h.disabled)("mat-button-toggle-disabled-interactive",h.disabledInteractive)("mat-button-toggle-appearance-standard",h.appearance==="standard"))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",disableRipple:[2,"disableRipple","disableRipple",pi],appearance:"appearance",checked:[2,"checked","checked",pi],disabled:[2,"disabled","disabled",pi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",pi]},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[or],ngContentSelectors:mk,decls:7,vars:13,consts:[["button",""],["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"click","id","disabled"],[1,"mat-button-toggle-checkbox-wrapper"],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"],["state","checked","aria-hidden","true","appearance","minimal",3,"disabled"]],template:function(l,h){if(l&1){let s=Li();Er(),V(0,"button",1,0),_t("click",function(){return $t(s),Gt(h._onButtonClick())}),it(2,gk,2,1,"div",2),V(3,"span",3),zi(4),$()(),Pe(5,"span",4)(6,"span",5)}if(l&2){let s=Ua(1);Ge("id",h.buttonId)("disabled",h.disabled&&!h.disabledInteractive||null),en("role",h.isSingleSelector()?"radio":"button")("tabindex",h.disabled&&!h.disabledInteractive?-1:h.tabIndex)("aria-pressed",h.isSingleSelector()?null:h.checked)("aria-checked",h.isSingleSelector()?h.checked:null)("name",h._getButtonName())("aria-label",h.ariaLabel)("aria-labelledby",h.ariaLabelledby)("aria-disabled",h.disabled&&h.disabledInteractive?"true":null),_e(2),sn(h.buttonToggleGroup&&(!h.buttonToggleGroup.multiple&&!h.buttonToggleGroup.hideSingleSelectionIndicator||h.buttonToggleGroup.multiple&&!h.buttonToggleGroup.hideMultipleSelectionIndicator)?2:-1),_e(4),Ge("matRippleTrigger",s)("matRippleDisabled",h.disableRipple||h.disabled)}},dependencies:[qm,vy],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0);border-radius:var(--mat-legacy-button-toggle-shape)}.mat-button-toggle-standalone:not([class*=mat-elevation-z]),.mat-button-toggle-group:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}@media(forced-colors: active){.mat-button-toggle-standalone,.mat-button-toggle-group{outline:solid 1px}}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full));border:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard .mat-pseudo-checkbox,.mat-button-toggle-group-appearance-standard .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-standard-button-toggle-selected-state-text-color, var(--mat-sys-on-secondary-container))}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard:not([class*=mat-elevation-z]),.mat-button-toggle-group-appearance-standard:not([class*=mat-elevation-z]){box-shadow:none}@media(forced-colors: active){.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{outline:0}}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative;color:var(--mat-legacy-button-toggle-text-color);font-family:var(--mat-legacy-button-toggle-label-text-font);font-size:var(--mat-legacy-button-toggle-label-text-size);line-height:var(--mat-legacy-button-toggle-label-text-line-height);font-weight:var(--mat-legacy-button-toggle-label-text-weight);letter-spacing:var(--mat-legacy-button-toggle-label-text-tracking);--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-legacy-button-toggle-selected-state-text-color)}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-legacy-button-toggle-focus-state-layer-opacity)}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle-checkbox-wrapper{display:inline-block;justify-content:flex-start;align-items:center;width:0;height:18px;line-height:18px;overflow:hidden;box-sizing:border-box;position:absolute;top:50%;left:16px;transform:translate3d(0, -50%, 0)}[dir=rtl] .mat-button-toggle-checkbox-wrapper{left:auto;right:16px}.mat-button-toggle-appearance-standard .mat-button-toggle-checkbox-wrapper{left:12px}[dir=rtl] .mat-button-toggle-appearance-standard .mat-button-toggle-checkbox-wrapper{left:auto;right:12px}.mat-button-toggle-checked .mat-button-toggle-checkbox-wrapper{width:18px}.mat-button-toggle-animations-enabled .mat-button-toggle-checkbox-wrapper{transition:width 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-button-toggle-vertical .mat-button-toggle-checkbox-wrapper{transition:none}.mat-button-toggle-checked{color:var(--mat-legacy-button-toggle-selected-state-text-color);background-color:var(--mat-legacy-button-toggle-selected-state-background-color)}.mat-button-toggle-disabled{pointer-events:none;color:var(--mat-legacy-button-toggle-disabled-state-text-color);background-color:var(--mat-legacy-button-toggle-disabled-state-background-color);--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var(--mat-legacy-button-toggle-disabled-state-text-color)}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:var(--mat-legacy-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-disabled-interactive{pointer-events:auto}.mat-button-toggle-appearance-standard{color:var(--mat-standard-button-toggle-text-color, var(--mat-sys-on-surface));background-color:var(--mat-standard-button-toggle-background-color, transparent);font-family:var(--mat-standard-button-toggle-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-standard-button-toggle-label-text-size, var(--mat-sys-label-large-size));line-height:var(--mat-standard-button-toggle-label-text-line-height, var(--mat-sys-label-large-line-height));font-weight:var(--mat-standard-button-toggle-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mat-standard-button-toggle-label-text-tracking, var(--mat-sys-label-large-tracking))}.mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}[dir=rtl] .mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:none;border-top:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-appearance-standard.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-selected-state-text-color, var(--mat-sys-on-secondary-container));background-color:var(--mat-standard-button-toggle-selected-state-background-color, var(--mat-sys-secondary-container))}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled{color:var(--mat-standard-button-toggle-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-standard-button-toggle-disabled-state-background-color, transparent)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var(--mat-standard-button-toggle-disabled-selected-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-disabled-selected-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-standard-button-toggle-disabled-selected-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{background-color:var(--mat-standard-button-toggle-state-layer-color, var(--mat-sys-on-surface))}.mat-button-toggle-appearance-standard:hover .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-button-toggle-appearance-standard.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}@media(hover: none){.mat-button-toggle-appearance-standard:hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;padding:0 16px;line-height:var(--mat-legacy-button-toggle-height);position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px;line-height:var(--mat-standard-button-toggle-height, 40px)}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0;background-color:var(--mat-legacy-button-toggle-state-layer-color)}@media(forced-colors: active){.mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 500px;opacity:.5;height:0}.mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-animations-enabled .mat-button-toggle-button{transition:padding 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-button-toggle-vertical .mat-button-toggle-button{transition:none}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}.mat-button-toggle-checked .mat-button-toggle-button:has(.mat-button-toggle-checkbox-wrapper){padding-left:30px}[dir=rtl] .mat-button-toggle-checked .mat-button-toggle-button:has(.mat-button-toggle-checkbox-wrapper){padding-left:0;padding-right:30px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard{--mat-focus-indicator-border-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full))}.mat-button-toggle-group-appearance-standard .mat-button-toggle:last-of-type .mat-button-toggle-button::before{border-top-right-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full));border-bottom-right-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full))}.mat-button-toggle-group-appearance-standard .mat-button-toggle:first-of-type .mat-button-toggle-button::before{border-top-left-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full));border-bottom-left-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full))}"],encapsulation:2,changeDetection:0})}return c})(),DC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un,Fp,vg,un]})}return c})();var bk=["determinateSpinner"];function xk(c,a){if(c&1&&(Dh(),V(0,"svg",11),Pe(1,"circle",12),$()),c&2){let i=Je();en("viewBox",i._viewBox()),_e(),Vr("stroke-dasharray",i._strokeCircumference(),"px")("stroke-dashoffset",i._strokeCircumference()/2,"px")("stroke-width",i._circleStrokeWidth(),"%"),en("r",i._circleRadius())}}var wk=new ct("mat-progress-spinner-default-options",{providedIn:"root",factory:Ck});function Ck(){return{diameter:RC}}var RC=100,Mk=10,bg=(()=>{class c{_elementRef=me(Ci);_noopAnimations;get color(){return this._color||this._defaultColor}set color(i){this._color=i}_color;_defaultColor="primary";_determinateCircle;constructor(){let i=me(wo,{optional:!0}),l=me(wk);this._noopAnimations=i==="NoopAnimations"&&!!l&&!l._forceAnimations,this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",l&&(l.color&&(this.color=this._defaultColor=l.color),l.diameter&&(this.diameter=l.diameter),l.strokeWidth&&(this.strokeWidth=l.strokeWidth))}mode;get value(){return this.mode==="determinate"?this._value:0}set value(i){this._value=Math.max(0,Math.min(100,i||0))}_value=0;get diameter(){return this._diameter}set diameter(i){this._diameter=i||0}_diameter=RC;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(i){this._strokeWidth=i||0}_strokeWidth;_circleRadius(){return(this.diameter-Mk)/2}_viewBox(){let i=this._circleRadius()*2+this.strokeWidth;return`0 0 ${i} ${i}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(l,h){if(l&1&&an(bk,5),l&2){let s;_i(s=yi())&&(h._determinateCircle=s.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(l,h){l&2&&(en("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",h.mode==="determinate"?h.value:null)("mode",h.mode),Nh("mat-"+h.color),Vr("width",h.diameter,"px")("height",h.diameter,"px")("--mdc-circular-progress-size",h.diameter+"px")("--mdc-circular-progress-active-indicator-width",h.diameter+"px"),wi("_mat-animation-noopable",h._noopAnimations)("mdc-circular-progress--indeterminate",h.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",Xc],diameter:[2,"diameter","diameter",Xc],strokeWidth:[2,"strokeWidth","strokeWidth",Xc]},exportAs:["matProgressSpinner"],features:[or],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(l,h){if(l&1&&(it(0,xk,2,8,"ng-template",null,0,Lf),V(2,"div",2,1),Dh(),V(4,"svg",3),Pe(5,"circle",4),$()(),Gb(),V(6,"div",5)(7,"div",6)(8,"div",7),Of(9,8),$(),V(10,"div",9),Of(11,8),$(),V(12,"div",10),Of(13,8),$()()()),l&2){let s=Ua(1);_e(4),en("viewBox",h._viewBox()),_e(),Vr("stroke-dasharray",h._strokeCircumference(),"px")("stroke-dashoffset",h._strokeDashOffset(),"px")("stroke-width",h._circleStrokeWidth(),"%"),en("r",h._circleRadius()),_e(4),Ge("ngTemplateOutlet",s),_e(2),Ge("ngTemplateOutlet",s),_e(2),Ge("ngTemplateOutlet",s)}},dependencies:[Vf],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0})}return c})();var xg=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=qt({type:c});static \u0275inj=Zt({imports:[un]})}return c})();var Cg=I_($y());function Sk(c,a){c&1&&(V(0,"div",42),Pe(1,"mat-spinner"),V(2,"p"),le(3,"Cargando datos..."),$()())}function Tk(c,a){if(c&1){let i=Li();V(0,"div",43)(1,"mat-icon"),le(2,"error_outline"),$(),V(3,"p"),le(4,"Error al cargar los datos. Intente nuevamente."),$(),V(5,"button",44),_t("click",function(){$t(i);let h=Je();return Gt(h.fetchData())}),le(6,"Reintentar"),$()()}}function Ek(c,a){c&1&&(V(0,"div")(1,"div",45),Pe(2,"span",46),V(3,"span"),le(4,"0-30% acceso a internet"),$()(),V(5,"div",45),Pe(6,"span",47),V(7,"span"),le(8,"30-70% acceso a internet"),$()(),V(9,"div",45),Pe(10,"span",48),V(11,"span"),le(12,"70-100% acceso a internet"),$()()())}function Ik(c,a){c&1&&(V(0,"div")(1,"div",45),Pe(2,"span",49),V(3,"span"),le(4,"0-14 a\xF1os (bajo)"),$()(),V(5,"div",45),Pe(6,"span",50),V(7,"span"),le(8,"0-14 a\xF1os (medio)"),$()(),V(9,"div",45),Pe(10,"span",51),V(11,"span"),le(12,"0-14 a\xF1os (alto)"),$()()())}function Pk(c,a){c&1&&(V(0,"div")(1,"div",45),Pe(2,"span",52),V(3,"span"),le(4,"15-59 a\xF1os (bajo)"),$()(),V(5,"div",45),Pe(6,"span",53),V(7,"span"),le(8,"15-59 a\xF1os (medio)"),$()(),V(9,"div",45),Pe(10,"span",54),V(11,"span"),le(12,"15-59 a\xF1os (alto)"),$()()())}function kk(c,a){c&1&&(V(0,"div")(1,"div",45),Pe(2,"span",55),V(3,"span"),le(4,"60+ a\xF1os (bajo)"),$()(),V(5,"div",45),Pe(6,"span",56),V(7,"span"),le(8,"60+ a\xF1os (medio)"),$()(),V(9,"div",45),Pe(10,"span",57),V(11,"span"),le(12,"60+ a\xF1os (alto)"),$()()())}function Ak(c,a){c&1&&(V(0,"div")(1,"div",45),Pe(2,"span",58),V(3,"span"),le(4,"Educaci\xF3n Primaria (bajo)"),$()(),V(5,"div",45),Pe(6,"span",59),V(7,"span"),le(8,"Educaci\xF3n Primaria (medio)"),$()(),V(9,"div",45),Pe(10,"span",60),V(11,"span"),le(12,"Educaci\xF3n Primaria (alto)"),$()()())}function Dk(c,a){c&1&&(V(0,"div")(1,"div",45),Pe(2,"span",61),V(3,"span"),le(4,"Educaci\xF3n Secundaria (bajo)"),$()(),V(5,"div",45),Pe(6,"span",62),V(7,"span"),le(8,"Educaci\xF3n Secundaria (medio)"),$()(),V(9,"div",45),Pe(10,"span",63),V(11,"span"),le(12,"Educaci\xF3n Secundaria (alto)"),$()()())}function Rk(c,a){c&1&&(V(0,"div")(1,"div",45),Pe(2,"span",64),V(3,"span"),le(4,"Educaci\xF3n Superior (bajo)"),$()(),V(5,"div",45),Pe(6,"span",65),V(7,"span"),le(8,"Educaci\xF3n Superior (medio)"),$()(),V(9,"div",45),Pe(10,"span",66),V(11,"span"),le(12,"Educaci\xF3n Superior (alto)"),$()()())}function Ok(c,a){if(c&1&&(V(0,"mat-option",67),le(1),$()),c&2){let i=a.$implicit;Ge("value",i),_e(),Lt(i)}}function Fk(c,a){if(c&1&&(V(0,"mat-button-toggle",67),le(1),$()),c&2){let i=a.$implicit;Ge("value",i.value),_e(),Lt(i.label)}}function Lk(c,a){if(c&1&&(V(0,"mat-button-toggle",67),le(1),$()),c&2){let i=a.$implicit;Ge("value",i.value),_e(),Lt(i.label)}}function zk(c,a){if(c&1&&(V(0,"mat-card-subtitle"),le(1),$()),c&2){let i=Je();_e(),ln("Comuna: ",i.selectedComuna,"")}}function Bk(c,a){c&1&&(V(0,"mat-card-subtitle"),le(1,"Todas las comunas"),$())}function Nk(c,a){if(c&1&&(V(0,"div",32),Pe(1,"span",68),V(2,"span"),le(3),_r(4,"number"),$()()),c&2){let i=a.$implicit,l=Je();_e(),Vr("background-color",l.getAgeColor(i.value)),_e(2),Wc("",i.label,": ",jr(4,4,l.ageDistribution[i.value],"1.1-1"),"%")}}var wg=class c{constructor(a){this.http=a}map;data=[];popup=null;selectedFeature=null;isLoading=!0;error=!1;selectedComuna="";selectedAgeGroup="";selectedEducationLevel="";internetAccessFilter="all";zoomLevel=9;comunas=[];ageGroups=[{value:"0-14",label:"0-14 a\xF1os"},{value:"15-59",label:"15-59 a\xF1os"},{value:"60+",label:"60+ a\xF1os"}];educationLevels=[{value:"primary",label:"Primaria"},{value:"secondary",label:"Secundaria"},{value:"higher",label:"Superior"}];ngOnInit(){this.fetchData()}ngOnDestroy(){this.map&&this.map.remove(),this.popup&&this.popup.remove(),this.selectedFeature=null}get filteredData(){let a=this.data;return this.selectedComuna&&(a=a.filter(i=>i.nmb_lc_cm===this.selectedComuna)),this.internetAccessFilter==="high"?a=a.filter(i=>i.tp19_inte1/(i.tvivienda||1)>.7):this.internetAccessFilter==="low"&&(a=a.filter(i=>i.tp19_inte1/(i.tvivienda||1)<=.3)),a}get totalPopulation(){return this.filteredData.reduce((a,i)=>a+(i.tp27_perso||0),0)}get totalHomes(){return this.filteredData.reduce((a,i)=>a+(i.tvivienda||0),0)}get internetAccessPercentage(){let a=this.filteredData.reduce((l,h)=>l+(h.tp19_inte1||0),0),i=this.totalHomes||1;return a/i*100}get waterAccessPercentage(){let a=this.filteredData.reduce((l,h)=>l+(h.tp19_acu_1||0),0),i=this.totalHomes||1;return a/i*100}get gasAccessPercentage(){let a=this.filteredData.reduce((l,h)=>l+(h.tp19_gas_1||0),0),i=this.totalHomes||1;return a/i*100}get ageDistribution(){let a={"0-14":0,"15-59":0,"60+":0};this.filteredData.forEach(l=>{a["0-14"]+=(l.tp34_1_eda||0)+(l.tp34_2_eda||0)+(l.tp34_3_eda||0),a["15-59"]+=(l.tp34_4_eda||0)+(l.tp34_5_eda||0)+(l.tp34_6_eda||0),a["60+"]+=(l.tp34_7_eda||0)+(l.tp34_8_eda||0)+(l.tp34_9_eda||0)});let i=a["0-14"]+a["15-59"]+a["60+"]||1;return{"0-14":a["0-14"]/i*100,"15-59":a["15-59"]/i*100,"60+":a["60+"]/i*100}}get educationDistribution(){let a={primary:0,secondary:0,higher:0,other:0};this.filteredData.forEach(l=>{a.primary+=l.tp51primar||0,a.secondary+=l.tp51secund||0,a.higher+=l.tp51superi||0,a.other+=l.tp51_99_ed||0});let i=a.primary+a.secondary+a.higher+a.other||1;return{primary:a.primary/i*100,secondary:a.secondary/i*100,higher:a.higher/i*100,other:a.other/i*100}}fetchData(){this.isLoading=!0,this.error=!1,this.http.get("http://flask-fiware.apps.preprodalcaldia.medellin.gov.co/api/wifi-dane/all").subscribe({next:a=>{this.data=a,this.processData(),this.initMap(),this.isLoading=!1},error:a=>{console.error("Error fetching data:",a),this.error=!0,this.isLoading=!1}})}processData(){let a=new Set;this.data.forEach(i=>a.add(i.nmb_lc_cm)),this.comunas=Array.from(a).sort()}initMap(){this.map=new Cg.Map({container:"map",style:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[-75.5454,6.2512],zoom:this.zoomLevel}),this.map.on("load",()=>{this.addDataToMap()}),this.map.on("zoomend",()=>{this.zoomLevel=this.map.getZoom(),this.updateMapLayers()})}addDataToMap(){let a={type:"FeatureCollection",features:this.data.map((i,l)=>({type:"Feature",id:l,geometry:{type:"Point",coordinates:[i.longitud,i.latitud]},properties:si(Ye({},i),{populationDensity:(i.tp27_perso||0)/(i.area||1),internetAccess:(i.tp19_inte1||0)/(i.tvivienda||1)*100,waterAccess:(i.tp19_acu_1||0)/(i.tvivienda||1)*100,gasAccess:(i.tp19_gas_1||0)/(i.tvivienda||1)*100,educationPrimary:(i.tp51primar||0)/(i.tp27_perso||1)*100,educationSecondary:(i.tp51secund||0)/(i.tp27_perso||1)*100,educationHigher:(i.tp51superi||0)/(i.tp27_perso||1)*100,elderlyPercentage:(i.tp34_7_eda+i.tp34_8_eda+i.tp34_9_eda||0)/(i.tp27_perso||1)*100})}))};this.map.addSource("wifi-data",{type:"geojson",data:a,generateId:!0}),this.map.addLayer({id:"wifi-points",type:"circle",source:"wifi-data",paint:{"circle-radius":["interpolate",["linear"],["zoom"],10,6,15,12],"circle-color":["case",["boolean",["feature-state","selected"],!1],"#ff00ff",["interpolate",["linear"],["get","internetAccess"],0,"#ff0000",50,"#ffff00",100,"#00ff00"]],"circle-opacity":.9,"circle-stroke-width":["case",["boolean",["feature-state","selected"],!1],3,1],"circle-stroke-color":"#ffffff"}}),this.map.on("click","wifi-points",i=>{i.features&&i.features.length>0&&this.showPopup(i.features[0])}),this.map.on("click",i=>{this.map.queryRenderedFeatures(i.point,{layers:["wifi-points"]}).length===0&&this.popup&&(this.clearSelectedFeature(),this.popup.remove(),this.popup=null)}),this.map.on("mouseenter","wifi-points",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","wifi-points",()=>{this.map.getCanvas().style.cursor=""})}clearSelectedFeature(){this.selectedFeature&&(this.map.getLayer("wifi-points")&&this.map.setFeatureState({source:"wifi-data",id:this.selectedFeature.id},{selected:!1}),this.selectedFeature=null)}showPopup(a){if(this.clearSelectedFeature(),!a.geometry||!a.geometry.coordinates){console.error("Feature geometry is invalid:",a);return}this.selectedFeature=a,this.map.setFeatureState({source:"wifi-data",id:a.id},{selected:!0}),this.popup&&this.popup.remove();let i=a.properties||{},l=a.geometry.coordinates.slice(),h=`
    <div class="map-popup">
      <h4>Manzana ${i.cod_dane_a||"N/A"}</h4>
      <p><strong>Comuna:</strong> ${i.nmb_lc_cm||"N/A"}</p>
      <p><strong>Poblaci\xF3n:</strong> ${i.tp27_perso||"0"}</p>
      <p><strong>Densidad:</strong> ${(i.populationDensity||0).toFixed(2)} pers/m\xB2</p>
      <p><strong>Acceso a internet:</strong> ${(i.internetAccess||0).toFixed(1)}%</p>
      <p><strong>Acceso a agua:</strong> ${(i.waterAccess||0).toFixed(1)}%</p>
      <p><strong>Acceso a gas:</strong> ${(i.gasAccess||0).toFixed(1)}%</p>
      <p><strong>Adultos mayores (60+):</strong> ${(i.elderlyPercentage||0).toFixed(1)}%</p>
      <strong>Educaci\xF3n:</strong><br>
      - Primaria: ${(i.educationPrimary||0).toFixed(1)}%<br>
      - Secundaria: ${(i.educationSecondary||0).toFixed(1)}%<br>
      - Superior: ${(i.educationHigher||0).toFixed(1)}%
    </div>
  `;this.popup=new Cg.Popup({closeButton:!0,closeOnClick:!1,anchor:"bottom",offset:25}).setLngLat(l).setHTML(h).addTo(this.map),this.popup.on("close",()=>{this.clearSelectedFeature(),this.popup=null})}updateMapLayers(){if(!this.map.getLayer("wifi-points"))return;let a=["interpolate",["linear"],["get","internetAccess"],0,"#ff0000",50,"#ffff00",100,"#00ff00"];this.selectedAgeGroup==="0-14"?a=["interpolate",["linear"],["/",["+",["get","tp34_1_eda"],["get","tp34_2_eda"],["get","tp34_3_eda"]],["get","tp27_perso"]],0,"#ffebee",.5,"#ffcdd2",1,"#ef9a9a"]:this.selectedAgeGroup==="15-59"?a=["interpolate",["linear"],["/",["+",["get","tp34_4_eda"],["get","tp34_5_eda"],["get","tp34_6_eda"]],["get","tp27_perso"]],0,"#e8f5e9",.5,"#c8e6c9",1,"#a5d6a7"]:this.selectedAgeGroup==="60+"?a=["interpolate",["linear"],["/",["+",["get","tp34_7_eda"],["get","tp34_8_eda"],["get","tp34_9_eda"]],["get","tp27_perso"]],0,"#e3f2fd",.5,"#bbdefb",1,"#90caf9"]:this.selectedEducationLevel==="primary"?a=["interpolate",["linear"],["get","educationPrimary"],0,"#fff3e0",50,"#ffe0b2",100,"#ffcc80"]:this.selectedEducationLevel==="secondary"?a=["interpolate",["linear"],["get","educationSecondary"],0,"#f3e5f5",50,"#e1bee7",100,"#ce93d8"]:this.selectedEducationLevel==="higher"&&(a=["interpolate",["linear"],["get","educationHigher"],0,"#e0f7fa",50,"#b2ebf2",100,"#80deea"]),this.map.setPaintProperty("wifi-points","circle-color",a),this.selectedComuna?this.map.setFilter("wifi-points",["==",["get","nmb_lc_cm"],this.selectedComuna]):this.map.setFilter("wifi-points",null),this.map.setPaintProperty("wifi-points","circle-radius",["interpolate",["linear"],["zoom"],10,3,15,8])}applyFilters(){this.updateMapLayers()}resetFilters(){this.selectedComuna="",this.selectedAgeGroup="",this.selectedEducationLevel="",this.internetAccessFilter="all",this.applyFilters()}getAgeColor(a){switch(a){case"0-14":return"#ef9a9a";case"15-59":return"#a5d6a7";case"60+":return"#90caf9";default:return"#bdbdbd"}}static \u0275fac=function(i){return new(i||c)(Ft(ws))};static \u0275cmp=rt({type:c,selectors:[["app-wifi-maps"]],decls:143,vars:67,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],[1,"dashboard-container"],[1,"map-container"],["class","loading-overlay",4,"ngIf"],["class","error-overlay",4,"ngIf"],["id","map",1,"map"],[1,"map-legend"],[4,"ngIf"],[1,"controls-container"],[1,"filters-card"],[1,"filter-group"],["appearance","outline"],[3,"ngModelChange","selectionChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"ngModelChange","change","ngModel"],["value","all"],["value","high"],["value","low"],["mat-raised-button","","color","warn",3,"click"],[1,"stats-card"],[1,"stat-item"],[1,"charts-card"],[1,"chart-container"],[1,"chart-legend"],["class","chart-legend-item",4,"ngFor","ngForOf"],[1,"chart-bar"],[1,"chart-bar-segment",2,"background-color","#ef9a9a"],[1,"chart-bar-segment",2,"background-color","#a5d6a7"],[1,"chart-bar-segment",2,"background-color","#90caf9"],[1,"chart-legend-item"],[1,"chart-legend-color",2,"background-color","#ffcc80"],[1,"chart-legend-color",2,"background-color","#ce93d8"],[1,"chart-legend-color",2,"background-color","#80deea"],[1,"chart-legend-color",2,"background-color","#bdbdbd"],[1,"chart-bar-segment",2,"background-color","#ffcc80"],[1,"chart-bar-segment",2,"background-color","#ce93d8"],[1,"chart-bar-segment",2,"background-color","#80deea"],[1,"chart-bar-segment",2,"background-color","#bdbdbd"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/cd625ad1-09dd-4109-be18-34cffbf9ab79/medellin-dane-geomanzanas?orgId=1&kiosk`,"allowfullscreen","",1,"large-iframe"],[1,"loading-overlay"],[1,"error-overlay"],["mat-raised-button","","color","primary",3,"click"],[1,"legend-item"],[1,"legend-color",2,"background-color","#ff0000"],[1,"legend-color",2,"background-color","#ffff00"],[1,"legend-color",2,"background-color","#00ff00"],[1,"legend-color",2,"background-color","#ffebee"],[1,"legend-color",2,"background-color","#ffcdd2"],[1,"legend-color",2,"background-color","#ef9a9a"],[1,"legend-color",2,"background-color","#e8f5e9"],[1,"legend-color",2,"background-color","#c8e6c9"],[1,"legend-color",2,"background-color","#a5d6a7"],[1,"legend-color",2,"background-color","#e3f2fd"],[1,"legend-color",2,"background-color","#bbdefb"],[1,"legend-color",2,"background-color","#90caf9"],[1,"legend-color",2,"background-color","#fff3e0"],[1,"legend-color",2,"background-color","#ffe0b2"],[1,"legend-color",2,"background-color","#ffcc80"],[1,"legend-color",2,"background-color","#f3e5f5"],[1,"legend-color",2,"background-color","#e1bee7"],[1,"legend-color",2,"background-color","#ce93d8"],[1,"legend-color",2,"background-color","#e0f7fa"],[1,"legend-color",2,"background-color","#b2ebf2"],[1,"legend-color",2,"background-color","#80deea"],[3,"value"],[1,"chart-legend-color"]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Ciudad Inteligente - Puntos Wifi"),$(),V(2,"div",1),Pe(3,"div",2),$(),Pe(4,"div",1),V(5,"div",3)(6,"div",4),it(7,Sk,4,0,"div",5)(8,Tk,7,0,"div",6),Pe(9,"div",7),V(10,"div",8)(11,"h4"),le(12,"Leyenda"),$(),it(13,Ek,13,0,"div",9)(14,Ik,13,0,"div",9)(15,Pk,13,0,"div",9)(16,kk,13,0,"div",9)(17,Ak,13,0,"div",9)(18,Dk,13,0,"div",9)(19,Rk,13,0,"div",9),$()(),V(20,"div",10)(21,"mat-card",11)(22,"mat-card-header")(23,"mat-card-title"),le(24,"Filtros"),$()(),V(25,"mat-card-content")(26,"div",12)(27,"mat-form-field",13)(28,"mat-label"),le(29,"Comuna"),$(),V(30,"mat-select",14),To("ngModelChange",function(s){return So(l.selectedComuna,s)||(l.selectedComuna=s),s}),_t("selectionChange",function(){return l.applyFilters()}),V(31,"mat-option",15),le(32,"Todas las comunas"),$(),it(33,Ok,2,2,"mat-option",16),$()()(),V(34,"div",12)(35,"h4"),le(36,"Grupo etario"),$(),V(37,"mat-button-toggle-group",17),To("ngModelChange",function(s){return So(l.selectedAgeGroup,s)||(l.selectedAgeGroup=s),s}),_t("change",function(){return l.applyFilters()}),V(38,"mat-button-toggle",15),le(39,"Todos"),$(),it(40,Fk,2,2,"mat-button-toggle",16),$()(),V(41,"div",12)(42,"h4"),le(43,"Nivel educativo"),$(),V(44,"mat-button-toggle-group",17),To("ngModelChange",function(s){return So(l.selectedEducationLevel,s)||(l.selectedEducationLevel=s),s}),_t("change",function(){return l.applyFilters()}),V(45,"mat-button-toggle",15),le(46,"Todos"),$(),it(47,Lk,2,2,"mat-button-toggle",16),$()(),V(48,"div",12)(49,"h4"),le(50,"Acceso a internet"),$(),V(51,"mat-button-toggle-group",17),To("ngModelChange",function(s){return So(l.internetAccessFilter,s)||(l.internetAccessFilter=s),s}),_t("change",function(){return l.applyFilters()}),V(52,"mat-button-toggle",18),le(53,"Todos"),$(),V(54,"mat-button-toggle",19),le(55,"Alto (>70%)"),$(),V(56,"mat-button-toggle",20),le(57,"Bajo (\u226430%)"),$()()(),V(58,"div",12)(59,"button",21),_t("click",function(){return l.resetFilters()}),le(60,"Reiniciar filtros"),$()()()(),V(61,"mat-card",22)(62,"mat-card-header")(63,"mat-card-title"),le(64,"Estad\xEDsticas"),$(),it(65,zk,2,1,"mat-card-subtitle",9)(66,Bk,2,0,"mat-card-subtitle",9),$(),V(67,"mat-card-content")(68,"div",23)(69,"h4"),le(70,"Poblaci\xF3n total"),$(),V(71,"p"),le(72),_r(73,"number"),$()(),V(74,"div",23)(75,"h4"),le(76,"Viviendas totales"),$(),V(77,"p"),le(78),_r(79,"number"),$()(),V(80,"div",23)(81,"h4"),le(82,"Acceso a internet"),$(),V(83,"p"),le(84),_r(85,"number"),$()(),V(86,"div",23)(87,"h4"),le(88,"Acceso a agua potable"),$(),V(89,"p"),le(90),_r(91,"number"),$()(),V(92,"div",23)(93,"h4"),le(94,"Acceso a gas natural"),$(),V(95,"p"),le(96),_r(97,"number"),$()()()(),V(98,"mat-card",24)(99,"mat-card-header")(100,"mat-card-title"),le(101,"Distribuci\xF3n"),$()(),V(102,"mat-card-content")(103,"div",25)(104,"h4"),le(105,"Distribuci\xF3n por edad"),$(),V(106,"div",26),it(107,Nk,5,7,"div",27),$(),V(108,"div",28),Pe(109,"div",29)(110,"div",30)(111,"div",31),$()(),V(112,"div",25)(113,"h4"),le(114,"Nivel educativo"),$(),V(115,"div",26)(116,"div",32),Pe(117,"span",33),V(118,"span"),le(119),_r(120,"number"),$()(),V(121,"div",32),Pe(122,"span",34),V(123,"span"),le(124),_r(125,"number"),$()(),V(126,"div",32),Pe(127,"span",35),V(128,"span"),le(129),_r(130,"number"),$()(),V(131,"div",32),Pe(132,"span",36),V(133,"span"),le(134),_r(135,"number"),$()()(),V(136,"div",28),Pe(137,"div",37)(138,"div",38)(139,"div",39)(140,"div",40),$()()()()()(),V(141,"div",1),Pe(142,"iframe",41),$()),i&2&&(_e(7),Ge("ngIf",l.isLoading),_e(),Ge("ngIf",l.error),_e(5),Ge("ngIf",!l.selectedAgeGroup&&!l.selectedEducationLevel),_e(),Ge("ngIf",l.selectedAgeGroup==="0-14"),_e(),Ge("ngIf",l.selectedAgeGroup==="15-59"),_e(),Ge("ngIf",l.selectedAgeGroup==="60+"),_e(),Ge("ngIf",l.selectedEducationLevel==="primary"),_e(),Ge("ngIf",l.selectedEducationLevel==="secondary"),_e(),Ge("ngIf",l.selectedEducationLevel==="higher"),_e(11),Mo("ngModel",l.selectedComuna),_e(3),Ge("ngForOf",l.comunas),_e(4),Mo("ngModel",l.selectedAgeGroup),_e(3),Ge("ngForOf",l.ageGroups),_e(4),Mo("ngModel",l.selectedEducationLevel),_e(3),Ge("ngForOf",l.educationLevels),_e(4),Mo("ngModel",l.internetAccessFilter),_e(14),Ge("ngIf",l.selectedComuna),_e(),Ge("ngIf",!l.selectedComuna),_e(6),Lt(G_(73,42,l.totalPopulation)),_e(6),Lt(G_(79,44,l.totalHomes)),_e(6),ln("",jr(85,46,l.internetAccessPercentage,"1.1-1"),"%"),_e(6),ln("",jr(91,49,l.waterAccessPercentage,"1.1-1"),"%"),_e(6),ln("",jr(97,52,l.gasAccessPercentage,"1.1-1"),"%"),_e(11),Ge("ngForOf",l.ageGroups),_e(2),Vr("width",l.ageDistribution["0-14"],"%"),_e(),Vr("width",l.ageDistribution["15-59"],"%"),_e(),Vr("width",l.ageDistribution["60+"],"%"),_e(8),ln("Primaria: ",jr(120,55,l.educationDistribution.primary,"1.1-1"),"%"),_e(5),ln("Secundaria: ",jr(125,58,l.educationDistribution.secondary,"1.1-1"),"%"),_e(5),ln("Superior: ",jr(130,61,l.educationDistribution.higher,"1.1-1"),"%"),_e(5),ln("Otros: ",jr(135,64,l.educationDistribution.other,"1.1-1"),"%"),_e(3),Vr("width",l.educationDistribution.primary,"%"),_e(),Vr("width",l.educationDistribution.secondary,"%"),_e(),Vr("width",l.educationDistribution.higher,"%"),_e(),Vr("width",l.educationDistribution.other,"%"))},dependencies:[$r,Hl,Qs,Uf,Tu,ic,td,eC,X1,K1,J1,Q1,Y1,Wl,IC,MC,_g,EC,Wm,PC,oc,rc,DC,Vy,vg,xg,bg],styles:[".dashboard-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:70vw;height:70vh;margin-left:25%;overflow:hidden}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]{width:444px;background:#f5f5f5;padding:16px;overflow-y:auto;max-height:100vh;z-index:10;box-shadow:2px 0 6px #0000001a;flex-shrink:0}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{flex:1}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-weight:500;color:#0009;font-size:14px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{margin-bottom:24px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-legend[_ngcontent-%COMP%]{margin-bottom:8px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-legend[_ngcontent-%COMP%]   .chart-legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:4px;font-size:12px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-legend[_ngcontent-%COMP%]   .chart-legend-item[_ngcontent-%COMP%]   .chart-legend-color[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;margin-right:8px;border-radius:2px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-bar[_ngcontent-%COMP%]{height:20px;background:#e0e0e0;border-radius:4px;overflow:hidden;display:flex}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-bar[_ngcontent-%COMP%]   .chart-bar-segment[_ngcontent-%COMP%]{height:100%}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;align-items:stretch;justify-content:center}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:0}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   #map[_ngcontent-%COMP%]{width:100%;height:100%;min-height:500px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%], .dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .error-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffffff2;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .error-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:red;margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]{position:absolute;bottom:20px;right:20px;background:#fff;padding:10px;border-radius:4px;box-shadow:0 2px 4px #0003;z-index:10;max-width:250px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:4px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px;margin-right:8px;border-radius:50%;border:1px solid #ccc}.map-popup[_ngcontent-%COMP%]{max-width:300px}.map-popup[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#1976d2}.map-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:13px}","body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.small-iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.large-iframe[_ngcontent-%COMP%]{height:700px;border:none}"]})};var Mg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-vamosmedmap"]],decls:9,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740220806985&to=1740393606985&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740220846838&to=1740393646839&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740220882021&to=1740393682021&viewPanel=26&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740221071260&to=1740393871260&viewPanel=27&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Ciudad Inteligente - VamosMed"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),$()(),V(7,"div",1),Pe(8,"iframe",6),$())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var Gy=I_($y());var Vk=["map"];function jk(c,a){c&1&&(V(0,"div",28),le(1," Cargando sensores... "),$())}function Uk(c,a){if(c&1){let i=Li();V(0,"div",29),le(1),V(2,"button",30),_t("click",function(){$t(i);let h=Je();return Gt(h.loadSensors())}),le(3,"Reintentar"),$()()}if(c&2){let i=Je();_e(),ln(" ",i.errorMessage," ")}}function $k(c,a){if(c&1&&(V(0,"option",35),le(1),$()),c&2){let i=a.$implicit,l=Je(2);Ge("value",i.entity_id),_e(),Wc(" ",l.getShortId(i.entity_id)," - ",i.laeq_slow," dB ")}}function Gk(c,a){if(c&1&&(V(0,"div",36),le(1),$()),c&2){let i=Je(2);_e(),ln(" Sensor seleccionado: ",i.getShortId(i.selectedSensor)," ")}}function Hk(c,a){if(c&1){let i=Li();V(0,"div")(1,"select",31),To("ngModelChange",function(h){$t(i);let s=Je();return So(s.selectedSensor,h)||(s.selectedSensor=h),Gt(h)}),_t("change",function(){$t(i);let h=Je();return Gt(h.onSensorSelect())}),V(2,"option",32),le(3,"Selecciona un sensor"),$(),it(4,$k,2,3,"option",33),$(),it(5,Gk,2,1,"div",34),$()}if(c&2){let i=Je();_e(),Mo("ngModel",i.selectedSensor),_e(3),Ge("ngForOf",i.sensors),_e(),Ge("ngIf",i.selectedSensor)}}function Zk(c,a){if(c&1&&(V(0,"div",29),le(1),$()),c&2){let i=Je();_e(),ln(" ",i.errorHistoric," ")}}function qk(c,a){if(c&1&&(V(0,"div",37)(1,"h3"),le(2),_r(3,"number"),$(),Pe(4,"div",38),$()),c&2){let i=Je();_e(2),ln("Resultados hist\xF3ricos (promedio: ",jr(3,1,i.historicAvg,"1.1-1")," dB)")}}function Wk(c,a){c&1&&(V(0,"div",39),Pe(1,"mat-spinner"),V(2,"p"),le(3,"Cargando datos de sensores..."),$()())}function Xk(c,a){if(c&1){let i=Li();V(0,"div",40)(1,"mat-icon"),le(2,"error_outline"),$(),V(3,"p"),le(4,"Error al cargar los datos de los sensores"),$(),V(5,"button",41),_t("click",function(){$t(i);let h=Je();return Gt(h.loadSensorData())}),le(6,"Reintentar"),$()()}}function Yk(c,a){if(c&1&&(V(0,"div",46)(1,"span",47),le(2,"Promedio hist\xF3rico:"),$(),V(3,"span",48),le(4),_r(5,"number"),$()()),c&2){let i=Je(2);_e(4),ln("",jr(5,1,i.historicAvg,"1.1-1")," dB")}}function Kk(c,a){if(c&1){let i=Li();V(0,"div",42)(1,"div",43)(2,"h3"),le(3,"Detalles del Sensor"),$(),V(4,"button",44),_t("click",function(){$t(i);let h=Je();return Gt(h.closeDetails())}),V(5,"mat-icon"),le(6,"close"),$()()(),V(7,"div",45)(8,"div",46)(9,"span",47),le(10,"ID:"),$(),V(11,"span",48),le(12),$()(),V(13,"div",46)(14,"span",47),le(15,"Nivel de Ruido:"),$(),V(16,"span",48),le(17),$()(),V(18,"div",46)(19,"span",47),le(20,"\xDAltima actualizaci\xF3n:"),$(),V(21,"span",48),le(22),_r(23,"date"),$()(),it(24,Yk,6,4,"div",49),$()()}if(c&2){let i=Je();_e(12),Lt(i.getShortId(i.selectedSensorDetails.id)),_e(5),Wc("",i.selectedSensorDetails.laeq," dB (",i.selectedSensorDetails.levelName,")"),_e(5),Lt(jr(23,5,i.selectedSensorDetails.lastUpdate,"medium")),_e(2),Ge("ngIf",i.historicAvg)}}var Sg=class c{constructor(a){this.http=a}mapContainer;map=null;apiUrl="http://flask-fiware.apps.preprodalcaldia.medellin.gov.co/api/sensores-ruido";sensors=[];selectedSensor="";selectedSensorDetails=null;historicData=[];historicAvg=0;desdeFecha="";hastaFecha="";loading=!0;isLoading=!0;loadingHistoric=!1;error=!1;errorMessage="";errorHistoric=null;ngOnInit(){this.loadSensors(),this.setDefaultDates()}ngAfterViewInit(){this.initMap()}initMap(){this.map=new Gy.default.Map({container:this.mapContainer.nativeElement,style:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[-75.573,6.244],zoom:14}),this.map.addControl(new Gy.default.NavigationControl),this.map.on("load",()=>this.addSensorsToMap())}loadSensors(){this.isLoading=!0,this.errorMessage="",this.http.get(this.apiUrl).subscribe({next:a=>{this.sensors=a.map(i=>si(Ye({},i),{noiseLevel:this.getNoiseLevel(i.laeq_slow),levelName:this.translateLevel(this.getNoiseLevel(i.laeq_slow))})),this.isLoading=!1,this.loadSensorData()},error:a=>{this.errorMessage="Error al cargar los sensores. Por favor intenta nuevamente.",this.isLoading=!1,console.error("Error fetching sensors:",a)}})}loadSensorData(){this.loading=!0,this.error=!1,this.http.get(this.apiUrl).subscribe({next:a=>{this.sensors=a.map(i=>si(Ye({},i),{noiseLevel:this.getNoiseLevel(i.laeq_slow),levelName:this.translateLevel(this.getNoiseLevel(i.laeq_slow))})),this.addSensorsToMap(),this.loading=!1},error:a=>{console.error("Error loading sensor data:",a),this.error=!0,this.loading=!1}})}setDefaultDates(){let a=new Date,i=new Date;i.setDate(a.getDate()-7),this.desdeFecha=this.formatDate(i),this.hastaFecha=this.formatDate(a)}formatDate(a){return a.toISOString().split("T")[0]}onSensorSelect(){if(!this.selectedSensor)return;let a=this.sensors.find(i=>i.entity_id===this.selectedSensor);a&&(this.selectedSensorDetails={id:a.entity_id,laeq:a.laeq_slow,levelName:a.levelName,lastUpdate:a.fecha_ultimo_registro},this.map&&this.map.flyTo({center:[parseFloat(a.longitud),parseFloat(a.latitud)],zoom:16}),this.historicData=[],this.historicAvg=0)}getHistoricData(){if(!this.selectedSensor||!this.desdeFecha||!this.hastaFecha){this.errorHistoric="Por favor selecciona un sensor y ambas fechas";return}this.loadingHistoric=!0,this.errorHistoric=null;let a=`${this.desdeFecha} 00:00:00`,i=`${this.hastaFecha} 23:59:59`;this.getHistoricoNoise(this.selectedSensor,a,i).subscribe({next:l=>{this.historicData=l,this.calculateHistoricAvg(),this.updateMapWithHistoricalData(),this.loadingHistoric=!1},error:l=>{this.errorHistoric="Error al cargar datos hist\xF3ricos",this.loadingHistoric=!1,console.error("Error fetching historic data:",l)}})}calculateHistoricAvg(){if(this.historicData.length===0){this.historicAvg=0;return}let a=this.historicData.reduce((i,l)=>i+l.laeq_slow,0);this.historicAvg=parseFloat((a/this.historicData.length).toFixed(1))}updateMapWithHistoricalData(){if(!this.map||!this.map.isStyleLoaded())return;let a=this.sensors.findIndex(i=>i.entity_id===this.selectedSensor);a!==-1&&(this.sensors[a]=si(Ye({},this.sensors[a]),{laeq_slow:this.historicAvg,noiseLevel:this.getNoiseLevel(this.historicAvg),levelName:this.translateLevel(this.getNoiseLevel(this.historicAvg))}),this.addSensorsToMap(),this.selectedSensorDetails&&(this.selectedSensorDetails=si(Ye({},this.selectedSensorDetails),{laeq:this.historicAvg,levelName:this.translateLevel(this.getNoiseLevel(this.historicAvg))})))}getHistoricoNoise(a,i,l){let h=new Js().set("desde",i).set("hasta",l),s=`${this.apiUrl}/${encodeURIComponent(a)}/historico`;return this.http.get(s,{params:h})}addSensorsToMap(){!this.map||!this.map.isStyleLoaded()||(this.map.getSource("sensors")&&(this.map.removeLayer("sensors-circle"),this.map.removeLayer("sensors-labels"),this.map.removeSource("sensors")),this.map.addSource("sensors",{type:"geojson",data:{type:"FeatureCollection",features:this.sensors.map(a=>({type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(a.longitud),parseFloat(a.latitud)]},properties:{id:a.entity_id,laeq:a.laeq_slow,level:a.noiseLevel,levelName:a.levelName,lastUpdate:a.fecha_ultimo_registro}}))}}),this.map.addLayer({id:"sensors-circle",type:"circle",source:"sensors",paint:{"circle-radius":["case",["==",["get","id"],this.selectedSensor],12,8],"circle-color":["match",["get","level"],"low","#4CAF50","moderate","#FFC107","high","#F44336","#9E9E9E"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),this.map.addLayer({id:"sensors-labels",type:"symbol",source:"sensors",layout:{"text-field":["get","laeq"],"text-size":12,"text-offset":[0,1.5]},paint:{"text-color":"#000000","text-halo-color":"#ffffff","text-halo-width":1}}),this.map.on("click","sensors-circle",a=>{let i=a.features[0].properties;this.selectedSensor=i.id,this.selectedSensorDetails={id:i.id,laeq:i.laeq,levelName:i.levelName,lastUpdate:i.lastUpdate},this.scrollToDetails()}),this.map.on("mouseenter","sensors-circle",()=>{this.map&&(this.map.getCanvas().style.cursor="pointer")}),this.map.on("mouseleave","sensors-circle",()=>{this.map&&(this.map.getCanvas().style.cursor="")}))}getNoiseLevel(a){return a<55?"low":a<=70?"moderate":"high"}translateLevel(a){return{low:"Bajo",moderate:"Moderado",high:"Alto"}[a]||a}getShortId(a){return a.split(":").pop()||a}scrollToDetails(){let a=document.getElementById("sensor-details");a&&a.scrollIntoView({behavior:"smooth"})}closeDetails(){this.selectedSensorDetails=null}static \u0275fac=function(i){return new(i||c)(Ft(ws))};static \u0275cmp=rt({type:c,selectors:[["app-noise-sensor-map"]],viewQuery:function(i,l){if(i&1&&an(Vk,5),i&2){let h;_i(h=yi())&&(l.mapContainer=h.first)}},decls:53,vars:13,consts:[["map",""],[1,"container"],[1,"page-title"],[1,"iframe-container"],[1,"date-controls"],[1,"sensor-container"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],[4,"ngIf"],["for","desde"],["type","date","id","desde",3,"ngModelChange","ngModel"],["for","hasta"],["type","date","id","hasta",3,"ngModelChange","ngModel"],[3,"click","disabled"],["class","historic-results",4,"ngIf"],[1,"map-container"],["class","loading-overlay",4,"ngIf"],["class","error-overlay",4,"ngIf"],[1,"map-layout"],[1,"half-layout"],["id","noise-sensor-map"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/f36b2714-61d2-45cd-91ac-58b622840b4e/sensores-ruido-2025?orgId=1&kiosk=tv`,"allowfullscreen","",2,"width","90%","height","100%","border","none","border-radius","12px"],["class","details-panel",4,"ngIf"],[1,"map-legend"],[1,"legend-item"],[1,"legend-color","low"],[1,"legend-color","moderate"],[1,"legend-color","high"],[1,"loading"],[1,"error"],[3,"click"],[1,"sensor-select",3,"ngModelChange","change","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["class","selected-info",4,"ngIf"],[3,"value"],[1,"selected-info"],[1,"historic-results"],[1,"chart-container"],[1,"loading-overlay"],[1,"error-overlay"],["mat-raised-button","","color","primary",3,"click"],[1,"details-panel"],[1,"panel-header"],["mat-icon-button","",3,"click"],["id","sensor-details",1,"sensor-details"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],["class","detail-row",4,"ngIf"]],template:function(i,l){if(i&1){let h=Li();V(0,"div",1)(1,"h2",2),le(2,"Ciudad Inteligente - Sensores de ruido"),$(),V(3,"div",3)(4,"h3"),le(5),$(),V(6,"div",4)(7,"div",5)(8,"h2"),le(9,"Selecciona un sensor de ruido"),$(),it(10,jk,2,0,"div",6)(11,Uk,4,1,"div",7)(12,Hk,6,3,"div",8),$(),V(13,"div")(14,"label",9),le(15,"Desde:"),$(),V(16,"input",10),To("ngModelChange",function(T){return $t(h),So(l.desdeFecha,T)||(l.desdeFecha=T),Gt(T)}),$()(),V(17,"div")(18,"label",11),le(19,"Hasta:"),$(),V(20,"input",12),To("ngModelChange",function(T){return $t(h),So(l.hastaFecha,T)||(l.hastaFecha=T),Gt(T)}),$()(),V(21,"div")(22,"button",13),_t("click",function(){return $t(h),Gt(l.getHistoricData())}),le(23),$()()(),it(24,Zk,2,1,"div",7)(25,qk,5,4,"div",14),V(26,"h2"),le(27,"Sensores de Ruido"),$(),V(28,"div",15),it(29,Wk,4,0,"div",16)(30,Xk,7,0,"div",17),V(31,"div",18)(32,"div",19),Pe(33,"div",20,0),$(),V(35,"div",19),Pe(36,"iframe",21),$(),it(37,Kk,25,8,"div",22),$(),V(38,"div",23)(39,"h4"),le(40,"Leyenda"),$(),V(41,"div",24),Pe(42,"span",25),V(43,"span"),le(44,"Bajo (<55 dB)"),$()(),V(45,"div",24),Pe(46,"span",26),V(47,"span"),le(48,"Moderado (55-70 dB)"),$()(),V(49,"div",24),Pe(50,"span",27),V(51,"span"),le(52,"Alto (>70 dB)"),$()()()()()()}i&2&&(_e(5),ln("Consultar hist\xF3rico para: ",l.getShortId(l.selectedSensor),""),_e(5),Ge("ngIf",l.isLoading),_e(),Ge("ngIf",l.errorMessage),_e(),Ge("ngIf",!l.isLoading&&!l.errorMessage),_e(4),Mo("ngModel",l.desdeFecha),_e(4),Mo("ngModel",l.hastaFecha),_e(2),Ge("disabled",!l.selectedSensor||l.loadingHistoric),_e(),ln(" ",l.loadingHistoric?"Cargando...":"Consultar"," "),_e(),Ge("ngIf",l.errorHistoric),_e(),Ge("ngIf",l.historicData.length>0),_e(4),Ge("ngIf",l.loading),_e(),Ge("ngIf",l.error),_e(7),Ge("ngIf",l.selectedSensorDetails))},dependencies:[$r,Hl,Qs,Uf,jf,Tu,Rm,Om,tc,Su,ic,td,oc,rc,Wl,xg,bg],styles:[`@charset "UTF-8";body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:#f4f7fa;overflow-x:hidden}.page-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:#333;text-align:left;padding:25px 30px;background-color:#fff;box-shadow:0 6px 15px #0000001a;margin:0 0 25px 300px;border-radius:0 0 12px 12px;text-shadow:1px 1px 2px rgba(0,0,0,.1);position:relative;z-index:10;border-bottom:4px solid #4CAF50;transform:perspective(500px) rotateX(1deg);transition:all .3s ease}.page-title[_ngcontent-%COMP%]:hover{transform:perspective(500px) rotateX(2deg);box-shadow:0 8px 20px #00000026}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:20px;gap:25px;background:linear-gradient(145deg,#fff,#f8f9fa);border-radius:12px;box-shadow:0 8px 25px #00000014;margin-bottom:30px;transition:all .3s ease}.iframe-container[_ngcontent-%COMP%]:hover{box-shadow:0 12px 30px #0000001f}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:25px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:280px;border:none;border-radius:10px;box-shadow:0 4px 15px #0000001a;transition:all .3s ease;transform:translateZ(0)}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:hover{transform:translateY(-5px) translateZ(10px);box-shadow:0 8px 25px #00000026}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:550px;border:none;border-radius:12px;box-shadow:0 6px 20px #0000001f;transition:all .3s ease}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe):hover{transform:translateY(-5px);box-shadow:0 10px 30px #0000002e}.map-container[_ngcontent-%COMP%]{position:relative;border-radius:15px;overflow:hidden;box-shadow:0 15px 35px #00000026;background:#fff;transform-style:preserve-3d;perspective:1000px;transition:all .4s ease}.map-container[_ngcontent-%COMP%]:hover{box-shadow:0 20px 40px #0003}.loading-overlay[_ngcontent-%COMP%], .error-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#ffffffe6;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000;border-radius:15px;animation:_ngcontent-%COMP%_fadeIn .5s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.loading-overlay[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{transform:scale(1.5);margin-bottom:20px}.error-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3.5rem;width:3.5rem;height:3.5rem;color:#f44336;margin-bottom:20px;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.map-layout[_ngcontent-%COMP%]{display:flex;width:100%;height:650px;gap:25px;padding:25px;perspective:1500px}.half-layout[_ngcontent-%COMP%]{width:50%;height:100%;border-radius:15px;overflow:hidden;box-shadow:0 10px 30px #00000026;background:#fff;transition:all .4s ease;transform-style:preserve-3d;position:relative}.half-layout[_ngcontent-%COMP%]:hover{transform:translateY(-10px) rotateX(1deg);box-shadow:0 15px 40px #0003}.half-layout[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#ffffff1a,#fff0);pointer-events:none;border-radius:15px}#noise-sensor-map[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:15px;transform:translateZ(0)}.details-panel[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) perspective(1000px) rotateY(0);width:350px;background:#fff;border-radius:12px;box-shadow:0 15px 35px #0003;z-index:1000;padding:20px;animation:_ngcontent-%COMP%_slideUp .4s cubic-bezier(.18,.89,.32,1.28);border:1px solid rgba(255,255,255,.3);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:#fffffff2;transform-style:preserve-3d}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translate(-50%,-30%) perspective(1000px) rotateY(10deg);opacity:0}to{transform:translate(-50%,-50%) perspective(1000px) rotateY(0);opacity:1}}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #eee}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.3rem;color:#333;text-shadow:1px 1px 2px rgba(0,0,0,.05)}.panel-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:#666;transition:all .2s ease}.panel-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#f44336;transform:rotate(90deg)}.sensor-details[_ngcontent-%COMP%]{font-size:.95rem}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px;padding:8px 10px;background:#f5f5f580;border-radius:8px;transition:all .2s ease}.detail-row[_ngcontent-%COMP%]:hover{background:#f5f5f5e6;transform:translate(5px)}.detail-label[_ngcontent-%COMP%]{font-weight:600;margin-right:10px;color:#555}.detail-value[_ngcontent-%COMP%]{font-weight:500;color:#333}.map-legend[_ngcontent-%COMP%]{position:absolute;bottom:30px;left:30px;background:#ffffffd9;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);padding:15px;border-radius:10px;box-shadow:0 8px 25px #00000026;z-index:100;transform:translateZ(20px);border:1px solid rgba(255,255,255,.3);animation:_ngcontent-%COMP%_float 6s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%{transform:translateY(0) translateZ(20px)}50%{transform:translateY(-10px) translateZ(20px)}to{transform:translateY(0) translateZ(20px)}}.map-legend[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:1.1rem;color:#333;text-align:center}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:8px;padding:5px 10px;border-radius:6px;transition:all .2s ease}.legend-item[_ngcontent-%COMP%]:hover{background:#0000000d;transform:translate(3px)}.legend-color[_ngcontent-%COMP%]{display:inline-block;width:18px;height:18px;border-radius:50%;margin-right:12px;border:2px solid white;box-shadow:0 2px 5px #0000001a;transition:all .3s ease}.legend-item[_ngcontent-%COMP%]:hover   .legend-color[_ngcontent-%COMP%]{transform:scale(1.2)}.legend-color.low[_ngcontent-%COMP%]{background-color:#4caf50}.legend-color.moderate[_ngcontent-%COMP%]{background-color:#ffc107}.legend-color.high[_ngcontent-%COMP%]{background-color:#f44336}.sensor-container[_ngcontent-%COMP%]{max-width:600px;margin:2rem 0 2rem 2rem;padding:1.5rem;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;box-shadow:0 10px 30px #0000001a;display:flex;flex-direction:column;gap:1.2rem;border:1px solid rgba(255,255,255,.3);transform:perspective(500px) rotateY(-1deg);transition:all .3s ease}.sensor-container[_ngcontent-%COMP%]:hover{transform:perspective(500px) rotateY(0);box-shadow:0 15px 40px #00000026}.sensor-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.4rem;color:#333;text-shadow:1px 1px 2px rgba(0,0,0,.05)}.sensor-select[_ngcontent-%COMP%]{width:100%;padding:.8rem;font-size:1rem;border:1px solid #ddd;border-radius:8px;background:#fffc;box-shadow:inset 0 2px 5px #0000000d;transition:all .3s ease;appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .7rem center;background-size:1rem}.sensor-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50;box-shadow:0 0 0 3px #4caf5033}.selected-info[_ngcontent-%COMP%]{margin-top:1rem;padding:.8rem;background-color:#f8f9fa;border-radius:8px;border-left:4px solid #4CAF50;animation:_ngcontent-%COMP%_fadeIn .5s ease}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{padding:1.2rem;text-align:center;margin:1rem 0;border-radius:8px;animation:_ngcontent-%COMP%_fadeIn .5s ease}.loading[_ngcontent-%COMP%]{color:#666;background:#f5f5f5cc}.error[_ngcontent-%COMP%]{color:#d32f2f;background-color:#fde0e0e6;border-radius:8px;border-left:4px solid #d32f2f}.error[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:.8rem;padding:.6rem 1.2rem;background-color:#d32f2f;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 5px #0000001a}.error[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#b71c1c;transform:translateY(-2px);box-shadow:0 4px 8px #00000026}.date-controls[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:15px;align-items:center;padding:1rem;background:#fffffff2;border-radius:12px;box-shadow:0 5px 15px #00000014;margin-bottom:1.5rem}.date-controls[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:10px}.date-controls[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-right:8px;color:#555;font-size:.95rem}.date-controls[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.7rem;border:1px solid #ddd;border-radius:8px;background:#fffc;box-shadow:inset 0 2px 5px #0000000d;transition:all .3s ease}.date-controls[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50;box-shadow:0 0 0 3px #4caf5033}.date-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem 1.5rem;background:linear-gradient(135deg,#4caf50,#66bb6a);color:#fff;border:none;border-radius:8px;cursor:pointer;transition:all .3s ease;font-weight:600;box-shadow:0 4px 8px #4caf504d;text-transform:uppercase;letter-spacing:.5px}.date-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#43a047,#4caf50);transform:translateY(-3px);box-shadow:0 6px 12px #4caf5066}.date-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed;transform:none;box-shadow:none}.historic-results[_ngcontent-%COMP%]{margin-top:1.5rem;max-height:400px;overflow-y:auto;background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 5px 15px #00000014;animation:_ngcontent-%COMP%_slideUp .5s ease}.historic-results[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333;font-size:1.3rem;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #eee}.historic-results[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.historic-results[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .historic-results[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #eee}.historic-results[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#f8f9fa,#e9ecef);color:#333;font-weight:600;position:sticky;top:0}.historic-results[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#4caf500d}.container[_ngcontent-%COMP%]{margin-left:0;padding:2rem;width:100%;box-sizing:border-box;animation:_ngcontent-%COMP%_fadeIn .8s ease}@media (max-width: 1200px){.map-layout[_ngcontent-%COMP%]{flex-direction:column;height:auto}.half-layout[_ngcontent-%COMP%]{width:100%;height:500px;margin-bottom:20px}.map-container[_ngcontent-%COMP%], .iframe-container[_ngcontent-%COMP%], .page-title[_ngcontent-%COMP%]{margin-left:0}}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000000d;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#0003;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#0000004d}@media (max-width: 1200px){.page-title[_ngcontent-%COMP%], .iframe-container[_ngcontent-%COMP%]{margin-left:0}.map-layout[_ngcontent-%COMP%]{flex-direction:column;height:auto}.half-layout[_ngcontent-%COMP%]{width:100%;height:400px}.iframe-row[_ngcontent-%COMP%]{flex-direction:column}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:250px}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:400px}}@media (max-width: 768px){.page-title[_ngcontent-%COMP%]{font-size:2rem;padding:20px;margin-bottom:20px}.sensor-container[_ngcontent-%COMP%]{margin:1rem;padding:1rem}.sensor-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}.sensor-select[_ngcontent-%COMP%]{font-size:.95rem;padding:.7rem}.details-panel[_ngcontent-%COMP%]{width:90%;padding:15px}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem}.map-legend[_ngcontent-%COMP%]{bottom:20px;left:20px;padding:10px}.map-legend[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem}.legend-color[_ngcontent-%COMP%]{width:14px;height:14px}.detail-row[_ngcontent-%COMP%]{font-size:.9rem}}@media (max-width: 480px){.page-title[_ngcontent-%COMP%]{font-size:1.6rem;padding:15px}.iframe-container[_ngcontent-%COMP%]{padding:15px;gap:15px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%], .iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:200px}.map-layout[_ngcontent-%COMP%]{padding:15px;gap:15px}.sensor-container[_ngcontent-%COMP%]{margin:1rem .5rem;padding:1rem}.details-panel[_ngcontent-%COMP%]{padding:10px}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem}.sensor-select[_ngcontent-%COMP%]{font-size:.9rem;padding:.6rem}.detail-row[_ngcontent-%COMP%]{padding:6px 8px}.map-legend[_ngcontent-%COMP%]{left:10px;bottom:15px;padding:8px}.legend-item[_ngcontent-%COMP%]{font-size:.85rem}.legend-color[_ngcontent-%COMP%]{width:12px;height:12px}}`]})};var Tg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-turismomaps"]],decls:9,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739789874607&to=1740394674607&viewPanel=7&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739790035176&to=1740394835176&viewPanel=5&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739790124478&to=1740394924478&viewPanel=6&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739790178621&to=1740394978621&viewPanel=4&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Ciudad Inteligente - Turismo"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),$()(),V(7,"div",1),Pe(8,"iframe",6),$())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var Eg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-siatamaps"]],decls:10,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&from=1739790813208&to=1740395613208&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&from=1739790813208&to=1740395613208&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&var-city=--Seleccionar--&from=1739790813208&from=1739790813208&to=1740395613208&to=1740395613208&viewPanel=1http:%2F%2Fgrafana-fiware.apps.preprodalcaldia.medellin.gov.co%2Fterritoriointeligente%2Fd%2Fsi_ma%2Fsiata-map%3ForgId%3D1&viewPanel=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&from=1739790813208&to=1740395613208&viewPanel=6&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Ciudad Inteligente - SIATA"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4),$()(),V(6,"div",1),Pe(7,"iframe",5),$(),V(8,"div",1),Pe(9,"iframe",6),$())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var Ig=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:7,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-column"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/movilidad-volumen-carri/movilidad-inteligente-volumen-de-trafico-por-carriles?orgId=1&var-carril=All&var-dia_semana=All&from=1734757199500&to=1738558797500&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/movilidad-vel-graph4/grafica-velocidad-promedio4?orgId=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/c18a5148-09d5-4585-8b7d-ea4aaba9e130/mapa-de-trafico-medellin?orgId=1&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(V(0,"h2",0),le(1,"Movilidad Inteligente"),$(),V(2,"div",1)(3,"div",2),Pe(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),$()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column;height:100vh;overflow-y:auto}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.iframe-column[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:500px;width:100%;border:none;overflow:visible;pointer-events:auto!important;z-index:10}"]})};var sc=I_(LC());function Qk(c,a){c&1&&(V(0,"div",5),Pe(1,"div",6),V(2,"p"),le(3,"Cargando..."),$()())}function Jk(c,a){c&1&&(V(0,"span"),le(1,"Este campo es requerido"),$())}function eA(c,a){if(c&1&&(V(0,"div",27),it(1,Jk,2,0,"span",28),$()),c&2){let i,l=Je(2);_e(),Ge("ngIf",(i=l.userForm.get("username"))==null||i.errors==null?null:i.errors.required)}}function tA(c,a){c&1&&(V(0,"div",27),le(1," Ingrese un correo electr\xF3nico v\xE1lido "),$())}function iA(c,a){c&1&&(V(0,"div",27),le(1," Este campo es requerido "),$())}function nA(c,a){c&1&&(V(0,"div",27),le(1," Este campo es requerido "),$())}function rA(c,a){if(c&1&&(V(0,"small",35),le(1),$()),c&2){let i=Je().$implicit;_e(),Lt(i.description)}}function oA(c,a){if(c&1){let i=Li();V(0,"div",31)(1,"input",32),_t("change",function(h){let s=$t(i).$implicit,T=Je(3);return Gt(T.onRoleChange(h,s.id))}),$(),V(2,"label",33),le(3),$(),it(4,rA,2,1,"small",34),$()}if(c&2){let i=a.$implicit,l=Je(3);_e(),Ge("id","role-"+i.id)("value",i.id)("checked",l.isRoleSelected(i.id))("disabled",l.roleAssignmentInProgress),_e(),Ge("for","role-"+i.id),_e(),Lt(i.name),_e(),Ge("ngIf",i.description)}}function sA(c,a){if(c&1&&(V(0,"div",10)(1,"label"),le(2,"Roles del Sistema (opcional)"),$(),V(3,"small"),le(4,"Puede asignar roles ahora o m\xE1s tarde"),$(),V(5,"div",29),it(6,oA,5,7,"div",30),$()()),c&2){let i=Je(2);_e(6),Ge("ngForOf",i.roles)}}function aA(c,a){if(c&1&&(V(0,"small",35),le(1),$()),c&2){let i=Je().$implicit;_e(),Lt(i.description)}}function lA(c,a){if(c&1){let i=Li();V(0,"div",31)(1,"input",32),_t("change",function(h){let s=$t(i).$implicit,T=Je(3);return Gt(T.onRoleChange(h,s.id,!0))}),$(),V(2,"label",33),le(3),$(),it(4,aA,2,1,"small",34),$()}if(c&2){let i=a.$implicit,l=Je(3);_e(),Ge("id","grafana-role-"+i.id)("value",i.id)("checked",l.isRoleSelected(i.id,!0))("disabled",l.roleAssignmentInProgress),_e(),Ge("for","grafana-role-"+i.id),_e(),Lt(i.name),_e(),Ge("ngIf",i.description)}}function cA(c,a){if(c&1&&(V(0,"div",27),le(1),$()),c&2){let i=Je(3);_e(),Lt(i.roleError)}}function dA(c,a){if(c&1&&(V(0,"div",10)(1,"label"),le(2,"Roles de Grafana (opcional)"),$(),V(3,"small"),le(4,"Puede asignar roles ahora o m\xE1s tarde"),$(),V(5,"div",29),it(6,lA,5,7,"div",30),$(),it(7,cA,2,1,"div",12),$()),c&2){let i=Je(2);_e(6),Ge("ngForOf",i.grafanaRoles),_e(),Ge("ngIf",i.roleError)}}function uA(c,a){if(c&1){let i=Li();V(0,"button",36),_t("click",function(){$t(i);let h=Je(2);return Gt(h.cancelEdit())}),le(1,"Cancelar"),$()}}function hA(c,a){if(c&1&&(V(0,"span",44),le(1),$()),c&2){let i=a.$implicit;_e(),Lt(i.name)}}function pA(c,a){c&1&&(V(0,"span",45),le(1,"Sin roles"),$())}function fA(c,a){if(c&1&&(V(0,"span",46),le(1),$()),c&2){let i=a.$implicit;_e(),Lt(i.name)}}function mA(c,a){c&1&&(V(0,"span",45),le(1,"Sin roles"),$())}function gA(c,a){if(c&1){let i=Li();V(0,"tr")(1,"td"),le(2),$(),V(3,"td"),le(4),$(),V(5,"td"),le(6),$(),V(7,"td")(8,"span"),le(9),$()(),V(10,"td"),it(11,hA,2,1,"span",37)(12,pA,2,0,"span",38),$(),V(13,"td"),it(14,fA,2,1,"span",39)(15,mA,2,0,"span",38),$(),V(16,"td",40)(17,"button",41),_t("click",function(){let h=$t(i).$implicit,s=Je(2);return Gt(s.editUser(h))}),le(18,"Editar"),$(),V(19,"button",42),_t("click",function(){let h=$t(i).$implicit,s=Je(2);return Gt(s.assignRoles(h))}),le(20,"Asignar Roles"),$(),V(21,"button",43),_t("click",function(){let h=$t(i).$implicit,s=Je(2);return Gt(s.confirmDelete(h.id))}),le(22,"Eliminar"),$()()()}if(c&2){let i=a.$implicit;_e(2),Wc("",i.firstName," ",i.lastName,""),_e(2),Lt(i.email),_e(2),Lt(i.username),_e(2),wi("active",i.enabled)("inactive",!i.enabled),_e(),ln(" ",i.enabled?"Activo":"Inactivo"," "),_e(2),Ge("ngForOf",i.roles),_e(),Ge("ngIf",!i.roles||i.roles.length===0),_e(2),Ge("ngForOf",i.grafanaRoles),_e(),Ge("ngIf",!i.grafanaRoles||i.grafanaRoles.length===0)}}function _A(c,a){c&1&&(V(0,"div",47),le(1," No se encontraron usuarios "),$())}function yA(c,a){if(c&1){let i=Li();V(0,"div",7)(1,"div",8)(2,"h2"),le(3),$(),V(4,"form",9),_t("ngSubmit",function(){$t(i);let h=Je();return Gt(h.selectedUser?h.updateUser():h.createUser())}),V(5,"div",10)(6,"label"),le(7,"Nombre de usuario *"),$(),Pe(8,"input",11),it(9,eA,2,1,"div",12),$(),V(10,"div",10)(11,"label"),le(12,"Correo electr\xF3nico *"),$(),Pe(13,"input",13),it(14,tA,2,0,"div",12),$(),V(15,"div",10)(16,"label"),le(17,"Nombre *"),$(),Pe(18,"input",14),it(19,iA,2,0,"div",12),$(),V(20,"div",10)(21,"label"),le(22,"Apellido *"),$(),Pe(23,"input",15),it(24,nA,2,0,"div",12),$(),V(25,"div",10)(26,"label"),le(27,"Contrase\xF1a (opcional)"),$(),Pe(28,"input",16),V(29,"small"),le(30,"Puede asignar una contrase\xF1a ahora o m\xE1s tarde"),$()(),V(31,"div",10)(32,"label"),le(33,"Habilitado"),$(),Pe(34,"input",17),$(),it(35,sA,7,1,"div",18)(36,dA,8,2,"div",18),V(37,"div",19)(38,"button",20),le(39),$(),it(40,uA,2,0,"button",21),$()()(),V(41,"div",22)(42,"h2"),le(43,"Lista de Usuarios"),$(),V(44,"div",23)(45,"input",24),To("ngModelChange",function(h){$t(i);let s=Je();return So(s.searchTerm,h)||(s.searchTerm=h),Gt(h)}),_t("input",function(){$t(i);let h=Je();return Gt(h.filterUsers())}),$()(),V(46,"table")(47,"thead")(48,"tr")(49,"th"),le(50,"Nombre"),$(),V(51,"th"),le(52,"Correo"),$(),V(53,"th"),le(54,"Usuario"),$(),V(55,"th"),le(56,"Estado"),$(),V(57,"th"),le(58,"Roles Sistema"),$(),V(59,"th"),le(60,"Roles Grafana"),$(),V(61,"th"),le(62,"Acciones"),$()()(),V(63,"tbody"),it(64,gA,23,13,"tr",25),$()(),it(65,_A,2,0,"div",26),$()()}if(c&2){let i,l,h,s,T=Je();_e(3),Lt(T.selectedUser?"Editar Usuario":"Crear Usuario"),_e(),Ge("formGroup",T.userForm),_e(4),Ge("disabled",!!T.selectedUser),_e(),Ge("ngIf",((i=T.userForm.get("username"))==null?null:i.invalid)&&((i=T.userForm.get("username"))==null?null:i.touched)),_e(5),Ge("ngIf",((l=T.userForm.get("email"))==null?null:l.invalid)&&((l=T.userForm.get("email"))==null?null:l.touched)),_e(5),Ge("ngIf",((h=T.userForm.get("firstName"))==null?null:h.invalid)&&((h=T.userForm.get("firstName"))==null?null:h.touched)),_e(5),Ge("ngIf",((s=T.userForm.get("lastName"))==null?null:s.invalid)&&((s=T.userForm.get("lastName"))==null?null:s.touched)),_e(4),Ge("placeholder",T.selectedUser?"Nueva contrase\xF1a (dejar en blanco para no cambiar)":"Ingrese contrase\xF1a (opcional)"),_e(7),Ge("ngIf",T.roles.length>0),_e(),Ge("ngIf",T.grafanaRoles.length>0),_e(2),Ge("disabled",!T.userForm.valid||T.roleAssignmentInProgress),_e(),ln(" ",T.selectedUser?"Actualizar":"Crear"," "),_e(),Ge("ngIf",T.selectedUser),_e(5),Mo("ngModel",T.searchTerm),_e(19),Ge("ngForOf",T.filteredUsers),_e(),Ge("ngIf",T.filteredUsers.length===0)}}function vA(c,a){if(c&1&&(V(0,"span",49),le(1),$()),c&2){let i=a.$implicit;_e(),ln(" ",i.username," ")}}function bA(c,a){c&1&&(V(0,"span"),le(1,"Ning\xFAn usuario"),$())}function xA(c,a){if(c&1){let i=Li();V(0,"tr")(1,"td"),le(2),$(),V(3,"td"),le(4),$(),V(5,"td"),it(6,vA,2,1,"span",48)(7,bA,2,0,"span",28),$(),V(8,"td")(9,"button",3),_t("click",function(){let h=$t(i).$implicit,s=Je(2);return Gt(s.viewRoleDetails(h))}),le(10,"Detalles"),$()()()}if(c&2){let i=a.$implicit,l=Je(2);_e(2),Lt(i.name),_e(2),Lt(i.description||"Sin descripci\xF3n"),_e(2),Ge("ngForOf",l.getUsersWithRole(i.id)),_e(),Ge("ngIf",l.getUsersWithRole(i.id).length===0)}}function wA(c,a){c&1&&(V(0,"div",47),le(1," No se encontraron roles del sistema "),$())}function CA(c,a){if(c&1&&(V(0,"div",7)(1,"div",22)(2,"h2"),le(3,"Roles del Sistema"),$(),V(4,"table")(5,"thead")(6,"tr")(7,"th"),le(8,"Nombre"),$(),V(9,"th"),le(10,"Descripci\xF3n"),$(),V(11,"th"),le(12,"Usuarios Asignados"),$(),V(13,"th"),le(14,"Acciones"),$()()(),V(15,"tbody"),it(16,xA,11,4,"tr",25),$()(),it(17,wA,2,0,"div",26),$()()),c&2){let i=Je();_e(16),Ge("ngForOf",i.roles),_e(),Ge("ngIf",i.roles.length===0)}}function MA(c,a){if(c&1&&(V(0,"span",49),le(1),$()),c&2){let i=a.$implicit;_e(),ln(" ",i.username," ")}}function SA(c,a){c&1&&(V(0,"span"),le(1,"Ning\xFAn usuario"),$())}function TA(c,a){if(c&1){let i=Li();V(0,"tr")(1,"td"),le(2),$(),V(3,"td"),le(4),$(),V(5,"td"),it(6,MA,2,1,"span",48)(7,SA,2,0,"span",28),$(),V(8,"td")(9,"button",3),_t("click",function(){let h=$t(i).$implicit,s=Je(2);return Gt(s.viewRoleDetails(h,!0))}),le(10,"Detalles"),$()()()}if(c&2){let i=a.$implicit,l=Je(2);_e(2),Lt(i.name),_e(2),Lt(i.description||"Sin descripci\xF3n"),_e(2),Ge("ngForOf",l.getUsersWithGrafanaRole(i.id)),_e(),Ge("ngIf",l.getUsersWithGrafanaRole(i.id).length===0)}}function EA(c,a){c&1&&(V(0,"div",47),le(1," No se encontraron roles de Grafana "),$())}function IA(c,a){if(c&1&&(V(0,"div",7)(1,"div",22)(2,"h2"),le(3,"Roles de Grafana"),$(),V(4,"table")(5,"thead")(6,"tr")(7,"th"),le(8,"Nombre"),$(),V(9,"th"),le(10,"Descripci\xF3n"),$(),V(11,"th"),le(12,"Usuarios Asignados"),$(),V(13,"th"),le(14,"Acciones"),$()()(),V(15,"tbody"),it(16,TA,11,4,"tr",25),$()(),it(17,EA,2,0,"div",26),$()()),c&2){let i=Je();_e(16),Ge("ngForOf",i.grafanaRoles),_e(),Ge("ngIf",i.grafanaRoles.length===0)}}function PA(c,a){if(c&1&&(V(0,"tr")(1,"td"),le(2),$(),V(3,"td"),le(4),$(),V(5,"td"),le(6),$(),V(7,"td"),le(8),$(),V(9,"td"),le(10),_r(11,"date"),$()()),c&2){let i=a.$implicit,l=Je(2);_e(2),Lt(i.userId||"Sistema"),_e(2),Lt(l.getActionName(i.operationType)),_e(2),Lt(l.getResourceType(i.resourceType)),_e(2),Lt(i.details||"N/A"),_e(2),Lt(jr(11,5,i.time,"dd/MM/yyyy HH:mm"))}}function kA(c,a){c&1&&(V(0,"div",47),le(1," No se encontraron registros de auditor\xEDa "),$())}function AA(c,a){if(c&1){let i=Li();V(0,"div",7)(1,"h2"),le(2,"Registros de Auditor\xEDa"),$(),V(3,"div",50)(4,"div",51)(5,"label"),le(6,"Filtrar por tipo:"),$(),V(7,"select",52),To("ngModelChange",function(h){$t(i);let s=Je();return So(s.auditFilter.type,h)||(s.auditFilter.type=h),Gt(h)}),_t("change",function(){$t(i);let h=Je();return Gt(h.filterAuditLogs())}),V(8,"option",53),le(9,"Todos"),$(),V(10,"option",54),le(11,"Usuarios"),$(),V(12,"option",55),le(13,"Roles"),$(),V(14,"option",56),le(15,"Roles Grafana"),$()()(),V(16,"div",51)(17,"label"),le(18,"Filtrar por acci\xF3n:"),$(),V(19,"select",52),To("ngModelChange",function(h){$t(i);let s=Je();return So(s.auditFilter.action,h)||(s.auditFilter.action=h),Gt(h)}),_t("change",function(){$t(i);let h=Je();return Gt(h.filterAuditLogs())}),V(20,"option",53),le(21,"Todas"),$(),V(22,"option",57),le(23,"Creaci\xF3n"),$(),V(24,"option",58),le(25,"Actualizaci\xF3n"),$(),V(26,"option",59),le(27,"Eliminaci\xF3n"),$()()(),V(28,"button",3),_t("click",function(){$t(i);let h=Je();return Gt(h.clearAuditFilters())}),le(29,"Limpiar Filtros"),$()(),V(30,"div",60)(31,"table")(32,"thead")(33,"tr")(34,"th"),le(35,"Usuario"),$(),V(36,"th"),le(37,"Acci\xF3n"),$(),V(38,"th"),le(39,"Recurso"),$(),V(40,"th"),le(41,"Detalles"),$(),V(42,"th"),le(43,"Fecha"),$()()(),V(44,"tbody"),it(45,PA,12,8,"tr",25),$()(),it(46,kA,2,0,"div",26),$()()}if(c&2){let i=Je();_e(7),Mo("ngModel",i.auditFilter.type),_e(12),Mo("ngModel",i.auditFilter.action),_e(26),Ge("ngForOf",i.filteredAuditLogs),_e(),Ge("ngIf",i.filteredAuditLogs.length===0)}}var Pg=class c{constructor(a,i){this.http=a;this.fb=i;this.initUserForm()}activeTab="usuarios";users=[];filteredUsers=[];roles=[];grafanaRoles=[];auditLogs=[];filteredAuditLogs=[];userForm;selectedUser=null;token="";searchTerm="";selectedRoles=[];selectedGrafanaRoles=[];roleAssignmentInProgress=!1;roleError="";loading=!1;auditFilter={type:"",action:""};apiUrl="http://flask-fiware.apps.preprodalcaldia.medellin.gov.co/api/keycloak";ngOnInit(){this.getToken()}initUserForm(){this.userForm=this.fb.group({username:["",[Po.required],[this.asyncUsernameValidator.bind(this)]],email:["",[Po.required,Po.email]],firstName:["",Po.required],lastName:["",Po.required],enabled:[!0],password:[""]})}asyncUsernameValidator(a){return this.validateUsername(a.value).then(i=>i?null:{})}validateUsername(a){return tu(this,null,function*(){if(!a||this.selectedUser)return!0;try{return(yield this.http.get(`${this.apiUrl}/users?username=${a}`,{headers:this.getHeaders()}).toPromise()).length===0}catch{return!1}})}getToken(){this.loading=!0;let a={username:"admin-user@hopu.eu",password:"5uLFJdgF65DqcMbGUzArLd29L4TAAdFHAMq8"};this.http.post(`${this.apiUrl}/login`,a).subscribe({next:i=>{this.token=i.access_token,this.loadInitialData(),this.loading=!1},error:i=>{console.error("Error al obtener token:",i),this.showError("Error al iniciar sesi\xF3n","No se pudo obtener el token de autenticaci\xF3n"),this.loading=!1}})}loadInitialData(){this.loadUsers(),this.loadRoles(),this.loadGrafanaRoles(),this.loadAuditLogs()}getHeaders(){return new xs({Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"})}loadUsers(){this.loading=!0,this.http.get(`${this.apiUrl}/users`,{headers:this.getHeaders()}).subscribe({next:a=>{this.users=a,this.filteredUsers=[...this.users],this.users.forEach(i=>{this.loadUserRoles(i.id),this.loadUserGrafanaRoles(i.id)}),this.loading=!1},error:a=>{console.error("Error al cargar usuarios:",a),this.showError("Error","No se pudieron cargar los usuarios"),this.loading=!1}})}loadUserRoles(a){this.http.get(`${this.apiUrl}/user_roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:i=>{let l=this.users.find(h=>h.id===a);l&&(l.roles=i,this.filterUsers())},error:i=>{console.error(`Error al cargar roles para usuario ${a}:`,i)}})}loadUserGrafanaRoles(a){this.http.get(`${this.apiUrl}/roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:i=>{let l=this.users.find(h=>h.id===a);l&&(l.grafanaRoles=i,this.filterUsers())},error:i=>{console.error(`Error al cargar roles de Grafana para usuario ${a}:`,i)}})}loadRoles(){this.loading=!0,this.http.get(`${this.apiUrl}/user_roles`,{headers:this.getHeaders()}).subscribe({next:a=>{this.roles=a,this.loading=!1},error:a=>{console.error("Error al cargar roles:",a),this.showError("Error","No se pudieron cargar los roles"),this.loading=!1}})}loadGrafanaRoles(){this.loading=!0,this.http.get(`${this.apiUrl}/roles`,{headers:this.getHeaders()}).subscribe({next:a=>{this.grafanaRoles=a,this.loading=!1},error:a=>{console.error("Error al cargar roles de Grafana:",a),this.showError("Error","No se pudieron cargar los roles de Grafana"),this.loading=!1}})}loadAuditLogs(){this.loading=!0,this.http.get(`${this.apiUrl}/user_logs`,{headers:this.getHeaders()}).subscribe({next:a=>{this.auditLogs=a,this.http.get(`${this.apiUrl}/role_logs`,{headers:this.getHeaders()}).subscribe({next:i=>{this.auditLogs=[...this.auditLogs,...i],this.filteredAuditLogs=[...this.auditLogs],this.filterAuditLogs(),this.loading=!1},error:i=>{console.error("Error al cargar logs de roles:",i),this.loading=!1}})},error:a=>{console.error("Error al cargar logs de usuarios:",a),this.loading=!1}})}assignSingleRole(a,i){return this.http.put(`${this.apiUrl}/roles/user_id/${a}/role_id/${i}`,{},{headers:this.getHeaders()}).toPromise()}removeSingleRole(a,i){return this.http.delete(`${this.apiUrl}/user_roles/user_id/${a}/role_id/${i}`,{headers:this.getHeaders()}).toPromise()}assignSingleGrafanaRole(a,i){return this.http.put(`${this.apiUrl}/roles/user_id/${a}/role_id/${i}`,{},{headers:this.getHeaders()}).toPromise()}removeSingleGrafanaRole(a,i){return this.http.delete(`${this.apiUrl}/roles/user_id/${a}/role_id/${i}`,{headers:this.getHeaders()}).toPromise()}onRoleChange(a,i,l=!1){return tu(this,null,function*(){if(!this.selectedUser){let h=l?this.selectedGrafanaRoles:this.selectedRoles;if(a.target.checked)h.includes(i)||h.push(i);else{let s=h.indexOf(i);s>-1&&h.splice(s,1)}return}this.roleAssignmentInProgress=!0,this.roleError="";try{a.target.checked?l?yield this.assignSingleGrafanaRole(this.selectedUser.id,i):yield this.assignSingleRole(this.selectedUser.id,i):l?yield this.removeSingleGrafanaRole(this.selectedUser.id,i):yield this.removeSingleRole(this.selectedUser.id,i),l?this.loadUserGrafanaRoles(this.selectedUser.id):this.loadUserRoles(this.selectedUser.id)}catch(h){console.error("Error al actualizar rol:",h),this.roleError="Error al actualizar el rol. Intente nuevamente.",a.target.checked=!a.target.checked}finally{this.roleAssignmentInProgress=!1}})}filterUsers(){if(!this.searchTerm){this.filteredUsers=[...this.users];return}let a=this.searchTerm.toLowerCase();this.filteredUsers=this.users.filter(i=>i.firstName&&i.firstName.toLowerCase().includes(a)||i.lastName&&i.lastName.toLowerCase().includes(a)||i.email&&i.email.toLowerCase().includes(a)||i.username&&i.username.toLowerCase().includes(a))}filterAuditLogs(){this.filteredAuditLogs=this.auditLogs.filter(a=>{let i=!0;return this.auditFilter.type&&(i=i&&a.resourceType===this.auditFilter.type),this.auditFilter.action&&(i=i&&a.operationType===this.auditFilter.action),i}).sort((a,i)=>new Date(i.time).getTime()-new Date(a.time).getTime())}clearAuditFilters(){this.auditFilter={type:"",action:""},this.filterAuditLogs()}getActionName(a){switch(a){case"CREATE":return"Creaci\xF3n";case"UPDATE":return"Actualizaci\xF3n";case"DELETE":return"Eliminaci\xF3n";default:return a}}getResourceType(a){switch(a){case"USER":return"Usuario";case"ROLE":return"Rol";default:return a}}getUsersWithRole(a){return this.users.filter(i=>i.roles&&i.roles.some(l=>l.id===a))}getUsersWithGrafanaRole(a){return this.users.filter(i=>i.grafanaRoles&&i.grafanaRoles.some(l=>l.id===a))}isRoleSelected(a,i=!1){return this.selectedUser?i?this.selectedUser.grafanaRoles&&this.selectedUser.grafanaRoles.some(l=>l.id===a):this.selectedUser.roles&&this.selectedUser.roles.some(l=>l.id===a):i?this.selectedGrafanaRoles.includes(a):this.selectedRoles.includes(a)}createUser(){if(this.userForm.valid){let a={username:this.userForm.value.username,email:this.userForm.value.email,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,enabled:this.userForm.value.enabled};sc.default.fire({title:"Crear usuario",text:"\xBFEst\xE1 seguro de que desea crear este usuario?",icon:"question",showCancelButton:!0,confirmButtonColor:"#334155",cancelButtonColor:"#d33",confirmButtonText:"S\xED, crear",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.createUserWithRoles(a)})}}createUserWithRoles(a){this.loading=!0,this.http.post(`${this.apiUrl}/users`,a,{headers:this.getHeaders()}).subscribe({next:i=>{let l=i.id,h=this.userForm.value.password,s=[];h&&s.push(this.setUserPassword(l,h)),Promise.all(s).then(()=>{this.showSuccess("Usuario creado","El usuario ha sido creado correctamente"),this.resetFormAndReload(),this.loading=!1,sc.default.fire({title:"Usuario creado",text:"\xBFDesea asignar roles ahora?",icon:"success",showCancelButton:!0,confirmButtonText:"S\xED, asignar roles",cancelButtonText:"M\xE1s tarde",confirmButtonColor:"#334155"}).then(T=>{T.isConfirmed&&this.editUser(i)})}).catch(T=>{this.showError("Error","Ocurri\xF3 un error al completar la creaci\xF3n del usuario"),console.error("Error en el proceso de creaci\xF3n:",T),this.loading=!1})},error:i=>{let l="Ocurri\xF3 un error al crear el usuario";try{let h=JSON.parse(i.error);h.errorMessage&&h.errorMessage.includes("User exists with same email")?l="Ya existe un usuario con el mismo correo electr\xF3nico":h.errorMessage&&h.errorMessage.includes("User exists with same username")&&(l="Ya existe un usuario con el mismo nombre de usuario")}catch{}this.showError("Error",l),this.loading=!1}})}setUserPassword(a,i){return new Promise((l,h)=>{let s={type:"password",value:i,temporary:!1};this.http.put(`${this.apiUrl}/password/${a}`,s,{headers:this.getHeaders()}).subscribe({next:()=>l(),error:T=>h(T)})})}assignRolesToUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.post(`${this.apiUrl}/user_roles/user_id/${a}`,s,{headers:this.getHeaders()}).subscribe({next:()=>l(),error:T=>h(T)})})}assignGrafanaRolesToUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.post(`${this.apiUrl}/roles/user_id/${a}`,s,{headers:this.getHeaders()}).subscribe({next:()=>l(),error:T=>h(T)})})}editUser(a){this.selectedUser=a,this.selectedRoles=a.roles?a.roles.map(i=>i.id):[],this.selectedGrafanaRoles=a.grafanaRoles?a.grafanaRoles.map(i=>i.id):[],this.userForm.patchValue({username:a.username,email:a.email,firstName:a.firstName,lastName:a.lastName,enabled:a.enabled,password:""})}assignRoles(a){this.selectedUser=a,this.selectedRoles=a.roles?a.roles.map(i=>i.id):[],this.selectedGrafanaRoles=a.grafanaRoles?a.grafanaRoles.map(i=>i.id):[],setTimeout(()=>{let i=document.querySelector(".user-form");i&&i.scrollIntoView({behavior:"smooth"})},100)}cancelEdit(){this.selectedUser=null,this.selectedRoles=[],this.selectedGrafanaRoles=[],this.userForm.reset(),this.userForm.patchValue({enabled:!0})}updateUser(){if(this.userForm.valid&&this.selectedUser){let a={email:this.userForm.value.email,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,enabled:this.userForm.value.enabled},i=this.selectedUser.id,l=this.userForm.value.password;sc.default.fire({title:"Actualizar usuario",text:"\xBFEst\xE1 seguro de que desea actualizar este usuario?",icon:"question",showCancelButton:!0,confirmButtonColor:"#334155",cancelButtonColor:"#d33",confirmButtonText:"S\xED, actualizar",cancelButtonText:"Cancelar"}).then(h=>{h.isConfirmed&&this.updateUserWithRoles(i,a,l)})}}updateUserWithRoles(a,i,l){this.loading=!0,this.http.put(`${this.apiUrl}/users/${a}`,i,{headers:this.getHeaders()}).subscribe({next:()=>{let h=[];l&&h.push(this.setUserPassword(a,l)),this.selectedUser&&(h.push(this.updateUserRoles(a,this.selectedRoles)),h.push(this.updateUserGrafanaRoles(a,this.selectedGrafanaRoles))),Promise.all(h).then(()=>{this.showSuccess("Usuario actualizado","El usuario ha sido actualizado correctamente"),this.resetFormAndReload(),this.loading=!1}).catch(s=>{this.showError("Error","Ocurri\xF3 un error al actualizar el usuario"),console.error("Error en el proceso de actualizaci\xF3n:",s),this.loading=!1})},error:h=>{this.showError("Error","Ocurri\xF3 un error al actualizar el usuario"),console.error("Error al actualizar usuario:",h),this.loading=!1}})}updateUserRoles(a,i){return new Promise((l,h)=>{this.http.get(`${this.apiUrl}/user_roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:s=>{let T=s.map(G=>G.id),Y=i.filter(G=>!T.includes(G)),K=T.filter(G=>!i.includes(G)),Ce=Y.length>0?this.assignRolesToUser(a,Y):Promise.resolve(),be=K.length>0?this.removeRolesFromUser(a,K):Promise.resolve();Promise.all([Ce,be]).then(()=>l()).catch(G=>h(G))},error:s=>h(s)})})}updateUserGrafanaRoles(a,i){return new Promise((l,h)=>{this.http.get(`${this.apiUrl}/roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:s=>{let T=s.map(G=>G.id),Y=i.filter(G=>!T.includes(G)),K=T.filter(G=>!i.includes(G)),Ce=Y.length>0?this.assignGrafanaRolesToUser(a,Y):Promise.resolve(),be=K.length>0?this.removeGrafanaRolesFromUser(a,K):Promise.resolve();Promise.all([Ce,be]).then(()=>l()).catch(G=>h(G))},error:s=>h(s)})})}removeRolesFromUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.request("DELETE",`${this.apiUrl}/user_roles/user_id/${a}`,{headers:this.getHeaders(),body:s}).subscribe({next:()=>l(),error:T=>h(T)})})}removeGrafanaRolesFromUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.request("DELETE",`${this.apiUrl}/roles/user_id/${a}`,{headers:this.getHeaders(),body:s}).subscribe({next:()=>l(),error:T=>h(T)})})}confirmDelete(a){sc.default.fire({title:"Eliminar usuario",text:"\xBFEst\xE1 seguro de que desea eliminar este usuario? Esta acci\xF3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#334155",confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.deleteUser(a)})}deleteUser(a){this.loading=!0,this.http.delete(`${this.apiUrl}/users/${a}`,{headers:this.getHeaders()}).subscribe({next:()=>{this.showSuccess("Usuario eliminado","El usuario ha sido eliminado correctamente"),this.loadUsers(),this.loading=!1},error:i=>{this.showError("Error","Ocurri\xF3 un error al eliminar el usuario"),console.error("Error al eliminar usuario:",i),this.loading=!1}})}resetFormAndReload(){this.selectedUser=null,this.selectedRoles=[],this.selectedGrafanaRoles=[],this.userForm.reset(),this.userForm.patchValue({enabled:!0}),this.loadUsers()}showSuccess(a,i){sc.default.fire({icon:"success",title:a,text:i,confirmButtonColor:"#334155"})}showError(a,i){sc.default.fire({icon:"error",title:a,text:i,confirmButtonColor:"#334155"})}changeTab(a){this.activeTab=a,a==="usuarios"?this.loadUsers():a==="roles"?(this.loadRoles(),this.loadGrafanaRoles()):a==="auditoria"&&this.loadAuditLogs()}viewRoleDetails(a,i=!1){let l=i?this.getUsersWithGrafanaRole(a.id):this.getUsersWithRole(a.id);sc.default.fire({title:`Detalles del Rol: ${a.name}`,html:`
        <p><strong>Tipo:</strong> ${i?"Grafana":"Sistema"}</p>
        <p><strong>Descripci\xF3n:</strong> ${a.description||"No disponible"}</p>
        <p><strong>Usuarios con este rol (${l.length}):</strong></p>
        <ul>
          ${l.map(h=>`<li>${h.username} (${h.firstName} ${h.lastName})</li>`).join("")}
        </ul>
      `,confirmButtonColor:"#334155"})}static \u0275fac=function(i){return new(i||c)(Ft(ws),Ft(Fm))};static \u0275cmp=rt({type:c,selectors:[["app-user-management"]],decls:17,vars:13,consts:[[1,"container"],["class","loading-overlay",4,"ngIf"],[1,"tabs"],[3,"click"],["class","tab-content",4,"ngIf"],[1,"loading-overlay"],[1,"spinner"],[1,"tab-content"],[1,"user-form"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","username","placeholder","Ingrese nombre de usuario",3,"disabled"],["class","error-message",4,"ngIf"],["type","email","formControlName","email","placeholder","Ingrese correo electr\xF3nico"],["type","text","formControlName","firstName","placeholder","Ingrese nombre"],["type","text","formControlName","lastName","placeholder","Ingrese apellido"],["type","password","formControlName","password",3,"placeholder"],["type","checkbox","formControlName","enabled"],["class","form-group",4,"ngIf"],[1,"form-actions"],["type","submit",3,"disabled"],["type","button",3,"click",4,"ngIf"],[1,"user-list"],[1,"search-bar"],["type","text","placeholder","Buscar usuarios...",3,"ngModelChange","input","ngModel"],[4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],[1,"error-message"],[4,"ngIf"],[1,"roles-container"],["class","role-checkbox",4,"ngFor","ngForOf"],[1,"role-checkbox"],["type","checkbox",3,"change","id","value","checked","disabled"],[3,"for"],["class","role-description",4,"ngIf"],[1,"role-description"],["type","button",3,"click"],["class","role-badge",4,"ngFor","ngForOf"],["class","no-roles",4,"ngIf"],["class","role-badge grafana-role",4,"ngFor","ngForOf"],[1,"actions"],[1,"edit-btn",3,"click"],[1,"role-btn",3,"click"],[1,"delete-btn",3,"click"],[1,"role-badge"],[1,"no-roles"],[1,"role-badge","grafana-role"],[1,"no-results"],["class","user-badge",4,"ngFor","ngForOf"],[1,"user-badge"],[1,"filters"],[1,"filter-group"],[3,"ngModelChange","change","ngModel"],["value",""],["value","USER"],["value","ROLE"],["value","GRAFANA_ROLE"],["value","CREATE"],["value","UPDATE"],["value","DELETE"],[1,"audit-logs"]],template:function(i,l){i&1&&(V(0,"div",0)(1,"h1"),le(2,"Gesti\xF3n de Usuarios"),$(),it(3,Qk,4,0,"div",1),V(4,"div",2)(5,"button",3),_t("click",function(){return l.changeTab("usuarios")}),le(6,"Usuarios"),$(),V(7,"button",3),_t("click",function(){return l.changeTab("roles")}),le(8,"Roles"),$(),V(9,"button",3),_t("click",function(){return l.changeTab("grafana-roles")}),le(10,"Roles Grafana"),$(),V(11,"button",3),_t("click",function(){return l.changeTab("auditoria")}),le(12,"Auditor\xEDa"),$()(),it(13,yA,66,16,"div",4)(14,CA,18,2,"div",4)(15,IA,18,2,"div",4)(16,AA,47,4,"div",4),$()),i&2&&(_e(3),Ge("ngIf",l.loading),_e(2),wi("active",l.activeTab==="usuarios"),_e(2),wi("active",l.activeTab==="roles"),_e(2),wi("active",l.activeTab==="grafana-roles"),_e(2),wi("active",l.activeTab==="auditoria"),_e(2),Ge("ngIf",l.activeTab==="usuarios"),_e(),Ge("ngIf",l.activeTab==="roles"),_e(),Ge("ngIf",l.activeTab==="grafana-roles"),_e(),Ge("ngIf",l.activeTab==="auditoria"))},dependencies:[$r,Hl,Qs,jf,Lm,Dm,Rm,Om,tc,Y0,Su,ic,Pm,id,Ip,Wl,Tu,td],styles:['.container[_ngcontent-%COMP%]{max-width:1200px;margin-left:20%;padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}h1[_ngcontent-%COMP%]{color:#334155;margin-bottom:30px;text-align:center}.tabs[_ngcontent-%COMP%]{display:flex;margin-bottom:20px;border-bottom:1px solid #e2e8f0}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;background:none;border:none;cursor:pointer;font-size:16px;color:#64748b;position:relative;transition:all .3s ease}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#334155}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:#334155;font-weight:700}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-1px;left:0;width:100%;height:2px;background-color:#334155}.tab-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 10px #0000001a}.user-form[_ngcontent-%COMP%]{margin-bottom:30px;padding:20px;background:#f8fafc;border-radius:8px}.user-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;color:#334155;font-size:20px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:15px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:500;color:#334155}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #e2e8f0;border-radius:4px;font-size:14px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus, .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]:focus, .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]:focus, .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#94a3b8}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-left:10px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;font-size:12px;color:#64748b;margin-top:5px}.user-form[_ngcontent-%COMP%]   .roles-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}.user-form[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;background:#e2e8f0;padding:5px 10px;border-radius:20px}.user-form[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:5px}.user-form[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:0;font-weight:400}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:20px}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-weight:500;transition:background-color .3s ease}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#334155;color:#fff}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#1e293b}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#cbd5e1;cursor:not-allowed}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]{background-color:#e2e8f0;color:#334155}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]:hover{background-color:#cbd5e1}.user-list[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{margin-bottom:20px}.user-list[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #e2e8f0;border-radius:4px;font-size:14px}.user-list[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#94a3b8}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #e2e8f0}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;color:#334155;font-weight:600}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.user-list[_ngcontent-%COMP%]   .role-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e2e8f0;color:#334155;padding:3px 8px;border-radius:12px;font-size:12px;margin-right:5px;margin-bottom:5px}.user-list[_ngcontent-%COMP%]   .no-roles[_ngcontent-%COMP%]{color:#94a3b8;font-style:italic;font-size:12px}.user-list[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{color:#16a34a;font-weight:500}.user-list[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]{color:#dc2626;font-weight:500}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:5px}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;font-size:13px;transition:background-color .3s ease}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.edit-btn[_ngcontent-%COMP%]{background-color:#e0f2fe;color:#0369a1}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.edit-btn[_ngcontent-%COMP%]:hover{background-color:#bae6fd}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]{background-color:#fee2e2;color:#b91c1c}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]:hover{background-color:#fecaca}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #e2e8f0}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;color:#334155;font-weight:600}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.roles-list[_ngcontent-%COMP%]   .user-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e2e8f0;color:#334155;padding:3px 8px;border-radius:12px;font-size:12px;margin-right:5px;margin-bottom:5px}.audit-logs[_ngcontent-%COMP%]{margin-top:20px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#334155}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #e2e8f0;border-radius:4px;font-size:14px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#94a3b8}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #e2e8f0}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;color:#334155;font-weight:600}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.no-results[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#64748b;font-style:italic}']})};var zC=[{path:"",component:Pp},{path:"login",component:Pp},{path:"",component:Jm,children:[{path:"inicio",component:eg},{path:"menu",component:ku},{path:"ambiente/residuos/camiones/dashboard",component:tg},{path:"ambiente/calidad/ruido/dashboard",component:ig},{path:"reportes",component:ng},{path:"economico/digital/wifi/dashboard",component:rg},{path:"habitat/movilidad/vamosmed/dashboard",component:og},{path:"habitat/movilidad/dashboard",component:Ig},{path:"perfil/usuarios",component:Pg},{path:"gobernanza/participacion/pqrs/dashboard",component:sg},{path:"whatsapp",component:ag},{path:"calidad/turismo/dashboard",component:lg},{path:"ambiente/calidad/siata/dashboard",component:cg},{path:"ambiente/residuos/camiones/mapa",component:dg},{path:"mapas/reportes",component:ug},{path:"economico/digital/wifi/mapa",component:wg,data:{ssr:!1}},{path:"habitat/movilidad/vamosmed/mapa",component:Mg},{path:"ambiente/calidad/ruido/mapa",component:Sg},{path:"calidad/turismo/map",component:Tg},{path:"ambiente/calidad/siata/mapa",component:Eg}]},{path:"**",redirectTo:"login"}];var DA="@",RA=(()=>{class c{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=me(Hb,{optional:!0});loadingSchedulerFn=me(OA,{optional:!0});_engine;constructor(i,l,h,s,T){this.doc=i,this.delegate=l,this.zone=h,this.animationType=s,this.moduleImpl=T}ngOnDestroy(){this._engine?.flush()}loadImpl(){let i=()=>this.moduleImpl??import("./chunk-32ENRA6D.js").then(h=>h),l;return this.loadingSchedulerFn?l=this.loadingSchedulerFn(i):l=i(),l.catch(h=>{throw new ki(5300,!1)}).then(({\u0275createEngine:h,\u0275AnimationRendererFactory:s})=>{this._engine=h(this.animationType,this.doc);let T=new s(this.delegate,this._engine,this.zone);return this.delegate=T,T})}createRenderer(i,l){let h=this.delegate.createRenderer(i,l);if(h.\u0275type===0)return h;typeof h.throwOnSyntheticProps=="boolean"&&(h.throwOnSyntheticProps=!1);let s=new Zy(h);return l?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(T=>{let Y=T.createRenderer(i,l);s.use(Y),this.scheduler?.notify(11)}).catch(T=>{s.use(h)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static \u0275fac=function(l){If()};static \u0275prov=ot({token:c,factory:c.\u0275fac})}return c})(),Zy=class{delegate;replay=[];\u0275type=1;constructor(a){this.delegate=a}use(a){if(this.delegate=a,this.replay!==null){for(let i of this.replay)i(a);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(a,i){return this.delegate.createElement(a,i)}createComment(a){return this.delegate.createComment(a)}createText(a){return this.delegate.createText(a)}get destroyNode(){return this.delegate.destroyNode}appendChild(a,i){this.delegate.appendChild(a,i)}insertBefore(a,i,l,h){this.delegate.insertBefore(a,i,l,h)}removeChild(a,i,l){this.delegate.removeChild(a,i,l)}selectRootElement(a,i){return this.delegate.selectRootElement(a,i)}parentNode(a){return this.delegate.parentNode(a)}nextSibling(a){return this.delegate.nextSibling(a)}setAttribute(a,i,l,h){this.delegate.setAttribute(a,i,l,h)}removeAttribute(a,i,l){this.delegate.removeAttribute(a,i,l)}addClass(a,i){this.delegate.addClass(a,i)}removeClass(a,i){this.delegate.removeClass(a,i)}setStyle(a,i,l,h){this.delegate.setStyle(a,i,l,h)}removeStyle(a,i,l){this.delegate.removeStyle(a,i,l)}setProperty(a,i,l){this.shouldReplay(i)&&this.replay.push(h=>h.setProperty(a,i,l)),this.delegate.setProperty(a,i,l)}setValue(a,i){this.delegate.setValue(a,i)}listen(a,i,l){return this.shouldReplay(i)&&this.replay.push(h=>h.listen(a,i,l)),this.delegate.listen(a,i,l)}shouldReplay(a){return this.replay!==null&&a.startsWith(DA)}},OA=new ct("");function BC(c="animations"){return N_("NgAsyncAnimations"),Hc([{provide:kf,useFactory:(a,i,l)=>new RA(a,i,l,c),deps:[fi,Kf,hi]},{provide:wo,useValue:c==="noop"?"NoopAnimations":"BrowserAnimations"}])}var NC={providers:[Fw(zC),BC(),Q_()]};var kg=class c{title="mi-aplicacion";static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-root"]],decls:1,vars:0,template:function(i,l){i&1&&Pe(0,"router-outlet")},dependencies:[$r,Kl,gp],encapsulation:2})};$x(kg,NC).catch(c=>console.error(c));
