import{$ as Di,$a as It,$b as er,A as Lh,Aa as Kc,Ab as si,Ac as ed,B as Fm,Ba as ix,Bb as Zh,Bc as Xm,C as Zb,Ca as Si,Cb as gx,Cc as Ym,D as Wl,Da as G_,Db as an,Dc as Qo,E as bn,Ea as nx,Eb as O,Ec as co,F as z_,Fa as jh,Fb as F,Fc as Km,G as na,Ga as rx,Gb as Te,Gc as Qm,H as ql,Ha as Ps,Hb as Wh,Hc as pu,I as Lm,Ia as Io,Ib as qh,Ic as nr,J as B_,Ja as Uh,Jb as Hm,Jc as Tx,K as To,Ka as H_,Kb as Xt,Kc as Xh,L as Wb,La as Bm,Lb as Zm,Lc as Jm,M as zh,Ma as au,Mb as tt,Mc as Ix,N as Xa,Na as $h,Nb as ze,Nc as ef,O as Xl,Oa as lu,Ob as Fr,P as N_,Pa as cu,Pb as Ni,Q as qb,Qa as ox,Qb as lo,Qc as Yh,R as V_,Ra as sx,Rb as ln,Rc as Kh,S as Xb,Sa as ax,Sb as wi,T as Yb,Ta as lx,Tb as Ci,Tc as td,U as j_,Ua as cx,Ub as _x,Uc as tf,V as zm,Va as dx,Vb as yx,Vc as mu,W as ra,Wa as ux,Wb as cn,Wc as kx,X as Cr,Xa as ko,Xb as Y,Xc as Ax,Y as Rn,Ya as qe,Yb as St,Z as Kb,Za as Gh,Zb as Ot,_ as tn,_a as re,_b as Ko,a as Qe,aa as qo,ab as Nm,ac as tr,b as di,ba as st,bb as Vm,bc as ir,ca as $t,cb as jm,cc as Gn,d as jb,da as Qb,db as du,dc as vx,e as ou,ea as ut,eb as uu,ec as xn,f as Dr,fa as U_,fb as Hh,fc as q_,g as Rr,ga as Vt,gb as Yl,gc as Hn,h as Ub,ha as ge,hb as hx,hc as Qc,i as qa,ia as Bh,ib as px,ic as Wm,j as F_,ja as $_,jb as mx,jc as Mr,k as Rm,ka as Xc,kb as Z_,kc as bx,l as qt,la as Jb,lb as rt,lc as yi,m as so,ma as Ss,mb as Gt,mc as Jc,n as Zl,na as Xo,nb as Ht,nc as Ya,o as wr,oa as ao,ob as fx,oc as Es,p as bt,pa as mt,pb as Wr,pc as xx,q as qc,qa as ft,qb as hr,qc as qm,r as Fh,ra as Nh,rb as Xe,rc as wx,s as $b,sa as ex,sb as Um,sc as hu,t as Gb,ta as Yo,tb as $m,tc as Cx,u as Hb,ua as Or,ub as W_,uc as Mx,v as Ft,va as Yc,vb as Gm,vc as vi,w as su,wa as tx,wb as Kl,wc as Sx,x as Eo,xa as Vh,xb as Ri,xc as X_,y as L_,ya as oi,yb as Oe,yc as Px,z as Om,za as _i,zb as qr,zc as Ex}from"./chunk-HIRD76C5.js";var Bp=jb((da,ay)=>{"use strict";(function(c,a){typeof da=="object"&&typeof ay<"u"?ay.exports=a():typeof define=="function"&&define.amd?define(a):(c=typeof globalThis<"u"?globalThis:c||self,c.Sweetalert2=a())})(da,function(){"use strict";function c(M,E,z){if(typeof M=="function"?M===E:M.has(E))return arguments.length<3?E:z;throw new TypeError("Private element is not present on this object")}function a(M,E){if(E.has(M))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(M,E){return M.get(c(M,E))}function l(M,E,z){a(M,E),E.set(M,z)}function h(M,E,z){return M.set(c(M,E),z),z}let s=100,P={},q=()=>{P.previousActiveElement instanceof HTMLElement?(P.previousActiveElement.focus(),P.previousActiveElement=null):document.body&&document.body.focus()},X=M=>new Promise(E=>{if(!M)return E();let z=window.scrollX,oe=window.scrollY;P.restoreFocusTimeout=setTimeout(()=>{q(),E()},s),window.scrollTo(z,oe)}),be="swal2-",$=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"].reduce((M,E)=>(M[E]=be+E,M),{}),ht=["success","warning","info","question","error"].reduce((M,E)=>(M[E]=be+E,M),{}),wt="SweetAlert2:",lt=M=>M.charAt(0).toUpperCase()+M.slice(1),at=M=>{console.warn(`${wt} ${typeof M=="object"?M.join(" "):M}`)},hi=M=>{console.error(`${wt} ${M}`)},Mi=[],At=M=>{Mi.includes(M)||(Mi.push(M),at(M))},bi=(M,E=null)=>{At(`"${M}" is deprecated and will be removed in the next major release.${E?` Use "${E}" instead.`:""}`)},Qi=M=>typeof M=="function"?M():M,pi=M=>M&&typeof M.toPromise=="function",Lr=M=>pi(M)?M.toPromise():Promise.resolve(M),ks=M=>M&&Promise.resolve(M)===M,Zi=()=>document.body.querySelector(`.${$.container}`),rr=M=>{let E=Zi();return E?E.querySelector(M):null},Vi=M=>rr(`.${M}`),kt=()=>Vi($.popup),Xr=()=>Vi($.icon),As=()=>Vi($["icon-content"]),Ds=()=>Vi($.title),mi=()=>Vi($["html-container"]),ho=()=>Vi($.image),Pr=()=>Vi($["progress-steps"]),po=()=>Vi($["validation-message"]),nn=()=>rr(`.${$.actions} .${$.confirm}`),mo=()=>rr(`.${$.actions} .${$.cancel}`),wn=()=>rr(`.${$.actions} .${$.deny}`),Cn=()=>Vi($["input-label"]),mr=()=>rr(`.${$.loader}`),Mn=()=>Vi($.actions),is=()=>Vi($.footer),Yr=()=>Vi($["timer-progress-bar"]),ns=()=>Vi($.close),fr=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,Zn=()=>{let M=kt();if(!M)return[];let E=M.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),z=Array.from(E).sort((it,xt)=>{let ti=parseInt(it.getAttribute("tabindex")||"0"),ri=parseInt(xt.getAttribute("tabindex")||"0");return ti>ri?1:ti<ri?-1:0}),oe=M.querySelectorAll(fr),Fe=Array.from(oe).filter(it=>it.getAttribute("tabindex")!=="-1");return[...new Set(z.concat(Fe))].filter(it=>Ii(it))},Sn=()=>on(document.body,$.shown)&&!on(document.body,$["toast-shown"])&&!on(document.body,$["no-backdrop"]),xi=()=>{let M=kt();return M?on(M,$.toast):!1},Kr=()=>{let M=kt();return M?M.hasAttribute("data-loading"):!1},rn=(M,E)=>{if(M.textContent="",E){let oe=new DOMParser().parseFromString(E,"text/html"),Fe=oe.querySelector("head");Fe&&Array.from(Fe.childNodes).forEach(xt=>{M.appendChild(xt)});let it=oe.querySelector("body");it&&Array.from(it.childNodes).forEach(xt=>{xt instanceof HTMLVideoElement||xt instanceof HTMLAudioElement?M.appendChild(xt.cloneNode(!0)):M.appendChild(xt)})}},on=(M,E)=>{if(!E)return!1;let z=E.split(/\s+/);for(let oe=0;oe<z.length;oe++)if(!M.classList.contains(z[oe]))return!1;return!0},ha=(M,E)=>{Array.from(M.classList).forEach(z=>{!Object.values($).includes(z)&&!Object.values(ht).includes(z)&&!Object.values(E.showClass||{}).includes(z)&&M.classList.remove(z)})},Pn=(M,E,z)=>{if(ha(M,E),!E.customClass)return;let oe=E.customClass[z];if(oe){if(typeof oe!="string"&&!oe.forEach){at(`Invalid type of customClass.${z}! Expected string or iterable object, got "${typeof oe}"`);return}Kt(M,oe)}},Fn=(M,E)=>{if(!E)return null;switch(E){case"select":case"textarea":case"file":return M.querySelector(`.${$.popup} > .${$[E]}`);case"checkbox":return M.querySelector(`.${$.popup} > .${$.checkbox} input`);case"radio":return M.querySelector(`.${$.popup} > .${$.radio} input:checked`)||M.querySelector(`.${$.popup} > .${$.radio} input:first-child`);case"range":return M.querySelector(`.${$.popup} > .${$.range} input`);default:return M.querySelector(`.${$.popup} > .${$.input}`)}},zr=M=>{if(M.focus(),M.type!=="file"){let E=M.value;M.value="",M.value=E}},Lo=(M,E,z)=>{!M||!E||(typeof E=="string"&&(E=E.split(/\s+/).filter(Boolean)),E.forEach(oe=>{Array.isArray(M)?M.forEach(Fe=>{z?Fe.classList.add(oe):Fe.classList.remove(oe)}):z?M.classList.add(oe):M.classList.remove(oe)}))},Kt=(M,E)=>{Lo(M,E,!0)},sn=(M,E)=>{Lo(M,E,!1)},gr=(M,E)=>{let z=Array.from(M.children);for(let oe=0;oe<z.length;oe++){let Fe=z[oe];if(Fe instanceof HTMLElement&&on(Fe,E))return Fe}},Er=(M,E,z)=>{z===`${parseInt(z)}`&&(z=parseInt(z)),z||parseInt(z)===0?M.style.setProperty(E,typeof z=="number"?`${z}px`:z):M.style.removeProperty(E)},ji=(M,E="flex")=>{M&&(M.style.display=E)},Oi=M=>{M&&(M.style.display="none")},Br=(M,E="block")=>{M&&new MutationObserver(()=>{Qr(M,M.innerHTML,E)}).observe(M,{childList:!0,subtree:!0})},fo=(M,E,z,oe)=>{let Fe=M.querySelector(E);Fe&&Fe.style.setProperty(z,oe)},Qr=(M,E,z="flex")=>{E?ji(M,z):Oi(M)},Ii=M=>!!(M&&(M.offsetWidth||M.offsetHeight||M.getClientRects().length)),or=()=>!Ii(nn())&&!Ii(wn())&&!Ii(mo()),Tr=M=>M.scrollHeight>M.clientHeight,xe=(M,E)=>{let z=M;for(;z&&z!==E;){if(Tr(z))return!0;z=z.parentElement}return!1},H=M=>{let E=window.getComputedStyle(M),z=parseFloat(E.getPropertyValue("animation-duration")||"0"),oe=parseFloat(E.getPropertyValue("transition-duration")||"0");return z>0||oe>0},Z=(M,E=!1)=>{let z=Yr();z&&Ii(z)&&(E&&(z.style.transition="none",z.style.width="100%"),setTimeout(()=>{z.style.transition=`width ${M/1e3}s linear`,z.style.width="0%"},10))},J=()=>{let M=Yr();if(!M)return;let E=parseInt(window.getComputedStyle(M).width);M.style.removeProperty("transition"),M.style.width="100%";let z=parseInt(window.getComputedStyle(M).width),oe=E/z*100;M.style.width=`${oe}%`},le=()=>typeof window>"u"||typeof document>"u",fe=`
 <div aria-labelledby="${$.title}" aria-describedby="${$["html-container"]}" class="${$.popup}" tabindex="-1">
   <button type="button" class="${$.close}"></button>
   <ul class="${$["progress-steps"]}"></ul>
   <div class="${$.icon}"></div>
   <img class="${$.image}" />
   <h2 class="${$.title}" id="${$.title}"></h2>
   <div class="${$["html-container"]}" id="${$["html-container"]}"></div>
   <input class="${$.input}" id="${$.input}" />
   <input type="file" class="${$.file}" />
   <div class="${$.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${$.select}" id="${$.select}"></select>
   <div class="${$.radio}"></div>
   <label class="${$.checkbox}">
     <input type="checkbox" id="${$.checkbox}" />
     <span class="${$.label}"></span>
   </label>
   <textarea class="${$.textarea}" id="${$.textarea}"></textarea>
   <div class="${$["validation-message"]}" id="${$["validation-message"]}"></div>
   <div class="${$.actions}">
     <div class="${$.loader}"></div>
     <button type="button" class="${$.confirm}"></button>
     <button type="button" class="${$.deny}"></button>
     <button type="button" class="${$.cancel}"></button>
   </div>
   <div class="${$.footer}"></div>
   <div class="${$["timer-progress-bar-container"]}">
     <div class="${$["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),Q=()=>{let M=Zi();return M?(M.remove(),sn([document.documentElement,document.body],[$["no-backdrop"],$["toast-shown"],$["has-column"]]),!0):!1},Me=()=>{P.currentInstance.resetValidationMessage()},ye=()=>{let M=kt(),E=gr(M,$.input),z=gr(M,$.file),oe=M.querySelector(`.${$.range} input`),Fe=M.querySelector(`.${$.range} output`),it=gr(M,$.select),xt=M.querySelector(`.${$.checkbox} input`),ti=gr(M,$.textarea);E.oninput=Me,z.onchange=Me,it.onchange=Me,xt.onchange=Me,ti.oninput=Me,oe.oninput=()=>{Me(),Fe.value=oe.value},oe.onchange=()=>{Me(),Fe.value=oe.value}},Ce=M=>typeof M=="string"?document.querySelector(M):M,Ee=M=>{let E=kt();E.setAttribute("role",M.toast?"alert":"dialog"),E.setAttribute("aria-live",M.toast?"polite":"assertive"),M.toast||E.setAttribute("aria-modal","true")},we=M=>{window.getComputedStyle(M).direction==="rtl"&&Kt(Zi(),$.rtl)},je=M=>{let E=Q();if(le()){hi("SweetAlert2 requires document to initialize");return}let z=document.createElement("div");z.className=$.container,E&&Kt(z,$["no-transition"]),rn(z,fe),z.dataset.swal2Theme=M.theme;let oe=Ce(M.target);oe.appendChild(z),M.topLayer&&(z.setAttribute("popover",""),z.showPopover()),Ee(M),we(oe),ye()},Ye=(M,E)=>{M instanceof HTMLElement?E.appendChild(M):typeof M=="object"?et(M,E):M&&rn(E,M)},et=(M,E)=>{M.jquery?gt(E,M):rn(E,M.toString())},gt=(M,E)=>{if(M.textContent="",0 in E)for(let z=0;z in E;z++)M.appendChild(E[z].cloneNode(!0));else M.appendChild(E.cloneNode(!0))},Dt=(M,E)=>{let z=Mn(),oe=mr();!z||!oe||(!E.showConfirmButton&&!E.showDenyButton&&!E.showCancelButton?Oi(z):ji(z),Pn(z,E,"actions"),Pt(z,oe,E),rn(oe,E.loaderHtml||""),Pn(oe,E,"loader"))};function Pt(M,E,z){let oe=nn(),Fe=wn(),it=mo();!oe||!Fe||!it||(jt(oe,"confirm",z),jt(Fe,"deny",z),jt(it,"cancel",z),De(oe,Fe,it,z),z.reverseButtons&&(z.toast?(M.insertBefore(it,oe),M.insertBefore(Fe,oe)):(M.insertBefore(it,E),M.insertBefore(Fe,E),M.insertBefore(oe,E))))}function De(M,E,z,oe){if(!oe.buttonsStyling){sn([M,E,z],$.styled);return}Kt([M,E,z],$.styled),oe.confirmButtonColor&&M.style.setProperty("--swal2-confirm-button-background-color",oe.confirmButtonColor),oe.denyButtonColor&&E.style.setProperty("--swal2-deny-button-background-color",oe.denyButtonColor),oe.cancelButtonColor&&z.style.setProperty("--swal2-cancel-button-background-color",oe.cancelButtonColor),ai(M),ai(E),ai(z)}function ai(M){let E=window.getComputedStyle(M);if(E.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;let z=E.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");M.style.setProperty("--swal2-action-button-focus-box-shadow",E.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${z}`))}function jt(M,E,z){let oe=lt(E);Qr(M,z[`show${oe}Button`],"inline-block"),rn(M,z[`${E}ButtonText`]||""),M.setAttribute("aria-label",z[`${E}ButtonAriaLabel`]||""),M.className=$[E],Pn(M,z,`${E}Button`)}let li=(M,E)=>{let z=ns();z&&(rn(z,E.closeButtonHtml||""),Pn(z,E,"closeButton"),Qr(z,E.showCloseButton),z.setAttribute("aria-label",E.closeButtonAriaLabel||""))},Mt=(M,E)=>{let z=Zi();z&&(Ve(z,E.backdrop),yt(z,E.position),Rt(z,E.grow),Pn(z,E,"container"))};function Ve(M,E){typeof E=="string"?M.style.background=E:E||Kt([document.documentElement,document.body],$["no-backdrop"])}function yt(M,E){E&&(E in $?Kt(M,$[E]):(at('The "position" parameter is not valid, defaulting to "center"'),Kt(M,$.center)))}function Rt(M,E){E&&Kt(M,$[`grow-${E}`])}var Tt={innerParams:new WeakMap,domCache:new WeakMap};let Ui=["input","file","range","select","radio","checkbox","textarea"],sr=(M,E)=>{let z=kt();if(!z)return;let oe=Tt.innerParams.get(M),Fe=!oe||E.input!==oe.input;Ui.forEach(it=>{let xt=gr(z,$[it]);xt&&(pa(it,E.inputAttributes),xt.className=$[it],Fe&&Oi(xt))}),E.input&&(Fe&&zt(E),rs(E))},zt=M=>{if(!M.input)return;if(!ui[M.input]){hi(`Unexpected type of input! Expected ${Object.keys(ui).join(" | ")}, got "${M.input}"`);return}let E=zo(M.input);if(!E)return;let z=ui[M.input](E,M);ji(E),M.inputAutoFocus&&setTimeout(()=>{zr(z)})},Rs=M=>{for(let E=0;E<M.attributes.length;E++){let z=M.attributes[E].name;["id","type","value","style"].includes(z)||M.removeAttribute(z)}},pa=(M,E)=>{let z=kt();if(!z)return;let oe=Fn(z,M);if(oe){Rs(oe);for(let Fe in E)oe.setAttribute(Fe,E[Fe])}},rs=M=>{if(!M.input)return;let E=zo(M.input);E&&Pn(E,M,"input")},os=(M,E)=>{!M.placeholder&&E.inputPlaceholder&&(M.placeholder=E.inputPlaceholder)},_r=(M,E,z)=>{if(z.inputLabel){let oe=document.createElement("label"),Fe=$["input-label"];oe.setAttribute("for",M.id),oe.className=Fe,typeof z.customClass=="object"&&Kt(oe,z.customClass.inputLabel),oe.innerText=z.inputLabel,E.insertAdjacentElement("beforebegin",oe)}},zo=M=>{let E=kt();if(E)return gr(E,$[M]||$.input)},Fi=(M,E)=>{["string","number"].includes(typeof E)?M.value=`${E}`:ks(E)||at(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof E}"`)},ui={};ui.text=ui.email=ui.password=ui.number=ui.tel=ui.url=ui.search=ui.date=ui["datetime-local"]=ui.time=ui.week=ui.month=(M,E)=>(Fi(M,E.inputValue),_r(M,M,E),os(M,E),M.type=E.input,M),ui.file=(M,E)=>(_r(M,M,E),os(M,E),M),ui.range=(M,E)=>{let z=M.querySelector("input"),oe=M.querySelector("output");return Fi(z,E.inputValue),z.type=E.input,Fi(oe,E.inputValue),_r(z,M,E),M},ui.select=(M,E)=>{if(M.textContent="",E.inputPlaceholder){let z=document.createElement("option");rn(z,E.inputPlaceholder),z.value="",z.disabled=!0,z.selected=!0,M.appendChild(z)}return _r(M,M,E),M},ui.radio=M=>(M.textContent="",M),ui.checkbox=(M,E)=>{let z=Fn(kt(),"checkbox");z.value="1",z.checked=!!E.inputValue;let oe=M.querySelector("span");return rn(oe,E.inputPlaceholder||E.inputLabel),z},ui.textarea=(M,E)=>{Fi(M,E.inputValue),os(M,E),_r(M,M,E);let z=oe=>parseInt(window.getComputedStyle(oe).marginLeft)+parseInt(window.getComputedStyle(oe).marginRight);return setTimeout(()=>{if("MutationObserver"in window){let oe=parseInt(window.getComputedStyle(kt()).width),Fe=()=>{if(!document.body.contains(M))return;let it=M.offsetWidth+z(M);it>oe?kt().style.width=`${it}px`:Er(kt(),"width",E.width)};new MutationObserver(Fe).observe(M,{attributes:!0,attributeFilter:["style"]})}}),M};let ki=(M,E)=>{let z=mi();z&&(Br(z),Pn(z,E,"htmlContainer"),E.html?(Ye(E.html,z),ji(z,"block")):E.text?(z.textContent=E.text,ji(z,"block")):Oi(z),sr(M,E))},ma=(M,E)=>{let z=is();z&&(Br(z),Qr(z,E.footer,"block"),E.footer&&Ye(E.footer,z),Pn(z,E,"footer"))},Os=(M,E)=>{let z=Tt.innerParams.get(M),oe=Xr();if(!oe)return;if(z&&E.icon===z.icon){ll(oe,E),al(oe,E);return}if(!E.icon&&!E.iconHtml){Oi(oe);return}if(E.icon&&Object.keys(ht).indexOf(E.icon)===-1){hi(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${E.icon}"`),Oi(oe);return}ji(oe),ll(oe,E),al(oe,E),Kt(oe,E.showClass&&E.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",Bo)},al=(M,E)=>{for(let[z,oe]of Object.entries(ht))E.icon!==z&&sn(M,oe);Kt(M,E.icon&&ht[E.icon]),pd(M,E),Bo(),Pn(M,E,"icon")},Bo=()=>{let M=kt();if(!M)return;let E=window.getComputedStyle(M).getPropertyValue("background-color"),z=M.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let oe=0;oe<z.length;oe++)z[oe].style.backgroundColor=E},go=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,hd=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,ll=(M,E)=>{if(!E.icon&&!E.iconHtml)return;let z=M.innerHTML,oe="";E.iconHtml?oe=ss(E.iconHtml):E.icon==="success"?(oe=go,z=z.replace(/ style=".*?"/g,"")):E.icon==="error"?oe=hd:E.icon&&(oe=ss({question:"?",warning:"!",info:"i"}[E.icon])),z.trim()!==oe.trim()&&rn(M,oe)},pd=(M,E)=>{if(E.iconColor){M.style.color=E.iconColor,M.style.borderColor=E.iconColor;for(let z of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])fo(M,z,"background-color",E.iconColor);fo(M,".swal2-success-ring","border-color",E.iconColor)}},ss=M=>`<div class="${$["icon-content"]}">${M}</div>`,md=(M,E)=>{let z=ho();if(z){if(!E.imageUrl){Oi(z);return}ji(z,""),z.setAttribute("src",E.imageUrl),z.setAttribute("alt",E.imageAlt||""),Er(z,"width",E.imageWidth),Er(z,"height",E.imageHeight),z.className=$.image,Pn(z,E,"image")}},uc=!1,fd=0,gd=0,hc=0,cl=0,as=M=>{M.addEventListener("mousedown",fa),document.body.addEventListener("mousemove",Jr),M.addEventListener("mouseup",Fs),M.addEventListener("touchstart",fa),document.body.addEventListener("touchmove",Jr),M.addEventListener("touchend",Fs)},pc=M=>{M.removeEventListener("mousedown",fa),document.body.removeEventListener("mousemove",Jr),M.removeEventListener("mouseup",Fs),M.removeEventListener("touchstart",fa),document.body.removeEventListener("touchmove",Jr),M.removeEventListener("touchend",Fs)},fa=M=>{let E=kt();if(M.target===E||Xr().contains(M.target)){uc=!0;let z=_d(M);fd=z.clientX,gd=z.clientY,hc=parseInt(E.style.insetInlineStart)||0,cl=parseInt(E.style.insetBlockStart)||0,Kt(E,"swal2-dragging")}},Jr=M=>{let E=kt();if(uc){let{clientX:z,clientY:oe}=_d(M);E.style.insetInlineStart=`${hc+(z-fd)}px`,E.style.insetBlockStart=`${cl+(oe-gd)}px`}},Fs=()=>{let M=kt();uc=!1,sn(M,"swal2-dragging")},_d=M=>{let E=0,z=0;return M.type.startsWith("mouse")?(E=M.clientX,z=M.clientY):M.type.startsWith("touch")&&(E=M.touches[0].clientX,z=M.touches[0].clientY),{clientX:E,clientY:z}},ga=(M,E)=>{let z=Zi(),oe=kt();if(!(!z||!oe)){if(E.toast){Er(z,"width",E.width),oe.style.width="100%";let Fe=mr();Fe&&oe.insertBefore(Fe,Xr())}else Er(oe,"width",E.width);Er(oe,"padding",E.padding),E.color&&(oe.style.color=E.color),E.background&&(oe.style.background=E.background),Oi(po()),_a(oe,E),E.draggable&&!E.toast?(Kt(oe,$.draggable),as(oe)):(sn(oe,$.draggable),pc(oe))}},_a=(M,E)=>{let z=E.showClass||{};M.className=`${$.popup} ${Ii(M)?z.popup:""}`,E.toast?(Kt([document.documentElement,document.body],$["toast-shown"]),Kt(M,$.toast)):Kt(M,$.modal),Pn(M,E,"popup"),typeof E.customClass=="string"&&Kt(M,E.customClass),E.icon&&Kt(M,$[`icon-${E.icon}`])},mc=(M,E)=>{let z=Pr();if(!z)return;let{progressSteps:oe,currentProgressStep:Fe}=E;if(!oe||oe.length===0||Fe===void 0){Oi(z);return}ji(z),z.textContent="",Fe>=oe.length&&at("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),oe.forEach((it,xt)=>{let ti=Wn(it);if(z.appendChild(ti),xt===Fe&&Kt(ti,$["active-progress-step"]),xt!==oe.length-1){let ri=ei(E);z.appendChild(ri)}})},Wn=M=>{let E=document.createElement("li");return Kt(E,$["progress-step"]),rn(E,M),E},ei=M=>{let E=document.createElement("li");return Kt(E,$["progress-step-line"]),M.progressStepsDistance&&Er(E,"width",M.progressStepsDistance),E},Ls=(M,E)=>{let z=Ds();z&&(Br(z),Qr(z,E.title||E.titleText,"block"),E.title&&Ye(E.title,z),E.titleText&&(z.innerText=E.titleText),Pn(z,E,"title"))},Ln=(M,E)=>{ga(M,E),Mt(M,E),mc(M,E),Os(M,E),md(M,E),Ls(M,E),li(M,E),ki(M,E),Dt(M,E),ma(M,E);let z=kt();typeof E.didRender=="function"&&z&&E.didRender(z),P.eventEmitter.emit("didRender",z)},ls=()=>Ii(kt()),Zt=()=>{var M;return(M=nn())===null||M===void 0?void 0:M.click()},ya=()=>{var M;return(M=wn())===null||M===void 0?void 0:M.click()},va=()=>{var M;return(M=mo())===null||M===void 0?void 0:M.click()},Nr=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),qn=M=>{M.keydownTarget&&M.keydownHandlerAdded&&(M.keydownTarget.removeEventListener("keydown",M.keydownHandler,{capture:M.keydownListenerCapture}),M.keydownHandlerAdded=!1)},En=(M,E,z)=>{qn(M),E.toast||(M.keydownHandler=oe=>zs(E,oe,z),M.keydownTarget=E.keydownListenerCapture?window:kt(),M.keydownListenerCapture=E.keydownListenerCapture,M.keydownTarget.addEventListener("keydown",M.keydownHandler,{capture:M.keydownListenerCapture}),M.keydownHandlerAdded=!0)},$i=(M,E)=>{var z;let oe=Zn();if(oe.length){M=M+E,M===-2&&(M=oe.length-1),M===oe.length?M=0:M===-1&&(M=oe.length-1),oe[M].focus();return}(z=kt())===null||z===void 0||z.focus()},pn=["ArrowRight","ArrowDown"],Pi=["ArrowLeft","ArrowUp"],zs=(M,E,z)=>{M&&(E.isComposing||E.keyCode===229||(M.stopKeydownPropagation&&E.stopPropagation(),E.key==="Enter"?Xn(E,M):E.key==="Tab"?yr(E):[...pn,...Pi].includes(E.key)?ar(E.key):E.key==="Escape"&&ba(E,M,z)))},Xn=(M,E)=>{if(!Qi(E.allowEnterKey))return;let z=Fn(kt(),E.input);if(M.target&&z&&M.target instanceof HTMLElement&&M.target.outerHTML===z.outerHTML){if(["textarea","file"].includes(E.input))return;Zt(),M.preventDefault()}},yr=M=>{let E=M.target,z=Zn(),oe=-1;for(let Fe=0;Fe<z.length;Fe++)if(E===z[Fe]){oe=Fe;break}M.shiftKey?$i(oe,-1):$i(oe,1),M.stopPropagation(),M.preventDefault()},ar=M=>{let E=Mn(),z=nn(),oe=wn(),Fe=mo();if(!E||!z||!oe||!Fe)return;let it=[z,oe,Fe];if(document.activeElement instanceof HTMLElement&&!it.includes(document.activeElement))return;let xt=pn.includes(M)?"nextElementSibling":"previousElementSibling",ti=document.activeElement;if(ti){for(let ri=0;ri<E.children.length;ri++){if(ti=ti[xt],!ti)return;if(ti instanceof HTMLButtonElement&&Ii(ti))break}ti instanceof HTMLButtonElement&&ti.focus()}},ba=(M,E,z)=>{Qi(E.allowEscapeKey)&&(M.preventDefault(),z(Nr.esc))};var ci={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};let Gi=()=>{let M=Zi();Array.from(document.body.children).forEach(z=>{z.contains(M)||(z.hasAttribute("aria-hidden")&&z.setAttribute("data-previous-aria-hidden",z.getAttribute("aria-hidden")||""),z.setAttribute("aria-hidden","true"))})},Wt=()=>{Array.from(document.body.children).forEach(E=>{E.hasAttribute("data-previous-aria-hidden")?(E.setAttribute("aria-hidden",E.getAttribute("data-previous-aria-hidden")||""),E.removeAttribute("data-previous-aria-hidden")):E.removeAttribute("aria-hidden")})},Et=typeof window<"u"&&!!window.GestureEvent,Bs=()=>{if(Et&&!on(document.body,$.iosfix)){let M=document.body.scrollTop;document.body.style.top=`${M*-1}px`,Kt(document.body,$.iosfix),Bt()}},Bt=()=>{let M=Zi();if(!M)return;let E;M.ontouchstart=z=>{E=dl(z)},M.ontouchmove=z=>{E&&(z.preventDefault(),z.stopPropagation())}},dl=M=>{let E=M.target,z=Zi(),oe=mi();return!z||!oe||zn(M)||fc(M)?!1:E===z||!Tr(z)&&E instanceof HTMLElement&&!xe(E,oe)&&E.tagName!=="INPUT"&&E.tagName!=="TEXTAREA"&&!(Tr(oe)&&oe.contains(E))},zn=M=>M.touches&&M.touches.length&&M.touches[0].touchType==="stylus",fc=M=>M.touches&&M.touches.length>1,gc=()=>{if(on(document.body,$.iosfix)){let M=parseInt(document.body.style.top,10);sn(document.body,$.iosfix),document.body.style.top="",document.body.scrollTop=M*-1}},xa=()=>{let M=document.createElement("div");M.className=$["scrollbar-measure"],document.body.appendChild(M);let E=M.getBoundingClientRect().width-M.clientWidth;return document.body.removeChild(M),E},Vr=null,wa=M=>{Vr===null&&(document.body.scrollHeight>window.innerHeight||M==="scroll")&&(Vr=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Vr+xa()}px`)},_c=()=>{Vr!==null&&(document.body.style.paddingRight=`${Vr}px`,Vr=null)};function Ca(M,E,z,oe){xi()?Sa(M,oe):(X(z).then(()=>Sa(M,oe)),qn(P)),Et?(E.setAttribute("style","display:none !important"),E.removeAttribute("class"),E.innerHTML=""):E.remove(),Sn()&&(_c(),gc(),Wt()),Ma()}function Ma(){sn([document.documentElement,document.body],[$.shown,$["height-auto"],$["no-backdrop"],$["toast-shown"]])}function lr(M){M=Vo(M);let E=ci.swalPromiseResolve.get(this),z=mn(this);this.isAwaitingPromise?M.isDismissed||(_o(this),E(M)):z&&E(M)}let mn=M=>{let E=kt();if(!E)return!1;let z=Tt.innerParams.get(M);if(!z||on(E,z.hideClass.popup))return!1;sn(E,z.showClass.popup),Kt(E,z.hideClass.popup);let oe=Zi();return sn(oe,z.showClass.backdrop),Kt(oe,z.hideClass.backdrop),fn(M,E,z),!0};function No(M){let E=ci.swalPromiseReject.get(this);_o(this),E&&E(M)}let _o=M=>{M.isAwaitingPromise&&(delete M.isAwaitingPromise,Tt.innerParams.get(M)||M._destroy())},Vo=M=>typeof M>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},M),fn=(M,E,z)=>{var oe;let Fe=Zi(),it=H(E);typeof z.willClose=="function"&&z.willClose(E),(oe=P.eventEmitter)===null||oe===void 0||oe.emit("willClose",E),it?ul(M,E,Fe,z.returnFocus,z.didClose):Ca(M,Fe,z.returnFocus,z.didClose)},ul=(M,E,z,oe,Fe)=>{P.swalCloseEventFinishedCallback=Ca.bind(null,M,z,oe,Fe);let it=function(xt){if(xt.target===E){var ti;(ti=P.swalCloseEventFinishedCallback)===null||ti===void 0||ti.call(P),delete P.swalCloseEventFinishedCallback,E.removeEventListener("animationend",it),E.removeEventListener("transitionend",it)}};E.addEventListener("animationend",it),E.addEventListener("transitionend",it)},Sa=(M,E)=>{setTimeout(()=>{var z;typeof E=="function"&&E.bind(M.params)(),(z=P.eventEmitter)===null||z===void 0||z.emit("didClose"),M._destroy&&M._destroy()})},cs=M=>{let E=kt();if(E||new qs,E=kt(),!E)return;let z=mr();xi()?Oi(Xr()):Nu(E,M),ji(z),E.setAttribute("data-loading","true"),E.setAttribute("aria-busy","true"),E.focus()},Nu=(M,E)=>{let z=Mn(),oe=mr();!z||!oe||(!E&&Ii(nn())&&(E=nn()),ji(z),E&&(Oi(E),oe.setAttribute("data-button-to-replace",E.className),z.insertBefore(oe,E)),Kt([M,z],$.loading))},Bn=(M,E)=>{E.input==="select"||E.input==="radio"?Ir(M,E):["text","email","number","tel","textarea"].some(z=>z===E.input)&&(pi(E.inputValue)||ks(E.inputValue))&&(cs(nn()),us(M,E))},Pa=(M,E)=>{let z=M.getInput();if(!z)return null;switch(E.input){case"checkbox":return eo(z);case"radio":return ds(z);case"file":return Ea(z);default:return E.inputAutoTrim?z.value.trim():z.value}},eo=M=>M.checked?1:0,ds=M=>M.checked?M.value:null,Ea=M=>M.files&&M.files.length?M.getAttribute("multiple")!==null?M.files:M.files[0]:null,Ir=(M,E)=>{let z=kt();if(!z)return;let oe=Fe=>{E.input==="select"?hl(z,Ns(Fe),E):E.input==="radio"&&Vu(z,Ns(Fe),E)};pi(E.inputOptions)||ks(E.inputOptions)?(cs(nn()),Lr(E.inputOptions).then(Fe=>{M.hideLoading(),oe(Fe)})):typeof E.inputOptions=="object"?oe(E.inputOptions):hi(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof E.inputOptions}`)},us=(M,E)=>{let z=M.getInput();z&&(Oi(z),Lr(E.inputValue).then(oe=>{z.value=E.input==="number"?`${parseFloat(oe)||0}`:`${oe}`,ji(z),z.focus(),M.hideLoading()}).catch(oe=>{hi(`Error in inputValue promise: ${oe}`),z.value="",ji(z),z.focus(),M.hideLoading()}))};function hl(M,E,z){let oe=gr(M,$.select);if(!oe)return;let Fe=(it,xt,ti)=>{let ri=document.createElement("option");ri.value=ti,rn(ri,xt),ri.selected=yd(ti,z.inputValue),it.appendChild(ri)};E.forEach(it=>{let xt=it[0],ti=it[1];if(Array.isArray(ti)){let ri=document.createElement("optgroup");ri.label=xt,ri.disabled=!1,oe.appendChild(ri),ti.forEach($o=>Fe(ri,$o[1],$o[0]))}else Fe(oe,ti,xt)}),oe.focus()}function Vu(M,E,z){let oe=gr(M,$.radio);if(!oe)return;E.forEach(it=>{let xt=it[0],ti=it[1],ri=document.createElement("input"),$o=document.createElement("label");ri.type="radio",ri.name=$.radio,ri.value=xt,yd(xt,z.inputValue)&&(ri.checked=!0);let _s=document.createElement("span");rn(_s,ti),_s.className=$.label,$o.appendChild(ri),$o.appendChild(_s),oe.appendChild($o)});let Fe=oe.querySelectorAll("input");Fe.length&&Fe[0].focus()}let Ns=M=>{let E=[];return M instanceof Map?M.forEach((z,oe)=>{let Fe=z;typeof Fe=="object"&&(Fe=Ns(Fe)),E.push([oe,Fe])}):Object.keys(M).forEach(z=>{let oe=M[z];typeof oe=="object"&&(oe=Ns(oe)),E.push([z,oe])}),E},yd=(M,E)=>!!E&&E.toString()===M.toString(),ju=M=>{let E=Tt.innerParams.get(M);M.disableButtons(),E.input?hs(M,"confirm"):fl(M,!0)},Uu=M=>{let E=Tt.innerParams.get(M);M.disableButtons(),E.returnInputValueOnDeny?hs(M,"deny"):Vs(M,!1)},pl=(M,E)=>{M.disableButtons(),E(Nr.cancel)},hs=(M,E)=>{let z=Tt.innerParams.get(M);if(!z.input){hi(`The "input" parameter is needed to be set when using returnInputValueOn${lt(E)}`);return}let oe=M.getInput(),Fe=Pa(M,z);z.inputValidator?ml(M,Fe,E):oe&&!oe.checkValidity()?(M.enableButtons(),M.showValidationMessage(z.validationMessage||oe.validationMessage)):E==="deny"?Vs(M,Fe):fl(M,Fe)},ml=(M,E,z)=>{let oe=Tt.innerParams.get(M);M.disableInput(),Promise.resolve().then(()=>Lr(oe.inputValidator(E,oe.validationMessage))).then(it=>{M.enableButtons(),M.enableInput(),it?M.showValidationMessage(it):z==="deny"?Vs(M,E):fl(M,E)})},Vs=(M,E)=>{let z=Tt.innerParams.get(M||void 0);z.showLoaderOnDeny&&cs(wn()),z.preDeny?(M.isAwaitingPromise=!0,Promise.resolve().then(()=>Lr(z.preDeny(E,z.validationMessage))).then(Fe=>{Fe===!1?(M.hideLoading(),_o(M)):M.close({isDenied:!0,value:typeof Fe>"u"?E:Fe})}).catch(Fe=>jr(M||void 0,Fe))):M.close({isDenied:!0,value:E})},Ta=(M,E)=>{M.close({isConfirmed:!0,value:E})},jr=(M,E)=>{M.rejectPromise(E)},fl=(M,E)=>{let z=Tt.innerParams.get(M||void 0);z.showLoaderOnConfirm&&cs(),z.preConfirm?(M.resetValidationMessage(),M.isAwaitingPromise=!0,Promise.resolve().then(()=>Lr(z.preConfirm(E,z.validationMessage))).then(Fe=>{Ii(po())||Fe===!1?(M.hideLoading(),_o(M)):Ta(M,typeof Fe>"u"?E:Fe)}).catch(Fe=>jr(M||void 0,Fe))):Ta(M,E)};function js(){let M=Tt.innerParams.get(this);if(!M)return;let E=Tt.domCache.get(this);Oi(E.loader),xi()?M.icon&&ji(Xr()):Ia(E),sn([E.popup,E.actions],$.loading),E.popup.removeAttribute("aria-busy"),E.popup.removeAttribute("data-loading"),E.confirmButton.disabled=!1,E.denyButton.disabled=!1,E.cancelButton.disabled=!1}let Ia=M=>{let E=M.popup.getElementsByClassName(M.loader.getAttribute("data-button-to-replace"));E.length?ji(E[0],"inline-block"):or()&&Oi(M.actions)};function Us(){let M=Tt.innerParams.get(this),E=Tt.domCache.get(this);return E?Fn(E.popup,M.input):null}function vd(M,E,z){let oe=Tt.domCache.get(M);E.forEach(Fe=>{oe[Fe].disabled=z})}function ka(M,E){let z=kt();if(!(!z||!M))if(M.type==="radio"){let oe=z.querySelectorAll(`[name="${$.radio}"]`);for(let Fe=0;Fe<oe.length;Fe++)oe[Fe].disabled=E}else M.disabled=E}function yc(){vd(this,["confirmButton","denyButton","cancelButton"],!1)}function jo(){vd(this,["confirmButton","denyButton","cancelButton"],!0)}function vc(){ka(this.getInput(),!1)}function bc(){ka(this.getInput(),!0)}function bd(M){let E=Tt.domCache.get(this),z=Tt.innerParams.get(this);rn(E.validationMessage,M),E.validationMessage.className=$["validation-message"],z.customClass&&z.customClass.validationMessage&&Kt(E.validationMessage,z.customClass.validationMessage),ji(E.validationMessage);let oe=this.getInput();oe&&(oe.setAttribute("aria-invalid","true"),oe.setAttribute("aria-describedby",$["validation-message"]),zr(oe),Kt(oe,$.inputerror))}function xc(){let M=Tt.domCache.get(this);M.validationMessage&&Oi(M.validationMessage);let E=this.getInput();E&&(E.removeAttribute("aria-invalid"),E.removeAttribute("aria-describedby"),sn(E,$.inputerror))}let to={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},xd=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],wd={allowEnterKey:void 0},Cd=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],gl=M=>Object.prototype.hasOwnProperty.call(to,M),yo=M=>xd.indexOf(M)!==-1,wc=M=>wd[M],Md=M=>{gl(M)||at(`Unknown parameter "${M}"`)},$s=M=>{Cd.includes(M)&&at(`The parameter "${M}" is incompatible with toasts`)},Sd=M=>{let E=wc(M);E&&bi(M,E)},Aa=M=>{M.backdrop===!1&&M.allowOutsideClick&&at('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),M.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(M.theme)&&at(`Invalid theme "${M.theme}"`);for(let E in M)Md(E),M.toast&&$s(E),Sd(E)};function Pd(M){let E=Zi(),z=kt(),oe=Tt.innerParams.get(this);if(!z||on(z,oe.hideClass.popup)){at("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}let Fe=$u(M),it=Object.assign({},oe,Fe);Aa(it),E.dataset.swal2Theme=it.theme,Ln(this,it),Tt.innerParams.set(this,it),Object.defineProperties(this,{params:{value:Object.assign({},this.params,M),writable:!1,enumerable:!0}})}let $u=M=>{let E={};return Object.keys(M).forEach(z=>{yo(z)?E[z]=M[z]:at(`Invalid parameter to update: ${z}`)}),E};function _l(){let M=Tt.domCache.get(this),E=Tt.innerParams.get(this);if(!E){Cc(this);return}M.popup&&P.swalCloseEventFinishedCallback&&(P.swalCloseEventFinishedCallback(),delete P.swalCloseEventFinishedCallback),typeof E.didDestroy=="function"&&E.didDestroy(),P.eventEmitter.emit("didDestroy"),Ed(this)}let Ed=M=>{Cc(M),delete M.params,delete P.keydownHandler,delete P.keydownTarget,delete P.currentInstance},Cc=M=>{M.isAwaitingPromise?(Da(Tt,M),M.isAwaitingPromise=!0):(Da(ci,M),Da(Tt,M),delete M.isAwaitingPromise,delete M.disableButtons,delete M.enableButtons,delete M.getInput,delete M.disableInput,delete M.enableInput,delete M.hideLoading,delete M.disableLoading,delete M.showValidationMessage,delete M.resetValidationMessage,delete M.close,delete M.closePopup,delete M.closeModal,delete M.closeToast,delete M.rejectPromise,delete M.update,delete M._destroy)},Da=(M,E)=>{for(let z in M)M[z].delete(E)};var Td=Object.freeze({__proto__:null,_destroy:_l,close:lr,closeModal:lr,closePopup:lr,closeToast:lr,disableButtons:jo,disableInput:bc,disableLoading:js,enableButtons:yc,enableInput:vc,getInput:Us,handleAwaitingPromise:_o,hideLoading:js,rejectPromise:No,resetValidationMessage:xc,showValidationMessage:bd,update:Pd});let ni=(M,E,z)=>{M.toast?vo(M,E,z):(Sc(E),Id(E),Pc(M,E,z))},vo=(M,E,z)=>{E.popup.onclick=()=>{M&&(Mc(M)||M.timer||M.input)||z(Nr.close)}},Mc=M=>!!(M.showConfirmButton||M.showDenyButton||M.showCancelButton||M.showCloseButton),Gs=!1,Sc=M=>{M.popup.onmousedown=()=>{M.container.onmouseup=function(E){M.container.onmouseup=()=>{},E.target===M.container&&(Gs=!0)}}},Id=M=>{M.container.onmousedown=E=>{E.target===M.container&&E.preventDefault(),M.popup.onmouseup=function(z){M.popup.onmouseup=()=>{},(z.target===M.popup||z.target instanceof HTMLElement&&M.popup.contains(z.target))&&(Gs=!0)}}},Pc=(M,E,z)=>{E.container.onclick=oe=>{if(Gs){Gs=!1;return}oe.target===E.container&&Qi(M.allowOutsideClick)&&z(Nr.backdrop)}},ps=M=>typeof M=="object"&&M.jquery,yl=M=>M instanceof Element||ps(M),Gu=M=>{let E={};return typeof M[0]=="object"&&!yl(M[0])?Object.assign(E,M[0]):["title","html","icon"].forEach((z,oe)=>{let Fe=M[oe];typeof Fe=="string"||yl(Fe)?E[z]=Fe:Fe!==void 0&&hi(`Unexpected type of ${z}! Expected "string" or "Element", got ${typeof Fe}`)}),E};function Hu(...M){return new this(...M)}function Zu(M){class E extends this{_main(oe,Fe){return super._main(oe,Object.assign({},M,Fe))}}return E}let Wu=()=>P.timeout&&P.timeout.getTimerLeft(),Ec=()=>{if(P.timeout)return J(),P.timeout.stop()},kd=()=>{if(P.timeout){let M=P.timeout.start();return Z(M),M}},Ad=()=>{let M=P.timeout;return M&&(M.running?Ec():kd())},vl=M=>{if(P.timeout){let E=P.timeout.increase(M);return Z(E,!0),E}},bl=()=>!!(P.timeout&&P.timeout.isRunning()),Ra=!1,Oa={};function ms(M="data-swal-template"){Oa[M]=this,Ra||(document.body.addEventListener("click",xl),Ra=!0)}let xl=M=>{for(let E=M.target;E&&E!==document;E=E.parentNode)for(let z in Oa){let oe=E.getAttribute(z);if(oe){Oa[z].fire({template:oe});return}}};class Hs{constructor(){this.events={}}_getHandlersByEventName(E){return typeof this.events[E]>"u"&&(this.events[E]=[]),this.events[E]}on(E,z){let oe=this._getHandlersByEventName(E);oe.includes(z)||oe.push(z)}once(E,z){let oe=(...Fe)=>{this.removeListener(E,oe),z.apply(this,Fe)};this.on(E,oe)}emit(E,...z){this._getHandlersByEventName(E).forEach(oe=>{try{oe.apply(this,z)}catch(Fe){console.error(Fe)}})}removeListener(E,z){let oe=this._getHandlersByEventName(E),Fe=oe.indexOf(z);Fe>-1&&oe.splice(Fe,1)}removeAllListeners(E){this.events[E]!==void 0&&(this.events[E].length=0)}reset(){this.events={}}}P.eventEmitter=new Hs;var Tc=Object.freeze({__proto__:null,argsToParams:Gu,bindClickHandler:ms,clickCancel:va,clickConfirm:Zt,clickDeny:ya,enableLoading:cs,fire:Hu,getActions:Mn,getCancelButton:mo,getCloseButton:ns,getConfirmButton:nn,getContainer:Zi,getDenyButton:wn,getFocusableElements:Zn,getFooter:is,getHtmlContainer:mi,getIcon:Xr,getIconContent:As,getImage:ho,getInputLabel:Cn,getLoader:mr,getPopup:kt,getProgressSteps:Pr,getTimerLeft:Wu,getTimerProgressBar:Yr,getTitle:Ds,getValidationMessage:po,increaseTimer:vl,isDeprecatedParameter:wc,isLoading:Kr,isTimerRunning:bl,isUpdatableParameter:yo,isValidParameter:gl,isVisible:ls,mixin:Zu,off:(M,E)=>{if(!M){P.eventEmitter.reset();return}E?P.eventEmitter.removeListener(M,E):P.eventEmitter.removeAllListeners(M)},on:(M,E)=>{P.eventEmitter.on(M,E)},once:(M,E)=>{P.eventEmitter.once(M,E)},resumeTimer:kd,showLoading:cs,stopTimer:Ec,toggleTimer:Ad});class fs{constructor(E,z){this.callback=E,this.remaining=z,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(E){let z=this.running;return z&&this.stop(),this.remaining+=E,z&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}let Fa=["swal-title","swal-html","swal-footer"],wl=M=>{let E=typeof M.template=="string"?document.querySelector(M.template):M.template;if(!E)return{};let z=E.content;return Ut(z),Object.assign(La(z),Cl(z),Ml(z),Zs(z),Ws(z),Dd(z),Sl(z,Fa))},La=M=>{let E={};return Array.from(M.querySelectorAll("swal-param")).forEach(oe=>{io(oe,["name","value"]);let Fe=oe.getAttribute("name"),it=oe.getAttribute("value");!Fe||!it||(typeof to[Fe]=="boolean"?E[Fe]=it!=="false":typeof to[Fe]=="object"?E[Fe]=JSON.parse(it):E[Fe]=it)}),E},Cl=M=>{let E={};return Array.from(M.querySelectorAll("swal-function-param")).forEach(oe=>{let Fe=oe.getAttribute("name"),it=oe.getAttribute("value");!Fe||!it||(E[Fe]=new Function(`return ${it}`)())}),E},Ml=M=>{let E={};return Array.from(M.querySelectorAll("swal-button")).forEach(oe=>{io(oe,["type","color","aria-label"]);let Fe=oe.getAttribute("type");!Fe||!["confirm","cancel","deny"].includes(Fe)||(E[`${Fe}ButtonText`]=oe.innerHTML,E[`show${lt(Fe)}Button`]=!0,oe.hasAttribute("color")&&(E[`${Fe}ButtonColor`]=oe.getAttribute("color")),oe.hasAttribute("aria-label")&&(E[`${Fe}ButtonAriaLabel`]=oe.getAttribute("aria-label")))}),E},Zs=M=>{let E={},z=M.querySelector("swal-image");return z&&(io(z,["src","width","height","alt"]),z.hasAttribute("src")&&(E.imageUrl=z.getAttribute("src")||void 0),z.hasAttribute("width")&&(E.imageWidth=z.getAttribute("width")||void 0),z.hasAttribute("height")&&(E.imageHeight=z.getAttribute("height")||void 0),z.hasAttribute("alt")&&(E.imageAlt=z.getAttribute("alt")||void 0)),E},Ws=M=>{let E={},z=M.querySelector("swal-icon");return z&&(io(z,["type","color"]),z.hasAttribute("type")&&(E.icon=z.getAttribute("type")),z.hasAttribute("color")&&(E.iconColor=z.getAttribute("color")),E.iconHtml=z.innerHTML),E},Dd=M=>{let E={},z=M.querySelector("swal-input");z&&(io(z,["type","label","placeholder","value"]),E.input=z.getAttribute("type")||"text",z.hasAttribute("label")&&(E.inputLabel=z.getAttribute("label")),z.hasAttribute("placeholder")&&(E.inputPlaceholder=z.getAttribute("placeholder")),z.hasAttribute("value")&&(E.inputValue=z.getAttribute("value")));let oe=Array.from(M.querySelectorAll("swal-input-option"));return oe.length&&(E.inputOptions={},oe.forEach(Fe=>{io(Fe,["value"]);let it=Fe.getAttribute("value");if(!it)return;let xt=Fe.innerHTML;E.inputOptions[it]=xt})),E},Sl=(M,E)=>{let z={};for(let oe in E){let Fe=E[oe],it=M.querySelector(Fe);it&&(io(it,[]),z[Fe.replace(/^swal-/,"")]=it.innerHTML.trim())}return z},Ut=M=>{let E=Fa.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(M.children).forEach(z=>{let oe=z.tagName.toLowerCase();E.includes(oe)||at(`Unrecognized element <${oe}>`)})},io=(M,E)=>{Array.from(M.attributes).forEach(z=>{E.indexOf(z.name)===-1&&at([`Unrecognized attribute "${z.name}" on <${M.tagName.toLowerCase()}>.`,`${E.length?`Allowed attributes are: ${E.join(", ")}`:"To set the value, use HTML within the element."}`])})},za=10,Ic=M=>{let E=Zi(),z=kt();typeof M.willOpen=="function"&&M.willOpen(z),P.eventEmitter.emit("willOpen",z);let Fe=window.getComputedStyle(document.body).overflowY;Rd(E,z,M),setTimeout(()=>{Yu(E,z)},za),Sn()&&(Ku(E,M.scrollbarPadding,Fe),Gi()),!xi()&&!P.previousActiveElement&&(P.previousActiveElement=document.activeElement),typeof M.didOpen=="function"&&setTimeout(()=>M.didOpen(z)),P.eventEmitter.emit("didOpen",z),sn(E,$["no-transition"])},Uo=M=>{let E=kt();if(M.target!==E)return;let z=Zi();E.removeEventListener("animationend",Uo),E.removeEventListener("transitionend",Uo),z.style.overflowY="auto"},Yu=(M,E)=>{H(E)?(M.style.overflowY="hidden",E.addEventListener("animationend",Uo),E.addEventListener("transitionend",Uo)):M.style.overflowY="auto"},Ku=(M,E,z)=>{Bs(),E&&z!=="hidden"&&wa(z),setTimeout(()=>{M.scrollTop=0})},Rd=(M,E,z)=>{Kt(M,z.showClass.backdrop),z.animation?(E.style.setProperty("opacity","0","important"),ji(E,"grid"),setTimeout(()=>{Kt(E,z.showClass.popup),E.style.removeProperty("opacity")},za)):ji(E,"grid"),Kt([document.documentElement,document.body],$.shown),z.heightAuto&&z.backdrop&&!z.toast&&Kt([document.documentElement,document.body],$["height-auto"])};var Od={email:(M,E)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(M)?Promise.resolve():Promise.resolve(E||"Invalid email address"),url:(M,E)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(M)?Promise.resolve():Promise.resolve(E||"Invalid URL")};function Pl(M){M.inputValidator||(M.input==="email"&&(M.inputValidator=Od.email),M.input==="url"&&(M.inputValidator=Od.url))}function Ba(M){(!M.target||typeof M.target=="string"&&!document.querySelector(M.target)||typeof M.target!="string"&&!M.target.appendChild)&&(at('Target parameter is not valid, defaulting to "body"'),M.target="body")}function El(M){Pl(M),M.showLoaderOnConfirm&&!M.preConfirm&&at(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),Ba(M),typeof M.title=="string"&&(M.title=M.title.split(`
`).join("<br />")),je(M)}let kr;var gs=new WeakMap;class Hi{constructor(...E){if(l(this,gs,void 0),typeof window>"u")return;kr=this;let z=Object.freeze(this.constructor.argsToParams(E));this.params=z,this.isAwaitingPromise=!1,h(gs,this,this._main(kr.params))}_main(E,z={}){if(Aa(Object.assign({},z,E)),P.currentInstance){let it=ci.swalPromiseResolve.get(P.currentInstance),{isAwaitingPromise:xt}=P.currentInstance;P.currentInstance._destroy(),xt||it({isDismissed:!0}),Sn()&&Wt()}P.currentInstance=kr;let oe=Va(E,z);El(oe),Object.freeze(oe),P.timeout&&(P.timeout.stop(),delete P.timeout),clearTimeout(P.restoreFocusTimeout);let Fe=ja(kr);return Ln(kr,oe),Tt.innerParams.set(kr,oe),Na(kr,Fe,oe)}then(E){return i(gs,this).then(E)}finally(E){return i(gs,this).finally(E)}}let Na=(M,E,z)=>new Promise((oe,Fe)=>{let it=xt=>{M.close({isDismissed:!0,dismiss:xt})};ci.swalPromiseResolve.set(M,oe),ci.swalPromiseReject.set(M,Fe),E.confirmButton.onclick=()=>{ju(M)},E.denyButton.onclick=()=>{Uu(M)},E.cancelButton.onclick=()=>{pl(M,it)},E.closeButton.onclick=()=>{it(Nr.close)},ni(z,E,it),En(P,z,it),Bn(M,z),Ic(z),kc(P,z,it),Ua(E,z),setTimeout(()=>{E.container.scrollTop=0})}),Va=(M,E)=>{let z=wl(M),oe=Object.assign({},to,E,z,M);return oe.showClass=Object.assign({},to.showClass,oe.showClass),oe.hideClass=Object.assign({},to.hideClass,oe.hideClass),oe.animation===!1&&(oe.showClass={backdrop:"swal2-noanimation"},oe.hideClass={}),oe},ja=M=>{let E={popup:kt(),container:Zi(),actions:Mn(),confirmButton:nn(),denyButton:wn(),cancelButton:mo(),loader:mr(),closeButton:ns(),validationMessage:po(),progressSteps:Pr()};return Tt.domCache.set(M,E),E},kc=(M,E,z)=>{let oe=Yr();Oi(oe),E.timer&&(M.timeout=new fs(()=>{z("timer"),delete M.timeout},E.timer),E.timerProgressBar&&(ji(oe),Pn(oe,E,"timerProgressBar"),setTimeout(()=>{M.timeout&&M.timeout.running&&Z(E.timer)})))},Ua=(M,E)=>{if(!E.toast){if(!Qi(E.allowEnterKey)){bi("allowEnterKey"),Il();return}Tl(M)||Fd(M,E)||$i(-1,1)}},Tl=M=>{let E=Array.from(M.popup.querySelectorAll("[autofocus]"));for(let z of E)if(z instanceof HTMLElement&&Ii(z))return z.focus(),!0;return!1},Fd=(M,E)=>E.focusDeny&&Ii(M.denyButton)?(M.denyButton.focus(),!0):E.focusCancel&&Ii(M.cancelButton)?(M.cancelButton.focus(),!0):E.focusConfirm&&Ii(M.confirmButton)?(M.confirmButton.focus(),!0):!1,Il=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){let M=new Date,E=localStorage.getItem("swal-initiation");E?(M.getTime()-Date.parse(E))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";let z=document.createElement("audio");z.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",z.loop=!0,document.body.appendChild(z),setTimeout(()=>{z.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${M}`)}Hi.prototype.disableButtons=jo,Hi.prototype.enableButtons=yc,Hi.prototype.getInput=Us,Hi.prototype.disableInput=bc,Hi.prototype.enableInput=vc,Hi.prototype.hideLoading=js,Hi.prototype.disableLoading=js,Hi.prototype.showValidationMessage=bd,Hi.prototype.resetValidationMessage=xc,Hi.prototype.close=lr,Hi.prototype.closePopup=lr,Hi.prototype.closeModal=lr,Hi.prototype.closeToast=lr,Hi.prototype.rejectPromise=No,Hi.prototype.update=Pd,Hi.prototype._destroy=_l,Object.assign(Hi,Tc),Object.keys(Td).forEach(M=>{Hi[M]=function(...E){return kr&&kr[M]?kr[M](...E):null}}),Hi.DismissReason=Nr,Hi.version="11.22.0";let qs=Hi;return qs.default=qs,qs});typeof da<"u"&&da.Sweetalert2&&(da.swal=da.sweetAlert=da.Swal=da.SweetAlert=da.Sweetalert2);typeof document<"u"&&function(c,a){var i=c.createElement("style");if(c.getElementsByTagName("head")[0].appendChild(i),i.styleSheet)i.styleSheet.disabled||(i.styleSheet.cssText=a);else try{i.innerHTML=a}catch{i.innerText=a}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}')});var Yy=jb((qy,Xy)=>{"use strict";(function(c,a){typeof qy=="object"&&typeof Xy<"u"?Xy.exports=a():typeof define=="function"&&define.amd?define(a):(c=typeof globalThis<"u"?globalThis:c||self,c.maplibregl=a())})(qy,function(){"use strict";var c={},a={};function i(h,s,P){if(a[h]=P,h==="index"){var q="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",X={};return a.shared(X),a.index(c,X),typeof window<"u"&&c.setWorkerUrl(window.URL.createObjectURL(new Blob([q],{type:"text/javascript"}))),c}}i("shared",["exports"],function(h){"use strict";function s(o,t,r,d){return new(r||(r=Promise))(function(m,_){function y(S){try{w(d.next(S))}catch(I){_(I)}}function b(S){try{w(d.throw(S))}catch(I){_(I)}}function w(S){var I;S.done?m(S.value):(I=S.value,I instanceof r?I:new r(function(A){A(I)})).then(y,b)}w((d=d.apply(o,t||[])).next())})}function P(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var q,X;function be(){if(X)return q;function o(t,r){this.x=t,this.y=r}return X=1,q=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,d=t.y-this.y;return r*r+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),d=Math.sin(t),m=d*this.x+r*this.y;return this.x=r*this.x-d*this.y,this.y=m,this},_rotateAround:function(t,r){var d=Math.cos(t),m=Math.sin(t),_=r.y+m*(this.x-r.x)+d*(this.y-r.y);return this.x=r.x+d*(this.x-r.x)-m*(this.y-r.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t},q}typeof SuppressedError=="function"&&SuppressedError;var ve,$,$e=P(be()),ht=function(){if($)return ve;function o(t,r,d,m){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(m-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=d,this.p2y=m}return $=1,ve=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,m=0;m<8;m++){var _=this.sampleCurveX(d)-t;if(Math.abs(_)<r)return d;var y=this.sampleCurveDerivativeX(d);if(Math.abs(y)<1e-6)break;d-=_/y}var b=0,w=1;for(d=t,m=0;m<20&&(_=this.sampleCurveX(d),!(Math.abs(_-t)<r));m++)t>_?b=d:w=d,d=.5*(w-b)+b;return d},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},ve}(),wt=P(ht);let lt,at;function hi(){return lt==null&&(lt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),lt}function Mi(){if(at==null&&(at=!1,hi())){let t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let d=0;d<5*5;d++){let m=4*d;t.fillStyle=`rgb(${m},${m+1},${m+2})`,t.fillRect(d%5,Math.floor(d/5),1,1)}let r=t.getImageData(0,0,5,5).data;for(let d=0;d<5*5*4;d++)if(d%4!=3&&r[d]!==d){at=!0;break}}}return at||!1}var At=1e-6,bi=typeof Float32Array<"u"?Float32Array:Array;function Qi(){var o=new bi(9);return bi!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function pi(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Lr(){var o=new bi(3);return bi!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function ks(o){return Math.hypot(o[0],o[1],o[2])}function Zi(o,t,r){var d=new bi(3);return d[0]=o,d[1]=t,d[2]=r,d}Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)});var rr,Vi=ks;function kt(o,t,r){var d=t[0],m=t[1],_=t[2],y=t[3];return o[0]=r[0]*d+r[4]*m+r[8]*_+r[12]*y,o[1]=r[1]*d+r[5]*m+r[9]*_+r[13]*y,o[2]=r[2]*d+r[6]*m+r[10]*_+r[14]*y,o[3]=r[3]*d+r[7]*m+r[11]*_+r[15]*y,o}function Xr(){var o=new bi(4);return bi!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function As(){var o=new bi(2);return bi!=Float32Array&&(o[0]=0,o[1]=0),o}function Ds(o,t){var r=new bi(2);return r[0]=o,r[1]=t,r}Lr(),rr=new bi(4),bi!=Float32Array&&(rr[0]=0,rr[1]=0,rr[2]=0,rr[3]=0),Lr(),Zi(1,0,0),Zi(0,1,0),Xr(),Xr(),Qi(),As();let mi=8192;function ho(o,t,r){return t*(mi/(o.tileSize*Math.pow(2,r-o.tileID.overscaledZ)))}function Pr(o,t){return(o%t+t)%t}function po(o,t,r){return o*(1-r)+t*r}function nn(o){if(o<=0)return 0;if(o>=1)return 1;let t=o*o,r=t*o;return 4*(o<.5?r:3*(o-t)+r-.75)}function mo(o,t,r,d){let m=new wt(o,t,r,d);return _=>m.solve(_)}let wn=mo(.25,.1,.25,1);function Cn(o,t,r){return Math.min(r,Math.max(t,o))}function mr(o,t,r){let d=r-t,m=((o-t)%d+d)%d+t;return m===t?r:m}function Mn(o,...t){for(let r of t)for(let d in r)o[d]=r[d];return o}let is=1;function Yr(o,t,r){let d={};for(let m in o)d[m]=t.call(this,o[m],m,o);return d}function ns(o,t,r){let d={};for(let m in o)t.call(this,o[m],m,o)&&(d[m]=o[m]);return d}function fr(o){return Array.isArray(o)?o.map(fr):typeof o=="object"&&o?Yr(o,fr):o}let Zn={};function Sn(o){Zn[o]||(typeof console<"u"&&console.warn(o),Zn[o]=!0)}function xi(o,t,r){return(r.y-o.y)*(t.x-o.x)>(t.y-o.y)*(r.x-o.x)}function Kr(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let rn=null;function on(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}let ha="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Pn(o,t,r,d,m){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let _=new VideoFrame(o,{timestamp:0});try{let y=_?.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);let b=y.startsWith("BGR"),w=new Uint8ClampedArray(d*m*4);if(yield _.copyTo(w,function(S,I,A,L,N){let V=4*Math.max(1,0),G=(Math.max(0,A)-A)*L*4+V,K=4*L,ne=Math.max(0,I),me=Math.max(0,A);return{rect:{x:ne,y:me,width:Math.min(S.width,I+L)-ne,height:Math.min(S.height,A+N)-me},layout:[{offset:G,stride:K}]}}(o,t,r,d,m)),b)for(let S=0;S<w.length;S+=4){let I=w[S];w[S]=w[S+2],w[S+2]=I}return w}finally{_.close()}})}let Fn,zr;function Lo(o,t,r,d){return o.addEventListener(t,r,d),{unsubscribe:()=>{o.removeEventListener(t,r,d)}}}function Kt(o){return o*Math.PI/180}function sn(o){return o/Math.PI*180}let gr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Er={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ji="AbortError";function Oi(){return new Error(ji)}let Br={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function fo(o){return Br.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}let Qr="global-dispatcher";class Ii extends Error{constructor(t,r,d,m){super(`AJAXError: ${r} (${t}): ${d}`),this.status=t,this.statusText=r,this.url=d,this.body=m}}let or=()=>Kr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Tr=function(o,t){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){let d=fo(o.url);if(d)return d(o,t);if(Kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:Qr},t)}if(!(/^file:/.test(r=o.url)||/^file:/.test(or())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(d,m){return s(this,void 0,void 0,function*(){let _=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:or(),signal:m.signal}),y,b;d.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{y=yield fetch(_)}catch(S){throw new Ii(0,S.message,d.url,new Blob)}if(!y.ok){let S=yield y.blob();throw new Ii(y.status,y.statusText,d.url,S)}b=d.type==="arrayBuffer"||d.type==="image"?y.arrayBuffer():d.type==="json"?y.json():y.text();let w=yield b;if(m.signal.aborted)throw Oi();return{data:w,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(o,t);if(Kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:Qr},t)}var r;return function(d,m){return new Promise((_,y)=>{var b;let w=new XMLHttpRequest;w.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(w.responseType="arraybuffer");for(let S in d.headers)w.setRequestHeader(S,d.headers[S]);d.type==="json"&&(w.responseType="text",!((b=d.headers)===null||b===void 0)&&b.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=d.credentials==="include",w.onerror=()=>{y(new Error(w.statusText))},w.onload=()=>{if(!m.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let S=w.response;if(d.type==="json")try{S=JSON.parse(w.response)}catch(I){return void y(I)}_({data:S,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{let S=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});y(new Ii(w.status,w.statusText,d.url,S))}},m.signal.addEventListener("abort",()=>{w.abort(),y(Oi())}),w.send(d.body)})}(o,t)};function xe(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;let t=new URL(o),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function H(o,t,r){r[o]&&r[o].indexOf(t)!==-1||(r[o]=r[o]||[],r[o].push(t))}function Z(o,t,r){if(r&&r[o]){let d=r[o].indexOf(t);d!==-1&&r[o].splice(d,1)}}class J{constructor(t,r={}){Mn(this,r),this.type=t}}class le extends J{constructor(t,r={}){super("error",Mn({error:t},r))}}class fe{on(t,r){return this._listeners=this._listeners||{},H(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return Z(t,r,this._listeners),Z(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},H(t,r,this._oneTimeListeners),this):new Promise(d=>this.once(t,d))}fire(t,r){typeof t=="string"&&(t=new J(t,r||{}));let d=t.type;if(this.listens(d)){t.target=this;let m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(let b of m)b.call(this,t);let _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(let b of _)Z(d,b,this._oneTimeListeners),b.call(this,t);let y=this._eventedParent;y&&(Mn(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof le&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var Q={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Me=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ye(o,t){let r={};for(let d in o)d!=="ref"&&(r[d]=o[d]);return Me.forEach(d=>{d in t&&(r[d]=t[d])}),r}function Ce(o,t){if(Array.isArray(o)){if(!Array.isArray(t)||o.length!==t.length)return!1;for(let r=0;r<o.length;r++)if(!Ce(o[r],t[r]))return!1;return!0}if(typeof o=="object"&&o!==null&&t!==null){if(typeof t!="object"||Object.keys(o).length!==Object.keys(t).length)return!1;for(let r in o)if(!Ce(o[r],t[r]))return!1;return!0}return o===t}function Ee(o,t){o.push(t)}function we(o,t,r){Ee(r,{command:"addSource",args:[o,t[o]]})}function je(o,t,r){Ee(t,{command:"removeSource",args:[o]}),r[o]=!0}function Ye(o,t,r,d){je(o,r,d),we(o,t,r)}function et(o,t,r){let d;for(d in o[r])if(Object.prototype.hasOwnProperty.call(o[r],d)&&d!=="data"&&!Ce(o[r][d],t[r][d]))return!1;for(d in t[r])if(Object.prototype.hasOwnProperty.call(t[r],d)&&d!=="data"&&!Ce(o[r][d],t[r][d]))return!1;return!0}function gt(o,t,r,d,m,_){o=o||{},t=t||{};for(let y in o)Object.prototype.hasOwnProperty.call(o,y)&&(Ce(o[y],t[y])||r.push({command:_,args:[d,y,t[y],m]}));for(let y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(o,y)&&(Ce(o[y],t[y])||r.push({command:_,args:[d,y,t[y],m]}))}function Dt(o){return o.id}function Pt(o,t){return o[t.id]=t,o}class De{constructor(t,r,d,m){this.message=(t?`${t}: `:"")+d,m&&(this.identifier=m),r!=null&&r.__line__&&(this.line=r.__line__)}}function ai(o,...t){for(let r of t)for(let d in r)o[d]=r[d];return o}class jt extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class li{constructor(t,r=[]){this.parent=t,this.bindings={};for(let[d,m]of r)this.bindings[d]=m}concat(t){return new li(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}let Mt={kind:"null"},Ve={kind:"number"},yt={kind:"string"},Rt={kind:"boolean"},Tt={kind:"color"},Ui={kind:"projectionDefinition"},sr={kind:"object"},zt={kind:"value"},Rs={kind:"collator"},pa={kind:"formatted"},rs={kind:"padding"},os={kind:"colorArray"},_r={kind:"numberArray"},zo={kind:"resolvedImage"},Fi={kind:"variableAnchorOffsetCollection"};function ui(o,t){return{kind:"array",itemType:o,N:t}}function ki(o){if(o.kind==="array"){let t=ki(o.itemType);return typeof o.N=="number"?`array<${t}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${t}>`}return o.kind}let ma=[Mt,Ve,yt,Rt,Tt,Ui,pa,sr,ui(zt),rs,_r,os,zo,Fi];function Os(o,t){if(t.kind==="error")return null;if(o.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Os(o.itemType,t.itemType))&&(typeof o.N!="number"||o.N===t.N))return null}else{if(o.kind===t.kind)return null;if(o.kind==="value"){for(let r of ma)if(!Os(r,t))return null}}return`Expected ${ki(o)} but found ${ki(t)} instead.`}function al(o,t){return t.some(r=>r.kind===o.kind)}function Bo(o,t){return t.some(r=>r==="null"?o===null:r==="array"?Array.isArray(o):r==="object"?o&&!Array.isArray(o)&&typeof o=="object":r===typeof o)}function go(o,t){return o.kind==="array"&&t.kind==="array"?o.itemType.kind===t.itemType.kind&&typeof o.N=="number":o.kind===t.kind}let hd=.96422,ll=.82521,pd=4/29,ss=6/29,md=3*ss*ss,uc=ss*ss*ss,fd=Math.PI/180,gd=180/Math.PI;function hc(o){return(o%=360)<0&&(o+=360),o}function cl([o,t,r,d]){let m,_,y=pc((.2225045*(o=as(o))+.7168786*(t=as(t))+.0606169*(r=as(r)))/1);o===t&&t===r?m=_=y:(m=pc((.4360747*o+.3850649*t+.1430804*r)/hd),_=pc((.0139322*o+.0971045*t+.7141733*r)/ll));let b=116*y-16;return[b<0?0:b,500*(m-y),200*(y-_),d]}function as(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function pc(o){return o>uc?Math.pow(o,1/3):o/md+pd}function fa([o,t,r,d]){let m=(o+16)/116,_=isNaN(t)?m:m+t/500,y=isNaN(r)?m:m-r/200;return m=1*Fs(m),_=hd*Fs(_),y=ll*Fs(y),[Jr(3.1338561*_-1.6168667*m-.4906146*y),Jr(-.9787684*_+1.9161415*m+.033454*y),Jr(.0719453*_-.2289914*m+1.4052427*y),d]}function Jr(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Fs(o){return o>ss?o*o*o:md*(o-pd)}let _d=Object.hasOwn||function(o,t){return Object.prototype.hasOwnProperty.call(o,t)};function ga(o,t){return _d(o,t)?o[t]:void 0}function _a(o){return parseInt(o.padEnd(2,o),16)/255}function mc(o,t){return Wn(t?o/100:o,0,1)}function Wn(o,t,r){return Math.min(Math.max(t,o),r)}function ei(o){return!o.some(Number.isNaN)}let Ls={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ln(o,t,r){return o+r*(t-o)}function ls(o,t,r){return o.map((d,m)=>Ln(d,t[m],r))}class Zt{constructor(t,r,d,m=1,_=!0){this.r=t,this.g=r,this.b=d,this.a=m,_||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[t,r,d,m]))}static parse(t){if(t instanceof Zt)return t;if(typeof t!="string")return;let r=function(d){if((d=d.toLowerCase().trim())==="transparent")return[0,0,0,0];let m=ga(Ls,d);if(m){let[y,b,w]=m;return[y/255,b/255,w/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){let y=d.length<6?1:2,b=1;return[_a(d.slice(b,b+=y)),_a(d.slice(b,b+=y)),_a(d.slice(b,b+=y)),_a(d.slice(b,b+y)||"ff")]}if(d.startsWith("rgb")){let y=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){let[b,w,S,I,A,L,N,V,G,K,ne,me]=y,ae=[I||" ",N||" ",K].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){let B=[S,L,G].join(""),W=B==="%%%"?100:B===""?255:0;if(W){let ce=[Wn(+w/W,0,1),Wn(+A/W,0,1),Wn(+V/W,0,1),ne?mc(+ne,me):1];if(ei(ce))return ce}}return}}let _=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){let[y,b,w,S,I,A,L,N,V]=_,G=[w||" ",I||" ",L].join("");if(G==="  "||G==="  /"||G===",,"||G===",,,"){let K=[+b,Wn(+S,0,100),Wn(+A,0,100),N?mc(+N,V):1];if(ei(K))return function([ne,me,ae,B]){function W(ce){let Pe=(ce+ne/30)%12,Ue=me*Math.min(ae,1-ae);return ae-Ue*Math.max(-1,Math.min(Pe-3,9-Pe,1))}return ne=hc(ne),me/=100,ae/=100,[W(0),W(8),W(4),B]}(K)}}}(t);return r?new Zt(...r,!1):void 0}get rgb(){let{r:t,g:r,b:d,a:m}=this,_=m||1/0;return this.overwriteGetter("rgb",[t/_,r/_,d/_,m])}get hcl(){return this.overwriteGetter("hcl",function(t){let[r,d,m,_]=cl(t),y=Math.sqrt(d*d+m*m);return[Math.round(1e4*y)?hc(Math.atan2(m,d)*gd):NaN,y,r,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",cl(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){let[t,r,d,m]=this.rgb;return`rgba(${[t,r,d].map(_=>Math.round(255*_)).join(",")},${m})`}static interpolate(t,r,d,m="rgb"){switch(m){case"rgb":{let[_,y,b,w]=ls(t.rgb,r.rgb,d);return new Zt(_,y,b,w,!1)}case"hcl":{let[_,y,b,w]=t.hcl,[S,I,A,L]=r.hcl,N,V;if(isNaN(_)||isNaN(S))isNaN(_)?isNaN(S)?N=NaN:(N=S,b!==1&&b!==0||(V=I)):(N=_,A!==1&&A!==0||(V=y));else{let ae=S-_;S>_&&ae>180?ae-=360:S<_&&_-S>180&&(ae+=360),N=_+d*ae}let[G,K,ne,me]=function([ae,B,W,ce]){return ae=isNaN(ae)?0:ae*fd,fa([W,Math.cos(ae)*B,Math.sin(ae)*B,ce])}([N,V??Ln(y,I,d),Ln(b,A,d),Ln(w,L,d)]);return new Zt(G,K,ne,me,!1)}case"lab":{let[_,y,b,w]=fa(ls(t.lab,r.lab,d));return new Zt(_,y,b,w,!1)}}}}Zt.black=new Zt(0,0,0,1),Zt.white=new Zt(1,1,1,1),Zt.transparent=new Zt(0,0,0,0),Zt.red=new Zt(1,0,0,1);class ya{constructor(t,r,d){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}let va=["bottom","center","top"];class Nr{constructor(t,r,d,m,_,y){this.text=t,this.image=r,this.scale=d,this.fontStack=m,this.textColor=_,this.verticalAlign=y}}class qn{constructor(t){this.sections=t}static fromString(t){return new qn([new Nr(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof qn?t:qn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class En{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof En)return t;if(typeof t=="number")return new En([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(let r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new En(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d){return new En(ls(t.values,r.values,d))}}class $i{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof $i)return t;if(typeof t=="number")return new $i([t]);if(Array.isArray(t)){for(let r of t)if(typeof r!="number")return;return new $i(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d){return new $i(ls(t.values,r.values,d))}}class pn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof pn)return t;if(typeof t=="string"){let d=Zt.parse(t);return d?new pn([d]):void 0}if(!Array.isArray(t))return;let r=[];for(let d of t){if(typeof d!="string")return;let m=Zt.parse(d);if(!m)return;r.push(m)}return new pn(r)}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d,m="rgb"){let _=[];if(t.values.length!=r.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${r.values.length}), cannot interpolate.`);for(let y=0;y<t.values.length;y++)_.push(Zt.interpolate(t.values[y],r.values[y],d,m));return new pn(_)}}class Pi extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}let zs=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Xn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Xn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){let d=t[r],m=t[r+1];if(typeof d!="string"||!zs.has(d)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Xn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,d){let m=t.values,_=r.values;if(m.length!==_.length)throw new Pi(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);let y=[];for(let b=0;b<m.length;b+=2){if(m[b]!==_[b])throw new Pi(`Cannot interpolate values containing mismatched anchors. from[${b}]: ${m[b]}, to[${b}]: ${_[b]}`);y.push(m[b]);let[w,S]=m[b+1],[I,A]=_[b+1];y.push([Ln(w,I,d),Ln(S,A,d)])}return new Xn(y)}}class yr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new yr({name:t,available:!1}):null}}class ar{constructor(t,r,d){this.from=t,this.to=r,this.transition=d}static interpolate(t,r,d){return new ar(t,r,d)}static parse(t){return t instanceof ar?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new ar(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new ar(t.from,t.to,t.transition):typeof t=="string"?new ar(t,t,1):void 0}}function ba(o,t,r,d){return typeof o=="number"&&o>=0&&o<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[o,t,r,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[o,t,r,d]:[o,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ci(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof ar||o instanceof Zt||o instanceof ya||o instanceof qn||o instanceof En||o instanceof $i||o instanceof pn||o instanceof Xn||o instanceof yr)return!0;if(Array.isArray(o)){for(let t of o)if(!ci(t))return!1;return!0}if(typeof o=="object"){for(let t in o)if(!ci(o[t]))return!1;return!0}return!1}function Gi(o){if(o===null)return Mt;if(typeof o=="string")return yt;if(typeof o=="boolean")return Rt;if(typeof o=="number")return Ve;if(o instanceof Zt)return Tt;if(o instanceof ar)return Ui;if(o instanceof ya)return Rs;if(o instanceof qn)return pa;if(o instanceof En)return rs;if(o instanceof $i)return _r;if(o instanceof pn)return os;if(o instanceof Xn)return Fi;if(o instanceof yr)return zo;if(Array.isArray(o)){let t=o.length,r;for(let d of o){let m=Gi(d);if(r){if(r===m)continue;r=zt;break}r=m}return ui(r||zt,t)}return sr}function Wt(o){let t=typeof o;return o===null?"":t==="string"||t==="number"||t==="boolean"?String(o):o instanceof Zt||o instanceof ar||o instanceof qn||o instanceof En||o instanceof $i||o instanceof pn||o instanceof Xn||o instanceof yr?o.toString():JSON.stringify(o)}class Et{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ci(t[1]))return r.error("invalid value");let d=t[1],m=Gi(d),_=r.expectedType;return m.kind!=="array"||m.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(m=_),new Et(m,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}let Bs={string:yt,number:Ve,boolean:Rt,object:sr};class Bt{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d,m=1,_=t[0];if(_==="array"){let b,w;if(t.length>2){let S=t[1];if(typeof S!="string"||!(S in Bs)||S==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);b=Bs[S],m++}else b=zt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);w=t[2],m++}d=ui(b,w)}else{if(!Bs[_])throw new Error(`Types doesn't contain name = ${_}`);d=Bs[_]}let y=[];for(;m<t.length;m++){let b=r.parse(t[m],m,zt);if(!b)return null;y.push(b)}return new Bt(d,y)}evaluate(t){for(let r=0;r<this.args.length;r++){let d=this.args[r].evaluate(t);if(!Os(this.type,Gi(d)))return d;if(r===this.args.length-1)throw new Pi(`Expected value to be of type ${ki(this.type)}, but found ${ki(Gi(d))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}let dl={"to-boolean":Rt,"to-color":Tt,"to-number":Ve,"to-string":yt};class zn{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d=t[0];if(!dl[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&t.length!==2)return r.error("Expected one argument.");let m=dl[d],_=[];for(let y=1;y<t.length;y++){let b=r.parse(t[y],y,zt);if(!b)return null;_.push(b)}return new zn(m,_)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,d;for(let m of this.args){if(r=m.evaluate(t),d=null,r instanceof Zt)return r;if(typeof r=="string"){let _=t.parseColor(r);if(_)return _}else if(Array.isArray(r)&&(d=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:ba(r[0],r[1],r[2],r[3]),!d))return new Zt(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Pi(d||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(let d of this.args){r=d.evaluate(t);let m=En.parse(r);if(m)return m}throw new Pi(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"numberArray":{let r;for(let d of this.args){r=d.evaluate(t);let m=$i.parse(r);if(m)return m}throw new Pi(`Could not parse numberArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"colorArray":{let r;for(let d of this.args){r=d.evaluate(t);let m=pn.parse(r);if(m)return m}throw new Pi(`Could not parse colorArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(let d of this.args){r=d.evaluate(t);let m=Xn.parse(r);if(m)return m}throw new Pi(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(let d of this.args){if(r=d.evaluate(t),r===null)return 0;let m=Number(r);if(!isNaN(m))return m}throw new Pi(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return qn.fromString(Wt(this.args[0].evaluate(t)));case"resolvedImage":return yr.fromString(Wt(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Wt(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}let fc=["Unknown","Point","LineString","Polygon"];class gc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?fc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache.get(t);return r||(r=Zt.parse(t),this._parseColorCache.set(t,r)),r}}class xa{constructor(t,r,d=[],m,_=new li,y=[]){this.registry=t,this.path=d,this.key=d.map(b=>`[${b}]`).join(""),this.scope=_,this.errors=y,this.expectedType=m,this._isConstant=r}parse(t,r,d,m,_={}){return r?this.concat(r,d,m)._parse(t,_):this._parse(t,_)}_parse(t,r){function d(m,_,y){return y==="assert"?new Bt(_,[m]):y==="coerce"?new zn(_,[m]):m}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let m=t[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let _=this.registry[m];if(_){let y=_.parse(t,this);if(!y)return null;if(this.expectedType){let b=this.expectedType,w=y.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||w.kind!=="value"){if(b.kind==="projectionDefinition"&&["string","array"].includes(w.kind)||["color","formatted","resolvedImage"].includes(b.kind)&&["value","string"].includes(w.kind)||["padding","numberArray"].includes(b.kind)&&["value","number","array"].includes(w.kind)||b.kind==="colorArray"&&["value","string","array"].includes(w.kind)||b.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(w.kind))y=d(y,b,r.typeAnnotation||"coerce");else if(this.checkSubtype(b,w))return null}else y=d(y,b,r.typeAnnotation||"assert")}if(!(y instanceof Et)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){let b=new gc;try{y=new Et(y.type,y.evaluate(b))}catch(w){return this.error(w.message),null}}return y}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,d){let m=typeof t=="number"?this.path.concat(t):this.path,_=d?this.scope.concat(d):this.scope;return new xa(this.registry,this._isConstant,m,r||null,_,this.errors)}error(t,...r){let d=`${this.key}${r.map(m=>`[${m}]`).join("")}`;this.errors.push(new jt(d,t))}checkSubtype(t,r){let d=Os(t,r);return d&&this.error(d),d}}class Vr{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(let r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);let d=[];for(let _=1;_<t.length-1;_+=2){let y=t[_];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,_);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",_);let b=r.parse(t[_+1],_+1);if(!b)return null;d.push([y,b])}let m=r.parse(t[t.length-1],t.length-1,r.expectedType,d);return m?new Vr(d,m):null}outputDefined(){return this.result.outputDefined()}}class wa{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let d=t[1];return r.scope.has(d)?new wa(d,r.scope.get(d)):r.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class _c{constructor(t,r,d){this.type=t,this.index=r,this.input=d}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,Ve),m=r.parse(t[2],2,ui(r.expectedType||zt));return d&&m?new _c(m.type.itemType,d,m):null}evaluate(t){let r=this.index.evaluate(t),d=this.input.evaluate(t);if(r<0)throw new Pi(`Array index out of bounds: ${r} < 0.`);if(r>=d.length)throw new Pi(`Array index out of bounds: ${r} > ${d.length-1}.`);if(r!==Math.floor(r))throw new Pi(`Array index must be an integer, but found ${r} instead.`);return d[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Ca{constructor(t,r){this.type=Rt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,zt),m=r.parse(t[2],2,zt);return d&&m?al(d.type,[Rt,yt,Ve,Mt,zt])?new Ca(d,m):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ki(d.type)} instead`):null}evaluate(t){let r=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!d)return!1;if(!Bo(r,["boolean","string","number","null"]))throw new Pi(`Expected first argument to be of type boolean, string, number or null, but found ${ki(Gi(r))} instead.`);if(!Bo(d,["string","array"]))throw new Pi(`Expected second argument to be of type array or string, but found ${ki(Gi(d))} instead.`);return d.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ma{constructor(t,r,d){this.type=Ve,this.needle=t,this.haystack=r,this.fromIndex=d}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,zt),m=r.parse(t[2],2,zt);if(!d||!m)return null;if(!al(d.type,[Rt,yt,Ve,Mt,zt]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ki(d.type)} instead`);if(t.length===4){let _=r.parse(t[3],3,Ve);return _?new Ma(d,m,_):null}return new Ma(d,m)}evaluate(t){let r=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!Bo(r,["boolean","string","number","null"]))throw new Pi(`Expected first argument to be of type boolean, string, number or null, but found ${ki(Gi(r))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(t)),Bo(d,["string"])){let _=d.indexOf(r,m);return _===-1?-1:[...d.slice(0,_)].length}if(Bo(d,["array"]))return d.indexOf(r,m);throw new Pi(`Expected second argument to be of type array or string, but found ${ki(Gi(d))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class lr{constructor(t,r,d,m,_,y){this.inputType=t,this.type=r,this.input=d,this.cases=m,this.outputs=_,this.otherwise=y}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let d,m;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);let _={},y=[];for(let S=2;S<t.length-1;S+=2){let I=t[S],A=t[S+1];Array.isArray(I)||(I=[I]);let L=r.concat(S);if(I.length===0)return L.error("Expected at least one branch label.");for(let V of I){if(typeof V!="number"&&typeof V!="string")return L.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return L.error("Numeric branch labels must be integer values.");if(d){if(L.checkSubtype(d,Gi(V)))return null}else d=Gi(V);if(_[String(V)]!==void 0)return L.error("Branch labels must be unique.");_[String(V)]=y.length}let N=r.parse(A,S,m);if(!N)return null;m=m||N.type,y.push(N)}let b=r.parse(t[1],1,zt);if(!b)return null;let w=r.parse(t[t.length-1],t.length-1,m);return w?b.type.kind!=="value"&&r.concat(1).checkSubtype(d,b.type)?null:new lr(d,m,b,_,y,w):null}evaluate(t){let r=this.input.evaluate(t);return(Gi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class mn{constructor(t,r,d){this.type=t,this.branches=r,this.otherwise=d}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let d;r.expectedType&&r.expectedType.kind!=="value"&&(d=r.expectedType);let m=[];for(let y=1;y<t.length-1;y+=2){let b=r.parse(t[y],y,Rt);if(!b)return null;let w=r.parse(t[y+1],y+1,d);if(!w)return null;m.push([b,w]),d=d||w.type}let _=r.parse(t[t.length-1],t.length-1,d);if(!_)return null;if(!d)throw new Error("Can't infer output type");return new mn(d,m,_)}evaluate(t){for(let[r,d]of this.branches)if(r.evaluate(t))return d.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(let[r,d]of this.branches)t(r),t(d);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class No{constructor(t,r,d,m){this.type=t,this.input=r,this.beginIndex=d,this.endIndex=m}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let d=r.parse(t[1],1,zt),m=r.parse(t[2],2,Ve);if(!d||!m)return null;if(!al(d.type,[ui(zt),yt,zt]))return r.error(`Expected first argument to be of type array or string, but found ${ki(d.type)} instead`);if(t.length===4){let _=r.parse(t[3],3,Ve);return _?new No(d.type,d,m,_):null}return new No(d.type,d,m)}evaluate(t){let r=this.input.evaluate(t),d=this.beginIndex.evaluate(t),m;if(this.endIndex&&(m=this.endIndex.evaluate(t)),Bo(r,["string"]))return[...r].slice(d,m).join("");if(Bo(r,["array"]))return r.slice(d,m);throw new Pi(`Expected first argument to be of type array or string, but found ${ki(Gi(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function _o(o,t){let r=o.length-1,d,m,_=0,y=r,b=0;for(;_<=y;)if(b=Math.floor((_+y)/2),d=o[b],m=o[b+1],d<=t){if(b===r||t<m)return b;_=b+1}else{if(!(d>t))throw new Pi("Input is not a number.");y=b-1}return 0}class Vo{constructor(t,r,d){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(let[m,_]of d)this.labels.push(m),this.outputs.push(_)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");let d=r.parse(t[1],1,Ve);if(!d)return null;let m=[],_=null;r.expectedType&&r.expectedType.kind!=="value"&&(_=r.expectedType);for(let y=1;y<t.length;y+=2){let b=y===1?-1/0:t[y],w=t[y+1],S=y,I=y+1;if(typeof b!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(m.length&&m[m.length-1][0]>=b)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);let A=r.parse(w,I,_);if(!A)return null;_=_||A.type,m.push([b,A])}return new Vo(_,d,m)}evaluate(t){let r=this.labels,d=this.outputs;if(r.length===1)return d[0].evaluate(t);let m=this.input.evaluate(t);if(m<=r[0])return d[0].evaluate(t);let _=r.length;return m>=r[_-1]?d[_-1].evaluate(t):d[_o(r,m)].evaluate(t)}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function fn(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ul,Sa,cs=function(){if(Sa)return ul;function o(t,r,d,m){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(m-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=d,this.p2y=m}return Sa=1,ul=o,o.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,m=0;m<8;m++){var _=this.sampleCurveX(d)-t;if(Math.abs(_)<r)return d;var y=this.sampleCurveDerivativeX(d);if(Math.abs(y)<1e-6)break;d-=_/y}var b=0,w=1;for(d=t,m=0;m<20&&(_=this.sampleCurveX(d),!(Math.abs(_-t)<r));m++)t>_?b=d:w=d,d=.5*(w-b)+b;return d},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},ul}(),Nu=fn(cs);class Bn{constructor(t,r,d,m,_){this.type=t,this.operator=r,this.interpolation=d,this.input=m,this.labels=[],this.outputs=[];for(let[y,b]of _)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(t,r,d,m){let _=0;if(t.name==="exponential")_=Pa(r,t.base,d,m);else if(t.name==="linear")_=Pa(r,1,d,m);else if(t.name==="cubic-bezier"){let y=t.controlPoints;_=new Nu(y[0],y[1],y[2],y[3]).solve(Pa(r,1,d,m))}return _}static parse(t,r){let[d,m,_,...y]=t;if(!Array.isArray(m)||m.length===0)return r.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){let S=m[1];if(typeof S!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:S}}else{if(m[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(m[0])}`,1,0);{let S=m.slice(1);if(S.length!==4||S.some(I=>typeof I!="number"||I<0||I>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:S}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(_=r.parse(_,2,Ve),!_)return null;let b=[],w=null;d!=="interpolate-hcl"&&d!=="interpolate-lab"||r.expectedType==os?r.expectedType&&r.expectedType.kind!=="value"&&(w=r.expectedType):w=Tt;for(let S=0;S<y.length;S+=2){let I=y[S],A=y[S+1],L=S+3,N=S+4;if(typeof I!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(b.length&&b[b.length-1][0]>=I)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);let V=r.parse(A,N,w);if(!V)return null;w=w||V.type,b.push([I,V])}return go(w,Ve)||go(w,Ui)||go(w,Tt)||go(w,rs)||go(w,_r)||go(w,os)||go(w,Fi)||go(w,ui(Ve))?new Bn(w,d,m,_,b):r.error(`Type ${ki(w)} is not interpolatable.`)}evaluate(t){let r=this.labels,d=this.outputs;if(r.length===1)return d[0].evaluate(t);let m=this.input.evaluate(t);if(m<=r[0])return d[0].evaluate(t);let _=r.length;if(m>=r[_-1])return d[_-1].evaluate(t);let y=_o(r,m),b=Bn.interpolationFactor(this.interpolation,m,r[y],r[y+1]),w=d[y].evaluate(t),S=d[y+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ln(w,S,b);case"color":return Zt.interpolate(w,S,b);case"padding":return En.interpolate(w,S,b);case"colorArray":return pn.interpolate(w,S,b);case"numberArray":return $i.interpolate(w,S,b);case"variableAnchorOffsetCollection":return Xn.interpolate(w,S,b);case"array":return ls(w,S,b);case"projectionDefinition":return ar.interpolate(w,S,b)}case"interpolate-hcl":switch(this.type.kind){case"color":return Zt.interpolate(w,S,b,"hcl");case"colorArray":return pn.interpolate(w,S,b,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Zt.interpolate(w,S,b,"lab");case"colorArray":return pn.interpolate(w,S,b,"lab")}}}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Pa(o,t,r,d){let m=d-r,_=o-r;return m===0?0:t===1?_/m:(Math.pow(t,_)-1)/(Math.pow(t,m)-1)}let eo={color:Zt.interpolate,number:Ln,padding:En.interpolate,numberArray:$i.interpolate,colorArray:pn.interpolate,variableAnchorOffsetCollection:Xn.interpolate,array:ls};class ds{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d=null,m=r.expectedType;m&&m.kind!=="value"&&(d=m);let _=[];for(let b of t.slice(1)){let w=r.parse(b,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!w)return null;d=d||w.type,_.push(w)}if(!d)throw new Error("No output type");let y=m&&_.some(b=>Os(m,b.type));return new ds(y?zt:d,_)}evaluate(t){let r,d=null,m=0;for(let _ of this.args)if(m++,d=_.evaluate(t),d&&d instanceof yr&&!d.available&&(r||(r=d.name),d=null,m===this.args.length&&(d=r)),d!==null)break;return d}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Ea(o,t){return o==="=="||o==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ir(o,t,r,d){return d.compare(t,r)===0}function us(o,t,r){let d=o!=="=="&&o!=="!=";return class HC{constructor(_,y,b){this.type=Rt,this.lhs=_,this.rhs=y,this.collator=b,this.hasUntypedArgument=_.type.kind==="value"||y.type.kind==="value"}static parse(_,y){if(_.length!==3&&_.length!==4)return y.error("Expected two or three arguments.");let b=_[0],w=y.parse(_[1],1,zt);if(!w)return null;if(!Ea(b,w.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${ki(w.type)}'.`);let S=y.parse(_[2],2,zt);if(!S)return null;if(!Ea(b,S.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${ki(S.type)}'.`);if(w.type.kind!==S.type.kind&&w.type.kind!=="value"&&S.type.kind!=="value")return y.error(`Cannot compare types '${ki(w.type)}' and '${ki(S.type)}'.`);d&&(w.type.kind==="value"&&S.type.kind!=="value"?w=new Bt(S.type,[w]):w.type.kind!=="value"&&S.type.kind==="value"&&(S=new Bt(w.type,[S])));let I=null;if(_.length===4){if(w.type.kind!=="string"&&S.type.kind!=="string"&&w.type.kind!=="value"&&S.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(I=y.parse(_[3],3,Rs),!I)return null}return new HC(w,S,I)}evaluate(_){let y=this.lhs.evaluate(_),b=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){let w=Gi(y),S=Gi(b);if(w.kind!==S.kind||w.kind!=="string"&&w.kind!=="number")throw new Pi(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${w.kind}, ${S.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){let w=Gi(y),S=Gi(b);if(w.kind!=="string"||S.kind!=="string")return t(_,y,b)}return this.collator?r(_,y,b,this.collator.evaluate(_)):t(_,y,b)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}let hl=us("==",function(o,t,r){return t===r},Ir),Vu=us("!=",function(o,t,r){return t!==r},function(o,t,r,d){return!Ir(0,t,r,d)}),Ns=us("<",function(o,t,r){return t<r},function(o,t,r,d){return d.compare(t,r)<0}),yd=us(">",function(o,t,r){return t>r},function(o,t,r,d){return d.compare(t,r)>0}),ju=us("<=",function(o,t,r){return t<=r},function(o,t,r,d){return d.compare(t,r)<=0}),Uu=us(">=",function(o,t,r){return t>=r},function(o,t,r,d){return d.compare(t,r)>=0});class pl{constructor(t,r,d){this.type=Rs,this.locale=d,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");let d=t[1];if(typeof d!="object"||Array.isArray(d))return r.error("Collator options argument must be an object.");let m=r.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Rt);if(!m)return null;let _=r.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Rt);if(!_)return null;let y=null;return d.locale&&(y=r.parse(d.locale,1,yt),!y)?null:new pl(m,_,y)}evaluate(t){return new ya(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class hs{constructor(t,r,d,m,_){this.type=yt,this.number=t,this.locale=r,this.currency=d,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");let d=r.parse(t[1],1,Ve);if(!d)return null;let m=t[2];if(typeof m!="object"||Array.isArray(m))return r.error("NumberFormat options argument must be an object.");let _=null;if(m.locale&&(_=r.parse(m.locale,1,yt),!_))return null;let y=null;if(m.currency&&(y=r.parse(m.currency,1,yt),!y))return null;let b=null;if(m["min-fraction-digits"]&&(b=r.parse(m["min-fraction-digits"],1,Ve),!b))return null;let w=null;return m["max-fraction-digits"]&&(w=r.parse(m["max-fraction-digits"],1,Ve),!w)?null:new hs(d,_,y,b,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class ml{constructor(t){this.type=pa,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let d=t[1];if(!Array.isArray(d)&&typeof d=="object")return r.error("First argument must be an image or text section.");let m=[],_=!1;for(let y=1;y<=t.length-1;++y){let b=t[y];if(_&&typeof b=="object"&&!Array.isArray(b)){_=!1;let w=null;if(b["font-scale"]&&(w=r.parse(b["font-scale"],1,Ve),!w))return null;let S=null;if(b["text-font"]&&(S=r.parse(b["text-font"],1,ui(yt)),!S))return null;let I=null;if(b["text-color"]&&(I=r.parse(b["text-color"],1,Tt),!I))return null;let A=null;if(b["vertical-align"]){if(typeof b["vertical-align"]=="string"&&!va.includes(b["vertical-align"]))return r.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${b["vertical-align"]}' instead.`);if(A=r.parse(b["vertical-align"],1,yt),!A)return null}let L=m[m.length-1];L.scale=w,L.font=S,L.textColor=I,L.verticalAlign=A}else{let w=r.parse(t[y],1,zt);if(!w)return null;let S=w.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,m.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ml(m)}evaluate(t){return new qn(this.sections.map(r=>{let d=r.content.evaluate(t);return Gi(d)===zo?new Nr("",d,null,null,null,r.verticalAlign?r.verticalAlign.evaluate(t):null):new Nr(Wt(d),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null,r.verticalAlign?r.verticalAlign.evaluate(t):null)}))}eachChild(t){for(let r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor),r.verticalAlign&&t(r.verticalAlign)}outputDefined(){return!1}}class Vs{constructor(t){this.type=zo,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");let d=r.parse(t[1],1,yt);return d?new Vs(d):r.error("No image name provided.")}evaluate(t){let r=this.input.evaluate(t),d=yr.fromString(r);return d&&t.availableImages&&(d.available=t.availableImages.indexOf(r)>-1),d}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ta{constructor(t){this.type=Ve,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);let d=r.parse(t[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${ki(d.type)} instead.`):new Ta(d):null}evaluate(t){let r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Pi(`Expected value to be of type string or array, but found ${ki(Gi(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}let jr=8192;function fl(o,t){let r=(180+o[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,m=Math.pow(2,t.z);return[Math.round(r*m*jr),Math.round(d*m*jr)]}function js(o,t){let r=Math.pow(2,t.z);return[(m=(o[0]/jr+t.x)/r,360*m-180),(d=(o[1]/jr+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,m}function Ia(o,t){o[0]=Math.min(o[0],t[0]),o[1]=Math.min(o[1],t[1]),o[2]=Math.max(o[2],t[0]),o[3]=Math.max(o[3],t[1])}function Us(o,t){return!(o[0]<=t[0]||o[2]>=t[2]||o[1]<=t[1]||o[3]>=t[3])}function vd(o,t,r){let d=o[0]-t[0],m=o[1]-t[1],_=o[0]-r[0],y=o[1]-r[1];return d*y-_*m==0&&d*_<=0&&m*y<=0}function ka(o,t,r,d){return(m=[d[0]-r[0],d[1]-r[1]])[0]*(_=[t[0]-o[0],t[1]-o[1]])[1]-m[1]*_[0]!=0&&!(!xc(o,t,r,d)||!xc(r,d,o,t));var m,_}function yc(o,t,r){for(let d of r)for(let m=0;m<d.length-1;++m)if(ka(o,t,d[m],d[m+1]))return!0;return!1}function jo(o,t,r=!1){let d=!1;for(let b of t)for(let w=0;w<b.length-1;w++){if(vd(o,b[w],b[w+1]))return r;(_=b[w])[1]>(m=o)[1]!=(y=b[w+1])[1]>m[1]&&m[0]<(y[0]-_[0])*(m[1]-_[1])/(y[1]-_[1])+_[0]&&(d=!d)}var m,_,y;return d}function vc(o,t){for(let r of t)if(jo(o,r))return!0;return!1}function bc(o,t){for(let r of o)if(!jo(r,t))return!1;for(let r=0;r<o.length-1;++r)if(yc(o[r],o[r+1],t))return!1;return!0}function bd(o,t){for(let r of t)if(bc(o,r))return!0;return!1}function xc(o,t,r,d){let m=d[0]-r[0],_=d[1]-r[1],y=(o[0]-r[0])*_-m*(o[1]-r[1]),b=(t[0]-r[0])*_-m*(t[1]-r[1]);return y>0&&b<0||y<0&&b>0}function to(o,t,r){let d=[];for(let m=0;m<o.length;m++){let _=[];for(let y=0;y<o[m].length;y++){let b=fl(o[m][y],r);Ia(t,b),_.push(b)}d.push(_)}return d}function xd(o,t,r){let d=[];for(let m=0;m<o.length;m++){let _=to(o[m],t,r);d.push(_)}return d}function wd(o,t,r,d){if(o[0]<r[0]||o[0]>r[2]){let m=.5*d,_=o[0]-r[0]>m?-d:r[0]-o[0]>m?d:0;_===0&&(_=o[0]-r[2]>m?-d:r[2]-o[0]>m?d:0),o[0]+=_}Ia(t,o)}function Cd(o,t,r,d){let m=Math.pow(2,d.z)*jr,_=[d.x*jr,d.y*jr],y=[];for(let b of o)for(let w of b){let S=[w.x+_[0],w.y+_[1]];wd(S,t,r,m),y.push(S)}return y}function gl(o,t,r,d){let m=Math.pow(2,d.z)*jr,_=[d.x*jr,d.y*jr],y=[];for(let w of o){let S=[];for(let I of w){let A=[I.x+_[0],I.y+_[1]];Ia(t,A),S.push(A)}y.push(S)}if(t[2]-t[0]<=m/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(let w of y)for(let S of w)wd(S,t,r,m)}var b;return y}class yo{constructor(t,r){this.type=Rt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ci(t[1])){let d=t[1];if(d.type==="FeatureCollection"){let m=[];for(let _ of d.features){let{type:y,coordinates:b}=_.geometry;y==="Polygon"&&m.push(b),y==="MultiPolygon"&&m.push(...b)}if(m.length)return new yo(d,{type:"MultiPolygon",coordinates:m})}else if(d.type==="Feature"){let m=d.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new yo(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new yo(d,d)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,d){let m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(d.type==="Polygon"){let b=to(d.coordinates,_,y),w=Cd(r.geometry(),m,_,y);if(!Us(m,_))return!1;for(let S of w)if(!jo(S,b))return!1}if(d.type==="MultiPolygon"){let b=xd(d.coordinates,_,y),w=Cd(r.geometry(),m,_,y);if(!Us(m,_))return!1;for(let S of w)if(!vc(S,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,d){let m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(d.type==="Polygon"){let b=to(d.coordinates,_,y),w=gl(r.geometry(),m,_,y);if(!Us(m,_))return!1;for(let S of w)if(!bc(S,b))return!1}if(d.type==="MultiPolygon"){let b=xd(d.coordinates,_,y),w=gl(r.geometry(),m,_,y);if(!Us(m,_))return!1;for(let S of w)if(!bd(S,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let wc=class{constructor(o=[],t=(r,d)=>r<d?-1:r>d?1:0){if(this.data=o,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;let o=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),o}peek(){return this.data[0]}_up(o){let{data:t,compare:r}=this,d=t[o];for(;o>0;){let m=o-1>>1,_=t[m];if(r(d,_)>=0)break;t[o]=_,o=m}t[o]=d}_down(o){let{data:t,compare:r}=this,d=this.length>>1,m=t[o];for(;o<d;){let _=1+(o<<1),y=_+1;if(y<this.length&&r(t[y],t[_])<0&&(_=y),r(t[_],m)>=0)break;t[o]=t[_],o=_}t[o]=m}};function Md(o,t,r=0,d=o.length-1,m=Sd){for(;d>r;){if(d-r>600){let w=d-r+1,S=t-r+1,I=Math.log(w),A=.5*Math.exp(2*I/3),L=.5*Math.sqrt(I*A*(w-A)/w)*(S-w/2<0?-1:1);Md(o,t,Math.max(r,Math.floor(t-S*A/w+L)),Math.min(d,Math.floor(t+(w-S)*A/w+L)),m)}let _=o[t],y=r,b=d;for($s(o,r,t),m(o[d],_)>0&&$s(o,r,d);y<b;){for($s(o,y,b),y++,b--;m(o[y],_)<0;)y++;for(;m(o[b],_)>0;)b--}m(o[r],_)===0?$s(o,r,b):(b++,$s(o,b,d)),b<=t&&(r=b+1),t<=b&&(d=b-1)}}function $s(o,t,r){let d=o[t];o[t]=o[r],o[r]=d}function Sd(o,t){return o<t?-1:o>t?1:0}function Aa(o,t){if(o.length<=1)return[o];let r=[],d,m;for(let _ of o){let y=$u(_);y!==0&&(_.area=Math.abs(y),m===void 0&&(m=y<0),m===y<0?(d&&r.push(d),d=[_]):d.push(_))}if(d&&r.push(d),t>1)for(let _=0;_<r.length;_++)r[_].length<=t||(Md(r[_],t,1,r[_].length-1,Pd),r[_]=r[_].slice(0,t));return r}function Pd(o,t){return t.area-o.area}function $u(o){let t=0;for(let r,d,m=0,_=o.length,y=_-1;m<_;y=m++)r=o[m],d=o[y],t+=(d.x-r.x)*(r.y+d.y);return t}let _l=1/298.257223563,Ed=_l*(2-_l),Cc=Math.PI/180;class Da{constructor(t){let r=6378.137*Cc*1e3,d=Math.cos(t*Cc),m=1/(1-Ed*(1-d*d)),_=Math.sqrt(m);this.kx=r*_*d,this.ky=r*_*m*(1-Ed)}distance(t,r){let d=this.wrap(t[0]-r[0])*this.kx,m=(t[1]-r[1])*this.ky;return Math.sqrt(d*d+m*m)}pointOnLine(t,r){let d,m,_,y,b=1/0;for(let w=0;w<t.length-1;w++){let S=t[w][0],I=t[w][1],A=this.wrap(t[w+1][0]-S)*this.kx,L=(t[w+1][1]-I)*this.ky,N=0;A===0&&L===0||(N=(this.wrap(r[0]-S)*this.kx*A+(r[1]-I)*this.ky*L)/(A*A+L*L),N>1?(S=t[w+1][0],I=t[w+1][1]):N>0&&(S+=A/this.kx*N,I+=L/this.ky*N)),A=this.wrap(r[0]-S)*this.kx,L=(r[1]-I)*this.ky;let V=A*A+L*L;V<b&&(b=V,d=S,m=I,_=w,y=N)}return{point:[d,m],index:_,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Td(o,t){return t[0]-o[0]}function ni(o){return o[1]-o[0]+1}function vo(o,t){return o[1]>=o[0]&&o[1]<t}function Mc(o,t){if(o[0]>o[1])return[null,null];let r=ni(o);if(t){if(r===2)return[o,null];let m=Math.floor(r/2);return[[o[0],o[0]+m],[o[0]+m,o[1]]]}if(r===1)return[o,null];let d=Math.floor(r/2)-1;return[[o[0],o[0]+d],[o[0]+d+1,o[1]]]}function Gs(o,t){if(!vo(t,o.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let d=t[0];d<=t[1];++d)Ia(r,o[d]);return r}function Sc(o){let t=[1/0,1/0,-1/0,-1/0];for(let r of o)for(let d of r)Ia(t,d);return t}function Id(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function Pc(o,t,r){if(!Id(o)||!Id(t))return NaN;let d=0,m=0;return o[2]<t[0]&&(d=t[0]-o[2]),o[0]>t[2]&&(d=o[0]-t[2]),o[1]>t[3]&&(m=o[1]-t[3]),o[3]<t[1]&&(m=t[1]-o[3]),r.distance([0,0],[d,m])}function ps(o,t,r){let d=r.pointOnLine(t,o);return r.distance(o,d.point)}function yl(o,t,r,d,m){let _=Math.min(ps(o,[r,d],m),ps(t,[r,d],m)),y=Math.min(ps(r,[o,t],m),ps(d,[o,t],m));return Math.min(_,y)}function Gu(o,t,r,d,m){if(!vo(t,o.length)||!vo(d,r.length))return 1/0;let _=1/0;for(let y=t[0];y<t[1];++y){let b=o[y],w=o[y+1];for(let S=d[0];S<d[1];++S){let I=r[S],A=r[S+1];if(ka(b,w,I,A))return 0;_=Math.min(_,yl(b,w,I,A,m))}}return _}function Hu(o,t,r,d,m){if(!vo(t,o.length)||!vo(d,r.length))return NaN;let _=1/0;for(let y=t[0];y<=t[1];++y)for(let b=d[0];b<=d[1];++b)if(_=Math.min(_,m.distance(o[y],r[b])),_===0)return _;return _}function Zu(o,t,r){if(jo(o,t,!0))return 0;let d=1/0;for(let m of t){let _=m[0],y=m[m.length-1];if(_!==y&&(d=Math.min(d,ps(o,[y,_],r)),d===0))return d;let b=r.pointOnLine(m,o);if(d=Math.min(d,r.distance(o,b.point)),d===0)return d}return d}function Wu(o,t,r,d){if(!vo(t,o.length))return NaN;for(let _=t[0];_<=t[1];++_)if(jo(o[_],r,!0))return 0;let m=1/0;for(let _=t[0];_<t[1];++_){let y=o[_],b=o[_+1];for(let w of r)for(let S=0,I=w.length,A=I-1;S<I;A=S++){let L=w[A],N=w[S];if(ka(y,b,L,N))return 0;m=Math.min(m,yl(y,b,L,N,d))}}return m}function Ec(o,t){for(let r of o)for(let d of r)if(jo(d,t,!0))return!0;return!1}function kd(o,t,r,d=1/0){let m=Sc(o),_=Sc(t);if(d!==1/0&&Pc(m,_,r)>=d)return d;if(Us(m,_)){if(Ec(o,t))return 0}else if(Ec(t,o))return 0;let y=1/0;for(let b of o)for(let w=0,S=b.length,I=S-1;w<S;I=w++){let A=b[I],L=b[w];for(let N of t)for(let V=0,G=N.length,K=G-1;V<G;K=V++){let ne=N[K],me=N[V];if(ka(A,L,ne,me))return 0;y=Math.min(y,yl(A,L,ne,me,r))}}return y}function Ad(o,t,r,d,m,_){if(!_)return;let y=Pc(Gs(d,_),m,r);y<t&&o.push([y,_,[0,0]])}function vl(o,t,r,d,m,_,y){if(!_||!y)return;let b=Pc(Gs(d,_),Gs(m,y),r);b<t&&o.push([b,_,y])}function bl(o,t,r,d,m=1/0){let _=Math.min(d.distance(o[0],r[0][0]),m);if(_===0)return _;let y=new wc([[0,[0,o.length-1],[0,0]]],Td),b=Sc(r);for(;y.length>0;){let w=y.pop();if(w[0]>=_)continue;let S=w[1],I=t?50:100;if(ni(S)<=I){if(!vo(S,o.length))return NaN;if(t){let A=Wu(o,S,r,d);if(isNaN(A)||A===0)return A;_=Math.min(_,A)}else for(let A=S[0];A<=S[1];++A){let L=Zu(o[A],r,d);if(_=Math.min(_,L),_===0)return 0}}else{let A=Mc(S,t);Ad(y,_,d,o,b,A[0]),Ad(y,_,d,o,b,A[1])}}return _}function Ra(o,t,r,d,m,_=1/0){let y=Math.min(_,m.distance(o[0],r[0]));if(y===0)return y;let b=new wc([[0,[0,o.length-1],[0,r.length-1]]],Td);for(;b.length>0;){let w=b.pop();if(w[0]>=y)continue;let S=w[1],I=w[2],A=t?50:100,L=d?50:100;if(ni(S)<=A&&ni(I)<=L){if(!vo(S,o.length)&&vo(I,r.length))return NaN;let N;if(t&&d)N=Gu(o,S,r,I,m),y=Math.min(y,N);else if(t&&!d){let V=o.slice(S[0],S[1]+1);for(let G=I[0];G<=I[1];++G)if(N=ps(r[G],V,m),y=Math.min(y,N),y===0)return y}else if(!t&&d){let V=r.slice(I[0],I[1]+1);for(let G=S[0];G<=S[1];++G)if(N=ps(o[G],V,m),y=Math.min(y,N),y===0)return y}else N=Hu(o,S,r,I,m),y=Math.min(y,N)}else{let N=Mc(S,t),V=Mc(I,d);vl(b,y,m,o,r,N[0],V[0]),vl(b,y,m,o,r,N[0],V[1]),vl(b,y,m,o,r,N[1],V[0]),vl(b,y,m,o,r,N[1],V[1])}}return y}function Oa(o){return o.type==="MultiPolygon"?o.coordinates.map(t=>({type:"Polygon",coordinates:t})):o.type==="MultiLineString"?o.coordinates.map(t=>({type:"LineString",coordinates:t})):o.type==="MultiPoint"?o.coordinates.map(t=>({type:"Point",coordinates:t})):[o]}class ms{constructor(t,r){this.type=Ve,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ci(t[1])){let d=t[1];if(d.type==="FeatureCollection")return new ms(d,d.features.map(m=>Oa(m.geometry)).flat());if(d.type==="Feature")return new ms(d,Oa(d.geometry));if("type"in d&&"coordinates"in d)return new ms(d,Oa(d))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,d){let m=r.geometry(),_=m.flat().map(w=>js([w.x,w.y],r.canonical));if(m.length===0)return NaN;let y=new Da(_[0][1]),b=1/0;for(let w of d){switch(w.type){case"Point":b=Math.min(b,Ra(_,!1,[w.coordinates],!1,y,b));break;case"LineString":b=Math.min(b,Ra(_,!1,w.coordinates,!0,y,b));break;case"Polygon":b=Math.min(b,bl(_,!1,w.coordinates,y,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,d){let m=r.geometry(),_=m.flat().map(w=>js([w.x,w.y],r.canonical));if(m.length===0)return NaN;let y=new Da(_[0][1]),b=1/0;for(let w of d){switch(w.type){case"Point":b=Math.min(b,Ra(_,!0,[w.coordinates],!1,y,b));break;case"LineString":b=Math.min(b,Ra(_,!0,w.coordinates,!0,y,b));break;case"Polygon":b=Math.min(b,bl(_,!0,w.coordinates,y,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="Polygon")return function(r,d){let m=r.geometry();if(m.length===0||m[0].length===0)return NaN;let _=Aa(m,0).map(w=>w.map(S=>S.map(I=>js([I.x,I.y],r.canonical)))),y=new Da(_[0][0][0][1]),b=1/0;for(let w of d)for(let S of _){switch(w.type){case"Point":b=Math.min(b,bl([w.coordinates],!1,S,y,b));break;case"LineString":b=Math.min(b,bl(w.coordinates,!0,S,y,b));break;case"Polygon":b=Math.min(b,kd(S,w.coordinates,y,b))}if(b===0)return b}return b}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class xl{constructor(t){this.type=zt,this.key=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);let d=t[1];return d==null?r.error("Global state property must be defined."):typeof d!="string"?r.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new xl(d)}evaluate(t){var r;let d=(r=t.globals)===null||r===void 0?void 0:r.globalState;return d&&Object.keys(d).length!==0?ga(d,this.key):null}eachChild(){}outputDefined(){return!1}}let Hs={"==":hl,"!=":Vu,">":yd,"<":Ns,">=":Uu,"<=":ju,array:Bt,at:_c,boolean:Bt,case:mn,coalesce:ds,collator:pl,format:ml,image:Vs,in:Ca,"index-of":Ma,interpolate:Bn,"interpolate-hcl":Bn,"interpolate-lab":Bn,length:Ta,let:Vr,literal:Et,match:lr,number:Bt,"number-format":hs,object:Bt,slice:No,step:Vo,string:Bt,"to-boolean":zn,"to-color":zn,"to-number":zn,"to-string":zn,var:wa,within:yo,distance:ms,"global-state":xl};class Ur{constructor(t,r,d,m){this.name=t,this.type=r,this._evaluate=d,this.args=m}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){let d=t[0],m=Ur.definitions[d];if(!m)return r.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);let _=Array.isArray(m)?m[0]:m.type,y=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,b=y.filter(([S])=>!Array.isArray(S)||S.length===t.length-1),w=null;for(let[S,I]of b){w=new xa(r.registry,Fa,r.path,null,r.scope);let A=[],L=!1;for(let N=1;N<t.length;N++){let V=t[N],G=Array.isArray(S)?S[N-1]:S.type,K=w.parse(V,1+A.length,G);if(!K){L=!0;break}A.push(K)}if(!L)if(Array.isArray(S)&&S.length!==A.length)w.error(`Expected ${S.length} arguments, but found ${A.length} instead.`);else{for(let N=0;N<A.length;N++){let V=Array.isArray(S)?S[N]:S.type,G=A[N];w.concat(N+1).checkSubtype(V,G.type)}if(w.errors.length===0)return new Ur(d,_,I,A)}}if(b.length===1)r.errors.push(...w.errors);else{let S=(b.length?b:y).map(([A])=>{return L=A,Array.isArray(L)?`(${L.map(ki).join(", ")})`:`(${ki(L.type)}...)`;var L}).join(" | "),I=[];for(let A=1;A<t.length;A++){let L=r.parse(t[A],1+I.length);if(!L)return null;I.push(ki(L.type))}r.error(`Expected arguments of type ${S}, but found (${I.join(", ")}) instead.`)}return null}static register(t,r){Ur.definitions=r;for(let d in r)t[d]=Ur}}function qu(o,[t,r,d,m]){t=t.evaluate(o),r=r.evaluate(o),d=d.evaluate(o);let _=m?m.evaluate(o):1,y=ba(t,r,d,_);if(y)throw new Pi(y);return new Zt(t/255,r/255,d/255,_,!1)}function Xu(o,t){return o in t}function Tc(o,t){let r=t[o];return r===void 0?null:r}function fs(o){return{type:o}}function Fa(o){if(o instanceof wa)return Fa(o.boundExpression);if(o instanceof Ur&&o.name==="error"||o instanceof pl||o instanceof yo||o instanceof ms||o instanceof xl)return!1;let t=o instanceof zn||o instanceof Bt,r=!0;return o.eachChild(d=>{r=t?r&&Fa(d):r&&d instanceof Et}),!!r&&wl(o)&&Cl(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function wl(o){if(o instanceof Ur&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof yo||o instanceof ms)return!1;let t=!0;return o.eachChild(r=>{t&&!wl(r)&&(t=!1)}),t}function La(o){if(o instanceof Ur&&o.name==="feature-state")return!1;let t=!0;return o.eachChild(r=>{t&&!La(r)&&(t=!1)}),t}function Cl(o,t){if(o instanceof Ur&&t.indexOf(o.name)>=0)return!1;let r=!0;return o.eachChild(d=>{r&&!Cl(d,t)&&(r=!1)}),r}function Ml(o){return{result:"success",value:o}}function Zs(o){return{result:"error",value:o}}function Ws(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Dd(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function Sl(o){return!!o.expression&&o.expression.interpolated}function Ut(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function io(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&Gi(o)===sr}function za(o){return o}function Ic(o,t){let r=o.stops&&typeof o.stops[0][0]=="object",d=r||!(r||o.property!==void 0),m=o.type||(Sl(t)?"exponential":"interval"),_=function(I){switch(I.type){case"color":return Zt.parse;case"padding":return En.parse;case"numberArray":return $i.parse;case"colorArray":return pn.parse;default:return null}}(t);if(_&&((o=ai({},o)).stops&&(o.stops=o.stops.map(I=>[I[0],_(I[1])])),o.default=_(o.default?o.default:t.default)),o.colorSpace&&(y=o.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var y;let b=function(I){switch(I){case"exponential":return Rd;case"interval":return Ku;case"categorical":return Yu;case"identity":return Od;default:throw new Error(`Unknown function type "${I}"`)}}(m),w,S;if(m==="categorical"){w=Object.create(null);for(let I of o.stops)w[I[0]]=I[1];S=typeof o.stops[0][0]}if(r){let I={},A=[];for(let V=0;V<o.stops.length;V++){let G=o.stops[V],K=G[0].zoom;I[K]===void 0&&(I[K]={zoom:K,type:o.type,property:o.property,default:o.default,stops:[]},A.push(K)),I[K].stops.push([G[0].value,G[1]])}let L=[];for(let V of A)L.push([I[V].zoom,Ic(I[V],t)]);let N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:Bn.interpolationFactor.bind(void 0,N),zoomStops:L.map(V=>V[0]),evaluate:({zoom:V},G)=>Rd({stops:L,base:o.base},t,V).evaluate(V,G)}}if(d){let I=m==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Bn.interpolationFactor.bind(void 0,I),zoomStops:o.stops.map(A=>A[0]),evaluate:({zoom:A})=>b(o,t,A,w,S)}}return{kind:"source",evaluate(I,A){let L=A&&A.properties?A.properties[o.property]:void 0;return L===void 0?Uo(o.default,t.default):b(o,t,L,w,S)}}}function Uo(o,t,r){return o!==void 0?o:t!==void 0?t:r!==void 0?r:void 0}function Yu(o,t,r,d,m){return Uo(typeof r===m?d[r]:void 0,o.default,t.default)}function Ku(o,t,r){if(Ut(r)!=="number")return Uo(o.default,t.default);let d=o.stops.length;if(d===1||r<=o.stops[0][0])return o.stops[0][1];if(r>=o.stops[d-1][0])return o.stops[d-1][1];let m=_o(o.stops.map(_=>_[0]),r);return o.stops[m][1]}function Rd(o,t,r){let d=o.base!==void 0?o.base:1;if(Ut(r)!=="number")return Uo(o.default,t.default);let m=o.stops.length;if(m===1||r<=o.stops[0][0])return o.stops[0][1];if(r>=o.stops[m-1][0])return o.stops[m-1][1];let _=_o(o.stops.map(I=>I[0]),r),y=function(I,A,L,N){let V=N-L,G=I-L;return V===0?0:A===1?G/V:(Math.pow(A,G)-1)/(Math.pow(A,V)-1)}(r,d,o.stops[_][0],o.stops[_+1][0]),b=o.stops[_][1],w=o.stops[_+1][1],S=eo[t.type]||za;return typeof b.evaluate=="function"?{evaluate(...I){let A=b.evaluate.apply(void 0,I),L=w.evaluate.apply(void 0,I);if(A!==void 0&&L!==void 0)return S(A,L,y,o.colorSpace)}}:S(b,w,y,o.colorSpace)}function Od(o,t,r){switch(t.type){case"color":r=Zt.parse(r);break;case"formatted":r=qn.fromString(r.toString());break;case"resolvedImage":r=yr.fromString(r.toString());break;case"padding":r=En.parse(r);break;case"colorArray":r=pn.parse(r);break;case"numberArray":r=$i.parse(r);break;default:Ut(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return Uo(r,o.default,t.default)}Ur.register(Hs,{error:[{kind:"error"},[yt],(o,[t])=>{throw new Pi(t.evaluate(o))}],typeof:[yt,[zt],(o,[t])=>ki(Gi(t.evaluate(o)))],"to-rgba":[ui(Ve,4),[Tt],(o,[t])=>{let[r,d,m,_]=t.evaluate(o).rgb;return[255*r,255*d,255*m,_]}],rgb:[Tt,[Ve,Ve,Ve],qu],rgba:[Tt,[Ve,Ve,Ve,Ve],qu],has:{type:Rt,overloads:[[[yt],(o,[t])=>Xu(t.evaluate(o),o.properties())],[[yt,sr],(o,[t,r])=>Xu(t.evaluate(o),r.evaluate(o))]]},get:{type:zt,overloads:[[[yt],(o,[t])=>Tc(t.evaluate(o),o.properties())],[[yt,sr],(o,[t,r])=>Tc(t.evaluate(o),r.evaluate(o))]]},"feature-state":[zt,[yt],(o,[t])=>Tc(t.evaluate(o),o.featureState||{})],properties:[sr,[],o=>o.properties()],"geometry-type":[yt,[],o=>o.geometryType()],id:[zt,[],o=>o.id()],zoom:[Ve,[],o=>o.globals.zoom],"heatmap-density":[Ve,[],o=>o.globals.heatmapDensity||0],"line-progress":[Ve,[],o=>o.globals.lineProgress||0],accumulated:[zt,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Ve,fs(Ve),(o,t)=>{let r=0;for(let d of t)r+=d.evaluate(o);return r}],"*":[Ve,fs(Ve),(o,t)=>{let r=1;for(let d of t)r*=d.evaluate(o);return r}],"-":{type:Ve,overloads:[[[Ve,Ve],(o,[t,r])=>t.evaluate(o)-r.evaluate(o)],[[Ve],(o,[t])=>-t.evaluate(o)]]},"/":[Ve,[Ve,Ve],(o,[t,r])=>t.evaluate(o)/r.evaluate(o)],"%":[Ve,[Ve,Ve],(o,[t,r])=>t.evaluate(o)%r.evaluate(o)],ln2:[Ve,[],()=>Math.LN2],pi:[Ve,[],()=>Math.PI],e:[Ve,[],()=>Math.E],"^":[Ve,[Ve,Ve],(o,[t,r])=>Math.pow(t.evaluate(o),r.evaluate(o))],sqrt:[Ve,[Ve],(o,[t])=>Math.sqrt(t.evaluate(o))],log10:[Ve,[Ve],(o,[t])=>Math.log(t.evaluate(o))/Math.LN10],ln:[Ve,[Ve],(o,[t])=>Math.log(t.evaluate(o))],log2:[Ve,[Ve],(o,[t])=>Math.log(t.evaluate(o))/Math.LN2],sin:[Ve,[Ve],(o,[t])=>Math.sin(t.evaluate(o))],cos:[Ve,[Ve],(o,[t])=>Math.cos(t.evaluate(o))],tan:[Ve,[Ve],(o,[t])=>Math.tan(t.evaluate(o))],asin:[Ve,[Ve],(o,[t])=>Math.asin(t.evaluate(o))],acos:[Ve,[Ve],(o,[t])=>Math.acos(t.evaluate(o))],atan:[Ve,[Ve],(o,[t])=>Math.atan(t.evaluate(o))],min:[Ve,fs(Ve),(o,t)=>Math.min(...t.map(r=>r.evaluate(o)))],max:[Ve,fs(Ve),(o,t)=>Math.max(...t.map(r=>r.evaluate(o)))],abs:[Ve,[Ve],(o,[t])=>Math.abs(t.evaluate(o))],round:[Ve,[Ve],(o,[t])=>{let r=t.evaluate(o);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ve,[Ve],(o,[t])=>Math.floor(t.evaluate(o))],ceil:[Ve,[Ve],(o,[t])=>Math.ceil(t.evaluate(o))],"filter-==":[Rt,[yt,zt],(o,[t,r])=>o.properties()[t.value]===r.value],"filter-id-==":[Rt,[zt],(o,[t])=>o.id()===t.value],"filter-type-==":[Rt,[yt],(o,[t])=>o.geometryType()===t.value],"filter-<":[Rt,[yt,zt],(o,[t,r])=>{let d=o.properties()[t.value],m=r.value;return typeof d==typeof m&&d<m}],"filter-id-<":[Rt,[zt],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r<d}],"filter->":[Rt,[yt,zt],(o,[t,r])=>{let d=o.properties()[t.value],m=r.value;return typeof d==typeof m&&d>m}],"filter-id->":[Rt,[zt],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r>d}],"filter-<=":[Rt,[yt,zt],(o,[t,r])=>{let d=o.properties()[t.value],m=r.value;return typeof d==typeof m&&d<=m}],"filter-id-<=":[Rt,[zt],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r<=d}],"filter->=":[Rt,[yt,zt],(o,[t,r])=>{let d=o.properties()[t.value],m=r.value;return typeof d==typeof m&&d>=m}],"filter-id->=":[Rt,[zt],(o,[t])=>{let r=o.id(),d=t.value;return typeof r==typeof d&&r>=d}],"filter-has":[Rt,[zt],(o,[t])=>t.value in o.properties()],"filter-has-id":[Rt,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Rt,[ui(yt)],(o,[t])=>t.value.indexOf(o.geometryType())>=0],"filter-id-in":[Rt,[ui(zt)],(o,[t])=>t.value.indexOf(o.id())>=0],"filter-in-small":[Rt,[yt,ui(zt)],(o,[t,r])=>r.value.indexOf(o.properties()[t.value])>=0],"filter-in-large":[Rt,[yt,ui(zt)],(o,[t,r])=>function(d,m,_,y){for(;_<=y;){let b=_+y>>1;if(m[b]===d)return!0;m[b]>d?y=b-1:_=b+1}return!1}(o.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Rt,overloads:[[[Rt,Rt],(o,[t,r])=>t.evaluate(o)&&r.evaluate(o)],[fs(Rt),(o,t)=>{for(let r of t)if(!r.evaluate(o))return!1;return!0}]]},any:{type:Rt,overloads:[[[Rt,Rt],(o,[t,r])=>t.evaluate(o)||r.evaluate(o)],[fs(Rt),(o,t)=>{for(let r of t)if(r.evaluate(o))return!0;return!1}]]},"!":[Rt,[Rt],(o,[t])=>!t.evaluate(o)],"is-supported-script":[Rt,[yt],(o,[t])=>{let r=o.globals&&o.globals.isSupportedScript;return!r||r(t.evaluate(o))}],upcase:[yt,[yt],(o,[t])=>t.evaluate(o).toUpperCase()],downcase:[yt,[yt],(o,[t])=>t.evaluate(o).toLowerCase()],concat:[yt,fs(zt),(o,t)=>t.map(r=>Wt(r.evaluate(o))).join("")],"resolved-locale":[yt,[Rs],(o,[t])=>t.evaluate(o).resolvedLocale()]});class Pl{constructor(t,r){this.expression=t,this._warningHistory={},this._evaluator=new gc,this._defaultValue=r?function(d){if(d.type==="color"&&io(d.default))return new Zt(0,0,0,0);switch(d.type){case"color":return Zt.parse(d.default)||null;case"padding":return En.parse(d.default)||null;case"numberArray":return $i.parse(d.default)||null;case"colorArray":return pn.parse(d.default)||null;case"variableAnchorOffsetCollection":return Xn.parse(d.default)||null;case"projectionDefinition":return ar.parse(d.default)||null;default:return d.default===void 0?null:d.default}}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,d,m,_,y){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=d,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,r,d,m,_,y){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=d||null,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y||null;try{let b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Pi(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Ba(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Hs}function El(o,t){let r=new xa(Hs,Fa,[],t?function(m){let _={color:Tt,string:yt,number:Ve,enum:yt,boolean:Rt,formatted:pa,padding:rs,numberArray:_r,colorArray:os,projectionDefinition:Ui,resolvedImage:zo,variableAnchorOffsetCollection:Fi};return m.type==="array"?ui(_[m.value]||zt,m.length):_[m.type]}(t):void 0),d=r.parse(o,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Ml(new Pl(d,t)):Zs(r.errors)}class kr{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!La(r.expression)}evaluateWithoutErrorHandling(t,r,d,m,_,y){return this._styleExpression.evaluateWithoutErrorHandling(t,r,d,m,_,y)}evaluate(t,r,d,m,_,y){return this._styleExpression.evaluate(t,r,d,m,_,y)}}class gs{constructor(t,r,d,m){this.kind=t,this.zoomStops=d,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!La(r.expression),this.interpolationType=m}evaluateWithoutErrorHandling(t,r,d,m,_,y){return this._styleExpression.evaluateWithoutErrorHandling(t,r,d,m,_,y)}evaluate(t,r,d,m,_,y){return this._styleExpression.evaluate(t,r,d,m,_,y)}interpolationFactor(t,r,d){return this.interpolationType?Bn.interpolationFactor(this.interpolationType,t,r,d):0}}function Hi(o,t){let r=El(o,t);if(r.result==="error")return r;let d=r.value.expression,m=wl(d);if(!m&&!Ws(t))return Zs([new jt("","data expressions not supported")]);let _=Cl(d,["zoom"]);if(!_&&!Dd(t))return Zs([new jt("","zoom expressions not supported")]);let y=Va(d);return y||_?y instanceof jt?Zs([y]):y instanceof Bn&&!Sl(t)?Zs([new jt("",'"interpolate" expressions cannot be used with this property')]):Ml(y?new gs(m?"camera":"composite",r.value,y.labels,y instanceof Bn?y.interpolation:void 0):new kr(m?"constant":"source",r.value)):Zs([new jt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Na{constructor(t,r){this._parameters=t,this._specification=r,ai(this,Ic(this._parameters,this._specification))}static deserialize(t){return new Na(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Va(o){let t=null;if(o instanceof Vr)t=Va(o.result);else if(o instanceof ds){for(let r of o.args)if(t=Va(r),t)break}else(o instanceof Vo||o instanceof Bn)&&o.input instanceof Ur&&o.input.name==="zoom"&&(t=o);return t instanceof jt||o.eachChild(r=>{let d=Va(r);d instanceof jt?t=d:!t&&d?t=new jt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&d&&t!==d&&(t=new jt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ja(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(let t of o.slice(1))if(!ja(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}let kc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ua(o){if(o==null)return{filter:()=>!0,needGeometry:!1};ja(o)||(o=Il(o));let t=El(o,kc);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,d,m)=>t.value.evaluate(r,d,{},m),needGeometry:Fd(o)}}function Tl(o,t){return o<t?-1:o>t?1:0}function Fd(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let t=1;t<o.length;t++)if(Fd(o[t]))return!0;return!1}function Il(o){if(!o)return!0;let t=o[0];return o.length<=1?t!=="any":t==="=="?qs(o[1],o[2],"=="):t==="!="?z(qs(o[1],o[2],"==")):t==="<"||t===">"||t==="<="||t===">="?qs(o[1],o[2],t):t==="any"?(r=o.slice(1),["any"].concat(r.map(Il))):t==="all"?["all"].concat(o.slice(1).map(Il)):t==="none"?["all"].concat(o.slice(1).map(Il).map(z)):t==="in"?M(o[1],o.slice(2)):t==="!in"?z(M(o[1],o.slice(2))):t==="has"?E(o[1]):t!=="!has"||z(E(o[1]));var r}function qs(o,t,r){switch(o){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,o,t]}}function M(o,t){if(t.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",o,["literal",t.sort(Tl)]]:["filter-in-small",o,["literal",t]]}}function E(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function z(o){return["!",o]}function oe(o){let t=typeof o;if(t==="number"||t==="boolean"||t==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let m="[";for(let _ of o)m+=`${oe(_)},`;return`${m}]`}let r=Object.keys(o).sort(),d="{";for(let m=0;m<r.length;m++)d+=`${JSON.stringify(r[m])}:${oe(o[r[m]])},`;return`${d}}`}function Fe(o){let t="";for(let r of Me)t+=`/${oe(o[r])}`;return t}function it(o){let t=o.value;return t?[new De(o.key,t,"constants have been deprecated as of v8")]:[]}function xt(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function ti(o){if(Array.isArray(o))return o.map(ti);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){let t={};for(let r in o)t[r]=ti(o[r]);return t}return xt(o)}function ri(o){let t=o.key,r=o.value,d=o.valueSpec||{},m=o.objectElementValidators||{},_=o.style,y=o.styleSpec,b=o.validateSpec,w=[],S=Ut(r);if(S!=="object")return[new De(t,r,`object expected, ${S} found`)];for(let I in r){let A=I.split(".")[0],L=ga(d,A)||d["*"],N;if(ga(m,A))N=m[A];else if(ga(d,A))N=b;else if(m["*"])N=m["*"];else{if(!d["*"]){w.push(new De(t,r[I],`unknown property "${I}"`));continue}N=b}w=w.concat(N({key:(t&&`${t}.`)+I,value:r[I],valueSpec:L,style:_,styleSpec:y,object:r,objectKey:I,validateSpec:b},r))}for(let I in d)m[I]||d[I].required&&d[I].default===void 0&&r[I]===void 0&&w.push(new De(t,r,`missing required property "${I}"`));return w}function $o(o){let t=o.value,r=o.valueSpec,d=o.style,m=o.styleSpec,_=o.key,y=o.arrayElementValidator||o.validateSpec;if(Ut(t)!=="array")return[new De(_,t,`array expected, ${Ut(t)} found`)];if(r.length&&t.length!==r.length)return[new De(_,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new De(_,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let b={type:r.value,values:r.values};m.$version<7&&(b.function=r.function),Ut(r.value)==="object"&&(b=r.value);let w=[];for(let S=0;S<t.length;S++)w=w.concat(y({array:t,arrayIndex:S,value:t[S],valueSpec:b,validateSpec:o.validateSpec,style:d,styleSpec:m,key:`${_}[${S}]`}));return w}function _s(o){let t=o.key,r=o.value,d=o.valueSpec,m=Ut(r);return m==="number"&&r!=r&&(m="NaN"),m!=="number"?[new De(t,r,`number expected, ${m} found`)]:"minimum"in d&&r<d.minimum?[new De(t,r,`${r} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&r>d.maximum?[new De(t,r,`${r} is greater than the maximum value ${d.maximum}`)]:[]}function Qu(o){let t=o.valueSpec,r=xt(o.value.type),d,m,_,y={},b=r!=="categorical"&&o.value.property===void 0,w=!b,S=Ut(o.value.stops)==="array"&&Ut(o.value.stops[0])==="array"&&Ut(o.value.stops[0][0])==="object",I=ri({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(N){if(r==="identity")return[new De(N.key,N.value,'identity function may not have a "stops" property')];let V=[],G=N.value;return V=V.concat($o({key:N.key,value:G,valueSpec:N.valueSpec,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:A})),Ut(G)==="array"&&G.length===0&&V.push(new De(N.key,G,"array must have at least one stop")),V},default:function(N){return N.validateSpec({key:N.key,value:N.value,valueSpec:t,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec})}}});return r==="identity"&&b&&I.push(new De(o.key,o.value,'missing required property "property"')),r==="identity"||o.value.stops||I.push(new De(o.key,o.value,'missing required property "stops"')),r==="exponential"&&o.valueSpec.expression&&!Sl(o.valueSpec)&&I.push(new De(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(w&&!Ws(o.valueSpec)?I.push(new De(o.key,o.value,"property functions not supported")):b&&!Dd(o.valueSpec)&&I.push(new De(o.key,o.value,"zoom functions not supported"))),r!=="categorical"&&!S||o.value.property!==void 0||I.push(new De(o.key,o.value,'"property" property is required')),I;function A(N){let V=[],G=N.value,K=N.key;if(Ut(G)!=="array")return[new De(K,G,`array expected, ${Ut(G)} found`)];if(G.length!==2)return[new De(K,G,`array length 2 expected, length ${G.length} found`)];if(S){if(Ut(G[0])!=="object")return[new De(K,G,`object expected, ${Ut(G[0])} found`)];if(G[0].zoom===void 0)return[new De(K,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new De(K,G,"object stop key must have value")];if(_&&_>xt(G[0].zoom))return[new De(K,G[0].zoom,"stop zoom values must appear in ascending order")];xt(G[0].zoom)!==_&&(_=xt(G[0].zoom),m=void 0,y={}),V=V.concat(ri({key:`${K}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:_s,value:L}}))}else V=V.concat(L({key:`${K}[0]`,value:G[0],validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec},G));return Ba(ti(G[1]))?V.concat([new De(`${K}[1]`,G[1],"expressions are not allowed in function stops.")]):V.concat(N.validateSpec({key:`${K}[1]`,value:G[1],valueSpec:t,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec}))}function L(N,V){let G=Ut(N.value),K=xt(N.value),ne=N.value!==null?N.value:V;if(d){if(G!==d)return[new De(N.key,ne,`${G} stop domain type must match previous stop domain type ${d}`)]}else d=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new De(N.key,ne,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&r!=="categorical"){let me=`number expected, ${G} found`;return Ws(t)&&r===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new De(N.key,ne,me)]}return r!=="categorical"||G!=="number"||isFinite(K)&&Math.floor(K)===K?r!=="categorical"&&G==="number"&&m!==void 0&&K<m?[new De(N.key,ne,"stop domain values must appear in ascending order")]:(m=K,r==="categorical"&&K in y?[new De(N.key,ne,"stop domain values must be unique")]:(y[K]=!0,[])):[new De(N.key,ne,`integer expected, found ${K}`)]}}function Go(o){let t=(o.expressionContext==="property"?Hi:El)(ti(o.value),o.valueSpec);if(t.result==="error")return t.value.map(d=>new De(`${o.key}${d.key}`,o.value,d.message));let r=t.value.expression||t.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!r.outputDefined())return[new De(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!La(r))return[new De(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!La(r))return[new De(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!Cl(r,["zoom","feature-state"]))return[new De(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!wl(r))return[new De(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ju(o){let t=o.key,r=o.value,d=Ut(r);return d!=="string"?[new De(t,r,`color expected, ${d} found`)]:Zt.parse(String(r))?[]:[new De(t,r,`color expected, "${r}" found`)]}function Ac(o){let t=o.key,r=o.value,d=o.valueSpec,m=[];return Array.isArray(d.values)?d.values.indexOf(xt(r))===-1&&m.push(new De(t,r,`expected one of [${d.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(d.values).indexOf(xt(r))===-1&&m.push(new De(t,r,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(r)} found`)),m}function eh(o){return ja(ti(o.value))?Go(ai({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Jp(o)}function Jp(o){let t=o.value,r=o.key;if(Ut(t)!=="array")return[new De(r,t,`array expected, ${Ut(t)} found`)];let d=o.styleSpec,m,_=[];if(t.length<1)return[new De(r,t,"filter array must have at least 1 element")];switch(_=_.concat(Ac({key:`${r}[0]`,value:t[0],valueSpec:d.filter_operator,style:o.style,styleSpec:o.styleSpec})),xt(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&xt(t[1])==="$type"&&_.push(new De(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&_.push(new De(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(m=Ut(t[1]),m!=="string"&&_.push(new De(`${r}[1]`,t[1],`string expected, ${m} found`)));for(let y=2;y<t.length;y++)m=Ut(t[y]),xt(t[1])==="$type"?_=_.concat(Ac({key:`${r}[${y}]`,value:t[y],valueSpec:d.geometry_type,style:o.style,styleSpec:o.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&_.push(new De(`${r}[${y}]`,t[y],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)_=_.concat(Jp({key:`${r}[${y}]`,value:t[y],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":m=Ut(t[1]),t.length!==2?_.push(new De(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):m!=="string"&&_.push(new De(`${r}[1]`,t[1],`string expected, ${m} found`))}return _}function em(o,t){let r=o.key,d=o.validateSpec,m=o.style,_=o.styleSpec,y=o.value,b=o.objectKey,w=_[`${t}_${o.layerType}`];if(!w)return[];let S=b.match(/^(.*)-transition$/);if(t==="paint"&&S&&w[S[1]]&&w[S[1]].transition)return d({key:r,value:y,valueSpec:_.transition,style:m,styleSpec:_});let I=o.valueSpec||w[b];if(!I)return[new De(r,y,`unknown property "${b}"`)];let A;if(Ut(y)==="string"&&Ws(I)&&!I.tokens&&(A=/^{([^}]+)}$/.exec(y)))return[new De(r,y,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];let L=[];return o.layerType==="symbol"&&(b==="text-field"&&m&&!m.glyphs&&L.push(new De(r,y,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&io(ti(y))&&xt(y.type)==="identity"&&L.push(new De(r,y,'"text-font" does not support identity functions'))),L.concat(d({key:o.key,value:y,valueSpec:I,style:m,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:b}))}function tm(o){return em(o,"paint")}function kl(o){return em(o,"layout")}function Al(o){let t=[],r=o.value,d=o.key,m=o.style,_=o.styleSpec;if(Ut(r)!=="object")return[new De(d,r,`object expected, ${Ut(r)} found`)];r.type||r.ref||t.push(new De(d,r,'either "type" or "ref" is required'));let y=xt(r.type),b=xt(r.ref);if(r.id){let w=xt(r.id);for(let S=0;S<o.arrayIndex;S++){let I=m.layers[S];xt(I.id)===w&&t.push(new De(d,r.id,`duplicate layer id "${r.id}", previously used at line ${I.id.__line__}`))}}if("ref"in r){let w;["type","source","source-layer","filter","layout"].forEach(S=>{S in r&&t.push(new De(d,r[S],`"${S}" is prohibited for ref layers`))}),m.layers.forEach(S=>{xt(S.id)===b&&(w=S)}),w?w.ref?t.push(new De(d,r.ref,"ref cannot reference another ref layer")):y=xt(w.type):t.push(new De(d,r.ref,`ref layer "${b}" not found`))}else if(y!=="background")if(r.source){let w=m.sources&&m.sources[r.source],S=w&&xt(w.type);w?S==="vector"&&y==="raster"?t.push(new De(d,r.source,`layer "${r.id}" requires a raster source`)):S!=="raster-dem"&&y==="hillshade"?t.push(new De(d,r.source,`layer "${r.id}" requires a raster-dem source`)):S==="raster"&&y!=="raster"?t.push(new De(d,r.source,`layer "${r.id}" requires a vector source`)):S!=="vector"||r["source-layer"]?S==="raster-dem"&&y!=="hillshade"?t.push(new De(d,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]||S==="geojson"&&w.lineMetrics||t.push(new De(d,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new De(d,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new De(d,r.source,`source "${r.source}" not found`))}else t.push(new De(d,r,'missing required property "source"'));return t=t.concat(ri({key:d,value:r,valueSpec:_.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${d}.type`,value:r.type,valueSpec:_.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:r,objectKey:"type"}),filter:eh,layout:w=>ri({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":S=>kl(ai({layerType:y},S))}}),paint:w=>ri({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":S=>tm(ai({layerType:y},S))}})}})),t}function Tn(o){let t=o.value,r=o.key,d=Ut(t);return d!=="string"?[new De(r,t,`string expected, ${d} found`)]:[]}let Dl={promoteId:function({key:o,value:t}){if(Ut(t)==="string")return Tn({key:o,value:t});{let r=[];for(let d in t)r.push(...Tn({key:`${o}.${d}`,value:t[d]}));return r}}};function th(o){let t=o.value,r=o.key,d=o.styleSpec,m=o.style,_=o.validateSpec;if(!t.type)return[new De(r,t,'"type" is required')];let y=xt(t.type),b;switch(y){case"vector":case"raster":return b=ri({key:r,value:t,valueSpec:d[`source_${y.replace("-","_")}`],style:o.style,styleSpec:d,objectElementValidators:Dl,validateSpec:_}),b;case"raster-dem":return b=function(w){var S;let I=(S=w.sourceName)!==null&&S!==void 0?S:"",A=w.value,L=w.styleSpec,N=L.source_raster_dem,V=w.style,G=[],K=Ut(A);if(A===void 0)return G;if(K!=="object")return G.push(new De("source_raster_dem",A,`object expected, ${K} found`)),G;let ne=xt(A.encoding)==="custom",me=["redFactor","greenFactor","blueFactor","baseShift"],ae=w.value.encoding?`"${w.value.encoding}"`:"Default";for(let B in A)!ne&&me.includes(B)?G.push(new De(B,A[B],`In "${I}": "${B}" is only valid when "encoding" is set to "custom". ${ae} encoding found`)):N[B]?G=G.concat(w.validateSpec({key:B,value:A[B],valueSpec:N[B],validateSpec:w.validateSpec,style:V,styleSpec:L})):G.push(new De(B,A[B],`unknown property "${B}"`));return G}({sourceName:r,value:t,style:o.style,styleSpec:d,validateSpec:_}),b;case"geojson":if(b=ri({key:r,value:t,valueSpec:d.source_geojson,style:m,styleSpec:d,validateSpec:_,objectElementValidators:Dl}),t.cluster)for(let w in t.clusterProperties){let[S,I]=t.clusterProperties[w],A=typeof S=="string"?[S,["accumulated"],["get",w]]:S;b.push(...Go({key:`${r}.${w}.map`,value:I,expressionContext:"cluster-map"})),b.push(...Go({key:`${r}.${w}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return b;case"video":return ri({key:r,value:t,valueSpec:d.source_video,style:m,validateSpec:_,styleSpec:d});case"image":return ri({key:r,value:t,valueSpec:d.source_image,style:m,validateSpec:_,styleSpec:d});case"canvas":return[new De(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ac({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function im(o){let t=o.value,r=o.styleSpec,d=r.light,m=o.style,_=[],y=Ut(t);if(t===void 0)return _;if(y!=="object")return _=_.concat([new De("light",t,`object expected, ${y} found`)]),_;for(let b in t){let w=b.match(/^(.*)-transition$/);_=_.concat(w&&d[w[1]]&&d[w[1]].transition?o.validateSpec({key:b,value:t[b],valueSpec:r.transition,validateSpec:o.validateSpec,style:m,styleSpec:r}):d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],validateSpec:o.validateSpec,style:m,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)])}return _}function nm(o){let t=o.value,r=o.styleSpec,d=r.sky,m=o.style,_=Ut(t);if(t===void 0)return[];if(_!=="object")return[new De("sky",t,`object expected, ${_} found`)];let y=[];for(let b in t)y=y.concat(d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],style:m,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)]);return y}function Rl(o){let t=o.value,r=o.styleSpec,d=r.terrain,m=o.style,_=[],y=Ut(t);if(t===void 0)return _;if(y!=="object")return _=_.concat([new De("terrain",t,`object expected, ${y} found`)]),_;for(let b in t)_=_.concat(d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],validateSpec:o.validateSpec,style:m,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)]);return _}function ih(o){let t=[],r=o.value,d=o.key;if(Array.isArray(r)){let m=[],_=[];for(let y in r)r[y].id&&m.includes(r[y].id)&&t.push(new De(d,r,`all the sprites' ids must be unique, but ${r[y].id} is duplicated`)),m.push(r[y].id),r[y].url&&_.includes(r[y].url)&&t.push(new De(d,r,`all the sprites' URLs must be unique, but ${r[y].url} is duplicated`)),_.push(r[y].url),t=t.concat(ri({key:`${d}[${y}]`,value:r[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return t}return Tn({key:d,value:r})}function Ld(o){return t=o.value,t&&t.constructor===Object?[]:[new De(o.key,o.value,`object expected, ${Ut(o.value)} found`)];var t}let rm={"*":()=>[],array:$o,boolean:function(o){let t=o.value,r=o.key,d=Ut(t);return d!=="boolean"?[new De(r,t,`boolean expected, ${d} found`)]:[]},number:_s,color:Ju,constants:it,enum:Ac,filter:eh,function:Qu,layer:Al,object:ri,source:th,light:im,sky:nm,terrain:Rl,projection:function(o){let t=o.value,r=o.styleSpec,d=r.projection,m=o.style,_=Ut(t);if(t===void 0)return[];if(_!=="object")return[new De("projection",t,`object expected, ${_} found`)];let y=[];for(let b in t)y=y.concat(d[b]?o.validateSpec({key:b,value:t[b],valueSpec:d[b],style:m,styleSpec:r}):[new De(b,t[b],`unknown property "${b}"`)]);return y},projectionDefinition:function(o){let t=o.key,r=o.value;r=r instanceof String?r.valueOf():r;let d=Ut(r);return d!=="array"||function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"}(r)||function(m){return!!["interpolate","step","literal"].includes(m[0])}(r)?["array","string"].includes(d)?[]:[new De(t,r,`projection expected, invalid type "${d}" found`)]:[new De(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Tn,formatted:function(o){return Tn(o).length===0?[]:Go(o)},resolvedImage:function(o){return Tn(o).length===0?[]:Go(o)},padding:function(o){let t=o.key,r=o.value;if(Ut(r)==="array"){if(r.length<1||r.length>4)return[new De(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];let d={type:"number"},m=[];for(let _=0;_<r.length;_++)m=m.concat(o.validateSpec({key:`${t}[${_}]`,value:r[_],validateSpec:o.validateSpec,valueSpec:d}));return m}return _s({key:t,value:r,valueSpec:{}})},numberArray:function(o){let t=o.key,r=o.value;if(Ut(r)==="array"){let d={type:"number"};if(r.length<1)return[new De(t,r,"array length at least 1 expected, length 0 found")];let m=[];for(let _=0;_<r.length;_++)m=m.concat(o.validateSpec({key:`${t}[${_}]`,value:r[_],validateSpec:o.validateSpec,valueSpec:d}));return m}return _s({key:t,value:r,valueSpec:{}})},colorArray:function(o){let t=o.key,r=o.value;if(Ut(r)==="array"){if(r.length<1)return[new De(t,r,"array length at least 1 expected, length 0 found")];let d=[];for(let m=0;m<r.length;m++)d=d.concat(Ju({key:`${t}[${m}]`,value:r[m]}));return d}return Ju({key:t,value:r})},variableAnchorOffsetCollection:function(o){let t=o.key,r=o.value,d=Ut(r),m=o.styleSpec;if(d!=="array"||r.length<1||r.length%2!=0)return[new De(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let y=0;y<r.length;y+=2)_=_.concat(Ac({key:`${t}[${y}]`,value:r[y],valueSpec:m.layout_symbol["text-anchor"]})),_=_.concat($o({key:`${t}[${y+1}]`,value:r[y+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:m}));return _},sprite:ih,state:Ld};function Ol(o){let t=o.value,r=o.valueSpec,d=o.styleSpec;return o.validateSpec=Ol,r.expression&&io(xt(t))?Qu(o):r.expression&&Ba(ti(t))?Go(o):r.type&&rm[r.type]?rm[r.type](o):ri(ai({},o,{valueSpec:r.type?d[r.type]:r}))}function om(o){let t=o.value,r=o.key,d=Tn(o);return d.length||(t.indexOf("{fontstack}")===-1&&d.push(new De(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&d.push(new De(r,t,'"glyphs" url must include a "{range}" token'))),d}function cr(o,t=Q){let r=[];return r=r.concat(Ol({key:"",value:o,valueSpec:t.$root,styleSpec:t,style:o,validateSpec:Ol,objectElementValidators:{glyphs:om,"*":()=>[]}})),o.constants&&(r=r.concat(it({key:"constants",value:o.constants}))),Fl(r)}function bo(o){return function(t){return o(di(Qe({},t),{validateSpec:Ol}))}}function Fl(o){return[].concat(o).sort((t,r)=>t.line-r.line)}function xo(o){return function(...t){return Fl(o.apply(this,t))}}cr.source=xo(bo(th)),cr.sprite=xo(bo(ih)),cr.glyphs=xo(bo(om)),cr.light=xo(bo(im)),cr.sky=xo(bo(nm)),cr.terrain=xo(bo(Rl)),cr.state=xo(bo(Ld)),cr.layer=xo(bo(Al)),cr.filter=xo(bo(eh)),cr.paintProperty=xo(bo(tm)),cr.layoutProperty=xo(bo(kl));let Ll=cr,zd=Ll.light,Bg=Ll.sky,nh=Ll.paintProperty,Bd=Ll.layoutProperty;function rh(o,t){let r=!1;if(t&&t.length)for(let d of t)o.fire(new le(new Error(d.message))),r=!0;return r}class zl{constructor(t,r,d){let m=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;let y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(r=y[1])+2*(d=y[2]);for(let w=0;w<this.d*this.d;w++){let S=y[3+w],I=y[3+w+1];m.push(S===I?null:y.subarray(S,I))}let b=y[3+m.length+1];this.keys=y.subarray(y[3+m.length],b),this.bboxes=y.subarray(b),this.insert=this._insertReadonly}else{this.d=r+2*d;for(let y=0;y<this.d*this.d;y++)m.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=d,this.scale=r/t,this.uid=0;let _=d/r*t;this.min=-_,this.max=t+_}insert(t,r,d,m,_){this._forEachCell(r,d,m,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,d,m,_,y){this.cells[_].push(y)}query(t,r,d,m,_){let y=this.min,b=this.max;if(t<=y&&r<=y&&b<=d&&b<=m&&!_)return Array.prototype.slice.call(this.keys);{let w=[];return this._forEachCell(t,r,d,m,this._queryCell,w,{},_),w}}_queryCell(t,r,d,m,_,y,b,w){let S=this.cells[_];if(S!==null){let I=this.keys,A=this.bboxes;for(let L=0;L<S.length;L++){let N=S[L];if(b[N]===void 0){let V=4*N;(w?w(A[V+0],A[V+1],A[V+2],A[V+3]):t<=A[V+2]&&r<=A[V+3]&&d>=A[V+0]&&m>=A[V+1])?(b[N]=!0,y.push(I[N])):b[N]=!1}}}}_forEachCell(t,r,d,m,_,y,b,w){let S=this._convertToCellCoord(t),I=this._convertToCellCoord(r),A=this._convertToCellCoord(d),L=this._convertToCellCoord(m);for(let N=S;N<=A;N++)for(let V=I;V<=L;V++){let G=this.d*V+N;if((!w||w(this._convertFromCellCoord(N),this._convertFromCellCoord(V),this._convertFromCellCoord(N+1),this._convertFromCellCoord(V+1)))&&_.call(this,t,r,d,m,G,y,b,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let t=this.cells,r=3+this.cells.length+1+1,d=0;for(let y=0;y<this.cells.length;y++)d+=this.cells[y].length;let m=new Int32Array(r+d+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let _=r;for(let y=0;y<t.length;y++){let b=t[y];m[3+y]=_,m.set(b,_),_+=b.length}return m[3+t.length]=_,m.set(this.keys,_),_+=this.keys.length,m[3+t.length+1]=_,m.set(this.bboxes,_),_+=this.bboxes.length,m.buffer}static serialize(t,r){let d=t.toArrayBuffer();return r&&r.push(d),{buffer:d}}static deserialize(t){return new zl(t.buffer)}}let Ho={};function nt(o,t,r={}){if(Ho[o])throw new Error(`${o} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:o,writeable:!1}),Ho[o]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}nt("Object",Object),nt("TransferableGridIndex",zl),nt("Color",Zt),nt("Error",Error),nt("AJAXError",Ii),nt("ResolvedImage",yr),nt("StylePropertyFunction",Na),nt("StyleExpression",Pl,{omit:["_evaluator"]}),nt("ZoomDependentExpression",gs),nt("ZoomConstantExpression",kr),nt("CompoundExpression",Ur,{omit:["_evaluate"]});for(let o in Hs)Hs[o]._classRegistryKey||nt(`Expression_${o}`,Hs[o]);function Nd(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function Vd(o){return o.$name||o.constructor._classRegistryKey}function sm(o){return!function(t){if(t===null||typeof t!="object")return!1;let r=Vd(t);return!(!r||r==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||Nd(o)||on(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function Bl(o,t){if(sm(o))return(Nd(o)||on(o))&&t&&t.push(o),ArrayBuffer.isView(o)&&t&&t.push(o.buffer),o instanceof ImageData&&t&&t.push(o.data.buffer),o;if(Array.isArray(o)){let _=[];for(let y of o)_.push(Bl(y,t));return _}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);let r=Vd(o);if(!r)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!Ho[r])throw new Error(`${r} is not registered.`);let{klass:d}=Ho[r],m=d.serialize?d.serialize(o,t):{};if(d.serialize){if(t&&m===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let _ in o){if(!o.hasOwnProperty(_)||Ho[r].omit.indexOf(_)>=0)continue;let y=o[_];m[_]=Ho[r].shallow.indexOf(_)>=0?y:Bl(y,t)}o instanceof Error&&(m.message=o.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(m.$name=r),m}function Dc(o){if(sm(o))return o;if(Array.isArray(o))return o.map(Dc);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);let t=Vd(o)||"Object";if(!Ho[t])throw new Error(`can't deserialize unregistered class ${t}`);let{klass:r}=Ho[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(o);let d=Object.create(r.prototype);for(let m of Object.keys(o)){if(m==="$name")continue;let _=o[m];d[m]=Ho[t].shallow.indexOf(m)>=0?_:Dc(_)}return d}class oh{constructor(){this.first=!0}update(t,r){let d=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=d,!0))}}let Yt={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function jd(o){for(let t of o)if(Ud(t.charCodeAt(0)))return!0;return!1}function Ng(o){for(let t of o)if(!lm(t.charCodeAt(0)))return!1;return!0}function sh(o){let t=o.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(t.join("|"),"u")}let am=sh(["Arab","Dupl","Mong","Ougr","Syrc"]);function lm(o){return!am.test(String.fromCodePoint(o))}let ah=sh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ud(o){return!(o!==746&&o!==747&&(o<4352||!(Yt["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||Yt["CJK Compatibility"](o)||Yt["CJK Strokes"](o)||!(!Yt["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||Yt["Enclosed CJK Letters and Months"](o)||Yt["Ideographic Description Characters"](o)||Yt.Kanbun(o)||Yt.Katakana(o)&&o!==12540||!(!Yt["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!Yt["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||Yt["Vertical Forms"](o)||Yt["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||ah.test(String.fromCodePoint(o)))))}function Rc(o){return!(Ud(o)||function(t){return!!(Yt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Yt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Yt["Letterlike Symbols"](t)||Yt["Number Forms"](t)||Yt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Yt["Control Pictures"](t)&&t!==9251||Yt["Optical Character Recognition"](t)||Yt["Enclosed Alphanumerics"](t)||Yt["Geometric Shapes"](t)||Yt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Yt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Yt["CJK Symbols and Punctuation"](t)||Yt.Katakana(t)||Yt["Private Use Area"](t)||Yt["CJK Compatibility Forms"](t)||Yt["Small Form Variants"](t)||Yt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(o))}let Vg=sh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function $d(o){return Vg.test(String.fromCodePoint(o))}function jg(o,t){return!(!t&&$d(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||Yt.Khmer(o))}function Ug(o){for(let t of o)if($d(t.charCodeAt(0)))return!0;return!1}let ys=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(ys.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,t){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;let r=o.pluginURL,d=new Promise(_=>{this.loadScriptResolve=_});t(r);let m=new Promise(_=>setTimeout(()=>_(),this.TIMEOUT));if(yield Promise.race([d,m]),this.isParsed()){let _={pluginStatus:"loaded",pluginURL:r};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class Li{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new oh,this.transition={})}isSupportedScript(t){return function(r,d){for(let m of r)if(!jg(m.charCodeAt(0),d))return!1;return!0}(t,ys.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let t=this.zoom,r=t-Math.floor(t),d=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*r}}}class Oc{constructor(t,r){this.property=t,this.value=r,this.expression=function(d,m){if(io(d))return new Na(d,m);if(Ba(d)){let _=Hi(d,m);if(_.result==="error")throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));return _.value}{let _=d;return m.type==="color"&&typeof d=="string"?_=Zt.parse(d):m.type!=="padding"||typeof d!="number"&&!Array.isArray(d)?m.type!=="numberArray"||typeof d!="number"&&!Array.isArray(d)?m.type!=="colorArray"||typeof d!="string"&&!Array.isArray(d)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(d)?_=Xn.parse(d):m.type==="projectionDefinition"&&typeof d=="string"&&(_=ar.parse(d)):_=pn.parse(d):_=$i.parse(d):_=En.parse(d),{kind:"constant",evaluate:()=>_}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,d){return this.property.possiblyEvaluate(this,t,r,d)}}class lh{constructor(t){this.property=t,this.value=new Oc(t,void 0)}transitioned(t,r){return new dm(this.property,this.value,r,Mn({},t.transition,this.transition),t.now)}untransitioned(){return new dm(this.property,this.value,null,{},0)}}class cm{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return fr(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new lh(this._values[t].property)),this._values[t].value=new Oc(this._values[t].property,r===null?void 0:fr(r))}getTransition(t){return fr(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new lh(this._values[t].property)),this._values[t].transition=fr(r)||void 0}serialize(){let t={};for(let r of Object.keys(this._values)){let d=this.getValue(r);d!==void 0&&(t[r]=d);let m=this.getTransition(r);m!==void 0&&(t[`${r}-transition`]=m)}return t}transitioned(t,r){let d=new um(this._properties);for(let m of Object.keys(this._values))d._values[m]=this._values[m].transitioned(t,r._values[m]);return d}untransitioned(){let t=new um(this._properties);for(let r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class dm{constructor(t,r,d,m,_){this.property=t,this.value=r,this.begin=_+m.delay||0,this.end=this.begin+m.duration||0,t.specification.transition&&(m.delay||m.duration)&&(this.prior=d)}possiblyEvaluate(t,r,d){let m=t.now||0,_=this.value.possiblyEvaluate(t,r,d),y=this.prior;if(y){if(m>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(m<this.begin)return y.possiblyEvaluate(t,r,d);{let b=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,r,d),_,nn(b))}}return _}}class um{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,d){let m=new Gd(this._properties);for(let _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(t,r,d);return m}hasTransition(){for(let t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class $g{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return fr(this._values[t].value)}setValue(t,r){this._values[t]=new Oc(this._values[t].property,r===null?void 0:fr(r))}serialize(){let t={};for(let r of Object.keys(this._values)){let d=this.getValue(r);d!==void 0&&(t[r]=d)}return t}possiblyEvaluate(t,r,d){let m=new Gd(this._properties);for(let _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(t,r,d);return m}}class vr{constructor(t,r,d){this.property=t,this.value=r,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,d,m){return this.property.evaluate(this.value,this.parameters,t,r,d,m)}}class Gd{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class pt{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,d){let m=eo[this.specification.type];return m?m(t,r,d):t}}class Ct{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,d,m){return new vr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},d,m)}:t.expression,r)}interpolate(t,r,d){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new vr(this,{kind:"constant",value:void 0},t.parameters);let m=eo[this.specification.type];if(m){let _=m(t.value.value,r.value.value,d);return new vr(this,{kind:"constant",value:_},t.parameters)}return t}evaluate(t,r,d,m,_,y){return t.kind==="constant"?t.value:t.evaluate(r,d,m,_,y)}}class Fc extends Ct{possiblyEvaluate(t,r,d,m){if(t.value===void 0)return new vr(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){let _=t.expression.evaluate(r,null,{},d,m),y=t.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,b=this._calculate(y,y,y,r);return new vr(this,{kind:"constant",value:b},r)}if(t.expression.kind==="camera"){let _=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new vr(this,{kind:"constant",value:_},r)}return new vr(this,t.expression,r)}evaluate(t,r,d,m,_,y){if(t.kind==="source"){let b=t.evaluate(r,d,m,_,y);return this._calculate(b,b,b,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},d,m),t.evaluate({zoom:Math.floor(r.zoom)},d,m),t.evaluate({zoom:Math.floor(r.zoom)+1},d,m),r):t.value}_calculate(t,r,d,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:d,to:r}}interpolate(t){return t}}class ch{constructor(t){this.specification=t}possiblyEvaluate(t,r,d,m){if(t.value!==void 0){if(t.expression.kind==="constant"){let _=t.expression.evaluate(r,null,{},d,m);return this._calculate(_,_,_,r)}return this._calculate(t.expression.evaluate(new Li(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Li(Math.floor(r.zoom),r)),t.expression.evaluate(new Li(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,d,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:d,to:r}}interpolate(t){return t}}class dh{constructor(t){this.specification=t}possiblyEvaluate(t,r,d,m){return!!t.expression.evaluate(r,null,{},d,m)}interpolate(){return!1}}class gn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in t){let d=t[r];d.specification.overridable&&this.overridableProperties.push(r);let m=this.defaultPropertyValues[r]=new Oc(d,void 0),_=this.defaultTransitionablePropertyValues[r]=new lh(d);this.defaultTransitioningPropertyValues[r]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=m.possiblyEvaluate({})}}}nt("DataDrivenProperty",Ct),nt("DataConstantProperty",pt),nt("CrossFadedDataDrivenProperty",Fc),nt("CrossFadedProperty",ch),nt("ColorRampProperty",dh);let uh="-transition";class no extends fe{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new $g(r.layout)),r.paint)){this._transitionablePaint=new cm(r.paint);for(let d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(let d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Gd(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,d={}){r!=null&&this._validate(Bd,`layers.${this.id}.layout.${t}`,t,r,d)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(uh)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,d={}){if(r!=null&&this._validate(nh,`layers.${this.id}.paint.${t}`,t,r,d))return!1;if(t.endsWith(uh))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{let m=this._transitionablePaint._values[t],_=m.property.specification["property-type"]==="cross-faded-data-driven",y=m.value.isDataDriven(),b=m.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);let w=this._transitionablePaint._values[t].value;return w.isDataDriven()||y||_||this._handleOverridablePaintPropertyUpdate(t,b,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,d){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){let t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),ns(t,(r,d)=>!(r===void 0||d==="layout"&&!Object.keys(r).length||d==="paint"&&!Object.keys(r).length))}_validate(t,r,d,m,_={}){return(!_||_.validate!==!1)&&rh(this,t.call(Ll,{key:r,layerType:this.type,objectKey:d,value:m,styleSpec:Q,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let t in this.paint._values){let r=this.paint.get(t);if(r instanceof vr&&Ws(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}let hm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class $a{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ji{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){let r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Wi(o,t=1){let r=0,d=0;return{members:o.map(m=>{let _=hm[m.type].BYTES_PER_ELEMENT,y=r=Nl(r,Math.max(t,_)),b=m.components||1;return d=Math.max(d,_),r+=_*b,{name:m.name,type:m.type,components:b,offset:y}}),size:Nl(r,Math.max(d,t)),alignment:t}}function Nl(o,t){return Math.ceil(o/t)*t}class Lc extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){let d=this.length;return this.resize(d+1),this.emplace(d,t,r)}emplace(t,r,d){let m=2*t;return this.int16[m+0]=r,this.int16[m+1]=d,t}}Lc.prototype.bytesPerElement=4,nt("StructArrayLayout2i4",Lc);class zc extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d){let m=this.length;return this.resize(m+1),this.emplace(m,t,r,d)}emplace(t,r,d,m){let _=3*t;return this.int16[_+0]=r,this.int16[_+1]=d,this.int16[_+2]=m,t}}zc.prototype.bytesPerElement=6,nt("StructArrayLayout3i6",zc);class Ga extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,m){let _=this.length;return this.resize(_+1),this.emplace(_,t,r,d,m)}emplace(t,r,d,m,_){let y=4*t;return this.int16[y+0]=r,this.int16[y+1]=d,this.int16[y+2]=m,this.int16[y+3]=_,t}}Ga.prototype.bytesPerElement=8,nt("StructArrayLayout4i8",Ga);class hh extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,m,_,y)}emplace(t,r,d,m,_,y,b){let w=6*t;return this.int16[w+0]=r,this.int16[w+1]=d,this.int16[w+2]=m,this.int16[w+3]=_,this.int16[w+4]=y,this.int16[w+5]=b,t}}hh.prototype.bytesPerElement=12,nt("StructArrayLayout2i4i12",hh);class ph extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,m,_,y)}emplace(t,r,d,m,_,y,b){let w=4*t,S=8*t;return this.int16[w+0]=r,this.int16[w+1]=d,this.uint8[S+4]=m,this.uint8[S+5]=_,this.uint8[S+6]=y,this.uint8[S+7]=b,t}}ph.prototype.bytesPerElement=8,nt("StructArrayLayout2i4ub8",ph);class Vl extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){let d=this.length;return this.resize(d+1),this.emplace(d,t,r)}emplace(t,r,d){let m=2*t;return this.float32[m+0]=r,this.float32[m+1]=d,t}}Vl.prototype.bytesPerElement=8,nt("StructArrayLayout2f8",Vl);class mh extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y,b,w,S,I){let A=this.length;return this.resize(A+1),this.emplace(A,t,r,d,m,_,y,b,w,S,I)}emplace(t,r,d,m,_,y,b,w,S,I,A){let L=10*t;return this.uint16[L+0]=r,this.uint16[L+1]=d,this.uint16[L+2]=m,this.uint16[L+3]=_,this.uint16[L+4]=y,this.uint16[L+5]=b,this.uint16[L+6]=w,this.uint16[L+7]=S,this.uint16[L+8]=I,this.uint16[L+9]=A,t}}mh.prototype.bytesPerElement=20,nt("StructArrayLayout10ui20",mh);class f extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y,b,w,S,I,A,L){let N=this.length;return this.resize(N+1),this.emplace(N,t,r,d,m,_,y,b,w,S,I,A,L)}emplace(t,r,d,m,_,y,b,w,S,I,A,L,N){let V=12*t;return this.int16[V+0]=r,this.int16[V+1]=d,this.int16[V+2]=m,this.int16[V+3]=_,this.uint16[V+4]=y,this.uint16[V+5]=b,this.uint16[V+6]=w,this.uint16[V+7]=S,this.int16[V+8]=I,this.int16[V+9]=A,this.int16[V+10]=L,this.int16[V+11]=N,t}}f.prototype.bytesPerElement=24,nt("StructArrayLayout4i4ui4i24",f);class e extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d){let m=this.length;return this.resize(m+1),this.emplace(m,t,r,d)}emplace(t,r,d,m){let _=3*t;return this.float32[_+0]=r,this.float32[_+1]=d,this.float32[_+2]=m,t}}e.prototype.bytesPerElement=12,nt("StructArrayLayout3f12",e);class n extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}n.prototype.bytesPerElement=4,nt("StructArrayLayout1ul4",n);class u extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y,b,w,S){let I=this.length;return this.resize(I+1),this.emplace(I,t,r,d,m,_,y,b,w,S)}emplace(t,r,d,m,_,y,b,w,S,I){let A=10*t,L=5*t;return this.int16[A+0]=r,this.int16[A+1]=d,this.int16[A+2]=m,this.int16[A+3]=_,this.int16[A+4]=y,this.int16[A+5]=b,this.uint32[L+3]=w,this.uint16[A+8]=S,this.uint16[A+9]=I,t}}u.prototype.bytesPerElement=20,nt("StructArrayLayout6i1ul2ui20",u);class p extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,m,_,y)}emplace(t,r,d,m,_,y,b){let w=6*t;return this.int16[w+0]=r,this.int16[w+1]=d,this.int16[w+2]=m,this.int16[w+3]=_,this.int16[w+4]=y,this.int16[w+5]=b,t}}p.prototype.bytesPerElement=12,nt("StructArrayLayout2i2i2i12",p);class g extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_){let y=this.length;return this.resize(y+1),this.emplace(y,t,r,d,m,_)}emplace(t,r,d,m,_,y){let b=4*t,w=8*t;return this.float32[b+0]=r,this.float32[b+1]=d,this.float32[b+2]=m,this.int16[w+6]=_,this.int16[w+7]=y,t}}g.prototype.bytesPerElement=16,nt("StructArrayLayout2f1f2i16",g);class v extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,d,m,_,y)}emplace(t,r,d,m,_,y,b){let w=16*t,S=4*t,I=8*t;return this.uint8[w+0]=r,this.uint8[w+1]=d,this.float32[S+1]=m,this.float32[S+2]=_,this.int16[I+6]=y,this.int16[I+7]=b,t}}v.prototype.bytesPerElement=16,nt("StructArrayLayout2ub2f2i16",v);class x extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d){let m=this.length;return this.resize(m+1),this.emplace(m,t,r,d)}emplace(t,r,d,m){let _=3*t;return this.uint16[_+0]=r,this.uint16[_+1]=d,this.uint16[_+2]=m,t}}x.prototype.bytesPerElement=6,nt("StructArrayLayout3ui6",x);class C extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y,b,w,S,I,A,L,N,V,G,K,ne){let me=this.length;return this.resize(me+1),this.emplace(me,t,r,d,m,_,y,b,w,S,I,A,L,N,V,G,K,ne)}emplace(t,r,d,m,_,y,b,w,S,I,A,L,N,V,G,K,ne,me){let ae=24*t,B=12*t,W=48*t;return this.int16[ae+0]=r,this.int16[ae+1]=d,this.uint16[ae+2]=m,this.uint16[ae+3]=_,this.uint32[B+2]=y,this.uint32[B+3]=b,this.uint32[B+4]=w,this.uint16[ae+10]=S,this.uint16[ae+11]=I,this.uint16[ae+12]=A,this.float32[B+7]=L,this.float32[B+8]=N,this.uint8[W+36]=V,this.uint8[W+37]=G,this.uint8[W+38]=K,this.uint32[B+10]=ne,this.int16[ae+22]=me,t}}C.prototype.bytesPerElement=48,nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",C);class T extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d,m,_,y,b,w,S,I,A,L,N,V,G,K,ne,me,ae,B,W,ce,Pe,Ue,Ie,Le,Ze,Ge){let We=this.length;return this.resize(We+1),this.emplace(We,t,r,d,m,_,y,b,w,S,I,A,L,N,V,G,K,ne,me,ae,B,W,ce,Pe,Ue,Ie,Le,Ze,Ge)}emplace(t,r,d,m,_,y,b,w,S,I,A,L,N,V,G,K,ne,me,ae,B,W,ce,Pe,Ue,Ie,Le,Ze,Ge,We){let Ne=32*t,ot=16*t;return this.int16[Ne+0]=r,this.int16[Ne+1]=d,this.int16[Ne+2]=m,this.int16[Ne+3]=_,this.int16[Ne+4]=y,this.int16[Ne+5]=b,this.int16[Ne+6]=w,this.int16[Ne+7]=S,this.uint16[Ne+8]=I,this.uint16[Ne+9]=A,this.uint16[Ne+10]=L,this.uint16[Ne+11]=N,this.uint16[Ne+12]=V,this.uint16[Ne+13]=G,this.uint16[Ne+14]=K,this.uint16[Ne+15]=ne,this.uint16[Ne+16]=me,this.uint16[Ne+17]=ae,this.uint16[Ne+18]=B,this.uint16[Ne+19]=W,this.uint16[Ne+20]=ce,this.uint16[Ne+21]=Pe,this.uint16[Ne+22]=Ue,this.uint32[ot+12]=Ie,this.float32[ot+13]=Le,this.float32[ot+14]=Ze,this.uint16[Ne+30]=Ge,this.uint16[Ne+31]=We,t}}T.prototype.bytesPerElement=64,nt("StructArrayLayout8i15ui1ul2f2ui64",T);class k extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}k.prototype.bytesPerElement=4,nt("StructArrayLayout1f4",k);class R extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d){let m=this.length;return this.resize(m+1),this.emplace(m,t,r,d)}emplace(t,r,d,m){let _=3*t;return this.uint16[6*t+0]=r,this.float32[_+1]=d,this.float32[_+2]=m,t}}R.prototype.bytesPerElement=12,nt("StructArrayLayout1ui2f12",R);class D extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,d){let m=this.length;return this.resize(m+1),this.emplace(m,t,r,d)}emplace(t,r,d,m){let _=4*t;return this.uint32[2*t+0]=r,this.uint16[_+2]=d,this.uint16[_+3]=m,t}}D.prototype.bytesPerElement=8,nt("StructArrayLayout1ul2ui8",D);class j extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){let d=this.length;return this.resize(d+1),this.emplace(d,t,r)}emplace(t,r,d){let m=2*t;return this.uint16[m+0]=r,this.uint16[m+1]=d,t}}j.prototype.bytesPerElement=4,nt("StructArrayLayout2ui4",j);class U extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}U.prototype.bytesPerElement=2,nt("StructArrayLayout1ui2",U);class te extends Ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,d,m){let _=this.length;return this.resize(_+1),this.emplace(_,t,r,d,m)}emplace(t,r,d,m,_){let y=4*t;return this.float32[y+0]=r,this.float32[y+1]=d,this.float32[y+2]=m,this.float32[y+3]=_,t}}te.prototype.bytesPerElement=16,nt("StructArrayLayout4f16",te);class ee extends $a{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new $e(this.anchorPointX,this.anchorPointY)}}ee.prototype.size=20;class ie extends u{get(t){return new ee(this,t)}}nt("CollisionBoxArray",ie);class se extends $a{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}se.prototype.size=48;class ue extends C{get(t){return new se(this,t)}}nt("PlacedSymbolArray",ue);class de extends $a{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}de.prototype.size=64;class he extends T{get(t){return new de(this,t)}}nt("SymbolInstanceArray",he);class _e extends k{getoffsetX(t){return this.float32[1*t+0]}}nt("GlyphOffsetArray",_e);class pe extends zc{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}nt("SymbolLineVertexArray",pe);class Se extends $a{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Se.prototype.size=12;class Be extends R{get(t){return new Se(this,t)}}nt("TextAnchorOffsetArray",Be);class ke extends $a{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ke.prototype.size=8;class Ae extends D{get(t){return new ke(this,t)}}nt("FeatureIndexArray",Ae);class Re extends Lc{}class Je extends Lc{}class Ke extends Lc{}class He extends hh{}class ct extends ph{}class Nt extends Vl{}class ii extends mh{}class qi extends f{}class Ei extends e{}class Xi extends n{}class Yi extends p{}class Ai extends v{}class fi extends x{}class In extends j{}let Nn=Wi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yn}=Nn;class gi{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,d,m){let _=this.segments[this.segments.length-1];return t>gi.MAX_VERTEX_ARRAY_LENGTH&&Sn(`Max vertices per segment is ${gi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${gi.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+t>gi.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==m?this.createNewSegment(r,d,m):_}createNewSegment(t,r,d){let m={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return d!==void 0&&(m.sortKey=d),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(t,r,d){return this.prepareSegment(0,t,r,d)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let t of this.segments)for(let r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,d,m){return new gi([{vertexOffset:t,primitiveOffset:r,vertexLength:d,primitiveLength:m,vaos:{},sortKey:0}])}}function Xs(o,t){return 256*(o=Cn(Math.floor(o),0,255))+Cn(Math.floor(t),0,255)}gi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nt("SegmentVector",gi);let Zo=Wi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ys,Ha,Bc,Ks={exports:{}},Za={exports:{}},$r={exports:{}},Qs=function(){if(Bc)return Ks.exports;Bc=1;var o=(Ys||(Ys=1,Za.exports=function(r,d){var m,_,y,b,w,S,I,A;for(_=r.length-(m=3&r.length),y=d,w=3432918353,S=461845907,A=0;A<_;)I=255&r.charCodeAt(A)|(255&r.charCodeAt(++A))<<8|(255&r.charCodeAt(++A))<<16|(255&r.charCodeAt(++A))<<24,++A,y=27492+(65535&(b=5*(65535&(y=(y^=I=(65535&(I=(I=(65535&I)*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(I=0,m){case 3:I^=(255&r.charCodeAt(A+2))<<16;case 2:I^=(255&r.charCodeAt(A+1))<<8;case 1:y^=I=(65535&(I=(I=(65535&(I^=255&r.charCodeAt(A)))*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295}return y^=r.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),Za.exports),t=(Ha||(Ha=1,$r.exports=function(r,d){for(var m,_=r.length,y=d^_,b=0;_>=4;)m=1540483477*(65535&(m=255&r.charCodeAt(b)|(255&r.charCodeAt(++b))<<8|(255&r.charCodeAt(++b))<<16|(255&r.charCodeAt(++b))<<24))+((1540483477*(m>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),_-=4,++b;switch(_){case 3:y^=(255&r.charCodeAt(b+2))<<16;case 2:y^=(255&r.charCodeAt(b+1))<<8;case 1:y=1540483477*(65535&(y^=255&r.charCodeAt(b)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),$r.exports);return Ks.exports=o,Ks.exports.murmur3=o,Ks.exports.murmur2=t,Ks.exports}(),vs=P(Qs);class Js{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,d,m){this.ids.push(_n(t)),this.positions.push(r,d,m)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=_n(t),d=0,m=this.ids.length-1;for(;d<m;){let y=d+m>>1;this.ids[y]>=r?m=y:d=y+1}let _=[];for(;this.ids[d]===r;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(t,r){let d=new Float64Array(t.ids),m=new Uint32Array(t.positions);return yn(d,m,0,d.length-1),r&&r.push(d.buffer,m.buffer),{ids:d,positions:m}}static deserialize(t){let r=new Js;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function _n(o){let t=+o;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:vs(String(o))}function yn(o,t,r,d){for(;r<d;){let m=o[r+d>>1],_=r-1,y=d+1;for(;;){do _++;while(o[_]<m);do y--;while(o[y]>m);if(_>=y)break;br(o,_,y),br(t,3*_,3*y),br(t,3*_+1,3*y+1),br(t,3*_+2,3*y+2)}y-r<d-y?(yn(o,t,r,y),r=y+1):(yn(o,t,y+1,d),d=y)}}function br(o,t,r){let d=o[t];o[t]=o[r],o[r]=d}nt("FeaturePositionMap",Js);class zi{constructor(t,r){this.gl=t.gl,this.location=r}}class Hd extends zi{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class pm extends zi{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class mm extends zi{constructor(t,r){super(t,r),this.current=Zt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}let Gg=new Float32Array(16);function fh(o){return[Xs(255*o.r,255*o.g),Xs(255*o.b,255*o.a)]}class Nc{constructor(t,r,d){this.value=t,this.uniformNames=r.map(m=>`u_${m}`),this.type=d}setUniform(t,r,d){t.set(d.constantOr(this.value))}getBinding(t,r,d){return this.type==="color"?new mm(t,r):new Hd(t,r)}}class ro{constructor(t,r){this.uniformNames=r.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,d,m){let _=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&t.set(_)}getBinding(t,r,d){return d.substr(0,9)==="u_pattern"?new pm(t,r):new Hd(t,r)}}class Wo{constructor(t,r,d,m){this.expression=t,this.type=d,this.maxValue=0,this.paintVertexAttributes=r.map(_=>({name:`a_${_}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,r,d,m,_){let y=this.paintVertexArray.length,b=this.expression.evaluate(new Li(0),r,{},m,[],_);this.paintVertexArray.resize(t),this._setPaintValue(y,t,b)}updatePaintArray(t,r,d,m){let _=this.expression.evaluate({zoom:0},d,m);this._setPaintValue(t,r,_)}_setPaintValue(t,r,d){if(this.type==="color"){let m=fh(d);for(let _=t;_<r;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class oo{constructor(t,r,d,m,_,y){this.expression=t,this.uniformNames=r.map(b=>`u_${b}_t`),this.type=d,this.useIntegerZoom=m,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,r,d,m,_){let y=this.expression.evaluate(new Li(this.zoom),r,{},m,[],_),b=this.expression.evaluate(new Li(this.zoom+1),r,{},m,[],_),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,y,b)}updatePaintArray(t,r,d,m){let _=this.expression.evaluate({zoom:this.zoom},d,m),y=this.expression.evaluate({zoom:this.zoom+1},d,m);this._setPaintValue(t,r,_,y)}_setPaintValue(t,r,d,m){if(this.type==="color"){let _=fh(d),y=fh(m);for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,_[0],_[1],y[0],y[1])}else{for(let _=t;_<r;_++)this.paintVertexArray.emplace(_,d,m);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(m))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){let d=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,m=Cn(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);t.set(m)}getBinding(t,r,d){return new Hd(t,r)}}class bs{constructor(t,r,d,m,_,y){this.expression=t,this.type=r,this.useIntegerZoom=d,this.zoom=m,this.layerId=y,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(t,r,d){let m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(m,t,r.patterns&&r.patterns[this.layerId],d)}updatePaintArray(t,r,d,m,_){this._setPaintValues(t,r,d.patterns&&d.patterns[this.layerId],_)}_setPaintValues(t,r,d,m){if(!m||!d)return;let{min:_,mid:y,max:b}=d,w=m[_],S=m[y],I=m[b];if(w&&S&&I)for(let A=t;A<r;A++)this.zoomInPaintVertexArray.emplace(A,S.tl[0],S.tl[1],S.br[0],S.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],S.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,S.tl[0],S.tl[1],S.br[0],S.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],S.pixelRatio,I.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Zo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Zo.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zd{constructor(t,r,d){this.binders={},this._buffers=[];let m=[];for(let _ in t.paint._values){if(!d(_))continue;let y=t.paint.get(_);if(!(y instanceof vr&&Ws(y.property.specification)))continue;let b=gh(_,t.type),w=y.value,S=y.property.specification.type,I=y.property.useIntegerZoom,A=y.property.specification["property-type"],L=A==="cross-faded"||A==="cross-faded-data-driven";if(w.kind==="constant")this.binders[_]=L?new ro(w.value,b):new Nc(w.value,b,S),m.push(`/u_${_}`);else if(w.kind==="source"||L){let N=tv(_,S,"source");this.binders[_]=L?new bs(w,S,I,r,N,t.id):new Wo(w,b,S,N),m.push(`/a_${_}`)}else{let N=tv(_,S,"composite");this.binders[_]=new oo(w,b,S,I,r,N),m.push(`/z_${_}`)}}this.cacheKey=m.sort().join("")}getMaxValue(t){let r=this.binders[t];return r instanceof Wo||r instanceof oo?r.maxValue:0}populatePaintArrays(t,r,d,m,_){for(let y in this.binders){let b=this.binders[y];(b instanceof Wo||b instanceof oo||b instanceof bs)&&b.populatePaintArray(t,r,d,m,_)}}setConstantPatternPositions(t,r){for(let d in this.binders){let m=this.binders[d];m instanceof ro&&m.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,d,m,_){let y=!1;for(let b in t){let w=r.getPositions(b);for(let S of w){let I=d.feature(S.index);for(let A in this.binders){let L=this.binders[A];if((L instanceof Wo||L instanceof oo||L instanceof bs)&&L.expression.isStateDependent===!0){let N=m.paint.get(A);L.expression=N.value,L.updatePaintArray(S.start,S.end,I,t[b],_),y=!0}}}}return y}defines(){let t=[];for(let r in this.binders){let d=this.binders[r];(d instanceof Nc||d instanceof ro)&&t.push(...d.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return t}getBinderAttributes(){let t=[];for(let r in this.binders){let d=this.binders[r];if(d instanceof Wo||d instanceof oo)for(let m=0;m<d.paintVertexAttributes.length;m++)t.push(d.paintVertexAttributes[m].name);else if(d instanceof bs)for(let m=0;m<Zo.members.length;m++)t.push(Zo.members[m].name)}return t}getBinderUniforms(){let t=[];for(let r in this.binders){let d=this.binders[r];if(d instanceof Nc||d instanceof ro||d instanceof oo)for(let m of d.uniformNames)t.push(m)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){let d=[];for(let m in this.binders){let _=this.binders[m];if(_ instanceof Nc||_ instanceof ro||_ instanceof oo){for(let y of _.uniformNames)if(r[y]){let b=_.getBinding(t,r[y],y);d.push({name:y,property:m,binding:b})}}}return d}setUniforms(t,r,d,m){for(let{name:_,property:y,binding:b}of r)this.binders[y].setUniform(b,m,d.get(y),_)}updatePaintBuffers(t){this._buffers=[];for(let r in this.binders){let d=this.binders[r];if(t&&d instanceof bs){let m=t.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(d instanceof Wo||d instanceof oo)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(t){for(let r in this.binders){let d=this.binders[r];(d instanceof Wo||d instanceof oo||d instanceof bs)&&d.upload(t)}this.updatePaintBuffers()}destroy(){for(let t in this.binders){let r=this.binders[t];(r instanceof Wo||r instanceof oo||r instanceof bs)&&r.destroy()}}}class ea{constructor(t,r,d=()=>!0){this.programConfigurations={};for(let m of t)this.programConfigurations[m.id]=new Zd(m,r,d);this.needsUpload=!1,this._featureMap=new Js,this._bufferOffset=0}populatePaintArrays(t,r,d,m,_,y){for(let b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,m,_,y);r.id!==void 0&&this._featureMap.add(r.id,d,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,d,m){for(let _ of d)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(t,this._featureMap,r,_,m)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(let t in this.programConfigurations)this.programConfigurations[t].destroy()}}function gh(o,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${t}-`,"").replace(/-/g,"_")]}function tv(o,t,r){let d={color:{source:Vl,composite:te},number:{source:k,composite:Vl}},m=function(_){return{"line-pattern":{source:ii,composite:ii},"fill-pattern":{source:ii,composite:ii},"fill-extrusion-pattern":{source:ii,composite:ii}}[_]}(o);return m&&m[r]||d[t][r]}nt("ConstantBinder",Nc),nt("CrossFadedConstantBinder",ro),nt("SourceExpressionBinder",Wo),nt("CrossFadedCompositeBinder",bs),nt("CompositeExpressionBinder",oo),nt("ProgramConfiguration",Zd,{omit:["_buffers"]}),nt("ProgramConfigurationSet",ea);let Hg=Math.pow(2,14)-1,iv=-Hg-1;function Vc(o){let t=mi/o.extent,r=o.loadGeometry();for(let d=0;d<r.length;d++){let m=r[d];for(let _=0;_<m.length;_++){let y=m[_],b=Math.round(y.x*t),w=Math.round(y.y*t);y.x=Cn(b,iv,Hg),y.y=Cn(w,iv,Hg),(b<y.x||b>y.x+1||w<y.y||w>y.y+1)&&Sn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function jc(o,t){return{type:o.type,id:o.id,properties:o.properties,geometry:t?Vc(o):[]}}let nv=-32768;function JC(o,t,r,d,m){o.emplaceBack(nv+8*t+d,nv+8*r+m)}class Zg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Je,this.indexArray=new fi,this.segments=new gi,this.programConfigurations=new ea(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){let m=this.layers[0],_=[],y=null,b=!1,w=m.type==="heatmap";if(m.type==="circle"){let I=m;y=I.layout.get("circle-sort-key"),b=!y.isConstant(),w=w||I.paint.get("circle-pitch-alignment")==="map"}let S=w?r.subdivisionGranularity.circle:1;for(let{feature:I,id:A,index:L,sourceLayerIndex:N}of t){let V=this.layers[0]._featureFilter.needGeometry,G=jc(I,V);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),G,d))continue;let K=b?y.evaluate(G,{},d):void 0,ne={id:A,properties:I.properties,type:I.type,sourceLayerIndex:N,index:L,geometry:V?G.geometry:Vc(I),patterns:{},sortKey:K};_.push(ne)}b&&_.sort((I,A)=>I.sortKey-A.sortKey);for(let I of _){let{geometry:A,index:L,sourceLayerIndex:N}=I,V=t[L].feature;this.addFeature(I,A,L,d,S),r.featureIndex.insert(V,A,L,N,this.index)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,d,m,_=1){let y;switch(_){case 1:y=[0,7];break;case 3:y=[0,2,5,7];break;case 5:y=[0,1,3,4,6,7];break;case 7:y=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}let b=y.length;for(let w of r)for(let S of w){let I=S.x,A=S.y;if(I<0||I>=mi||A<0||A>=mi)continue;let L=this.segments.prepareSegment(b*b,this.layoutVertexArray,this.indexArray,t.sortKey),N=L.vertexLength;for(let V=0;V<b;V++)for(let G=0;G<b;G++)JC(this.layoutVertexArray,I,A,y[G],y[V]);for(let V=0;V<b-1;V++)for(let G=0;G<b-1;G++){let K=N+V*b+G,ne=N+(V+1)*b+G;this.indexArray.emplaceBack(K,ne+1,K+1),this.indexArray.emplaceBack(K,ne,ne+1)}L.vertexLength+=b*b,L.primitiveLength+=(b-1)*(b-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,{},m)}}function rv(o,t){for(let r=0;r<o.length;r++)if(Uc(t,o[r]))return!0;for(let r=0;r<t.length;r++)if(Uc(o,t[r]))return!0;return!!Wg(o,t)}function e2(o,t,r){return!!Uc(o,t)||!!qg(t,o,r)}function ov(o,t){if(o.length===1)return av(t,o[0]);for(let r=0;r<t.length;r++){let d=t[r];for(let m=0;m<d.length;m++)if(Uc(o,d[m]))return!0}for(let r=0;r<o.length;r++)if(av(t,o[r]))return!0;for(let r=0;r<t.length;r++)if(Wg(o,t[r]))return!0;return!1}function t2(o,t,r){if(o.length>1){if(Wg(o,t))return!0;for(let d=0;d<t.length;d++)if(qg(t[d],o,r))return!0}for(let d=0;d<o.length;d++)if(qg(o[d],t,r))return!0;return!1}function Wg(o,t){if(o.length===0||t.length===0)return!1;for(let r=0;r<o.length-1;r++){let d=o[r],m=o[r+1];for(let _=0;_<t.length-1;_++)if(i2(d,m,t[_],t[_+1]))return!0}return!1}function i2(o,t,r,d){return xi(o,r,d)!==xi(t,r,d)&&xi(o,t,r)!==xi(o,t,d)}function qg(o,t,r){let d=r*r;if(t.length===1)return o.distSqr(t[0])<d;for(let m=1;m<t.length;m++)if(sv(o,t[m-1],t[m])<d)return!0;return!1}function sv(o,t,r){let d=t.distSqr(r);if(d===0)return o.distSqr(t);let m=((o.x-t.x)*(r.x-t.x)+(o.y-t.y)*(r.y-t.y))/d;return o.distSqr(m<0?t:m>1?r:r.sub(t)._mult(m)._add(t))}function av(o,t){for(let r=0;r<o.length;r++)if(Uc(o[r],t))return!0;return!1}function Uc(o,t){let r=!1;for(let d=0,m=o.length-1;d<o.length;m=d++){let _=o[d],y=o[m];_.y>t.y!=y.y>t.y&&t.x<(y.x-_.x)*(t.y-_.y)/(y.y-_.y)+_.x&&(r=!r)}return r}function n2(o,t,r){let d=r[0],m=r[2];if(o.x<d.x&&t.x<d.x||o.x>m.x&&t.x>m.x||o.y<d.y&&t.y<d.y||o.y>m.y&&t.y>m.y)return!1;let _=xi(o,t,r[0]);return _!==xi(o,t,r[1])||_!==xi(o,t,r[2])||_!==xi(o,t,r[3])}function _h(o,t,r){let d=t.paint.get(o).value;return d.kind==="constant"?d.value:r.programConfigurations.get(t.id).getMaxValue(o)}function fm(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function gm(o,t,r,d,m){if(!t[0]&&!t[1])return o;let _=$e.convert(t)._mult(m);r==="viewport"&&_._rotate(-d);let y=[];for(let b=0;b<o.length;b++)y.push(o[b].sub(_));return y}let lv,cv;nt("CircleBucket",Zg,{omit:["layers"]});var r2={get paint(){return cv=cv||new gn({"circle-radius":new Ct(Q.paint_circle["circle-radius"]),"circle-color":new Ct(Q.paint_circle["circle-color"]),"circle-blur":new Ct(Q.paint_circle["circle-blur"]),"circle-opacity":new Ct(Q.paint_circle["circle-opacity"]),"circle-translate":new pt(Q.paint_circle["circle-translate"]),"circle-translate-anchor":new pt(Q.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pt(Q.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pt(Q.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ct(Q.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ct(Q.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ct(Q.paint_circle["circle-stroke-opacity"])})},get layout(){return lv=lv||new gn({"circle-sort-key":new Ct(Q.layout_circle["circle-sort-key"])})}};class o2 extends no{constructor(t){super(t,r2)}createBucket(t){return new Zg(t)}queryRadius(t){let r=t;return _h("circle-radius",this,r)+_h("circle-stroke-width",this,r)+fm(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:d,geometry:m,transform:_,pixelsToTileUnits:y,unwrappedTileID:b,getElevation:w}){let S=gm(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,y),I=this.paint.get("circle-radius").evaluate(r,d)+this.paint.get("circle-stroke-width").evaluate(r,d),A=this.paint.get("circle-pitch-alignment")==="map",L=A?S:function(V,G,K,ne){return V.map(me=>dv(me,G,K,ne))}(S,_,b,w),N=A?I*y:I;for(let V of m)for(let G of V){let K=A?G:dv(G,_,b,w),ne=N,me=_.projectTileCoordinates(G.x,G.y,b,w).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ne*=me/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ne*=_.cameraToCenterDistance/me),e2(L,K,ne))return!0}return!1}}function dv(o,t,r,d){let m=t.projectTileCoordinates(o.x,o.y,r,d).point;return new $e((.5*m.x+.5)*t.width,(.5*-m.y+.5)*t.height)}class uv extends Zg{}let hv;nt("HeatmapBucket",uv,{omit:["layers"]});var s2={get paint(){return hv=hv||new gn({"heatmap-radius":new Ct(Q.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ct(Q.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pt(Q.paint_heatmap["heatmap-intensity"]),"heatmap-color":new dh(Q.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pt(Q.paint_heatmap["heatmap-opacity"])})}};function Xg(o,{width:t,height:r},d,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==t*r*d)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${t*r*d}`)}else m=new Uint8Array(t*r*d);return o.width=t,o.height=r,o.data=m,o}function pv(o,{width:t,height:r},d){if(t===o.width&&r===o.height)return;let m=Xg({},{width:t,height:r},d);Yg(o,m,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,t),height:Math.min(o.height,r)},d),o.width=t,o.height=r,o.data=m.data}function Yg(o,t,r,d,m,_){if(m.width===0||m.height===0)return t;if(m.width>o.width||m.height>o.height||r.x>o.width-m.width||r.y>o.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>t.width||m.height>t.height||d.x>t.width-m.width||d.y>t.height-m.height)throw new RangeError("out of range destination coordinates for image copy");let y=o.data,b=t.data;if(y===b)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<m.height;w++){let S=((r.y+w)*o.width+r.x)*_,I=((d.y+w)*t.width+d.x)*_;for(let A=0;A<m.width*_;A++)b[I+A]=y[S+A]}return t}class yh{constructor(t,r){Xg(this,t,1,r)}resize(t){pv(this,t,1)}clone(){return new yh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,d,m,_){Yg(t,r,d,m,_,1)}}class wo{constructor(t,r){Xg(this,t,4,r)}resize(t){pv(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new wo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,d,m,_){Yg(t,r,d,m,_,4)}}function mv(o){let t={},r=o.resolution||256,d=o.clips?o.clips.length:1,m=o.image||new wo({width:r,height:d});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);let _=(y,b,w)=>{t[o.evaluationKey]=w;let S=o.expression.evaluate(t);m.data[y+b+0]=Math.floor(255*S.r/S.a),m.data[y+b+1]=Math.floor(255*S.g/S.a),m.data[y+b+2]=Math.floor(255*S.b/S.a),m.data[y+b+3]=Math.floor(255*S.a)};if(o.clips)for(let y=0,b=0;y<d;++y,b+=4*r)for(let w=0,S=0;w<r;w++,S+=4){let I=w/(r-1),{start:A,end:L}=o.clips[y];_(b,S,A*(1-I)+L*I)}else for(let y=0,b=0;y<r;y++,b+=4)_(0,b,y/(r-1));return m}nt("AlphaImage",yh),nt("RGBAImage",wo);let Kg="big-fb";class a2 extends no{createBucket(t){return new uv(t)}constructor(t){super(t,s2),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Kg)&&this.heatmapFbos.delete(Kg)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let fv;var l2={get paint(){return fv=fv||new gn({"hillshade-illumination-direction":new pt(Q.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new pt(Q.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new pt(Q.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pt(Q.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pt(Q.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pt(Q.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pt(Q.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new pt(Q.paint_hillshade["hillshade-method"])})}};class c2 extends no{constructor(t){super(t,l2),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,r=this.paint.get("hillshade-illumination-altitude").values,d=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values,_=Math.max(t.length,r.length,d.length,m.length);t=t.concat(Array(_-t.length).fill(t.at(-1))),r=r.concat(Array(_-r.length).fill(r.at(-1))),d=d.concat(Array(_-d.length).fill(d.at(-1))),m=m.concat(Array(_-m.length).fill(m.at(-1)));let y=r.map(Kt);return{directionRadians:t.map(Kt),altitudeRadians:y,shadowColor:m,highlightColor:d}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let d2=Wi([{name:"a_pos",components:2,type:"Int16"}],4),{members:u2}=d2;function Qg(o,t,r){let d=r.patternDependencies,m=!1;for(let _ of t){let y=_.paint.get(`${o}-pattern`);y.isConstant()||(m=!0);let b=y.constantOr(null);b&&(m=!0,d[b.to]=!0,d[b.from]=!0)}return m}function Jg(o,t,r,d,m){let _=m.patternDependencies;for(let y of t){let b=y.paint.get(`${o}-pattern`).value;if(b.kind!=="constant"){let w=b.evaluate({zoom:d-1},r,{},m.availableImages),S=b.evaluate({zoom:d},r,{},m.availableImages),I=b.evaluate({zoom:d+1},r,{},m.availableImages);w=w&&w.name?w.name:w,S=S&&S.name?S.name:S,I=I&&I.name?I.name:I,_[w]=!0,_[S]=!0,_[I]=!0,r.patterns[y.id]={min:w,mid:S,max:I}}}return r}function gv(o,t,r,d,m){let _;if(m===function(y,b,w,S){let I=0;for(let A=b,L=w-S;A<w;A+=S)I+=(y[L]-y[A])*(y[A+1]+y[L+1]),L=A;return I}(o,t,r,d)>0)for(let y=t;y<r;y+=d)_=bv(y/d|0,o[y],o[y+1],_);else for(let y=r-d;y>=t;y-=d)_=bv(y/d|0,o[y],o[y+1],_);return _&&Wd(_,_.next)&&(wh(_),_=_.next),_}function $c(o,t){if(!o)return o;t||(t=o);let r,d=o;do if(r=!1,d.steiner||!Wd(d,d.next)&&un(d.prev,d,d.next)!==0)d=d.next;else{if(wh(d),d=t=d.prev,d===d.next)break;r=!0}while(r||d!==t);return t}function vh(o,t,r,d,m,_,y){if(!o)return;!y&&_&&function(w,S,I,A){let L=w;do L.z===0&&(L.z=e_(L.x,L.y,S,I,A)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==w);L.prevZ.nextZ=null,L.prevZ=null,function(N){let V,G=1;do{let K,ne=N;N=null;let me=null;for(V=0;ne;){V++;let ae=ne,B=0;for(let ce=0;ce<G&&(B++,ae=ae.nextZ,ae);ce++);let W=G;for(;B>0||W>0&&ae;)B!==0&&(W===0||!ae||ne.z<=ae.z)?(K=ne,ne=ne.nextZ,B--):(K=ae,ae=ae.nextZ,W--),me?me.nextZ=K:N=K,K.prevZ=me,me=K;ne=ae}me.nextZ=null,G*=2}while(V>1)}(L)}(o,d,m,_);let b=o;for(;o.prev!==o.next;){let w=o.prev,S=o.next;if(_?p2(o,d,m,_):h2(o))t.push(w.i,o.i,S.i),wh(o),o=S.next,b=S.next;else if((o=S)===b){y?y===1?vh(o=m2($c(o),t),t,r,d,m,_,2):y===2&&f2(o,t,r,d,m,_):vh($c(o),t,r,d,m,_,1);break}}}function h2(o){let t=o.prev,r=o,d=o.next;if(un(t,r,d)>=0)return!1;let m=t.x,_=r.x,y=d.x,b=t.y,w=r.y,S=d.y,I=Math.min(m,_,y),A=Math.min(b,w,S),L=Math.max(m,_,y),N=Math.max(b,w,S),V=d.next;for(;V!==t;){if(V.x>=I&&V.x<=L&&V.y>=A&&V.y<=N&&bh(m,b,_,w,y,S,V.x,V.y)&&un(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function p2(o,t,r,d){let m=o.prev,_=o,y=o.next;if(un(m,_,y)>=0)return!1;let b=m.x,w=_.x,S=y.x,I=m.y,A=_.y,L=y.y,N=Math.min(b,w,S),V=Math.min(I,A,L),G=Math.max(b,w,S),K=Math.max(I,A,L),ne=e_(N,V,t,r,d),me=e_(G,K,t,r,d),ae=o.prevZ,B=o.nextZ;for(;ae&&ae.z>=ne&&B&&B.z<=me;){if(ae.x>=N&&ae.x<=G&&ae.y>=V&&ae.y<=K&&ae!==m&&ae!==y&&bh(b,I,w,A,S,L,ae.x,ae.y)&&un(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,B.x>=N&&B.x<=G&&B.y>=V&&B.y<=K&&B!==m&&B!==y&&bh(b,I,w,A,S,L,B.x,B.y)&&un(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;ae&&ae.z>=ne;){if(ae.x>=N&&ae.x<=G&&ae.y>=V&&ae.y<=K&&ae!==m&&ae!==y&&bh(b,I,w,A,S,L,ae.x,ae.y)&&un(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;B&&B.z<=me;){if(B.x>=N&&B.x<=G&&B.y>=V&&B.y<=K&&B!==m&&B!==y&&bh(b,I,w,A,S,L,B.x,B.y)&&un(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function m2(o,t){let r=o;do{let d=r.prev,m=r.next.next;!Wd(d,m)&&yv(d,r,r.next,m)&&xh(d,m)&&xh(m,d)&&(t.push(d.i,r.i,m.i),wh(r),wh(r.next),r=o=m),r=r.next}while(r!==o);return $c(r)}function f2(o,t,r,d,m,_){let y=o;do{let b=y.next.next;for(;b!==y.prev;){if(y.i!==b.i&&b2(y,b)){let w=vv(y,b);return y=$c(y,y.next),w=$c(w,w.next),vh(y,t,r,d,m,_,0),void vh(w,t,r,d,m,_,0)}b=b.next}y=y.next}while(y!==o)}function g2(o,t){let r=o.x-t.x;return r===0&&(r=o.y-t.y,r===0)&&(r=(o.next.y-o.y)/(o.next.x-o.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function _2(o,t){let r=function(m,_){let y=_,b=m.x,w=m.y,S,I=-1/0;if(Wd(m,y))return y;do{if(Wd(m,y.next))return y.next;if(w<=y.y&&w>=y.next.y&&y.next.y!==y.y){let G=y.x+(w-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(G<=b&&G>I&&(I=G,S=y.x<y.next.x?y:y.next,G===b))return S}y=y.next}while(y!==_);if(!S)return null;let A=S,L=S.x,N=S.y,V=1/0;y=S;do{if(b>=y.x&&y.x>=L&&b!==y.x&&_v(w<N?b:I,w,L,N,w<N?I:b,w,y.x,y.y)){let G=Math.abs(w-y.y)/(b-y.x);xh(y,m)&&(G<V||G===V&&(y.x>S.x||y.x===S.x&&y2(S,y)))&&(S=y,V=G)}y=y.next}while(y!==A);return S}(o,t);if(!r)return t;let d=vv(r,o);return $c(d,d.next),$c(r,r.next)}function y2(o,t){return un(o.prev,o,t.prev)<0&&un(t.next,o,o.next)<0}function e_(o,t,r,d,m){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-r)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-d)*m|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function v2(o){let t=o,r=o;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==o);return r}function _v(o,t,r,d,m,_,y,b){return(m-y)*(t-b)>=(o-y)*(_-b)&&(o-y)*(d-b)>=(r-y)*(t-b)&&(r-y)*(_-b)>=(m-y)*(d-b)}function bh(o,t,r,d,m,_,y,b){return!(o===y&&t===b)&&_v(o,t,r,d,m,_,y,b)}function b2(o,t){return o.next.i!==t.i&&o.prev.i!==t.i&&!function(r,d){let m=r;do{if(m.i!==r.i&&m.next.i!==r.i&&m.i!==d.i&&m.next.i!==d.i&&yv(m,m.next,r,d))return!0;m=m.next}while(m!==r);return!1}(o,t)&&(xh(o,t)&&xh(t,o)&&function(r,d){let m=r,_=!1,y=(r.x+d.x)/2,b=(r.y+d.y)/2;do m.y>b!=m.next.y>b&&m.next.y!==m.y&&y<(m.next.x-m.x)*(b-m.y)/(m.next.y-m.y)+m.x&&(_=!_),m=m.next;while(m!==r);return _}(o,t)&&(un(o.prev,o,t.prev)||un(o,t.prev,t))||Wd(o,t)&&un(o.prev,o,o.next)>0&&un(t.prev,t,t.next)>0)}function un(o,t,r){return(t.y-o.y)*(r.x-t.x)-(t.x-o.x)*(r.y-t.y)}function Wd(o,t){return o.x===t.x&&o.y===t.y}function yv(o,t,r,d){let m=ym(un(o,t,r)),_=ym(un(o,t,d)),y=ym(un(r,d,o)),b=ym(un(r,d,t));return m!==_&&y!==b||!(m!==0||!_m(o,r,t))||!(_!==0||!_m(o,d,t))||!(y!==0||!_m(r,o,d))||!(b!==0||!_m(r,t,d))}function _m(o,t,r){return t.x<=Math.max(o.x,r.x)&&t.x>=Math.min(o.x,r.x)&&t.y<=Math.max(o.y,r.y)&&t.y>=Math.min(o.y,r.y)}function ym(o){return o>0?1:o<0?-1:0}function xh(o,t){return un(o.prev,o,o.next)<0?un(o,t,o.next)>=0&&un(o,o.prev,t)>=0:un(o,t,o.prev)<0||un(o,o.next,t)<0}function vv(o,t){let r=t_(o.i,o.x,o.y),d=t_(t.i,t.x,t.y),m=o.next,_=t.prev;return o.next=t,t.prev=o,r.next=m,m.prev=r,d.next=r,r.prev=d,_.next=d,d.prev=_,d}function bv(o,t,r,d){let m=t_(o,t,r);return d?(m.next=d.next,m.prev=d,d.next.prev=m,d.next=m):(m.prev=m,m.next=m),m}function wh(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function t_(o,t,r){return{i:o,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class qd{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class vm{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}vm.noSubdivision=new vm({fill:new qd(0,0),line:new qd(0,0),tile:new qd(0,0),stencil:new qd(0,0),circle:1}),nt("SubdivisionGranularityExpression",qd),nt("SubdivisionGranularitySetting",vm);let Xd=-32768,Ch=32767;class x2{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=mi/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|(r+=32768)<<0}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");let d=0|Math.round(t),m=0|Math.round(r),_=this._getKey(d,m);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);let y=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,y),this._vertexBuffer.push(d,m),y}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(m,_){let y=[];for(let b=0;b<_.length;b+=3){let w=_[b],S=_[b+1],I=_[b+2],A=m[2*w],L=m[2*w+1];(m[2*S]-A)*(m[2*I+1]-L)-(m[2*S+1]-L)*(m[2*I]-A)>0?(y.push(w),y.push(I),y.push(S)):(y.push(w),y.push(S),y.push(I))}return y}(this._vertexBuffer,t);let r=[],d=t.length;for(let m=0;m<d;m+=3){let _=[t[m+0],t[m+1],t[m+2]],y=[this._vertexBuffer[2*t[m+0]+0],this._vertexBuffer[2*t[m+0]+1],this._vertexBuffer[2*t[m+1]+0],this._vertexBuffer[2*t[m+1]+1],this._vertexBuffer[2*t[m+2]+0],this._vertexBuffer[2*t[m+2]+1]],b=1/0,w=1/0,S=-1/0,I=-1/0;for(let G=0;G<3;G++){let K=y[2*G],ne=y[2*G+1];b=Math.min(b,K),S=Math.max(S,K),w=Math.min(w,ne),I=Math.max(I,ne)}if(b===S||w===I)continue;let A=Math.floor(b/this._granularityCellSize),L=Math.ceil(S/this._granularityCellSize),N=Math.floor(w/this._granularityCellSize),V=Math.ceil(I/this._granularityCellSize);if(A!==L||N!==V)for(let G=N;G<V;G++){let K=this._scanlineGenerateVertexRingForCellRow(G,y,_);w2(this._vertexBuffer,K,r)}else r.push(..._)}return r}_scanlineGenerateVertexRingForCellRow(t,r,d){let m=t*this._granularityCellSize,_=m+this._granularityCellSize,y=[];for(let b=0;b<3;b++){let w=r[2*b],S=r[2*b+1],I=r[2*(b+1)%6],A=r[(2*(b+1)+1)%6],L=r[2*(b+2)%6],N=r[(2*(b+2)+1)%6],V=I-w,G=A-S,K=V===0,ne=G===0,me=(m-S)/G,ae=(_-S)/G,B=Math.min(me,ae),W=Math.max(me,ae);if(!ne&&(B>=1||W<=0)||ne&&(S<m||S>_)){A>=m&&A<=_&&y.push(d[(b+1)%3]);continue}!ne&&B>0&&y.push(this._vertexToIndex(w+V*B,S+G*B));let ce=w+V*Math.max(B,0),Pe=w+V*Math.min(W,1);K||this._generateIntraEdgeVertices(y,w,S,I,A,ce,Pe),!ne&&W<1&&y.push(this._vertexToIndex(w+V*W,S+G*W)),(ne||A>=m&&A<=_)&&y.push(d[(b+1)%3]),!ne&&(A<=m||A>=_)&&this._generateInterEdgeVertices(y,w,S,I,A,L,N,Pe,m,_)}return y}_generateIntraEdgeVertices(t,r,d,m,_,y,b){let w=m-r,S=_-d,I=S===0,A=I?Math.min(r,m):Math.min(y,b),L=I?Math.max(r,m):Math.max(y,b),N=Math.floor(A/this._granularityCellSize)+1,V=Math.ceil(L/this._granularityCellSize)-1;if(I?r<m:y<b)for(let G=N;G<=V;G++){let K=G*this._granularityCellSize;t.push(this._vertexToIndex(K,d+S*(K-r)/w))}else for(let G=V;G>=N;G--){let K=G*this._granularityCellSize;t.push(this._vertexToIndex(K,d+S*(K-r)/w))}}_generateInterEdgeVertices(t,r,d,m,_,y,b,w,S,I){let A=_-d,L=y-m,N=b-_,V=(S-_)/N,G=(I-_)/N,K=Math.min(V,G),ne=Math.max(V,G),me=m+L*K,ae=Math.floor(Math.min(me,w)/this._granularityCellSize)+1,B=Math.ceil(Math.max(me,w)/this._granularityCellSize)-1,W=w<me,ce=N===0;if(ce&&(b===S||b===I))return;if(ce||K>=1||ne<=0){let Ue=d-b,Ie=y+(r-y)*Math.min((S-b)/Ue,(I-b)/Ue);ae=Math.floor(Math.min(Ie,w)/this._granularityCellSize)+1,B=Math.ceil(Math.max(Ie,w)/this._granularityCellSize)-1,W=w<Ie}let Pe=A>0?I:S;if(W)for(let Ue=ae;Ue<=B;Ue++)t.push(this._vertexToIndex(Ue*this._granularityCellSize,Pe));else for(let Ue=B;Ue>=ae;Ue--)t.push(this._vertexToIndex(Ue*this._granularityCellSize,Pe))}_generateOutline(t){let r=[];for(let d of t){let m=Gc(d,this._granularity,!0),_=this._pointArrayToIndices(m),y=[];for(let b=1;b<_.length;b++)y.push(_[b-1]),y.push(_[b]);r.push(y)}return r}_handlePoles(t){let r=!1,d=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(d=!0)),(r||d)&&this._fillPoles(t,r,d)}_ensureNoPoleVertices(){let t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){let d=t[r+1];d===Xd&&(t[r+1]=-32767),d===Ch&&(t[r+1]=32766)}}_generatePoleQuad(t,r,d,m,_,y){m>_!=(y===Xd)?(t.push(r),t.push(d),t.push(this._vertexToIndex(m,y)),t.push(d),t.push(this._vertexToIndex(_,y)),t.push(this._vertexToIndex(m,y))):(t.push(d),t.push(r),t.push(this._vertexToIndex(m,y)),t.push(this._vertexToIndex(_,y)),t.push(d),t.push(this._vertexToIndex(m,y)))}_fillPoles(t,r,d){let m=this._vertexBuffer,_=mi,y=t.length;for(let b=2;b<y;b+=3){let w=t[b-2],S=t[b-1],I=t[b],A=m[2*w],L=m[2*w+1],N=m[2*S],V=m[2*S+1],G=m[2*I],K=m[2*I+1];r&&(L===0&&V===0&&this._generatePoleQuad(t,w,S,A,N,Xd),V===0&&K===0&&this._generatePoleQuad(t,S,I,N,G,Xd),K===0&&L===0&&this._generatePoleQuad(t,I,w,G,A,Xd)),d&&(L===_&&V===_&&this._generatePoleQuad(t,w,S,A,N,Ch),V===_&&K===_&&this._generatePoleQuad(t,S,I,N,G,Ch),K===_&&L===_&&this._generatePoleQuad(t,I,w,G,A,Ch))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;let{flattened:d,holeIndices:m}=function(b){let w=[],S=[];for(let I of b)if(I.length!==0){I!==b[0]&&w.push(S.length/2);for(let A=0;A<I.length;A++)S.push(I[A].x),S.push(I[A].y)}return{flattened:S,holeIndices:w}}(t),_;this._initializeVertices(d);try{let b=function(S,I,A=2){let L=I&&I.length,N=L?I[0]*A:S.length,V=gv(S,0,N,A,!0),G=[];if(!V||V.next===V.prev)return G;let K,ne,me;if(L&&(V=function(ae,B,W,ce){let Pe=[];for(let Ue=0,Ie=B.length;Ue<Ie;Ue++){let Le=gv(ae,B[Ue]*ce,Ue<Ie-1?B[Ue+1]*ce:ae.length,ce,!1);Le===Le.next&&(Le.steiner=!0),Pe.push(v2(Le))}Pe.sort(g2);for(let Ue=0;Ue<Pe.length;Ue++)W=_2(Pe[Ue],W);return W}(S,I,V,A)),S.length>80*A){K=1/0,ne=1/0;let ae=-1/0,B=-1/0;for(let W=A;W<N;W+=A){let ce=S[W],Pe=S[W+1];ce<K&&(K=ce),Pe<ne&&(ne=Pe),ce>ae&&(ae=ce),Pe>B&&(B=Pe)}me=Math.max(ae-K,B-ne),me=me!==0?32767/me:0}return vh(V,G,A,K,ne,me,0),G}(d,m),w=this._convertIndices(d,b);_=this._subdivideTrianglesScanline(w)}catch(b){console.error(b)}let y=[];return r&&(y=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:y}}_convertIndices(t,r){let d=[];for(let m=0;m<r.length;m++)d.push(this._vertexToIndex(t[2*r[m]],t[2*r[m]+1]));return d}_pointArrayToIndices(t){let r=[];for(let d=0;d<t.length;d++){let m=t[d];r.push(this._vertexToIndex(m.x,m.y))}return r}}function xv(o,t,r,d=!0){return new x2(r,t).subdividePolygonInternal(o,d)}function Gc(o,t,r=!1){if(!o||o.length<1)return[];if(o.length<2)return[];let d=o[0],m=o[o.length-1],_=r&&(d.x!==m.x||d.y!==m.y);if(t<2)return _?[...o,o[0]]:[...o];let y=Math.floor(mi/t),b=[];b.push(new $e(o[0].x,o[0].y));let w=o.length,S=_?w:w-1;for(let I=0;I<S;I++){let A=o[I],L=I<w-1?o[I+1]:o[0],N=A.x,V=A.y,G=L.x,K=L.y,ne=N!==G,me=V!==K;if(!ne&&!me)continue;let ae=G-N,B=K-V,W=Math.abs(ae),ce=Math.abs(B),Pe=N,Ue=V;for(;;){let Le=ae>0?(Math.floor(Pe/y)+1)*y:(Math.ceil(Pe/y)-1)*y,Ze=B>0?(Math.floor(Ue/y)+1)*y:(Math.ceil(Ue/y)-1)*y,Ge=Math.abs(Pe-Le),We=Math.abs(Ue-Ze),Ne=Math.abs(Pe-G),ot=Math.abs(Ue-K),vt=ne?Ge/W:Number.POSITIVE_INFINITY,_t=me?We/ce:Number.POSITIVE_INFINITY;if((Ne<=Ge||!ne)&&(ot<=We||!me))break;if(vt<_t&&ne||!me){Pe=Le,Ue+=B*vt;let dt=new $e(Pe,Math.round(Ue));b[b.length-1].x===dt.x&&b[b.length-1].y===dt.y||b.push(dt)}else{Pe+=ae*_t,Ue=Ze;let dt=new $e(Math.round(Pe),Ue);b[b.length-1].x===dt.x&&b[b.length-1].y===dt.y||b.push(dt)}}let Ie=new $e(G,K);b[b.length-1].x===Ie.x&&b[b.length-1].y===Ie.y||b.push(Ie)}return b}function w2(o,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let d=0,m=o[2*t[0]];for(let w=1;w<t.length;w++){let S=o[2*t[w]];S<m&&(m=S,d=w)}let _=t.length,y=d,b=(y+1)%_;for(;;){let w=y-1>=0?y-1:_-1,S=(b+1)%_,I=o[2*t[w]],A=o[2*t[S]],L=o[2*t[y]],N=o[2*t[y]+1],V=o[2*t[b]+1],G=!1;if(I<A)G=!0;else if(I>A)G=!1;else{let K=V-N,ne=-(o[2*t[b]]-L),me=N<V?1:-1;((I-L)*K+(o[2*t[w]+1]-N)*ne)*me>((A-L)*K+(o[2*t[S]+1]-N)*ne)*me&&(G=!0)}if(G){let K=t[w],ne=t[y],me=t[b];K!==ne&&K!==me&&ne!==me&&r.push(me,ne,K),y--,y<0&&(y=_-1)}else{let K=t[S],ne=t[y],me=t[b];K!==ne&&K!==me&&ne!==me&&r.push(me,ne,K),b++,b>=_&&(b=0)}if(w===S)break}}function wv(o,t,r,d,m,_,y,b,w){let S=m.length/2,I=y&&b&&w;if(S<gi.MAX_VERTEX_ARRAY_LENGTH){let A=t.prepareSegment(S,r,d),L=A.vertexLength;for(let G=0;G<_.length;G+=3)d.emplaceBack(L+_[G],L+_[G+1],L+_[G+2]);let N,V;A.vertexLength+=S,A.primitiveLength+=_.length/3,I&&(V=y.prepareSegment(S,r,b),N=V.vertexLength,V.vertexLength+=S);for(let G=0;G<m.length;G+=2)o(m[G],m[G+1]);if(I)for(let G=0;G<w.length;G++){let K=w[G];for(let ne=1;ne<K.length;ne+=2)b.emplaceBack(N+K[ne-1],N+K[ne]);V.primitiveLength+=K.length/2}}else(function(A,L,N,V,G,K){let ne=[];for(let ce=0;ce<V.length/2;ce++)ne.push(-1);let me={count:0},ae=0,B=A.getOrCreateLatestSegment(L,N),W=B.vertexLength;for(let ce=2;ce<G.length;ce+=3){let Pe=G[ce-2],Ue=G[ce-1],Ie=G[ce],Le=ne[Pe]<ae,Ze=ne[Ue]<ae,Ge=ne[Ie]<ae;B.vertexLength+((Le?1:0)+(Ze?1:0)+(Ge?1:0))>gi.MAX_VERTEX_ARRAY_LENGTH&&(B=A.createNewSegment(L,N),ae=me.count,Le=!0,Ze=!0,Ge=!0,W=0);let We=Mh(ne,V,K,me,Pe,Le,B),Ne=Mh(ne,V,K,me,Ue,Ze,B),ot=Mh(ne,V,K,me,Ie,Ge,B);N.emplaceBack(W+We-ae,W+Ne-ae,W+ot-ae),B.primitiveLength++}})(t,r,d,m,_,o),I&&function(A,L,N,V,G,K){let ne=[];for(let ce=0;ce<V.length/2;ce++)ne.push(-1);let me={count:0},ae=0,B=A.getOrCreateLatestSegment(L,N),W=B.vertexLength;for(let ce=0;ce<G.length;ce++){let Pe=G[ce];for(let Ue=1;Ue<G[ce].length;Ue+=2){let Ie=Pe[Ue-1],Le=Pe[Ue],Ze=ne[Ie]<ae,Ge=ne[Le]<ae;B.vertexLength+((Ze?1:0)+(Ge?1:0))>gi.MAX_VERTEX_ARRAY_LENGTH&&(B=A.createNewSegment(L,N),ae=me.count,Ze=!0,Ge=!0,W=0);let We=Mh(ne,V,K,me,Ie,Ze,B),Ne=Mh(ne,V,K,me,Le,Ge,B);N.emplaceBack(W+We-ae,W+Ne-ae),B.primitiveLength++}}}(y,r,b,m,w,o),t.forceNewSegmentOnNextPrepare(),y?.forceNewSegmentOnNextPrepare()}function Mh(o,t,r,d,m,_,y){if(_){let b=d.count;return r(t[2*m],t[2*m+1]),o[m]=d.count,d.count++,y.vertexLength++,b}return o[m]}class i_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ke,this.indexArray=new fi,this.indexArray2=new In,this.programConfigurations=new ea(t.layers,t.zoom),this.segments=new gi,this.segments2=new gi,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){this.hasPattern=Qg("fill",this.layers,r);let m=this.layers[0].layout.get("fill-sort-key"),_=!m.isConstant(),y=[];for(let{feature:b,id:w,index:S,sourceLayerIndex:I}of t){let A=this.layers[0]._featureFilter.needGeometry,L=jc(b,A);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),L,d))continue;let N=_?m.evaluate(L,{},d,r.availableImages):void 0,V={id:w,properties:b.properties,type:b.type,sourceLayerIndex:I,index:S,geometry:A?L.geometry:Vc(b),patterns:{},sortKey:N};y.push(V)}_&&y.sort((b,w)=>b.sortKey-w.sortKey);for(let b of y){let{geometry:w,index:S,sourceLayerIndex:I}=b;if(this.hasPattern){let A=Jg("fill",this.layers,b,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(b,w,S,d,{},r.subdivisionGranularity);r.featureIndex.insert(t[S].feature,w,S,I,this.index)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}addFeatures(t,r,d){for(let m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,r,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,u2),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,d,m,_,y){for(let b of Aa(r,500)){let w=xv(b,m,y.fill.getGranularityForZoomLevel(m.z)),S=this.layoutVertexArray;wv((I,A)=>{S.emplaceBack(I,A)},this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,_,m)}}let Cv,Mv;nt("FillBucket",i_,{omit:["layers","patternFeatures"]});var C2={get paint(){return Mv=Mv||new gn({"fill-antialias":new pt(Q.paint_fill["fill-antialias"]),"fill-opacity":new Ct(Q.paint_fill["fill-opacity"]),"fill-color":new Ct(Q.paint_fill["fill-color"]),"fill-outline-color":new Ct(Q.paint_fill["fill-outline-color"]),"fill-translate":new pt(Q.paint_fill["fill-translate"]),"fill-translate-anchor":new pt(Q.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fc(Q.paint_fill["fill-pattern"])})},get layout(){return Cv=Cv||new gn({"fill-sort-key":new Ct(Q.layout_fill["fill-sort-key"])})}};class M2 extends no{constructor(t){super(t,C2)}recalculate(t,r){super.recalculate(t,r);let d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new i_(t)}queryRadius(){return fm(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:d,pixelsToTileUnits:m}){return ov(gm(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-d.bearingInRadians,m),r)}isTileClipped(){return!0}}let S2=Wi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),P2=Wi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:E2}=S2;var n_,Sv,r_,Pv,o_,Ev,Tv,bm={};function Iv(){if(Sv)return n_;Sv=1;var o=be();function t(m,_,y,b,w){this.properties={},this.extent=y,this.type=0,this._pbf=m,this._geometry=-1,this._keys=b,this._values=w,m.readFields(r,this,_)}function r(m,_,y){m==1?_.id=y.readVarint():m==2?function(b,w){for(var S=b.readVarint()+b.pos;b.pos<S;){var I=w._keys[b.readVarint()],A=w._values[b.readVarint()];w.properties[I]=A}}(y,_):m==3?_.type=y.readVarint():m==4&&(_._geometry=y.pos)}function d(m){for(var _,y,b=0,w=0,S=m.length,I=S-1;w<S;I=w++)b+=((y=m[I]).x-(_=m[w]).x)*(_.y+y.y);return b}return n_=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var _,y=m.readVarint()+m.pos,b=1,w=0,S=0,I=0,A=[];m.pos<y;){if(w<=0){var L=m.readVarint();b=7&L,w=L>>3}if(w--,b===1||b===2)S+=m.readSVarint(),I+=m.readSVarint(),b===1&&(_&&A.push(_),_=[]),_.push(new o(S,I));else{if(b!==7)throw new Error("unknown command "+b);_&&_.push(_[0].clone())}}return _&&A.push(_),A},t.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var _=m.readVarint()+m.pos,y=1,b=0,w=0,S=0,I=1/0,A=-1/0,L=1/0,N=-1/0;m.pos<_;){if(b<=0){var V=m.readVarint();y=7&V,b=V>>3}if(b--,y===1||y===2)(w+=m.readSVarint())<I&&(I=w),w>A&&(A=w),(S+=m.readSVarint())<L&&(L=S),S>N&&(N=S);else if(y!==7)throw new Error("unknown command "+y)}return[I,L,A,N]},t.prototype.toGeoJSON=function(m,_,y){var b,w,S=this.extent*Math.pow(2,y),I=this.extent*m,A=this.extent*_,L=this.loadGeometry(),N=t.types[this.type];function V(ne){for(var me=0;me<ne.length;me++){var ae=ne[me];ne[me]=[360*(ae.x+I)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+A)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(b=0;b<L.length;b++)G[b]=L[b][0];V(L=G);break;case 2:for(b=0;b<L.length;b++)V(L[b]);break;case 3:for(L=function(ne){var me=ne.length;if(me<=1)return[ne];for(var ae,B,W=[],ce=0;ce<me;ce++){var Pe=d(ne[ce]);Pe!==0&&(B===void 0&&(B=Pe<0),B===Pe<0?(ae&&W.push(ae),ae=[ne[ce]]):ae.push(ne[ce]))}return ae&&W.push(ae),W}(L),b=0;b<L.length;b++)for(w=0;w<L[b].length;w++)V(L[b][w])}L.length===1?L=L[0]:N="Multi"+N;var K={type:"Feature",geometry:{type:N,coordinates:L},properties:this.properties};return"id"in this&&(K.id=this.id),K},n_}function kv(){if(Pv)return r_;Pv=1;var o=Iv();function t(d,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(r,this,m),this.length=this._features.length}function r(d,m,_){d===15?m.version=_.readVarint():d===1?m.name=_.readString():d===5?m.extent=_.readVarint():d===2?m._features.push(_.pos):d===3?m._keys.push(_.readString()):d===4&&m._values.push(function(y){for(var b=null,w=y.readVarint()+y.pos;y.pos<w;){var S=y.readVarint()>>3;b=S===1?y.readString():S===2?y.readFloat():S===3?y.readDouble():S===4?y.readVarint64():S===5?y.readVarint():S===6?y.readSVarint():S===7?y.readBoolean():null}return b}(_))}return r_=t,t.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var m=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,m,this.extent,this._keys,this._values)},r_}function Av(){return Tv||(Tv=1,bm.VectorTile=function(){if(Ev)return o_;Ev=1;var o=kv();function t(r,d,m){if(r===3){var _=new o(m,m.readVarint()+m.pos);_.length&&(d[_.name]=_)}}return o_=function(r,d){this.layers=r.readFields(t,{},d)},o_}(),bm.VectorTileFeature=Iv(),bm.VectorTileLayer=kv()),bm}var Sh=P(Av());let T2=Sh.VectorTileFeature.types,s_=Math.pow(2,13);function Ph(o,t,r,d,m,_,y,b){o.emplaceBack(t,r,2*Math.floor(d*s_)+y,m*s_*2,_*s_*2,Math.round(b))}class a_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new He,this.centroidVertexArray=new Re,this.indexArray=new fi,this.programConfigurations=new ea(t.layers,t.zoom),this.segments=new gi,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){this.features=[],this.hasPattern=Qg("fill-extrusion",this.layers,r);for(let{feature:m,id:_,index:y,sourceLayerIndex:b}of t){let w=this.layers[0]._featureFilter.needGeometry,S=jc(m,w);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),S,d))continue;let I={id:_,sourceLayerIndex:b,index:y,geometry:w?S.geometry:Vc(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(Jg("fill-extrusion",this.layers,I,this.zoom,r)):this.addFeature(I,I.geometry,y,d,{},r.subdivisionGranularity),r.featureIndex.insert(m,I.geometry,y,b,this.index,!0)}}addFeatures(t,r,d){for(let m of this.features){let{geometry:_}=m;this.addFeature(m,_,m.index,r,d,t.subdivisionGranularity)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,E2),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,P2.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,d,m,_,y){for(let b of Aa(r,500)){let w={x:0,y:0,sampleCount:0},S=this.layoutVertexArray.length;this.processPolygon(w,m,t,b,y);let I=this.layoutVertexArray.length-S,A=Math.floor(w.x/w.sampleCount),L=Math.floor(w.y/w.sampleCount);for(let N=0;N<I;N++)this.centroidVertexArray.emplaceBack(A,L)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,_,m)}processPolygon(t,r,d,m,_){if(m.length<1||Dv(m[0]))return;for(let A of m)A.length!==0&&I2(t,A);let y={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},b=_.fill.getGranularityForZoomLevel(r.z),w=T2[d.type]==="Polygon";for(let A of m){if(A.length===0||Dv(A))continue;let L=Gc(A,b,w);this._generateSideFaces(L,y)}if(!w)return;let S=xv(m,r,b,!1),I=this.layoutVertexArray;wv((A,L)=>{Ph(I,A,L,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles)}_generateSideFaces(t,r){let d=0;for(let m=1;m<t.length;m++){let _=t[m],y=t[m-1];if(k2(_,y))continue;r.segment.vertexLength+4>gi.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let b=_.sub(y)._perp()._unit(),w=y.dist(_);d+w>32768&&(d=0),Ph(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,0,d),Ph(this.layoutVertexArray,_.x,_.y,b.x,b.y,0,1,d),d+=w,Ph(this.layoutVertexArray,y.x,y.y,b.x,b.y,0,0,d),Ph(this.layoutVertexArray,y.x,y.y,b.x,b.y,0,1,d);let S=r.segment.vertexLength;this.indexArray.emplaceBack(S,S+2,S+1),this.indexArray.emplaceBack(S+1,S+2,S+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function I2(o,t){for(let r=0;r<t.length;r++){let d=t[r];r===t.length-1&&t[0].x===d.x&&t[0].y===d.y||(o.x+=d.x,o.y+=d.y,o.sampleCount++)}}function k2(o,t){return o.x===t.x&&(o.x<0||o.x>mi)||o.y===t.y&&(o.y<0||o.y>mi)}function Dv(o){return o.every(t=>t.x<0)||o.every(t=>t.x>mi)||o.every(t=>t.y<0)||o.every(t=>t.y>mi)}let Rv;nt("FillExtrusionBucket",a_,{omit:["layers","features"]});var A2={get paint(){return Rv=Rv||new gn({"fill-extrusion-opacity":new pt(Q["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ct(Q["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pt(Q["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pt(Q["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fc(Q["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ct(Q["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ct(Q["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pt(Q["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class D2 extends no{constructor(t){super(t,A2)}createBucket(t){return new a_(t)}queryRadius(){return fm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:d,geometry:m,transform:_,pixelsToTileUnits:y,pixelPosMatrix:b}){let w=gm(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,y),S=this.paint.get("fill-extrusion-height").evaluate(r,d),I=this.paint.get("fill-extrusion-base").evaluate(r,d),A=function(N,V,G){let K=[];for(let ne of N){let me=[ne.x,ne.y,0,1];kt(me,me,V),K.push(new $e(me[0]/me[3],me[1]/me[3]))}return K}(w,b),L=function(N,V,G,K){let ne=[],me=[],ae=K[8]*V,B=K[9]*V,W=K[10]*V,ce=K[11]*V,Pe=K[8]*G,Ue=K[9]*G,Ie=K[10]*G,Le=K[11]*G;for(let Ze of N){let Ge=[],We=[];for(let Ne of Ze){let ot=Ne.x,vt=Ne.y,_t=K[0]*ot+K[4]*vt+K[12],dt=K[1]*ot+K[5]*vt+K[13],Qt=K[2]*ot+K[6]*vt+K[14],en=K[3]*ot+K[7]*vt+K[15],An=Qt+W,ur=en+ce,Mo=_t+Pe,Hr=dt+Ue,Kn=Qt+Ie,Ki=en+Le,Vn=new $e((_t+ae)/ur,(dt+B)/ur);Vn.z=An/ur,Ge.push(Vn);let Qn=new $e(Mo/Ki,Hr/Ki);Qn.z=Kn/Ki,We.push(Qn)}ne.push(Ge),me.push(We)}return[ne,me]}(m,I,S,b);return function(N,V,G){let K=1/0;ov(G,V)&&(K=Ov(G,V[0]));for(let ne=0;ne<V.length;ne++){let me=V[ne],ae=N[ne];for(let B=0;B<me.length-1;B++){let W=me[B],ce=[W,me[B+1],ae[B+1],ae[B],W];rv(G,ce)&&(K=Math.min(K,Ov(G,ce)))}}return K!==1/0&&K}(L[0],L[1],A)}}function Eh(o,t){return o.x*t.x+o.y*t.y}function Ov(o,t){if(o.length===1){let r=0,d=t[r++],m;for(;!m||d.equals(m);)if(m=t[r++],!m)return 1/0;for(;r<t.length;r++){let _=t[r],y=o[0],b=m.sub(d),w=_.sub(d),S=y.sub(d),I=Eh(b,b),A=Eh(b,w),L=Eh(w,w),N=Eh(S,b),V=Eh(S,w),G=I*L-A*A,K=(L*N-A*V)/G,ne=(I*V-A*N)/G,me=d.z*(1-K-ne)+m.z*K+_.z*ne;if(isFinite(me))return me}return 1/0}{let r=1/0;for(let d of t)r=Math.min(r,d.z);return r}}let R2=Wi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:O2}=R2,F2=Wi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:L2}=F2,z2=Sh.VectorTileFeature.types,B2=Math.cos(Math.PI/180*37.5),Fv=Math.pow(2,14)/.5;class l_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new ct,this.layoutVertexArray2=new Nt,this.indexArray=new fi,this.programConfigurations=new ea(t.layers,t.zoom),this.segments=new gi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,d){this.hasPattern=Qg("line",this.layers,r);let m=this.layers[0].layout.get("line-sort-key"),_=!m.isConstant(),y=[];for(let{feature:b,id:w,index:S,sourceLayerIndex:I}of t){let A=this.layers[0]._featureFilter.needGeometry,L=jc(b,A);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),L,d))continue;let N=_?m.evaluate(L,{},d):void 0,V={id:w,properties:b.properties,type:b.type,sourceLayerIndex:I,index:S,geometry:A?L.geometry:Vc(b),patterns:{},sortKey:N};y.push(V)}_&&y.sort((b,w)=>b.sortKey-w.sortKey);for(let b of y){let{geometry:w,index:S,sourceLayerIndex:I}=b;if(this.hasPattern){let A=Jg("line",this.layers,b,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(b,w,S,d,{},r.subdivisionGranularity);r.featureIndex.insert(t[S].feature,w,S,I,this.index)}}update(t,r,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,d)}addFeatures(t,r,d){for(let m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,r,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,L2)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,O2),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,d,m,_,y){let b=this.layers[0].layout,w=b.get("line-join").evaluate(t,{}),S=b.get("line-cap"),I=b.get("line-miter-limit"),A=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(let L of r)this.addLine(L,t,w,S,I,A,m,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,_,m)}addLine(t,r,d,m,_,y,b,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Gc(t,b?w.line.getGranularityForZoomLevel(b.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<t.length-1;ae++)this.totalDistance+=t[ae].dist(t[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let S=z2[r.type]==="Polygon",I=t.length;for(;I>=2&&t[I-1].equals(t[I-2]);)I--;let A=0;for(;A<I-1&&t[A].equals(t[A+1]);)A++;if(I<(S?3:2))return;d==="bevel"&&(_=1.05);let L=this.overscaling<=16?15*mi/(512*this.overscaling):0,N=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),V,G,K,ne,me;this.e1=this.e2=-1,S&&(V=t[I-2],me=t[A].sub(V)._unit()._perp());for(let ae=A;ae<I;ae++){if(K=ae===I-1?S?t[A+1]:void 0:t[ae+1],K&&t[ae].equals(K))continue;me&&(ne=me),V&&(G=V),V=t[ae],me=K?K.sub(V)._unit()._perp():ne,ne=ne||me;let B=ne.add(me);B.x===0&&B.y===0||B._unit();let W=ne.x*me.x+ne.y*me.y,ce=B.x*me.x+B.y*me.y,Pe=ce!==0?1/ce:1/0,Ue=2*Math.sqrt(2-2*ce),Ie=ce<B2&&G&&K,Le=ne.x*me.y-ne.y*me.x>0;if(Ie&&ae>A){let We=V.dist(G);if(We>2*L){let Ne=V.sub(V.sub(G)._mult(L/We)._round());this.updateDistance(G,Ne),this.addCurrentVertex(Ne,ne,0,0,N),G=Ne}}let Ze=G&&K,Ge=Ze?d:S?"butt":m;if(Ze&&Ge==="round"&&(Pe<y?Ge="miter":Pe<=2&&(Ge="fakeround")),Ge==="miter"&&Pe>_&&(Ge="bevel"),Ge==="bevel"&&(Pe>2&&(Ge="flipbevel"),Pe<_&&(Ge="miter")),G&&this.updateDistance(G,V),Ge==="miter")B._mult(Pe),this.addCurrentVertex(V,B,0,0,N);else if(Ge==="flipbevel"){if(Pe>100)B=me.mult(-1);else{let We=Pe*ne.add(me).mag()/ne.sub(me).mag();B._perp()._mult(We*(Le?-1:1))}this.addCurrentVertex(V,B,0,0,N),this.addCurrentVertex(V,B.mult(-1),0,0,N)}else if(Ge==="bevel"||Ge==="fakeround"){let We=-Math.sqrt(Pe*Pe-1),Ne=Le?We:0,ot=Le?0:We;if(G&&this.addCurrentVertex(V,ne,Ne,ot,N),Ge==="fakeround"){let vt=Math.round(180*Ue/Math.PI/20);for(let _t=1;_t<vt;_t++){let dt=_t/vt;if(dt!==.5){let en=dt-.5;dt+=dt*en*(dt-1)*((1.0904+W*(W*(3.55645-1.43519*W)-3.2452))*en*en+(.848013+W*(.215638*W-1.06021)))}let Qt=me.sub(ne)._mult(dt)._add(ne)._unit()._mult(Le?-1:1);this.addHalfVertex(V,Qt.x,Qt.y,!1,Le,0,N)}}K&&this.addCurrentVertex(V,me,-Ne,-ot,N)}else if(Ge==="butt")this.addCurrentVertex(V,B,0,0,N);else if(Ge==="square"){let We=G?1:-1;this.addCurrentVertex(V,B,We,We,N)}else Ge==="round"&&(G&&(this.addCurrentVertex(V,ne,0,0,N),this.addCurrentVertex(V,ne,1,1,N,!0)),K&&(this.addCurrentVertex(V,me,-1,-1,N,!0),this.addCurrentVertex(V,me,0,0,N)));if(Ie&&ae<I-1){let We=V.dist(K);if(We>2*L){let Ne=V.add(K.sub(V)._mult(L/We)._round());this.updateDistance(V,Ne),this.addCurrentVertex(Ne,me,0,0,N),V=Ne}}}}addCurrentVertex(t,r,d,m,_,y=!1){let b=r.y*m-r.x,w=-r.y-r.x*m;this.addHalfVertex(t,r.x+r.y*d,r.y-r.x*d,y,!1,d,_),this.addHalfVertex(t,b,w,y,!0,-m,_),this.distance>Fv/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,d,m,_,y))}addHalfVertex({x:t,y:r},d,m,_,y,b,w){let S=.5*(this.lineClips?this.scaledDistance*(Fv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(_?1:0),(r<<1)+(y?1:0),Math.round(63*d)+128,Math.round(63*m)+128,1+(b===0?0:b<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let I=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,I,this.e2),w.primitiveLength++),y?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let Lv,zv;nt("LineBucket",l_,{omit:["layers","patternFeatures"]});var Bv={get paint(){return zv=zv||new gn({"line-opacity":new Ct(Q.paint_line["line-opacity"]),"line-color":new Ct(Q.paint_line["line-color"]),"line-translate":new pt(Q.paint_line["line-translate"]),"line-translate-anchor":new pt(Q.paint_line["line-translate-anchor"]),"line-width":new Ct(Q.paint_line["line-width"]),"line-gap-width":new Ct(Q.paint_line["line-gap-width"]),"line-offset":new Ct(Q.paint_line["line-offset"]),"line-blur":new Ct(Q.paint_line["line-blur"]),"line-dasharray":new ch(Q.paint_line["line-dasharray"]),"line-pattern":new Fc(Q.paint_line["line-pattern"]),"line-gradient":new dh(Q.paint_line["line-gradient"])})},get layout(){return Lv=Lv||new gn({"line-cap":new pt(Q.layout_line["line-cap"]),"line-join":new Ct(Q.layout_line["line-join"]),"line-miter-limit":new pt(Q.layout_line["line-miter-limit"]),"line-round-limit":new pt(Q.layout_line["line-round-limit"]),"line-sort-key":new Ct(Q.layout_line["line-sort-key"])})}};class N2 extends Ct{possiblyEvaluate(t,r){return r=new Li(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,d,m){return r=Mn({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,d,m)}}let xm;class V2 extends no{constructor(t){super(t,Bv),this.gradientVersion=0,xm||(xm=new N2(Bv.paint.properties["line-width"].specification),xm.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){let r=this.gradientExpression();this.stepInterpolant=!!function(d){return d._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof Vo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=xm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new l_(t)}queryRadius(t){let r=t,d=Nv(_h("line-width",this,r),_h("line-gap-width",this,r)),m=_h("line-offset",this,r);return d/2+Math.abs(m)+fm(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:d,geometry:m,transform:_,pixelsToTileUnits:y}){let b=gm(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,y),w=y/2*Nv(this.paint.get("line-width").evaluate(r,d),this.paint.get("line-gap-width").evaluate(r,d)),S=this.paint.get("line-offset").evaluate(r,d);return S&&(m=function(I,A){let L=[];for(let N=0;N<I.length;N++){let V=I[N],G=[];for(let K=0;K<V.length;K++){let ne=V[K-1],me=V[K],ae=V[K+1],B=K===0?new $e(0,0):me.sub(ne)._unit()._perp(),W=K===V.length-1?new $e(0,0):ae.sub(me)._unit()._perp(),ce=B._add(W)._unit(),Pe=ce.x*W.x+ce.y*W.y;Pe!==0&&ce._mult(1/Pe),G.push(ce._mult(A)._add(me))}L.push(G)}return L}(m,S*y)),function(I,A,L){for(let N=0;N<A.length;N++){let V=A[N];if(I.length>=3){for(let G=0;G<V.length;G++)if(Uc(I,V[G]))return!0}if(t2(I,V,L))return!0}return!1}(b,m,w)}isTileClipped(){return!0}}function Nv(o,t){return t>0?t+2*o:o}let j2=Wi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),U2=Wi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Wi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let $2=Wi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Wi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let Vv=Wi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),G2=Wi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function H2(o,t,r){return o.sections.forEach(d=>{d.text=function(m,_,y){let b=_.layout.get("text-transform").evaluate(y,{});return b==="uppercase"?m=m.toLocaleUpperCase():b==="lowercase"&&(m=m.toLocaleLowerCase()),ys.applyArabicShaping&&(m=ys.applyArabicShaping(m)),m}(d.text,t,r)}),o}Wi([{name:"triangle",components:3,type:"Uint16"}]),Wi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Wi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Wi([{type:"Float32",name:"offsetX"}]),Wi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Wi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let Th={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var jv,c_,Uv,kn=24,d_={};function Z2(){return jv||(jv=1,d_.read=function(o,t,r,d,m){var _,y,b=8*m-d-1,w=(1<<b)-1,S=w>>1,I=-7,A=r?m-1:0,L=r?-1:1,N=o[t+A];for(A+=L,_=N&(1<<-I)-1,N>>=-I,I+=b;I>0;_=256*_+o[t+A],A+=L,I-=8);for(y=_&(1<<-I)-1,_>>=-I,I+=d;I>0;y=256*y+o[t+A],A+=L,I-=8);if(_===0)_=1-S;else{if(_===w)return y?NaN:1/0*(N?-1:1);y+=Math.pow(2,d),_-=S}return(N?-1:1)*y*Math.pow(2,_-d)},d_.write=function(o,t,r,d,m,_){var y,b,w,S=8*_-m-1,I=(1<<S)-1,A=I>>1,L=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=d?0:_-1,V=d?1:-1,G=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,y=I):(y=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-y))<1&&(y--,w*=2),(t+=y+A>=1?L/w:L*Math.pow(2,1-A))*w>=2&&(y++,w/=2),y+A>=I?(b=0,y=I):y+A>=1?(b=(t*w-1)*Math.pow(2,m),y+=A):(b=t*Math.pow(2,A-1)*Math.pow(2,m),y=0));m>=8;o[r+N]=255&b,N+=V,b/=256,m-=8);for(y=y<<m|b,S+=m;S>0;o[r+N]=255&y,N+=V,y/=256,S-=8);o[r+N-V]|=128*G}),d_}function $v(){if(Uv)return c_;Uv=1,c_=t;var o=Z2();function t(B){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(B)?B:new Uint8Array(B||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=4294967296,d=1/r,m=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function _(B){return B.type===t.Bytes?B.readVarint()+B.pos:B.pos+1}function y(B,W,ce){return ce?4294967296*W+(B>>>0):4294967296*(W>>>0)+(B>>>0)}function b(B,W,ce){var Pe=W<=16383?1:W<=2097151?2:W<=268435455?3:Math.floor(Math.log(W)/(7*Math.LN2));ce.realloc(Pe);for(var Ue=ce.pos-1;Ue>=B;Ue--)ce.buf[Ue+Pe]=ce.buf[Ue]}function w(B,W){for(var ce=0;ce<B.length;ce++)W.writeVarint(B[ce])}function S(B,W){for(var ce=0;ce<B.length;ce++)W.writeSVarint(B[ce])}function I(B,W){for(var ce=0;ce<B.length;ce++)W.writeFloat(B[ce])}function A(B,W){for(var ce=0;ce<B.length;ce++)W.writeDouble(B[ce])}function L(B,W){for(var ce=0;ce<B.length;ce++)W.writeBoolean(B[ce])}function N(B,W){for(var ce=0;ce<B.length;ce++)W.writeFixed32(B[ce])}function V(B,W){for(var ce=0;ce<B.length;ce++)W.writeSFixed32(B[ce])}function G(B,W){for(var ce=0;ce<B.length;ce++)W.writeFixed64(B[ce])}function K(B,W){for(var ce=0;ce<B.length;ce++)W.writeSFixed64(B[ce])}function ne(B,W){return(B[W]|B[W+1]<<8|B[W+2]<<16)+16777216*B[W+3]}function me(B,W,ce){B[ce]=W,B[ce+1]=W>>>8,B[ce+2]=W>>>16,B[ce+3]=W>>>24}function ae(B,W){return(B[W]|B[W+1]<<8|B[W+2]<<16)+(B[W+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(B,W,ce){for(ce=ce||this.length;this.pos<ce;){var Pe=this.readVarint(),Ue=Pe>>3,Ie=this.pos;this.type=7&Pe,B(Ue,W,this),this.pos===Ie&&this.skip(Pe)}return W},readMessage:function(B,W){return this.readFields(B,W,this.readVarint()+this.pos)},readFixed32:function(){var B=ne(this.buf,this.pos);return this.pos+=4,B},readSFixed32:function(){var B=ae(this.buf,this.pos);return this.pos+=4,B},readFixed64:function(){var B=ne(this.buf,this.pos)+ne(this.buf,this.pos+4)*r;return this.pos+=8,B},readSFixed64:function(){var B=ne(this.buf,this.pos)+ae(this.buf,this.pos+4)*r;return this.pos+=8,B},readFloat:function(){var B=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,B},readDouble:function(){var B=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,B},readVarint:function(B){var W,ce,Pe=this.buf;return W=127&(ce=Pe[this.pos++]),ce<128?W:(W|=(127&(ce=Pe[this.pos++]))<<7,ce<128?W:(W|=(127&(ce=Pe[this.pos++]))<<14,ce<128?W:(W|=(127&(ce=Pe[this.pos++]))<<21,ce<128?W:function(Ue,Ie,Le){var Ze,Ge,We=Le.buf;if(Ze=(112&(Ge=We[Le.pos++]))>>4,Ge<128||(Ze|=(127&(Ge=We[Le.pos++]))<<3,Ge<128)||(Ze|=(127&(Ge=We[Le.pos++]))<<10,Ge<128)||(Ze|=(127&(Ge=We[Le.pos++]))<<17,Ge<128)||(Ze|=(127&(Ge=We[Le.pos++]))<<24,Ge<128)||(Ze|=(1&(Ge=We[Le.pos++]))<<31,Ge<128))return y(Ue,Ze,Ie);throw new Error("Expected varint not more than 10 bytes")}(W|=(15&(ce=Pe[this.pos]))<<28,B,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var B=this.readVarint();return B%2==1?(B+1)/-2:B/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var B=this.readVarint()+this.pos,W=this.pos;return this.pos=B,B-W>=12&&m?function(ce,Pe,Ue){return m.decode(ce.subarray(Pe,Ue))}(this.buf,W,B):function(ce,Pe,Ue){for(var Ie="",Le=Pe;Le<Ue;){var Ze,Ge,We,Ne=ce[Le],ot=null,vt=Ne>239?4:Ne>223?3:Ne>191?2:1;if(Le+vt>Ue)break;vt===1?Ne<128&&(ot=Ne):vt===2?(192&(Ze=ce[Le+1]))==128&&(ot=(31&Ne)<<6|63&Ze)<=127&&(ot=null):vt===3?(Ge=ce[Le+2],(192&(Ze=ce[Le+1]))==128&&(192&Ge)==128&&((ot=(15&Ne)<<12|(63&Ze)<<6|63&Ge)<=2047||ot>=55296&&ot<=57343)&&(ot=null)):vt===4&&(Ge=ce[Le+2],We=ce[Le+3],(192&(Ze=ce[Le+1]))==128&&(192&Ge)==128&&(192&We)==128&&((ot=(15&Ne)<<18|(63&Ze)<<12|(63&Ge)<<6|63&We)<=65535||ot>=1114112)&&(ot=null)),ot===null?(ot=65533,vt=1):ot>65535&&(ot-=65536,Ie+=String.fromCharCode(ot>>>10&1023|55296),ot=56320|1023&ot),Ie+=String.fromCharCode(ot),Le+=vt}return Ie}(this.buf,W,B)},readBytes:function(){var B=this.readVarint()+this.pos,W=this.buf.subarray(this.pos,B);return this.pos=B,W},readPackedVarint:function(B,W){if(this.type!==t.Bytes)return B.push(this.readVarint(W));var ce=_(this);for(B=B||[];this.pos<ce;)B.push(this.readVarint(W));return B},readPackedSVarint:function(B){if(this.type!==t.Bytes)return B.push(this.readSVarint());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readSVarint());return B},readPackedBoolean:function(B){if(this.type!==t.Bytes)return B.push(this.readBoolean());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readBoolean());return B},readPackedFloat:function(B){if(this.type!==t.Bytes)return B.push(this.readFloat());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readFloat());return B},readPackedDouble:function(B){if(this.type!==t.Bytes)return B.push(this.readDouble());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readDouble());return B},readPackedFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed32());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readFixed32());return B},readPackedSFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed32());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readSFixed32());return B},readPackedFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed64());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readFixed64());return B},readPackedSFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed64());var W=_(this);for(B=B||[];this.pos<W;)B.push(this.readSFixed64());return B},skip:function(B){var W=7&B;if(W===t.Varint)for(;this.buf[this.pos++]>127;);else if(W===t.Bytes)this.pos=this.readVarint()+this.pos;else if(W===t.Fixed32)this.pos+=4;else{if(W!==t.Fixed64)throw new Error("Unimplemented type: "+W);this.pos+=8}},writeTag:function(B,W){this.writeVarint(B<<3|W)},realloc:function(B){for(var W=this.length||16;W<this.pos+B;)W*=2;if(W!==this.length){var ce=new Uint8Array(W);ce.set(this.buf),this.buf=ce,this.length=W}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(B){this.realloc(4),me(this.buf,B,this.pos),this.pos+=4},writeSFixed32:function(B){this.realloc(4),me(this.buf,B,this.pos),this.pos+=4},writeFixed64:function(B){this.realloc(8),me(this.buf,-1&B,this.pos),me(this.buf,Math.floor(B*d),this.pos+4),this.pos+=8},writeSFixed64:function(B){this.realloc(8),me(this.buf,-1&B,this.pos),me(this.buf,Math.floor(B*d),this.pos+4),this.pos+=8},writeVarint:function(B){(B=+B||0)>268435455||B<0?function(W,ce){var Pe,Ue;if(W>=0?(Pe=W%4294967296|0,Ue=W/4294967296|0):(Ue=~(-W/4294967296),4294967295^(Pe=~(-W%4294967296))?Pe=Pe+1|0:(Pe=0,Ue=Ue+1|0)),W>=18446744073709552e3||W<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ce.realloc(10),function(Ie,Le,Ze){Ze.buf[Ze.pos++]=127&Ie|128,Ie>>>=7,Ze.buf[Ze.pos++]=127&Ie|128,Ie>>>=7,Ze.buf[Ze.pos++]=127&Ie|128,Ie>>>=7,Ze.buf[Ze.pos++]=127&Ie|128,Ze.buf[Ze.pos]=127&(Ie>>>=7)}(Pe,0,ce),function(Ie,Le){var Ze=(7&Ie)<<4;Le.buf[Le.pos++]|=Ze|((Ie>>>=3)?128:0),Ie&&(Le.buf[Le.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Le.buf[Le.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Le.buf[Le.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Le.buf[Le.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Le.buf[Le.pos++]=127&Ie)))))}(Ue,ce)}(B,this):(this.realloc(4),this.buf[this.pos++]=127&B|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=B>>>7&127))))},writeSVarint:function(B){this.writeVarint(B<0?2*-B-1:2*B)},writeBoolean:function(B){this.writeVarint(!!B)},writeString:function(B){B=String(B),this.realloc(4*B.length),this.pos++;var W=this.pos;this.pos=function(Pe,Ue,Ie){for(var Le,Ze,Ge=0;Ge<Ue.length;Ge++){if((Le=Ue.charCodeAt(Ge))>55295&&Le<57344){if(!Ze){Le>56319||Ge+1===Ue.length?(Pe[Ie++]=239,Pe[Ie++]=191,Pe[Ie++]=189):Ze=Le;continue}if(Le<56320){Pe[Ie++]=239,Pe[Ie++]=191,Pe[Ie++]=189,Ze=Le;continue}Le=Ze-55296<<10|Le-56320|65536,Ze=null}else Ze&&(Pe[Ie++]=239,Pe[Ie++]=191,Pe[Ie++]=189,Ze=null);Le<128?Pe[Ie++]=Le:(Le<2048?Pe[Ie++]=Le>>6|192:(Le<65536?Pe[Ie++]=Le>>12|224:(Pe[Ie++]=Le>>18|240,Pe[Ie++]=Le>>12&63|128),Pe[Ie++]=Le>>6&63|128),Pe[Ie++]=63&Le|128)}return Ie}(this.buf,B,this.pos);var ce=this.pos-W;ce>=128&&b(W,ce,this),this.pos=W-1,this.writeVarint(ce),this.pos+=ce},writeFloat:function(B){this.realloc(4),o.write(this.buf,B,this.pos,!0,23,4),this.pos+=4},writeDouble:function(B){this.realloc(8),o.write(this.buf,B,this.pos,!0,52,8),this.pos+=8},writeBytes:function(B){var W=B.length;this.writeVarint(W),this.realloc(W);for(var ce=0;ce<W;ce++)this.buf[this.pos++]=B[ce]},writeRawMessage:function(B,W){this.pos++;var ce=this.pos;B(W,this);var Pe=this.pos-ce;Pe>=128&&b(ce,Pe,this),this.pos=ce-1,this.writeVarint(Pe),this.pos+=Pe},writeMessage:function(B,W,ce){this.writeTag(B,t.Bytes),this.writeRawMessage(W,ce)},writePackedVarint:function(B,W){W.length&&this.writeMessage(B,w,W)},writePackedSVarint:function(B,W){W.length&&this.writeMessage(B,S,W)},writePackedBoolean:function(B,W){W.length&&this.writeMessage(B,L,W)},writePackedFloat:function(B,W){W.length&&this.writeMessage(B,I,W)},writePackedDouble:function(B,W){W.length&&this.writeMessage(B,A,W)},writePackedFixed32:function(B,W){W.length&&this.writeMessage(B,N,W)},writePackedSFixed32:function(B,W){W.length&&this.writeMessage(B,V,W)},writePackedFixed64:function(B,W){W.length&&this.writeMessage(B,G,W)},writePackedSFixed64:function(B,W){W.length&&this.writeMessage(B,K,W)},writeBytesField:function(B,W){this.writeTag(B,t.Bytes),this.writeBytes(W)},writeFixed32Field:function(B,W){this.writeTag(B,t.Fixed32),this.writeFixed32(W)},writeSFixed32Field:function(B,W){this.writeTag(B,t.Fixed32),this.writeSFixed32(W)},writeFixed64Field:function(B,W){this.writeTag(B,t.Fixed64),this.writeFixed64(W)},writeSFixed64Field:function(B,W){this.writeTag(B,t.Fixed64),this.writeSFixed64(W)},writeVarintField:function(B,W){this.writeTag(B,t.Varint),this.writeVarint(W)},writeSVarintField:function(B,W){this.writeTag(B,t.Varint),this.writeSVarint(W)},writeStringField:function(B,W){this.writeTag(B,t.Bytes),this.writeString(W)},writeFloatField:function(B,W){this.writeTag(B,t.Fixed32),this.writeFloat(W)},writeDoubleField:function(B,W){this.writeTag(B,t.Fixed64),this.writeDouble(W)},writeBooleanField:function(B,W){this.writeVarintField(B,!!W)}},c_}var u_=P($v());let h_=3;function W2(o,t,r){o===1&&r.readMessage(q2,t)}function q2(o,t,r){if(o===3){let{id:d,bitmap:m,width:_,height:y,left:b,top:w,advance:S}=r.readMessage(X2,{});t.push({id:d,bitmap:new yh({width:_+2*h_,height:y+2*h_},m),metrics:{width:_,height:y,left:b,top:w,advance:S}})}}function X2(o,t,r){o===1?t.id=r.readVarint():o===2?t.bitmap=r.readBytes():o===3?t.width=r.readVarint():o===4?t.height=r.readVarint():o===5?t.left=r.readSVarint():o===6?t.top=r.readSVarint():o===7&&(t.advance=r.readVarint())}let Y2=h_;function Gv(o){let t=0,r=0;for(let y of o)t+=y.w*y.h,r=Math.max(r,y.w);o.sort((y,b)=>b.h-y.h);let d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],m=0,_=0;for(let y of o)for(let b=d.length-1;b>=0;b--){let w=d[b];if(!(y.w>w.w||y.h>w.h)){if(y.x=w.x,y.y=w.y,_=Math.max(_,y.y+y.h),m=Math.max(m,y.x+y.w),y.w===w.w&&y.h===w.h){let S=d.pop();b<d.length&&(d[b]=S)}else y.h===w.h?(w.x+=y.w,w.w-=y.w):y.w===w.w?(w.y+=y.h,w.h-=y.h):(d.push({x:w.x+y.w,y:w.y,w:w.w-y.w,h:y.h}),w.y+=y.h,w.h-=y.h);break}}return{w:m,h:_,fill:t/(m*_)||0}}let Gr=1;class p_{constructor(t,{pixelRatio:r,version:d,stretchX:m,stretchY:_,content:y,textFitWidth:b,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=m,this.stretchY=_,this.content=y,this.version=d,this.textFitWidth=b,this.textFitHeight=w}get tl(){return[this.paddedRect.x+Gr,this.paddedRect.y+Gr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Gr,this.paddedRect.y+this.paddedRect.h-Gr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Gr)/this.pixelRatio,(this.paddedRect.h-2*Gr)/this.pixelRatio]}}class Hv{constructor(t,r){let d={},m={};this.haveRenderCallbacks=[];let _=[];this.addImages(t,d,_),this.addImages(r,m,_);let{w:y,h:b}=Gv(_),w=new wo({width:y||1,height:b||1});for(let S in t){let I=t[S],A=d[S].paddedRect;wo.copy(I.data,w,{x:0,y:0},{x:A.x+Gr,y:A.y+Gr},I.data)}for(let S in r){let I=r[S],A=m[S].paddedRect,L=A.x+Gr,N=A.y+Gr,V=I.data.width,G=I.data.height;wo.copy(I.data,w,{x:0,y:0},{x:L,y:N},I.data),wo.copy(I.data,w,{x:0,y:G-1},{x:L,y:N-1},{width:V,height:1}),wo.copy(I.data,w,{x:0,y:0},{x:L,y:N+G},{width:V,height:1}),wo.copy(I.data,w,{x:V-1,y:0},{x:L-1,y:N},{width:1,height:G}),wo.copy(I.data,w,{x:0,y:0},{x:L+V,y:N},{width:1,height:G})}this.image=w,this.iconPositions=d,this.patternPositions=m}addImages(t,r,d){for(let m in t){let _=t[m],y={x:0,y:0,w:_.data.width+2*Gr,h:_.data.height+2*Gr};d.push(y),r[m]=new p_(y,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let d in t.updatedImages)this.patchUpdatedImage(this.iconPositions[d],t.getImage(d),r),this.patchUpdatedImage(this.patternPositions[d],t.getImage(d),r)}patchUpdatedImage(t,r,d){if(!t||!r||t.version===r.version)return;t.version=r.version;let[m,_]=t.tl;d.update(r.data,void 0,{x:m,y:_})}}var jl;nt("ImagePosition",p_),nt("ImageAtlas",Hv),h.al=void 0,(jl=h.al||(h.al={}))[jl.none=0]="none",jl[jl.horizontal=1]="horizontal",jl[jl.vertical=2]="vertical",jl[jl.horizontalOnly=3]="horizontalOnly";let wm=-17;class Ih{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,r,d){let m=new Ih;return m.scale=t||1,m.fontStack=r,m.verticalAlign=d||"bottom",m}static forImage(t,r){let d=new Ih;return d.imageName=t,d.verticalAlign=r||"bottom",d}}class Yd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){let d=new Yd;for(let m=0;m<t.sections.length;m++){let _=t.sections[m];_.image?d.addImageSection(_):d.addTextSection(_,r)}return d}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let d=0;d<t.length;d++){let m=t.charCodeAt(d+1)||null,_=t.charCodeAt(d-1)||null;r+=m&&Rc(m)&&!Th[t[d+1]]||_&&Rc(_)&&!Th[t[d-1]]||!Th[t[d]]?t[d]:Th[t[d]]}return r}(this.text)}trim(){let t=0;for(let d=0;d<this.text.length&&Mm[this.text.charCodeAt(d)];d++)t++;let r=this.text.length;for(let d=this.text.length-1;d>=0&&d>=t&&Mm[this.text.charCodeAt(d)];d--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){let d=new Yd;return d.text=this.text.substring(t,r),d.sectionIndex=this.sectionIndex.slice(t,r),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}getMaxImageSize(t){let r=0,d=0;for(let m=0;m<this.length();m++){let _=this.getSection(m);if(_.imageName){let y=t[_.imageName];if(!y)continue;let b=y.displaySize;r=Math.max(r,b[0]),d=Math.max(d,b[1])}}return{maxImageWidth:r,maxImageHeight:d}}addTextSection(t,r){this.text+=t.text,this.sections.push(Ih.forText(t.scale,t.fontStack||r,t.verticalAlign));let d=this.sections.length-1;for(let m=0;m<t.text.length;++m)this.sectionIndex.push(d)}addImageSection(t){let r=t.image?t.image.name:"";if(r.length===0)return void Sn("Can't add FormattedSection with an empty image.");let d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(Ih.forImage(r,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Sn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cm(o,t,r,d,m,_,y,b,w,S,I,A,L,N,V){let G=Yd.fromFeature(o,m),K;A===h.al.vertical&&G.verticalizePunctuation();let{processBidirectionalText:ne,processStyledBidirectionalText:me}=ys;if(ne&&G.sections.length===1){K=[];let W=ne(G.toString(),m_(G,S,_,t,d,N));for(let ce of W){let Pe=new Yd;Pe.text=ce,Pe.sections=G.sections;for(let Ue=0;Ue<ce.length;Ue++)Pe.sectionIndex.push(0);K.push(Pe)}}else if(me){K=[];let W=me(G.text,G.sectionIndex,m_(G,S,_,t,d,N));for(let ce of W){let Pe=new Yd;Pe.text=ce[0],Pe.sectionIndex=ce[1],Pe.sections=G.sections,K.push(Pe)}}else K=function(W,ce){let Pe=[],Ue=W.text,Ie=0;for(let Le of ce)Pe.push(W.substring(Ie,Le)),Ie=Le;return Ie<Ue.length&&Pe.push(W.substring(Ie,Ue.length)),Pe}(G,m_(G,S,_,t,d,N));let ae=[],B={positionedLines:ae,text:G.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(W,ce,Pe,Ue,Ie,Le,Ze,Ge,We,Ne,ot,vt){let _t=0,dt=0,Qt=0,en=0,An=Ge==="right"?1:Ge==="left"?0:.5,ur=kn/vt,Mo=0;for(let Ki of Ie){Ki.trim();let Vn=Ki.getMaxScale(),Qn={positionedGlyphs:[],lineOffset:0};W.positionedLines[Mo]=Qn;let Jn=Qn.positionedGlyphs,Ar=0;if(!Ki.length()){dt+=Le,++Mo;continue}let So=eM(Ue,Ki,ur);for(let Zr=0;Zr<Ki.length();Zr++){let Dn=Ki.getSection(Zr),Un=Ki.getSectionIndex(Zr),$n=Ki.getCharCode(Zr),vn=tM(We,ot,$n),Bi;if(Dn.imageName){if(W.iconsInText=!0,Dn.scale=Dn.scale*ur,Bi=nM(Dn,vn,Vn,So,Ue),!Bi)continue;Ar=Math.max(Ar,Bi.imageOffset)}else if(Bi=iM(Dn,$n,vn,So,ce,Pe),!Bi)continue;let{rect:xs,metrics:eu,baselineOffset:ws}=Bi;Jn.push({glyph:$n,imageName:Dn.imageName,x:_t,y:dt+ws+wm,vertical:vn,scale:Dn.scale,fontStack:Dn.fontStack,sectionIndex:Un,metrics:eu,rect:xs}),vn?(W.verticalizable=!0,_t+=(Dn.imageName?eu.advance:kn)*Dn.scale+Ne):_t+=eu.advance*Dn.scale+Ne}Jn.length!==0&&(Qt=Math.max(_t-Ne,Qt),rM(Jn,0,Jn.length-1,An)),_t=0,Qn.lineOffset=Math.max(Ar,(Vn-1)*kn);let jn=Le*Vn+Ar;dt+=jn,en=Math.max(jn,en),++Mo}let{horizontalAlign:Hr,verticalAlign:Kn}=f_(Ze);(function(Ki,Vn,Qn,Jn,Ar,So,jn,Zr,Dn){let Un=(Vn-Qn)*Ar,$n=0;$n=So!==jn?-Zr*Jn-wm:-Jn*Dn*jn+.5*jn;for(let vn of Ki)for(let Bi of vn.positionedGlyphs)Bi.x+=Un,Bi.y+=$n})(W.positionedLines,An,Hr,Kn,Qt,en,Le,dt,Ie.length),W.top+=-Kn*dt,W.bottom=W.top+dt,W.left+=-Hr*Qt,W.right=W.left+Qt}(B,t,r,d,K,y,b,w,A,S,L,V),!function(W){for(let ce of W)if(ce.positionedGlyphs.length!==0)return!1;return!0}(ae)&&B}let Mm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},K2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Q2={40:!0};function Zv(o,t,r,d,m,_){if(t.imageName){let y=d[t.imageName];return y?y.displaySize[0]*t.scale*kn/_+m:0}{let y=r[t.fontStack],b=y&&y[o];return b?b.metrics.advance*t.scale+m:0}}function Wv(o,t,r,d){let m=Math.pow(o-t,2);return d?o<t?m/2:2*m:m+Math.abs(r)*r}function J2(o,t,r){let d=0;return o===10&&(d-=1e4),r&&(d+=150),o!==40&&o!==65288||(d+=50),t!==41&&t!==65289||(d+=50),d}function qv(o,t,r,d,m,_){let y=null,b=Wv(t,r,m,_);for(let w of d){let S=Wv(t-w.x,r,m,_)+w.badness;S<=b&&(y=w,b=S)}return{index:o,x:t,priorBreak:y,badness:b}}function Xv(o){return o?Xv(o.priorBreak).concat(o.index):[]}function m_(o,t,r,d,m,_){if(!o)return[];let y=[],b=function(A,L,N,V,G,K){let ne=0;for(let me=0;me<A.length();me++){let ae=A.getSection(me);ne+=Zv(A.getCharCode(me),ae,V,G,L,K)}return ne/Math.max(1,Math.ceil(ne/N))}(o,t,r,d,m,_),w=o.text.indexOf("\u200B")>=0,S=0;for(let A=0;A<o.length();A++){let L=o.getSection(A),N=o.getCharCode(A);if(Mm[N]||(S+=Zv(N,L,d,m,t,_)),A<o.length()-1){let V=!((I=N)<11904)&&(!!Yt["CJK Compatibility Forms"](I)||!!Yt["CJK Compatibility"](I)||!!Yt["CJK Strokes"](I)||!!Yt["CJK Symbols and Punctuation"](I)||!!Yt["Enclosed CJK Letters and Months"](I)||!!Yt["Halfwidth and Fullwidth Forms"](I)||!!Yt["Ideographic Description Characters"](I)||!!Yt["Vertical Forms"](I)||ah.test(String.fromCodePoint(I)));(K2[N]||V||L.imageName||A!==o.length()-2&&Q2[o.getCharCode(A+1)])&&y.push(qv(A+1,S,b,y,J2(N,o.getCharCode(A+1),V&&w),!1))}}var I;return Xv(qv(o.length(),S,b,y,0,!0))}function f_(o){let t=.5,r=.5;switch(o){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function eM(o,t,r){let d=t.getMaxScale()*kn,{maxImageWidth:m,maxImageHeight:_}=t.getMaxImageSize(o),y=Math.max(d,_*r);return{verticalLineContentWidth:Math.max(d,m*r),horizontalLineContentHeight:y}}function Yv(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function tM(o,t,r){return!(o===h.al.horizontal||!t&&!Ud(r)||t&&(Mm[r]||(d=r,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(d)))));var d}function iM(o,t,r,d,m,_){let y=_[o.fontStack],b=function(S,I,A,L){if(S&&S.rect)return S;let N=I[A.fontStack],V=N&&N[L];return V?{rect:null,metrics:V.metrics}:null}(y&&y[t],m,o,t);if(b===null)return null;let w;if(r)w=d.verticalLineContentWidth-o.scale*kn;else{let S=Yv(o.verticalAlign);w=(d.horizontalLineContentHeight-o.scale*kn)*S}return{rect:b.rect,metrics:b.metrics,baselineOffset:w}}function nM(o,t,r,d,m){let _=m[o.imageName];if(!_)return null;let y=_.paddedRect,b=_.displaySize,w={width:b[0],height:b[1],left:Gr,top:-3,advance:t?b[1]:b[0]},S;if(t)S=d.verticalLineContentWidth-b[1]*o.scale;else{let I=Yv(o.verticalAlign);S=(d.horizontalLineContentHeight-b[1]*o.scale)*I}return{rect:y,metrics:w,baselineOffset:S,imageOffset:(t?b[0]:b[1])*o.scale-kn*r}}function rM(o,t,r,d){if(d===0)return;let m=o[r],_=(o[r].x+m.metrics.advance*m.scale)*d;for(let y=t;y<=r;y++)o[y].x-=_}function oM(o,t,r){let{horizontalAlign:d,verticalAlign:m}=f_(r),_=t[0]-o.displaySize[0]*d,y=t[1]-o.displaySize[1]*m;return{image:o,top:y,bottom:y+o.displaySize[1],left:_,right:_+o.displaySize[0]}}function Kv(o){var t,r;let d=o.left,m=o.top,_=o.right-d,y=o.bottom-m,b=(t=o.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(r=o.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",S=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(w==="proportional"){if(b==="stretchOnly"&&_/y<S||b==="proportional"){let I=Math.ceil(y*S);d*=I/_,_=I}}else if(b==="proportional"&&w==="stretchOnly"&&S!==0&&_/y>S){let I=Math.ceil(_/S);m*=I/y,y=I}return{x1:d,y1:m,x2:d+_,y2:m+y}}function Qv(o,t,r,d,m,_){let y=o.image,b;if(y.content){let K=y.content,ne=y.pixelRatio||1;b=[K[0]/ne,K[1]/ne,y.displaySize[0]-K[2]/ne,y.displaySize[1]-K[3]/ne]}let w=t.left*_,S=t.right*_,I,A,L,N;r==="width"||r==="both"?(N=m[0]+w-d[3],A=m[0]+S+d[1]):(N=m[0]+(w+S-y.displaySize[0])/2,A=N+y.displaySize[0]);let V=t.top*_,G=t.bottom*_;return r==="height"||r==="both"?(I=m[1]+V-d[0],L=m[1]+G+d[2]):(I=m[1]+(V+G-y.displaySize[1])/2,L=I+y.displaySize[1]),{image:y,top:I,right:A,bottom:L,left:N,collisionPadding:b}}let kh=255,ta=128,Ul=kh*ta;function Jv(o,t){let{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Li(o+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:d,interpolationType:m}=r,_=0;for(;_<d.length&&d[_]<=o;)_++;_=Math.max(0,_-1);let y=_;for(;y<d.length&&d[y]<o+1;)y++;y=Math.min(d.length-1,y);let b=d[_],w=d[y];return r.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:w,interpolationType:m}:{kind:"camera",minZoom:b,maxZoom:w,minSize:r.evaluate(new Li(b)),maxSize:r.evaluate(new Li(w)),interpolationType:m}}}function g_(o,t,r){let d="never",m=o.get(t);return m?d=m:o.get(r)&&(d="always"),d}let sM=Sh.VectorTileFeature.types,aM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sm(o,t,r,d,m,_,y,b,w,S,I,A,L){let N=b?Math.min(Ul,Math.round(b[0])):0,V=b?Math.min(Ul,Math.round(b[1])):0;o.emplaceBack(t,r,Math.round(32*d),Math.round(32*m),_,y,(N<<1)+(w?1:0),V,16*S,16*I,256*A,256*L)}function __(o,t,r){o.emplaceBack(t.x,t.y,r),o.emplaceBack(t.x,t.y,r),o.emplaceBack(t.x,t.y,r),o.emplaceBack(t.x,t.y,r)}function lM(o){for(let t of o.sections)if(Ug(t.text))return!0;return!1}class y_{constructor(t){this.layoutVertexArray=new qi,this.indexArray=new fi,this.programConfigurations=t,this.segments=new gi,this.dynamicLayoutVertexArray=new Ei,this.opacityVertexArray=new Xi,this.hasVisibleVertices=!1,this.placedSymbolArray=new ue}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,d,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,j2.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,U2.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,aM,!0),this.opacityVertexBuffer.itemSize=1),(d||m)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}nt("SymbolBuffers",y_);class v_{constructor(t,r,d){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new d,this.segments=new gi,this.collisionVertexArray=new Ai}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,$2.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}nt("CollisionBuffers",v_);class Kd{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jv(this.zoom,r["text-size"]),this.iconSizeData=Jv(this.zoom,r["icon-size"]);let d=this.layers[0].layout,m=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=g_(d,"text-overlap","text-allow-overlap")!=="never"||g_(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(y=>h.al[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID}createArrays(){this.text=new y_(new ea(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new y_(new ea(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new _e,this.lineVertexArray=new pe,this.symbolInstances=new he,this.textAnchorOffsets=new Be}calculateGlyphDependencies(t,r,d,m,_){for(let y=0;y<t.length;y++)if(r[t.charCodeAt(y)]=!0,(d||m)&&_){let b=Th[t.charAt(y)];b&&(r[b.charCodeAt(0)]=!0)}}populate(t,r,d){let m=this.layers[0],_=m.layout,y=_.get("text-font"),b=_.get("text-field"),w=_.get("icon-image"),S=(b.value.kind!=="constant"||b.value.value instanceof qn&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),I=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,A=_.get("symbol-sort-key");if(this.features=[],!S&&!I)return;let L=r.iconDependencies,N=r.glyphDependencies,V=r.availableImages,G=new Li(this.zoom);for(let{feature:K,id:ne,index:me,sourceLayerIndex:ae}of t){let B=m._featureFilter.needGeometry,W=jc(K,B);if(!m._featureFilter.filter(G,W,d))continue;let ce,Pe;if(B||(W.geometry=Vc(K)),S){let Ie=m.getValueAndResolveTokens("text-field",W,d,V),Le=qn.factory(Ie),Ze=this.hasRTLText=this.hasRTLText||lM(Le);(!Ze||ys.getRTLTextPluginStatus()==="unavailable"||Ze&&ys.isParsed())&&(ce=H2(Le,m,W))}if(I){let Ie=m.getValueAndResolveTokens("icon-image",W,d,V);Pe=Ie instanceof yr?Ie:yr.fromString(Ie)}if(!ce&&!Pe)continue;let Ue=this.sortFeaturesByKey?A.evaluate(W,{},d):void 0;if(this.features.push({id:ne,text:ce,icon:Pe,index:me,sourceLayerIndex:ae,geometry:W.geometry,properties:K.properties,type:sM[K.type],sortKey:Ue}),Pe&&(L[Pe.name]=!0),ce){let Ie=y.evaluate(W,{},d).join(","),Le=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(h.al.vertical)>=0;for(let Ze of ce.sections)if(Ze.image)L[Ze.image.name]=!0;else{let Ge=jd(ce.toString()),We=Ze.fontStack||Ie,Ne=N[We]=N[We]||{};this.calculateGlyphDependencies(Ze.text,Ne,Le,this.allowVerticalPlacement,Ge)}}}_.get("symbol-placement")==="line"&&(this.features=function(K){let ne={},me={},ae=[],B=0;function W(Ie){ae.push(K[Ie]),B++}function ce(Ie,Le,Ze){let Ge=me[Ie];return delete me[Ie],me[Le]=Ge,ae[Ge].geometry[0].pop(),ae[Ge].geometry[0]=ae[Ge].geometry[0].concat(Ze[0]),Ge}function Pe(Ie,Le,Ze){let Ge=ne[Le];return delete ne[Le],ne[Ie]=Ge,ae[Ge].geometry[0].shift(),ae[Ge].geometry[0]=Ze[0].concat(ae[Ge].geometry[0]),Ge}function Ue(Ie,Le,Ze){let Ge=Ze?Le[0][Le[0].length-1]:Le[0][0];return`${Ie}:${Ge.x}:${Ge.y}`}for(let Ie=0;Ie<K.length;Ie++){let Le=K[Ie],Ze=Le.geometry,Ge=Le.text?Le.text.toString():null;if(!Ge){W(Ie);continue}let We=Ue(Ge,Ze),Ne=Ue(Ge,Ze,!0);if(We in me&&Ne in ne&&me[We]!==ne[Ne]){let ot=Pe(We,Ne,Ze),vt=ce(We,Ne,ae[ot].geometry);delete ne[We],delete me[Ne],me[Ue(Ge,ae[vt].geometry,!0)]=vt,ae[ot].geometry=null}else We in me?ce(We,Ne,Ze):Ne in ne?Pe(We,Ne,Ze):(W(Ie),ne[We]=B-1,me[Ne]=B-1)}return ae.filter(Ie=>Ie.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((K,ne)=>K.sortKey-ne.sortKey)}update(t,r,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,d),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){let d=this.lineVertexArray.length;if(t.segment!==void 0){let m=t.dist(r[t.segment+1]),_=t.dist(r[t.segment]),y={};for(let b=t.segment+1;b<r.length;b++)y[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:m},b<r.length-1&&(m+=r[b+1].dist(r[b]));for(let b=t.segment||0;b>=0;b--)y[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:_},b>0&&(_+=r[b-1].dist(r[b]));for(let b=0;b<r.length;b++){let w=y[b];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(t,r,d,m,_,y,b,w,S,I,A,L){let N=t.indexArray,V=t.layoutVertexArray,G=t.segments.prepareSegment(4*r.length,V,N,this.canOverlap?y.sortKey:void 0),K=this.glyphOffsetArray.length,ne=G.vertexLength,me=this.allowVerticalPlacement&&b===h.al.vertical?Math.PI/2:0,ae=y.text&&y.text.sections;for(let B=0;B<r.length;B++){let{tl:W,tr:ce,bl:Pe,br:Ue,tex:Ie,pixelOffsetTL:Le,pixelOffsetBR:Ze,minFontScaleX:Ge,minFontScaleY:We,glyphOffset:Ne,isSDF:ot,sectionIndex:vt}=r[B],_t=G.vertexLength,dt=Ne[1];Sm(V,w.x,w.y,W.x,dt+W.y,Ie.x,Ie.y,d,ot,Le.x,Le.y,Ge,We),Sm(V,w.x,w.y,ce.x,dt+ce.y,Ie.x+Ie.w,Ie.y,d,ot,Ze.x,Le.y,Ge,We),Sm(V,w.x,w.y,Pe.x,dt+Pe.y,Ie.x,Ie.y+Ie.h,d,ot,Le.x,Ze.y,Ge,We),Sm(V,w.x,w.y,Ue.x,dt+Ue.y,Ie.x+Ie.w,Ie.y+Ie.h,d,ot,Ze.x,Ze.y,Ge,We),__(t.dynamicLayoutVertexArray,w,me),N.emplaceBack(_t,_t+2,_t+1),N.emplaceBack(_t+1,_t+2,_t+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ne[0]),B!==r.length-1&&vt===r[B+1].sectionIndex||t.programConfigurations.populatePaintArrays(V.length,y,y.index,{},L,ae&&ae[vt])}t.placedSymbolArray.emplaceBack(w.x,w.y,K,this.glyphOffsetArray.length-K,ne,S,I,w.segment,d?d[0]:0,d?d[1]:0,m[0],m[1],b,0,!1,0,A)}_addCollisionDebugVertex(t,r,d,m,_,y){return r.emplaceBack(0,0),t.emplaceBack(d.x,d.y,m,_,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,r,d,m,_,y,b){let w=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),S=w.vertexLength,I=_.layoutVertexArray,A=_.collisionVertexArray,L=b.anchorX,N=b.anchorY;this._addCollisionDebugVertex(I,A,y,L,N,new $e(t,r)),this._addCollisionDebugVertex(I,A,y,L,N,new $e(d,r)),this._addCollisionDebugVertex(I,A,y,L,N,new $e(d,m)),this._addCollisionDebugVertex(I,A,y,L,N,new $e(t,m)),w.vertexLength+=4;let V=_.indexArray;V.emplaceBack(S,S+1),V.emplaceBack(S+1,S+2),V.emplaceBack(S+2,S+3),V.emplaceBack(S+3,S),w.primitiveLength+=4}addDebugCollisionBoxes(t,r,d,m){for(let _=t;_<r;_++){let y=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,m?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new v_(Yi,Vv.members,In),this.iconCollisionBox=new v_(Yi,Vv.members,In);for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,d,m,_,y,b,w,S){let I={};for(let A=r;A<d;A++){let L=t.get(A);I.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.textFeatureIndex=L.featureIndex;break}for(let A=m;A<_;A++){let L=t.get(A);I.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.verticalTextFeatureIndex=L.featureIndex;break}for(let A=y;A<b;A++){let L=t.get(A);I.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.iconFeatureIndex=L.featureIndex;break}for(let A=w;A<S;A++){let L=t.get(A);I.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.verticalIconFeatureIndex=L.featureIndex;break}return I}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let d=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){let d=t.placedSymbolArray.get(r),m=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<m;_+=4)t.indexArray.emplaceBack(_,_+2,_+1),t.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(t),d=Math.cos(t),m=[],_=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);let w=this.symbolInstances.get(b);m.push(0|Math.round(r*w.anchorX+d*w.anchorY)),_.push(w.featureIndex)}return y.sort((b,w)=>m[b]-m[w]||_[w]-_[b]),y}addToSortKeyRanges(t,r){let d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===r?d.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let d=this.symbolInstances.get(r);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((m,_,y)=>{m>=0&&y.indexOf(m)===_&&this.addIndicesForPlacedSymbol(this.text,m)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let eb,tb;nt("SymbolBucket",Kd,{omit:["layers","collisionBoxArray","features","compareText"]}),Kd.MAX_GLYPHS=65535,Kd.addDynamicAttributes=__;var b_={get paint(){return tb=tb||new gn({"icon-opacity":new Ct(Q.paint_symbol["icon-opacity"]),"icon-color":new Ct(Q.paint_symbol["icon-color"]),"icon-halo-color":new Ct(Q.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ct(Q.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ct(Q.paint_symbol["icon-halo-blur"]),"icon-translate":new pt(Q.paint_symbol["icon-translate"]),"icon-translate-anchor":new pt(Q.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ct(Q.paint_symbol["text-opacity"]),"text-color":new Ct(Q.paint_symbol["text-color"],{runtimeType:Tt,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Ct(Q.paint_symbol["text-halo-color"]),"text-halo-width":new Ct(Q.paint_symbol["text-halo-width"]),"text-halo-blur":new Ct(Q.paint_symbol["text-halo-blur"]),"text-translate":new pt(Q.paint_symbol["text-translate"]),"text-translate-anchor":new pt(Q.paint_symbol["text-translate-anchor"])})},get layout(){return eb=eb||new gn({"symbol-placement":new pt(Q.layout_symbol["symbol-placement"]),"symbol-spacing":new pt(Q.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pt(Q.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ct(Q.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pt(Q.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pt(Q.layout_symbol["icon-allow-overlap"]),"icon-overlap":new pt(Q.layout_symbol["icon-overlap"]),"icon-ignore-placement":new pt(Q.layout_symbol["icon-ignore-placement"]),"icon-optional":new pt(Q.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pt(Q.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ct(Q.layout_symbol["icon-size"]),"icon-text-fit":new pt(Q.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pt(Q.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ct(Q.layout_symbol["icon-image"]),"icon-rotate":new Ct(Q.layout_symbol["icon-rotate"]),"icon-padding":new Ct(Q.layout_symbol["icon-padding"]),"icon-keep-upright":new pt(Q.layout_symbol["icon-keep-upright"]),"icon-offset":new Ct(Q.layout_symbol["icon-offset"]),"icon-anchor":new Ct(Q.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pt(Q.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pt(Q.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pt(Q.layout_symbol["text-rotation-alignment"]),"text-field":new Ct(Q.layout_symbol["text-field"]),"text-font":new Ct(Q.layout_symbol["text-font"]),"text-size":new Ct(Q.layout_symbol["text-size"]),"text-max-width":new Ct(Q.layout_symbol["text-max-width"]),"text-line-height":new pt(Q.layout_symbol["text-line-height"]),"text-letter-spacing":new Ct(Q.layout_symbol["text-letter-spacing"]),"text-justify":new Ct(Q.layout_symbol["text-justify"]),"text-radial-offset":new Ct(Q.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pt(Q.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ct(Q.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ct(Q.layout_symbol["text-anchor"]),"text-max-angle":new pt(Q.layout_symbol["text-max-angle"]),"text-writing-mode":new pt(Q.layout_symbol["text-writing-mode"]),"text-rotate":new Ct(Q.layout_symbol["text-rotate"]),"text-padding":new pt(Q.layout_symbol["text-padding"]),"text-keep-upright":new pt(Q.layout_symbol["text-keep-upright"]),"text-transform":new Ct(Q.layout_symbol["text-transform"]),"text-offset":new Ct(Q.layout_symbol["text-offset"]),"text-allow-overlap":new pt(Q.layout_symbol["text-allow-overlap"]),"text-overlap":new pt(Q.layout_symbol["text-overlap"]),"text-ignore-placement":new pt(Q.layout_symbol["text-ignore-placement"]),"text-optional":new pt(Q.layout_symbol["text-optional"])})}};class ib{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Mt,this.defaultValue=t}evaluate(t){if(t.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nt("FormatSectionOverride",ib,{omit:["defaultValue"]});class Pm extends no{constructor(t){super(t,b_)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let d=this.layout.get("text-writing-mode");if(d){let m=[];for(let _ of d)m.indexOf(_)<0&&m.push(_);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,d,m){let _=this.layout.get(t).evaluate(r,{},d,m),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||Ba(y.value)||!_?_:function(b,w){return w.replace(/{([^{}]+)}/g,(S,I)=>b&&I in b?String(b[I]):"")}(r.properties,_)}createBucket(t){return new Kd(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let t of b_.paint.overridableProperties){if(!Pm.hasPaintOverride(this.layout,t))continue;let r=this.paint.get(t),d=new ib(r),m=new Pl(d,r.property.specification),_=null;_=r.value.kind==="constant"||r.value.kind==="source"?new kr("source",m):new gs("composite",m,r.value.zoomStops),this.paint._values[t]=new vr(r.property,_,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,d){return!(!this.layout||r.isDataDriven()||d.isDataDriven())&&Pm.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){let d=t.get("text-field"),m=b_.paint.properties[r],_=!1,y=b=>{for(let w of b)if(m.overrides&&m.overrides.hasOverride(w))return void(_=!0)};if(d.value.kind==="constant"&&d.value.value instanceof qn)y(d.value.value.sections);else if(d.value.kind==="source"){let b=S=>{_||(S instanceof Et&&Gi(S.value)===pa?y(S.value.sections):S instanceof ml?y(S.sections):S.eachChild(b))},w=d.value;w._styleExpression&&b(w._styleExpression.expression)}return _}}let nb;var cM={get paint(){return nb=nb||new gn({"background-color":new pt(Q.paint_background["background-color"]),"background-pattern":new ch(Q.paint_background["background-pattern"]),"background-opacity":new pt(Q.paint_background["background-opacity"])})}};class dM extends no{constructor(t){super(t,cM)}}let rb;var uM={get paint(){return rb=rb||new gn({"raster-opacity":new pt(Q.paint_raster["raster-opacity"]),"raster-hue-rotate":new pt(Q.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pt(Q.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pt(Q.paint_raster["raster-brightness-max"]),"raster-saturation":new pt(Q.paint_raster["raster-saturation"]),"raster-contrast":new pt(Q.paint_raster["raster-contrast"]),"raster-resampling":new pt(Q.paint_raster["raster-resampling"]),"raster-fade-duration":new pt(Q.paint_raster["raster-fade-duration"])})}};class hM extends no{constructor(t){super(t,uM)}}class pM extends no{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class mM{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let fM={once:!0},x_=63710088e-1;class $l{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $l(mr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){let r=Math.PI/180,d=this.lat*r,m=t.lat*r,_=Math.sin(d)*Math.sin(m)+Math.cos(d)*Math.cos(m)*Math.cos((t.lng-this.lng)*r);return x_*Math.acos(Math.min(_,1))}static convert(t){if(t instanceof $l)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new $l(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new $l(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let ob=2*Math.PI*x_;function sb(o){return ob*Math.cos(o*Math.PI/180)}function ab(o){return(180+o)/360}function lb(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function cb(o,t){return o/sb(t)}function w_(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function db(o,t){return o*sb(w_(t))}class Ah{constructor(t,r,d=0){this.x=+t,this.y=+r,this.z=+d}static fromLngLat(t,r=0){let d=$l.convert(t);return new Ah(ab(d.lng),lb(d.lat),cb(r,d.lat))}toLngLat(){return new $l(360*this.x-180,w_(this.y))}toAltitude(){return db(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ob*(t=w_(this.y),1/Math.cos(t*Math.PI/180));var t}}function ub(o,t,r){var d=2*Math.PI*6378137/256/Math.pow(2,r);return[o*d-2*Math.PI*6378137/2,t*d-2*Math.PI*6378137/2]}class C_{constructor(t,r,d){if(!function(m,_,y){return!(m<0||m>25||y<0||y>=Math.pow(2,m)||_<0||_>=Math.pow(2,m))}(t,r,d))throw new Error(`x=${r}, y=${d}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=d,this.key=Qd(0,t,t,r,d)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,d){let m=(y=this.y,b=this.z,w=ub(256*(_=this.x),256*(y=Math.pow(2,b)-y-1),b),S=ub(256*(_+1),256*(y+1),b),w[0]+","+w[1]+","+S[0]+","+S[1]);var _,y,b,w,S;let I=function(A,L,N){let V,G="";for(let K=A;K>0;K--)V=1<<K-1,G+=(L&V?1:0)+(N&V?2:0);return G}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,m)}isChildOf(t){let r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){let r=Math.pow(2,this.z);return new $e((t.x*r-this.x)*mi,(t.y*r-this.y)*mi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class hb{constructor(t,r){this.wrap=t,this.canonical=r,this.key=Qd(t,r.z,r.z,r.x,r.y)}}class Co{constructor(t,r,d,m,_){if(this.terrainRttPosMatrix32f=null,t<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${d}`);this.overscaledZ=t,this.wrap=r,this.canonical=new C_(d,+m,+_),this.key=Qd(r,t,d,m,_)}clone(){return new Co(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-t;return t>this.canonical.z?new Co(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Co(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let d=this.canonical.z-t;return t>this.canonical.z?Qd(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Qd(this.wrap*+r,t,t,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(t){if(t.wrap!==this.wrap)return!1;let r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Co(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,d=2*this.canonical.x,m=2*this.canonical.y;return[new Co(r,this.wrap,r,d,m),new Co(r,this.wrap,r,d+1,m),new Co(r,this.wrap,r,d,m+1),new Co(r,this.wrap,r,d+1,m+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Co(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Co(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new hb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Ah(t.x-this.wrap,t.y))}}function Qd(o,t,r,d,m){(o*=2)<0&&(o=-1*o-1);let _=1<<r;return(_*_*o+_*m+d).toString(36)+r.toString(36)+t.toString(36)}nt("CanonicalTileID",C_),nt("OverscaledTileID",Co,{omit:["terrainRttPosMatrix32f"]});class pb{constructor(t,r,d,m=1,_=1,y=1,b=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void Sn(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;let w=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=_,this.blueFactor=y,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let S=0;S<w;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(w,S)]=this.data[this._idx(w-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,w)]=this.data[this._idx(S,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let S=0;S<w;S++)for(let I=0;I<w;I++){let A=this.get(S,I);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(t,r){let d=new Uint8Array(this.data.buffer),m=4*this._idx(t,r);return this.unpack(d[m],d[m+1],d[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,d){return t*this.redFactor+r*this.greenFactor+d*this.blueFactor-this.baseShift}getPixels(){return new wo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,d){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let m=r*this.dim,_=r*this.dim+this.dim,y=d*this.dim,b=d*this.dim+this.dim;switch(r){case-1:m=_-1;break;case 1:_=m+1}switch(d){case-1:y=b-1;break;case 1:b=y+1}let w=-r*this.dim,S=-d*this.dim;for(let I=y;I<b;I++)for(let A=m;A<_;A++)this.data[this._idx(A,I)]=t.data[this._idx(A+w,I+S)]}}nt("DEMData",pb);class mb{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){let d=t[r];this._stringToNumber[d]=r,this._numberToString[r]=d}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class fb{constructor(t,r,d,m,_){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=d,t._y=m,this.properties=t.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){let t={geometry:this.geometry};for(let r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class gb{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new zl(mi,16,0),this.grid3D=new zl(mi,16,0),this.featureIndexArray=new Ae,this.promoteId=r}insert(t,r,d,m,_,y){let b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,m,_);let w=y?this.grid3D:this.grid;for(let S=0;S<r.length;S++){let I=r[S],A=[1/0,1/0,-1/0,-1/0];for(let L=0;L<I.length;L++){let N=I[L];A[0]=Math.min(A[0],N.x),A[1]=Math.min(A[1],N.y),A[2]=Math.max(A[2],N.x),A[3]=Math.max(A[3],N.y)}A[0]<mi&&A[1]<mi&&A[2]>=0&&A[3]>=0&&w.insert(b,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Sh.VectorTile(new u_(this.rawTileData)).layers,this.sourceLayerCoder=new mb(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,d,m){this.loadVTLayers();let _=t.params,y=mi/t.tileSize/t.scale,b=Ua(_.filter),w=t.queryGeometry,S=t.queryPadding*y,I=yb(w),A=this.grid.query(I.minX-S,I.minY-S,I.maxX+S,I.maxY+S),L=yb(t.cameraQueryGeometry),N=this.grid3D.query(L.minX-S,L.minY-S,L.maxX+S,L.maxY+S,(K,ne,me,ae)=>function(B,W,ce,Pe,Ue){for(let Le of B)if(W<=Le.x&&ce<=Le.y&&Pe>=Le.x&&Ue>=Le.y)return!0;let Ie=[new $e(W,ce),new $e(W,Ue),new $e(Pe,Ue),new $e(Pe,ce)];if(B.length>2){for(let Le of Ie)if(Uc(B,Le))return!0}for(let Le=0;Le<B.length-1;Le++)if(n2(B[Le],B[Le+1],Ie))return!0;return!1}(t.cameraQueryGeometry,K-S,ne-S,me+S,ae+S));for(let K of N)A.push(K);A.sort(gM);let V={},G;for(let K=0;K<A.length;K++){let ne=A[K];if(ne===G)continue;G=ne;let me=this.featureIndexArray.get(ne),ae=null;this.loadMatchingFeature(V,me.bucketIndex,me.sourceLayerIndex,me.featureIndex,b,_.layers,_.availableImages,r,d,m,(B,W,ce)=>(ae||(ae=Vc(B)),W.queryIntersectsFeature({queryGeometry:w,feature:B,featureState:ce,geometry:ae,zoom:this.z,transform:t.transform,pixelsToTileUnits:y,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return V}loadMatchingFeature(t,r,d,m,_,y,b,w,S,I,A){let L=this.bucketLayerIDs[r];if(y&&!L.some(K=>y.has(K)))return;let N=this.sourceLayerCoder.decode(d),V=this.vtLayers[N].feature(m);if(_.needGeometry){let K=jc(V,!0);if(!_.filter(new Li(this.tileID.overscaledZ),K,this.tileID.canonical))return}else if(!_.filter(new Li(this.tileID.overscaledZ),V))return;let G=this.getId(V,N);for(let K=0;K<L.length;K++){let ne=L[K];if(y&&!y.has(ne))continue;let me=w[ne];if(!me)continue;let ae={};G&&I&&(ae=I.getState(me.sourceLayer||"_geojsonTileLayer",G));let B=Mn({},S[ne]);B.paint=_b(B.paint,me.paint,V,ae,b),B.layout=_b(B.layout,me.layout,V,ae,b);let W=!A||A(V,me,ae);if(!W)continue;let ce=new fb(V,this.z,this.x,this.y,G);ce.layer=B;let Pe=t[ne];Pe===void 0&&(Pe=t[ne]=[]),Pe.push({featureIndex:m,feature:ce,intersectionZ:W})}}lookupSymbolFeatures(t,r,d,m,_,y,b,w){let S={};this.loadVTLayers();let I=Ua(_);for(let A of t)this.loadMatchingFeature(S,d,m,A,I,y,b,w,r);return S}hasLayer(t){for(let r of this.bucketLayerIDs)for(let d of r)if(t===d)return!0;return!1}getId(t,r){var d;let m=t.id;return this.promoteId&&(m=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((d=t.properties)===null||d===void 0)&&d.cluster)&&this.promoteId&&(m=Number(t.properties.cluster_id))),m}}function _b(o,t,r,d,m){return Yr(o,(_,y)=>{let b=t instanceof Gd?t.get(y):null;return b&&b.evaluate?b.evaluate(r,d,m):b})}function yb(o){let t=1/0,r=1/0,d=-1/0,m=-1/0;for(let _ of o)t=Math.min(t,_.x),r=Math.min(r,_.y),d=Math.max(d,_.x),m=Math.max(m,_.y);return{minX:t,minY:r,maxX:d,maxY:m}}function gM(o,t){return t-o}function vb(o,t,r,d,m){let _=[];for(let y=0;y<o.length;y++){let b=o[y],w;for(let S=0;S<b.length-1;S++){let I=b[S],A=b[S+1];I.x<t&&A.x<t||(I.x<t?I=new $e(t,I.y+(t-I.x)/(A.x-I.x)*(A.y-I.y))._round():A.x<t&&(A=new $e(t,I.y+(t-I.x)/(A.x-I.x)*(A.y-I.y))._round()),I.y<r&&A.y<r||(I.y<r?I=new $e(I.x+(r-I.y)/(A.y-I.y)*(A.x-I.x),r)._round():A.y<r&&(A=new $e(I.x+(r-I.y)/(A.y-I.y)*(A.x-I.x),r)._round()),I.x>=d&&A.x>=d||(I.x>=d?I=new $e(d,I.y+(d-I.x)/(A.x-I.x)*(A.y-I.y))._round():A.x>=d&&(A=new $e(d,I.y+(d-I.x)/(A.x-I.x)*(A.y-I.y))._round()),I.y>=m&&A.y>=m||(I.y>=m?I=new $e(I.x+(m-I.y)/(A.y-I.y)*(A.x-I.x),m)._round():A.y>=m&&(A=new $e(I.x+(m-I.y)/(A.y-I.y)*(A.x-I.x),m)._round()),w&&I.equals(w[w.length-1])||(w=[I],_.push(w)),w.push(A)))))}}return _}nt("FeatureIndex",gb,{omit:["rawTileData","sourceLayerCoder"]});class Gl extends $e{constructor(t,r,d,m){super(t,r),this.angle=d,m!==void 0&&(this.segment=m)}clone(){return new Gl(this.x,this.y,this.angle,this.segment)}}function bb(o,t,r,d,m){if(t.segment===void 0||r===0)return!0;let _=t,y=t.segment+1,b=0;for(;b>-r/2;){if(y--,y<0)return!1;b-=o[y].dist(_),_=o[y]}b+=o[y].dist(o[y+1]),y++;let w=[],S=0;for(;b<r/2;){let I=o[y],A=o[y+1];if(!A)return!1;let L=o[y-1].angleTo(I)-I.angleTo(A);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:b,angleDelta:L}),S+=L;b-w[0].distance>d;)S-=w.shift().angleDelta;if(S>m)return!1;y++,b+=I.dist(A)}return!0}function xb(o){let t=0;for(let r=0;r<o.length-1;r++)t+=o[r].dist(o[r+1]);return t}function wb(o,t,r){return o?.6*t*r:0}function Cb(o,t){return Math.max(o?o.right-o.left:0,t?t.right-t.left:0)}function _M(o,t,r,d,m,_){let y=wb(r,m,_),b=Cb(r,d)*_,w=0,S=xb(o)/2;for(let I=0;I<o.length-1;I++){let A=o[I],L=o[I+1],N=A.dist(L);if(w+N>S){let V=(S-w)/N,G=eo.number(A.x,L.x,V),K=eo.number(A.y,L.y,V),ne=new Gl(G,K,L.angleTo(A),I);return ne._round(),!y||bb(o,ne,b,y,t)?ne:void 0}w+=N}}function yM(o,t,r,d,m,_,y,b,w){let S=wb(d,_,y),I=Cb(d,m),A=I*y,L=o[0].x===0||o[0].x===w||o[0].y===0||o[0].y===w;return t-A<t/4&&(t=A+t/4),Mb(o,L?t/2*b%t:(I/2+2*_)*y*b%t,t,S,r,A,L,!1,w)}function Mb(o,t,r,d,m,_,y,b,w){let S=_/2,I=xb(o),A=0,L=t-r,N=[];for(let V=0;V<o.length-1;V++){let G=o[V],K=o[V+1],ne=G.dist(K),me=K.angleTo(G);for(;L+r<A+ne;){L+=r;let ae=(L-A)/ne,B=eo.number(G.x,K.x,ae),W=eo.number(G.y,K.y,ae);if(B>=0&&B<w&&W>=0&&W<w&&L-S>=0&&L+S<=I){let ce=new Gl(B,W,me,V);ce._round(),d&&!bb(o,ce,_,d,m)||N.push(ce)}}A+=ne}return b||N.length||y||(N=Mb(o,A/2,r,d,m,_,y,!0,w)),N}nt("Anchor",Gl);let Dh=Gr;function Sb(o,t,r,d){let m=[],_=o.image,y=_.pixelRatio,b=_.paddedRect.w-2*Dh,w=_.paddedRect.h-2*Dh,S={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom},I=_.stretchX||[[0,b]],A=_.stretchY||[[0,w]],L=(Ne,ot)=>Ne+ot[1]-ot[0],N=I.reduce(L,0),V=A.reduce(L,0),G=b-N,K=w-V,ne=0,me=N,ae=0,B=V,W=0,ce=G,Pe=0,Ue=K;if(_.content&&d){let Ne=_.content,ot=Ne[2]-Ne[0],vt=Ne[3]-Ne[1];(_.textFitWidth||_.textFitHeight)&&(S=Kv(o)),ne=Em(I,0,Ne[0]),ae=Em(A,0,Ne[1]),me=Em(I,Ne[0],Ne[2]),B=Em(A,Ne[1],Ne[3]),W=Ne[0]-ne,Pe=Ne[1]-ae,ce=ot-me,Ue=vt-B}let Ie=S.x1,Le=S.y1,Ze=S.x2-Ie,Ge=S.y2-Le,We=(Ne,ot,vt,_t)=>{let dt=Tm(Ne.stretch-ne,me,Ze,Ie),Qt=Im(Ne.fixed-W,ce,Ne.stretch,N),en=Tm(ot.stretch-ae,B,Ge,Le),An=Im(ot.fixed-Pe,Ue,ot.stretch,V),ur=Tm(vt.stretch-ne,me,Ze,Ie),Mo=Im(vt.fixed-W,ce,vt.stretch,N),Hr=Tm(_t.stretch-ae,B,Ge,Le),Kn=Im(_t.fixed-Pe,Ue,_t.stretch,V),Ki=new $e(dt,en),Vn=new $e(ur,en),Qn=new $e(ur,Hr),Jn=new $e(dt,Hr),Ar=new $e(Qt/y,An/y),So=new $e(Mo/y,Kn/y),jn=t*Math.PI/180;if(jn){let Un=Math.sin(jn),$n=Math.cos(jn),vn=[$n,-Un,Un,$n];Ki._matMult(vn),Vn._matMult(vn),Jn._matMult(vn),Qn._matMult(vn)}let Zr=Ne.stretch+Ne.fixed,Dn=ot.stretch+ot.fixed;return{tl:Ki,tr:Vn,bl:Jn,br:Qn,tex:{x:_.paddedRect.x+Dh+Zr,y:_.paddedRect.y+Dh+Dn,w:vt.stretch+vt.fixed-Zr,h:_t.stretch+_t.fixed-Dn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ar,pixelOffsetBR:So,minFontScaleX:ce/y/Ze,minFontScaleY:Ue/y/Ge,isSDF:r}};if(d&&(_.stretchX||_.stretchY)){let Ne=Pb(I,G,N),ot=Pb(A,K,V);for(let vt=0;vt<Ne.length-1;vt++){let _t=Ne[vt],dt=Ne[vt+1];for(let Qt=0;Qt<ot.length-1;Qt++)m.push(We(_t,ot[Qt],dt,ot[Qt+1]))}}else m.push(We({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:w+1}));return m}function Em(o,t,r){let d=0;for(let m of o)d+=Math.max(t,Math.min(r,m[1]))-Math.max(t,Math.min(r,m[0]));return d}function Pb(o,t,r){let d=[{fixed:-1,stretch:0}];for(let[m,_]of o){let y=d[d.length-1];d.push({fixed:m-y.stretch,stretch:y.stretch}),d.push({fixed:m-y.stretch,stretch:y.stretch+(_-m)})}return d.push({fixed:t+Dh,stretch:r}),d}function Tm(o,t,r,d){return o/t*r+d}function Im(o,t,r,d){return o-t*r/d}class km{constructor(t,r,d,m,_,y,b,w,S,I){var A;if(this.boxStartIndex=t.length,S){let L=y.top,N=y.bottom,V=y.collisionPadding;V&&(L-=V[1],N+=V[3]);let G=N-L;G>0&&(G=Math.max(10,G),this.circleDiameter=G)}else{let L=!((A=y.image)===null||A===void 0)&&A.content&&(y.image.textFitWidth||y.image.textFitHeight)?Kv(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};L.y1=L.y1*b-w[0],L.y2=L.y2*b+w[2],L.x1=L.x1*b-w[3],L.x2=L.x2*b+w[1];let N=y.collisionPadding;if(N&&(L.x1-=N[0]*b,L.y1-=N[1]*b,L.x2+=N[2]*b,L.y2+=N[3]*b),I){let V=new $e(L.x1,L.y1),G=new $e(L.x2,L.y1),K=new $e(L.x1,L.y2),ne=new $e(L.x2,L.y2),me=I*Math.PI/180;V._rotate(me),G._rotate(me),K._rotate(me),ne._rotate(me),L.x1=Math.min(V.x,G.x,K.x,ne.x),L.x2=Math.max(V.x,G.x,K.x,ne.x),L.y1=Math.min(V.y,G.y,K.y,ne.y),L.y2=Math.max(V.y,G.y,K.y,ne.y)}t.emplaceBack(r.x,r.y,L.x1,L.y1,L.x2,L.y2,d,m,_)}this.boxEndIndex=t.length}}class vM{constructor(t=[],r=(d,m)=>d<m?-1:d>m?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;let t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:r,compare:d}=this,m=r[t];for(;t>0;){let _=t-1>>1,y=r[_];if(d(m,y)>=0)break;r[t]=y,t=_}r[t]=m}_down(t){let{data:r,compare:d}=this,m=this.length>>1,_=r[t];for(;t<m;){let y=1+(t<<1),b=y+1;if(b<this.length&&d(r[b],r[y])<0&&(y=b),d(r[y],_)>=0)break;r[t]=r[y],t=y}r[t]=_}}function bM(o,t=1,r=!1){let d=1/0,m=1/0,_=-1/0,y=-1/0,b=o[0];for(let N=0;N<b.length;N++){let V=b[N];(!N||V.x<d)&&(d=V.x),(!N||V.y<m)&&(m=V.y),(!N||V.x>_)&&(_=V.x),(!N||V.y>y)&&(y=V.y)}let w=Math.min(_-d,y-m),S=w/2,I=new vM([],xM);if(w===0)return new $e(d,m);for(let N=d;N<_;N+=w)for(let V=m;V<y;V+=w)I.push(new Jd(N+S,V+S,S,o));let A=function(N){let V=0,G=0,K=0,ne=N[0];for(let me=0,ae=ne.length,B=ae-1;me<ae;B=me++){let W=ne[me],ce=ne[B],Pe=W.x*ce.y-ce.x*W.y;G+=(W.x+ce.x)*Pe,K+=(W.y+ce.y)*Pe,V+=3*Pe}return new Jd(G/V,K/V,0,N)}(o),L=I.length;for(;I.length;){let N=I.pop();(N.d>A.d||!A.d)&&(A=N,r&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,L)),N.max-A.d<=t||(S=N.h/2,I.push(new Jd(N.p.x-S,N.p.y-S,S,o)),I.push(new Jd(N.p.x+S,N.p.y-S,S,o)),I.push(new Jd(N.p.x-S,N.p.y+S,S,o)),I.push(new Jd(N.p.x+S,N.p.y+S,S,o)),L+=4)}return r&&(console.log(`num probes: ${L}`),console.log(`best distance: ${A.d}`)),A.p}function xM(o,t){return t.max-o.max}function Jd(o,t,r,d){this.p=new $e(o,t),this.h=r,this.d=function(m,_){let y=!1,b=1/0;for(let w=0;w<_.length;w++){let S=_[w];for(let I=0,A=S.length,L=A-1;I<A;L=I++){let N=S[I],V=S[L];N.y>m.y!=V.y>m.y&&m.x<(V.x-N.x)*(m.y-N.y)/(V.y-N.y)+N.x&&(y=!y),b=Math.min(b,sv(m,N,V))}}return(y?1:-1)*Math.sqrt(b)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var dr;h.aB=void 0,(dr=h.aB||(h.aB={}))[dr.center=1]="center",dr[dr.left=2]="left",dr[dr.right=3]="right",dr[dr.top=4]="top",dr[dr.bottom=5]="bottom",dr[dr["top-left"]=6]="top-left",dr[dr["top-right"]=7]="top-right",dr[dr["bottom-left"]=8]="bottom-left",dr[dr["bottom-right"]=9]="bottom-right";let Hl=7,M_=Number.POSITIVE_INFINITY;function Eb(o,t){return t[1]!==M_?function(r,d,m){let _=0,y=0;switch(d=Math.abs(d),m=Math.abs(m),r){case"top-right":case"top-left":case"top":y=m-Hl;break;case"bottom-right":case"bottom-left":case"bottom":y=-m+Hl}switch(r){case"top-right":case"bottom-right":case"right":_=-d;break;case"top-left":case"bottom-left":case"left":_=d}return[_,y]}(o,t[0],t[1]):function(r,d){let m=0,_=0;d<0&&(d=0);let y=d/Math.SQRT2;switch(r){case"top-right":case"top-left":_=y-Hl;break;case"bottom-right":case"bottom-left":_=-y+Hl;break;case"bottom":_=-d+Hl;break;case"top":_=d-Hl}switch(r){case"top-right":case"bottom-right":m=-y;break;case"top-left":case"bottom-left":m=y;break;case"left":m=d;break;case"right":m=-d}return[m,_]}(o,t[0])}function Tb(o,t,r){var d;let m=o.layout,_=(d=m.get("text-variable-anchor-offset"))===null||d===void 0?void 0:d.evaluate(t,{},r);if(_){let b=_.values,w=[];for(let S=0;S<b.length;S+=2){let I=w[S]=b[S],A=b[S+1].map(L=>L*kn);I.startsWith("top")?A[1]-=Hl:I.startsWith("bottom")&&(A[1]+=Hl),w[S+1]=A}return new Xn(w)}let y=m.get("text-variable-anchor");if(y){let b;b=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(t,{},r)*kn,M_]:m.get("text-offset").evaluate(t,{},r).map(S=>S*kn);let w=[];for(let S of y)w.push(S,Eb(S,b));return new Xn(w)}return null}function S_(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wM(o,t,r,d,m,_,y,b,w,S,I,A){let L=_.textMaxSize.evaluate(t,{});L===void 0&&(L=y);let N=o.layers[0].layout,V=N.get("icon-offset").evaluate(t,{},I),G=kb(r.horizontal),K=y/24,ne=o.tilePixelRatio*K,me=o.tilePixelRatio*L/24,ae=o.tilePixelRatio*b,B=o.tilePixelRatio*N.get("symbol-spacing"),W=N.get("text-padding")*o.tilePixelRatio,ce=function(vt,_t,dt,Qt=1){let en=vt.get("icon-padding").evaluate(_t,{},dt),An=en&&en.values;return[An[0]*Qt,An[1]*Qt,An[2]*Qt,An[3]*Qt]}(N,t,I,o.tilePixelRatio),Pe=N.get("text-max-angle")/180*Math.PI,Ue=N.get("text-rotation-alignment")!=="viewport"&&N.get("symbol-placement")!=="point",Ie=N.get("icon-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",Le=N.get("symbol-placement"),Ze=B/2,Ge=N.get("icon-text-fit"),We;d&&Ge!=="none"&&(o.allowVerticalPlacement&&r.vertical&&(We=Qv(d,r.vertical,Ge,N.get("icon-text-fit-padding"),V,K)),G&&(d=Qv(d,G,Ge,N.get("icon-text-fit-padding"),V,K)));let Ne=I?A.line.getGranularityForZoomLevel(I.z):1,ot=(vt,_t)=>{_t.x<0||_t.x>=mi||_t.y<0||_t.y>=mi||function(dt,Qt,en,An,ur,Mo,Hr,Kn,Ki,Vn,Qn,Jn,Ar,So,jn,Zr,Dn,Un,$n,vn,Bi,xs,eu,ws,SM){let tu=dt.addToLineVertexArray(Qt,en),Hc,iu,nu,ru,Ob=0,Fb=0,Lb=0,zb=0,R_=-1,O_=-1,Wa={},Bb=vs("");if(dt.allowVerticalPlacement&&An.vertical){let xr=Kn.layout.get("text-rotate").evaluate(Bi,{},ws)+90;nu=new km(Ki,Qt,Vn,Qn,Jn,An.vertical,Ar,So,jn,xr),Hr&&(ru=new km(Ki,Qt,Vn,Qn,Jn,Hr,Dn,Un,jn,xr))}if(ur){let xr=Kn.layout.get("icon-rotate").evaluate(Bi,{}),Po=Kn.layout.get("icon-text-fit")!=="none",Zc=Sb(ur,xr,eu,Po),Ms=Hr?Sb(Hr,xr,eu,Po):void 0;iu=new km(Ki,Qt,Vn,Qn,Jn,ur,Dn,Un,!1,xr),Ob=4*Zc.length;let Wc=dt.iconSizeData,ia=null;Wc.kind==="source"?(ia=[ta*Kn.layout.get("icon-size").evaluate(Bi,{})],ia[0]>Ul&&Sn(`${dt.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)):Wc.kind==="composite"&&(ia=[ta*xs.compositeIconSizes[0].evaluate(Bi,{},ws),ta*xs.compositeIconSizes[1].evaluate(Bi,{},ws)],(ia[0]>Ul||ia[1]>Ul)&&Sn(`${dt.layerIds[0]}: Value for "icon-size" is >= ${kh}. Reduce your "icon-size".`)),dt.addSymbols(dt.icon,Zc,ia,vn,$n,Bi,h.al.none,Qt,tu.lineStartIndex,tu.lineLength,-1,ws),R_=dt.icon.placedSymbolArray.length-1,Ms&&(Fb=4*Ms.length,dt.addSymbols(dt.icon,Ms,ia,vn,$n,Bi,h.al.vertical,Qt,tu.lineStartIndex,tu.lineLength,-1,ws),O_=dt.icon.placedSymbolArray.length-1)}let Nb=Object.keys(An.horizontal);for(let xr of Nb){let Po=An.horizontal[xr];if(!Hc){Bb=vs(Po.text);let Ms=Kn.layout.get("text-rotate").evaluate(Bi,{},ws);Hc=new km(Ki,Qt,Vn,Qn,Jn,Po,Ar,So,jn,Ms)}let Zc=Po.positionedLines.length===1;if(Lb+=Ib(dt,Qt,Po,Mo,Kn,jn,Bi,Zr,tu,An.vertical?h.al.horizontal:h.al.horizontalOnly,Zc?Nb:[xr],Wa,R_,xs,ws),Zc)break}An.vertical&&(zb+=Ib(dt,Qt,An.vertical,Mo,Kn,jn,Bi,Zr,tu,h.al.vertical,["vertical"],Wa,O_,xs,ws));let PM=Hc?Hc.boxStartIndex:dt.collisionBoxArray.length,EM=Hc?Hc.boxEndIndex:dt.collisionBoxArray.length,TM=nu?nu.boxStartIndex:dt.collisionBoxArray.length,IM=nu?nu.boxEndIndex:dt.collisionBoxArray.length,kM=iu?iu.boxStartIndex:dt.collisionBoxArray.length,AM=iu?iu.boxEndIndex:dt.collisionBoxArray.length,DM=ru?ru.boxStartIndex:dt.collisionBoxArray.length,RM=ru?ru.boxEndIndex:dt.collisionBoxArray.length,Cs=-1,Dm=(xr,Po)=>xr&&xr.circleDiameter?Math.max(xr.circleDiameter,Po):Po;Cs=Dm(Hc,Cs),Cs=Dm(nu,Cs),Cs=Dm(iu,Cs),Cs=Dm(ru,Cs);let Vb=Cs>-1?1:0;Vb&&(Cs*=SM/kn),dt.glyphOffsetArray.length>=Kd.MAX_GLYPHS&&Sn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bi.sortKey!==void 0&&dt.addToSortKeyRanges(dt.symbolInstances.length,Bi.sortKey);let OM=Tb(Kn,Bi,ws),[FM,LM]=function(xr,Po){let Zc=xr.length,Ms=Po?.values;if(Ms?.length>0)for(let Wc=0;Wc<Ms.length;Wc+=2){let ia=Ms[Wc+1];xr.emplaceBack(h.aB[Ms[Wc]],ia[0],ia[1])}return[Zc,xr.length]}(dt.textAnchorOffsets,OM);dt.symbolInstances.emplaceBack(Qt.x,Qt.y,Wa.right>=0?Wa.right:-1,Wa.center>=0?Wa.center:-1,Wa.left>=0?Wa.left:-1,Wa.vertical||-1,R_,O_,Bb,PM,EM,TM,IM,kM,AM,DM,RM,Vn,Lb,zb,Ob,Fb,Vb,0,Ar,Cs,FM,LM)}(o,_t,vt,r,d,m,We,o.layers[0],o.collisionBoxArray,t.index,t.sourceLayerIndex,o.index,ne,[W,W,W,W],Ue,w,ae,ce,Ie,V,t,_,S,I,y)};if(Le==="line")for(let vt of vb(t.geometry,0,0,mi,mi)){let _t=Gc(vt,Ne),dt=yM(_t,B,Pe,r.vertical||G,d,24,me,o.overscaling,mi);for(let Qt of dt)G&&CM(o,G.text,Ze,Qt)||ot(_t,Qt)}else if(Le==="line-center"){for(let vt of t.geometry)if(vt.length>1){let _t=Gc(vt,Ne),dt=_M(_t,Pe,r.vertical||G,d,24,me);dt&&ot(_t,dt)}}else if(t.type==="Polygon")for(let vt of Aa(t.geometry,0)){let _t=bM(vt,16);ot(Gc(vt[0],Ne,!0),new Gl(_t.x,_t.y,0))}else if(t.type==="LineString")for(let vt of t.geometry){let _t=Gc(vt,Ne);ot(_t,new Gl(_t[0].x,_t[0].y,0))}else if(t.type==="Point")for(let vt of t.geometry)for(let _t of vt)ot([_t],new Gl(_t.x,_t.y,0))}function Ib(o,t,r,d,m,_,y,b,w,S,I,A,L,N,V){let G=function(me,ae,B,W,ce,Pe,Ue,Ie){let Le=W.layout.get("text-rotate").evaluate(Pe,{})*Math.PI/180,Ze=[];for(let Ge of ae.positionedLines)for(let We of Ge.positionedGlyphs){if(!We.rect)continue;let Ne=We.rect||{},ot=Y2+1,vt=!0,_t=1,dt=0,Qt=(ce||Ie)&&We.vertical,en=We.metrics.advance*We.scale/2;if(Ie&&ae.verticalizable&&(dt=Ge.lineOffset/2-(We.imageName?-(kn-We.metrics.width*We.scale)/2:(We.scale-1)*kn)),We.imageName){let Un=Ue[We.imageName];vt=Un.sdf,_t=Un.pixelRatio,ot=Gr/_t}let An=ce?[We.x+en,We.y]:[0,0],ur=ce?[0,0]:[We.x+en+B[0],We.y+B[1]-dt],Mo=[0,0];Qt&&(Mo=ur,ur=[0,0]);let Hr=We.metrics.isDoubleResolution?2:1,Kn=(We.metrics.left-ot)*We.scale-en+ur[0],Ki=(-We.metrics.top-ot)*We.scale+ur[1],Vn=Kn+Ne.w/Hr*We.scale/_t,Qn=Ki+Ne.h/Hr*We.scale/_t,Jn=new $e(Kn,Ki),Ar=new $e(Vn,Ki),So=new $e(Kn,Qn),jn=new $e(Vn,Qn);if(Qt){let Un=new $e(-en,en-wm),$n=-Math.PI/2,vn=kn/2-en,Bi=new $e(5-wm-vn,-(We.imageName?vn:0)),xs=new $e(...Mo);Jn._rotateAround($n,Un)._add(Bi)._add(xs),Ar._rotateAround($n,Un)._add(Bi)._add(xs),So._rotateAround($n,Un)._add(Bi)._add(xs),jn._rotateAround($n,Un)._add(Bi)._add(xs)}if(Le){let Un=Math.sin(Le),$n=Math.cos(Le),vn=[$n,-Un,Un,$n];Jn._matMult(vn),Ar._matMult(vn),So._matMult(vn),jn._matMult(vn)}let Zr=new $e(0,0),Dn=new $e(0,0);Ze.push({tl:Jn,tr:Ar,bl:So,br:jn,tex:Ne,writingMode:ae.writingMode,glyphOffset:An,sectionIndex:We.sectionIndex,isSDF:vt,pixelOffsetTL:Zr,pixelOffsetBR:Dn,minFontScaleX:0,minFontScaleY:0})}return Ze}(0,r,b,m,_,y,d,o.allowVerticalPlacement),K=o.textSizeData,ne=null;K.kind==="source"?(ne=[ta*m.layout.get("text-size").evaluate(y,{})],ne[0]>Ul&&Sn(`${o.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)):K.kind==="composite"&&(ne=[ta*N.compositeTextSizes[0].evaluate(y,{},V),ta*N.compositeTextSizes[1].evaluate(y,{},V)],(ne[0]>Ul||ne[1]>Ul)&&Sn(`${o.layerIds[0]}: Value for "text-size" is >= ${kh}. Reduce your "text-size".`)),o.addSymbols(o.text,G,ne,b,_,y,S,t,w.lineStartIndex,w.lineLength,L,V);for(let me of I)A[me]=o.text.placedSymbolArray.length-1;return 4*G.length}function kb(o){for(let t in o)return o[t];return null}function CM(o,t,r,d){let m=o.compareText;if(t in m){let _=m[t];for(let y=_.length-1;y>=0;y--)if(d.dist(_[y])<r)return!0}else m[t]=[];return m[t].push(d),!1}let Ab=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class P_{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,d]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let m=d>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);let _=Ab[15&d];if(!_)throw new Error("Unrecognized array type.");let[y]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new P_(b,y,_,t)}constructor(t,r=64,d=Float64Array,m){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=d,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let _=Ab.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-b%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${d}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+b+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){let d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=t,this.coords[this._pos++]=r,d}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return E_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,d,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:_,coords:y,nodeSize:b}=this,w=[0,_.length-1,0],S=[];for(;w.length;){let I=w.pop()||0,A=w.pop()||0,L=w.pop()||0;if(A-L<=b){for(let K=L;K<=A;K++){let ne=y[2*K],me=y[2*K+1];ne>=t&&ne<=d&&me>=r&&me<=m&&S.push(_[K])}continue}let N=L+A>>1,V=y[2*N],G=y[2*N+1];V>=t&&V<=d&&G>=r&&G<=m&&S.push(_[N]),(I===0?t<=V:r<=G)&&(w.push(L),w.push(N-1),w.push(1-I)),(I===0?d>=V:m>=G)&&(w.push(N+1),w.push(A),w.push(1-I))}return S}within(t,r,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:m,coords:_,nodeSize:y}=this,b=[0,m.length-1,0],w=[],S=d*d;for(;b.length;){let I=b.pop()||0,A=b.pop()||0,L=b.pop()||0;if(A-L<=y){for(let K=L;K<=A;K++)Rb(_[2*K],_[2*K+1],t,r)<=S&&w.push(m[K]);continue}let N=L+A>>1,V=_[2*N],G=_[2*N+1];Rb(V,G,t,r)<=S&&w.push(m[N]),(I===0?t-d<=V:r-d<=G)&&(b.push(L),b.push(N-1),b.push(1-I)),(I===0?t+d>=V:r+d>=G)&&(b.push(N+1),b.push(A),b.push(1-I))}return w}}function E_(o,t,r,d,m,_){if(m-d<=r)return;let y=d+m>>1;Db(o,t,y,d,m,_),E_(o,t,r,d,y-1,1-_),E_(o,t,r,y+1,m,1-_)}function Db(o,t,r,d,m,_){for(;m>d;){if(m-d>600){let S=m-d+1,I=r-d+1,A=Math.log(S),L=.5*Math.exp(2*A/3),N=.5*Math.sqrt(A*L*(S-L)/S)*(I-S/2<0?-1:1);Db(o,t,r,Math.max(d,Math.floor(r-I*L/S+N)),Math.min(m,Math.floor(r+(S-I)*L/S+N)),_)}let y=t[2*r+_],b=d,w=m;for(Rh(o,t,d,r),t[2*m+_]>y&&Rh(o,t,d,m);b<w;){for(Rh(o,t,b,w),b++,w--;t[2*b+_]<y;)b++;for(;t[2*w+_]>y;)w--}t[2*d+_]===y?Rh(o,t,d,w):(w++,Rh(o,t,w,m)),w<=r&&(d=w+1),r<=w&&(m=w-1)}}function Rh(o,t,r,d){T_(o,r,d),T_(t,2*r,2*d),T_(t,2*r+1,2*d+1)}function T_(o,t,r){let d=o[t];o[t]=o[r],o[r]=d}function Rb(o,t,r,d){let m=o-r,_=t-d;return m*m+_*_}var I_;h.co=void 0,(I_=h.co||(h.co={})).create="create",I_.load="load",I_.fullLoad="fullLoad";let Am=null,Oh=[],k_=1e3/60,A_="loadTime",D_="fullLoadTime",MM={mark(o){performance.mark(o)},frame(o){let t=o;Am!=null&&Oh.push(t-Am),Am=t},clearMetrics(){Am=null,Oh=[],performance.clearMeasures(A_),performance.clearMeasures(D_);for(let o in h.co)performance.clearMarks(h.co[o])},getPerformanceMetrics(){performance.measure(A_,h.co.create,h.co.load),performance.measure(D_,h.co.create,h.co.fullLoad);let o=performance.getEntriesByName(A_)[0].duration,t=performance.getEntriesByName(D_)[0].duration,r=Oh.length,d=1/(Oh.reduce((_,y)=>_+y,0)/r/1e3),m=Oh.filter(_=>_>k_).reduce((_,y)=>_+(y-k_)/k_,0);return{loadTime:o,fullLoadTime:t,fps:d,percentDroppedFrames:m/(r+m)*100,totalFrames:r}}};h.$=Ah,h.A=bi,h.B=eo,h.C=Li,h.D=pt,h.E=fe,h.F=Bg,h.G=function(o){if(rn==null){let t=o.navigator?o.navigator.userAgent:null;rn=!!o.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return rn},h.H=class{constructor(o,t){this.target=o,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new mM(()=>this.process()),this.subscription=Lo(this.target,"message",r=>this.receive(r),!1),this.globalScope=Kr(self)?o:window}registerMessageHandler(o,t){this.messageHandlers[o]=t}sendAsync(o,t){return new Promise((r,d)=>{let m=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=t?Lo(t.signal,"abort",()=>{_?.unsubscribe(),delete this.resolveRejects[m];let w={id:m,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},fM):null;this.resolveRejects[m]={resolve:w=>{_?.unsubscribe(),r(w)},reject:w=>{_?.unsubscribe(),d(w)}};let y=[],b=Object.assign(Object.assign({},o),{id:m,sourceMapId:this.mapId,origin:location.origin,data:Bl(o.data,y)});this.target.postMessage(b,{transfer:y})})}receive(o){let t=o.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];let d=this.abortControllers[r];return delete this.abortControllers[r],void(d&&d.abort())}if(Kr(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;let o=this.taskQueue.shift(),t=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(o,t)}processTask(o,t){return s(this,void 0,void 0,function*(){if(t.type==="<response>"){let m=this.resolveRejects[o];return delete this.resolveRejects[o],m?void(t.error?m.reject(Dc(t.error)):m.resolve(Dc(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let r=Dc(t.data),d=new AbortController;this.abortControllers[o]=d;try{let m=yield this.messageHandlers[t.type](t.sourceMapId,r,d);this.completeTask(o,null,m)}catch(m){this.completeTask(o,m)}})}completeTask(o,t,r){let d=[];delete this.abortControllers[o];let m={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Bl(t):null,data:Bl(r,d)};this.target.postMessage(m,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},h.I=p_,h.J=Qr,h.K=function(){var o=new bi(16);return bi!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},h.L=function(o,t,r){var d,m,_,y,b,w,S,I,A,L,N,V,G=r[0],K=r[1],ne=r[2];return t===o?(o[12]=t[0]*G+t[4]*K+t[8]*ne+t[12],o[13]=t[1]*G+t[5]*K+t[9]*ne+t[13],o[14]=t[2]*G+t[6]*K+t[10]*ne+t[14],o[15]=t[3]*G+t[7]*K+t[11]*ne+t[15]):(m=t[1],_=t[2],y=t[3],b=t[4],w=t[5],S=t[6],I=t[7],A=t[8],L=t[9],N=t[10],V=t[11],o[0]=d=t[0],o[1]=m,o[2]=_,o[3]=y,o[4]=b,o[5]=w,o[6]=S,o[7]=I,o[8]=A,o[9]=L,o[10]=N,o[11]=V,o[12]=d*G+b*K+A*ne+t[12],o[13]=m*G+w*K+L*ne+t[13],o[14]=_*G+S*K+N*ne+t[14],o[15]=y*G+I*K+V*ne+t[15]),o},h.M=function(o,t,r){var d=r[0],m=r[1],_=r[2];return o[0]=t[0]*d,o[1]=t[1]*d,o[2]=t[2]*d,o[3]=t[3]*d,o[4]=t[4]*m,o[5]=t[5]*m,o[6]=t[6]*m,o[7]=t[7]*m,o[8]=t[8]*_,o[9]=t[9]*_,o[10]=t[10]*_,o[11]=t[11]*_,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},h.N=function(o,t,r){var d=t[0],m=t[1],_=t[2],y=t[3],b=t[4],w=t[5],S=t[6],I=t[7],A=t[8],L=t[9],N=t[10],V=t[11],G=t[12],K=t[13],ne=t[14],me=t[15],ae=r[0],B=r[1],W=r[2],ce=r[3];return o[0]=ae*d+B*b+W*A+ce*G,o[1]=ae*m+B*w+W*L+ce*K,o[2]=ae*_+B*S+W*N+ce*ne,o[3]=ae*y+B*I+W*V+ce*me,o[4]=(ae=r[4])*d+(B=r[5])*b+(W=r[6])*A+(ce=r[7])*G,o[5]=ae*m+B*w+W*L+ce*K,o[6]=ae*_+B*S+W*N+ce*ne,o[7]=ae*y+B*I+W*V+ce*me,o[8]=(ae=r[8])*d+(B=r[9])*b+(W=r[10])*A+(ce=r[11])*G,o[9]=ae*m+B*w+W*L+ce*K,o[10]=ae*_+B*S+W*N+ce*ne,o[11]=ae*y+B*I+W*V+ce*me,o[12]=(ae=r[12])*d+(B=r[13])*b+(W=r[14])*A+(ce=r[15])*G,o[13]=ae*m+B*w+W*L+ce*K,o[14]=ae*_+B*S+W*N+ce*ne,o[15]=ae*y+B*I+W*V+ce*me,o},h.O=function(o,t){let r={};for(let d=0;d<t.length;d++){let m=t[d];m in o&&(r[m]=o[m])}return r},h.P=$e,h.Q=$l,h.R=wo,h.S=lb,h.T=cm,h.U=ab,h.V=hi,h.W=Mi,h.X=Pn,h.Y=Co,h.Z=mi,h._=s,h.a=Br,h.a$=function(o,t,r){var d=Math.sin(r),m=Math.cos(r),_=t[4],y=t[5],b=t[6],w=t[7],S=t[8],I=t[9],A=t[10],L=t[11];return t!==o&&(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[4]=_*m+S*d,o[5]=y*m+I*d,o[6]=b*m+A*d,o[7]=w*m+L*d,o[8]=S*m-_*d,o[9]=I*m-y*d,o[10]=A*m-b*d,o[11]=L*m-w*d,o},h.a0=25,h.a1=C_,h.a2=o=>{let t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(let d of o){let m=window.document.createElement("source");xe(d)||(t.crossOrigin="Anonymous"),m.src=d,t.appendChild(m)}})},h.a3=De,h.a4=function(){return is++},h.a5=ie,h.a6=Kd,h.a7=Ua,h.a8=jc,h.a9=fb,h.aA=function(o,t,r,d,m=!1){if(!r[0]&&!r[1])return[0,0];let _=m?d==="map"?-o.bearingInRadians:0:d==="viewport"?o.bearingInRadians:0;if(_){let y=Math.sin(_),b=Math.cos(_);r=[r[0]*b-r[1]*y,r[0]*y+r[1]*b]}return[m?r[0]:ho(t,r[0],o.zoom),m?r[1]:ho(t,r[1],o.zoom)]},h.aC=g_,h.aD=S_,h.aE=f_,h.aF=P_,h.aG=Wi,h.aH=vm,h.aI=Re,h.aJ=gi,h.aK=fi,h.aL=mr,h.aM=sn,h.aN=db,h.aO=function(o,t,r){return o[0]=t[0]*r,o[1]=t[1]*r,o[2]=t[2]*r,o},h.aP=function(o,t,r){return o[0]=t[0]+r[0],o[1]=t[1]+r[1],o[2]=t[2]+r[2],o},h.aQ=function(o){var t=new bi(3);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t},h.aR=function(o,t,r){return o[0]=t[0]*r[0],o[1]=t[1]*r[1],o[2]=t[2]*r[2],o[3]=t[3]*r[3],o},h.aS=function(o,t,r){return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],o},h.aT=function(o,t){var r=t[0],d=t[1],m=t[2],_=r*r+d*d+m*m;return _>0&&(_=1/Math.sqrt(_)),o[0]=t[0]*_,o[1]=t[1]*_,o[2]=t[2]*_,o},h.aU=function(o,t,r){var d=t[0],m=t[1],_=t[2],y=r[0],b=r[1],w=r[2];return o[0]=m*w-_*b,o[1]=_*y-d*w,o[2]=d*b-m*y,o},h.aV=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]},h.aW=hb,h.aX=Qd,h.aY=function(o,t,r,d,m){var _,y=1/Math.tan(t/2);return o[0]=y/r,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=y,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,m!=null&&m!==1/0?(o[10]=(m+d)*(_=1/(d-m)),o[14]=2*m*d*_):(o[10]=-1,o[14]=-2*d),o},h.aZ=function(o){var t=new bi(16);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},h.a_=function(o,t,r){var d=Math.sin(r),m=Math.cos(r),_=t[0],y=t[1],b=t[2],w=t[3],S=t[4],I=t[5],A=t[6],L=t[7];return t!==o&&(o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=_*m+S*d,o[1]=y*m+I*d,o[2]=b*m+A*d,o[3]=w*m+L*d,o[4]=S*m-_*d,o[5]=I*m-y*d,o[6]=A*m-b*d,o[7]=L*m-w*d,o},h.aa=function(o){let t={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,d,m,_)=>{let y=m||_;return t[d]=!y||y.toLowerCase(),""}),t["max-age"]){let r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},h.ab=Kt,h.ac=function(o){return Math.pow(2,o)},h.ad=pi,h.ae=Cn,h.af=85.051129,h.ag=cb,h.ah=function(o){return Math.log(o)/Math.LN2},h.ai=function(o){var t=o[0],r=o[1];return t*t+r*r},h.aj=function(o,t){let r=[];for(let d in o)d in t||r.push(d);return r},h.ak=function(o,t){let r=0,d=0;if(o.kind==="constant")d=o.layoutSize;else if(o.kind!=="source"){let{interpolationType:m,minZoom:_,maxZoom:y}=o,b=m?Cn(Bn.interpolationFactor(m,t,_,y),0,1):0;o.kind==="camera"?d=eo.number(o.minSize,o.maxSize,b):r=b}return{uSizeT:r,uSize:d}},h.am=function(o,{uSize:t,uSizeT:r},{lowerSize:d,upperSize:m}){return o.kind==="source"?d/ta:o.kind==="composite"?eo.number(d/ta,m/ta,r):t},h.an=function(o,t){var r=t[0],d=t[1],m=t[2],_=t[3],y=t[4],b=t[5],w=t[6],S=t[7],I=t[8],A=t[9],L=t[10],N=t[11],V=t[12],G=t[13],K=t[14],ne=t[15],me=r*b-d*y,ae=r*w-m*y,B=r*S-_*y,W=d*w-m*b,ce=d*S-_*b,Pe=m*S-_*w,Ue=I*G-A*V,Ie=I*K-L*V,Le=I*ne-N*V,Ze=A*K-L*G,Ge=A*ne-N*G,We=L*ne-N*K,Ne=me*We-ae*Ge+B*Ze+W*Le-ce*Ie+Pe*Ue;return Ne?(o[0]=(b*We-w*Ge+S*Ze)*(Ne=1/Ne),o[1]=(m*Ge-d*We-_*Ze)*Ne,o[2]=(G*Pe-K*ce+ne*W)*Ne,o[3]=(L*ce-A*Pe-N*W)*Ne,o[4]=(w*Le-y*We-S*Ie)*Ne,o[5]=(r*We-m*Le+_*Ie)*Ne,o[6]=(K*B-V*Pe-ne*ae)*Ne,o[7]=(I*Pe-L*B+N*ae)*Ne,o[8]=(y*Ge-b*Le+S*Ue)*Ne,o[9]=(d*Le-r*Ge-_*Ue)*Ne,o[10]=(V*ce-G*B+ne*me)*Ne,o[11]=(A*B-I*ce-N*me)*Ne,o[12]=(b*Ie-y*Ze-w*Ue)*Ne,o[13]=(r*Ze-d*Ie+m*Ue)*Ne,o[14]=(G*ae-V*W-K*me)*Ne,o[15]=(I*W-A*ae+L*me)*Ne,o):null},h.ao=As,h.ap=function(o){return Math.hypot(o[0],o[1])},h.aq=function(o){return o[0]=0,o[1]=0,o},h.ar=function(o,t,r){return o[0]=t[0]*r,o[1]=t[1]*r,o},h.as=__,h.at=kt,h.au=function(o,t,r,d){let m=t.y-o.y,_=t.x-o.x,y=d.y-r.y,b=d.x-r.x,w=y*_-b*m;if(w===0)return null;let S=(b*(o.y-r.y)-y*(o.x-r.x))/w;return new $e(o.x+S*_,o.y+S*m)},h.av=vb,h.aw=rv,h.ax=function(o){let t=1/0,r=1/0,d=-1/0,m=-1/0;for(let _ of o)t=Math.min(t,_.x),r=Math.min(r,_.y),d=Math.max(d,_.x),m=Math.max(m,_.y);return[t,r,d,m]},h.ay=kn,h.az=ho,h.b=on,h.b$=class extends U{},h.b0=function(){let o=new Float32Array(16);return pi(o),o},h.b1=function(){let o=new Float64Array(16);return pi(o),o},h.b2=function(){return new Float64Array(16)},h.b3=function(o,t,r){let d=new Float64Array(4);return function(m,_,y,b){var w=.5*Math.PI/180;_*=w,y*=w,b*=w;var S=Math.sin(_),I=Math.cos(_),A=Math.sin(y),L=Math.cos(y),N=Math.sin(b),V=Math.cos(b);m[0]=S*L*V-I*A*N,m[1]=I*A*V+S*L*N,m[2]=I*L*N-S*A*V,m[3]=I*L*V+S*A*N}(d,o,t-90,r),d},h.b4=function(o,t,r,d){var m,_,y,b,w,S=t[0],I=t[1],A=t[2],L=t[3],N=r[0],V=r[1],G=r[2],K=r[3];return(_=S*N+I*V+A*G+L*K)<0&&(_=-_,N=-N,V=-V,G=-G,K=-K),1-_>At?(m=Math.acos(_),y=Math.sin(m),b=Math.sin((1-d)*m)/y,w=Math.sin(d*m)/y):(b=1-d,w=d),o[0]=b*S+w*N,o[1]=b*I+w*V,o[2]=b*A+w*G,o[3]=b*L+w*K,o},h.b5=function(o){let t=new Float64Array(9);var r,d,m,_,y,b,w,S,I,A,L,N,V,G,K,ne,me,ae;A=(m=(d=o)[0])*(w=m+m),L=(_=d[1])*w,V=(y=d[2])*w,G=y*(S=_+_),ne=(b=d[3])*w,me=b*S,ae=b*(I=y+y),(r=t)[0]=1-(N=_*S)-(K=y*I),r[3]=L-ae,r[6]=V+me,r[1]=L+ae,r[4]=1-A-K,r[7]=G-ne,r[2]=V-me,r[5]=G+ne,r[8]=1-A-N;let B=sn(-Math.asin(Cn(t[2],-1,1))),W,ce;return Math.hypot(t[5],t[8])<.001?(W=0,ce=-sn(Math.atan2(t[3],t[4]))):(W=sn(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ce=sn(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:W,pitch:B+90,bearing:ce}},h.b6=function(o,t){return o.roll==t.roll&&o.pitch==t.pitch&&o.bearing==t.bearing},h.b7=Zt,h.b8=Hd,h.b9=Xd,h.bA=function(o){if(o.type==="custom")return new pM(o);switch(o.type){case"background":return new dM(o);case"circle":return new o2(o);case"fill":return new M2(o);case"fill-extrusion":return new D2(o);case"heatmap":return new a2(o);case"hillshade":return new c2(o);case"line":return new V2(o);case"raster":return new hM(o);case"symbol":return new Pm(o)}},h.bB=fr,h.bC=function(o,t){if(!o)return[{command:"setStyle",args:[t]}];let r=[];try{if(!Ce(o.version,t.version))return[{command:"setStyle",args:[t]}];Ce(o.center,t.center)||r.push({command:"setCenter",args:[t.center]}),Ce(o.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),Ce(o.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Ce(o.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),Ce(o.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),Ce(o.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),Ce(o.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),Ce(o.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),Ce(o.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),Ce(o.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),Ce(o.light,t.light)||r.push({command:"setLight",args:[t.light]}),Ce(o.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),Ce(o.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),Ce(o.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});let d={},m=[];(function(y,b,w,S){let I;for(I in b=b||{},y=y||{})Object.prototype.hasOwnProperty.call(y,I)&&(Object.prototype.hasOwnProperty.call(b,I)||je(I,w,S));for(I in b)Object.prototype.hasOwnProperty.call(b,I)&&(Object.prototype.hasOwnProperty.call(y,I)?Ce(y[I],b[I])||(y[I].type==="geojson"&&b[I].type==="geojson"&&et(y,b,I)?Ee(w,{command:"setGeoJSONSourceData",args:[I,b[I].data]}):Ye(I,b,w,S)):we(I,b,w))})(o.sources,t.sources,m,d);let _=[];o.layers&&o.layers.forEach(y=>{"source"in y&&d[y.source]?r.push({command:"removeLayer",args:[y.id]}):_.push(y)}),r=r.concat(m),function(y,b,w){b=b||[];let S=(y=y||[]).map(Dt),I=b.map(Dt),A=y.reduce(Pt,{}),L=b.reduce(Pt,{}),N=S.slice(),V=Object.create(null),G,K,ne,me,ae;for(let B=0,W=0;B<S.length;B++)G=S[B],Object.prototype.hasOwnProperty.call(L,G)?W++:(Ee(w,{command:"removeLayer",args:[G]}),N.splice(N.indexOf(G,W),1));for(let B=0,W=0;B<I.length;B++)G=I[I.length-1-B],N[N.length-1-B]!==G&&(Object.prototype.hasOwnProperty.call(A,G)?(Ee(w,{command:"removeLayer",args:[G]}),N.splice(N.lastIndexOf(G,N.length-W),1)):W++,me=N[N.length-B],Ee(w,{command:"addLayer",args:[L[G],me]}),N.splice(N.length-B,0,G),V[G]=!0);for(let B=0;B<I.length;B++)if(G=I[B],K=A[G],ne=L[G],!V[G]&&!Ce(K,ne))if(Ce(K.source,ne.source)&&Ce(K["source-layer"],ne["source-layer"])&&Ce(K.type,ne.type)){for(ae in gt(K.layout,ne.layout,w,G,null,"setLayoutProperty"),gt(K.paint,ne.paint,w,G,null,"setPaintProperty"),Ce(K.filter,ne.filter)||Ee(w,{command:"setFilter",args:[G,ne.filter]}),Ce(K.minzoom,ne.minzoom)&&Ce(K.maxzoom,ne.maxzoom)||Ee(w,{command:"setLayerZoomRange",args:[G,ne.minzoom,ne.maxzoom]}),K)Object.prototype.hasOwnProperty.call(K,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?gt(K[ae],ne[ae],w,G,ae.slice(6),"setPaintProperty"):Ce(K[ae],ne[ae])||Ee(w,{command:"setLayerProperty",args:[G,ae,ne[ae]]}));for(ae in ne)Object.prototype.hasOwnProperty.call(ne,ae)&&!Object.prototype.hasOwnProperty.call(K,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?gt(K[ae],ne[ae],w,G,ae.slice(6),"setPaintProperty"):Ce(K[ae],ne[ae])||Ee(w,{command:"setLayerProperty",args:[G,ae,ne[ae]]}))}else Ee(w,{command:"removeLayer",args:[G]}),me=N[N.lastIndexOf(G)+1],Ee(w,{command:"addLayer",args:[ne,me]})}(_,t.layers,r)}catch(d){console.warn("Unable to compute style diff:",d),r=[{command:"setStyle",args:[t]}]}return r},h.bD=function(o){let t=[],r=o.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),o.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},h.bE=function o(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let d=0;d<t.length;d++)if(!o(t[d],r[d]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(let d in t)if(!o(t[d],r[d]))return!1;return!0}return t===r},h.bF=Yr,h.bG=ns,h.bH=class extends zi{constructor(o,t){super(o,t),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},h.bI=mm,h.bJ=class extends zi{constructor(o,t){super(o,t),this.current=Gg}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let t=1;t<16;t++)if(o[t]!==this.current[t]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},h.bK=pm,h.bL=class extends zi{constructor(o,t){super(o,t),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},h.bM=class extends zi{constructor(o,t){super(o,t),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},h.bN=Qi,h.bO=function(o,t){var r=Math.sin(t),d=Math.cos(t);return o[0]=d,o[1]=r,o[2]=0,o[3]=-r,o[4]=d,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},h.bP=function(o,t,r){var d=t[0],m=t[1],_=t[2];return o[0]=d*r[0]+m*r[3]+_*r[6],o[1]=d*r[1]+m*r[4]+_*r[7],o[2]=d*r[2]+m*r[5]+_*r[8],o},h.bQ=function(o,t,r,d,m,_,y){var b=1/(t-r),w=1/(d-m),S=1/(_-y);return o[0]=-2*b,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*w,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*S,o[11]=0,o[12]=(t+r)*b,o[13]=(m+d)*w,o[14]=(y+_)*S,o[15]=1,o},h.bR=class extends zi{constructor(o,t){super(o,t),this.current=new Array}set(o){if(o!=this.current){this.current=o;let t=new Float32Array(4*o.length);for(let r=0;r<o.length;r++)t[4*r]=o[r].r,t[4*r+1]=o[r].g,t[4*r+2]=o[r].b,t[4*r+3]=o[r].a;this.gl.uniform4fv(this.location,t)}}},h.bS=class extends zi{constructor(o,t){super(o,t),this.current=new Array}set(o){if(o!=this.current){this.current=o;let t=new Float32Array(o);this.gl.uniform1fv(this.location,t)}}},h.bT=class extends g{},h.bU=G2,h.bV=class extends x{},h.bW=Kg,h.bX=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},h.bY=mv,h.bZ=function(o,t,r){var d=t[0],m=t[1],_=t[2],y=r[3]*d+r[7]*m+r[11]*_+r[15];return o[0]=(r[0]*d+r[4]*m+r[8]*_+r[12])/(y=y||1),o[1]=(r[1]*d+r[5]*m+r[9]*_+r[13])/y,o[2]=(r[2]*d+r[6]*m+r[10]*_+r[14])/y,o},h.b_=class extends Ga{},h.ba=Ch,h.bb=qd,h.bc=po,h.bd=nn,h.be=ar,h.bf=function(o,t,r,d,m){return po(d,m,Cn((o-t)/(r-t),0,1))},h.bg=Pr,h.bh=function(){return new Float64Array(3)},h.bi=function(o,t,r,d){return o[0]=t[0]+r[0]*d,o[1]=t[1]+r[1]*d,o[2]=t[2]+r[2]*d,o},h.bj=Vi,h.bk=function(){return new Float64Array(4)},h.bl=function(o,t,r,d){var m=[],_=[];return m[0]=t[0]-r[0],m[1]=t[1]-r[1],m[2]=t[2]-r[2],_[0]=m[0]*Math.cos(d)-m[1]*Math.sin(d),_[1]=m[0]*Math.sin(d)+m[1]*Math.cos(d),_[2]=m[2],o[0]=_[0]+r[0],o[1]=_[1]+r[1],o[2]=_[2]+r[2],o},h.bm=function(o,t,r,d){var m=[],_=[];return m[0]=t[0]-r[0],m[1]=t[1]-r[1],m[2]=t[2]-r[2],_[0]=m[0],_[1]=m[1]*Math.cos(d)-m[2]*Math.sin(d),_[2]=m[1]*Math.sin(d)+m[2]*Math.cos(d),o[0]=_[0]+r[0],o[1]=_[1]+r[1],o[2]=_[2]+r[2],o},h.bn=function(o,t,r,d){var m=[],_=[];return m[0]=t[0]-r[0],m[1]=t[1]-r[1],m[2]=t[2]-r[2],_[0]=m[2]*Math.sin(d)+m[0]*Math.cos(d),_[1]=m[1],_[2]=m[2]*Math.cos(d)-m[0]*Math.sin(d),o[0]=_[0]+r[0],o[1]=_[1]+r[1],o[2]=_[2]+r[2],o},h.bo=ks,h.bp=function(o,t,r){var d=Math.sin(r),m=Math.cos(r),_=t[0],y=t[1],b=t[2],w=t[3],S=t[8],I=t[9],A=t[10],L=t[11];return t!==o&&(o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=_*m-S*d,o[1]=y*m-I*d,o[2]=b*m-A*d,o[3]=w*m-L*d,o[8]=_*d+S*m,o[9]=y*d+I*m,o[10]=b*d+A*m,o[11]=w*d+L*m,o},h.bq=function(o,t){let r=Pr(o,360),d=Pr(t,360),m=d-r,_=d>r?m-360:m+360;return Math.abs(m)<Math.abs(_)?m:_},h.br=function(o){return o[0]=0,o[1]=0,o[2]=0,o},h.bs=function(o,t,r,d){let m=Math.sqrt(o*o+t*t),_=Math.sqrt(r*r+d*d);o/=m,t/=m,r/=_,d/=_;let y=Math.acos(o*r+t*d);return-t*r+o*d>0?y:-y},h.bt=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]},h.bu=x_,h.bv=function(o,t){let r=Pr(o,2*Math.PI),d=Pr(t,2*Math.PI);return Math.min(Math.abs(r-d),Math.abs(r-d+2*Math.PI),Math.abs(r-d-2*Math.PI))},h.bw=function(){let o={},t=Q.$version;for(let r in Q.$root){let d=Q.$root[r];if(d.required){let m=null;m=r==="version"?t:d.type==="array"?[]:{},m!=null&&(o[r]=m)}}return o},h.bx=oh,h.by=or,h.bz=function(o){o=o.slice();let t=Object.create(null);for(let r=0;r<o.length;r++)t[o[r].id]=o[r];for(let r=0;r<o.length;r++)"ref"in o[r]&&(o[r]=ye(o[r],t[o[r].ref]));return o},h.c=Oi,h.c0=function(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]&&o[4]===t[4]&&o[5]===t[5]&&o[6]===t[6]&&o[7]===t[7]&&o[8]===t[8]&&o[9]===t[9]&&o[10]===t[10]&&o[11]===t[11]&&o[12]===t[12]&&o[13]===t[13]&&o[14]===t[14]&&o[15]===t[15]},h.c1=function(o,t){var r=o[0],d=o[1],m=o[2],_=o[3],y=o[4],b=o[5],w=o[6],S=o[7],I=o[8],A=o[9],L=o[10],N=o[11],V=o[12],G=o[13],K=o[14],ne=o[15],me=t[0],ae=t[1],B=t[2],W=t[3],ce=t[4],Pe=t[5],Ue=t[6],Ie=t[7],Le=t[8],Ze=t[9],Ge=t[10],We=t[11],Ne=t[12],ot=t[13],vt=t[14],_t=t[15];return Math.abs(r-me)<=At*Math.max(1,Math.abs(r),Math.abs(me))&&Math.abs(d-ae)<=At*Math.max(1,Math.abs(d),Math.abs(ae))&&Math.abs(m-B)<=At*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(_-W)<=At*Math.max(1,Math.abs(_),Math.abs(W))&&Math.abs(y-ce)<=At*Math.max(1,Math.abs(y),Math.abs(ce))&&Math.abs(b-Pe)<=At*Math.max(1,Math.abs(b),Math.abs(Pe))&&Math.abs(w-Ue)<=At*Math.max(1,Math.abs(w),Math.abs(Ue))&&Math.abs(S-Ie)<=At*Math.max(1,Math.abs(S),Math.abs(Ie))&&Math.abs(I-Le)<=At*Math.max(1,Math.abs(I),Math.abs(Le))&&Math.abs(A-Ze)<=At*Math.max(1,Math.abs(A),Math.abs(Ze))&&Math.abs(L-Ge)<=At*Math.max(1,Math.abs(L),Math.abs(Ge))&&Math.abs(N-We)<=At*Math.max(1,Math.abs(N),Math.abs(We))&&Math.abs(V-Ne)<=At*Math.max(1,Math.abs(V),Math.abs(Ne))&&Math.abs(G-ot)<=At*Math.max(1,Math.abs(G),Math.abs(ot))&&Math.abs(K-vt)<=At*Math.max(1,Math.abs(K),Math.abs(vt))&&Math.abs(ne-_t)<=At*Math.max(1,Math.abs(ne),Math.abs(_t))},h.c2=function(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},h.c3=o=>o.type==="symbol",h.c4=o=>o.type==="circle",h.c5=o=>o.type==="heatmap",h.c6=o=>o.type==="line",h.c7=o=>o.type==="fill",h.c8=o=>o.type==="fill-extrusion",h.c9=o=>o.type==="hillshade",h.cA=i_,h.cB=a_,h.cC=Sh,h.cD=u_,h.cE=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},h.cF=function(o,t,r,d,m){return s(this,void 0,void 0,function*(){if(Mi())try{return yield Pn(o,t,r,d,m)}catch{}return function(_,y,b,w,S){let I=_.width,A=_.height;Fn&&zr||(Fn=new OffscreenCanvas(I,A),zr=Fn.getContext("2d",{willReadFrequently:!0})),Fn.width=I,Fn.height=A,zr.drawImage(_,0,0,I,A);let L=zr.getImageData(y,b,w,S);return zr.clearRect(0,0,I,A),L.data}(o,t,r,d,m)})},h.cG=pb,h.cH=P,h.cI=be,h.cJ=Av,h.cK=$v,h.cL=El,h.cM=ys,h.ca=o=>o.type==="raster",h.cb=o=>o.type==="background",h.cc=o=>o.type==="custom",h.cd=mo,h.ce=function(o,t,r){let d=Ds(t.x-r.x,t.y-r.y),m=Ds(o.x-r.x,o.y-r.y);var _,y;return sn(Math.atan2(d[0]*m[1]-d[1]*m[0],(_=d)[0]*(y=m)[0]+_[1]*y[1]))},h.cf=wn,h.cg=function(o,t){return Er[t]&&(o instanceof MouseEvent||o instanceof WheelEvent)},h.ch=function(o,t){return gr[t]&&"touches"in o},h.ci=function(o){return gr[o]||Er[o]},h.cj=function(o,t,r){var d=t[0],m=t[1];return o[0]=r[0]*d+r[4]*m+r[12],o[1]=r[1]*d+r[5]*m+r[13],o},h.ck=function(o,t){let{x:r,y:d}=Ah.fromLngLat(t);return!(o<0||o>25||d<0||d>=1||r<0||r>=1)},h.cl=function(o,t){return o[0]=t[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=t[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=t[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},h.cm=class extends zc{},h.cn=MM,h.cp=function(o){return o.message===ji},h.cq=Ii,h.cr=function(o,t){Br.REGISTERED_PROTOCOLS[o]=t},h.cs=function(o){delete Br.REGISTERED_PROTOCOLS[o]},h.ct=function(o,t){let r={};for(let m=0;m<o.length;m++){let _=t&&t[o[m].id]||Fe(o[m]);t&&(t[o[m].id]=_);let y=r[_];y||(y=r[_]=[]),y.push(o[m])}let d=[];for(let m in r)d.push(r[m]);return d},h.cu=nt,h.cv=mb,h.cw=gb,h.cx=Hv,h.cy=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=mi/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;let t=o.bucket.layers[0],r=t.layout,d=t._unevaluatedLayout._values,m={layoutIconSize:d["icon-size"].possiblyEvaluate(new Li(o.bucket.zoom+1),o.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new Li(o.bucket.zoom+1),o.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new Li(18))};if(o.bucket.textSizeData.kind==="composite"){let{minZoom:S,maxZoom:I}=o.bucket.textSizeData;m.compositeTextSizes=[d["text-size"].possiblyEvaluate(new Li(S),o.canonical),d["text-size"].possiblyEvaluate(new Li(I),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){let{minZoom:S,maxZoom:I}=o.bucket.iconSizeData;m.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new Li(S),o.canonical),d["icon-size"].possiblyEvaluate(new Li(I),o.canonical)]}let _=r.get("text-line-height")*kn,y=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",b=r.get("text-keep-upright"),w=r.get("text-size");for(let S of o.bucket.features){let I=r.get("text-font").evaluate(S,{},o.canonical).join(","),A=w.evaluate(S,{},o.canonical),L=m.layoutTextSize.evaluate(S,{},o.canonical),N=m.layoutIconSize.evaluate(S,{},o.canonical),V={horizontal:{},vertical:void 0},G=S.text,K,ne=[0,0];if(G){let B=G.toString(),W=r.get("text-letter-spacing").evaluate(S,{},o.canonical)*kn,ce=Ng(B)?W:0,Pe=r.get("text-anchor").evaluate(S,{},o.canonical),Ue=Tb(t,S,o.canonical);if(!Ue){let Ge=r.get("text-radial-offset").evaluate(S,{},o.canonical);ne=Ge?Eb(Pe,[Ge*kn,M_]):r.get("text-offset").evaluate(S,{},o.canonical).map(We=>We*kn)}let Ie=y?"center":r.get("text-justify").evaluate(S,{},o.canonical),Le=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(S,{},o.canonical)*kn:1/0,Ze=()=>{o.bucket.allowVerticalPlacement&&jd(B)&&(V.vertical=Cm(G,o.glyphMap,o.glyphPositions,o.imagePositions,I,Le,_,Pe,"left",ce,ne,h.al.vertical,!0,L,A))};if(!y&&Ue){let Ge=new Set;if(Ie==="auto")for(let Ne=0;Ne<Ue.values.length;Ne+=2)Ge.add(S_(Ue.values[Ne]));else Ge.add(Ie);let We=!1;for(let Ne of Ge)if(!V.horizontal[Ne])if(We)V.horizontal[Ne]=V.horizontal[0];else{let ot=Cm(G,o.glyphMap,o.glyphPositions,o.imagePositions,I,Le,_,"center",Ne,ce,ne,h.al.horizontal,!1,L,A);ot&&(V.horizontal[Ne]=ot,We=ot.positionedLines.length===1)}Ze()}else{Ie==="auto"&&(Ie=S_(Pe));let Ge=Cm(G,o.glyphMap,o.glyphPositions,o.imagePositions,I,Le,_,Pe,Ie,ce,ne,h.al.horizontal,!1,L,A);Ge&&(V.horizontal[Ie]=Ge),Ze(),jd(B)&&y&&b&&(V.vertical=Cm(G,o.glyphMap,o.glyphPositions,o.imagePositions,I,Le,_,Pe,Ie,ce,ne,h.al.vertical,!1,L,A))}}let me=!1;if(S.icon&&S.icon.name){let B=o.imageMap[S.icon.name];B&&(K=oM(o.imagePositions[S.icon.name],r.get("icon-offset").evaluate(S,{},o.canonical),r.get("icon-anchor").evaluate(S,{},o.canonical)),me=!!B.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=me:o.bucket.sdfIcons!==me&&Sn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(B.pixelRatio!==o.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}let ae=kb(V.horizontal)||V.vertical;o.bucket.iconsInText=!!ae&&ae.iconsInText,(ae||K)&&wM(o.bucket,S,V,K,o.imageMap,m,L,N,ne,me,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},h.cz=l_,h.d=xe,h.e=Mn,h.f=o=>s(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));let t=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),h.g=fo,h.h=o=>new Promise((t,r)=>{let d=new Image;d.onload=()=>{t(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame(()=>{d.src=ha})},d.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let m=new Blob([new Uint8Array(o)],{type:"image/png"});d.src=o.byteLength?URL.createObjectURL(m):ha}),h.i=Kr,h.j=(o,t)=>Tr(Mn(o,{type:"json"}),t),h.k=le,h.l=J,h.m=Tr,h.n=(o,t)=>Tr(Mn(o,{type:"arrayBuffer"}),t),h.o=function(o){return new u_(o).readFields(W2,[])},h.p=Gv,h.q=yh,h.r=gn,h.s=Lo,h.t=zd,h.u=Yt,h.v=Q,h.w=Sn,h.x=rh,h.y=Ll,h.z=function([o,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:o*Math.cos(t)*Math.sin(r),y:o*Math.sin(t)*Math.sin(r),z:o*Math.cos(r)}}}),i("worker",["./shared"],function(h){"use strict";class s{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,Z){for(let le of H){this._layerConfigs[le.id]=le;let fe=this._layers[le.id]=h.bA(le);fe._featureFilter=h.a7(fe.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(let le of Z)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};let J=h.ct(Object.values(this._layerConfigs),this.keyCache);for(let le of J){let fe=le.map(we=>this._layers[we.id]),Q=fe[0];if(Q.visibility==="none")continue;let Me=Q.source||"",ye=this.familiesBySource[Me];ye||(ye=this.familiesBySource[Me]={});let Ce=Q.sourceLayer||"_geojsonTileLayer",Ee=ye[Ce];Ee||(Ee=ye[Ce]=[]),Ee.push(fe)}}}class P{constructor(H){let Z={},J=[];for(let Me in H){let ye=H[Me],Ce=Z[Me]={};for(let Ee in ye){let we=ye[+Ee];if(!we||we.bitmap.width===0||we.bitmap.height===0)continue;let je={x:0,y:0,w:we.bitmap.width+2,h:we.bitmap.height+2};J.push(je),Ce[Ee]={rect:je,metrics:we.metrics}}}let{w:le,h:fe}=h.p(J),Q=new h.q({width:le||1,height:fe||1});for(let Me in H){let ye=H[Me];for(let Ce in ye){let Ee=ye[+Ce];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;let we=Z[Me][Ce].rect;h.q.copy(Ee.bitmap,Q,{x:0,y:0},{x:we.x+1,y:we.y+1},Ee.bitmap)}}this.image=Q,this.positions=Z}}h.cu("GlyphAtlas",P);class q{constructor(H){this.tileID=new h.Y(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId,this.inFlightDependencies=[]}parse(H,Z,J,le,fe){return h._(this,void 0,void 0,function*(){this.status="parsing",this.data=H,this.collisionBoxArray=new h.a5;let Q=new h.cv(Object.keys(H.layers).sort()),Me=new h.cw(this.tileID,this.promoteId);Me.bucketLayerIDs=[];let ye={},Ce={featureIndex:Me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:J,subdivisionGranularity:fe},Ee=Z.familiesBySource[this.source];for(let Mt in Ee){let Ve=H.layers[Mt];if(!Ve)continue;Ve.version===1&&h.w(`Vector tile source "${this.source}" layer "${Mt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let yt=Q.encode(Mt),Rt=[];for(let Tt=0;Tt<Ve.length;Tt++){let Ui=Ve.feature(Tt),sr=Me.getId(Ui,Mt);Rt.push({feature:Ui,id:sr,index:Tt,sourceLayerIndex:yt})}for(let Tt of Ee[Mt]){let Ui=Tt[0];Ui.source!==this.source&&h.w(`layer.source = ${Ui.source} does not equal this.source = ${this.source}`),Ui.minzoom&&this.zoom<Math.floor(Ui.minzoom)||Ui.maxzoom&&this.zoom>=Ui.maxzoom||Ui.visibility!=="none"&&(X(Tt,this.zoom,J),(ye[Ui.id]=Ui.createBucket({index:Me.bucketLayerIDs.length,layers:Tt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yt,sourceID:this.source})).populate(Rt,Ce,this.tileID.canonical),Me.bucketLayerIDs.push(Tt.map(sr=>sr.id)))}}let we=h.bF(Ce.glyphDependencies,Mt=>Object.keys(Mt).map(Number));this.inFlightDependencies.forEach(Mt=>Mt?.abort()),this.inFlightDependencies=[];let je=Promise.resolve({});if(Object.keys(we).length){let Mt=new AbortController;this.inFlightDependencies.push(Mt),je=le.sendAsync({type:"GG",data:{stacks:we,source:this.source,tileID:this.tileID,type:"glyphs"}},Mt)}let Ye=Object.keys(Ce.iconDependencies),et=Promise.resolve({});if(Ye.length){let Mt=new AbortController;this.inFlightDependencies.push(Mt),et=le.sendAsync({type:"GI",data:{icons:Ye,source:this.source,tileID:this.tileID,type:"icons"}},Mt)}let gt=Object.keys(Ce.patternDependencies),Dt=Promise.resolve({});if(gt.length){let Mt=new AbortController;this.inFlightDependencies.push(Mt),Dt=le.sendAsync({type:"GI",data:{icons:gt,source:this.source,tileID:this.tileID,type:"patterns"}},Mt)}let[Pt,De,ai]=yield Promise.all([je,et,Dt]),jt=new P(Pt),li=new h.cx(De,ai);for(let Mt in ye){let Ve=ye[Mt];Ve instanceof h.a6?(X(Ve.layers,this.zoom,J),h.cy({bucket:Ve,glyphMap:Pt,glyphPositions:jt.positions,imageMap:De,imagePositions:li.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ce.subdivisionGranularity})):Ve.hasPattern&&(Ve instanceof h.cz||Ve instanceof h.cA||Ve instanceof h.cB)&&(X(Ve.layers,this.zoom,J),Ve.addFeatures(Ce,this.tileID.canonical,li.patternPositions))}return this.status="done",{buckets:Object.values(ye).filter(Mt=>!Mt.isEmpty()),featureIndex:Me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:jt.image,imageAtlas:li,glyphMap:this.returnDependencies?Pt:null,iconMap:this.returnDependencies?De:null,glyphPositions:this.returnDependencies?jt.positions:null}})}}function X(xe,H,Z){let J=new h.C(H);for(let le of xe)le.recalculate(J,Z)}class be{constructor(H,Z,J){this.actor=H,this.layerIndex=Z,this.availableImages=J,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(H,Z){return h._(this,void 0,void 0,function*(){let J=yield h.n(H.request,Z);try{return{vectorTile:new h.cC.VectorTile(new h.cD(J.data)),rawData:J.data,cacheControl:J.cacheControl,expires:J.expires}}catch(le){let fe=new Uint8Array(J.data),Q=`Unable to parse the tile at ${H.request.url}, `;throw Q+=fe[0]===31&&fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${le.message}`,new Error(Q)}})}loadTile(H){return h._(this,void 0,void 0,function*(){let Z=H.uid,J=!!(H&&H.request&&H.request.collectResourceTiming)&&new h.cE(H.request),le=new q(H);this.loading[Z]=le;let fe=new AbortController;le.abort=fe;try{let Q=yield this.loadVectorTile(H,fe);if(delete this.loading[Z],!Q)return null;let Me=Q.rawData,ye={};Q.expires&&(ye.expires=Q.expires),Q.cacheControl&&(ye.cacheControl=Q.cacheControl);let Ce={};if(J){let we=J.finish();we&&(Ce.resourceTiming=JSON.parse(JSON.stringify(we)))}le.vectorTile=Q.vectorTile;let Ee=le.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity);this.loaded[Z]=le,this.fetching[Z]={rawTileData:Me,cacheControl:ye,resourceTiming:Ce};try{let we=yield Ee;return h.e({rawTileData:Me.slice(0)},we,ye,Ce)}finally{delete this.fetching[Z]}}catch(Q){throw delete this.loading[Z],le.status="done",this.loaded[Z]=le,Q}})}reloadTile(H){return h._(this,void 0,void 0,function*(){let Z=H.uid;if(!this.loaded||!this.loaded[Z])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let J=this.loaded[Z];if(J.showCollisionBoxes=H.showCollisionBoxes,J.status==="parsing"){let le=yield J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity),fe;if(this.fetching[Z]){let{rawTileData:Q,cacheControl:Me,resourceTiming:ye}=this.fetching[Z];delete this.fetching[Z],fe=h.e({rawTileData:Q.slice(0)},le,Me,ye)}else fe=le;return fe}if(J.status==="done"&&J.vectorTile)return J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,H.subdivisionGranularity)})}abortTile(H){return h._(this,void 0,void 0,function*(){let Z=this.loading,J=H.uid;Z&&Z[J]&&Z[J].abort&&(Z[J].abort.abort(),delete Z[J])})}removeTile(H){return h._(this,void 0,void 0,function*(){this.loaded&&this.loaded[H.uid]&&delete this.loaded[H.uid]})}}class ve{constructor(){this.loaded={}}loadTile(H){return h._(this,void 0,void 0,function*(){let{uid:Z,encoding:J,rawImageData:le,redFactor:fe,greenFactor:Q,blueFactor:Me,baseShift:ye}=H,Ce=le.width+2,Ee=le.height+2,we=h.b(le)?new h.R({width:Ce,height:Ee},yield h.cF(le,-1,-1,Ce,Ee)):le,je=new h.cG(Z,we,J,fe,Q,Me,ye);return this.loaded=this.loaded||{},this.loaded[Z]=je,je})}removeTile(H){let Z=this.loaded,J=H.uid;Z&&Z[J]&&delete Z[J]}}var $,$e,ht=function(){if($e)return $;function xe(Z,J){if(Z.length!==0){H(Z[0],J);for(var le=1;le<Z.length;le++)H(Z[le],!J)}}function H(Z,J){for(var le=0,fe=0,Q=0,Me=Z.length,ye=Me-1;Q<Me;ye=Q++){var Ce=(Z[Q][0]-Z[ye][0])*(Z[ye][1]+Z[Q][1]),Ee=le+Ce;fe+=Math.abs(le)>=Math.abs(Ce)?le-Ee+Ce:Ce-Ee+le,le=Ee}le+fe>=0!=!!J&&Z.reverse()}return $e=1,$=function Z(J,le){var fe,Q=J&&J.type;if(Q==="FeatureCollection")for(fe=0;fe<J.features.length;fe++)Z(J.features[fe],le);else if(Q==="GeometryCollection")for(fe=0;fe<J.geometries.length;fe++)Z(J.geometries[fe],le);else if(Q==="Feature")Z(J.geometry,le);else if(Q==="Polygon")xe(J.coordinates,le);else if(Q==="MultiPolygon")for(fe=0;fe<J.coordinates.length;fe++)xe(J.coordinates[fe],le);return J}}(),wt=h.cH(ht);let lt=h.cC.VectorTileFeature.prototype.toGeoJSON;class at{constructor(H){this._feature=H,this.extent=h.Z,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(this._feature.type===1){let H=[];for(let Z of this._feature.geometry)H.push([new h.P(Z[0],Z[1])]);return H}{let H=[];for(let Z of this._feature.geometry){let J=[];for(let le of Z)J.push(new h.P(le[0],le[1]));H.push(J)}return H}}toGeoJSON(H,Z,J){return lt.call(this,H,Z,J)}}class hi{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.Z,this.length=H.length,this._features=H}feature(H){return new at(this._features[H])}}var Mi,At,bi,Qi={exports:{}},pi=function(){if(bi)return Qi.exports;bi=1;var xe=h.cK(),H=function(){if(At)return Mi;At=1;var Ee=h.cI(),we=h.cJ().VectorTileFeature;function je(et,gt){this.options=gt||{},this.features=et,this.length=et.length}function Ye(et,gt){this.id=typeof et.id=="number"?et.id:void 0,this.type=et.type,this.rawGeometry=et.type===1?[et.geometry]:et.geometry,this.properties=et.tags,this.extent=gt||4096}return Mi=je,je.prototype.feature=function(et){return new Ye(this.features[et],this.options.extent)},Ye.prototype.loadGeometry=function(){var et=this.rawGeometry;this.geometry=[];for(var gt=0;gt<et.length;gt++){for(var Dt=et[gt],Pt=[],De=0;De<Dt.length;De++)Pt.push(new Ee(Dt[De][0],Dt[De][1]));this.geometry.push(Pt)}return this.geometry},Ye.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var et=this.geometry,gt=1/0,Dt=-1/0,Pt=1/0,De=-1/0,ai=0;ai<et.length;ai++)for(var jt=et[ai],li=0;li<jt.length;li++){var Mt=jt[li];gt=Math.min(gt,Mt.x),Dt=Math.max(Dt,Mt.x),Pt=Math.min(Pt,Mt.y),De=Math.max(De,Mt.y)}return[gt,Pt,Dt,De]},Ye.prototype.toGeoJSON=we.prototype.toGeoJSON,Mi}();function Z(Ee){var we=new xe;return function(je,Ye){for(var et in je.layers)Ye.writeMessage(3,J,je.layers[et])}(Ee,we),we.finish()}function J(Ee,we){var je;we.writeVarintField(15,Ee.version||1),we.writeStringField(1,Ee.name||""),we.writeVarintField(5,Ee.extent||4096);var Ye={keys:[],values:[],keycache:{},valuecache:{}};for(je=0;je<Ee.length;je++)Ye.feature=Ee.feature(je),we.writeMessage(2,le,Ye);var et=Ye.keys;for(je=0;je<et.length;je++)we.writeStringField(3,et[je]);var gt=Ye.values;for(je=0;je<gt.length;je++)we.writeMessage(4,Ce,gt[je])}function le(Ee,we){var je=Ee.feature;je.id!==void 0&&we.writeVarintField(1,je.id),we.writeMessage(2,fe,Ee),we.writeVarintField(3,je.type),we.writeMessage(4,ye,je)}function fe(Ee,we){var je=Ee.feature,Ye=Ee.keys,et=Ee.values,gt=Ee.keycache,Dt=Ee.valuecache;for(var Pt in je.properties){var De=je.properties[Pt],ai=gt[Pt];if(De!==null){ai===void 0&&(Ye.push(Pt),gt[Pt]=ai=Ye.length-1),we.writeVarint(ai);var jt=typeof De;jt!=="string"&&jt!=="boolean"&&jt!=="number"&&(De=JSON.stringify(De));var li=jt+":"+De,Mt=Dt[li];Mt===void 0&&(et.push(De),Dt[li]=Mt=et.length-1),we.writeVarint(Mt)}}}function Q(Ee,we){return(we<<3)+(7&Ee)}function Me(Ee){return Ee<<1^Ee>>31}function ye(Ee,we){for(var je=Ee.loadGeometry(),Ye=Ee.type,et=0,gt=0,Dt=je.length,Pt=0;Pt<Dt;Pt++){var De=je[Pt],ai=1;Ye===1&&(ai=De.length),we.writeVarint(Q(1,ai));for(var jt=Ye===3?De.length-1:De.length,li=0;li<jt;li++){li===1&&Ye!==1&&we.writeVarint(Q(2,jt-1));var Mt=De[li].x-et,Ve=De[li].y-gt;we.writeVarint(Me(Mt)),we.writeVarint(Me(Ve)),et+=Mt,gt+=Ve}Ye===3&&we.writeVarint(Q(7,1))}}function Ce(Ee,we){var je=typeof Ee;je==="string"?we.writeStringField(1,Ee):je==="boolean"?we.writeBooleanField(7,Ee):je==="number"&&(Ee%1!=0?we.writeDoubleField(3,Ee):Ee<0?we.writeSVarintField(6,Ee):we.writeVarintField(5,Ee))}return Qi.exports=Z,Qi.exports.fromVectorTileJs=Z,Qi.exports.fromGeojsonVt=function(Ee,we){we=we||{};var je={};for(var Ye in Ee)je[Ye]=new H(Ee[Ye].features,we),je[Ye].name=Ye,je[Ye].version=we.version,je[Ye].extent=we.extent;return Z({layers:je})},Qi.exports.GeoJSONWrapper=H,Qi.exports}(),Lr=h.cH(pi);let ks={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},Zi=Math.fround||(rr=new Float32Array(1),xe=>(rr[0]=+xe,rr[0]));var rr;let Vi=3,kt=5,Xr=6;class As{constructor(H){this.options=Object.assign(Object.create(ks),H),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(H){let{log:Z,minZoom:J,maxZoom:le}=this.options;Z&&console.time("total time");let fe=`prepare ${H.length} points`;Z&&console.time(fe),this.points=H;let Q=[];for(let ye=0;ye<H.length;ye++){let Ce=H[ye];if(!Ce.geometry)continue;let[Ee,we]=Ce.geometry.coordinates,je=Zi(ho(Ee)),Ye=Zi(Pr(we));Q.push(je,Ye,1/0,ye,-1,1),this.options.reduce&&Q.push(0)}let Me=this.trees[le+1]=this._createTree(Q);Z&&console.timeEnd(fe);for(let ye=le;ye>=J;ye--){let Ce=+Date.now();Me=this.trees[ye]=this._createTree(this._cluster(Me,ye)),Z&&console.log("z%d: %d clusters in %dms",ye,Me.numItems,+Date.now()-Ce)}return Z&&console.timeEnd("total time"),this}getClusters(H,Z){let J=((H[0]+180)%360+360)%360-180,le=Math.max(-90,Math.min(90,H[1])),fe=H[2]===180?180:((H[2]+180)%360+360)%360-180,Q=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)J=-180,fe=180;else if(J>fe){let we=this.getClusters([J,le,180,Q],Z),je=this.getClusters([-180,le,fe,Q],Z);return we.concat(je)}let Me=this.trees[this._limitZoom(Z)],ye=Me.range(ho(J),Pr(Q),ho(fe),Pr(le)),Ce=Me.data,Ee=[];for(let we of ye){let je=this.stride*we;Ee.push(Ce[je+kt]>1?Ds(Ce,je,this.clusterProps):this.points[Ce[je+Vi]])}return Ee}getChildren(H){let Z=this._getOriginId(H),J=this._getOriginZoom(H),le="No cluster with the specified id.",fe=this.trees[J];if(!fe)throw new Error(le);let Q=fe.data;if(Z*this.stride>=Q.length)throw new Error(le);let Me=this.options.radius/(this.options.extent*Math.pow(2,J-1)),ye=fe.within(Q[Z*this.stride],Q[Z*this.stride+1],Me),Ce=[];for(let Ee of ye){let we=Ee*this.stride;Q[we+4]===H&&Ce.push(Q[we+kt]>1?Ds(Q,we,this.clusterProps):this.points[Q[we+Vi]])}if(Ce.length===0)throw new Error(le);return Ce}getLeaves(H,Z,J){let le=[];return this._appendLeaves(le,H,Z=Z||10,J=J||0,0),le}getTile(H,Z,J){let le=this.trees[this._limitZoom(H)],fe=Math.pow(2,H),{extent:Q,radius:Me}=this.options,ye=Me/Q,Ce=(J-ye)/fe,Ee=(J+1+ye)/fe,we={features:[]};return this._addTileFeatures(le.range((Z-ye)/fe,Ce,(Z+1+ye)/fe,Ee),le.data,Z,J,fe,we),Z===0&&this._addTileFeatures(le.range(1-ye/fe,Ce,1,Ee),le.data,fe,J,fe,we),Z===fe-1&&this._addTileFeatures(le.range(0,Ce,ye/fe,Ee),le.data,-1,J,fe,we),we.features.length?we:null}getClusterExpansionZoom(H){let Z=this._getOriginZoom(H)-1;for(;Z<=this.options.maxZoom;){let J=this.getChildren(H);if(Z++,J.length!==1)break;H=J[0].properties.cluster_id}return Z}_appendLeaves(H,Z,J,le,fe){let Q=this.getChildren(Z);for(let Me of Q){let ye=Me.properties;if(ye&&ye.cluster?fe+ye.point_count<=le?fe+=ye.point_count:fe=this._appendLeaves(H,ye.cluster_id,J,le,fe):fe<le?fe++:H.push(Me),H.length===J)break}return fe}_createTree(H){let Z=new h.aF(H.length/this.stride|0,this.options.nodeSize,Float32Array);for(let J=0;J<H.length;J+=this.stride)Z.add(H[J],H[J+1]);return Z.finish(),Z.data=H,Z}_addTileFeatures(H,Z,J,le,fe,Q){for(let Me of H){let ye=Me*this.stride,Ce=Z[ye+kt]>1,Ee,we,je;if(Ce)Ee=mi(Z,ye,this.clusterProps),we=Z[ye],je=Z[ye+1];else{let gt=this.points[Z[ye+Vi]];Ee=gt.properties;let[Dt,Pt]=gt.geometry.coordinates;we=ho(Dt),je=Pr(Pt)}let Ye={type:1,geometry:[[Math.round(this.options.extent*(we*fe-J)),Math.round(this.options.extent*(je*fe-le))]],tags:Ee},et;et=Ce||this.options.generateId?Z[ye+Vi]:this.points[Z[ye+Vi]].id,et!==void 0&&(Ye.id=et),Q.features.push(Ye)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,Z){let{radius:J,extent:le,reduce:fe,minPoints:Q}=this.options,Me=J/(le*Math.pow(2,Z)),ye=H.data,Ce=[],Ee=this.stride;for(let we=0;we<ye.length;we+=Ee){if(ye[we+2]<=Z)continue;ye[we+2]=Z;let je=ye[we],Ye=ye[we+1],et=H.within(ye[we],ye[we+1],Me),gt=ye[we+kt],Dt=gt;for(let Pt of et){let De=Pt*Ee;ye[De+2]>Z&&(Dt+=ye[De+kt])}if(Dt>gt&&Dt>=Q){let Pt,De=je*gt,ai=Ye*gt,jt=-1,li=((we/Ee|0)<<5)+(Z+1)+this.points.length;for(let Mt of et){let Ve=Mt*Ee;if(ye[Ve+2]<=Z)continue;ye[Ve+2]=Z;let yt=ye[Ve+kt];De+=ye[Ve]*yt,ai+=ye[Ve+1]*yt,ye[Ve+4]=li,fe&&(Pt||(Pt=this._map(ye,we,!0),jt=this.clusterProps.length,this.clusterProps.push(Pt)),fe(Pt,this._map(ye,Ve)))}ye[we+4]=li,Ce.push(De/Dt,ai/Dt,1/0,li,-1,Dt),fe&&Ce.push(jt)}else{for(let Pt=0;Pt<Ee;Pt++)Ce.push(ye[we+Pt]);if(Dt>1)for(let Pt of et){let De=Pt*Ee;if(!(ye[De+2]<=Z)){ye[De+2]=Z;for(let ai=0;ai<Ee;ai++)Ce.push(ye[De+ai])}}}}return Ce}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,Z,J){if(H[Z+kt]>1){let Q=this.clusterProps[H[Z+Xr]];return J?Object.assign({},Q):Q}let le=this.points[H[Z+Vi]].properties,fe=this.options.map(le);return J&&fe===le?Object.assign({},fe):fe}}function Ds(xe,H,Z){return{type:"Feature",id:xe[H+Vi],properties:mi(xe,H,Z),geometry:{type:"Point",coordinates:[(J=xe[H],360*(J-.5)),po(xe[H+1])]}};var J}function mi(xe,H,Z){let J=xe[H+kt],le=J>=1e4?`${Math.round(J/1e3)}k`:J>=1e3?Math.round(J/100)/10+"k":J,fe=xe[H+Xr],Q=fe===-1?{}:Object.assign({},Z[fe]);return Object.assign(Q,{cluster:!0,cluster_id:xe[H+Vi],point_count:J,point_count_abbreviated:le})}function ho(xe){return xe/360+.5}function Pr(xe){let H=Math.sin(xe*Math.PI/180),Z=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return Z<0?0:Z>1?1:Z}function po(xe){let H=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function nn(xe,H,Z,J){let le=J,fe=H+(Z-H>>1),Q,Me=Z-H,ye=xe[H],Ce=xe[H+1],Ee=xe[Z],we=xe[Z+1];for(let je=H+3;je<Z;je+=3){let Ye=mo(xe[je],xe[je+1],ye,Ce,Ee,we);if(Ye>le)Q=je,le=Ye;else if(Ye===le){let et=Math.abs(je-fe);et<Me&&(Q=je,Me=et)}}le>J&&(Q-H>3&&nn(xe,H,Q,J),xe[Q+2]=le,Z-Q>3&&nn(xe,Q,Z,J))}function mo(xe,H,Z,J,le,fe){let Q=le-Z,Me=fe-J;if(Q!==0||Me!==0){let ye=((xe-Z)*Q+(H-J)*Me)/(Q*Q+Me*Me);ye>1?(Z=le,J=fe):ye>0&&(Z+=Q*ye,J+=Me*ye)}return Q=xe-Z,Me=H-J,Q*Q+Me*Me}function wn(xe,H,Z,J){let le={id:xe??null,type:H,geometry:Z,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(H==="Point"||H==="MultiPoint"||H==="LineString")Cn(le,Z);else if(H==="Polygon")Cn(le,Z[0]);else if(H==="MultiLineString")for(let fe of Z)Cn(le,fe);else if(H==="MultiPolygon")for(let fe of Z)Cn(le,fe[0]);return le}function Cn(xe,H){for(let Z=0;Z<H.length;Z+=3)xe.minX=Math.min(xe.minX,H[Z]),xe.minY=Math.min(xe.minY,H[Z+1]),xe.maxX=Math.max(xe.maxX,H[Z]),xe.maxY=Math.max(xe.maxY,H[Z+1])}function mr(xe,H,Z,J){if(!H.geometry)return;let le=H.geometry.coordinates;if(le&&le.length===0)return;let fe=H.geometry.type,Q=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2),Me=[],ye=H.id;if(Z.promoteId?ye=H.properties[Z.promoteId]:Z.generateId&&(ye=J||0),fe==="Point")Mn(le,Me);else if(fe==="MultiPoint")for(let Ce of le)Mn(Ce,Me);else if(fe==="LineString")is(le,Me,Q,!1);else if(fe==="MultiLineString"){if(Z.lineMetrics){for(let Ce of le)Me=[],is(Ce,Me,Q,!1),xe.push(wn(ye,"LineString",Me,H.properties));return}Yr(le,Me,Q,!1)}else if(fe==="Polygon")Yr(le,Me,Q,!0);else{if(fe!=="MultiPolygon"){if(fe==="GeometryCollection"){for(let Ce of H.geometry.geometries)mr(xe,{id:ye,geometry:Ce,properties:H.properties},Z,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let Ce of le){let Ee=[];Yr(Ce,Ee,Q,!0),Me.push(Ee)}}xe.push(wn(ye,fe,Me,H.properties))}function Mn(xe,H){H.push(ns(xe[0]),fr(xe[1]),0)}function is(xe,H,Z,J){let le,fe,Q=0;for(let ye=0;ye<xe.length;ye++){let Ce=ns(xe[ye][0]),Ee=fr(xe[ye][1]);H.push(Ce,Ee,0),ye>0&&(Q+=J?(le*Ee-Ce*fe)/2:Math.sqrt(Math.pow(Ce-le,2)+Math.pow(Ee-fe,2))),le=Ce,fe=Ee}let Me=H.length-3;H[2]=1,nn(H,0,Me,Z),H[Me+2]=1,H.size=Math.abs(Q),H.start=0,H.end=H.size}function Yr(xe,H,Z,J){for(let le=0;le<xe.length;le++){let fe=[];is(xe[le],fe,Z,J),H.push(fe)}}function ns(xe){return xe/360+.5}function fr(xe){let H=Math.sin(xe*Math.PI/180),Z=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return Z<0?0:Z>1?1:Z}function Zn(xe,H,Z,J,le,fe,Q,Me){if(J/=H,fe>=(Z/=H)&&Q<J)return xe;if(Q<Z||fe>=J)return null;let ye=[];for(let Ce of xe){let Ee=Ce.geometry,we=Ce.type,je=le===0?Ce.minX:Ce.minY,Ye=le===0?Ce.maxX:Ce.maxY;if(je>=Z&&Ye<J){ye.push(Ce);continue}if(Ye<Z||je>=J)continue;let et=[];if(we==="Point"||we==="MultiPoint")Sn(Ee,et,Z,J,le);else if(we==="LineString")xi(Ee,et,Z,J,le,!1,Me.lineMetrics);else if(we==="MultiLineString")rn(Ee,et,Z,J,le,!1);else if(we==="Polygon")rn(Ee,et,Z,J,le,!0);else if(we==="MultiPolygon")for(let gt of Ee){let Dt=[];rn(gt,Dt,Z,J,le,!0),Dt.length&&et.push(Dt)}if(et.length){if(Me.lineMetrics&&we==="LineString"){for(let gt of et)ye.push(wn(Ce.id,we,gt,Ce.tags));continue}we!=="LineString"&&we!=="MultiLineString"||(et.length===1?(we="LineString",et=et[0]):we="MultiLineString"),we!=="Point"&&we!=="MultiPoint"||(we=et.length===3?"Point":"MultiPoint"),ye.push(wn(Ce.id,we,et,Ce.tags))}}return ye.length?ye:null}function Sn(xe,H,Z,J,le){for(let fe=0;fe<xe.length;fe+=3){let Q=xe[fe+le];Q>=Z&&Q<=J&&on(H,xe[fe],xe[fe+1],xe[fe+2])}}function xi(xe,H,Z,J,le,fe,Q){let Me=Kr(xe),ye=le===0?ha:Pn,Ce,Ee,we=xe.start;for(let Dt=0;Dt<xe.length-3;Dt+=3){let Pt=xe[Dt],De=xe[Dt+1],ai=xe[Dt+2],jt=xe[Dt+3],li=xe[Dt+4],Mt=le===0?Pt:De,Ve=le===0?jt:li,yt=!1;Q&&(Ce=Math.sqrt(Math.pow(Pt-jt,2)+Math.pow(De-li,2))),Mt<Z?Ve>Z&&(Ee=ye(Me,Pt,De,jt,li,Z),Q&&(Me.start=we+Ce*Ee)):Mt>J?Ve<J&&(Ee=ye(Me,Pt,De,jt,li,J),Q&&(Me.start=we+Ce*Ee)):on(Me,Pt,De,ai),Ve<Z&&Mt>=Z&&(Ee=ye(Me,Pt,De,jt,li,Z),yt=!0),Ve>J&&Mt<=J&&(Ee=ye(Me,Pt,De,jt,li,J),yt=!0),!fe&&yt&&(Q&&(Me.end=we+Ce*Ee),H.push(Me),Me=Kr(xe)),Q&&(we+=Ce)}let je=xe.length-3,Ye=xe[je],et=xe[je+1],gt=le===0?Ye:et;gt>=Z&&gt<=J&&on(Me,Ye,et,xe[je+2]),je=Me.length-3,fe&&je>=3&&(Me[je]!==Me[0]||Me[je+1]!==Me[1])&&on(Me,Me[0],Me[1],Me[2]),Me.length&&H.push(Me)}function Kr(xe){let H=[];return H.size=xe.size,H.start=xe.start,H.end=xe.end,H}function rn(xe,H,Z,J,le,fe){for(let Q of xe)xi(Q,H,Z,J,le,fe,!1)}function on(xe,H,Z,J){xe.push(H,Z,J)}function ha(xe,H,Z,J,le,fe){let Q=(fe-H)/(J-H);return on(xe,fe,Z+(le-Z)*Q,1),Q}function Pn(xe,H,Z,J,le,fe){let Q=(fe-Z)/(le-Z);return on(xe,H+(J-H)*Q,fe,1),Q}function Fn(xe,H){let Z=[];for(let J=0;J<xe.length;J++){let le=xe[J],fe=le.type,Q;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")Q=zr(le.geometry,H);else if(fe==="MultiLineString"||fe==="Polygon"){Q=[];for(let Me of le.geometry)Q.push(zr(Me,H))}else if(fe==="MultiPolygon"){Q=[];for(let Me of le.geometry){let ye=[];for(let Ce of Me)ye.push(zr(Ce,H));Q.push(ye)}}Z.push(wn(le.id,fe,Q,le.tags))}return Z}function zr(xe,H){let Z=[];Z.size=xe.size,xe.start!==void 0&&(Z.start=xe.start,Z.end=xe.end);for(let J=0;J<xe.length;J+=3)Z.push(xe[J]+H,xe[J+1],xe[J+2]);return Z}function Lo(xe,H){if(xe.transformed)return xe;let Z=1<<xe.z,J=xe.x,le=xe.y;for(let fe of xe.features){let Q=fe.geometry,Me=fe.type;if(fe.geometry=[],Me===1)for(let ye=0;ye<Q.length;ye+=2)fe.geometry.push(Kt(Q[ye],Q[ye+1],H,Z,J,le));else for(let ye=0;ye<Q.length;ye++){let Ce=[];for(let Ee=0;Ee<Q[ye].length;Ee+=2)Ce.push(Kt(Q[ye][Ee],Q[ye][Ee+1],H,Z,J,le));fe.geometry.push(Ce)}}return xe.transformed=!0,xe}function Kt(xe,H,Z,J,le,fe){return[Math.round(Z*(xe*J-le)),Math.round(Z*(H*J-fe))]}function sn(xe,H,Z,J,le){let fe=H===le.maxZoom?0:le.tolerance/((1<<H)*le.extent),Q={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:Z,y:J,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let Me of xe)gr(Q,Me,fe,le);return Q}function gr(xe,H,Z,J){let le=H.geometry,fe=H.type,Q=[];if(xe.minX=Math.min(xe.minX,H.minX),xe.minY=Math.min(xe.minY,H.minY),xe.maxX=Math.max(xe.maxX,H.maxX),xe.maxY=Math.max(xe.maxY,H.maxY),fe==="Point"||fe==="MultiPoint")for(let Me=0;Me<le.length;Me+=3)Q.push(le[Me],le[Me+1]),xe.numPoints++,xe.numSimplified++;else if(fe==="LineString")Er(Q,le,xe,Z,!1,!1);else if(fe==="MultiLineString"||fe==="Polygon")for(let Me=0;Me<le.length;Me++)Er(Q,le[Me],xe,Z,fe==="Polygon",Me===0);else if(fe==="MultiPolygon")for(let Me=0;Me<le.length;Me++){let ye=le[Me];for(let Ce=0;Ce<ye.length;Ce++)Er(Q,ye[Ce],xe,Z,!0,Ce===0)}if(Q.length){let Me=H.tags||null;if(fe==="LineString"&&J.lineMetrics){Me={};for(let Ce in H.tags)Me[Ce]=H.tags[Ce];Me.mapbox_clip_start=le.start/le.size,Me.mapbox_clip_end=le.end/le.size}let ye={geometry:Q,type:fe==="Polygon"||fe==="MultiPolygon"?3:fe==="LineString"||fe==="MultiLineString"?2:1,tags:Me};H.id!==null&&(ye.id=H.id),xe.features.push(ye)}}function Er(xe,H,Z,J,le,fe){let Q=J*J;if(J>0&&H.size<(le?Q:J))return void(Z.numPoints+=H.length/3);let Me=[];for(let ye=0;ye<H.length;ye+=3)(J===0||H[ye+2]>Q)&&(Z.numSimplified++,Me.push(H[ye],H[ye+1])),Z.numPoints++;le&&function(ye,Ce){let Ee=0;for(let we=0,je=ye.length,Ye=je-2;we<je;Ye=we,we+=2)Ee+=(ye[we]-ye[Ye])*(ye[we+1]+ye[Ye+1]);if(Ee>0===Ce)for(let we=0,je=ye.length;we<je/2;we+=2){let Ye=ye[we],et=ye[we+1];ye[we]=ye[je-2-we],ye[we+1]=ye[je-1-we],ye[je-2-we]=Ye,ye[je-1-we]=et}}(Me,fe),xe.push(Me)}let ji={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Oi{constructor(H,Z){let J=(Z=this.options=function(fe,Q){for(let Me in Q)fe[Me]=Q[Me];return fe}(Object.create(ji),Z)).debug;if(J&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");let le=function(fe,Q){let Me=[];if(fe.type==="FeatureCollection")for(let ye=0;ye<fe.features.length;ye++)mr(Me,fe.features[ye],Q,ye);else mr(Me,fe.type==="Feature"?fe:{geometry:fe},Q);return Me}(H,Z);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),le=function(fe,Q){let Me=Q.buffer/Q.extent,ye=fe,Ce=Zn(fe,1,-1-Me,Me,0,-1,2,Q),Ee=Zn(fe,1,1-Me,2+Me,0,-1,2,Q);return(Ce||Ee)&&(ye=Zn(fe,1,-Me,1+Me,0,-1,2,Q)||[],Ce&&(ye=Fn(Ce,1).concat(ye)),Ee&&(ye=ye.concat(Fn(Ee,-1)))),ye}(le,Z),le.length&&this.splitTile(le,0,0,0),J&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(H,Z,J,le,fe,Q,Me){let ye=[H,Z,J,le],Ce=this.options,Ee=Ce.debug;for(;ye.length;){le=ye.pop(),J=ye.pop(),Z=ye.pop(),H=ye.pop();let we=1<<Z,je=Br(Z,J,le),Ye=this.tiles[je];if(!Ye&&(Ee>1&&console.time("creation"),Ye=this.tiles[je]=sn(H,Z,J,le,Ce),this.tileCoords.push({z:Z,x:J,y:le}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,J,le,Ye.numFeatures,Ye.numPoints,Ye.numSimplified),console.timeEnd("creation"));let yt=`z${Z}`;this.stats[yt]=(this.stats[yt]||0)+1,this.total++}if(Ye.source=H,fe==null){if(Z===Ce.indexMaxZoom||Ye.numPoints<=Ce.indexMaxPoints)continue}else{if(Z===Ce.maxZoom||Z===fe)continue;if(fe!=null){let yt=fe-Z;if(J!==Q>>yt||le!==Me>>yt)continue}}if(Ye.source=null,H.length===0)continue;Ee>1&&console.time("clipping");let et=.5*Ce.buffer/Ce.extent,gt=.5-et,Dt=.5+et,Pt=1+et,De=null,ai=null,jt=null,li=null,Mt=Zn(H,we,J-et,J+Dt,0,Ye.minX,Ye.maxX,Ce),Ve=Zn(H,we,J+gt,J+Pt,0,Ye.minX,Ye.maxX,Ce);H=null,Mt&&(De=Zn(Mt,we,le-et,le+Dt,1,Ye.minY,Ye.maxY,Ce),ai=Zn(Mt,we,le+gt,le+Pt,1,Ye.minY,Ye.maxY,Ce),Mt=null),Ve&&(jt=Zn(Ve,we,le-et,le+Dt,1,Ye.minY,Ye.maxY,Ce),li=Zn(Ve,we,le+gt,le+Pt,1,Ye.minY,Ye.maxY,Ce),Ve=null),Ee>1&&console.timeEnd("clipping"),ye.push(De||[],Z+1,2*J,2*le),ye.push(ai||[],Z+1,2*J,2*le+1),ye.push(jt||[],Z+1,2*J+1,2*le),ye.push(li||[],Z+1,2*J+1,2*le+1)}}getTile(H,Z,J){H=+H,Z=+Z,J=+J;let le=this.options,{extent:fe,debug:Q}=le;if(H<0||H>24)return null;let Me=1<<H,ye=Br(H,Z=Z+Me&Me-1,J);if(this.tiles[ye])return Lo(this.tiles[ye],fe);Q>1&&console.log("drilling down to z%d-%d-%d",H,Z,J);let Ce,Ee=H,we=Z,je=J;for(;!Ce&&Ee>0;)Ee--,we>>=1,je>>=1,Ce=this.tiles[Br(Ee,we,je)];return Ce&&Ce.source?(Q>1&&(console.log("found parent tile z%d-%d-%d",Ee,we,je),console.time("drilling down")),this.splitTile(Ce.source,Ee,we,je,H,Z,J),Q>1&&console.timeEnd("drilling down"),this.tiles[ye]?Lo(this.tiles[ye],fe):null):null}}function Br(xe,H,Z){return 32*((1<<xe)*Z+H)+xe}function fo(xe,H){return H?xe.properties[H]:xe.id}function Qr(xe,H){if(xe==null)return!0;if(xe.type==="Feature")return fo(xe,H)!=null;if(xe.type==="FeatureCollection"){let Z=new Set;for(let J of xe.features){let le=fo(J,H);if(le==null||Z.has(le))return!1;Z.add(le)}return!0}return!1}function Ii(xe,H){let Z=new Map;if(xe!=null)if(xe.type==="Feature")Z.set(fo(xe,H),xe);else for(let J of xe.features)Z.set(fo(J,H),J);return Z}class or extends be{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(H,Z){return h._(this,void 0,void 0,function*(){let J=H.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let le=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!le)return null;let fe=new hi(le.features),Q=Lr(fe);return Q.byteOffset===0&&Q.byteLength===Q.buffer.byteLength||(Q=new Uint8Array(Q)),{vectorTile:fe,rawData:Q.buffer}})}loadData(H){return h._(this,void 0,void 0,function*(){var Z;(Z=this._pendingRequest)===null||Z===void 0||Z.abort();let J=!!(H&&H.request&&H.request.collectResourceTiming)&&new h.cE(H.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(H,this._pendingRequest),this._geoJSONIndex=H.cluster?new As(function({superclusterOptions:Q,clusterProperties:Me}){if(!Me||!Q)return Q;let ye={},Ce={},Ee={accumulated:null,zoom:0},we={properties:null},je=Object.keys(Me);for(let Ye of je){let[et,gt]=Me[Ye],Dt=h.cL(gt),Pt=h.cL(typeof et=="string"?[et,["accumulated"],["get",Ye]]:et);ye[Ye]=Dt.value,Ce[Ye]=Pt.value}return Q.map=Ye=>{we.properties=Ye;let et={};for(let gt of je)et[gt]=ye[gt].evaluate(Ee,we);return et},Q.reduce=(Ye,et)=>{we.properties=et;for(let gt of je)Ee.accumulated=Ye[gt],Ye[gt]=Ce[gt].evaluate(Ee,we)},Q}(H)).load((yield this._pendingData).features):(le=yield this._pendingData,new Oi(le,H.geojsonVtOptions)),this.loaded={};let fe={};if(J){let Q=J.finish();Q&&(fe.resourceTiming={},fe.resourceTiming[H.source]=JSON.parse(JSON.stringify(Q)))}return fe}catch(fe){if(delete this._pendingRequest,h.cp(fe))return{abandoned:!0};throw fe}var le})}getData(){return h._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(H){let Z=this.loaded;return Z&&Z[H.uid]?super.reloadTile(H):this.loadTile(H)}loadAndProcessGeoJSON(H,Z){return h._(this,void 0,void 0,function*(){let J=yield this.loadGeoJSON(H,Z);if(delete this._pendingRequest,typeof J!="object")throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`);if(wt(J,!0),H.filter){let le=h.cL(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map(Q=>`${Q.key}: ${Q.message}`).join(", "));J={type:"FeatureCollection",features:J.features.filter(Q=>le.value.evaluate({zoom:0},Q))}}return J})}loadGeoJSON(H,Z){return h._(this,void 0,void 0,function*(){let{promoteId:J}=H;if(H.request){let le=yield h.j(H.request,Z);return this._dataUpdateable=Qr(le.data,J)?Ii(le.data,J):void 0,le.data}if(typeof H.data=="string")try{let le=JSON.parse(H.data);return this._dataUpdateable=Qr(le,J)?Ii(le,J):void 0,le}catch{throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`)}if(!H.dataDiff)throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${H.source}`);return function(le,fe,Q){var Me,ye,Ce,Ee;if(fe.removeAll&&le.clear(),fe.remove)for(let we of fe.remove)le.delete(we);if(fe.add)for(let we of fe.add){let je=fo(we,Q);je!=null&&le.set(je,we)}if(fe.update)for(let we of fe.update){let je=le.get(we.id);if(je==null)continue;let Ye=!we.removeAllProperties&&(((Me=we.removeProperties)===null||Me===void 0?void 0:Me.length)>0||((ye=we.addOrUpdateProperties)===null||ye===void 0?void 0:ye.length)>0);if((we.newGeometry||we.removeAllProperties||Ye)&&(je=Object.assign({},je),le.set(we.id,je),Ye&&(je.properties=Object.assign({},je.properties))),we.newGeometry&&(je.geometry=we.newGeometry),we.removeAllProperties)je.properties={};else if(((Ce=we.removeProperties)===null||Ce===void 0?void 0:Ce.length)>0)for(let et of we.removeProperties)Object.prototype.hasOwnProperty.call(je.properties,et)&&delete je.properties[et];if(((Ee=we.addOrUpdateProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(let{key:et,value:gt}of we.addOrUpdateProperties)je.properties[et]=gt}}(this._dataUpdateable,H.dataDiff,J),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(H){return h._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(H){return this._geoJSONIndex.getClusterExpansionZoom(H.clusterId)}getClusterChildren(H){return this._geoJSONIndex.getChildren(H.clusterId)}getClusterLeaves(H){return this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset)}}class Tr{constructor(H){this.self=H,this.actor=new h.H(H),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Z,J)=>{if(this.externalWorkerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.externalWorkerSourceTypes[Z]=J},this.self.addProtocol=h.cr,this.self.removeProtocol=h.cs,this.self.registerRTLTextPlugin=Z=>{h.cM.setMethods(Z)},this.actor.registerMessageHandler("LDT",(Z,J)=>this._getDEMWorkerSource(Z,J.source).loadTile(J)),this.actor.registerMessageHandler("RDT",(Z,J)=>h._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Z,J.source).removeTile(J)})),this.actor.registerMessageHandler("GCEZ",(Z,J)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,J.type,J.source).getClusterExpansionZoom(J)})),this.actor.registerMessageHandler("GCC",(Z,J)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,J.type,J.source).getClusterChildren(J)})),this.actor.registerMessageHandler("GCL",(Z,J)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(Z,J.type,J.source).getClusterLeaves(J)})),this.actor.registerMessageHandler("LD",(Z,J)=>this._getWorkerSource(Z,J.type,J.source).loadData(J)),this.actor.registerMessageHandler("GD",(Z,J)=>this._getWorkerSource(Z,J.type,J.source).getData()),this.actor.registerMessageHandler("LT",(Z,J)=>this._getWorkerSource(Z,J.type,J.source).loadTile(J)),this.actor.registerMessageHandler("RT",(Z,J)=>this._getWorkerSource(Z,J.type,J.source).reloadTile(J)),this.actor.registerMessageHandler("AT",(Z,J)=>this._getWorkerSource(Z,J.type,J.source).abortTile(J)),this.actor.registerMessageHandler("RMT",(Z,J)=>this._getWorkerSource(Z,J.type,J.source).removeTile(J)),this.actor.registerMessageHandler("RS",(Z,J)=>h._(this,void 0,void 0,function*(){if(!this.workerSources[Z]||!this.workerSources[Z][J.type]||!this.workerSources[Z][J.type][J.source])return;let le=this.workerSources[Z][J.type][J.source];delete this.workerSources[Z][J.type][J.source],le.removeSource!==void 0&&le.removeSource(J)})),this.actor.registerMessageHandler("RM",Z=>h._(this,void 0,void 0,function*(){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z]})),this.actor.registerMessageHandler("SR",(Z,J)=>h._(this,void 0,void 0,function*(){this.referrer=J})),this.actor.registerMessageHandler("SRPS",(Z,J)=>this._syncRTLPluginState(Z,J)),this.actor.registerMessageHandler("IS",(Z,J)=>h._(this,void 0,void 0,function*(){this.self.importScripts(J)})),this.actor.registerMessageHandler("SI",(Z,J)=>this._setImages(Z,J)),this.actor.registerMessageHandler("UL",(Z,J)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(Z).update(J.layers,J.removedIds)})),this.actor.registerMessageHandler("SL",(Z,J)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(Z).replace(J)}))}_setImages(H,Z){return h._(this,void 0,void 0,function*(){this.availableImages[H]=Z;for(let J in this.workerSources[H]){let le=this.workerSources[H][J];for(let fe in le)le[fe].availableImages=Z}})}_syncRTLPluginState(H,Z){return h._(this,void 0,void 0,function*(){return yield h.cM.syncState(Z,this.self.importScripts)})}_getAvailableImages(H){let Z=this.availableImages[H];return Z||(Z=[]),Z}_getLayerIndex(H){let Z=this.layerIndexes[H];return Z||(Z=this.layerIndexes[H]=new s),Z}_getWorkerSource(H,Z,J){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][Z]||(this.workerSources[H][Z]={}),!this.workerSources[H][Z][J]){let le={sendAsync:(fe,Q)=>(fe.targetMapId=H,this.actor.sendAsync(fe,Q))};switch(Z){case"vector":this.workerSources[H][Z][J]=new be(le,this._getLayerIndex(H),this._getAvailableImages(H));break;case"geojson":this.workerSources[H][Z][J]=new or(le,this._getLayerIndex(H),this._getAvailableImages(H));break;default:this.workerSources[H][Z][J]=new this.externalWorkerSourceTypes[Z](le,this._getLayerIndex(H),this._getAvailableImages(H))}}return this.workerSources[H][Z][J]}_getDEMWorkerSource(H,Z){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][Z]||(this.demWorkerSources[H][Z]=new ve),this.demWorkerSources[H][Z]}}return h.i(self)&&(self.worker=new Tr(self)),Tr}),i("index",["exports","./shared"],function(h,s){"use strict";var P="5.5.0";function q(){var f=new s.A(4);return s.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let X,be,ve={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,n){let u=requestAnimationFrame(g=>{p(),e(g)}),{unsubscribe:p}=s.s(f.signal,"abort",()=>{p(),cancelAnimationFrame(u),n(s.c())},!1)},frameAsync(f){return new Promise((e,n)=>{this.frame(f,e,n)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){let e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,n.drawImage(f,0,0,f.width,f.height),n},resolveURL:f=>(X||(X=document.createElement("a")),X.href=f,X.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(be==null&&(be=matchMedia("(prefers-reduced-motion: reduce)")),be.matches)}};class ${static testProp(e){if(!$.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in $.docStyle)return e[n];return e[0]}static create(e,n,u){let p=window.document.createElement(e);return n!==void 0&&(p.className=n),u&&u.appendChild(p),p}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){$.docStyle&&$.selectProp&&($.userSelect=$.docStyle[$.selectProp],$.docStyle[$.selectProp]="none")}static enableDrag(){$.docStyle&&$.selectProp&&($.docStyle[$.selectProp]=$.userSelect)}static setTransform(e,n){e.style[$.transformProp]=n}static addEventListener(e,n,u,p={}){e.addEventListener(n,u,"passive"in p?p:p.capture)}static removeEventListener(e,n,u,p={}){e.removeEventListener(n,u,"passive"in p?p:p.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",$.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",$.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",$.suppressClickInternal,!0)},0)}static getScale(e){let n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,u){let p=n.boundingClientRect;return new s.P((u.clientX-p.left)/n.x-e.clientLeft,(u.clientY-p.top)/n.y-e.clientTop)}static mousePos(e,n){let u=$.getScale(e);return $.getPoint(e,u,n)}static touchPos(e,n){let u=[],p=$.getScale(e);for(let g=0;g<n.length;g++)u.push($.getPoint(e,p,n[g]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){let n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),u=n.querySelectorAll("script");for(let p of u)p.remove();return $.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){let u=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!u.includes("javascript:")&&!u.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){let n=e.children;for(let u of n)$.removeAttributes(u),$.clean(u)}static removeAttributes(e){for(let{name:n,value:u}of e.attributes)$.isPossiblyDangerous(n,u)&&e.removeAttribute(n)}}$.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,$.selectProp=$.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),$.transformProp=$.testProp(["transform","WebkitTransform"]);let $e={supported:!1,testSupport:function(f){!lt&&wt&&(at?hi(f):ht=f)}},ht,wt,lt=!1,at=!1;function hi(f){let e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,wt),f.isContextLost())return;$e.supported=!0}catch{}f.deleteTexture(e),lt=!0}var Mi;typeof document<"u"&&(wt=document.createElement("img"),wt.onload=()=>{ht&&hi(ht),ht=null,at=!0},wt.onerror=()=>{lt=!0,ht=null},wt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,n,u,p;f.resetRequestQueue=()=>{e=[],n=0,u=0,p={}},f.addThrottleControl=C=>{let T=u++;return p[T]=C,T},f.removeThrottleControl=C=>{delete p[C],v()},f.getImage=(C,T,k=!0)=>new Promise((R,D)=>{$e.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),s.e(C,{type:"image"}),e.push({abortController:T,requestParameters:C,supportImageRefresh:k,state:"queued",onError:j=>{D(j)},onSuccess:j=>{R(j)}}),v()});let g=C=>s._(this,void 0,void 0,function*(){C.state="running";let{requestParameters:T,supportImageRefresh:k,onError:R,onSuccess:D,abortController:j}=C,U=k===!1&&!s.i(self)&&!s.g(T.url)&&(!T.headers||Object.keys(T.headers).reduce((ie,se)=>ie&&se==="accept",!0));n++;let te=U?x(T,j):s.m(T,j);try{let ie=yield te;delete C.abortController,C.state="completed",ie.data instanceof HTMLImageElement||s.b(ie.data)?D(ie):ie.data&&D({data:yield(ee=ie.data,typeof createImageBitmap=="function"?s.f(ee):s.h(ee)),cacheControl:ie.cacheControl,expires:ie.expires})}catch(ie){delete C.abortController,R(ie)}finally{n--,v()}var ee}),v=()=>{let C=(()=>{for(let T of Object.keys(p))if(p[T]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let T=n;T<C&&e.length>0;T++){let k=e.shift();k.abortController.signal.aborted?T--:g(k)}},x=(C,T)=>new Promise((k,R)=>{let D=new Image,j=C.url,U=C.credentials;U&&U==="include"?D.crossOrigin="use-credentials":(U&&U==="same-origin"||!s.d(j))&&(D.crossOrigin="anonymous"),T.signal.addEventListener("abort",()=>{D.src="",R(s.c())}),D.fetchPriority="high",D.onload=()=>{D.onerror=D.onload=null,k({data:D})},D.onerror=()=>{D.onerror=D.onload=null,T.signal.aborted||R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},D.src=j})}(Mi||(Mi={})),Mi.resetRequestQueue();class At{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function bi(f){let e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){let n=[];for(let{id:u,url:p}of f){let g=`${u}${p}`;n.indexOf(g)===-1&&(n.push(g),e.push({id:u,url:p}))}}return e}function Qi(f,e,n){try{let u=new URL(f);return u.pathname+=`${e}${n}`,u.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class pi{constructor(e,n,u,p){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(n,p)}update(e,n,u){let{width:p,height:g}=e,v=!(this.size&&this.size[0]===p&&this.size[1]===g||u),{context:x}=this,{gl:C}=x;if(this.useMipmap=!!(n&&n.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!n||n.premultiply!==!1)),v)this.size=[p,g],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||s.b(e)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,e):C.texImage2D(C.TEXTURE_2D,0,this.format,p,g,0,this.format,C.UNSIGNED_BYTE,e.data);else{let{x:T,y:k}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||s.b(e)?C.texSubImage2D(C.TEXTURE_2D,0,T,k,C.RGBA,C.UNSIGNED_BYTE,e):C.texSubImage2D(C.TEXTURE_2D,0,T,k,p,g,C.RGBA,C.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D),x.pixelStoreUnpackFlipY.setDefault(),x.pixelStoreUnpack.setDefault(),x.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,u){let{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),e!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||e),this.filter=e),n!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Lr(f){let{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class ks extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:n,promiseResolve:u}of this.requestors)u(this._getImagesForIds(n));this.requestors=[]}}getImage(e){let n=this.images[e];if(n&&!n.data&&n.spriteData){let u=n.spriteData;n.data=new s.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let u=!0,p=n.data||n.spriteData;return this._validateStretch(n.stretchX,p&&p.width)||(this.fire(new s.k(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(n.stretchY,p&&p.height)||(this.fire(new s.k(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(n.content,n)||(this.fire(new s.k(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,n){if(!e)return!0;let u=0;for(let p of e){if(p[0]<u||p[1]<p[0]||n<p[1])return!1;u=p[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;let u=n.spriteData,p=u&&u.width||n.data.width,g=u&&u.height||n.data.height;return!(e[0]<0||p<e[0]||e[1]<0||g<e[1]||e[2]<0||p<e[2]||e[3]<0||g<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,u=!0){let p=this.getImage(e);if(u&&(p.data.width!==n.data.width||p.data.height!==n.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=p.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){let n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,u)=>{let p=!0;if(!this.isLoaded())for(let g of e)this.images[g]||(p=!1);this.isLoaded()||p?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){let n={};for(let u of e){let p=this.getImage(u);p||(this.fire(new s.l("styleimagemissing",{id:u})),p=this.getImage(u)),p?n[u]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,textFitWidth:p.textFitWidth,textFitHeight:p.textFitHeight,hasRenderCallback:!!(p.userImage&&p.userImage.render)}:s.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){let{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){let n=this.patterns[e],u=this.getImage(e);if(!u)return null;if(n&&n.position.version===u.version)return n.position;if(n)n.position.version=u.version;else{let p={w:u.data.width+2,h:u.data.height+2,x:0,y:0},g=new s.I(p,u);this.patterns[e]={bin:p,position:g}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new pi(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let g in this.patterns)e.push(this.patterns[g].bin);let{w:n,h:u}=s.p(e),p=this.atlasImage;p.resize({width:n||1,height:u||1});for(let g in this.patterns){let{bin:v}=this.patterns[g],x=v.x+1,C=v.y+1,T=this.getImage(g).data,k=T.width,R=T.height;s.R.copy(T,p,{x:0,y:0},{x,y:C},{width:k,height:R}),s.R.copy(T,p,{x:0,y:R-1},{x,y:C-1},{width:k,height:1}),s.R.copy(T,p,{x:0,y:0},{x,y:C+R},{width:k,height:1}),s.R.copy(T,p,{x:k-1,y:0},{x:x-1,y:C},{width:1,height:R}),s.R.copy(T,p,{x:0,y:0},{x:x+k,y:C},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;let u=this.getImage(n);u||s.w(`Image with ID: "${n}" was not found`),Lr(u)&&this.updateImage(n,u)}}}let Zi=1e20;function rr(f,e,n,u,p,g,v,x,C){for(let T=e;T<e+u;T++)Vi(f,n*g+T,g,p,v,x,C);for(let T=n;T<n+p;T++)Vi(f,T*g+e,1,u,v,x,C)}function Vi(f,e,n,u,p,g,v){g[0]=0,v[0]=-1e20,v[1]=Zi,p[0]=f[e];for(let x=1,C=0,T=0;x<u;x++){p[x]=f[e+x*n];let k=x*x;do{let R=g[C];T=(p[x]-p[R]+k-R*R)/(x-R)/2}while(T<=v[C]&&--C>-1);C++,g[C]=x,v[C]=T,v[C+1]=Zi}for(let x=0,C=0;x<u;x++){for(;v[C+1]<x;)C++;let T=g[C],k=x-T;f[e+x*n]=p[T]+k*k}}class kt{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return s._(this,void 0,void 0,function*(){let n=[];for(let g in e)for(let v of e[g])n.push(this._getAndCacheGlyphsPromise(g,v));let u=yield Promise.all(n),p={};for(let{stack:g,id:v,glyph:x}of u)p[g]||(p[g]={}),p[g][v]=x&&{id:x.id,bitmap:x.bitmap.clone(),metrics:x.metrics};return p})}_getAndCacheGlyphsPromise(e,n){return s._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let p=u.glyphs[n];if(p!==void 0)return{stack:e,id:n,glyph:p};if(p=this._tinySDF(u,e,n),p)return u.glyphs[n]=p,{stack:e,id:n,glyph:p};let g=Math.floor(n/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[g])return{stack:e,id:n,glyph:p};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[g]){let x=kt.loadGlyphRange(e,g,this.url,this.requestManager);u.requests[g]=x}let v=yield u.requests[g];for(let x in v)this._doesCharSupportLocalGlyph(+x)||(u.glyphs[+x]=v[+x]);return u.ranges[g]=!0,{stack:e,id:n,glyph:v[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||s.u["CJK Unified Ideographs"](e)||s.u["Hangul Syllables"](e)||s.u.Hiragana(e)||s.u.Katakana(e)||s.u["CJK Symbols and Punctuation"](e)||s.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,n,u){let p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let g=e.tinySDF;if(!g){let x="400";/bold/i.test(n)?x="900":/medium/i.test(n)?x="500":/light/i.test(n)&&(x="200"),g=e.tinySDF=new kt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:p,fontWeight:x})}let v=g.draw(String.fromCharCode(u));return{id:u,bitmap:new s.q({width:v.width||60,height:v.height||60},v.data),metrics:{width:v.glyphWidth/2||24,height:v.glyphHeight/2||24,left:v.glyphLeft/2+.5||0,top:v.glyphTop/2-27.5||-8,advance:v.glyphAdvance/2||24,isDoubleResolution:!0}}}}kt.loadGlyphRange=function(f,e,n,u){return s._(this,void 0,void 0,function*(){let p=256*e,g=p+255,v=u.transformRequest(n.replace("{fontstack}",f).replace("{range}",`${p}-${g}`),"Glyphs"),x=yield s.n(v,new AbortController);if(!x||!x.data)throw new Error(`Could not load glyph range. range: ${e}, ${p}-${g}`);let C={};for(let T of s.o(x.data))C[T.id]=T;return C})},kt.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:n=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=n;let x=this.size=f+4*e,C=this._createCanvas(x),T=this.ctx=C.getContext("2d",{willReadFrequently:!0});T.font=`${v} ${g} ${f}px ${p}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(f){let e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){let{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(f),v=Math.ceil(n),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-p))),C=Math.min(this.size-this.buffer,v+Math.ceil(u)),T=x+2*this.buffer,k=C+2*this.buffer,R=Math.max(T*k,0),D=new Uint8ClampedArray(R),j={data:D,width:T,height:k,glyphWidth:x,glyphHeight:C,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(x===0||C===0)return j;let{ctx:U,buffer:te,gridInner:ee,gridOuter:ie}=this;U.clearRect(te,te,x,C),U.fillText(f,te,te+v);let se=U.getImageData(te,te,x,C);ie.fill(Zi,0,R),ee.fill(0,0,R);for(let ue=0;ue<C;ue++)for(let de=0;de<x;de++){let he=se.data[4*(ue*x+de)+3]/255;if(he===0)continue;let _e=(ue+te)*T+de+te;if(he===1)ie[_e]=0,ee[_e]=Zi;else{let pe=.5-he;ie[_e]=pe>0?pe*pe:0,ee[_e]=pe<0?pe*pe:0}}rr(ie,0,0,T,k,T,this.f,this.v,this.z),rr(ee,te,te,x,C,T,this.f,this.v,this.z);for(let ue=0;ue<R;ue++){let de=Math.sqrt(ie[ue])-Math.sqrt(ee[ue]);D[ue]=Math.round(255-255*(de/this.radius+this.cutoff))}return j}};class Xr{constructor(){this.specification=s.v.light.position}possiblyEvaluate(e,n){return s.z(e.expression.evaluate(n))}interpolate(e,n,u){return{x:s.B.number(e.x,n.x,u),y:s.B.number(e.y,n.y,u),z:s.B.number(e.z,n.z,u)}}}let As;class Ds extends s.E{constructor(e){super(),As=As||new s.r({anchor:new s.D(s.v.light.anchor),position:new Xr,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.T(As),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(s.t,e,n))for(let u in e){let p=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,u){return(!u||u.validate!==!1)&&s.x(this,e.call(s.y,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}let mi=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class ho extends s.E{constructor(e){super(),this._transitionable=new s.T(mi),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.C(0))}setSky(e,n={}){if(!this._validate(s.F,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(let u in e){let p=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,u={}){return u?.validate!==!1&&s.x(this,e.call(s.y,s.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Pr{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){let u=e.join(",")+String(n);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,n)),this.dashEntry[u]}getDashRanges(e,n,u){let p=[],g=e.length%2==1?-e[e.length-1]*u:0,v=e[0]*u,x=!0;p.push({left:g,right:v,isDash:x,zeroLength:e[0]===0});let C=e[0];for(let T=1;T<e.length;T++){x=!x;let k=e[T];g=C*u,C+=k,v=C*u,p.push({left:g,right:v,isDash:x,zeroLength:k===0})}return p}addRoundDash(e,n,u){let p=n/2;for(let g=-u;g<=u;g++){let v=this.width*(this.nextRow+u+g),x=0,C=e[x];for(let T=0;T<this.width;T++){T/C.right>1&&(C=e[++x]);let k=Math.abs(T-C.left),R=Math.abs(T-C.right),D=Math.min(k,R),j,U=g/u*(p+1);if(C.isDash){let te=p-Math.abs(U);j=Math.sqrt(D*D+te*te)}else j=p-Math.sqrt(D*D+U*U);this.data[v+T]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(e){for(let x=e.length-1;x>=0;--x){let C=e[x],T=e[x+1];C.zeroLength?e.splice(x,1):T&&T.isDash===C.isDash&&(T.left=C.left,e.splice(x,1))}let n=e[0],u=e[e.length-1];n.isDash===u.isDash&&(n.left=u.left-this.width,u.right=n.right+this.width);let p=this.width*this.nextRow,g=0,v=e[g];for(let x=0;x<this.width;x++){x/v.right>1&&(v=e[++g]);let C=Math.abs(x-v.left),T=Math.abs(x-v.right),k=Math.min(C,T);this.data[p+x]=Math.max(0,Math.min(255,(v.isDash?k:-k)+128))}}addDash(e,n){let u=n?7:0,p=2*u+1;if(this.nextRow+p>this.height)return s.w("LineAtlas out of space"),null;let g=0;for(let x=0;x<e.length;x++)g+=e[x];if(g!==0){let x=this.width/g,C=this.getDashRanges(e,this.width,x);n?this.addRoundDash(C,x,u):this.addRegularDash(C)}let v={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:g};return this.nextRow+=p,this.dirty=!0,v}bind(e){let n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}let po="maplibre_preloaded_worker_pool";class nn{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<nn.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[po]}numActive(){return Object.keys(this.active).length}}let mo=Math.floor(ve.hardwareConcurrency/2),wn,Cn;function mr(){return wn||(wn=new nn),wn}nn.workerCount=s.G(globalThis)?Math.max(Math.min(mo,3),1):1;class Mn{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;let u=this.workerPool.acquire(n);for(let p=0;p<u.length;p++){let g=new s.H(u[p],n);g.name=`Worker ${p}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){let u=[];for(let p of this.actors)u.push(p.sendAsync({type:e,data:n}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(let u of this.actors)u.registerMessageHandler(e,n)}}function is(){return Cn||(Cn=new Mn(mr(),s.J),Cn.registerMessageHandler("GR",(f,e,n)=>s.m(e,n))),Cn}function Yr(f,e){let n=s.K();return s.L(n,n,[1,1,0]),s.M(n,n,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?s.N(n,n,f.calculatePosMatrix(e.toUnwrapped())):n}function ns(f,e,n,u,p,g,v){var x;let C=function(D,j,U){if(D)for(let te of D){let ee=j[te];if(ee&&ee.source===U&&ee.type==="fill-extrusion")return!0}else for(let te in j){let ee=j[te];if(ee.source===U&&ee.type==="fill-extrusion")return!0}return!1}((x=p?.layers)!==null&&x!==void 0?x:null,e,f.id),T=g.maxPitchScaleFactor(),k=f.tilesIn(u,T,C);k.sort(fr);let R=[];for(let D of k)R.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,n,f._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,p,g,T,Yr(f.transform,D.tileID),v?(j,U)=>v(D.tileID,j,U):void 0)});return function(D,j){for(let U in D)for(let te of D[U])Zn(te,j);return D}(function(D){let j={},U={};for(let te of D){let ee=te.queryResults,ie=te.wrappedTileID,se=U[ie]=U[ie]||{};for(let ue in ee){let de=ee[ue],he=se[ue]=se[ue]||{},_e=j[ue]=j[ue]||[];for(let pe of de)he[pe.featureIndex]||(he[pe.featureIndex]=!0,_e.push(pe))}}return j}(R),f)}function fr(f,e){let n=f.tileID,u=e.tileID;return n.overscaledZ-u.overscaledZ||n.canonical.y-u.canonical.y||n.wrap-u.wrap||n.canonical.x-u.canonical.x}function Zn(f,e){let n=f.feature,u=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=u}function Sn(f,e,n){return s._(this,void 0,void 0,function*(){let u=f;if(f.url?u=(yield s.j(e.transformRequest(f.url,"Source"),n)).data:yield ve.frameAsync(n),!u)return null;let p=s.O(s.e(u,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(p.vectorLayerIds=u.vector_layers.map(g=>g.id)),p})}class xi{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof s.Q?new s.Q(e.lng,e.lat):s.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof s.Q?new s.Q(e.lng,e.lat):s.Q.convert(e),this}extend(e){let n=this._sw,u=this._ne,p,g;if(e instanceof s.Q)p=e,g=e;else{if(!(e instanceof xi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(xi.convert(e)):this.extend(s.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(s.Q.convert(e)):this;if(p=e._sw,g=e._ne,!p||!g)return this}return n||u?(n.lng=Math.min(p.lng,n.lng),n.lat=Math.min(p.lat,n.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new s.Q(p.lng,p.lat),this._ne=new s.Q(g.lng,g.lat)),this}getCenter(){return new s.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.Q(this.getWest(),this.getNorth())}getSouthEast(){return new s.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:n,lat:u}=s.Q.convert(e),p=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(e){return e instanceof xi?e:e&&new xi(e)}static fromLngLat(e,n=0){let u=360*n/40075017,p=u/Math.cos(Math.PI/180*e.lat);return new xi(new s.Q(e.lng-p,e.lat-u),new s.Q(e.lng+p,e.lat+u))}adjustAntiMeridian(){let e=new s.Q(this._sw.lng,this._sw.lat),n=new s.Q(this._ne.lng,this._ne.lat);return new xi(e,e.lng>n.lng?new s.Q(n.lng+360,n.lat):n)}}class Kr{constructor(e,n,u){this.bounds=xi.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){let n=Math.pow(2,e.z),u=Math.floor(s.U(this.bounds.getWest())*n),p=Math.floor(s.S(this.bounds.getNorth())*n),g=Math.ceil(s.U(this.bounds.getEast())*n),v=Math.ceil(s.S(this.bounds.getSouth())*n);return e.x>=u&&e.x<g&&e.y>=p&&e.y<v}}class rn extends s.E{constructor(e,n,u,p){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.O(n,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=yield Sn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(s.e(this,e),e.bounds&&(this.tileBounds=new Kr(e.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new s.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.request.collectResourceTiming=this._collectResourceTiming;let p="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((g,v)=>{e.reloadPromise={resolve:g,reject:v}})}else e.actor=this.dispatcher.getActor(),p="LT";e.abortController=new AbortController;try{let g=yield e.actor.sendAsync({type:p,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,g)}catch(g){if(delete e.abortController,e.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){let u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class on extends s.E{constructor(e,n,u,p){super(),this.id=e,this.dispatcher=u,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},n),s.e(this,s.O(n,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let n=yield Sn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(s.e(this,n),n.bounds&&(this.tileBounds=new Kr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new s.k(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return s.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let u=yield Mi.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&(u.cacheControl||u.expires)&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});let p=this.map.painter.context,g=p.gl,v=u.data;e.texture=this.map.painter.getTileTexture(v.width),e.texture?e.texture.update(v,{useMipmap:!0}):(e.texture=new pi(p,v,g.RGBA,{useMipmap:!0}),e.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class ha extends on{constructor(e,n,u,p){super(e,n,u,p),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let p=yield Mi.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(p&&p.data){let g=p.data;this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&e.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});let v=s.b(g)&&s.V()?g:yield this.readImageNow(g),x={type:this.type,uid:e.uid,source:this.id,rawImageData:v,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let C=yield e.actor.sendAsync({type:"LDT",data:x});e.dem=C,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(p){if(delete e.abortController,e.aborted)e.state="unloaded";else if(p)throw e.state="errored",p}})}readImageNow(e){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.W()){let n=e.width+2,u=e.height+2;try{return new s.R({width:n,height:u},yield s.X(e,-1,-1,n,u))}catch{}}return ve.getImageData(e,1)})}_getNeighboringTiles(e){let n=e.canonical,u=Math.pow(2,n.z),p=(n.x-1+u)%u,g=n.x===0?e.wrap-1:e.wrap,v=(n.x+1+u)%u,x=n.x+1===u?e.wrap+1:e.wrap,C={};return C[new s.Y(e.overscaledZ,g,n.z,p,n.y).key]={backfilled:!1},C[new s.Y(e.overscaledZ,x,n.z,v,n.y).key]={backfilled:!1},n.y>0&&(C[new s.Y(e.overscaledZ,g,n.z,p,n.y-1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,x,n.z,v,n.y-1).key]={backfilled:!1}),n.y+1<u&&(C[new s.Y(e.overscaledZ,g,n.z,p,n.y+1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},C[new s.Y(e.overscaledZ,x,n.z,v,n.y+1).key]={backfilled:!1}),C}unloadTile(e){return s._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Pn extends s.E{constructor(e,n,u,p){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(p),this._data=n.data,this._options=s.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:s.Z,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:s.Z,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(s.Z/this.tileSize)}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return s._(this,void 0,void 0,function*(){let e=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(n=>n.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){let e=new xi,n=yield this.getData(),u;switch(n.type){case"FeatureCollection":u=n.features.map(p=>this.getCoordinatesFromGeometry(p.geometry)).flat(1/0);break;case"Feature":u=this.getCoordinatesFromGeometry(n.geometry);break;default:u=this.getCoordinatesFromGeometry(n)}if(u.length==0)return e;for(let p=0;p<u.length-1;p+=2)e.extend([u[p],u[p+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:u}})}_updateWorkerData(e){return s._(this,void 0,void 0,function*(){let n=s.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(ve.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.l("dataloading",{dataType:"source"}));try{let u=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));let p=null;u.resourceTiming&&u.resourceTiming[this.id]&&(p=u.resourceTiming[this.id].slice(0));let g={dataType:"source"};this._collectResourceTiming&&p&&p.length>0&&s.e(g,{resourceTiming:p}),this.fire(new s.l("data",Object.assign(Object.assign({},g),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},g),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return s._(this,void 0,void 0,function*(){let n=e.actor?"RT":"LT";e.actor=this.actor;let u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;let p=yield this.actor.sendAsync({type:n,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(p,this.map.painter,n==="RT")})}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Fn extends s.E{constructor(e,n,u,p){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=u,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=n}load(e){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let n=yield Mi.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new s.k(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let n=e.map(s.$.fromLngLat);var u;return this.tileID=function(p){let g=1/0,v=1/0,x=-1/0,C=-1/0;for(let D of p)g=Math.min(g,D.x),v=Math.min(v,D.y),x=Math.max(x,D.x),C=Math.max(C,D.y);let T=Math.max(x-g,C-v),k=Math.max(0,Math.floor(-Math.log(T)/Math.LN2)),R=Math.pow(2,k);return new s.a1(k,Math.floor((g+x)/2*R),Math.floor((v+C)/2*R))}(n),this.terrainTileRanges=this._getOverlappingTileRanges(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(p=>this.tileID.getTilePoint(p)._round()),this.flippedWindingOrder=((u=this.tileCoords)[1].x-u[0].x)*(u[2].y-u[0].y)-(u[1].y-u[0].y)*(u[2].x-u[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new pi(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let u=!1;for(let p in this.tiles){let g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let n=1/0,u=1/0,p=-1/0,g=-1/0;for(let x of e)n=Math.min(n,x.x),u=Math.min(u,x.y),p=Math.max(p,x.x),g=Math.max(g,x.y);let v={};for(let x=0;x<=s.a0;x++){let C=Math.pow(2,x),T=Math.floor(n*C),k=Math.floor(u*C),R=Math.floor(p*C),D=Math.floor(g*C);v[x]={minTileX:T,minTileY:k,maxTileX:R,maxTileY:D}}return v}}class zr extends Fn{constructor(e,n,u,p){super(e,n,u,p),this.roundZoom=!0,this.type="video",this.options=n}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;let e=this.options;this.urls=[];for(let n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{let n=yield s.a2(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new s.k(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new s.k(new s.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new pi(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let u=!1;for(let p in this.tiles){let g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Lo extends Fn{constructor(e,n,u,p){super(e,n,u,p),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new s.k(new s.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a3(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new s.k(new s.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let n=this.map.painter.context,u=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new pi(n,this.canvas,u.RGBA,{premultiply:!0});let p=!1;for(let g in this.tiles){let v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}let Kt={},sn=f=>{switch(f){case"geojson":return Pn;case"image":return Fn;case"raster":return on;case"raster-dem":return ha;case"vector":return rn;case"video":return zr;case"canvas":return Lo}return Kt[f]},gr="RTLPluginLoaded";class Er extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=is()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return s._(this,arguments,void 0,function*(n,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ve.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(gr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ji=null;function Oi(){return ji||(ji=new Er),ji}class Br{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=s.a4(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(p,g){let v={};if(!g)return v;for(let x of p){let C=x.layerIds.map(T=>g.getLayer(T)).filter(Boolean);if(C.length!==0){x.layers=C,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(T=>C.filter(k=>k.id===T)[0]));for(let T of C)v[T.id]=x}}return v}(e.buckets,n?.style),this.hasSymbolBuckets=!1;for(let p in this.buckets){let g=this.buckets[p];if(g instanceof s.a6){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let p in this.buckets){let g=this.buckets[p];if(g instanceof s.a6&&g.hasRTLText){this.hasRTLText=!0,Oi().lazyLoad();break}}this.queryPadding=0;for(let p in this.buckets){let g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(p).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s.a5}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let u in this.buckets){let p=this.buckets[u];p.uploadPending()&&p.upload(e)}let n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new pi(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new pi(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,u,p,g,v,x,C,T,k,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:v,tileSize:this.tileSize,pixelPosMatrix:k,transform:C,params:x,queryPadding:this.queryPadding*T,getElevation:R},e,n,u):{}}querySourceFeatures(e,n){let u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;let p=u.loadVTLayers(),g=n&&n.sourceLayer?n.sourceLayer:"",v=p._geojsonTileLayer||p[g];if(!v)return;let x=s.a7(n&&n.filter),{z:C,x:T,y:k}=this.tileID.canonical,R={z:C,x:T,y:k};for(let D=0;D<v.length;D++){let j=v.feature(D);if(x.needGeometry){let ee=s.a8(j,!0);if(!x.filter(new s.C(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!x.filter(new s.C(this.tileID.overscaledZ),j))continue;let U=u.getId(j,g),te=new s.a9(j,C,T,k,U);te.tile=R,e.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let n=this.expirationTime;if(e.cacheControl){let u=s.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let u=Date.now(),p=!1;if(this.expirationTime>u)p=!1;else if(n)if(this.expirationTime<n)p=!0;else{let g=this.expirationTime-n;g?this.expirationTime=u+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let u=this.latestFeatureIndex.loadVTLayers();for(let p in this.buckets){if(!n.style.hasLayer(p))continue;let g=this.buckets[p],v=g.layers[0].sourceLayer||"_geojsonTileLayer",x=u[v],C=e[v];if(!x||!C||Object.keys(C).length===0)continue;g.update(C,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});let T=n&&n.style&&n.style.getLayer(p);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ve.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ve.now()+e}setDependencies(e,n){let u={};for(let p of n)u[p]=!0;this.dependencies[e]=u}hasDependency(e,n){for(let u of e){let p=this.dependencies[u];if(p){for(let g of n)if(p[g])return!0}}return!1}}class fo{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(let e in this.data)for(let n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,u){let p=e.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);let g={value:n,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(e,g)},u)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){let v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){let n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;let u=e.wrapped().key,p=n===void 0?0:this.data[u].indexOf(n),g=this.data[u][p];return this.data[u].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){let n=[];for(let u in this.data)for(let p of this.data[u])e(p.value)||n.push(p);for(let u of n)this.remove(u.value.tileID,u)}}class Qr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,u){let p=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][p]=this.stateChanges[e][p]||{},s.e(this.stateChanges[e][p],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(let g in this.state[e])g!==p&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][p]===null){this.deletedStates[e][p]={};for(let g in this.state[e][p])u[g]||(this.deletedStates[e][p][g]=null)}else for(let g in u)this.deletedStates[e]&&this.deletedStates[e][p]&&this.deletedStates[e][p][g]===null&&delete this.deletedStates[e][p][g]}removeFeatureState(e,n,u){if(this.deletedStates[e]===null)return;let p=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&n!==void 0)this.deletedStates[e][p]!==null&&(this.deletedStates[e][p]=this.deletedStates[e][p]||{},this.deletedStates[e][p][u]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][p])for(u in this.deletedStates[e][p]={},this.stateChanges[e][p])this.deletedStates[e][p][u]=null;else this.deletedStates[e][p]=null;else this.deletedStates[e]=null}getState(e,n){let u=String(n),p=s.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let g=this.deletedStates[e][n];if(g===null)return{};for(let v in g)delete p[v]}return p}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){let u={};for(let p in this.stateChanges){this.state[p]=this.state[p]||{};let g={};for(let v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),s.e(this.state[p][v],this.stateChanges[p][v]),g[v]=this.state[p][v];u[p]=g}for(let p in this.deletedStates){this.state[p]=this.state[p]||{};let g={};if(this.deletedStates[p]===null)for(let v in this.state[p])g[v]={},this.state[p][v]={};else for(let v in this.deletedStates[p]){if(this.deletedStates[p][v]===null)this.state[p][v]={};else for(let x of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][x];g[v]=this.state[p][v]}u[p]=u[p]||{},s.e(u[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(let p in e)e[p].setFeatureState(u,n)}}let Ii=89.25;function or(f,e){let n=s.ae(e.lat,-85.051129,s.af);return new s.P(s.U(e.lng)*f,s.S(n)*f)}function Tr(f,e){return new s.$(e.x/f,e.y/f).toLngLat()}function xe(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(s.ab(90-f.pitch)),Math.tan(s.ab(Ii-f.pitch)))}function H(f,e){let n=f.canonical,u=e/s.ac(n.z),p=n.x+Math.pow(2,n.z)*f.wrap,g=s.ad(new Float64Array(16));return s.L(g,g,[p*u,n.y*u,0]),s.M(g,g,[u/s.Z,u/s.Z,1]),g}function Z(f,e,n,u,p){let g=s.$.fromLngLat(f,e),v=p*s.ag(1,f.lat),x=v*Math.cos(s.ab(n)),C=Math.sqrt(v*v-x*x),T=C*Math.sin(s.ab(-u)),k=C*Math.cos(s.ab(-u));return new s.$(g.x+T,g.y+k,g.z+x)}function J(f,e,n){let u=e.intersectsFrustum(f);if(!n)return u;let p=e.intersectsPlane(n);return u===0||p===0?0:u===2&&p===2?2:1}function le(f,e,n){let u=0,p=(n-e)/10;for(let g=0;g<10;g++)u+=p*Math.pow(Math.cos(e+(g+.5)/10*(n-e)),f);return u}function fe(f,e){return function(n,u,p,g,v){let x=2*((f-1)/s.ah(Math.cos(s.ab(Ii-v))/Math.cos(s.ab(Ii)))-1),C=Math.acos(p/g),T=2*le(x-1,0,s.ab(v/2)),k=Math.min(s.ab(Ii),C+s.ab(v/2)),R=le(x-1,Math.min(k,C-s.ab(v/2)),k),D=Math.atan(u/p),j=Math.hypot(u,p),U=n;return U+=s.ah(g/j/Math.max(.5,Math.cos(s.ab(v/2)))),U+=x*s.ah(Math.cos(D))/2,U-=s.ah(Math.max(1,R/T/e))/2,U}}let Q=fe(9.314,3);function Me(f,e){let n=(e.roundZoom?Math.round:Math.floor)(f.zoom+s.ah(f.tileSize/e.tileSize));return Math.max(0,n)}function ye(f,e){let n=f.getCameraFrustum(),u=f.getClippingPlane(),p=f.screenPointToMercatorCoordinate(f.getCameraPoint()),g=s.$.fromLngLat(f.center,f.elevation);p.z=g.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;let v=f.getCoveringTilesDetailsProvider(),x=v.allowVariableZoom(f,e),C=Me(f,e),T=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,R=Math.min(Math.max(0,C),k),D=Math.pow(2,R),j=[D*p.x,D*p.y,0],U=[D*g.x,D*g.y,0],te=Math.hypot(g.x-p.x,g.y-p.y),ee=Math.abs(g.z-p.z),ie=Math.hypot(te,ee),se=he=>({zoom:0,x:0,y:0,wrap:he,fullyVisible:!1}),ue=[],de=[];if(f.renderWorldCopies&&v.allowWorldCopies())for(let he=1;he<=3;he++)ue.push(se(-he)),ue.push(se(he));for(ue.push(se(0));ue.length>0;){let he=ue.pop(),_e=he.x,pe=he.y,Se=he.fullyVisible,Be={x:_e,y:pe,z:he.zoom},ke=v.getTileAABB(Be,he.wrap,f.elevation,e);if(!Se){let Ke=J(n,ke,u);if(Ke===0)continue;Se=Ke===2}let Ae=v.distanceToTile2d(p.x,p.y,Be,ke),Re=C;x&&(Re=(e.calculateTileZoom||Q)(f.zoom+s.ah(f.tileSize/e.tileSize),Ae,ee,ie,f.fov)),Re=(e.roundZoom?Math.round:Math.floor)(Re),Re=Math.max(0,Re);let Je=Math.min(Re,k);if(he.wrap=v.getWrap(g,Be,he.wrap),he.zoom>=Je){if(he.zoom<T)continue;let Ke=R-he.zoom,He=j[0]-.5-(_e<<Ke),ct=j[1]-.5-(pe<<Ke),Nt=e.reparseOverscaled?Math.max(he.zoom,Re):he.zoom;de.push({tileID:new s.Y(he.zoom===k?Nt:he.zoom,he.wrap,he.zoom,_e,pe),distanceSq:s.ai([U[0]-.5-_e,U[1]-.5-pe]),tileDistanceToCamera:Math.sqrt(He*He+ct*ct)})}else for(let Ke=0;Ke<4;Ke++)ue.push({zoom:he.zoom+1,x:(_e<<1)+Ke%2,y:(pe<<1)+(Ke>>1),wrap:he.wrap,fullyVisible:Se})}return de.sort((he,_e)=>he.distanceSq-_e.distanceSq).map(he=>he.tileID)}class Ce extends s.E{constructor(e,n,u){super(),this.id=e,this.dispatcher=u,this.on("data",p=>this._dataHandler(p)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((p,g,v,x)=>{let C=new(sn(g.type))(p,g,v,x);if(C.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${C.id}`);return C})(e,n,u,this),this._tiles={},this._cache=new fo(0,p=>this._unloadTile(p)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Qr,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let e in this._tiles){let n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,u){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,u)}catch(p){e.state="errored",p.status!==404?this._source.fire(new s.k(p,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new s.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let n in this._tiles){let u=this._tiles[n];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Ee).map(e=>e.key)}getRenderableIds(e){let n=[];for(let u in this._tiles)this._isIdRenderable(u,e)&&n.push(this._tiles[u]);return e?n.sort((u,p)=>{let g=u.tileID,v=p.tileID,x=new s.P(g.canonical.x,g.canonical.y)._rotate(-this.transform.bearingInRadians),C=new s.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians);return g.overscaledZ-v.overscaledZ||C.y-x.y||C.x-x.x}).map(u=>u.tileID.key):n.map(u=>u.tileID).sort(Ee).map(u=>u.key)}hasRenderableParent(e){let n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return s._(this,void 0,void 0,function*(){let u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=n),yield this._loadTile(u,e,n))})}_tileLoaded(e,n,u){e.timeAdded=ve.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let n=this.getRenderableIds();for(let p=0;p<n.length;p++){let g=n[p];if(e.neighboringTiles&&e.neighboringTiles[g]){let v=this.getTileByID(g);u(e,v),u(v,e)}}function u(p,g){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let v=g.tileID.canonical.x-p.tileID.canonical.x,x=g.tileID.canonical.y-p.tileID.canonical.y,C=Math.pow(2,p.tileID.canonical.z),T=g.tileID.key;v===0&&x===0||Math.abs(x)>1||(Math.abs(v)>1&&(Math.abs(v+C)===1?v+=C:Math.abs(v-C)===1&&(v-=C)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,v,x),p.neighboringTiles&&p.neighboringTiles[T]&&(p.neighboringTiles[T].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,u,p){for(let g in this._tiles){let v=this._tiles[g];if(p[g]||!v.hasData()||v.tileID.overscaledZ<=n||v.tileID.overscaledZ>u)continue;let x=v.tileID;for(;v&&v.tileID.overscaledZ>n+1;){let T=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[T.key],v&&v.hasData()&&(x=T)}let C=x;for(;C.overscaledZ>n;)if(C=C.scaledTo(C.overscaledZ-1),e[C.key]||e[C.canonical.key]){p[x.key]=x;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){let u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=n?u:null}for(let u=e.overscaledZ-1;u>=n;u--){let p=e.scaledTo(u),g=this._getLoadedTile(p);if(g)return g}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){let n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let n=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,p=Math.floor(n*u*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(e){let n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){let u={};for(let p in this._tiles){let g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+n),u[g.tileID.key]=g}this._tiles=u;for(let p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(let p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}_updateCoveredAndRetainedTiles(e,n,u,p,g,v){let x={},C={},T=Object.keys(e),k=ve.now();for(let R of T){let D=e[R],j=this._tiles[R];if(!j||j.fadeEndTime!==0&&j.fadeEndTime<=k)continue;let U=this.findLoadedParent(D,n),te=this.findLoadedSibling(D),ee=U||te||null;ee&&(this._addTile(ee.tileID),x[ee.tileID.key]=ee.tileID),C[R]=D}this._retainLoadedChildren(C,p,u,e);for(let R in x)e[R]||(this._coveredTiles[R]=!0,e[R]=x[R]);if(v){let R={},D={};for(let j of g)this._tiles[j.key].hasData()?R[j.key]=j:D[j.key]=j;for(let j in D){let U=D[j].children(this._source.maxzoom);this._tiles[U[0].key]&&this._tiles[U[1].key]&&this._tiles[U[2].key]&&this._tiles[U[3].key]&&(R[U[0].key]=e[U[0].key]=U[0],R[U[1].key]=e[U[1].key]=U[1],R[U[2].key]=e[U[2].key]=U[2],R[U[3].key]=e[U[3].key]=U[3],delete D[j])}for(let j in D){let U=D[j],te=this.findLoadedParent(U,this._source.minzoom),ee=this.findLoadedSibling(U),ie=te||ee||null;if(ie){R[ie.tileID.key]=e[ie.tileID.key]=ie.tileID;for(let se in R)R[se].isChildOf(ie.tileID)&&delete R[se]}}for(let j in this._tiles)R[j]||(this._coveredTiles[j]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new s.Y(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(u=ye(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(u=u.filter(k=>this._source.hasTile(k)))):u=[];let p=Me(e,this._source),g=Math.max(p-Ce.maxOverzooming,this._source.minzoom),v=Math.max(p+Ce.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let k={};for(let R of u)if(R.canonical.z>this._source.minzoom){let D=R.scaledTo(R.canonical.z-1);k[D.key]=D;let j=R.scaledTo(Math.max(this._source.minzoom,Math.min(R.canonical.z,5)));k[j.key]=j}u=u.concat(Object.values(k))}let x=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let C=this._updateRetainedTiles(u,p);we(this._source.type)&&this._updateCoveredAndRetainedTiles(C,g,v,p,u,n);for(let k in C)this._tiles[k].clearFadeHold();let T=s.aj(this._tiles,C);for(let k of T){let R=this._tiles[k];R.hasSymbolBuckets&&!R.holdingForFade()?R.setHoldDuration(this.map._fadeDuration):R.hasSymbolBuckets&&!R.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var u;let p={},g={},v=Math.max(n-Ce.maxOverzooming,this._source.minzoom),x=Math.max(n+Ce.maxUnderzooming,this._source.minzoom),C={};for(let T of e){let k=this._addTile(T);p[T.key]=T,k.hasData()||n<this._source.maxzoom&&(C[T.key]=T)}this._retainLoadedChildren(C,n,x,p);for(let T of e){let k=this._tiles[T.key];if(k.hasData())continue;if(n+1>this._source.maxzoom){let D=T.children(this._source.maxzoom)[0],j=this.getTile(D);if(j&&j.hasData()){p[D.key]=D;continue}}else{let D=T.children(this._source.maxzoom);if(p[D[0].key]&&p[D[1].key]&&p[D[2].key]&&p[D[3].key])continue}let R=k.wasRequested();for(let D=T.overscaledZ-1;D>=v;--D){let j=T.scaledTo(D);if(g[j.key])break;if(g[j.key]=!0,k=this.getTile(j),!k&&R&&(k=this._addTile(j)),k){let U=k.hasData();if((U||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||R)&&(p[j.key]=j),R=k.wasRequested(),U)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let n=[],u,p=this._tiles[e].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}n.push(p.key);let g=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;p=g}for(let g of n)this._loadedParentTiles[g]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(let e in this._tiles){let n=this._tiles[e].tileID,u=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=u}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));let u=n;return n||(n=new Br(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,u||this._source.fire(new s.l("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let u=n.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}refreshTiles(e){for(let n in this._tiles)this._isIdRenderable(n)&&e.some(u=>u.equals(this._tiles[n].tileID.canonical))&&this._reloadTile(n,"expired")}_removeTile(e){let n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){let n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,u){let p=[],g=this.transform;if(!g)return p;let v=u?g.getCameraQueryGeometry(e):e,x=e.map(U=>g.screenPointToMercatorCoordinate(U,this.terrain)),C=v.map(U=>g.screenPointToMercatorCoordinate(U,this.terrain)),T=this.getIds(),k=1/0,R=1/0,D=-1/0,j=-1/0;for(let U of C)k=Math.min(k,U.x),R=Math.min(R,U.y),D=Math.max(D,U.x),j=Math.max(j,U.y);for(let U=0;U<T.length;U++){let te=this._tiles[T[U]];if(te.holdingForFade())continue;let ee=g.getCoveringTilesDetailsProvider().allowWorldCopies()?te.tileID:te.tileID.unwrapTo(0),ie=Math.pow(2,g.zoom-te.tileID.overscaledZ),se=n*te.queryPadding*s.Z/te.tileSize/ie,ue=[ee.getTilePoint(new s.$(k,R)),ee.getTilePoint(new s.$(D,j))];if(ue[0].x-se<s.Z&&ue[0].y-se<s.Z&&ue[1].x+se>=0&&ue[1].y+se>=0){let de=x.map(_e=>ee.getTilePoint(_e)),he=C.map(_e=>ee.getTilePoint(_e));p.push({tile:te,tileID:ee,queryGeometry:de,cameraQueryGeometry:he,scale:ie})}}return p}getVisibleCoordinates(e){let n=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(we(this._source.type)){let e=ve.now();for(let n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,u){this._state.updateState(e=e||"_geojsonTileLayer",n,u)}removeFeatureState(e,n,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,u)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,u){let p=this._tiles[e];p&&p.setDependencies(n,u)}reloadTilesForDependencies(e,n){for(let u in this._tiles)this._tiles[u].hasDependency(e,n)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,n))}}function Ee(f,e){let n=Math.abs(2*f.wrap)-+(f.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||u-n||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function we(f){return f==="raster"||f==="image"||f==="video"}Ce.maxOverzooming=10,Ce.maxUnderzooming=3;class je{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=s.ae(e,0,1);let n=1,u=this._distances[n],p=e*this.paddedLength+this.padding;for(;u<p&&n<this._distances.length;)u=this._distances[++n];let g=n-1,v=this._distances[g],x=u-v,C=x>0?(p-v)/x:0;return this.points[g].mult(1-C).add(this.points[n].mult(C))}}function Ye(f,e){let n=!0;return f==="always"||f!=="never"&&e!=="never"||(n=!1),n}class et{constructor(e,n,u){let p=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(n/u);for(let v=0;v<this.xCellCount*this.yCellCount;v++)p.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,u,p,g){this._forEachCell(n,u,p,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(g)}insertCircle(e,n,u,p){this._forEachCell(n-p,u-p,n+p,u+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(u),this.circles.push(p)}_insertBoxCell(e,n,u,p,g,v){this.boxCells[g].push(v)}_insertCircleCell(e,n,u,p,g,v){this.circleCells[g].push(v)}_query(e,n,u,p,g,v,x){if(u<0||e>this.width||p<0||n>this.height)return[];let C=[];if(e<=0&&n<=0&&this.width<=u&&this.height<=p){if(g)return[{key:null,x1:e,y1:n,x2:u,y2:p}];for(let T=0;T<this.boxKeys.length;T++)C.push({key:this.boxKeys[T],x1:this.bboxes[4*T],y1:this.bboxes[4*T+1],x2:this.bboxes[4*T+2],y2:this.bboxes[4*T+3]});for(let T=0;T<this.circleKeys.length;T++){let k=this.circles[3*T],R=this.circles[3*T+1],D=this.circles[3*T+2];C.push({key:this.circleKeys[T],x1:k-D,y1:R-D,x2:k+D,y2:R+D})}}else this._forEachCell(e,n,u,p,this._queryCell,C,{hitTest:g,overlapMode:v,seenUids:{box:{},circle:{}}},x);return C}query(e,n,u,p){return this._query(e,n,u,p,!1,null)}hitTest(e,n,u,p,g,v){return this._query(e,n,u,p,!0,g,v).length>0}hitTestCircle(e,n,u,p,g){let v=e-u,x=e+u,C=n-u,T=n+u;if(x<0||v>this.width||T<0||C>this.height)return!1;let k=[];return this._forEachCell(v,C,x,T,this._queryCellCircle,k,{hitTest:!0,overlapMode:p,circle:{x:e,y:n,radius:u},seenUids:{box:{},circle:{}}},g),k.length>0}_queryCell(e,n,u,p,g,v,x,C){let{seenUids:T,hitTest:k,overlapMode:R}=x,D=this.boxCells[g];if(D!==null){let U=this.bboxes;for(let te of D)if(!T.box[te]){T.box[te]=!0;let ee=4*te,ie=this.boxKeys[te];if(e<=U[ee+2]&&n<=U[ee+3]&&u>=U[ee+0]&&p>=U[ee+1]&&(!C||C(ie))&&(!k||!Ye(R,ie.overlapMode))&&(v.push({key:ie,x1:U[ee],y1:U[ee+1],x2:U[ee+2],y2:U[ee+3]}),k))return!0}}let j=this.circleCells[g];if(j!==null){let U=this.circles;for(let te of j)if(!T.circle[te]){T.circle[te]=!0;let ee=3*te,ie=this.circleKeys[te];if(this._circleAndRectCollide(U[ee],U[ee+1],U[ee+2],e,n,u,p)&&(!C||C(ie))&&(!k||!Ye(R,ie.overlapMode))){let se=U[ee],ue=U[ee+1],de=U[ee+2];if(v.push({key:ie,x1:se-de,y1:ue-de,x2:se+de,y2:ue+de}),k)return!0}}}return!1}_queryCellCircle(e,n,u,p,g,v,x,C){let{circle:T,seenUids:k,overlapMode:R}=x,D=this.boxCells[g];if(D!==null){let U=this.bboxes;for(let te of D)if(!k.box[te]){k.box[te]=!0;let ee=4*te,ie=this.boxKeys[te];if(this._circleAndRectCollide(T.x,T.y,T.radius,U[ee+0],U[ee+1],U[ee+2],U[ee+3])&&(!C||C(ie))&&!Ye(R,ie.overlapMode))return v.push(!0),!0}}let j=this.circleCells[g];if(j!==null){let U=this.circles;for(let te of j)if(!k.circle[te]){k.circle[te]=!0;let ee=3*te,ie=this.circleKeys[te];if(this._circlesCollide(U[ee],U[ee+1],U[ee+2],T.x,T.y,T.radius)&&(!C||C(ie))&&!Ye(R,ie.overlapMode))return v.push(!0),!0}}}_forEachCell(e,n,u,p,g,v,x,C){let T=this._convertToXCellCoord(e),k=this._convertToYCellCoord(n),R=this._convertToXCellCoord(u),D=this._convertToYCellCoord(p);for(let j=T;j<=R;j++)for(let U=k;U<=D;U++)if(g.call(this,e,n,u,p,this.xCellCount*U+j,v,x,C))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,u,p,g,v){let x=p-e,C=g-n,T=u+v;return T*T>x*x+C*C}_circleAndRectCollide(e,n,u,p,g,v,x){let C=(v-p)/2,T=Math.abs(e-(p+C));if(T>C+u)return!1;let k=(x-g)/2,R=Math.abs(n-(g+k));if(R>k+u)return!1;if(T<=C||R<=k)return!0;let D=T-C,j=R-k;return D*D+j*j<=u*u}}function gt(f,e,n){let u=s.K();if(!f){let{vecSouth:R,vecEast:D}=Pt(e),j=q();j[0]=D[0],j[1]=D[1],j[2]=R[0],j[3]=R[1],p=j,(k=(v=(g=j)[0])*(T=g[3])-(C=g[2])*(x=g[1]))&&(p[0]=T*(k=1/k),p[1]=-x*k,p[2]=-C*k,p[3]=v*k),u[0]=j[0],u[1]=j[1],u[4]=j[2],u[5]=j[3]}var p,g,v,x,C,T,k;return s.M(u,u,[1/n,1/n,1]),u}function Dt(f,e,n,u){if(f){let p=s.K();if(!e){let{vecSouth:g,vecEast:v}=Pt(n);p[0]=v[0],p[1]=v[1],p[4]=g[0],p[5]=g[1]}return s.M(p,p,[u,u,1]),p}return n.pixelsToClipSpaceMatrix}function Pt(f){let e=Math.cos(f.rollInRadians),n=Math.sin(f.rollInRadians),u=Math.cos(f.pitchInRadians),p=Math.cos(f.bearingInRadians),g=Math.sin(f.bearingInRadians),v=s.ao();v[0]=-p*u*n-g*e,v[1]=-g*u*n+p*e;let x=s.ap(v);x<1e-9?s.aq(v):s.ar(v,v,1/x);let C=s.ao();C[0]=p*u*e-g*n,C[1]=g*u*e+p*n;let T=s.ap(C);return T<1e-9?s.aq(C):s.ar(C,C,1/T),{vecEast:C,vecSouth:v}}function De(f,e,n,u){let p;u?(p=[f,e,u(f,e),1],s.at(p,p,n)):(p=[f,e,0,1],zo(p,p,n));let g=p[3];return{point:new s.P(p[0]/g,p[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function ai(f,e){return .5+f/e*.5}function jt(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function li(f,e,n,u,p,g,v,x,C,T,k,R,D){let j=n?f.textSizeData:f.iconSizeData,U=s.ak(j,e.transform.zoom),te=[256/e.width*2+1,256/e.height*2+1],ee=n?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ee.clear();let ie=f.lineVertexArray,se=n?f.text.placedSymbolArray:f.icon.placedSymbolArray,ue=e.transform.width/e.transform.height,de=!1;for(let he=0;he<se.length;he++){let _e=se.get(he);if(_e.hidden||_e.writingMode===s.al.vertical&&!de){_r(_e.numGlyphs,ee);continue}de=!1;let pe=new s.P(_e.anchorX,_e.anchorY),Se={getElevation:D,pitchedLabelPlaneMatrix:u,lineVertexArray:ie,pitchWithMap:g,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:pe,unwrappedTileID:C,width:T,height:k,translation:R},Be=zt(_e.anchorX,_e.anchorY,Se);if(!jt(Be.point,te)){_r(_e.numGlyphs,ee);continue}let ke=ai(e.transform.cameraToCenterDistance,Be.signedDistanceFromCamera),Ae=s.am(j,U,_e),Re=g?Ae*e.transform.getPitchedTextCorrection(_e.anchorX,_e.anchorY,C)/ke:Ae*ke,Je=yt({projectionContext:Se,pitchedLabelPlaneMatrixInverse:p,symbol:_e,fontSize:Re,flip:!1,keepUpright:v,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:ue,rotateToLine:x});de=Je.useVertical,(Je.notEnoughRoom||de||Je.needsFlipping&&yt({projectionContext:Se,pitchedLabelPlaneMatrixInverse:p,symbol:_e,fontSize:Re,flip:!0,keepUpright:v,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:ue,rotateToLine:x}).notEnoughRoom)&&_r(_e.numGlyphs,ee)}n?f.text.dynamicLayoutVertexBuffer.updateData(ee):f.icon.dynamicLayoutVertexBuffer.updateData(ee)}function Mt(f,e,n,u,p,g,v,x){let C=g.glyphStartIndex+g.numGlyphs,T=g.lineStartIndex,k=g.lineStartIndex+g.lineLength,R=e.getoffsetX(g.glyphStartIndex),D=e.getoffsetX(C-1),j=rs(f*R,n,u,p,g.segment,T,k,x,v);if(!j)return null;let U=rs(f*D,n,u,p,g.segment,T,k,x,v);return U?x.projectionCache.anyProjectionOccluded?null:{first:j,last:U}:null}function Ve(f,e,n,u){return f===s.al.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*u?{useVertical:!0}:(f===s.al.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function yt(f){let{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:u,fontSize:p,flip:g,keepUpright:v,glyphOffsetArray:x,dynamicLayoutVertexArray:C,aspectRatio:T,rotateToLine:k}=f,R=p/24,D=u.lineOffsetX*R,j=u.lineOffsetY*R,U;if(u.numGlyphs>1){let te=u.glyphStartIndex+u.numGlyphs,ee=u.lineStartIndex,ie=u.lineStartIndex+u.lineLength,se=Mt(R,x,D,j,g,u,k,e);if(!se)return{notEnoughRoom:!0};let ue=sr(se.first.point.x,se.first.point.y,e,n),de=sr(se.last.point.x,se.last.point.y,e,n);if(v&&!g){let he=Ve(u.writingMode,ue,de,T);if(he)return he}U=[se.first];for(let he=u.glyphStartIndex+1;he<te-1;he++)U.push(rs(R*x.getoffsetX(he),D,j,g,u.segment,ee,ie,e,k));U.push(se.last)}else{if(v&&!g){let ee=Ui(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ie=u.lineStartIndex+u.segment+1,se=new s.P(e.lineVertexArray.getx(ie),e.lineVertexArray.gety(ie)),ue=Ui(se.x,se.y,e),de=ue.signedDistanceFromCamera>0?ue.point:Rt(e.tileAnchorPoint,se,ee,1,e),he=sr(ee.x,ee.y,e,n),_e=sr(de.x,de.y,e,n),pe=Ve(u.writingMode,he,_e,T);if(pe)return pe}let te=rs(R*x.getoffsetX(u.glyphStartIndex),D,j,g,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,e,k);if(!te||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};U=[te]}for(let te of U)s.as(C,te.point,te.angle);return{}}function Rt(f,e,n,u,p){let g=f.add(f.sub(e)._unit()),v=Ui(g.x,g.y,p).point,x=n.sub(v);return n.add(x._mult(u/x.mag()))}function Tt(f,e,n){let u=e.projectionCache;if(u.projections[f])return u.projections[f];let p=new s.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),g=Ui(p.x,p.y,e);if(g.signedDistanceFromCamera>0)return u.projections[f]=g.point,u.anyProjectionOccluded=u.anyProjectionOccluded||g.isOccluded,g.point;let v=f-n.direction;return Rt(n.distanceFromAnchor===0?e.tileAnchorPoint:new s.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),p,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function Ui(f,e,n){let u=f+n.translation[0],p=e+n.translation[1],g;return n.pitchWithMap?(g=De(u,p,n.pitchedLabelPlaneMatrix,n.getElevation),g.isOccluded=!1):(g=n.transform.projectTileCoordinates(u,p,n.unwrappedTileID,n.getElevation),g.point.x=(.5*g.point.x+.5)*n.width,g.point.y=(.5*-g.point.y+.5)*n.height),g}function sr(f,e,n,u){if(n.pitchWithMap){let p=[f,e,0,1];return s.at(p,p,u),n.transform.projectTileCoordinates(p[0]/p[3],p[1]/p[3],n.unwrappedTileID,n.getElevation).point}return{x:f/n.width*2-1,y:e/n.height*2-1}}function zt(f,e,n){return n.transform.projectTileCoordinates(f,e,n.unwrappedTileID,n.getElevation)}function Rs(f,e,n){return f._unit()._perp()._mult(e*n)}function pa(f,e,n,u,p,g,v,x,C){if(x.projectionCache.offsets[f])return x.projectionCache.offsets[f];let T=n.add(e);if(f+C.direction<u||f+C.direction>=p)return x.projectionCache.offsets[f]=T,T;let k=Tt(f+C.direction,x,C),R=Rs(k.sub(n),v,C.direction),D=n.add(R),j=k.add(R);return x.projectionCache.offsets[f]=s.au(g,T,D,j)||T,x.projectionCache.offsets[f]}function rs(f,e,n,u,p,g,v,x,C){let T=u?f-e:f+e,k=T>0?1:-1,R=0;u&&(k*=-1,R=Math.PI),k<0&&(R+=Math.PI);let D,j=k>0?g+p:g+p+1;x.projectionCache.cachedAnchorPoint?D=x.projectionCache.cachedAnchorPoint:(D=Ui(x.tileAnchorPoint.x,x.tileAnchorPoint.y,x).point,x.projectionCache.cachedAnchorPoint=D);let U,te,ee=D,ie=D,se=0,ue=0,de=Math.abs(T),he=[],_e;for(;se+ue<=de;){if(j+=k,j<g||j>=v)return null;se+=ue,ie=ee,te=U;let Be={absOffsetX:de,direction:k,distanceFromAnchor:se,previousVertex:ie};if(ee=Tt(j,x,Be),n===0)he.push(ie),_e=ee.sub(ie);else{let ke,Ae=ee.sub(ie);ke=Ae.mag()===0?Rs(Tt(j+k,x,Be).sub(ee),n,k):Rs(Ae,n,k),te||(te=ie.add(ke)),U=pa(j,ke,ee,g,v,te,n,x,Be),he.push(te),_e=U.sub(te)}ue=_e.mag()}let pe=_e._mult((de-se)/ue)._add(te||ie),Se=R+Math.atan2(ee.y-ie.y,ee.x-ie.x);return he.push(pe),{point:pe,angle:C?Se:0,path:he}}let os=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function _r(f,e){for(let n=0;n<f;n++){let u=e.length;e.resize(u+4),e.float32.set(os,3*u)}}function zo(f,e,n){let u=e[0],p=e[1];return f[0]=n[0]*u+n[4]*p+n[12],f[1]=n[1]*u+n[5]*p+n[13],f[3]=n[3]*u+n[7]*p+n[15],f}let Fi=100;class ui{constructor(e,n=new et(e.width+200,e.height+200,25),u=new et(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=u,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Fi,this.screenBottomBoundary=e.height+Fi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,u,p,g,v,x,C,T,k,R,D){let j=this.projectAndGetPerspectiveRatio(e.anchorPointX+C[0],e.anchorPointY+C[1],g,k,D),U=u*j.perspectiveRatio,te;if(v||x)te=this._projectCollisionBox(e,U,p,g,v,x,C,j,k,R,D);else{let _e=j.x+(R?R.x*U:0),pe=j.y+(R?R.y*U:0);te={allPointsOccluded:!1,box:[_e+e.x1*U,pe+e.y1*U,_e+e.x2*U,pe+e.y2*U]}}let[ee,ie,se,ue]=te.box,de=v?te.allPointsOccluded:j.isOccluded,he=de;return he||(he=j.perspectiveRatio<this.perspectiveRatioCutoff),he||(he=!this.isInsideGrid(ee,ie,se,ue)),he||n!=="always"&&this.grid.hitTest(ee,ie,se,ue,n,T)?{box:[ee,ie,se,ue],placeable:!1,offscreen:!1,occluded:de}:{box:[ee,ie,se,ue],placeable:!0,offscreen:this.isOffscreen(ee,ie,se,ue),occluded:de}}placeCollisionCircles(e,n,u,p,g,v,x,C,T,k,R,D,j,U){let te=[],ee=new s.P(n.anchorX,n.anchorY),ie=this.getPerspectiveRatio(ee.x,ee.y,v,U),se=(T?g*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,v)/ie:g*ie)/s.ay,ue={getElevation:U,pitchedLabelPlaneMatrix:x,lineVertexArray:u,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ee,unwrappedTileID:v,width:this.transform.width,height:this.transform.height,translation:j},de=Mt(se,p,n.lineOffsetX*se,n.lineOffsetY*se,!1,n,!1,ue),he=!1,_e=!1,pe=!0;if(de){let Se=.5*R*ie+D,Be=new s.P(-100,-100),ke=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Ae=new je,Re=de.first,Je=de.last,Ke=[];for(let Nt=Re.path.length-1;Nt>=1;Nt--)Ke.push(Re.path[Nt]);for(let Nt=1;Nt<Je.path.length;Nt++)Ke.push(Je.path[Nt]);let He=2.5*Se;if(T){let Nt=this.projectPathToScreenSpace(Ke,ue);Ke=Nt.some(ii=>ii.signedDistanceFromCamera<=0)?[]:Nt.map(ii=>ii.point)}let ct=[];if(Ke.length>0){let Nt=Ke[0].clone(),ii=Ke[0].clone();for(let qi=1;qi<Ke.length;qi++)Nt.x=Math.min(Nt.x,Ke[qi].x),Nt.y=Math.min(Nt.y,Ke[qi].y),ii.x=Math.max(ii.x,Ke[qi].x),ii.y=Math.max(ii.y,Ke[qi].y);ct=Nt.x>=Be.x&&ii.x<=ke.x&&Nt.y>=Be.y&&ii.y<=ke.y?[Ke]:ii.x<Be.x||Nt.x>ke.x||ii.y<Be.y||Nt.y>ke.y?[]:s.av([Ke],Be.x,Be.y,ke.x,ke.y)}for(let Nt of ct){Ae.reset(Nt,.25*Se);let ii=0;ii=Ae.length<=.5*Se?1:Math.ceil(Ae.paddedLength/He)+1;for(let qi=0;qi<ii;qi++){let Ei=qi/Math.max(ii-1,1),Xi=Ae.lerp(Ei),Yi=Xi.x+Fi,Ai=Xi.y+Fi;te.push(Yi,Ai,Se,0);let fi=Yi-Se,In=Ai-Se,Nn=Yi+Se,Yn=Ai+Se;if(pe=pe&&this.isOffscreen(fi,In,Nn,Yn),_e=_e||this.isInsideGrid(fi,In,Nn,Yn),e!=="always"&&this.grid.hitTestCircle(Yi,Ai,Se,e,k)&&(he=!0,!C))return{circles:[],offscreen:!1,collisionDetected:he}}}}return{circles:!C&&he||!_e||ie<this.perspectiveRatioCutoff?[]:te,offscreen:pe,collisionDetected:he}}projectPathToScreenSpace(e,n){let u=function(p,g){let v=s.K();return s.an(v,g.pitchedLabelPlaneMatrix),p.map(x=>{let C=De(x.x,x.y,v,g.getElevation),T=g.transform.projectTileCoordinates(C.point.x,C.point.y,g.unwrappedTileID,g.getElevation);return T.point.x=(.5*T.point.x+.5)*g.width,T.point.y=(.5*-T.point.y+.5)*g.height,T})}(e,n);return function(p){let g=0,v=0,x=0,C=0;for(let T=0;T<p.length;T++)p[T].isOccluded?(x=T+1,C=0):(C++,C>v&&(v=C,g=x));return p.slice(g,g+v)}(u)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let n=[],u=1/0,p=1/0,g=-1/0,v=-1/0;for(let k of e){let R=new s.P(k.x+Fi,k.y+Fi);u=Math.min(u,R.x),p=Math.min(p,R.y),g=Math.max(g,R.x),v=Math.max(v,R.y),n.push(R)}let x=this.grid.query(u,p,g,v).concat(this.ignoredGrid.query(u,p,g,v)),C={},T={};for(let k of x){let R=k.key;if(C[R.bucketInstanceId]===void 0&&(C[R.bucketInstanceId]={}),C[R.bucketInstanceId][R.featureIndex])continue;let D=[new s.P(k.x1,k.y1),new s.P(k.x2,k.y1),new s.P(k.x2,k.y2),new s.P(k.x1,k.y2)];s.aw(n,D)&&(C[R.bucketInstanceId][R.featureIndex]=!0,T[R.bucketInstanceId]===void 0&&(T[R.bucketInstanceId]=[]),T[R.bucketInstanceId].push(R.featureIndex))}return T}insertCollisionBox(e,n,u,p,g,v){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,u,p,g,v){let x=u?this.ignoredGrid:this.grid,C={bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:n};for(let T=0;T<e.length;T+=4)x.insertCircle(C,e[T],e[T+1],e[T+2])}projectAndGetPerspectiveRatio(e,n,u,p,g){if(g){let v;p?(v=[e,n,p(e,n),1],s.at(v,v,g)):(v=[e,n,0,1],zo(v,v,g));let x=v[3];return{x:(v[0]/x+1)/2*this.transform.width+Fi,y:(-v[1]/x+1)/2*this.transform.height+Fi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x*.5,isOccluded:!1,signedDistanceFromCamera:x}}{let v=this.transform.projectTileCoordinates(e,n,u,p);return{x:(v.point.x+1)/2*this.transform.width+Fi,y:(1-v.point.y)/2*this.transform.height+Fi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5,isOccluded:v.isOccluded,signedDistanceFromCamera:v.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,u,p){let g=this.transform.projectTileCoordinates(e,n,u,p);return .5+this.transform.cameraToCenterDistance/g.signedDistanceFromCamera*.5}isOffscreen(e,n,u,p){return u<Fi||e>=this.screenRightBoundary||p<Fi||n>this.screenBottomBoundary}isInsideGrid(e,n,u,p){return u>=0&&e<this.gridRightBoundary&&p>=0&&n<this.gridBottomBoundary}getViewportMatrix(){let e=s.ad([]);return s.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,u,p,g,v,x,C,T,k,R){let D=1,j=0,U=0,te=1,ee=e.anchorPointX+x[0],ie=e.anchorPointY+x[1];if(v&&!g){let Ke=this.projectAndGetPerspectiveRatio(ee+1,ie,p,T,R),He=Ke.x-C.x,ct=Math.atan((Ke.y-C.y)/He)+(He<0?Math.PI:0),Nt=Math.sin(ct),ii=Math.cos(ct);D=ii,j=Nt,U=-Nt,te=ii}else if(!v&&g){let Ke=Pt(this.transform);D=Ke.vecEast[0],j=Ke.vecEast[1],U=Ke.vecSouth[0],te=Ke.vecSouth[1]}let se=C.x,ue=C.y,de=n;g&&(se=ee,ue=ie,de=Math.pow(2,-(this.transform.zoom-u.overscaledZ)),de*=this.transform.getPitchedTextCorrection(ee,ie,p),k||(de*=s.ae(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(se+=D*k.x*de+U*k.y*de,ue+=j*k.x*de+te*k.y*de);let he=e.x1*de,_e=e.x2*de,pe=(he+_e)/2,Se=e.y1*de,Be=e.y2*de,ke=(Se+Be)/2,Ae=[{offsetX:he,offsetY:Se},{offsetX:pe,offsetY:Se},{offsetX:_e,offsetY:Se},{offsetX:_e,offsetY:ke},{offsetX:_e,offsetY:Be},{offsetX:pe,offsetY:Be},{offsetX:he,offsetY:Be},{offsetX:he,offsetY:ke}],Re=[];for(let{offsetX:Ke,offsetY:He}of Ae)Re.push(new s.P(se+D*Ke+U*He,ue+j*Ke+te*He));let Je=!1;if(g){let Ke=Re.map(He=>this.projectAndGetPerspectiveRatio(He.x,He.y,p,T,R));Je=Ke.some(He=>!He.isOccluded),Re=Ke.map(He=>new s.P(He.x,He.y))}else Je=!0;return{box:s.ax(Re),allPointsOccluded:!Je}}}class ki{constructor(e,n,u,p){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):p&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class ma{constructor(e,n,u,p,g){this.text=new ki(e?e.text:null,n,u,g),this.icon=new ki(e?e.icon:null,n,p,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Os{constructor(e,n,u){this.text=e,this.icon=n,this.skipFade=u}}class al{constructor(e,n,u,p,g){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=u,this.bucketIndex=p,this.tileID=g}}class Bo{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:u=>u.collisionGroupID===n}}return this.collisionGroups[e]}}function go(f,e,n,u,p){let{horizontalAlign:g,verticalAlign:v}=s.aE(f);return new s.P(-(g-.5)*e+u[0]*p,-(v-.5)*n+u[1]*p)}class hd{constructor(e,n,u,p,g){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new ui(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Bo(p),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){let n=this.terrain;return n?(u,p)=>n.getElevation(e,u,p):null}getBucketParts(e,n,u,p){let g=u.getBucket(n),v=u.latestFeatureIndex;if(!g||!v||n.id!==g.layerIds[0])return;let x=u.collisionBoxArray,C=g.layers[0].layout,T=g.layers[0].paint,k=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),R=u.tileSize/s.Z,D=u.tileID.toUnwrapped(),j=C.get("text-rotation-alignment")==="map",U=s.az(u,1,this.transform.zoom),te=s.aA(this.collisionIndex.transform,u,T.get("text-translate"),T.get("text-translate-anchor")),ee=s.aA(this.collisionIndex.transform,u,T.get("icon-translate"),T.get("icon-translate-anchor")),ie=gt(j,this.transform,U);this.retainedQueryData[g.bucketInstanceId]=new al(g.bucketInstanceId,v,g.sourceLayerIndex,g.index,u.tileID);let se={bucket:g,layout:C,translationText:te,translationIcon:ee,unwrappedTileID:D,pitchedLabelPlaneMatrix:ie,scale:k,textPixelRatio:R,holdingForFade:u.holdingForFade(),collisionBoxArray:x,partiallyEvaluatedTextSize:s.ak(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(p)for(let ue of g.sortKeyRanges){let{sortKey:de,symbolInstanceStart:he,symbolInstanceEnd:_e}=ue;e.push({sortKey:de,symbolInstanceStart:he,symbolInstanceEnd:_e,parameters:se})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:se})}attemptAnchorPlacement(e,n,u,p,g,v,x,C,T,k,R,D,j,U,te,ee,ie,se,ue,de){let he=s.aB[e.textAnchor],_e=[e.textOffset0,e.textOffset1],pe=go(he,u,p,_e,g),Se=this.collisionIndex.placeCollisionBox(n,D,C,T,k,x,v,ee,R.predicate,ue,pe,de);if((!se||this.collisionIndex.placeCollisionBox(se,D,C,T,k,x,v,ie,R.predicate,ue,pe,de).placeable)&&Se.placeable){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[j.crossTileID].anchor),j.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:_e,width:u,height:p,anchor:he,textBoxScale:g,prevAnchor:Be},this.markUsedJustification(U,he,j,te),U.allowVerticalPlacement&&(this.markUsedOrientation(U,te,j),this.placedOrientations[j.crossTileID]=te),{shift:pe,placedGlyphBoxes:Se}}}placeLayerBucketPart(e,n,u){let{bucket:p,layout:g,translationText:v,translationIcon:x,unwrappedTileID:C,pitchedLabelPlaneMatrix:T,textPixelRatio:k,holdingForFade:R,collisionBoxArray:D,partiallyEvaluatedTextSize:j,collisionGroup:U}=e.parameters,te=g.get("text-optional"),ee=g.get("icon-optional"),ie=s.aC(g,"text-overlap","text-allow-overlap"),se=ie==="always",ue=s.aC(g,"icon-overlap","icon-allow-overlap"),de=ue==="always",he=g.get("text-rotation-alignment")==="map",_e=g.get("text-pitch-alignment")==="map",pe=g.get("icon-text-fit")!=="none",Se=g.get("symbol-z-order")==="viewport-y",Be=se&&(de||!p.hasIconData()||ee),ke=de&&(se||!p.hasTextData()||te);!p.collisionArrays&&D&&p.deserializeCollisionBoxes(D);let Ae=this.retainedQueryData[p.bucketInstanceId].tileID,Re=this._getTerrainElevationFunc(Ae),Je=this.transform.getFastPathSimpleProjectionMatrix(Ae),Ke=(He,ct,Nt)=>{var ii,qi;if(n[He.crossTileID])return;if(R)return void(this.placements[He.crossTileID]=new Os(!1,!1,!1));let Ei=!1,Xi=!1,Yi=!0,Ai=null,fi={box:null,placeable:!1,offscreen:null,occluded:!1},In={placeable:!1},Nn=null,Yn=null,gi=null,Xs=0,Zo=0,Ys=0;ct.textFeatureIndex?Xs=ct.textFeatureIndex:He.useRuntimeCollisionCircles&&(Xs=He.featureIndex),ct.verticalTextFeatureIndex&&(Zo=ct.verticalTextFeatureIndex);let Ha=ct.textBox;if(Ha){let $r=_n=>{let yn=s.al.horizontal;if(p.allowVerticalPlacement&&!_n&&this.prevPlacement){let br=this.prevPlacement.placedOrientations[He.crossTileID];br&&(this.placedOrientations[He.crossTileID]=br,yn=br,this.markUsedOrientation(p,yn,He))}return yn},Qs=(_n,yn)=>{if(p.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&ct.verticalTextBox){for(let br of p.writingModes)if(br===s.al.vertical?(fi=yn(),In=fi):fi=_n(),fi&&fi.placeable)break}else fi=_n()},vs=He.textAnchorOffsetStartIndex,Js=He.textAnchorOffsetEndIndex;if(Js===vs){let _n=(yn,br)=>{let zi=this.collisionIndex.placeCollisionBox(yn,ie,k,Ae,C,_e,he,v,U.predicate,Re,void 0,Je);return zi&&zi.placeable&&(this.markUsedOrientation(p,br,He),this.placedOrientations[He.crossTileID]=br),zi};Qs(()=>_n(Ha,s.al.horizontal),()=>{let yn=ct.verticalTextBox;return p.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&yn?_n(yn,s.al.vertical):{box:null,offscreen:null}}),$r(fi&&fi.placeable)}else{let _n=s.aB[(qi=(ii=this.prevPlacement)===null||ii===void 0?void 0:ii.variableOffsets[He.crossTileID])===null||qi===void 0?void 0:qi.anchor],yn=(zi,Hd,pm)=>{let mm=zi.x2-zi.x1,Gg=zi.y2-zi.y1,fh=He.textBoxScale,Nc=pe&&ue==="never"?Hd:null,ro=null,Wo=ie==="never"?1:2,oo="never";_n&&Wo++;for(let bs=0;bs<Wo;bs++){for(let Zd=vs;Zd<Js;Zd++){let ea=p.textAnchorOffsets.get(Zd);if(_n&&ea.textAnchor!==_n)continue;let gh=this.attemptAnchorPlacement(ea,zi,mm,Gg,fh,he,_e,k,Ae,C,U,oo,He,p,pm,v,x,Nc,Re);if(gh&&(ro=gh.placedGlyphBoxes,ro&&ro.placeable))return Ei=!0,Ai=gh.shift,ro}_n?_n=null:oo=ie}return u&&!ro&&(ro={box:this.collisionIndex.placeCollisionBox(Ha,"always",k,Ae,C,_e,he,v,U.predicate,Re,void 0,Je).box,offscreen:!1,placeable:!1,occluded:!1}),ro};Qs(()=>yn(Ha,ct.iconBox,s.al.horizontal),()=>{let zi=ct.verticalTextBox;return p.allowVerticalPlacement&&(!fi||!fi.placeable)&&He.numVerticalGlyphVertices>0&&zi?yn(zi,ct.verticalIconBox,s.al.vertical):{box:null,occluded:!0,offscreen:null}}),fi&&(Ei=fi.placeable,Yi=fi.offscreen);let br=$r(fi&&fi.placeable);if(!Ei&&this.prevPlacement){let zi=this.prevPlacement.variableOffsets[He.crossTileID];zi&&(this.variableOffsets[He.crossTileID]=zi,this.markUsedJustification(p,zi.anchor,He,br))}}}if(Nn=fi,Ei=Nn&&Nn.placeable,Yi=Nn&&Nn.offscreen,He.useRuntimeCollisionCircles){let $r=p.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),Qs=s.am(p.textSizeData,j,$r),vs=g.get("text-padding");Yn=this.collisionIndex.placeCollisionCircles(ie,$r,p.lineVertexArray,p.glyphOffsetArray,Qs,C,T,u,_e,U.predicate,He.collisionCircleDiameter,vs,v,Re),Yn.circles.length&&Yn.collisionDetected&&!u&&s.w("Collisions detected, but collision boxes are not shown"),Ei=se||Yn.circles.length>0&&!Yn.collisionDetected,Yi=Yi&&Yn.offscreen}if(ct.iconFeatureIndex&&(Ys=ct.iconFeatureIndex),ct.iconBox){let $r=Qs=>this.collisionIndex.placeCollisionBox(Qs,ue,k,Ae,C,_e,he,x,U.predicate,Re,pe&&Ai?Ai:void 0,Je);In&&In.placeable&&ct.verticalIconBox?(gi=$r(ct.verticalIconBox),Xi=gi.placeable):(gi=$r(ct.iconBox),Xi=gi.placeable),Yi=Yi&&gi.offscreen}let Bc=te||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,Ks=ee||He.numIconVertices===0;Bc||Ks?Ks?Bc||(Xi=Xi&&Ei):Ei=Xi&&Ei:Xi=Ei=Xi&&Ei;let Za=Xi&&gi.placeable;if(Ei&&Nn.placeable&&this.collisionIndex.insertCollisionBox(Nn.box,ie,g.get("text-ignore-placement"),p.bucketInstanceId,In&&In.placeable&&Zo?Zo:Xs,U.ID),Za&&this.collisionIndex.insertCollisionBox(gi.box,ue,g.get("icon-ignore-placement"),p.bucketInstanceId,Ys,U.ID),Yn&&Ei&&this.collisionIndex.insertCollisionCircles(Yn.circles,ie,g.get("text-ignore-placement"),p.bucketInstanceId,Xs,U.ID),u&&this.storeCollisionData(p.bucketInstanceId,Nt,ct,Nn,gi,Yn),He.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new Os((Ei||Be)&&!Nn?.occluded,(Xi||ke)&&!gi?.occluded,Yi||p.justReloaded),n[He.crossTileID]=!0};if(Se){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let He=p.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let ct=He.length-1;ct>=0;--ct){let Nt=He[ct];Ke(p.symbolInstances.get(Nt),p.collisionArrays[Nt],Nt)}}else for(let He=e.symbolInstanceStart;He<e.symbolInstanceEnd;He++)Ke(p.symbolInstances.get(He),p.collisionArrays[He],He);p.justReloaded=!1}storeCollisionData(e,n,u,p,g,v){if(u.textBox||u.iconBox){let x,C;this.collisionBoxArrays.has(e)?x=this.collisionBoxArrays.get(e):(x=new Map,this.collisionBoxArrays.set(e,x)),x.has(n)?C=x.get(n):(C={text:null,icon:null},x.set(n,C)),u.textBox&&(C.text=p.box),u.iconBox&&(C.icon=g.box)}if(v){let x=this.collisionCircleArrays[e];x===void 0&&(x=this.collisionCircleArrays[e]=[]);for(let C=0;C<v.circles.length;C+=4)x.push(v.circles[C+0]-Fi),x.push(v.circles[C+1]-Fi),x.push(v.circles[C+2]),x.push(v.collisionDetected?1:0)}}markUsedJustification(e,n,u,p){let g;g=p===s.al.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[s.aD(n)];let v=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(let x of v)x>=0&&(e.text.placedSymbolArray.get(x).crossTileID=g>=0&&x!==g?0:u.crossTileID)}markUsedOrientation(e,n,u){let p=n===s.al.horizontal||n===s.al.horizontalOnly?n:0,g=n===s.al.vertical?n:0,v=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(let x of v)e.text.placedSymbolArray.get(x).placedOrientation=p;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let n=this.prevPlacement,u=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;let p=n?n.symbolFadeChange(e):1,g=n?n.opacities:{},v=n?n.variableOffsets:{},x=n?n.placedOrientations:{};for(let C in this.placements){let T=this.placements[C],k=g[C];k?(this.opacities[C]=new ma(k,p,T.text,T.icon),u=u||T.text!==k.text.placed||T.icon!==k.icon.placed):(this.opacities[C]=new ma(null,p,T.text,T.icon,T.skipFade),u=u||T.text||T.icon)}for(let C in g){let T=g[C];if(!this.opacities[C]){let k=new ma(T,p,!1,!1);k.isHidden()||(this.opacities[C]=k,u=u||T.text.placed||T.icon.placed)}}for(let C in v)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=v[C]);for(let C in x)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=x[C]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){let u={};for(let p of n){let g=p.getBucket(e);g&&p.latestFeatureIndex&&e.id===g.layerIds[0]&&this.updateBucketOpacities(g,p.tileID,u,p.collisionBoxArray)}}updateBucketOpacities(e,n,u,p){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let g=e.layers[0],v=g.layout,x=new ma(null,0,!1,!1,!0),C=v.get("text-allow-overlap"),T=v.get("icon-allow-overlap"),k=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),R=v.get("text-rotation-alignment")==="map",D=v.get("text-pitch-alignment")==="map",j=v.get("icon-text-fit")!=="none",U=new ma(null,0,C&&(T||!e.hasIconData()||v.get("icon-optional")),T&&(C||!e.hasTextData()||v.get("text-optional")),!0);!e.collisionArrays&&p&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(p);let te=(ie,se,ue)=>{for(let de=0;de<se/4;de++)ie.opacityVertexArray.emplaceBack(ue);ie.hasVisibleVertices=ie.hasVisibleVertices||ue!==as},ee=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ie=0;ie<e.symbolInstances.length;ie++){let se=e.symbolInstances.get(ie),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:de,crossTileID:he}=se,_e=this.opacities[he];u[he]?_e=x:_e||(_e=U,this.opacities[he]=_e),u[he]=!0;let pe=se.numIconVertices>0,Se=this.placedOrientations[se.crossTileID],Be=Se===s.al.vertical,ke=Se===s.al.horizontal||Se===s.al.horizontalOnly;if(ue>0||de>0){let Re=cl(_e.text);te(e.text,ue,Be?as:Re),te(e.text,de,ke?as:Re);let Je=_e.text.isHidden();[se.rightJustifiedTextSymbolIndex,se.centerJustifiedTextSymbolIndex,se.leftJustifiedTextSymbolIndex].forEach(ct=>{ct>=0&&(e.text.placedSymbolArray.get(ct).hidden=Je||Be?1:0)}),se.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(se.verticalPlacedTextSymbolIndex).hidden=Je||ke?1:0);let Ke=this.variableOffsets[se.crossTileID];Ke&&this.markUsedJustification(e,Ke.anchor,se,Se);let He=this.placedOrientations[se.crossTileID];He&&(this.markUsedJustification(e,"left",se,He),this.markUsedOrientation(e,He,se))}if(pe){let Re=cl(_e.icon),Je=!(j&&se.verticalPlacedIconSymbolIndex&&Be);se.placedIconSymbolIndex>=0&&(te(e.icon,se.numIconVertices,Je?Re:as),e.icon.placedSymbolArray.get(se.placedIconSymbolIndex).hidden=_e.icon.isHidden()),se.verticalPlacedIconSymbolIndex>=0&&(te(e.icon,se.numVerticalIconVertices,Je?as:Re),e.icon.placedSymbolArray.get(se.verticalPlacedIconSymbolIndex).hidden=_e.icon.isHidden())}let Ae=ee&&ee.has(ie)?ee.get(ie):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let Re=e.collisionArrays[ie];if(Re){let Je=new s.P(0,0);if(Re.textBox||Re.verticalTextBox){let Ke=!0;if(k){let He=this.variableOffsets[he];He?(Je=go(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),R&&Je._rotate(D?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ke=!1}if(Re.textBox||Re.verticalTextBox){let He;Re.textBox&&(He=Be),Re.verticalTextBox&&(He=ke),ll(e.textCollisionBox.collisionVertexArray,_e.text.placed,!Ke||He,Ae.text,Je.x,Je.y)}}if(Re.iconBox||Re.verticalIconBox){let Ke=!!(!ke&&Re.verticalIconBox),He;Re.iconBox&&(He=Ke),Re.verticalIconBox&&(He=!Ke),ll(e.iconCollisionBox.collisionVertexArray,_e.icon.placed,He,Ae.icon,j?Je.x:0,j?Je.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){let u=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function ll(f,e,n,u,p,g){u&&u.length!==0||(u=[0,0,0,0]);let v=u[0]-Fi,x=u[1]-Fi,C=u[2]-Fi,T=u[3]-Fi;f.emplaceBack(e?1:0,n?1:0,p||0,g||0,v,x),f.emplaceBack(e?1:0,n?1:0,p||0,g||0,C,x),f.emplaceBack(e?1:0,n?1:0,p||0,g||0,C,T),f.emplaceBack(e?1:0,n?1:0,p||0,g||0,v,T)}let pd=Math.pow(2,25),ss=Math.pow(2,24),md=Math.pow(2,17),uc=Math.pow(2,16),fd=Math.pow(2,9),gd=Math.pow(2,8),hc=Math.pow(2,1);function cl(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;let e=f.placed?1:0,n=Math.floor(127*f.opacity);return n*pd+e*ss+n*md+e*uc+n*fd+e*gd+n*hc+e}let as=0;class pc{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,u,p,g){let v=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(v,p,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((x,C)=>x.sortKey-C.sortKey));this._currentPartIndex<v.length;)if(n.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,g())return!0;return!1}}class fa{constructor(e,n,u,p,g,v,x,C){this.placement=new hd(e,n,v,x,C),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(e,n,u){let p=ve.now(),g=()=>!this._forceFullPlacement&&ve.now()-p>2;for(;this._currentPlacementIndex>=0;){let v=n[e[this._currentPlacementIndex]],x=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=x)&&(!v.maxzoom||v.maxzoom>x)){if(this._inProgressLayer||(this._inProgressLayer=new pc(v)),this._inProgressLayer.continuePlacement(u[v.source],this.placement,this._showCollisionBoxes,v,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}let Jr=512/s.Z/2;class Fs{constructor(e,n,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};let p=new Map;for(let g=0;g<n.length;g++){let v=n.get(g),x=v.key,C=p.get(x);C?C.push(v):p.set(x,[v])}for(let[g,v]of p){let x={positions:v.map(C=>({x:Math.floor(C.anchorX*Jr),y:Math.floor(C.anchorY*Jr)})),crossTileIDs:v.map(C=>C.crossTileID)};if(x.positions.length>128){let C=new s.aF(x.positions.length,16,Uint16Array);for(let{x:T,y:k}of x.positions)C.add(T,k);C.finish(),delete x.positions,x.index=C}this._symbolsByKey[g]=x}}getScaledCoordinates(e,n){let{x:u,y:p,z:g}=this.tileID.canonical,{x:v,y:x,z:C}=n.canonical,T=Jr/Math.pow(2,C-g),k=(x*s.Z+e.anchorY)*T,R=p*s.Z*Jr;return{x:Math.floor((v*s.Z+e.anchorX)*T-u*s.Z*Jr),y:Math.floor(k-R)}}findMatches(e,n,u){let p=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let g=0;g<e.length;g++){let v=e.get(g);if(v.crossTileID)continue;let x=this._symbolsByKey[v.key];if(!x)continue;let C=this.getScaledCoordinates(v,n);if(x.index){let T=x.index.range(C.x-p,C.y-p,C.x+p,C.y+p).sort();for(let k of T){let R=x.crossTileIDs[k];if(!u[R]){u[R]=!0,v.crossTileID=R;break}}}else if(x.positions)for(let T=0;T<x.positions.length;T++){let k=x.positions[T],R=x.crossTileIDs[T];if(Math.abs(k.x-C.x)<=p&&Math.abs(k.y-C.y)<=p&&!u[R]){u[R]=!0,v.crossTileID=R;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class _d{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ga{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let n=Math.round((e-this.lng)/360);if(n!==0)for(let u in this.indexes){let p=this.indexes[u],g={};for(let v in p){let x=p[v];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+n),g[x.tileID.key]=x}this.indexes[u]=g}this.lng=e}addBucket(e,n,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let g=0;g<n.symbolInstances.length;g++)n.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let p=this.usedCrossTileIDs[e.overscaledZ];for(let g in this.indexes){let v=this.indexes[g];if(Number(g)>e.overscaledZ)for(let x in v){let C=v[x];C.tileID.isChildOf(e)&&C.findMatches(n.symbolInstances,e,p)}else{let x=v[e.scaledTo(Number(g)).key];x&&x.findMatches(n.symbolInstances,e,p)}}for(let g=0;g<n.symbolInstances.length;g++){let v=n.symbolInstances.get(g);v.crossTileID||(v.crossTileID=u.generate(),p[v.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Fs(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(let u of n.getCrossTileIDsLists())for(let p of u)delete this.usedCrossTileIDs[e][p]}removeStaleBuckets(e){let n=!1;for(let u in this.indexes){let p=this.indexes[u];for(let g in p)e[p[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,p[g]),delete p[g],n=!0)}return n}}class _a{constructor(){this.layerIndexes={},this.crossTileIDs=new _d,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,u){let p=this.layerIndexes[e.id];p===void 0&&(p=this.layerIndexes[e.id]=new ga);let g=!1,v={};p.handleWrapJump(u);for(let x of n){let C=x.getBucket(e);C&&e.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(x.tileID,C,this.crossTileIDs)&&(g=!0),v[C.bucketInstanceId]=!0)}return p.removeStaleBuckets(v)&&(g=!0),g}pruneUnusedLayers(e){let n={};e.forEach(u=>{n[u]=!0});for(let u in this.layerIndexes)n[u]||delete this.layerIndexes[u]}}var mc="void main() {fragColor=vec4(1.0);}";let Wn={prelude:ei(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ei("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ei("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ei(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ei(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ei(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ei(mc,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ei(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ei(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ei("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ei("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ei("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ei(mc,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ei(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ei(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ei(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ei(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ei(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ei(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ei(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ei(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ei(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ei(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ei(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ei(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ei(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ei(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ei(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ei(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ei("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ei("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ei("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ei("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ei(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ei("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ei(f,e){let n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/in ([\w]+) ([\w]+)/g),p=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=g?g.concat(p):p,x={};return{fragmentSource:f=f.replace(n,(C,T,k,R,D)=>(x[D]=!0,T==="define"?`
#ifndef HAS_UNIFORM_u_${D}
in ${k} ${R} ${D};
#else
uniform ${k} ${R} u_${D};
#endif
`:`
#ifdef HAS_UNIFORM_u_${D}
    ${k} ${R} ${D} = u_${D};
#endif
`)),vertexSource:e=e.replace(n,(C,T,k,R,D)=>{let j=R==="float"?"vec2":"vec4",U=D.match(/color/)?"color":j;return x[D]?T==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${k} ${j} a_${D};
out ${k} ${R} ${D};
#else
uniform ${k} ${R} u_${D};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = a_${D};
#else
    ${k} ${R} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${D} = unpack_mix_${U}(a_${D}, u_${D}_t);
#else
    ${k} ${R} ${D} = u_${D};
#endif
`:T==="define"?`
#ifndef HAS_UNIFORM_u_${D}
uniform lowp float u_${D}_t;
in ${k} ${j} a_${D};
#else
uniform ${k} ${R} u_${D};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${D}
    ${k} ${R} ${D} = a_${D};
#else
    ${k} ${R} ${D} = u_${D};
#endif
`:`
#ifndef HAS_UNIFORM_u_${D}
    ${k} ${R} ${D} = unpack_mix_${U}(a_${D}, u_${D}_t);
#else
    ${k} ${R} ${D} = u_${D};
#endif
`}),staticAttributes:u,staticUniforms:v}}class Ls{constructor(e,n,u){this.vertexBuffer=e,this.indexBuffer=n,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ln=s.aG([{name:"a_pos",type:"Int16",components:2}]);let ls="#define PROJECTION_MERCATOR",Zt="mercator";class ya{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Zt}get shaderDefine(){return ls}get shaderPreludeCode(){return Wn.projectionMercator}get vertexShaderPreludeCode(){return Wn.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,u,p,g){if(this._cachedMesh)return this._cachedMesh;let v=new s.aI;v.emplaceBack(0,0),v.emplaceBack(s.Z,0),v.emplaceBack(0,s.Z),v.emplaceBack(s.Z,s.Z);let x=e.createVertexBuffer(v,Ln.members),C=s.aJ.simpleSegment(0,0,4,2),T=new s.aK;T.emplaceBack(1,0,2),T.emplaceBack(1,2,3);let k=e.createIndexBuffer(T);return this._cachedMesh=new Ls(x,k,C),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class va{constructor(e=0,n=0,u=0,p=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(u)||u<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=u,this.right=p}interpolate(e,n,u){return n.top!=null&&e.top!=null&&(this.top=s.B.number(e.top,n.top,u)),n.bottom!=null&&e.bottom!=null&&(this.bottom=s.B.number(e.bottom,n.bottom,u)),n.left!=null&&e.left!=null&&(this.left=s.B.number(e.left,n.left,u)),n.right!=null&&e.right!=null&&(this.right=s.B.number(e.right,n.right,u)),this}getCenter(e,n){let u=s.ae((this.left+e-this.right)/2,0,e),p=s.ae((this.top+n-this.bottom)/2,0,n);return new s.P(u,p)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new va(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Nr(f,e){if(!f.renderWorldCopies||f.lngRange)return;let n=e.lng-f.center.lng;e.lng+=n>180?-360:n<-180?360:0}function qn(f){return Math.max(0,Math.floor(f))}class En{constructor(e,n,u,p,g,v){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=p??0,this._maxPitch=g??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=qn(this._zoom),this._scale=s.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new va,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,u){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=qn(this._zoom),this._scale=s.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new va(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!u&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){let n=s.aL(e,-180,180)*Math.PI/180;var u,p,g,v,x,C,T,k,R;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=q(),u=this._rotationMatrix,g=-this._bearingInRadians,v=(p=this._rotationMatrix)[0],x=p[1],C=p[2],T=p[3],k=Math.sin(g),R=Math.cos(g),u[0]=v*R+C*k,u[1]=x*R+T*k,u[2]=v*-k+C*R,u[3]=x*-k+T*R)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){let n=s.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){let n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aM(this._fovInRadians)}setFov(e){e=s.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=s.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){let n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=s.ac(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,u){this._unmodified=!1,this._edgeInsets.interpolate(e,n,u),this._constrain(),this._calcMatrices()}resize(e,n,u=!0){this._width=e,this._height=n,u&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new xi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,s.af])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let u=e.x,p=e.y,g=e.x,v=e.y;for(let x of n)u=Math.min(u,x.x),p=Math.min(p,x.y),g=Math.max(g,x.x),v=Math.max(v,x.y);return[new s.P(u,p),new s.P(g,p),new s.P(g,v),new s.P(u,v),new s.P(u,p)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:n,zoom:u}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(u),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=s.ad(new Float64Array(16));s.M(e,e,[this._width/2,-this._height/2,1]),s.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=s.ad(new Float64Array(16)),s.M(e,e,[1,-1,1]),s.L(e,e,[-1,-1,0]),s.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,u,p){let g=u!==void 0?u:this.bearing,v=p=p!==void 0?p:this.pitch,x=s.$.fromLngLat(e,n),C=-Math.cos(s.ab(v)),T=Math.sin(s.ab(v)),k=T*Math.sin(s.ab(g)),R=-T*Math.cos(s.ab(g)),D=this.elevation,j=n-D,U;C*j>=0||Math.abs(C)<.1?(U=1e4,D=n+U*C):U=-j/C;let te,ee,ie=s.aN(1,x.y),se=0;do{if(se+=1,se>10)break;ee=U/ie,te=new s.$(x.x+k*ee,x.y+R*ee),ie=1/te.meterInMercatorCoordinateUnits()}while(Math.abs(U-ee*ie)>1e-12);return{center:te.toLngLat(),elevation:D,zoom:s.ah(this.height/2/Math.tan(this.fovInRadians/2)/ee/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;let n=s.ag(1,this.center.lat)*this.worldSize,u=this.cameraToCenterDistance/n,p=s.$.fromLngLat(this.center,this.elevation),g=Z(this.center,this.elevation,this.pitch,this.bearing,u);this._elevation=e;let v=this.calculateCenterFromCameraLngLatAlt(g.toLngLat(),s.aN(g.z,p.y),this.bearing,this.pitch);this._elevation=v.elevation,this._center=v.center,this.setZoom(v.zoom)}getCameraPoint(){let e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){let e=s.ag(1,this.center.lat)*this.worldSize;return Z(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];let n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/s.Z,1/n/s.Z]}}class $i{constructor(e,n){this.min=e,this.max=n,this.center=s.aO([],s.aP([],this.min,this.max),.5)}quadrant(e){let n=[e%2==0,e<2],u=s.aQ(this.min),p=s.aQ(this.max);for(let g=0;g<n.length;g++)u[g]=n[g]?this.min[g]:this.center[g],p[g]=n[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new $i(u,p)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let u=0;u<e.planes.length;u++){let p=this.intersectsPlane(e.planes[u]);if(p===0)return 0;p===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],u=e[3];for(let p=0;p<3;p++)e[p]>0?(n+=e[p]*this.min[p],u+=e[p]*this.max[p]):(u+=e[p]*this.min[p],n+=e[p]*this.max[p]);return n>=0?2:u<0?0:1}}class pn{distanceToTile2d(e,n,u,p){let g=p.distanceX([e,n]),v=p.distanceY([e,n]);return Math.hypot(g,v)}getWrap(e,n,u){return u}getTileAABB(e,n,u,p){var g,v;let x=u,C=u;if(p.terrain){let k=new s.Y(e.z,n,e.z,e.x,e.y),R=p.terrain.getMinMaxElevation(k);x=(g=R.minElevation)!==null&&g!==void 0?g:u,C=(v=R.maxElevation)!==null&&v!==void 0?v:u}let T=1<<e.z;return new $i([n+e.x/T,e.y/T,x],[n+(e.x+1)/T,(e.y+1)/T,C])}allowVariableZoom(e,n){let u=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,p=s.ae(78.5-u/2,0,60);return!!n.terrain||e.pitch>p}allowWorldCopies(){return!0}recalculateCache(){}}class Pi{constructor(e,n,u){this.points=e,this.planes=n,this.aabb=u}static fromInvProjectionMatrix(e,n=1,u=0){let p=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{let k=1/(T=s.at([],T,e))[3]/n*p;return s.aR(T,T,[k,k,1/T[3],k])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{let k=s.aS([],g[T[0]],g[T[1]]),R=s.aS([],g[T[2]],g[T[1]]),D=s.aT([],s.aU([],k,R)),j=-s.aV(D,g[T[1]]);return D.concat(j)}),x=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],C=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let T of g)for(let k=0;k<3;k++)x[k]=Math.min(x[k],T[k]),C[k]=Math.max(C[k],T[k]);return new Pi(g,v,new $i(x,C))}}class zs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,u){return this._helper.interpolatePadding(e,n,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,u=!0){this._helper.resize(e,n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,u,p,g){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new En({calcMatrices:()=>{this._calcMatrices()},getConstrained:(v,x)=>this.getConstrained(v,x)},e,n,u,p,g),this._coveringTilesDetailsProvider=new pn}clone(){let e=new zs;return e.apply(this),e}apply(e,n,u){this._helper.apply(e,n,u)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){let n=[new s.aW(0,e)];if(this._helper._renderWorldCopies){let u=this.screenPointToMercatorCoordinate(new s.P(0,0)),p=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),g=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),v=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),x=Math.floor(Math.min(u.x,p.x,g.x,v.x)),C=Math.floor(Math.max(u.x,p.x,g.x,v.x)),T=1;for(let k=x-T;k<=C+T;k++)k!==0&&n.push(new s.aW(k,e))}return n}getCameraFrustum(){return Pi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){let n=this.screenPointToLocation(this.centerPoint,e),u=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(u)}setLocationAtPoint(e,n){let u=s.ag(this.elevation,this.center.lat),p=this.screenPointToMercatorCoordinateAtZ(n,u),g=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,u),v=s.$.fromLngLat(e),x=new s.$(v.x-(p.x-g.x),v.y-(p.y-g.y));this.setCenter(x?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(s.$.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.$.fromLngLat(e))}screenPointToLocation(e,n){var u;return(u=this.screenPointToMercatorCoordinate(e,n))===null||u===void 0?void 0:u.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){let u=n.pointCoordinate(e);if(u!=null)return u}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){let u=n||0,p=[e.x,e.y,0,1],g=[e.x,e.y,1,1];s.at(p,p,this._pixelMatrixInverse),s.at(g,g,this._pixelMatrixInverse);let v=p[3],x=g[3],C=p[1]/v,T=g[1]/x,k=p[2]/v,R=g[2]/x,D=k===R?0:(u-k)/(R-k);return new s.$(s.B.number(p[0]/v,g[0]/x,D)/this.worldSize,s.B.number(C,T,D)/this.worldSize,u)}coordinatePoint(e,n=0,u=this._pixelMatrix){let p=[e.x*this.worldSize,e.y*this.worldSize,n,1];return s.at(p,p,u),new s.P(p[0]/p[3],p[1]/p[3])}getBounds(){let e=Math.max(0,this._helper._height/2-xe(this));return new xi().extend(this.screenPointToLocation(new s.P(0,e))).extend(this.screenPointToLocation(new s.P(this._helper._width,e))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-xe(this)}calculatePosMatrix(e,n=!1,u){var p;let g=(p=e.key)!==null&&p!==void 0?p:s.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),v=n?this._alignedPosMatrixCache:this._posMatrixCache;if(v.has(g)){let T=v.get(g);return u?T.f32:T.f64}let x=H(e,this.worldSize);s.N(x,n?this._alignedProjMatrix:this._viewProjMatrix,x);let C={f64:x,f32:new Float32Array(x)};return v.set(g,C),u?C.f32:C.f64}calculateFogMatrix(e){let n=e.key,u=this._fogMatrixCacheF32;if(u.has(n))return u.get(n);let p=H(e,this.worldSize);return s.N(p,this._fogMatrix,p),u.set(n,new Float32Array(p)),u.get(n)}getConstrained(e,n){n=s.ae(+n,this.minZoom,this.maxZoom);let u={center:new s.Q(e.lng,e.lat),zoom:n},p=this._helper._lngRange;this._helper._renderWorldCopies||p!==null||(p=[-179.9999999999,180-1e-10]);let g=this.tileSize*s.ac(u.zoom),v=0,x=g,C=0,T=g,k=0,R=0,{x:D,y:j}=this.size;if(this._helper._latRange){let ue=this._helper._latRange;v=s.S(ue[1])*g,x=s.S(ue[0])*g,x-v<j&&(k=j/(x-v))}p&&(C=s.aL(s.U(p[0])*g,0,g),T=s.aL(s.U(p[1])*g,0,g),T<C&&(T+=g),T-C<D&&(R=D/(T-C)));let{x:U,y:te}=or(g,e),ee,ie,se=Math.max(R||0,k||0);if(se){let ue=new s.P(R?(T+C)/2:U,k?(x+v)/2:te);return u.center=Tr(g,ue).wrap(),u.zoom+=s.ah(se),u}if(this._helper._latRange){let ue=j/2;te-ue<v&&(ie=v+ue),te+ue>x&&(ie=x-ue)}if(p){let ue=(C+T)/2,de=U;this._helper._renderWorldCopies&&(de=s.aL(U,ue-g/2,ue+g/2));let he=D/2;de-he<C&&(ee=C+he),de+he>T&&(ee=T-he)}if(ee!==void 0||ie!==void 0){let ue=new s.P(ee??U,ie??te);u.center=Tr(g,ue).wrap()}return u}calculateCenterFromCameraLngLatAlt(e,n,u,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,u,p)}_calculateNearFarZIfNeeded(e,n,u){if(!this._helper.autoCalculateNearFarZ)return;let p=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),g=e-p*this._helper._pixelPerMeter/Math.cos(n),v=p<0?g:e,x=Math.PI/2+this.pitchInRadians,C=s.ab(this.fov)*(Math.abs(Math.cos(s.ab(this.roll)))*this.height+Math.abs(Math.sin(s.ab(this.roll)))*this.width)/this.height*(.5+u.y/this.height),T=Math.sin(C)*v/Math.sin(s.ae(Math.PI-x-C,.01,Math.PI-.01)),k=xe(this),R=Math.atan(k/this._helper.cameraToCenterDistance),D=s.ab(.75),j=R>D?2*R*(.5+u.y/(2*k)):D,U=Math.sin(j)*v/Math.sin(s.ae(Math.PI-x-j,.01,Math.PI-.01)),te=Math.min(T,U);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*te+v),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;let e=this.centerOffset,n=or(this.worldSize,this.center),u=n.x,p=n.y;this._helper._pixelPerMeter=s.ag(1,this.center.lat)*this.worldSize;let g=s.ab(Math.min(this.pitch,Ii)),v=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(g)),x;this._calculateNearFarZIfNeeded(v,g,e),x=new Float64Array(16),s.aY(x,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.an(this._invProjMatrix,x),x[8]=2*-e.x/this._helper._width,x[9]=2*e.y/this._helper._height,this._projectionMatrix=s.aZ(x),s.M(x,x,[1,-1,1]),s.L(x,x,[0,0,-this._helper.cameraToCenterDistance]),s.a_(x,x,-this.rollInRadians),s.a$(x,x,this.pitchInRadians),s.a_(x,x,-this.bearingInRadians),s.L(x,x,[-u,-p,0]),this._mercatorMatrix=s.M([],x,[this.worldSize,this.worldSize,this.worldSize]),s.M(x,x,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x),s.L(x,x,[0,0,-this.elevation]),this._viewProjMatrix=x,this._invViewProjMatrix=s.an([],x);let C=[0,0,-1,1];s.at(C,C,this._invViewProjMatrix),this._cameraPosition=[C[0]/C[3],C[1]/C[3],C[2]/C[3]],this._fogMatrix=new Float64Array(16),s.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,v,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,s.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.L(this._fogMatrix,this._fogMatrix,[-u,-p,0]),s.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x);let T=this._helper._width%2/2,k=this._helper._height%2/2,R=Math.cos(this.bearingInRadians),D=Math.sin(-this.bearingInRadians),j=u-Math.round(u)+R*T+D*k,U=p-Math.round(p)+R*k+D*T,te=new Float64Array(x);if(s.L(te,te,[j>.5?j-1:j,U>.5?U-1:U,0]),this._alignedProjMatrix=te,x=s.an(new Float64Array(16),this._pixelMatrix),!x)throw new Error("failed to invert matrix");this._pixelMatrixInverse=x,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;let e=this.screenPointToMercatorCoordinate(new s.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return s.at(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){let e=s.ag(1,this.center.lat)*this.worldSize;return Z(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){let u=s.$.fromLngLat(e),p=[u.x*this.worldSize,u.y*this.worldSize,n,1];return s.at(p,p,this._viewProjMatrix),p[2]/p[3]}getProjectionData(e){let{overscaledTileID:n,aligned:u,applyTerrainMatrix:p}=e,g=this._helper.getMercatorTileCoordinates(n),v=n?this.calculatePosMatrix(n,u,!0):null,x;return x=n&&n.terrainRttPosMatrix32f&&p?n.terrainRttPosMatrix32f:v||s.b0(),{mainMatrix:x,tileMercatorCoords:g,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:x}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,u){return 1}transformLightDirection(e){return s.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,u,p){let g=this.calculatePosMatrix(u),v;p?(v=[e,n,p(e,n),1],s.at(v,v,g)):(v=[e,n,0,1],zo(v,v,g));let x=v[3];return{point:new s.P(v[0]/x,v[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}populateCache(e){for(let n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){let u=s.$.fromLngLat(e,n),p=u.meterInMercatorCoordinateUnits(),g=s.b1();return s.L(g,g,[u.x,u.y,u.z]),s.a_(g,g,Math.PI),s.a$(g,g,Math.PI/2),s.M(g,g,[-p,p,p]),g}getProjectionDataForCustomLayer(e=!0){let n=new s.Y(0,0,0,0,0),u=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),p=H(n,this.worldSize);s.N(p,this._viewProjMatrix,p),u.tileMercatorCoords=[0,0,1,1];let g=[s.Z,s.Z,this.worldSize/this._helper.pixelsPerMeter],v=s.b2();return s.M(v,p,g),u.fallbackMatrix=v,u.mainMatrix=v,u}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Xn(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function yr(f){if(f.useSlerp)if(f.k<1){let e=s.b3(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),n=s.b3(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),u=new Float64Array(4);s.b4(u,e,n,f.k);let p=s.b5(u);f.tr.setRoll(p.roll),f.tr.setPitch(p.pitch),f.tr.setBearing(p.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(s.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(s.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(s.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function ar(f,e,n,u,p){let g=p.padding,v=or(p.worldSize,n.getNorthWest()),x=or(p.worldSize,n.getNorthEast()),C=or(p.worldSize,n.getSouthEast()),T=or(p.worldSize,n.getSouthWest()),k=s.ab(-u),R=v.rotate(k),D=x.rotate(k),j=C.rotate(k),U=T.rotate(k),te=new s.P(Math.max(R.x,D.x,U.x,j.x),Math.max(R.y,D.y,U.y,j.y)),ee=new s.P(Math.min(R.x,D.x,U.x,j.x),Math.min(R.y,D.y,U.y,j.y)),ie=te.sub(ee),se=(p.width-(g.left+g.right+e.left+e.right))/ie.x,ue=(p.height-(g.top+g.bottom+e.top+e.bottom))/ie.y;if(ue<0||se<0)return void Xn();let de=Math.min(s.ah(p.scale*Math.min(se,ue)),f.maxZoom),he=s.P.convert(f.offset),_e=new s.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(s.ab(u)),pe=he.add(_e).mult(p.scale/s.ac(de));return{center:Tr(p.worldSize,v.add(C).div(2).sub(pe)),zoom:de,bearing:u}}class ba{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,u){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(u,e.around)}cameraForBoxAndBearing(e,n,u,p,g){return ar(e,n,u,p,g)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(s.Q.convert(n.center))}handleEaseTo(e,n){let u=e.zoom,p=e.padding,g={roll:e.roll,pitch:e.pitch,bearing:e.bearing},v={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},x=n.zoom!==void 0,C=!e.isPaddingEqual(n.padding),T=!1,k=x?+n.zoom:e.zoom,R=e.centerPoint.add(n.offsetAsPoint),D=e.screenPointToLocation(R),{center:j,zoom:U}=e.getConstrained(s.Q.convert(n.center||D),k??u);Nr(e,j);let te=or(e.worldSize,D),ee=or(e.worldSize,j).sub(te),ie=s.ac(U-u);return T=U!==u,{easeFunc:se=>{if(T&&e.setZoom(s.B.number(u,U,se)),s.b6(g,v)||yr({startEulerAngles:g,endEulerAngles:v,tr:e,k:se,useSlerp:g.roll!=v.roll}),C&&(e.interpolatePadding(p,n.padding,se),R=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{let ue=s.ac(e.zoom-u),de=U>u?Math.min(2,ie):Math.max(.5,ie),he=Math.pow(de,1-se),_e=Tr(e.worldSize,te.add(ee.mult(se*he)).mult(ue));e.setLocationAtPoint(e.renderWorldCopies?_e.wrap():_e,R)}},isZooming:T,elevationCenter:j}}handleFlyTo(e,n){let u=n.zoom!==void 0,p=e.zoom,g=e.getConstrained(s.Q.convert(n.center||n.locationAtOffset),u?+n.zoom:p),v=g.center,x=g.zoom;Nr(e,v);let C=or(e.worldSize,n.locationAtOffset),T=or(e.worldSize,v).sub(C),k=T.mag(),R=s.ac(x-p),D;if(n.minZoom!==void 0){let j=Math.min(+n.minZoom,p,x),U=e.getConstrained(v,j).zoom;D=s.ac(U-p)}return{easeFunc:(j,U,te,ee)=>{e.setZoom(j===1?x:p+s.ah(U));let ie=j===1?v:Tr(e.worldSize,C.add(T.mult(te)).mult(U));e.setLocationAtPoint(e.renderWorldCopies?ie.wrap():ie,ee)},scaleOfZoom:R,targetCenter:v,scaleOfMinZoom:D,pixelPathLength:k}}}class ci{constructor(e,n,u){this.blendFunction=e,this.blendColor=n,this.mask=u}}ci.Replace=[1,0],ci.disabled=new ci(ci.Replace,s.b7.transparent,[!1,!1,!1,!1]),ci.unblended=new ci(ci.Replace,s.b7.transparent,[!0,!0,!0,!0]),ci.alphaBlended=new ci([1,771],s.b7.transparent,[!0,!0,!0,!0]);let Gi=2305;class Wt{constructor(e,n,u){this.enable=e,this.mode=n,this.frontFace=u}}Wt.disabled=new Wt(!1,1029,Gi),Wt.backCCW=new Wt(!0,1029,Gi),Wt.frontCCW=new Wt(!0,1028,Gi);class Et{constructor(e,n,u){this.func=e,this.mask=n,this.range=u}}Et.ReadOnly=!1,Et.ReadWrite=!0,Et.disabled=new Et(519,Et.ReadOnly,[0,1]);let Bs=7680;class Bt{constructor(e,n,u,p,g,v){this.test=e,this.ref=n,this.mask=u,this.fail=p,this.depthFail=g,this.pass=v}}Bt.disabled=new Bt({func:519,mask:0},0,0,Bs,Bs,Bs);let dl=new WeakMap;function zn(f){var e;if(dl.has(f))return dl.get(f);{let n=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return dl.set(f,n),n}}class fc{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;let n=e.context,u=n.gl;this._texFormat=u.RGBA,this._texType=u.UNSIGNED_BYTE;let p=new s.aI;p.emplaceBack(-1,-1),p.emplaceBack(2,-1),p.emplaceBack(-1,2);let g=new s.aK;g.emplaceBack(0,1,2),this._fullscreenTriangle=new Ls(n.createVertexBuffer(p,Ln.members),n.createIndexBuffer(g),s.aJ.simpleSegment(0,0,p.length,g.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(u.TEXTURE1);let v=u.createTexture();u.bindTexture(u.TEXTURE_2D,v),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texImage2D(u.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(v),zn(u)&&(this._pbo=u.createBuffer(),u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.bufferData(u.PIXEL_PACK_BUFFER,4,u.STREAM_READ),u.bindBuffer(u.PIXEL_PACK_BUFFER,null))}destroy(){let e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){let u=this._updateCount;return this._readbackQueue?u>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():u>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){let e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){let u=this._cachedRenderContext.context,p=u.gl;if(this._bindFramebuffer(),u.viewport.set([0,0,this._texWidth,this._texHeight]),u.clear({color:s.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(u,p.TRIANGLES,Et.disabled,Bt.disabled,ci.unblended,Wt.disabled,((g,v)=>({u_input:g,u_output_expected:v}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&zn(p)){p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.readBuffer(p.COLOR_ATTACHMENT0),p.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),p.bindBuffer(p.PIXEL_PACK_BUFFER,null);let g=p.fenceSync(p.SYNC_GPU_COMMANDS_COMPLETE,0);p.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:g}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){let e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&zn(e)){let n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=fc._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}let gc=s.Z/128;function xa(f,e){let n=f.granularity!==void 0?Math.max(f.granularity,1):1,u=n+(f.generateBorders?2:0),p=n+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),g=u+1,v=p+1,x=f.generateBorders?-1:0,C=f.generateBorders||f.extendToNorthPole?-1:0,T=n+(f.generateBorders?1:0),k=n+(f.generateBorders||f.extendToSouthPole?1:0),R=g*v,D=u*p*6,j=g*v>65536;if(j&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");let U=j||e==="32bit",te=new Int16Array(2*R),ee=0;for(let ue=C;ue<=k;ue++)for(let de=x;de<=T;de++){let he=de/n*s.Z;de===-1&&(he=-64),de===n+1&&(he=s.Z+gc);let _e=ue/n*s.Z;ue===-1&&(_e=f.extendToNorthPole?s.b9:-64),ue===n+1&&(_e=f.extendToSouthPole?s.ba:s.Z+gc),te[ee++]=he,te[ee++]=_e}let ie=U?new Uint32Array(D):new Uint16Array(D),se=0;for(let ue=0;ue<p;ue++)for(let de=0;de<u;de++){let he=de+1+ue*g,_e=de+(ue+1)*g,pe=de+1+(ue+1)*g;ie[se++]=de+ue*g,ie[se++]=_e,ie[se++]=he,ie[se++]=he,ie[se++]=_e,ie[se++]=pe}return{vertices:te.buffer.slice(0),indices:ie.buffer.slice(0),uses32bitIndices:U}}let Vr=new s.aH({fill:new s.bb(128,2),line:new s.bb(512,0),tile:new s.bb(128,32),stencil:new s.bb(128,1),circle:3});class wa{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Wn.projectionGlobe}get vertexShaderPreludeCode(){return Wn.projectionMercator.vertexSource}get subdivisionGranularity(){return Vr}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new fc(e));let n=s.S(this._errorQueryLatitudeDegrees),u=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,p=this._errorMeasurement.updateErrorLoop(n,u),g=ve.now();p!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=p,this._errorMeasurementLastChangeTime=g);let v=Math.min(Math.max((g-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bd(v))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,u,p,g){let v=(g==="stencil"?Vr.stencil:Vr.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:v,generateBorders:u,extendToNorthPole:n.y===0&&p,extendToSouthPole:n.y===(1<<n.z)-1&&p})}_getMesh(e,n){let u=this._getMeshKey(n);if(u in this._tileMeshCache)return this._tileMeshCache[u];let p=function(g,v){let x=xa(v,"16bit"),C=s.aI.deserialize({arrayBuffer:x.vertices,length:x.vertices.byteLength/2/2}),T=s.aK.deserialize({arrayBuffer:x.indices,length:x.indices.byteLength/2/3});return new Ls(g.createVertexBuffer(C,Ln.members),g.createIndexBuffer(T),s.aJ.simpleSegment(0,0,C.length,T.length))}(e,n);return this._tileMeshCache[u]=p,p}recalculate(e){}hasTransition(){let e=ve.now(),n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}let _c=new s.r({type:new s.D(s.v.projection.type)});class Ca extends s.E{constructor(e){super(),this._transitionable=new s.T(_c),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.C(0)),this._mercatorProjection=new ya,this._verticalPerspectiveProjection=new wa}get transitionState(){let e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof s.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,u,p,g){return this.currentProjection.getMeshFromTileID(e,n,u,p,g)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Ma(f){let e=No(f.worldSize,f.center.lat);return 2*Math.PI*e}function lr(f,e,n,u,p){let g=1/(1<<p),v=e/s.Z*g+u*g,x=s.bg((f/s.Z*g+n*g)*Math.PI*2+Math.PI,2*Math.PI),C=2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI,T=Math.cos(C),k=new Float64Array(3);return k[0]=Math.sin(x)*T,k[1]=Math.sin(C),k[2]=Math.cos(x)*T,k}function mn(f){return function(e,n){let u=Math.cos(n),p=new Float64Array(3);return p[0]=Math.sin(e)*u,p[1]=Math.sin(n),p[2]=Math.cos(e)*u,p}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function No(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function _o(f){let e=Math.asin(f[1])/Math.PI*180,n=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(n>1e-6){let u=f[0]/n,p=Math.acos(f[2]/n),g=(u>0?p:-p)/Math.PI*180;return new s.Q(s.aL(g,-180,180),e)}return new s.Q(0,e)}function Vo(f){return Math.cos(f*Math.PI/180)}function fn(f,e){let n=Vo(f),u=Vo(e);return s.ah(u/n)}function ul(f,e){let n=f.rotate(e.bearingInRadians),u=e.zoom+fn(e.center.lat,0),p=s.bc(1/Vo(e.center.lat),1/Vo(Math.min(Math.abs(e.center.lat),60)),s.bf(u,7,3,0,1)),g=360/Ma({worldSize:e.worldSize,center:{lat:e.center.lat}});return new s.Q(e.center.lng-n.x*g*p,s.ae(e.center.lat+n.y*g,-85.051129,s.af))}function Sa(f){let e=.5*f,n=Math.sin(e),u=Math.cos(e);return Math.log(n+u)-Math.log(u-n)}function cs(f,e,n,u){let p=f.lat+n*u;if(Math.abs(n)>1){let g=(Math.sign(f.lat+n)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,v=Math.abs(f.lat+n)*Math.PI/180,x=Sa(g+u*(v-g)),C=Sa(g),T=Sa(v);return new s.Q(f.lng+e*((x-C)/(T-C)),p)}return new s.Q(f.lng+e*u,p)}class Nu{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;let e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,u,p){let g=`${e.z}_${e.x}_${e.y}`,v=this._cache.get(g);if(v)return v;let x=this._cachePrevious.get(g);if(x)return this._cache.set(g,x),x;let C=this._aabbFactory(e,n,u,p);return this._cache.set(g,C),this._hadAnyChanges=!0,C}}function Bn(f,e,n){let u=f-e;return u<0?-u:Math.max(0,u-n)}function Pa(f,e,n,u,p){let g=f-n,v;return v=g<0?Math.min(-g,1+g-p):g>1?Math.min(Math.max(g-p,0),1-g):0,Math.max(v,Bn(e,u,p))}class eo{constructor(){this._aabbCache=new Nu(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,u,p){let g=1<<u.z,v=1/g,x=u.x/g,C=u.y/g,T=2;return T=Math.min(T,Pa(e,n,x,C,v)),T=Math.min(T,Pa(e,n,x+.5,-C-v,v)),T=Math.min(T,Pa(e,n,x+.5,2-C-v,v)),T}getWrap(e,n,u){let p=1<<n.z,g=1/p,v=n.x/p,x=Bn(e.x,v,g),C=Bn(e.x,v-1,g),T=Bn(e.x,v+1,g),k=Math.min(x,C,T);return k===T?1:k===C?-1:0}allowVariableZoom(e,n){return Me(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,u,p){return this._aabbCache.getTileAABB(e,n,u,p)}_computeTileAABB(e,n,u,p){if(e.z<=0)return new $i([-1,-1,-1],[1,1,1]);if(e.z===1)return new $i([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{let g=[lr(0,0,e.x,e.y,e.z),lr(s.Z,0,e.x,e.y,e.z),lr(s.Z,s.Z,e.x,e.y,e.z),lr(0,s.Z,e.x,e.y,e.z)],v=[1,1,1],x=[-1,-1,-1];for(let C of g)for(let T=0;T<3;T++)v[T]=Math.min(v[T],C[T]),x[T]=Math.max(x[T],C[T]);if(e.y===0||e.y===(1<<e.z)-1){let C=[0,e.y===0?1:-1,0];for(let T=0;T<3;T++)v[T]=Math.min(v[T],C[T]),x[T]=Math.max(x[T],C[T])}return new $i(v,x)}}}class ds{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,u){return this._helper.interpolatePadding(e,n,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=s.bk(),this._projectionMatrix=s.b1(),this._globeViewProjMatrix32f=s.b0(),this._globeViewProjMatrixNoCorrection=s.b1(),this._globeViewProjMatrixNoCorrectionInverted=s.b1(),this._globeProjMatrixInverted=s.b1(),this._cameraPosition=s.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new En({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new eo}clone(){let e=new ds;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){let e=s.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){let{overscaledTileID:n,applyGlobeMatrix:u}=e,p=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:p,clippingPlane:this._cachedClippingPlane,projectionTransition:u?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){let n=this.pitchInRadians,u=this.cameraToCenterDistance/e,p=Math.sin(n)*u,g=Math.cos(n)*u+1,v=1/Math.sqrt(p*p+g*g)*1,x=-p,C=g,T=Math.sqrt(x*x+C*C);x/=T,C/=T;let k=[0,x,C];s.bl(k,k,[0,0,0],-this.bearingInRadians),s.bm(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),s.bn(k,k,[0,0,0],this.center.lng*Math.PI/180);let R=1/s.bo(k);return s.aO(k,k,R),[...k,-v*R]}isLocationOccluded(e){return!this.isSurfacePointVisible(mn(e))}transformLightDirection(e){let n=this._helper._center.lng*Math.PI/180,u=this._helper._center.lat*Math.PI/180,p=Math.cos(u),g=[Math.sin(n)*p,Math.sin(u),Math.cos(n)*p],v=[g[2],0,-g[0]],x=[0,0,0];s.aU(x,v,g),s.aT(v,v),s.aT(x,x);let C=[0,0,0];return s.aT(C,[v[0]*e[0]+x[0]*e[1]+g[0]*e[2],v[1]*e[0]+x[1]*e[1]+g[1]*e[2],v[2]*e[0]+x[2]*e[1]+g[2]*e[2]]),C}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,u){let p=function(x,C,T){let k=1/(1<<T.z);return new s.$(x/s.Z*k+T.x*k,C/s.Z*k+T.y*k)}(e,n,u.canonical),g=(v=p.y,[s.bg(p.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI]);var v;return this.getCircleRadiusCorrection()/Math.cos(g[1])}projectTileCoordinates(e,n,u,p){let g=u.canonical,v=lr(e,n,g.x,g.y,g.z),x=1+(p?p(e,n):0)/s.bu,C=[v[0]*x,v[1]*x,v[2]*x,1];s.at(C,C,this._globeViewProjMatrixNoCorrection);let T=this._cachedClippingPlane,k=T[0]*v[0]+T[1]*v[1]+T[2]*v[2]+T[3]<0;return{point:new s.P(C[0]/C[3],C[1]/C[3]),signedDistanceFromCamera:C[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;let e=No(this.worldSize,this.center.lat),n=s.b2(),u=s.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),s.aY(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);let p=this.centerOffset;n[8]=2*-p.x/this._helper._width,n[9]=2*p.y/this._helper._height,this._projectionMatrix=s.aZ(n),this._globeProjMatrixInverted=s.b2(),s.an(this._globeProjMatrixInverted,n),s.L(n,n,[0,0,-this.cameraToCenterDistance]),s.a_(n,n,this.rollInRadians),s.a$(n,n,-this.pitchInRadians),s.a_(n,n,this.bearingInRadians),s.L(n,n,[0,0,-e]);let g=s.bh();g[0]=e,g[1]=e,g[2]=e,s.a$(u,n,this.center.lat*Math.PI/180),s.bp(u,u,-this.center.lng*Math.PI/180),s.M(u,u,g),this._globeViewProjMatrixNoCorrection=u,s.a$(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.bp(n,n,-this.center.lng*Math.PI/180),s.M(n,n,g),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=s.b2(),s.an(this._globeViewProjMatrixNoCorrectionInverted,u);let v=s.bh();this._cameraPosition=s.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,s.bl(this._cameraPosition,this._cameraPosition,v,-this.rollInRadians),s.bm(this._cameraPosition,this._cameraPosition,v,this.pitchInRadians),s.bl(this._cameraPosition,this._cameraPosition,v,-this.bearingInRadians),s.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bm(this._cameraPosition,this._cameraPosition,v,-this.center.lat*Math.PI/180),s.bn(this._cameraPosition,this._cameraPosition,v,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);let x=s.aZ(this._globeViewProjMatrixNoCorrectionInverted);s.M(x,x,[1,1,-1]),this._cachedFrustum=Pi.fromInvProjectionMatrix(x)}calculateFogMatrix(e){s.w("calculateFogMatrix is not supported on globe projection.");let n=s.b2();return s.ad(n),n}getVisibleUnwrappedCoordinates(e){return[new s.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;let u=mn(e);s.aO(u,u,1+n/s.bu);let p=s.bk();return s.at(p,[u[0],u[1],u[2],1],this._globeViewProjMatrixNoCorrection),p[2]/p[3]}populateCache(e){}getBounds(){let e=.5*this.width,n=.5*this.height,u=[new s.P(0,0),new s.P(e,0),new s.P(this.width,0),new s.P(this.width,n),new s.P(this.width,this.height),new s.P(e,this.height),new s.P(0,this.height),new s.P(0,n)],p=[];for(let R of u)p.push(this.unprojectScreenPoint(R));let g=0,v=0,x=0,C=0,T=this.center;for(let R of p){let D=s.bq(T.lng,R.lng),j=s.bq(T.lat,R.lat);D<v&&(v=D),D>g&&(g=D),j<C&&(C=j),j>x&&(x=j)}let k=[T.lng+v,T.lat+C,T.lng+g,T.lat+x];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new xi(k)}getConstrained(e,n){let u=s.ae(e.lat,-85.051129,s.af),p=s.ae(+n,this.minZoom+fn(0,u),this.maxZoom);return{center:new s.Q(e.lng,u),zoom:p}}calculateCenterFromCameraLngLatAlt(e,n,u,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,u,p)}setLocationAtPoint(e,n){let u=mn(this.unprojectScreenPoint(n)),p=mn(e),g=s.bh();s.br(g);let v=s.bh();s.bn(v,u,g,-this.center.lng*Math.PI/180),s.bm(v,v,g,this.center.lat*Math.PI/180);let x=p[0]*p[0]+p[2]*p[2],C=v[0]*v[0];if(x<C)return;let T=Math.sqrt(x-C),k=-T,R=s.bs(p[0],p[2],v[0],T),D=s.bs(p[0],p[2],v[0],k),j=s.bh();s.bn(j,p,g,-R);let U=s.bs(j[1],j[2],v[1],v[2]),te=s.bh();s.bn(te,p,g,-D);let ee=s.bs(te[1],te[2],v[1],v[2]),ie=.5*Math.PI,se=U>=-ie&&U<=ie,ue=ee>=-ie&&ee<=ie,de,he;if(se&&ue){let Be=this.center.lng*Math.PI/180,ke=this.center.lat*Math.PI/180;s.bv(R,Be)+s.bv(U,ke)<s.bv(D,Be)+s.bv(ee,ke)?(de=R,he=U):(de=D,he=ee)}else if(se)de=R,he=U;else{if(!ue)return;de=D,he=ee}let _e=de/Math.PI*180,pe=he/Math.PI*180,Se=this.center.lat;this.setCenter(new s.Q(_e,s.ae(pe,-90,90))),this.setZoom(this.zoom+fn(Se,this.center.lat))}locationToScreenPoint(e,n){let u=mn(e);if(n){let p=n.getElevationForLngLatZoom(e,this._helper._tileZoom);s.aO(u,u,1+p/s.bu)}return this._projectSurfacePointToScreen(u)}_projectSurfacePointToScreen(e){let n=s.bk();return s.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new s.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){let u=n.pointCoordinate(e);if(u)return u}return s.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var u;return(u=this.screenPointToMercatorCoordinate(e,n))===null||u===void 0?void 0:u.toLngLat()}isPointOnMapSurface(e,n){let u=this._cameraPosition,p=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(u,p)}getRayDirectionFromPixel(e){let n=s.bk();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,s.at(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];let u=s.bh();u[0]=n[0]-this._cameraPosition[0],u[1]=n[1]-this._cameraPosition[1],u[2]=n[2]-this._cameraPosition[2];let p=s.bh();return s.aT(p,u),p}isSurfacePointVisible(e){let n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;let n=s.bk();return s.at(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){let u=s.aV(e,n),p=s.bh(),g=s.bh();s.aO(g,n,u),s.aS(p,e,g);let v=1-s.aV(p,p);if(v<0)return null;let x=s.aV(e,e)-1,C=-u+(u<0?1:-1)*Math.sqrt(v),T=x/C,k=C;return{tMin:Math.min(T,k),tMax:Math.max(T,k)}}unprojectScreenPoint(e){let n=this._cameraPosition,u=this.getRayDirectionFromPixel(e),p=this.rayPlanetIntersection(n,u);if(p){let k=s.bh();s.aP(k,n,[u[0]*p.tMin,u[1]*p.tMin,u[2]*p.tMin]);let R=s.bh();return s.aT(R,k),_o(R)}let g=this._cachedClippingPlane,v=g[0]*u[0]+g[1]*u[1]+g[2]*u[2],x=-s.bt(g,n)/v,C=s.bh();if(x>0)s.aP(C,n,[u[0]*x,u[1]*x,u[2]*x]);else{let k=s.bh();s.aP(k,n,[2*u[0],2*u[1],2*u[2]]);let R=s.bt(this._cachedClippingPlane,k);s.aS(C,k,[this._cachedClippingPlane[0]*R,this._cachedClippingPlane[1]*R,this._cachedClippingPlane[2]*R])}let T=function(k){let R=s.bh();return R[0]=k[0]*-k[3],R[1]=k[1]*-k[3],R[2]=k[2]*-k[3],{center:R,radius:Math.sqrt(1-k[3]*k[3])}}(g);return _o(function(k,R,D){let j=s.bh();s.aS(j,D,k);let U=s.bh();return s.bi(U,k,j,R/s.bj(j)),U}(T.center,T.radius,C))}getMatrixForModel(e,n){let u=s.Q.convert(e),p=1/s.bu,g=s.b1();return s.bp(g,g,u.lng/180*Math.PI),s.a$(g,g,-u.lat/180*Math.PI),s.L(g,g,[0,0,1+n/s.bu]),s.a$(g,g,.5*Math.PI),s.M(g,g,[p,p,p]),g}getProjectionDataForCustomLayer(e=!0){let n=this.getProjectionData({overscaledTileID:new s.Y(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class Ea{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,u){return this._helper.interpolatePadding(e,n,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,u=!0){this._helper.resize(e,n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new En({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new zs,this._verticalPerspectiveTransform=new ds}clone(){let e=new Ea;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){let n=this._mercatorTransform.getProjectionData(e),u=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?u.mainMatrix:n.mainMatrix,clippingPlane:u.clippingPlane,tileMercatorCoords:u.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return s.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,u){let p=this._mercatorTransform.getPitchedTextCorrection(e,n,u),g=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,u);return s.bc(p,g,this._globeness)}projectTileCoordinates(e,n,u,p){return this.currentTransform.projectTileCoordinates(e,n,u,p)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,u,p){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,u,p)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){let n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;let u=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return u.fallbackMatrix=n.mainMatrix,u}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Ir{get useGlobeControls(){return!0}handlePanInertia(e,n){let u=ul(e,n);return Math.abs(u.lng-n.center.lng)>180&&(u.lng=n.center.lng+179.5*Math.sign(u.lng-n.center.lng)),{easingCenter:u,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){let u=e.around,p=n.screenPointToLocation(u);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);let g=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);let v=n.zoom-g;if(v===0)return;let x=s.bq(n.center.lng,p.lng),C=x/(Math.abs(x/180)+1),T=s.bq(n.center.lat,p.lat),k=n.getRayDirectionFromPixel(u),R=n.cameraPosition,D=-1*s.aV(R,k),j=s.bh();s.aP(j,R,[k[0]*D,k[1]*D,k[2]*D]);let U=s.bo(j)-1,te=Math.exp(.5*-Math.max(U-.3,0)),ee=No(n.worldSize,n.center.lat)/Math.min(n.width,n.height),ie=s.bf(ee,.9,.5,1,.25),se=(1-s.ac(-v))*Math.min(te,ie),ue=n.center.lat,de=n.zoom,he=new s.Q(n.center.lng+C*se,s.ae(n.center.lat+T*se,-85.051129,s.af));n.setLocationAtPoint(p,u);let _e=n.center,pe=s.bf(Math.abs(x),45,85,0,1),Se=s.bf(ee,.75,.35,0,1),Be=Math.pow(Math.max(pe,Se),.25),ke=s.bq(_e.lng,he.lng),Ae=s.bq(_e.lat,he.lat);n.setCenter(new s.Q(_e.lng+ke*Be,_e.lat+Ae*Be).wrap()),n.setZoom(de+fn(ue,n.center.lat))}handleMapControlsPan(e,n,u){if(!e.panDelta)return;let p=n.center.lat,g=n.zoom;n.setCenter(ul(e.panDelta,n).wrap()),n.setZoom(g+fn(p,n.center.lat))}cameraForBoxAndBearing(e,n,u,p,g){let v=ar(e,n,u,p,g),x=n.left/g.width*2-1,C=(g.width-n.right)/g.width*2-1,T=n.top/g.height*-2+1,k=(g.height-n.bottom)/g.height*-2+1,R=s.bq(u.getWest(),u.getEast())<0,D=R?u.getEast():u.getWest(),j=R?u.getWest():u.getEast(),U=Math.max(u.getNorth(),u.getSouth()),te=Math.min(u.getNorth(),u.getSouth()),ee=D+.5*s.bq(D,j),ie=U+.5*s.bq(U,te),se=g.clone();se.setCenter(v.center),se.setBearing(v.bearing),se.setPitch(0),se.setRoll(0),se.setZoom(v.zoom);let ue=se.modelViewProjectionMatrix,de=[mn(u.getNorthWest()),mn(u.getNorthEast()),mn(u.getSouthWest()),mn(u.getSouthEast()),mn(new s.Q(j,ie)),mn(new s.Q(D,ie)),mn(new s.Q(ee,U)),mn(new s.Q(ee,te))],he=mn(v.center),_e=Number.POSITIVE_INFINITY;for(let pe of de)x<0&&(_e=Ir.getLesserNonNegativeNonNull(_e,Ir.solveVectorScale(pe,he,ue,"x",x))),C>0&&(_e=Ir.getLesserNonNegativeNonNull(_e,Ir.solveVectorScale(pe,he,ue,"x",C))),T>0&&(_e=Ir.getLesserNonNegativeNonNull(_e,Ir.solveVectorScale(pe,he,ue,"y",T))),k<0&&(_e=Ir.getLesserNonNegativeNonNull(_e,Ir.solveVectorScale(pe,he,ue,"y",k)));if(Number.isFinite(_e)&&_e!==0)return v.zoom=se.zoom+s.ah(_e),v;Xn()}handleJumpToCenterZoom(e,n){let u=e.center.lat,p=e.getConstrained(n.center?s.Q.convert(n.center):e.center,e.zoom).center;e.setCenter(p.wrap());let g=n.zoom!==void 0?+n.zoom:e.zoom+fn(u,p.lat);e.zoom!==g&&e.setZoom(g)}handleEaseTo(e,n){let u=e.zoom,p=e.center,g=e.padding,v={roll:e.roll,pitch:e.pitch,bearing:e.bearing},x={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},C=n.zoom!==void 0,T=!e.isPaddingEqual(n.padding),k=!1,R=n.center?s.Q.convert(n.center):p,D=e.getConstrained(R,u).center;Nr(e,D);let j=e.clone();j.setCenter(D),j.setZoom(C?+n.zoom:u+fn(p.lat,R.lat)),j.setBearing(n.bearing);let U=new s.P(s.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),s.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));j.setLocationAtPoint(D,U);let te=(n.offset&&n.offsetAsPoint.mag())>0?j.center:D,ee=C?+n.zoom:u+fn(p.lat,te.lat),ie=u+fn(p.lat,0),se=ee+fn(te.lat,0),ue=s.bq(p.lng,te.lng),de=s.bq(p.lat,te.lat),he=s.ac(se-ie);return k=ee!==u,{easeFunc:_e=>{if(s.b6(v,x)||yr({startEulerAngles:v,endEulerAngles:x,tr:e,k:_e,useSlerp:v.roll!=x.roll}),T&&e.interpolatePadding(g,n.padding,_e),n.around)s.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{let pe=se>ie?Math.min(2,he):Math.max(.5,he),Se=Math.pow(pe,1-_e),Be=cs(p,ue,de,_e*Se);e.setCenter(Be.wrap())}if(k){let pe=s.B.number(ie,se,_e)+fn(0,e.center.lat);e.setZoom(pe)}},isZooming:k,elevationCenter:te}}handleFlyTo(e,n){let u=n.zoom!==void 0,p=e.center,g=e.zoom,v=e.padding,x=!e.isPaddingEqual(n.padding),C=e.getConstrained(s.Q.convert(n.center||n.locationAtOffset),g).center,T=u?+n.zoom:e.zoom+fn(e.center.lat,C.lat),k=e.clone();k.setCenter(C),k.setZoom(T),k.setBearing(n.bearing);let R=new s.P(s.ae(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),s.ae(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(C,R);let D=k.center;Nr(e,D);let j=function(de,he,_e){let pe=mn(he),Se=mn(_e),Be=s.aV(pe,Se),ke=Math.acos(Be),Ae=Ma(de);return ke/(2*Math.PI)*Ae}(e,p,D),U=g+fn(p.lat,0),te=T+fn(D.lat,0),ee=s.ac(te-U),ie;if(typeof n.minZoom=="number"){let de=+n.minZoom+fn(D.lat,0),he=Math.min(de,U,te)+fn(0,D.lat),_e=e.getConstrained(D,he).zoom+fn(D.lat,0);ie=s.ac(_e-U)}let se=s.bq(p.lng,D.lng),ue=s.bq(p.lat,D.lat);return{easeFunc:(de,he,_e,pe)=>{let Se=cs(p,se,ue,_e);x&&e.interpolatePadding(v,n.padding,de);let Be=de===1?D:Se;e.setCenter(Be.wrap());let ke=U+s.ah(he);e.setZoom(de===1?T:ke+fn(0,Be.lat))},scaleOfZoom:ee,targetCenter:D,scaleOfMinZoom:ie,pixelPathLength:j}}static solveVectorScale(e,n,u,p,g){let v=p==="x"?[u[0],u[4],u[8],u[12]]:[u[1],u[5],u[9],u[13]],x=[u[3],u[7],u[11],u[15]],C=e[0]*v[0]+e[1]*v[1]+e[2]*v[2],T=e[0]*x[0]+e[1]*x[1]+e[2]*x[2],k=n[0]*v[0]+n[1]*v[1]+n[2]*v[2],R=n[0]*x[0]+n[1]*x[1]+n[2]*x[2];return k+g*T===C+g*R||x[3]*(C-k)+v[3]*(R-T)+C*R==k*T?null:(k+v[3]-g*R-g*x[3])/(k-C-g*R+g*T)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class us{constructor(e){this._globe=e,this._mercatorCameraHelper=new ba,this._verticalPerspectiveCameraHelper=new Ir}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,u){this.currentHelper.handleMapControlsPan(e,n,u)}cameraForBoxAndBearing(e,n,u,p,g){return this.currentHelper.cameraForBoxAndBearing(e,n,u,p,g)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}let hl=(f,e)=>s.x(f,e&&e.filter(n=>n.identifier!=="source.canvas")),Vu=s.bw();class Ns extends s.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(let u in this.sourceCaches){let p=this.sourceCaches[u].getSource().type;p!=="vector"&&p!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new Mn(mr(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,p)=>this.getGlyphs(u,p)),this.dispatcher.registerMessageHandler("GI",(u,p)=>this.getImages(u,p)),this.imageManager=new ks,this.imageManager.setEventedParent(this),this.glyphManager=new kt(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new Pr(256,512),this.crossTileSymbolIndex=new _a,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",s.by()),Oi().on(gr,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;let p=this.sourceCaches[u.sourceId];if(!p)return;let g=p.getSource();if(g&&g.vectorLayerIds)for(let v in this._layers){let x=this._layers[v];x.source===g.id&&this._validateLayer(x)}})}loadURL(e,n={},u){this.fire(new s.l("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;let p=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;let g=this._loadStyleRequest;s.j(p,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,n,u)}).catch(v=>{this._loadStyleRequest=null,v&&!g.signal.aborted&&this.fire(new s.k(v))})}loadJSON(e,n={},u){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ve.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,u)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(Vu,{validate:!1})}_load(e,n,u){var p,g;let v=n.transformStyle?n.transformStyle(u,e):e;if(!n.validate||!hl(this,s.y(v))){this._loaded=!0,this.stylesheet=v;for(let x in v.sources)this.addSource(x,v.sources[x],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Ds(this.stylesheet.light),this._setProjectionInternal(((p=this.stylesheet.projection)===null||p===void 0?void 0:p.type)||"mercator"),this.sky=new ho(this.stylesheet.sky),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){let e=s.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(let n of e){let u=s.bA(n);u.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=u}}_loadSprite(e,n=!1,u=void 0){let p;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(g,v,x,C){return s._(this,void 0,void 0,function*(){let T=bi(g),k=x>1?"@2x":"",R={},D={};for(let{id:j,url:U}of T){let te=v.transformRequest(Qi(U,k,".json"),"SpriteJSON");R[j]=s.j(te,C);let ee=v.transformRequest(Qi(U,k,".png"),"SpriteImage");D[j]=Mi.getImage(ee,C)}return yield Promise.all([...Object.values(R),...Object.values(D)]),function(j,U){return s._(this,void 0,void 0,function*(){let te={};for(let ee in j){te[ee]={};let ie=ve.getImageCanvasContext((yield U[ee]).data),se=(yield j[ee]).data;for(let ue in se){let{width:de,height:he,x:_e,y:pe,sdf:Se,pixelRatio:Be,stretchX:ke,stretchY:Ae,content:Re,textFitWidth:Je,textFitHeight:Ke}=se[ue];te[ee][ue]={data:null,pixelRatio:Be,sdf:Se,stretchX:ke,stretchY:Ae,content:Re,textFitWidth:Je,textFitHeight:Ke,spriteData:{width:de,height:he,x:_e,y:pe,context:ie}}}}return te})}(R,D)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(g=>{if(this._spriteRequest=null,g)for(let v in g){this._spritesImagesIds[v]=[];let x=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter(C=>!(C in g)):[];for(let C of x)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(let C in g[v]){let T=v==="default"?C:`${v}:${C}`;this._spritesImagesIds[v].push(T),T in this.imageManager.images?this.imageManager.updateImage(T,g[v][C],!1):this.imageManager.addImage(T,g[v][C]),n&&(this._changedImages[T]=!0)}}}).catch(g=>{this._spriteRequest=null,p=g,this.fire(new s.k(p))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),u&&u(p)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(e){let n=this.sourceCaches[e.source];if(!n)return;let u=e.sourceLayer;if(!u)return;let p=n.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(u)===-1)&&this.fire(new s.k(new Error(`Source layer "${u}" does not exist on source "${p.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){let u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?s.bB(u):u);let p=[];for(let g of e)if(u[g]){let v=n?s.bB(u[g]):u[g];p.push(v)}return p}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let n=Object.keys(this._layers);for(let u of n){let p=this._layers[u];p.type!=="custom"&&(e[u]=p.serialize())}return e}hasTransitions(){var e,n,u;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((u=this.projection)===null||u===void 0)&&u.hasTransition())return!0;for(let p in this.sourceCaches)if(this.sourceCaches[p].hasTransition())return!0;for(let p in this._layers)if(this._layers[p].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let n=this._changed;if(n){let p=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(p.length||g.length)&&this._updateWorkerLayers(p,g);for(let v in this._updatedSources){let x=this._updatedSources[v];if(x==="reload")this._reloadSource(v);else{if(x!=="clear")throw new Error(`Invalid action ${x}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let v in this._updatedPaintProps)this._layers[v].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}let u={};for(let p in this.sourceCaches){let g=this.sourceCaches[p];u[p]=g.used,g.used=!1}for(let p of this._order){let g=this._layers[p];g.recalculate(e,this._availableImages),!g.isHidden(e.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(let p in u){let g=this.sourceCaches[p];!!u[p]!=!!g.used&&g.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var u;this._checkLoaded();let p=this.serialize();if(e=n.transformStyle?n.transformStyle(p,e):e,((u=n.validate)===null||u===void 0||u)&&hl(this,s.y(e)))return!1;(e=s.bB(e)).layers=s.bz(e.layers);let g=s.bC(p,e),v=this._getOperationsToPerform(g);if(v.unimplemented.length>0)throw new Error(`Unimplemented: ${v.unimplemented.join(", ")}.`);if(v.operations.length===0)return!1;for(let x of v.operations)x();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let n=[],u=[];for(let p of e)switch(p.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,p.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,p.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,p.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,p.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,p.args));break;case"addSource":n.push(()=>this.addSource.apply(this,p.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,p.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,p.args));break;case"setLight":n.push(()=>this.setLight.apply(this,p.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,p.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,p.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,p.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,p.args));break;case"setSky":n.push(()=>this.setSky.apply(this,p.args));break;case"setProjection":this.setProjection.apply(this,p.args);break;case"setTransition":n.push(()=>{});break;default:u.push(p.command)}return{operations:n,unimplemented:u}}addImage(e,n){if(this.getImage(e))return this.fire(new s.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new s.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(s.y.source,`sources.${e}`,n,null,u))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);let p=this.sourceCaches[e]=new Ce(e,n,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:e})),p.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let u in this._layers)if(this._layers[u].source===e)return this.fire(new s.k(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));let n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);let u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,u={}){this._checkLoaded();let p=e.id;if(this.getLayer(p))return void this.fire(new s.k(new Error(`Layer "${p}" already exists on this map.`)));let g;if(e.type==="custom"){if(hl(this,s.bD(e)))return;g=s.bA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(p,e.source),e=s.bB(e),e=s.e(e,{source:p})),this._validate(s.y.layer,`layers.${p}`,e,{arrayIndex:-1},u))return;g=s.bA(e),this._validateLayer(g),g.setEventedParent(this,{layer:{id:p}})}let v=n?this._order.indexOf(n):this._order.length;if(n&&v===-1)this.fire(new s.k(new Error(`Cannot add layer "${p}" before non-existing layer "${n}".`)));else{if(this._order.splice(v,0,p),this._layerOrderChanged=!0,this._layers[p]=g,this._removedLayers[p]&&g.source&&g.type!=="custom"){let x=this._removedLayers[p];delete this._removedLayers[p],x.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new s.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;let u=this._order.indexOf(e);this._order.splice(u,1);let p=n?this._order.indexOf(n):this._order.length;n&&p===-1?this.fire(new s.k(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(p,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();let n=this._layers[e];if(!n)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);let u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,u){this._checkLoaded();let p=this.getLayer(e);p?p.minzoom===n&&p.maxzoom===u||(n!=null&&(p.minzoom=n),u!=null&&(p.maxzoom=u),this._updateLayer(p)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,u={}){this._checkLoaded();let p=this.getLayer(e);if(p){if(!s.bE(p.filter,n))return n==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(s.y.filter,`layers.${p.id}.filter`,n,null,u)||(p.filter=s.bB(n),this._updateLayer(p)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return s.bB(this.getLayer(e).filter)}setLayoutProperty(e,n,u,p={}){this._checkLoaded();let g=this.getLayer(e);g?s.bE(g.getLayoutProperty(n),u)||(g.setLayoutProperty(n,u,p),this._updateLayer(g)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){let u=this.getLayer(e);if(u)return u.getLayoutProperty(n);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,u,p={}){this._checkLoaded();let g=this.getLayer(e);g?s.bE(g.getPaintProperty(n),u)||(g.setPaintProperty(n,u,p)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new s.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();let u=e.source,p=e.sourceLayer,g=this.sourceCaches[u];if(g===void 0)return void this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)));let v=g.getSource().type;v==="geojson"&&p?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||p?(e.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),g.setFeatureState(p,e.id,n)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();let u=e.source,p=this.sourceCaches[u];if(p===void 0)return void this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)));let g=p.getSource().type,v=g==="vector"?e.sourceLayer:void 0;g!=="vector"||v?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(v,e.id,n):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();let n=e.source,u=e.sourceLayer,p=this.sourceCaches[n];if(p!==void 0)return p.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),p.getFeatureState(u,e.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=s.bF(this.sourceCaches,g=>g.serialize()),n=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,p=this.stylesheet;return s.bG({version:p.version,name:p.name,metadata:p.metadata,light:p.light,sky:p.sky,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,projection:p.projection,sources:e,layers:n,terrain:u},g=>g!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let n=v=>this._layers[v].type==="fill-extrusion",u={},p=[];for(let v=this._order.length-1;v>=0;v--){let x=this._order[v];if(n(x)){u[x]=v;for(let C of e){let T=C[x];if(T)for(let k of T)p.push(k)}}}p.sort((v,x)=>x.intersectionZ-v.intersectionZ);let g=[];for(let v=this._order.length-1;v>=0;v--){let x=this._order[v];if(n(x))for(let C=p.length-1;C>=0;C--){let T=p[C].feature;if(u[T.layer.id]<v)break;g.push(T),p.pop()}else for(let C of e){let T=C[x];if(T)for(let k of T)g.push(k.feature)}}return g}queryRenderedFeatures(e,n,u){n&&n.filter&&this._validate(s.y.filter,"queryRenderedFeatures.filter",n.filter,null,n);let p={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(let T of n.layers){let k=this._layers[T];if(!k)return this.fire(new s.k(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];p[k.source]=!0}}let g=[];n.availableImages=this._availableImages;let v=this._serializedAllLayers(),x=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,C=Object.assign(Object.assign({},n),{layers:x});for(let T in this.sourceCaches)n.layers&&!p[T]||g.push(ns(this.sourceCaches[T],this._layers,v,e,C,u,this.map.terrain?(k,R,D)=>this.map.terrain.getElevation(k,R,D):void 0));return this.placement&&g.push(function(T,k,R,D,j,U,te){let ee={},ie=U.queryRenderedSymbols(D),se=[];for(let ue of Object.keys(ie).map(Number))se.push(te[ue]);se.sort(fr);for(let ue of se){let de=ue.featureIndex.lookupSymbolFeatures(ie[ue.bucketInstanceId],k,ue.bucketIndex,ue.sourceLayerIndex,j.filter,j.layers,j.availableImages,T);for(let he in de){let _e=ee[he]=ee[he]||[],pe=de[he];pe.sort((Se,Be)=>{let ke=ue.featureSortOrder;if(ke){let Ae=ke.indexOf(Se.featureIndex);return ke.indexOf(Be.featureIndex)-Ae}return Be.featureIndex-Se.featureIndex});for(let Se of pe)_e.push(Se)}}return function(ue,de,he){for(let _e in ue)for(let pe of ue[_e])Zn(pe,he[de[_e].source]);return ue}(ee,T,R)}(this._layers,v,this.sourceCaches,e,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(e,n){n&&n.filter&&this._validate(s.y.filter,"querySourceFeatures.filter",n.filter,null,n);let u=this.sourceCaches[e];return u?function(p,g){let v=p.getRenderableIds().map(T=>p.getTileByID(T)),x=[],C={};for(let T=0;T<v.length;T++){let k=v[T],R=k.tileID.canonical.key;C[R]||(C[R]=!0,k.querySourceFeatures(x,g))}return x}(u,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();let u=this.light.getLight(),p=!1;for(let v in e)if(!s.bE(e[v],u[v])){p=!0;break}if(!p)return;let g={now:ve.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(g)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();let u=this.getSky(),p=!1;if(!e&&!u)return;if(e&&!u)p=!0;else if(!e&&u)p=!0;else for(let v in e)if(!s.bE(e[v],u[v])){p=!0;break}if(!p)return;let g={now:ve.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(g)}_setProjectionInternal(e){let n=function(u){if(Array.isArray(u)){let p=new Ca({type:u});return{projection:p,transform:new Ea,cameraHelper:new us(p)}}switch(u){case"mercator":return{projection:new ya,transform:new zs,cameraHelper:new ba};case"globe":{let p=new Ca({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:p,transform:new Ea,cameraHelper:new us(p)}}case"vertical-perspective":return{projection:new wa,transform:new ds,cameraHelper:new Ir};default:return s.w(`Unknown projection name: ${u}. Falling back to mercator projection.`),{projection:new ya,transform:new zs,cameraHelper:new ba}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(let u in this.sourceCaches)this.sourceCaches[u].reload()}_validate(e,n,u,p,g={}){return(!g||g.validate!==!1)&&hl(this,e.call(s.y,s.e({key:n,style:this.serialize(),value:u,styleSpec:s.v},p)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Oi().off(gr,this._rtlPluginLoaded);for(let n in this._layers)this._layers[n].setEventedParent(null);for(let n in this.sourceCaches){let u=this.sourceCaches[n];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,u,p,g=!1){let v=!1,x=!1,C={};for(let T of this._order){let k=this._layers[T];if(k.type!=="symbol")continue;if(!C[k.source]){let D=this.sourceCaches[k.source];C[k.source]=D.getRenderableIds(!0).map(j=>D.getTileByID(j)).sort((j,U)=>U.tileID.overscaledZ-j.tileID.overscaledZ||(j.tileID.isLessThan(U.tileID)?-1:1))}let R=this.crossTileSymbolIndex.addLayer(k,C[k.source],e.center.lng);v=v||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ve.now(),e.zoom))&&(this.pauseablePlacement=new fa(e,this.map.terrain,this._order,g,n,u,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ve.now()),x=!0),v&&this.pauseablePlacement.placement.setStale()),x||v)for(let T of this._order){let k=this._layers[T];k.type==="symbol"&&this.placement.updateLayerOpacities(k,C[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ve.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return s._(this,void 0,void 0,function*(){let u=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();let p=this.sourceCaches[n.source];return p&&p.setDependencies(n.tileID.key,n.type,n.icons),u})}getGlyphs(e,n){return s._(this,void 0,void 0,function*(){let u=yield this.glyphManager.getGlyphs(n.stacks),p=this.sourceCaches[n.source];return p&&p.setDependencies(n.tileID.key,n.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(s.y.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,u={},p){this._checkLoaded();let g=[{id:e,url:n}],v=[...bi(this.stylesheet.sprite),...g];this._validate(s.y.sprite,"sprite",v,null,u)||(this.stylesheet.sprite=v,this._loadSprite(g,!0,p))}removeSprite(e){this._checkLoaded();let n=bi(this.stylesheet.sprite);if(n.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(let u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;n.splice(n.findIndex(u=>u.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return bi(this.stylesheet.sprite)}setSprite(e,n={},u){this._checkLoaded(),e&&this._validate(s.y.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var yd=s.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ju{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,u,p,g,v,x,C,T){this.context=e;let k=this.boundPaintVertexBuffers.length!==p.length;for(let R=0;!k&&R<p.length;R++)this.boundPaintVertexBuffers[R]!==p[R]&&(k=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==u||k||this.boundIndexBuffer!==g||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==x||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==T?this.freshBind(n,u,p,g,v,x,C,T):(e.bindVertexArray.set(this.vao),x&&x.bind(),g&&g.dynamicDraw&&g.bind(),C&&C.bind(),T&&T.bind())}freshBind(e,n,u,p,g,v,x,C){let T=e.numAttributes,k=this.context,R=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=p,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=x,this.boundDynamicVertexBuffer3=C,n.enableAttributes(R,e);for(let D of u)D.enableAttributes(R,e);v&&v.enableAttributes(R,e),x&&x.enableAttributes(R,e),C&&C.enableAttributes(R,e),n.bind(),n.setVertexAttribPointers(R,e,g);for(let D of u)D.bind(),D.setVertexAttribPointers(R,e,g);v&&(v.bind(),v.setVertexAttribPointers(R,e,g)),p&&p.bind(),x&&(x.bind(),x.setVertexAttribPointers(R,e,g)),C&&(C.bind(),C.setVertexAttribPointers(R,e,g)),k.currentNumAttributes=T}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let Uu=(f,e,n,u,p)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):s.b7.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:p?0:n?n.calculateFogBlendOpacity(u):0,u_horizon_color:n?n.properties.get("horizon-color"):s.b7.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:p?1:0}),pl={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function hs(f){let e=[];for(let n=0;n<f.length;n++){if(f[n]===null)continue;let u=f[n].split(" ");e.push(u.pop())}return e}class ml{constructor(e,n,u,p,g,v,x,C,T=[]){let k=e.gl;this.program=k.createProgram();let R=hs(n.staticAttributes),D=u?u.getBinderAttributes():[],j=R.concat(D),U=Wn.prelude.staticUniforms?hs(Wn.prelude.staticUniforms):[],te=x.staticUniforms?hs(x.staticUniforms):[],ee=n.staticUniforms?hs(n.staticUniforms):[],ie=u?u.getBinderUniforms():[],se=U.concat(te).concat(ee).concat(ie),ue=[];for(let ke of se)ue.indexOf(ke)<0&&ue.push(ke);let de=u?u.defines():[];zn(k)&&de.unshift("#version 300 es"),g&&de.push("#define OVERDRAW_INSPECTOR;"),v&&de.push("#define TERRAIN3D;"),C&&de.push(C),T&&de.push(...T);let he=de.concat(Wn.prelude.fragmentSource,x.fragmentSource,n.fragmentSource).join(`
`),_e=de.concat(Wn.prelude.vertexSource,x.vertexSource,n.vertexSource).join(`
`);zn(k)||(he=function(ke){return ke.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(he),_e=function(ke){return ke.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(_e));let pe=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(pe,he),k.compileShader(pe),!k.getShaderParameter(pe,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(pe)}`);k.attachShader(this.program,pe);let Se=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(Se,_e),k.compileShader(Se),!k.getShaderParameter(Se,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(Se)}`);k.attachShader(this.program,Se),this.attributes={};let Be={};this.numAttributes=j.length;for(let ke=0;ke<this.numAttributes;ke++)j[ke]&&(k.bindAttribLocation(this.program,ke,j[ke]),this.attributes[j[ke]]=ke);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(Se),k.deleteShader(pe);for(let ke=0;ke<ue.length;ke++){let Ae=ue[ke];if(Ae&&!Be[Ae]){let Re=k.getUniformLocation(this.program,Ae);Re&&(Be[Ae]=Re)}}this.fixedUniforms=p(e,Be),this.terrainUniforms=((ke,Ae)=>({u_depth:new s.bH(ke,Ae.u_depth),u_terrain:new s.bH(ke,Ae.u_terrain),u_terrain_dim:new s.b8(ke,Ae.u_terrain_dim),u_terrain_matrix:new s.bJ(ke,Ae.u_terrain_matrix),u_terrain_unpack:new s.bK(ke,Ae.u_terrain_unpack),u_terrain_exaggeration:new s.b8(ke,Ae.u_terrain_exaggeration)}))(e,Be),this.projectionUniforms=((ke,Ae)=>({u_projection_matrix:new s.bJ(ke,Ae.u_projection_matrix),u_projection_tile_mercator_coords:new s.bK(ke,Ae.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bK(ke,Ae.u_projection_clipping_plane),u_projection_transition:new s.b8(ke,Ae.u_projection_transition),u_projection_fallback_matrix:new s.bJ(ke,Ae.u_projection_fallback_matrix)}))(e,Be),this.binderUniforms=u?u.getUniforms(e,Be):[]}draw(e,n,u,p,g,v,x,C,T,k,R,D,j,U,te,ee,ie,se,ue){let de=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(p),e.setColorMode(g),e.setCullFace(v),C){e.activeTexture.set(de.TEXTURE2),de.bindTexture(de.TEXTURE_2D,C.depthTexture),e.activeTexture.set(de.TEXTURE3),de.bindTexture(de.TEXTURE_2D,C.texture);for(let _e in this.terrainUniforms)this.terrainUniforms[_e].set(C[_e])}if(T)for(let _e in T)this.projectionUniforms[pl[_e]].set(T[_e]);if(x)for(let _e in this.fixedUniforms)this.fixedUniforms[_e].set(x[_e]);ee&&ee.setUniforms(e,this.binderUniforms,U,{zoom:te});let he=0;switch(n){case de.LINES:he=2;break;case de.TRIANGLES:he=3;break;case de.LINE_STRIP:he=1}for(let _e of j.get()){let pe=_e.vaos||(_e.vaos={});(pe[k]||(pe[k]=new ju)).bind(e,this,R,ee?ee.getPaintVertexBuffers():[],D,_e.vertexOffset,ie,se,ue),de.drawElements(n,_e.primitiveLength*he,de.UNSIGNED_SHORT,_e.primitiveOffset*he*2)}}}function Vs(f,e,n){let u=1/s.az(n,1,e.transform.tileZoom),p=Math.pow(2,n.tileID.overscaledZ),g=n.tileSize*Math.pow(2,e.transform.tileZoom)/p,v=g*(n.tileID.canonical.x+n.tileID.wrap*p),x=g*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[u,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[v>>16,x>>16],u_pixel_coord_lower:[65535&v,65535&x]}}let Ta=(f,e,n,u)=>{let p=f.style.light,g=p.properties.get("position"),v=[g.x,g.y,g.z],x=s.bN();p.properties.get("anchor")==="viewport"&&s.bO(x,f.transform.bearingInRadians),s.bP(v,v,x);let C=f.transform.transformLightDirection(v),T=p.properties.get("color");return{u_lightpos:v,u_lightpos_globe:C,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:u}},jr=(f,e,n,u,p,g,v)=>s.e(Ta(f,e,n,u),Vs(g,f,v),{u_height_factor:-Math.pow(2,p.overscaledZ)/v.tileSize/8}),fl=(f,e,n,u)=>s.e(Vs(e,f,n),{u_fill_translate:u}),js=(f,e)=>({u_world:f,u_fill_translate:e}),Ia=(f,e,n,u,p)=>s.e(fl(f,e,n,p),{u_world:u}),Us=(f,e,n,u,p)=>{let g=f.transform,v,x,C=0;if(n.paint.get("circle-pitch-alignment")==="map"){let T=s.az(e,1,g.zoom);v=!0,x=[T,T],C=T/(s.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*p}else v=!1,x=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+v,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:x,u_globe_extrude_scale:C,u_translate:u}},vd=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),ka=f=>({u_viewport_size:[f.width,f.height]}),yc=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),jo=(f,e,n,u)=>{let p=s.az(f,1,e)/(s.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*u;return{u_extrude_scale:s.az(f,1,e),u_intensity:n,u_globe_extrude_scale:p}},vc=(f,e,n,u)=>{let p=s.K();s.bQ(p,0,f.width,f.height,0,0,1);let g=f.context.gl;return{u_matrix:p,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:n,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}},bc=(f,e,n)=>{let u=n.paint.get("hillshade-accent-color"),p;switch(n.paint.get("hillshade-method")){case"basic":p=4;break;case"combined":p=1;break;case"igor":p=2;break;case"multidirectional":p=3;break;default:p=0}let g=n.getIlluminationProperties();for(let v=0;v<g.directionRadians.length;v++)n.paint.get("hillshade-illumination-anchor")==="viewport"&&(g.directionRadians[v]+=f.transform.bearingInRadians);return{u_image:0,u_latrange:xc(0,e.tileID),u_exaggeration:n.paint.get("hillshade-exaggeration"),u_altitudes:g.altitudeRadians,u_azimuths:g.directionRadians,u_accent:u,u_method:p,u_highlights:g.highlightColor,u_shadows:g.shadowColor}},bd=(f,e)=>{let n=e.stride,u=s.K();return s.bQ(u,0,s.Z,-8192,0,0,1),s.L(u,u,[0,-8192,0]),{u_matrix:u,u_image:1,u_dimension:[n,n],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function xc(f,e){let n=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new s.$(0,u/n).toLngLat().lat,new s.$(0,(u+1)/n).toLngLat().lat]}let to=(f,e,n,u)=>{let p=f.transform;return{u_translation:yo(f,e,n),u_ratio:u/s.az(e,1,p.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},xd=(f,e,n,u,p)=>s.e(to(f,e,n,u),{u_image:0,u_image_height:p}),wd=(f,e,n,u,p)=>{let g=f.transform,v=gl(e,g);return{u_translation:yo(f,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:u/s.az(e,1,g.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[v,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Cd=(f,e,n,u,p,g)=>{let v=f.lineAtlas,x=gl(e,f.transform),C=n.layout.get("line-cap")==="round",T=v.getDash(p.from,C),k=v.getDash(p.to,C),R=T.width*g.fromScale,D=k.width*g.toScale;return s.e(to(f,e,n,u),{u_patternscale_a:[x/R,-T.height/2],u_patternscale_b:[x/D,-k.height/2],u_sdfgamma:v.width/(256*Math.min(R,D)*f.pixelRatio)/2,u_image:0,u_tex_y_a:T.y,u_tex_y_b:k.y,u_mix:g.t})};function gl(f,e){return 1/s.az(f,1,e.tileZoom)}function yo(f,e,n){return s.aA(f.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}let wc=(f,e,n,u,p)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(v=u.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(g=u.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:Md(u.paint.get("raster-hue-rotate")),u_coords_top:[p[0].x,p[0].y,p[1].x,p[1].y],u_coords_bottom:[p[3].x,p[3].y,p[2].x,p[2].y]};var g,v};function Md(f){f*=Math.PI/180;let e=Math.sin(f),n=Math.cos(f);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}let $s=(f,e,n,u,p,g,v,x,C,T,k,R,D)=>{let j=v.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:j.width/j.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_label_plane_matrix:x,u_coord_matrix:C,u_is_text:+k,u_pitch_with_map:+u,u_is_along_line:p,u_is_variable_anchor:g,u_texsize:R,u_texture:0,u_translation:T,u_pitched_scale:D}},Sd=(f,e,n,u,p,g,v,x,C,T,k,R,D,j)=>{let U=v.transform;return s.e($s(f,e,n,u,p,g,v,x,C,T,k,R,j),{u_gamma_scale:u?Math.cos(U.pitch*Math.PI/180)*U.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:1})},Aa=(f,e,n,u,p,g,v,x,C,T,k,R,D)=>s.e(Sd(f,e,n,u,p,g,v,x,C,T,!0,k,0,D),{u_texsize_icon:R,u_texture_icon:1}),Pd=(f,e)=>({u_opacity:f,u_color:e}),$u=(f,e,n,u,p)=>s.e(function(g,v,x,C){let T=x.imageManager.getPattern(g.from.toString()),k=x.imageManager.getPattern(g.to.toString()),{width:R,height:D}=x.imageManager.getPixelSize(),j=Math.pow(2,C.tileID.overscaledZ),U=C.tileSize*Math.pow(2,x.transform.tileZoom)/j,te=U*(C.tileID.canonical.x+C.tileID.wrap*j),ee=U*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:T.tl,u_pattern_br_a:T.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[R,D],u_mix:v.t,u_pattern_size_a:T.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/s.az(C,1,x.transform.tileZoom),u_pixel_coord_upper:[te>>16,ee>>16],u_pixel_coord_lower:[65535&te,65535&ee]}}(n,p,e,u),{u_opacity:f}),_l=(f,e)=>{},Ed={fillExtrusion:(f,e)=>({u_lightpos:new s.bL(f,e.u_lightpos),u_lightpos_globe:new s.bL(f,e.u_lightpos_globe),u_lightintensity:new s.b8(f,e.u_lightintensity),u_lightcolor:new s.bL(f,e.u_lightcolor),u_vertical_gradient:new s.b8(f,e.u_vertical_gradient),u_opacity:new s.b8(f,e.u_opacity),u_fill_translate:new s.bM(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new s.bL(f,e.u_lightpos),u_lightpos_globe:new s.bL(f,e.u_lightpos_globe),u_lightintensity:new s.b8(f,e.u_lightintensity),u_lightcolor:new s.bL(f,e.u_lightcolor),u_vertical_gradient:new s.b8(f,e.u_vertical_gradient),u_height_factor:new s.b8(f,e.u_height_factor),u_opacity:new s.b8(f,e.u_opacity),u_fill_translate:new s.bM(f,e.u_fill_translate),u_image:new s.bH(f,e.u_image),u_texsize:new s.bM(f,e.u_texsize),u_pixel_coord_upper:new s.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(f,e.u_pixel_coord_lower),u_scale:new s.bL(f,e.u_scale),u_fade:new s.b8(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new s.bM(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new s.bH(f,e.u_image),u_texsize:new s.bM(f,e.u_texsize),u_pixel_coord_upper:new s.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(f,e.u_pixel_coord_lower),u_scale:new s.bL(f,e.u_scale),u_fade:new s.b8(f,e.u_fade),u_fill_translate:new s.bM(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new s.bM(f,e.u_world),u_fill_translate:new s.bM(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new s.bM(f,e.u_world),u_image:new s.bH(f,e.u_image),u_texsize:new s.bM(f,e.u_texsize),u_pixel_coord_upper:new s.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(f,e.u_pixel_coord_lower),u_scale:new s.bL(f,e.u_scale),u_fade:new s.b8(f,e.u_fade),u_fill_translate:new s.bM(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new s.b8(f,e.u_camera_to_center_distance),u_scale_with_map:new s.bH(f,e.u_scale_with_map),u_pitch_with_map:new s.bH(f,e.u_pitch_with_map),u_extrude_scale:new s.bM(f,e.u_extrude_scale),u_device_pixel_ratio:new s.b8(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new s.b8(f,e.u_globe_extrude_scale),u_translate:new s.bM(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new s.bM(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new s.bM(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new s.bI(f,e.u_color),u_overlay:new s.bH(f,e.u_overlay),u_overlay_scale:new s.b8(f,e.u_overlay_scale)}),depth:_l,clippingMask:_l,heatmap:(f,e)=>({u_extrude_scale:new s.b8(f,e.u_extrude_scale),u_intensity:new s.b8(f,e.u_intensity),u_globe_extrude_scale:new s.b8(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new s.bJ(f,e.u_matrix),u_world:new s.bM(f,e.u_world),u_image:new s.bH(f,e.u_image),u_color_ramp:new s.bH(f,e.u_color_ramp),u_opacity:new s.b8(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new s.bH(f,e.u_image),u_latrange:new s.bM(f,e.u_latrange),u_exaggeration:new s.b8(f,e.u_exaggeration),u_altitudes:new s.bS(f,e.u_altitudes),u_azimuths:new s.bS(f,e.u_azimuths),u_accent:new s.bI(f,e.u_accent),u_method:new s.bH(f,e.u_method),u_shadows:new s.bR(f,e.u_shadows),u_highlights:new s.bR(f,e.u_highlights)}),hillshadePrepare:(f,e)=>({u_matrix:new s.bJ(f,e.u_matrix),u_image:new s.bH(f,e.u_image),u_dimension:new s.bM(f,e.u_dimension),u_zoom:new s.b8(f,e.u_zoom),u_unpack:new s.bK(f,e.u_unpack)}),line:(f,e)=>({u_translation:new s.bM(f,e.u_translation),u_ratio:new s.b8(f,e.u_ratio),u_device_pixel_ratio:new s.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new s.bM(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new s.bM(f,e.u_translation),u_ratio:new s.b8(f,e.u_ratio),u_device_pixel_ratio:new s.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new s.bM(f,e.u_units_to_pixels),u_image:new s.bH(f,e.u_image),u_image_height:new s.b8(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new s.bM(f,e.u_translation),u_texsize:new s.bM(f,e.u_texsize),u_ratio:new s.b8(f,e.u_ratio),u_device_pixel_ratio:new s.b8(f,e.u_device_pixel_ratio),u_image:new s.bH(f,e.u_image),u_units_to_pixels:new s.bM(f,e.u_units_to_pixels),u_scale:new s.bL(f,e.u_scale),u_fade:new s.b8(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new s.bM(f,e.u_translation),u_ratio:new s.b8(f,e.u_ratio),u_device_pixel_ratio:new s.b8(f,e.u_device_pixel_ratio),u_units_to_pixels:new s.bM(f,e.u_units_to_pixels),u_patternscale_a:new s.bM(f,e.u_patternscale_a),u_patternscale_b:new s.bM(f,e.u_patternscale_b),u_sdfgamma:new s.b8(f,e.u_sdfgamma),u_image:new s.bH(f,e.u_image),u_tex_y_a:new s.b8(f,e.u_tex_y_a),u_tex_y_b:new s.b8(f,e.u_tex_y_b),u_mix:new s.b8(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new s.bM(f,e.u_tl_parent),u_scale_parent:new s.b8(f,e.u_scale_parent),u_buffer_scale:new s.b8(f,e.u_buffer_scale),u_fade_t:new s.b8(f,e.u_fade_t),u_opacity:new s.b8(f,e.u_opacity),u_image0:new s.bH(f,e.u_image0),u_image1:new s.bH(f,e.u_image1),u_brightness_low:new s.b8(f,e.u_brightness_low),u_brightness_high:new s.b8(f,e.u_brightness_high),u_saturation_factor:new s.b8(f,e.u_saturation_factor),u_contrast_factor:new s.b8(f,e.u_contrast_factor),u_spin_weights:new s.bL(f,e.u_spin_weights),u_coords_top:new s.bK(f,e.u_coords_top),u_coords_bottom:new s.bK(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new s.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bH(f,e.u_is_size_feature_constant),u_size_t:new s.b8(f,e.u_size_t),u_size:new s.b8(f,e.u_size),u_camera_to_center_distance:new s.b8(f,e.u_camera_to_center_distance),u_pitch:new s.b8(f,e.u_pitch),u_rotate_symbol:new s.bH(f,e.u_rotate_symbol),u_aspect_ratio:new s.b8(f,e.u_aspect_ratio),u_fade_change:new s.b8(f,e.u_fade_change),u_label_plane_matrix:new s.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new s.bJ(f,e.u_coord_matrix),u_is_text:new s.bH(f,e.u_is_text),u_pitch_with_map:new s.bH(f,e.u_pitch_with_map),u_is_along_line:new s.bH(f,e.u_is_along_line),u_is_variable_anchor:new s.bH(f,e.u_is_variable_anchor),u_texsize:new s.bM(f,e.u_texsize),u_texture:new s.bH(f,e.u_texture),u_translation:new s.bM(f,e.u_translation),u_pitched_scale:new s.b8(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new s.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bH(f,e.u_is_size_feature_constant),u_size_t:new s.b8(f,e.u_size_t),u_size:new s.b8(f,e.u_size),u_camera_to_center_distance:new s.b8(f,e.u_camera_to_center_distance),u_pitch:new s.b8(f,e.u_pitch),u_rotate_symbol:new s.bH(f,e.u_rotate_symbol),u_aspect_ratio:new s.b8(f,e.u_aspect_ratio),u_fade_change:new s.b8(f,e.u_fade_change),u_label_plane_matrix:new s.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new s.bJ(f,e.u_coord_matrix),u_is_text:new s.bH(f,e.u_is_text),u_pitch_with_map:new s.bH(f,e.u_pitch_with_map),u_is_along_line:new s.bH(f,e.u_is_along_line),u_is_variable_anchor:new s.bH(f,e.u_is_variable_anchor),u_texsize:new s.bM(f,e.u_texsize),u_texture:new s.bH(f,e.u_texture),u_gamma_scale:new s.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new s.b8(f,e.u_device_pixel_ratio),u_is_halo:new s.bH(f,e.u_is_halo),u_translation:new s.bM(f,e.u_translation),u_pitched_scale:new s.b8(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new s.bH(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bH(f,e.u_is_size_feature_constant),u_size_t:new s.b8(f,e.u_size_t),u_size:new s.b8(f,e.u_size),u_camera_to_center_distance:new s.b8(f,e.u_camera_to_center_distance),u_pitch:new s.b8(f,e.u_pitch),u_rotate_symbol:new s.bH(f,e.u_rotate_symbol),u_aspect_ratio:new s.b8(f,e.u_aspect_ratio),u_fade_change:new s.b8(f,e.u_fade_change),u_label_plane_matrix:new s.bJ(f,e.u_label_plane_matrix),u_coord_matrix:new s.bJ(f,e.u_coord_matrix),u_is_text:new s.bH(f,e.u_is_text),u_pitch_with_map:new s.bH(f,e.u_pitch_with_map),u_is_along_line:new s.bH(f,e.u_is_along_line),u_is_variable_anchor:new s.bH(f,e.u_is_variable_anchor),u_texsize:new s.bM(f,e.u_texsize),u_texsize_icon:new s.bM(f,e.u_texsize_icon),u_texture:new s.bH(f,e.u_texture),u_texture_icon:new s.bH(f,e.u_texture_icon),u_gamma_scale:new s.b8(f,e.u_gamma_scale),u_device_pixel_ratio:new s.b8(f,e.u_device_pixel_ratio),u_is_halo:new s.bH(f,e.u_is_halo),u_translation:new s.bM(f,e.u_translation),u_pitched_scale:new s.b8(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new s.b8(f,e.u_opacity),u_color:new s.bI(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new s.b8(f,e.u_opacity),u_image:new s.bH(f,e.u_image),u_pattern_tl_a:new s.bM(f,e.u_pattern_tl_a),u_pattern_br_a:new s.bM(f,e.u_pattern_br_a),u_pattern_tl_b:new s.bM(f,e.u_pattern_tl_b),u_pattern_br_b:new s.bM(f,e.u_pattern_br_b),u_texsize:new s.bM(f,e.u_texsize),u_mix:new s.b8(f,e.u_mix),u_pattern_size_a:new s.bM(f,e.u_pattern_size_a),u_pattern_size_b:new s.bM(f,e.u_pattern_size_b),u_scale_a:new s.b8(f,e.u_scale_a),u_scale_b:new s.b8(f,e.u_scale_b),u_pixel_coord_upper:new s.bM(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.bM(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new s.b8(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new s.bH(f,e.u_texture),u_ele_delta:new s.b8(f,e.u_ele_delta),u_fog_matrix:new s.bJ(f,e.u_fog_matrix),u_fog_color:new s.bI(f,e.u_fog_color),u_fog_ground_blend:new s.b8(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.b8(f,e.u_fog_ground_blend_opacity),u_horizon_color:new s.bI(f,e.u_horizon_color),u_horizon_fog_blend:new s.b8(f,e.u_horizon_fog_blend),u_is_globe_mode:new s.b8(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new s.b8(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new s.bH(f,e.u_texture),u_terrain_coords_id:new s.b8(f,e.u_terrain_coords_id),u_ele_delta:new s.b8(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new s.b8(f,e.u_input),u_output_expected:new s.b8(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new s.bL(f,e.u_sun_pos),u_atmosphere_blend:new s.b8(f,e.u_atmosphere_blend),u_globe_position:new s.bL(f,e.u_globe_position),u_globe_radius:new s.b8(f,e.u_globe_radius),u_inv_proj_matrix:new s.bJ(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new s.bI(f,e.u_sky_color),u_horizon_color:new s.bI(f,e.u_horizon_color),u_horizon:new s.bM(f,e.u_horizon),u_horizon_normal:new s.bM(f,e.u_horizon_normal),u_sky_horizon_blend:new s.b8(f,e.u_sky_horizon_blend),u_sky_blend:new s.b8(f,e.u_sky_blend)})};class Cc{constructor(e,n,u){this.context=e;let p=e.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let Da={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Td{constructor(e,n,u,p){this.length=n.length,this.attributes=u,this.itemSize=n.bytesPerElement,this.dynamicDraw=p,this.context=e;let g=e.gl;this.buffer=g.createBuffer(),e.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);let n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let u=0;u<this.attributes.length;u++){let p=n.attributes[this.attributes[u].name];p!==void 0&&e.enableVertexAttribArray(p)}}setVertexAttribPointers(e,n,u){for(let p=0;p<this.attributes.length;p++){let g=this.attributes[p],v=n.attributes[g.name];v!==void 0&&e.vertexAttribPointer(v,g.components,e[Da[g.type]],!1,this.itemSize,g.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ni{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vo extends ni{getDefault(){return s.b7.transparent}set(e){let n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Mc extends ni{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Gs extends ni{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Sc extends ni{getDefault(){return[!0,!0,!0,!0]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Id extends ni{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Pc extends ni{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class ps extends ni{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class yl extends ni{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Gu extends ni{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class Hu extends ni{getDefault(){return[0,1]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Zu extends ni{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class Wu extends ni{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Ec extends ni{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class kd extends ni{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ad extends ni{getDefault(){return s.b7.transparent}set(e){let n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class vl extends ni{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class bl extends ni{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class Ra extends ni{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Oa extends ni{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ms extends ni{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class xl extends ni{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Hs extends ni{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Ur extends ni{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class qu extends ni{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Xu extends ni{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Tc extends ni{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class fs extends ni{getDefault(){return null}set(e){let n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Fa extends ni{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;let u=this.gl;zn(u)?u.bindVertexArray(e):(n=u.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class wl extends ni{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class La extends ni{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Cl extends ni{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Ml extends ni{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class Zs extends Ml{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Ws extends Ml{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Dd extends Ml{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}let Sl="Framebuffer is not complete";class Ut{constructor(e,n,u,p,g){this.context=e,this.width=n,this.height=u;let v=e.gl,x=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new Zs(e,x),p)this.depthAttachment=g?new Dd(e,x):new Ws(e,x);else if(g)throw new Error("Stencil cannot be set without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error(Sl)}destroy(){let e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){let u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class io{constructor(e){var n,u;if(this.gl=e,this.clearColor=new vo(this),this.clearDepth=new Mc(this),this.clearStencil=new Gs(this),this.colorMask=new Sc(this),this.depthMask=new Id(this),this.stencilMask=new Pc(this),this.stencilFunc=new ps(this),this.stencilOp=new yl(this),this.stencilTest=new Gu(this),this.depthRange=new Hu(this),this.depthTest=new Zu(this),this.depthFunc=new Wu(this),this.blend=new Ec(this),this.blendFunc=new kd(this),this.blendColor=new Ad(this),this.blendEquation=new vl(this),this.cullFace=new bl(this),this.cullFaceSide=new Ra(this),this.frontFace=new Oa(this),this.program=new ms(this),this.activeTexture=new xl(this),this.viewport=new Hs(this),this.bindFramebuffer=new Ur(this),this.bindRenderbuffer=new qu(this),this.bindTexture=new Xu(this),this.bindVertexBuffer=new Tc(this),this.bindElementBuffer=new fs(this),this.bindVertexArray=new Fa(this),this.pixelStoreUnpack=new wl(this),this.pixelStoreUnpackPremultiplyAlpha=new La(this),this.pixelStoreUnpackFlipY=new Cl(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),zn(e)){this.HALF_FLOAT=e.HALF_FLOAT;let p=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:p?.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:p?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let p=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=p?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new Cc(this,e,n)}createVertexBuffer(e,n,u){return new Td(this,e,n,u)}createRenderbuffer(e,n,u){let p=this.gl,g=p.createRenderbuffer();return this.bindRenderbuffer.set(g),p.renderbufferStorage(p.RENDERBUFFER,e,n,u),this.bindRenderbuffer.set(null),g}createFramebuffer(e,n,u,p){return new Ut(this,e,n,u,p)}clear({color:e,depth:n,stencil:u}){let p=this.gl,g=0;e&&(g|=p.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(g|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),u!==void 0&&(g|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),p.clear(g)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){s.bE(e.blendFunction,ci.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return zn(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return zn(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let za;function Ic(f,e,n,u,p){let g=f.context,v=f.transform,x=g.gl,C=f.useProgram("collisionBox"),T=[],k=0,R=0;for(let ie=0;ie<u.length;ie++){let se=u[ie],ue=e.getTile(se).getBucket(n);if(!ue)continue;let de=p?ue.textCollisionBox:ue.iconCollisionBox,he=ue.collisionCircleArray;he.length>0&&(T.push({circleArray:he,circleOffset:R,coord:se}),k+=he.length/4,R=k),de&&C.draw(g,x.LINES,Et.disabled,Bt.disabled,f.colorModeForRenderPass(),Wt.disabled,vd(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(se),v.getProjectionData({overscaledTileID:se,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,f.transform.zoom,null,null,de.collisionVertexBuffer)}if(!p||!T.length)return;let D=f.useProgram("collisionCircle"),j=new s.bT;j.resize(4*k),j._trim();let U=0;for(let ie of T)for(let se=0;se<ie.circleArray.length/4;se++){let ue=4*se,de=ie.circleArray[ue+0],he=ie.circleArray[ue+1],_e=ie.circleArray[ue+2],pe=ie.circleArray[ue+3];j.emplace(U++,de,he,_e,pe,0),j.emplace(U++,de,he,_e,pe,1),j.emplace(U++,de,he,_e,pe,2),j.emplace(U++,de,he,_e,pe,3)}(!za||za.length<2*k)&&(za=function(ie){let se=2*ie,ue=new s.bV;ue.resize(se),ue._trim();for(let de=0;de<se;de++){let he=6*de;ue.uint16[he+0]=4*de+0,ue.uint16[he+1]=4*de+1,ue.uint16[he+2]=4*de+2,ue.uint16[he+3]=4*de+2,ue.uint16[he+4]=4*de+3,ue.uint16[he+5]=4*de+0}return ue}(k));let te=g.createIndexBuffer(za,!0),ee=g.createVertexBuffer(j,s.bU.members,!0);for(let ie of T){let se=ka(f.transform);D.draw(g,x.TRIANGLES,Et.disabled,Bt.disabled,f.colorModeForRenderPass(),Wt.disabled,se,f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie.coord),null,n.id,ee,te,s.aJ.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,f.transform.zoom,null,null,null)}ee.destroy(),te.destroy()}let Uo=s.ad(new Float32Array(16));function Yu(f,e,n,u,p,g){let{horizontalAlign:v,verticalAlign:x}=s.aE(f);return new s.P((-(v-.5)*e/p+u[0])*g,(-(x-.5)*n/p+u[1])*g)}function Ku(f,e,n,u,p,g){let v=e.tileAnchorPoint.add(new s.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let x=u.mult(g);n||(x=x.rotate(-p));let C=v.add(x);return De(C.x,C.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){let x=Ui(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),C=Math.atan(x.y/x.x)+(x.x<0?Math.PI:0);return f.add(u.rotate(C))}return f.add(u)}function Rd(f,e,n,u,p,g,v,x,C,T,k,R){let D=f.text.placedSymbolArray,j=f.text.dynamicLayoutVertexArray,U=f.icon.dynamicLayoutVertexArray,te={};j.clear();for(let ee=0;ee<D.length;ee++){let ie=D.get(ee),se=ie.hidden||!ie.crossTileID||f.allowVerticalPlacement&&!ie.placedOrientation?null:u[ie.crossTileID];if(se){let ue=new s.P(ie.anchorX,ie.anchorY),de={getElevation:R,width:p.width,height:p.height,pitchedLabelPlaneMatrix:g,pitchWithMap:n,transform:p,tileAnchorPoint:ue,translation:T,unwrappedTileID:k},he=n?zt(ue.x,ue.y,de):Ui(ue.x,ue.y,de),_e=ai(p.cameraToCenterDistance,he.signedDistanceFromCamera),pe=s.am(f.textSizeData,x,ie)*_e/s.ay;n&&(pe*=f.tilePixelRatio/v);let{width:Se,height:Be,anchor:ke,textOffset:Ae,textBoxScale:Re}=se,Je=Yu(ke,Se,Be,Ae,Re,pe),Ke=p.getPitchedTextCorrection(ue.x+T[0],ue.y+T[1],k),He=Ku(he.point,de,e,Je,-p.bearingInRadians,Ke),ct=f.allowVerticalPlacement&&ie.placedOrientation===s.al.vertical?Math.PI/2:0;for(let Nt=0;Nt<ie.numGlyphs;Nt++)s.as(j,He,ct);C&&ie.associatedIconIndex>=0&&(te[ie.associatedIconIndex]={shiftedAnchor:He,angle:ct})}else _r(ie.numGlyphs,j)}if(C){U.clear();let ee=f.icon.placedSymbolArray;for(let ie=0;ie<ee.length;ie++){let se=ee.get(ie);if(se.hidden)_r(se.numGlyphs,U);else{let ue=te[ie];if(ue)for(let de=0;de<se.numGlyphs;de++)s.as(U,ue.shiftedAnchor,ue.angle);else _r(se.numGlyphs,U)}}f.icon.dynamicLayoutVertexBuffer.updateData(U)}f.text.dynamicLayoutVertexBuffer.updateData(j)}function Od(f,e,n){return n.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Pl(f,e,n,u,p,g,v,x,C,T,k,R,D){let j=f.context,U=j.gl,te=f.transform,ee=x==="map",ie=C==="map",se=x!=="viewport"&&n.layout.get("symbol-placement")!=="point",ue=ee&&!ie&&!se,de=!n.layout.get("symbol-sort-key").isConstant(),he=!1,_e=f.getDepthModeForSublayer(0,Et.ReadOnly),pe=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Se=[],Be=te.getCircleRadiusCorrection();for(let ke of u){let Ae=e.getTile(ke),Re=Ae.getBucket(n);if(!Re)continue;let Je=p?Re.text:Re.icon;if(!Je||!Je.segments.get().length||!Je.hasVisibleVertices)continue;let Ke=Je.programConfigurations.get(n.id),He=p||Re.sdfIcons,ct=p?Re.textSizeData:Re.iconSizeData,Nt=ie||te.pitch!==0,ii=f.useProgram(Od(He,p,Re),Ke),qi=s.ak(ct,te.zoom),Ei=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ke),Xi,Yi,Ai,fi,In=[0,0],Nn=null;if(p)Yi=Ae.glyphAtlasTexture,Ai=U.LINEAR,Xi=Ae.glyphAtlasTexture.size,Re.iconsInText&&(In=Ae.imageAtlasTexture.size,Nn=Ae.imageAtlasTexture,fi=Nt||f.options.rotating||f.options.zooming||ct.kind==="composite"||ct.kind==="camera"?U.LINEAR:U.NEAREST);else{let _n=n.layout.get("icon-size").constantOr(0)!==1||Re.iconsNeedLinear;Yi=Ae.imageAtlasTexture,Ai=He||f.options.rotating||f.options.zooming||_n||Nt?U.LINEAR:U.NEAREST,Xi=Ae.imageAtlasTexture.size}let Yn=s.az(Ae,1,f.transform.zoom),gi=gt(ee,f.transform,Yn),Xs=s.K();s.an(Xs,gi);let Zo=Dt(ie,ee,f.transform,Yn),Ys=s.aA(te,Ae,g,v),Ha=te.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),Bc=pe&&Re.hasTextData(),Ks=n.layout.get("icon-text-fit")!=="none"&&Bc&&Re.hasIconData();if(se){let _n=f.style.map.terrain?(br,zi)=>f.style.map.terrain.getElevation(ke,br,zi):null,yn=n.layout.get("text-rotation-alignment")==="map";li(Re,f,p,gi,Xs,ie,T,yn,ke.toUnwrapped(),te.width,te.height,Ys,_n)}let Za=p&&pe||Ks,$r=se||Za?Uo:ie?gi:f.transform.clipSpaceToPixelsMatrix,Qs=He&&n.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0,vs;vs=He?Re.iconsInText?Aa(ct.kind,qi,ue,ie,se,Za,f,$r,Zo,Ys,Xi,In,Be):Sd(ct.kind,qi,ue,ie,se,Za,f,$r,Zo,Ys,p,Xi,0,Be):$s(ct.kind,qi,ue,ie,se,Za,f,$r,Zo,Ys,p,Xi,Be);let Js={program:ii,buffers:Je,uniformValues:vs,projectionData:Ha,atlasTexture:Yi,atlasTextureIcon:Nn,atlasInterpolation:Ai,atlasInterpolationIcon:fi,isSDF:He,hasHalo:Qs};if(de&&Re.canOverlap){he=!0;let _n=Je.segments.get();for(let yn of _n)Se.push({segments:new s.aJ([yn]),sortKey:yn.sortKey,state:Js,terrainData:Ei})}else Se.push({segments:Je.segments,sortKey:0,state:Js,terrainData:Ei})}he&&Se.sort((ke,Ae)=>ke.sortKey-Ae.sortKey);for(let ke of Se){let Ae=ke.state;if(j.activeTexture.set(U.TEXTURE0),Ae.atlasTexture.bind(Ae.atlasInterpolation,U.CLAMP_TO_EDGE),Ae.atlasTextureIcon&&(j.activeTexture.set(U.TEXTURE1),Ae.atlasTextureIcon&&Ae.atlasTextureIcon.bind(Ae.atlasInterpolationIcon,U.CLAMP_TO_EDGE)),Ae.isSDF){let Re=Ae.uniformValues;Ae.hasHalo&&(Re.u_is_halo=1,Ba(Ae.buffers,ke.segments,n,f,Ae.program,_e,k,R,Re,Ae.projectionData,ke.terrainData)),Re.u_is_halo=0}Ba(Ae.buffers,ke.segments,n,f,Ae.program,_e,k,R,Ae.uniformValues,Ae.projectionData,ke.terrainData)}}function Ba(f,e,n,u,p,g,v,x,C,T,k){let R=u.context;p.draw(R,R.gl.TRIANGLES,g,v,x,Wt.backCCW,C,k,T,n.id,f.layoutVertexBuffer,f.indexBuffer,e,n.paint,u.transform.zoom,f.programConfigurations.get(n.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function El(f,e,n,u,p){let g=f.context,v=g.gl,x=Bt.disabled,C=new ci([v.ONE,v.ONE],s.b7.transparent,[!0,!0,!0,!0]),T=e.getBucket(n);if(!T)return;let k=u.key,R=n.heatmapFbos.get(k);R||(R=gs(g,e.tileSize,e.tileSize),n.heatmapFbos.set(k,R)),g.bindFramebuffer.set(R.framebuffer),g.viewport.set([0,0,e.tileSize,e.tileSize]),g.clear({color:s.b7.transparent});let D=T.programConfigurations.get(n.id),j=f.useProgram("heatmap",D,!p),U=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),te=f.style.map.terrain.getTerrainData(u);j.draw(g,v.TRIANGLES,Et.disabled,x,C,Wt.disabled,jo(e,f.transform.zoom,n.paint.get("heatmap-intensity"),1),te,U,n.id,T.layoutVertexBuffer,T.indexBuffer,T.segments,n.paint,f.transform.zoom,D)}function kr(f,e,n,u,p){let g=f.context,v=g.gl,x=f.transform;g.setColorMode(f.colorModeForRenderPass());let C=Hi(g,e),T=n.key,k=e.heatmapFbos.get(T);if(!k)return;g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,k.colorAttachment.get()),g.activeTexture.set(v.TEXTURE1),C.bind(v.LINEAR,v.CLAMP_TO_EDGE);let R=x.getProjectionData({overscaledTileID:n,applyTerrainMatrix:p,applyGlobeMatrix:!u});f.useProgram("heatmapTexture").draw(g,v.TRIANGLES,Et.disabled,Bt.disabled,f.colorModeForRenderPass(),Wt.disabled,vc(f,e,0,1),null,R,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,x.zoom),k.destroy(),e.heatmapFbos.delete(T)}function gs(f,e,n){var u,p;let g=f.gl,v=g.createTexture();g.bindTexture(g.TEXTURE_2D,v),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);let x=(u=f.HALF_FLOAT)!==null&&u!==void 0?u:g.UNSIGNED_BYTE,C=(p=f.RGBA16F)!==null&&p!==void 0?p:g.RGBA;g.texImage2D(g.TEXTURE_2D,0,C,e,n,0,g.RGBA,x,null);let T=f.createFramebuffer(e,n,!1,!1);return T.colorAttachment.set(v),T}function Hi(f,e){return e.colorRampTexture||(e.colorRampTexture=new pi(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function Na(f,e,n,u,p){if(!n||!u||!u.imageAtlas)return;let g=u.imageAtlas.patternPositions,v=g[n.to.toString()],x=g[n.from.toString()];if(!v&&x&&(v=x),!x&&v&&(x=v),!v||!x){let C=p.getPaintProperty(e);v=g[C],x=g[C]}v&&x&&f.setConstantPatternPositions(v,x)}function Va(f,e,n,u,p,g,v,x){let C=f.context.gl,T="fill-pattern",k=n.paint.get(T),R=k&&k.constantOr(1),D=n.getCrossfadeParameters(),j,U,te,ee,ie,se=f.transform,ue=n.paint.get("fill-translate"),de=n.paint.get("fill-translate-anchor");v?(U=R&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=C.LINES):(U=R?"fillPattern":"fill",j=C.TRIANGLES);let he=k.constantOr(null);for(let _e of u){let pe=e.getTile(_e);if(R&&!pe.patternsLoaded())continue;let Se=pe.getBucket(n);if(!Se)continue;let Be=Se.programConfigurations.get(n.id),ke=f.useProgram(U,Be),Ae=f.style.map.terrain&&f.style.map.terrain.getTerrainData(_e);R&&(f.context.activeTexture.set(C.TEXTURE0),pe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Be.updatePaintBuffers(D)),Na(Be,T,he,pe,n);let Re=se.getProjectionData({overscaledTileID:_e,applyGlobeMatrix:!x,applyTerrainMatrix:!0}),Je=s.aA(se,pe,ue,de);if(v){ee=Se.indexBuffer2,ie=Se.segments2;let He=[C.drawingBufferWidth,C.drawingBufferHeight];te=U==="fillOutlinePattern"&&R?Ia(f,D,pe,He,Je):js(He,Je)}else ee=Se.indexBuffer,ie=Se.segments,te=R?fl(f,D,pe,Je):{u_fill_translate:Je};let Ke=f.stencilModeForClipping(_e);ke.draw(f.context,j,p,Ke,g,Wt.backCCW,te,Ae,Re,n.id,Se.layoutVertexBuffer,ee,ie,n.paint,f.transform.zoom,Be)}}function ja(f,e,n,u,p,g,v,x){let C=f.context,T=C.gl,k="fill-extrusion-pattern",R=n.paint.get(k),D=R.constantOr(1),j=n.getCrossfadeParameters(),U=n.paint.get("fill-extrusion-opacity"),te=R.constantOr(null),ee=f.transform;for(let ie of u){let se=e.getTile(ie),ue=se.getBucket(n);if(!ue)continue;let de=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie),he=ue.programConfigurations.get(n.id),_e=f.useProgram(D?"fillExtrusionPattern":"fillExtrusion",he);D&&(f.context.activeTexture.set(T.TEXTURE0),se.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),he.updatePaintBuffers(j));let pe=ee.getProjectionData({overscaledTileID:ie,applyGlobeMatrix:!x,applyTerrainMatrix:!0});Na(he,k,te,se,n);let Se=s.aA(ee,se,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Be=n.paint.get("fill-extrusion-vertical-gradient"),ke=D?jr(f,Be,U,Se,ie,j,se):Ta(f,Be,U,Se);_e.draw(C,C.gl.TRIANGLES,p,g,v,Wt.backCCW,ke,de,pe,n.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,n.paint,f.transform.zoom,he,f.style.map.terrain&&ue.centroidVertexBuffer)}}function kc(f,e,n,u,p,g,v,x,C){var T;let k=f.style.projection,R=f.context,D=f.transform,j=R.gl,U=[`#define NUM_ILLUMINATION_SOURCES ${n.paint.get("hillshade-highlight-color").values.length}`],te=f.useProgram("hillshade",null,!1,U),ee=!f.options.moving;for(let ie of u){let se=e.getTile(ie),ue=se.fbo;if(!ue)continue;let de=k.getMeshFromTileID(R,ie.canonical,x,!0,"raster"),he=(T=f.style.map.terrain)===null||T===void 0?void 0:T.getTerrainData(ie);R.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,ue.colorAttachment.get());let _e=D.getProjectionData({overscaledTileID:ie,aligned:ee,applyGlobeMatrix:!C,applyTerrainMatrix:!0});te.draw(R,j.TRIANGLES,g,p[ie.overscaledZ],v,Wt.backCCW,bc(f,se,n),he,_e,n.id,de.vertexBuffer,de.indexBuffer,de.segments)}}let Ua=[new s.P(0,0),new s.P(s.Z,0),new s.P(s.Z,s.Z),new s.P(0,s.Z)];function Tl(f,e,n,u,p,g,v,x,C=!1,T=!1){let k=u[u.length-1].overscaledZ,R=f.context,D=R.gl,j=f.useProgram("raster"),U=f.transform,te=f.style.projection,ee=f.colorModeForRenderPass(),ie=!f.options.moving;for(let se of u){let ue=f.getDepthModeForSublayer(se.overscaledZ-k,n.paint.get("raster-opacity")===1?Et.ReadWrite:Et.ReadOnly,D.LESS),de=e.getTile(se);de.registerFadeDuration(n.paint.get("raster-fade-duration"));let he=e.findLoadedParent(se,0),_e=e.findLoadedSibling(se),pe=Fd(de,he||_e||null,e,n,f.transform,f.style.map.terrain),Se,Be,ke=n.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;R.activeTexture.set(D.TEXTURE0),de.texture.bind(ke,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(D.TEXTURE1),he?(he.texture.bind(ke,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Se=Math.pow(2,he.tileID.overscaledZ-de.tileID.overscaledZ),Be=[de.tileID.canonical.x*Se%1,de.tileID.canonical.y*Se%1]):de.texture.bind(ke,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),de.texture.useMipmap&&R.extTextureFilterAnisotropic&&f.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);let Ae=f.style.map.terrain&&f.style.map.terrain.getTerrainData(se),Re=U.getProjectionData({overscaledTileID:se,aligned:ie,applyGlobeMatrix:!T,applyTerrainMatrix:!0}),Je=wc(Be||[0,0],Se||1,pe,n,x),Ke=te.getMeshFromTileID(R,se.canonical,g,v,"raster");j.draw(R,D.TRIANGLES,ue,p?p[se.overscaledZ]:Bt.disabled,ee,C?Wt.frontCCW:Wt.backCCW,Je,Ae,Re,n.id,Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}}function Fd(f,e,n,u,p,g){let v=u.paint.get("raster-fade-duration");if(!g&&v>0){let x=ve.now(),C=(x-f.timeAdded)/v,T=e?(x-e.timeAdded)/v:-1,k=n.getSource(),R=Me(p,{tileSize:k.tileSize,roundZoom:k.roundZoom}),D=!e||Math.abs(e.tileID.overscaledZ-R)>Math.abs(f.tileID.overscaledZ-R),j=D&&f.refreshedUponExpiration?1:s.ae(D?C:1-T,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}let Il=new s.b7(1,0,0,1),qs=new s.b7(0,1,0,1),M=new s.b7(0,0,1,1),E=new s.b7(1,0,1,1),z=new s.b7(0,1,1,1);function oe(f,e,n,u){it(f,0,e+n/2,f.transform.width,n,u)}function Fe(f,e,n,u){it(f,e-n/2,0,n,f.transform.height,u)}function it(f,e,n,u,p,g){let v=f.context,x=v.gl;x.enable(x.SCISSOR_TEST),x.scissor(e*f.pixelRatio,n*f.pixelRatio,u*f.pixelRatio,p*f.pixelRatio),v.clear({color:g}),x.disable(x.SCISSOR_TEST)}function xt(f,e,n){let u=f.context,p=u.gl,g=f.useProgram("debug"),v=Et.disabled,x=Bt.disabled,C=f.colorModeForRenderPass(),T="$debug",k=f.style.map.terrain&&f.style.map.terrain.getTerrainData(n);u.activeTexture.set(p.TEXTURE0);let R=e.getTileByID(n.key).latestRawTileData,D=Math.floor((R&&R.byteLength||0)/1024),j=e.getTile(n).tileSize,U=512/Math.min(j,512)*(n.overscaledZ/f.transform.zoom)*.5,te=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(te+=` => ${n.overscaledZ}`),function(ie,se){ie.initDebugOverlayCanvas();let ue=ie.debugOverlayCanvas,de=ie.context.gl,he=ie.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,ue.width,ue.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(se,5,5),he.strokeText(se,5,5),ie.debugOverlayTexture.update(ue),ie.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(f,`${te} ${D}kB`);let ee=f.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(u,p.TRIANGLES,v,x,ci.alphaBlended,Wt.disabled,yc(s.b7.transparent,U),null,ee,T,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),g.draw(u,p.LINE_STRIP,v,x,C,Wt.disabled,yc(s.b7.red),k,ee,T,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function ti(f,e,n,u){let{isRenderingGlobe:p}=u,g=f.context,v=g.gl,x=f.transform,C=f.colorModeForRenderPass(),T=f.getDepthModeFor3D(),k=f.useProgram("terrain");g.bindFramebuffer.set(null),g.viewport.set([0,0,f.width,f.height]);for(let R of n){let D=e.getTerrainMesh(R.tileID),j=f.renderToTexture.getTexture(R),U=e.getTerrainData(R.tileID);g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,j.texture);let te=e.getMeshFrameDelta(x.zoom),ee=x.calculateFogMatrix(R.tileID.toUnwrapped()),ie=Uu(te,ee,f.style.sky,x.pitch,p),se=x.getProjectionData({overscaledTileID:R.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(g,v.TRIANGLES,T,Bt.disabled,C,Wt.backCCW,ie,U,se,"terrain",D.vertexBuffer,D.indexBuffer,D.segments)}}function ri(f,e){if(!e.mesh){let n=new s.aI;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);let u=new s.aK;u.emplaceBack(0,1,2),u.emplaceBack(0,2,3),e.mesh=new Ls(f.createVertexBuffer(n,Ln.members),f.createIndexBuffer(u),s.aJ.simpleSegment(0,0,n.length,u.length))}return e.mesh}class $o{constructor(e,n){this.context=new io(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ce.maxUnderzooming+Ce.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _a}resize(e,n,u){if(this.width=Math.floor(e*u),this.height=Math.floor(n*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let p of this.style._order)this.style._layers[p].resize()}setup(){let e=this.context,n=new s.aI;n.emplaceBack(0,0),n.emplaceBack(s.Z,0),n.emplaceBack(0,s.Z),n.emplaceBack(s.Z,s.Z),this.tileExtentBuffer=e.createVertexBuffer(n,Ln.members),this.tileExtentSegments=s.aJ.simpleSegment(0,0,4,2);let u=new s.aI;u.emplaceBack(0,0),u.emplaceBack(s.Z,0),u.emplaceBack(0,s.Z),u.emplaceBack(s.Z,s.Z),this.debugBuffer=e.createVertexBuffer(u,Ln.members),this.debugSegments=s.aJ.simpleSegment(0,0,4,5);let p=new s.b_;p.emplaceBack(0,0,0,0),p.emplaceBack(s.Z,0,s.Z,0),p.emplaceBack(0,s.Z,0,s.Z),p.emplaceBack(s.Z,s.Z,s.Z,s.Z),this.rasterBoundsBuffer=e.createVertexBuffer(p,yd.members),this.rasterBoundsSegments=s.aJ.simpleSegment(0,0,4,2);let g=new s.aI;g.emplaceBack(0,0),g.emplaceBack(s.Z,0),g.emplaceBack(0,s.Z),g.emplaceBack(s.Z,s.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(g,Ln.members),this.rasterBoundsSegmentsPosOnly=s.aJ.simpleSegment(0,0,4,5);let v=new s.aI;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(v,Ln.members),this.viewportSegments=s.aJ.simpleSegment(0,0,4,2);let x=new s.b$;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(x);let C=new s.aK;C.emplaceBack(1,0,2),C.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(C);let T=this.context.gl;this.stencilClearMode=new Bt({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO),this.tileExtentMesh=new Ls(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){let e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let u=s.K();s.bQ(u,0,this.width,this.height,0,0,1),s.M(u,u,[n.drawingBufferWidth,n.drawingBufferHeight,0]);let p={mainMatrix:u,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:u};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,Et.disabled,this.stencilClearMode,ci.disabled,Wt.disabled,null,null,p,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,u){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();let p=this.context;p.setColorMode(ci.disabled),p.setDepthMode(Et.disabled);let g={};for(let v of n)g[v.key]=this.nextStencilID++;this._renderTileMasks(g,n,u,!0),this._renderTileMasks(g,n,u,!1),this._tileClippingMaskIDs=g}_renderTileMasks(e,n,u,p){let g=this.context,v=g.gl,x=this.style.projection,C=this.transform,T=this.useProgram("clippingMask");for(let k of n){let R=e[k.key],D=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),j=x.getMeshFromTileID(this.context,k.canonical,p,!0,"stencil"),U=C.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!u,applyTerrainMatrix:!0});T.draw(g,v.TRIANGLES,Et.disabled,new Bt({func:v.ALWAYS,mask:0},R,255,v.KEEP,v.KEEP,v.REPLACE),ci.disabled,u?Wt.disabled:Wt.backCCW,null,D,U,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}_renderTilesDepthBuffer(){let e=this.context,n=e.gl,u=this.style.projection,p=this.transform,g=this.useProgram("depth"),v=this.getDepthModeFor3D(),x=ye(p,{tileSize:p.tileSize});for(let C of x){let T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(C),k=u.getMeshFromTileID(this.context,C.canonical,!0,!0,"raster"),R=p.getProjectionData({overscaledTileID:C,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(e,n.TRIANGLES,v,Bt.disabled,ci.disabled,Wt.backCCW,null,T,R,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,n=this.context.gl;return new Bt({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){let n=this.context.gl;return new Bt({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){let n=this.context.gl,u=e.sort((v,x)=>x.overscaledZ-v.overscaledZ),p=u[u.length-1].overscaledZ,g=u[0].overscaledZ-p+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();let v={};for(let x=0;x<g;x++)v[x+p]=new Bt({func:n.GEQUAL,mask:255},x+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=g,[v,u]}return[{[p]:Bt.disabled},u]}stencilConfigForOverlapTwoPass(e){let n=this.context.gl,u=e.sort((v,x)=>x.overscaledZ-v.overscaledZ),p=u[u.length-1].overscaledZ,g=u[0].overscaledZ-p+1;if(this.clearStencil(),g>1){let v={},x={};for(let C=0;C<g;C++)v[C+p]=new Bt({func:n.GREATER,mask:255},g+1+C,255,n.KEEP,n.KEEP,n.REPLACE),x[C+p]=new Bt({func:n.GREATER,mask:255},1+C,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*g+1,[v,x,u]}return this.nextStencilID=3,[{[p]:new Bt({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[p]:new Bt({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},u]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new ci([e.CONSTANT_COLOR,e.ONE],new s.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ci.unblended:ci.alphaBlended}getDepthModeForSublayer(e,n,u){if(!this.opaquePassEnabledForLayer())return Et.disabled;let p=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Et(u||this.context.gl.LEQUAL,n,[p,p])}getDepthModeFor3D(){return new Et(this.context.gl.LEQUAL,Et.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var u,p;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(ve.now()),this.imageManager.beginFrame();let g=this.style._order,v=this.style.sourceCaches,x={},C={},T={},k={isRenderingToTexture:!1,isRenderingGlobe:((u=e.projection)===null||u===void 0?void 0:u.transitionState)>0};for(let D in v){let j=v[D];j.used&&j.prepare(this.context),x[D]=j.getVisibleCoordinates(!1),C[D]=x[D].slice().reverse(),T[D]=j.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let D=0;D<g.length;D++)if(this.style._layers[g[D]].is3D()){this.opaquePassCutoff=D;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let D of g){let j=this.style._layers[D];if(!j.hasOffscreenPass()||j.isHidden(this.transform.zoom))continue;let U=C[j.source];(j.type==="custom"||U.length)&&this.renderLayer(this,v[j.source],j,U,k)}if((p=this.style.projection)===null||p===void 0||p.updateGPUdependent({context:this.context,useProgram:D=>this.useProgram(D)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?s.b7.black:s.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(D,j){let U=D.context,te=U.gl,ee=((_e,pe,Se)=>{let Be=Math.cos(pe.rollInRadians),ke=Math.sin(pe.rollInRadians),Ae=xe(pe),Re=pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:_e.properties.get("sky-color"),u_horizon_color:_e.properties.get("horizon-color"),u_horizon:[(pe.width/2-Ae*ke)*Se,(pe.height/2+Ae*Be)*Se],u_horizon_normal:[-ke,Be],u_sky_horizon_blend:_e.properties.get("sky-horizon-blend")*pe.height/2*Se,u_sky_blend:Re}})(j,D.style.map.transform,D.pixelRatio),ie=new Et(te.LEQUAL,Et.ReadWrite,[0,1]),se=Bt.disabled,ue=D.colorModeForRenderPass(),de=D.useProgram("sky"),he=ri(U,j);de.draw(U,te.TRIANGLES,ie,se,ue,Wt.disabled,ee,null,void 0,"sky",he.vertexBuffer,he.indexBuffer,he.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){let D=this.style._layers[g[this.currentLayer]],j=v[D.source],U=x[D.source];this._renderTileClippingMasks(D,U,!1),this.renderLayer(this,j,D,U,k)}this.renderPass="translucent";let R=!1;for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){let D=this.style._layers[g[this.currentLayer]],j=v[D.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(D,k))continue;this.opaquePassEnabledForLayer()||R||(R=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());let U=(D.type==="symbol"?T:C)[D.source];this._renderTileClippingMasks(D,x[D.source],!!this.renderToTexture),this.renderLayer(this,j,D,U,k)}if(k.isRenderingGlobe&&function(D,j,U){let te=D.context,ee=te.gl,ie=D.useProgram("atmosphere"),se=new Et(ee.LEQUAL,Et.ReadOnly,[0,1]),ue=D.transform,de=function(Re,Je){let Ke=Re.properties.get("position"),He=[-Ke.x,-Ke.y,-Ke.z],ct=s.ad(new Float64Array(16));return Re.properties.get("anchor")==="map"&&(s.a_(ct,ct,Je.rollInRadians),s.a$(ct,ct,-Je.pitchInRadians),s.a_(ct,ct,Je.bearingInRadians),s.a$(ct,ct,Je.center.lat*Math.PI/180),s.bp(ct,ct,-Je.center.lng*Math.PI/180)),s.bZ(He,He,ct),He}(U,D.transform),he=ue.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),_e=j.properties.get("atmosphere-blend")*he.projectionTransition;if(_e===0)return;let pe=No(ue.worldSize,ue.center.lat),Se=ue.inverseProjectionMatrix,Be=new Float64Array(4);Be[3]=1,s.at(Be,Be,ue.modelViewProjectionMatrix),Be[0]/=Be[3],Be[1]/=Be[3],Be[2]/=Be[3],Be[3]=1,s.at(Be,Be,Se),Be[0]/=Be[3],Be[1]/=Be[3],Be[2]/=Be[3],Be[3]=1;let ke=((Re,Je,Ke,He,ct)=>({u_sun_pos:Re,u_atmosphere_blend:Je,u_globe_position:Ke,u_globe_radius:He,u_inv_proj_matrix:ct}))(de,_e,[Be[0],Be[1],Be[2]],pe,Se),Ae=ri(te,j);ie.draw(te,ee.TRIANGLES,se,Bt.disabled,ci.alphaBlended,Wt.disabled,ke,null,null,"atmosphere",Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){let D=function(j,U){let te=null,ee=Object.values(j._layers).flatMap(de=>de.source&&!de.isHidden(U)?[j.sourceCaches[de.source]]:[]),ie=ee.filter(de=>de.getSource().type==="vector"),se=ee.filter(de=>de.getSource().type!=="vector"),ue=de=>{(!te||te.getSource().maxzoom<de.getSource().maxzoom)&&(te=de)};return ie.forEach(de=>ue(de)),te||se.forEach(de=>ue(de)),te}(this.style,this.transform.zoom);D&&function(j,U,te){for(let ee=0;ee<te.length;ee++)xt(j,U,te[ee])}(this,D,D.getVisibleCoordinates())}this.options.showPadding&&function(D){let j=D.transform.padding;oe(D,D.transform.height-(j.top||0),3,Il),oe(D,j.bottom||0,3,qs),Fe(D,j.left||0,3,M),Fe(D,D.transform.width-(j.right||0),3,E);let U=D.transform.centerPoint;(function(te,ee,ie,se){it(te,ee-1,ie-10,2,20,se),it(te,ee-10,ie-1,20,2,se)})(D,U.x,D.transform.height-U.y,z)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let n=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix,p=this.terrainFacilitator.dirty;p||(p=e?!s.c0(n,u):!s.c1(n,u)),p||(p=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),p&&(s.c2(n,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(g,v){let x=g.context,C=x.gl,T=g.transform,k=ci.unblended,R=new Et(C.LEQUAL,Et.ReadWrite,[0,1]),D=v.sourceCache.getRenderableTiles(),j=g.useProgram("terrainDepth");x.bindFramebuffer.set(v.getFramebuffer("depth").framebuffer),x.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),x.clear({color:s.b7.transparent,depth:1});for(let U of D){let te=v.getTerrainMesh(U.tileID),ee=v.getTerrainData(U.tileID),ie=T.getProjectionData({overscaledTileID:U.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),se={u_ele_delta:v.getMeshFrameDelta(T.zoom)};j.draw(x,C.TRIANGLES,R,Bt.disabled,k,Wt.backCCW,se,ee,ie,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}x.bindFramebuffer.set(null),x.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain),function(g,v){let x=g.context,C=x.gl,T=g.transform,k=ci.unblended,R=new Et(C.LEQUAL,Et.ReadWrite,[0,1]),D=v.getCoordsTexture(),j=v.sourceCache.getRenderableTiles(),U=g.useProgram("terrainCoords");x.bindFramebuffer.set(v.getFramebuffer("coords").framebuffer),x.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),x.clear({color:s.b7.transparent,depth:1}),v.coordsIndex=[];for(let te of j){let ee=v.getTerrainMesh(te.tileID),ie=v.getTerrainData(te.tileID);x.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,D.texture);let se={u_terrain_coords_id:(255-v.coordsIndex.length)/255,u_texture:0,u_ele_delta:v.getMeshFrameDelta(T.zoom)},ue=T.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(x,C.TRIANGLES,R,Bt.disabled,k,Wt.backCCW,se,ie,ue,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),v.coordsIndex.push(te.tileID.key)}x.bindFramebuffer.set(null),x.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain))}renderLayer(e,n,u,p,g){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(p||[]).length)&&(this.id=u.id,s.c3(u)?function(v,x,C,T,k,R){if(v.renderPass!=="translucent")return;let{isRenderingToTexture:D}=R,j=Bt.disabled,U=v.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(te,ee,ie,se,ue,de,he,_e,pe){let Se=ee.transform,Be=ee.style.map.terrain,ke=ue==="map",Ae=de==="map";for(let Re of te){let Je=se.getTile(Re),Ke=Je.getBucket(ie);if(!Ke||!Ke.text||!Ke.text.segments.get().length)continue;let He=s.ak(Ke.textSizeData,Se.zoom),ct=s.az(Je,1,ee.transform.zoom),Nt=gt(ke,ee.transform,ct),ii=ie.layout.get("icon-text-fit")!=="none"&&Ke.hasIconData();if(He){let qi=Math.pow(2,Se.zoom-Je.tileID.overscaledZ),Ei=Be?(Xi,Yi)=>Be.getElevation(Re,Xi,Yi):null;Rd(Ke,ke,Ae,pe,Se,Nt,qi,He,ii,s.aA(Se,Je,he,_e),Re.toUnwrapped(),Ei)}}}(T,v,C,x,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),k),C.paint.get("icon-opacity").constantOr(1)!==0&&Pl(v,x,C,T,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),j,U,D),C.paint.get("text-opacity").constantOr(1)!==0&&Pl(v,x,C,T,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),j,U,D),x.map.showCollisionBoxes&&(Ic(v,x,C,T,!0),Ic(v,x,C,T,!1))}(e,n,u,p,this.style.placement.variableOffsets,g):s.c4(u)?function(v,x,C,T,k){if(v.renderPass!=="translucent")return;let{isRenderingToTexture:R}=k,D=C.paint.get("circle-opacity"),j=C.paint.get("circle-stroke-width"),U=C.paint.get("circle-stroke-opacity"),te=!C.layout.get("circle-sort-key").isConstant();if(D.constantOr(1)===0&&(j.constantOr(1)===0||U.constantOr(1)===0))return;let ee=v.context,ie=ee.gl,se=v.transform,ue=v.getDepthModeForSublayer(0,Et.ReadOnly),de=Bt.disabled,he=v.colorModeForRenderPass(),_e=[],pe=se.getCircleRadiusCorrection();for(let Se=0;Se<T.length;Se++){let Be=T[Se],ke=x.getTile(Be),Ae=ke.getBucket(C);if(!Ae)continue;let Re=C.paint.get("circle-translate"),Je=C.paint.get("circle-translate-anchor"),Ke=s.aA(se,ke,Re,Je),He=Ae.programConfigurations.get(C.id),ct=v.useProgram("circle",He),Nt=Ae.layoutVertexBuffer,ii=Ae.indexBuffer,qi=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Be),Ei={programConfiguration:He,program:ct,layoutVertexBuffer:Nt,indexBuffer:ii,uniformValues:Us(v,ke,C,Ke,pe),terrainData:qi,projectionData:se.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!R,applyTerrainMatrix:!0})};if(te){let Xi=Ae.segments.get();for(let Yi of Xi)_e.push({segments:new s.aJ([Yi]),sortKey:Yi.sortKey,state:Ei})}else _e.push({segments:Ae.segments,sortKey:0,state:Ei})}te&&_e.sort((Se,Be)=>Se.sortKey-Be.sortKey);for(let Se of _e){let{programConfiguration:Be,program:ke,layoutVertexBuffer:Ae,indexBuffer:Re,uniformValues:Je,terrainData:Ke,projectionData:He}=Se.state;ke.draw(ee,ie.TRIANGLES,ue,de,he,Wt.backCCW,Je,Ke,He,C.id,Ae,Re,Se.segments,C.paint,v.transform.zoom,Be)}}(e,n,u,p,g):s.c5(u)?function(v,x,C,T,k){if(C.paint.get("heatmap-opacity")===0)return;let R=v.context,{isRenderingToTexture:D,isRenderingGlobe:j}=k;if(v.style.map.terrain){for(let U of T){let te=x.getTile(U);x.hasRenderableParent(U)||(v.renderPass==="offscreen"?El(v,te,C,U,j):v.renderPass==="translucent"&&kr(v,C,U,D,j))}R.viewport.set([0,0,v.width,v.height])}else v.renderPass==="offscreen"?function(U,te,ee,ie){let se=U.context,ue=se.gl,de=U.transform,he=Bt.disabled,_e=new ci([ue.ONE,ue.ONE],s.b7.transparent,[!0,!0,!0,!0]);(function(pe,Se,Be){let ke=pe.gl;pe.activeTexture.set(ke.TEXTURE1),pe.viewport.set([0,0,Se.width/4,Se.height/4]);let Ae=Be.heatmapFbos.get(s.bW);Ae?(ke.bindTexture(ke.TEXTURE_2D,Ae.colorAttachment.get()),pe.bindFramebuffer.set(Ae.framebuffer)):(Ae=gs(pe,Se.width/4,Se.height/4),Be.heatmapFbos.set(s.bW,Ae))})(se,U,ee),se.clear({color:s.b7.transparent});for(let pe=0;pe<ie.length;pe++){let Se=ie[pe];if(te.hasRenderableParent(Se))continue;let Be=te.getTile(Se),ke=Be.getBucket(ee);if(!ke)continue;let Ae=ke.programConfigurations.get(ee.id),Re=U.useProgram("heatmap",Ae),Je=de.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Ke=de.getCircleRadiusCorrection();Re.draw(se,ue.TRIANGLES,Et.disabled,he,_e,Wt.backCCW,jo(Be,de.zoom,ee.paint.get("heatmap-intensity"),Ke),null,Je,ee.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,ee.paint,de.zoom,Ae)}se.viewport.set([0,0,U.width,U.height])}(v,x,C,T):v.renderPass==="translucent"&&function(U,te){let ee=U.context,ie=ee.gl;ee.setColorMode(U.colorModeForRenderPass());let se=te.heatmapFbos.get(s.bW);se&&(ee.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,se.colorAttachment.get()),ee.activeTexture.set(ie.TEXTURE1),Hi(ee,te).bind(ie.LINEAR,ie.CLAMP_TO_EDGE),U.useProgram("heatmapTexture").draw(ee,ie.TRIANGLES,Et.disabled,Bt.disabled,U.colorModeForRenderPass(),Wt.disabled,vc(U,te,0,1),null,null,te.id,U.viewportBuffer,U.quadTriangleIndexBuffer,U.viewportSegments,te.paint,U.transform.zoom))}(v,C)}(e,n,u,p,g):s.c6(u)?function(v,x,C,T,k){if(v.renderPass!=="translucent")return;let{isRenderingToTexture:R}=k,D=C.paint.get("line-opacity"),j=C.paint.get("line-width");if(D.constantOr(1)===0||j.constantOr(1)===0)return;let U=v.getDepthModeForSublayer(0,Et.ReadOnly),te=v.colorModeForRenderPass(),ee=C.paint.get("line-dasharray"),ie=C.paint.get("line-pattern"),se=ie.constantOr(1),ue=C.paint.get("line-gradient"),de=C.getCrossfadeParameters(),he=se?"linePattern":ee?"lineSDF":ue?"lineGradient":"line",_e=v.context,pe=_e.gl,Se=v.transform,Be=!0;for(let ke of T){let Ae=x.getTile(ke);if(se&&!Ae.patternsLoaded())continue;let Re=Ae.getBucket(C);if(!Re)continue;let Je=Re.programConfigurations.get(C.id),Ke=v.context.program.get(),He=v.useProgram(he,Je),ct=Be||He.program!==Ke,Nt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ke),ii=ie.constantOr(null);if(ii&&Ae.imageAtlas){let Ai=Ae.imageAtlas,fi=Ai.patternPositions[ii.to.toString()],In=Ai.patternPositions[ii.from.toString()];fi&&In&&Je.setConstantPatternPositions(fi,In)}let qi=Se.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),Ei=Se.getPixelScale(),Xi=se?wd(v,Ae,C,Ei,de):ee?Cd(v,Ae,C,Ei,ee,de):ue?xd(v,Ae,C,Ei,Re.lineClipsArray.length):to(v,Ae,C,Ei);if(se)_e.activeTexture.set(pe.TEXTURE0),Ae.imageAtlasTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),Je.updatePaintBuffers(de);else if(ee&&(ct||v.lineAtlas.dirty))_e.activeTexture.set(pe.TEXTURE0),v.lineAtlas.bind(_e);else if(ue){let Ai=Re.gradients[C.id],fi=Ai.texture;if(C.gradientVersion!==Ai.version){let In=256;if(C.stepInterpolant){let Nn=x.getSource().maxzoom,Yn=ke.canonical.z===Nn?Math.ceil(1<<v.transform.maxZoom-ke.canonical.z):1;In=s.ae(s.bX(Re.maxLineLength/s.Z*1024*Yn),256,_e.maxTextureSize)}Ai.gradient=s.bY({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:In,image:Ai.gradient||void 0,clips:Re.lineClipsArray}),Ai.texture?Ai.texture.update(Ai.gradient):Ai.texture=new pi(_e,Ai.gradient,pe.RGBA),Ai.version=C.gradientVersion,fi=Ai.texture}_e.activeTexture.set(pe.TEXTURE0),fi.bind(C.stepInterpolant?pe.NEAREST:pe.LINEAR,pe.CLAMP_TO_EDGE)}let Yi=v.stencilModeForClipping(ke);He.draw(_e,pe.TRIANGLES,U,Yi,te,Wt.disabled,Xi,Nt,qi,C.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,C.paint,v.transform.zoom,Je,Re.layoutVertexBuffer2),Be=!1}}(e,n,u,p,g):s.c7(u)?function(v,x,C,T,k){let R=C.paint.get("fill-color"),D=C.paint.get("fill-opacity");if(D.constantOr(1)===0)return;let{isRenderingToTexture:j}=k,U=v.colorModeForRenderPass(),te=C.paint.get("fill-pattern"),ee=v.opaquePassEnabledForLayer()&&!te.constantOr(1)&&R.constantOr(s.b7.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===ee){let ie=v.getDepthModeForSublayer(1,v.renderPass==="opaque"?Et.ReadWrite:Et.ReadOnly);Va(v,x,C,T,ie,U,!1,j)}if(v.renderPass==="translucent"&&C.paint.get("fill-antialias")){let ie=v.getDepthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Et.ReadOnly);Va(v,x,C,T,ie,U,!0,j)}}(e,n,u,p,g):s.c8(u)?function(v,x,C,T,k){let R=C.paint.get("fill-extrusion-opacity");if(R===0)return;let{isRenderingToTexture:D}=k;if(v.renderPass==="translucent"){let j=new Et(v.context.gl.LEQUAL,Et.ReadWrite,v.depthRangeFor3D);if(R!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))ja(v,x,C,T,j,Bt.disabled,ci.disabled,D),ja(v,x,C,T,j,v.stencilModeFor3D(),v.colorModeForRenderPass(),D);else{let U=v.colorModeForRenderPass();ja(v,x,C,T,j,Bt.disabled,U,D)}}}(e,n,u,p,g):s.c9(u)?function(v,x,C,T,k){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;let{isRenderingToTexture:R}=k,D=v.context,j=v.style.projection.useSubdivision,U=v.getDepthModeForSublayer(0,Et.ReadOnly),te=v.colorModeForRenderPass();if(v.renderPass==="offscreen")(function(ee,ie,se,ue,de,he,_e){let pe=ee.context,Se=pe.gl;for(let Be of se){let ke=ie.getTile(Be),Ae=ke.dem;if(!Ae||!Ae.data||!ke.needsHillshadePrepare)continue;let Re=Ae.dim,Je=Ae.stride,Ke=Ae.getPixels();if(pe.activeTexture.set(Se.TEXTURE1),pe.pixelStoreUnpackPremultiplyAlpha.set(!1),ke.demTexture=ke.demTexture||ee.getTileTexture(Je),ke.demTexture){let ct=ke.demTexture;ct.update(Ke,{premultiply:!1}),ct.bind(Se.NEAREST,Se.CLAMP_TO_EDGE)}else ke.demTexture=new pi(pe,Ke,Se.RGBA,{premultiply:!1}),ke.demTexture.bind(Se.NEAREST,Se.CLAMP_TO_EDGE);pe.activeTexture.set(Se.TEXTURE0);let He=ke.fbo;if(!He){let ct=new pi(pe,{width:Re,height:Re,data:null},Se.RGBA);ct.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),He=ke.fbo=pe.createFramebuffer(Re,Re,!0,!1),He.colorAttachment.set(ct.texture)}pe.bindFramebuffer.set(He.framebuffer),pe.viewport.set([0,0,Re,Re]),ee.useProgram("hillshadePrepare").draw(pe,Se.TRIANGLES,de,he,_e,Wt.disabled,bd(ke.tileID,Ae),null,null,ue.id,ee.rasterBoundsBuffer,ee.quadTriangleIndexBuffer,ee.rasterBoundsSegments),ke.needsHillshadePrepare=!1}})(v,x,T,C,U,Bt.disabled,te),D.viewport.set([0,0,v.width,v.height]);else if(v.renderPass==="translucent")if(j){let[ee,ie,se]=v.stencilConfigForOverlapTwoPass(T);kc(v,x,C,se,ee,U,te,!1,R),kc(v,x,C,se,ie,U,te,!0,R)}else{let[ee,ie]=v.getStencilConfigForOverlapAndUpdateStencilID(T);kc(v,x,C,ie,ee,U,te,!1,R)}}(e,n,u,p,g):s.ca(u)?function(v,x,C,T,k){if(v.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!T.length)return;let{isRenderingToTexture:R}=k,D=x.getSource(),j=v.style.projection.useSubdivision;if(D instanceof Fn)Tl(v,x,C,T,null,!1,!1,D.tileCoords,D.flippedWindingOrder,R);else if(j){let[U,te,ee]=v.stencilConfigForOverlapTwoPass(T);Tl(v,x,C,ee,U,!1,!0,Ua,!1,R),Tl(v,x,C,ee,te,!0,!0,Ua,!1,R)}else{let[U,te]=v.getStencilConfigForOverlapAndUpdateStencilID(T);Tl(v,x,C,te,U,!1,!0,Ua,!1,R)}}(e,n,u,p,g):s.cb(u)?function(v,x,C,T,k){let R=C.paint.get("background-color"),D=C.paint.get("background-opacity");if(D===0)return;let{isRenderingToTexture:j}=k,U=v.context,te=U.gl,ee=v.style.projection,ie=v.transform,se=ie.tileSize,ue=C.paint.get("background-pattern");if(v.isPatternMissing(ue))return;let de=!ue&&R.a===1&&D===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==de)return;let he=Bt.disabled,_e=v.getDepthModeForSublayer(0,de==="opaque"?Et.ReadWrite:Et.ReadOnly),pe=v.colorModeForRenderPass(),Se=v.useProgram(ue?"backgroundPattern":"background"),Be=T||ye(ie,{tileSize:se,terrain:v.style.map.terrain});ue&&(U.activeTexture.set(te.TEXTURE0),v.imageManager.bind(v.context));let ke=C.getCrossfadeParameters();for(let Ae of Be){let Re=ie.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Je=ue?$u(D,v,ue,{tileID:Ae,tileSize:se},ke):Pd(D,R),Ke=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ae),He=ee.getMeshFromTileID(U,Ae.canonical,!1,!0,"raster");Se.draw(U,te.TRIANGLES,_e,he,pe,Wt.backCCW,Je,Ke,Re,C.id,He.vertexBuffer,He.indexBuffer,He.segments)}}(e,0,u,p,g):s.cc(u)&&function(v,x,C,T){let{isRenderingGlobe:k}=T,R=v.context,D=C.implementation,j=v.style.projection,U=v.transform,te=U.getProjectionDataForCustomLayer(k),ee={farZ:U.farZ,nearZ:U.nearZ,fov:U.fov*Math.PI/180,modelViewProjectionMatrix:U.modelViewProjectionMatrix,projectionMatrix:U.projectionMatrix,shaderData:{variantName:j.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${j.shaderPreludeCode.vertexSource}`,define:j.shaderDefine},defaultProjectionData:te},ie=D.renderingMode?D.renderingMode:"2d";if(v.renderPass==="offscreen"){let se=D.prerender;se&&(v.setCustomLayerDefaults(),R.setColorMode(v.colorModeForRenderPass()),se.call(D,R.gl,ee),R.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),R.setColorMode(v.colorModeForRenderPass()),R.setStencilMode(Bt.disabled);let se=ie==="3d"?v.getDepthModeFor3D():v.getDepthModeForSublayer(0,Et.ReadOnly);R.setDepthMode(se),D.render(R.gl,ee),R.setDirty(),v.setBaseState(),R.bindFramebuffer.set(null)}}(e,0,u,g))}saveTileTexture(e){let n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let n=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!n||!u}useProgram(e,n,u=!1,p=[]){this.cache=this.cache||{};let g=!!this.style.map.terrain,v=this.style.projection,x=u?Wn.projectionMercator:v.shaderPreludeCode,C=u?ls:v.shaderDefine,T=e+(n?n.cacheKey:"")+`/${u?Zt:v.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(g?"/terrain":"")+(p?`/${p.join("/")}`:"");return this.cache[T]||(this.cache[T]=new ml(this.context,Wn[e],n,Ed[e],this._showOverdrawInspector,g,x,C,p)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new pi(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function _s(f,e){let n,u=!1,p=null,g=null,v=()=>{p=null,u&&(f.apply(g,n),p=setTimeout(v,e),u=!1)};return(...x)=>(u=!0,g=this,n=x,p||v(),p)}class Qu{constructor(e){this._getCurrentHash=()=>{let n=window.location.hash.replace("#","");if(this._hashName){let u;return n.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(u=p)}),(u&&u[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{let n=this._getCurrentHash();if(!this._isValidHash(n))return!1;let u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:u,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{let n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{let n=this._getCurrentHash();if(n.length===0)return;let u=n.join("/"),p=u;p.split("&").length>0&&(p=p.split("&")[0]),this._hashName&&(p=`${this._hashName}=${u}`);let g=window.location.hash.replace(p,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let v=window.location.href.replace(/(#.+)?$/,g);v=v.replace("&&","&"),window.history.replaceState(window.history.state,null,v)},this._updateHash=_s(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){let n=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,p=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,p),v=Math.round(n.lng*g)/g,x=Math.round(n.lat*g)/g,C=this._map.getBearing(),T=this._map.getPitch(),k="";if(k+=e?`/${v}/${x}/${u}`:`${u}/${x}/${v}`,(C||T)&&(k+="/"+Math.round(10*C)/10),T&&(k+=`/${Math.round(T)}`),this._hashName){let R=this._hashName,D=!1,j=window.location.hash.slice(1).split("&").map(U=>{let te=U.split("=")[0];return te===R?(D=!0,`${te}=${k}`):U}).filter(U=>U);return D||j.push(`${R}=${k}`),`#${j.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new s.Q(+e[2],+e[1])}catch{return!1}let n=+e[0],u=+(e[3]||0),p=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&u>=-180&&u<=180&&p>=this._map.getMinPitch()&&p<=this._map.getMaxPitch()}}let Go={linearity:.3,easing:s.cd(0,0,.3,1)},Ju=s.e({deceleration:2500,maxSpeed:1400},Go),Ac=s.e({deceleration:20,maxSpeed:1400},Go),eh=s.e({deceleration:1e3,maxSpeed:360},Go),Jp=s.e({deceleration:1e3,maxSpeed:90},Go),em=s.e({deceleration:1e3,maxSpeed:360},Go);class tm{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ve.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,n=ve.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let n={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:g}of this._inertiaBuffer)n.zoom+=g.zoomDelta||0,n.bearing+=g.bearingDelta||0,n.pitch+=g.pitchDelta||0,n.roll+=g.rollDelta||0,g.panDelta&&n.pan._add(g.panDelta),g.around&&(n.around=g.around),g.pinchAround&&(n.pinchAround=g.pinchAround);let u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(n.pan.mag()){let g=Al(n.pan.mag(),u,s.e({},Ju,e||{})),v=n.pan.mult(g.amount/n.pan.mag()),x=this._map.cameraHelper.handlePanInertia(v,this._map.transform);p.center=x.easingCenter,p.offset=x.easingOffset,kl(p,g)}if(n.zoom){let g=Al(n.zoom,u,Ac);p.zoom=this._map.transform.zoom+g.amount,kl(p,g)}if(n.bearing){let g=Al(n.bearing,u,eh);p.bearing=this._map.transform.bearing+s.ae(g.amount,-179,179),kl(p,g)}if(n.pitch){let g=Al(n.pitch,u,Jp);p.pitch=this._map.transform.pitch+g.amount,kl(p,g)}if(n.roll){let g=Al(n.roll,u,em);p.roll=this._map.transform.roll+s.ae(g.amount,-179,179),kl(p,g)}if(p.zoom||p.bearing){let g=n.pinchAround===void 0?n.around:n.pinchAround;p.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),s.e(p,{noMoveStart:!0})}}function kl(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function Al(f,e,n){let{maxSpeed:u,linearity:p,deceleration:g}=n,v=s.ae(f*p/(e/1e3),-u,u),x=Math.abs(v)/(g*p);return{easing:n.easing,duration:1e3*x,amount:v*(x/2)}}class Tn extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,u,p={}){u=u instanceof MouseEvent?u:new MouseEvent(e,u);let g=$.mousePos(n.getCanvas(),u),v=n.unproject(g);super(e,s.e({point:g,lngLat:v,originalEvent:u},p)),this._defaultPrevented=!1,this.target=n}}class Dl extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,u){let p=e==="touchend"?u.changedTouches:u.touches,g=$.touchPos(n.getCanvasContainer(),p),v=g.map(C=>n.unproject(C)),x=g.reduce((C,T,k,R)=>C.add(T.div(R.length)),new s.P(0,0));super(e,{points:g,point:x,lngLats:v,lngLat:n.unproject(x),originalEvent:u}),this._defaultPrevented=!1}}class th extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class im{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new th(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new Tn(e.type,this._map,e))}mouseup(e){this._map.fire(new Tn(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new Tn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Tn(e.type,this._map,e))}mouseover(e){this._map.fire(new Tn(e.type,this._map,e))}mouseout(e){this._map.fire(new Tn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Dl(e.type,this._map,e))}touchmove(e){this._map.fire(new Dl(e.type,this._map,e))}touchend(e){this._map.fire(new Dl(e.type,this._map,e))}touchcancel(e){this._map.fire(new Dl(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nm{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Tn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Tn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Tn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(s.P.convert(e),this._map.terrain)}}class ih{constructor(e,n){this._map=e,this._tr=new Rl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&($.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;let u=n;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;let p=this._startPos;this._lastPos=u,this._box||(this._box=$.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let g=Math.min(p.x,u.x),v=Math.max(p.x,u.x),x=Math.min(p.y,u.y),C=Math.max(p.y,u.y);$.setTransform(this._box,`translate(${g}px,${x}px)`),this._box.style.width=v-g+"px",this._box.style.height=C-x+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;let u=this._startPos,p=n;if(this.reset(),$.suppressClick(),u.x!==p.x||u.y!==p.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:e})),{cameraAnimation:g=>g.fitScreenCoordinates(u,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&($.remove(this._box),this._box=null),$.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new s.l(e,{originalEvent:n}))}}function Ld(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);let n={};for(let u=0;u<f.length;u++)n[f[u].identifier]=e[u];return n}class rm{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(p){let g=new s.P(0,0);for(let v of p)g._add(v);return g.div(p.length)}(n),this.touches=Ld(u,n)))}touchmove(e,n,u){if(this.aborted||!this.centroid)return;let p=Ld(u,n);for(let g in this.touches){let v=p[g];(!v||v.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(e,n,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){let p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Ol{constructor(e){this.singleTap=new rm(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,u){this.singleTap.touchstart(e,n,u)}touchmove(e,n,u){this.singleTap.touchmove(e,n,u)}touchend(e,n,u){let p=this.singleTap.touchend(e,n,u);if(p){let g=e.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(p)<30;if(g&&v||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class om{constructor(e){this._tr=new Rl(e),this._zoomIn=new Ol({numTouches:1,numTaps:2}),this._zoomOut=new Ol({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,u){this._zoomIn.touchstart(e,n,u),this._zoomOut.touchstart(e,n,u)}touchmove(e,n,u){this._zoomIn.touchmove(e,n,u),this._zoomOut.touchmove(e,n,u)}touchend(e,n,u){let p=this._zoomIn.touchend(e,n,u),g=this._zoomOut.touchend(e,n,u),v=this._tr;return p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(p)},{originalEvent:e})}):g?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(g)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cr{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;let u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);let p=Array.isArray(n)?n[0]:n;return!this._moved&&p.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(u,p))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&$.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let bo={0:1,2:2};class Fl{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let n=$.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,u){let p=bo[u];return n.buttons===void 0||(n.buttons&p)!==p}(e,this._eventButton)}isValidEndEvent(e){return $.mouseButton(e)===this._eventButton}}class xo{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Ll{constructor(e=new Fl({checkCorrectEvent:()=>!0}),n=new xo){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,u){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?u(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}let zd=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class Bg{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,u){return this._calculateTransform(e,n,u)}touchmove(e,n,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,n,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,u){this._calculateTransform(e,n,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,u){u.length>0&&(this._active=!0);let p=Ld(u,n),g=new s.P(0,0),v=new s.P(0,0),x=0;for(let T in p){let k=p[T],R=this._touches[T];R&&(g._add(k),v._add(k.sub(R)),x++,p[T]=k)}if(this._touches=p,this._shouldBePrevented(x)||!v.mag())return;let C=v.div(x);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(x),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nh{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,u){if(!this._firstTwoTouches)return;e.preventDefault();let[p,g]=this._firstTwoTouches,v=Bd(u,n,p),x=Bd(u,n,g);if(!v||!x)return;let C=this._aroundCenter?null:v.add(x).div(2);return this._move([v,x],C,e)}touchend(e,n,u){if(!this._firstTwoTouches)return;let[p,g]=this._firstTwoTouches,v=Bd(u,n,p),x=Bd(u,n,g);v&&x||(this._active&&$.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Bd(f,e,n){for(let u=0;u<f.length;u++)if(f[u].identifier===n)return e[u]}function rh(f,e){return Math.log(f/e)/Math.LN2}class zl extends nh{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){let u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(rh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:rh(this._distance,u),pinchAround:n}}}function Ho(f,e){return 180*f.angleWith(e)/Math.PI}class nt extends nh{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,u){let p=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ho(this._vector,p),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let n=25/(Math.PI*this._minDiameter)*360,u=Ho(e,this._startVector);return Math.abs(u)<n}}function Nd(f){return Math.abs(f.y)>Math.abs(f.x)}class Vd extends nh{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,u){super.touchstart(e,n,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,Nd(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let p=e[0].sub(this._lastPoints[0]),g=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,g,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(p.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,u){if(this._valid!==void 0)return this._valid;let p=e.mag()>=2,g=n.mag()>=2;if(!p&&!g)return;if(!p||!g)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;let v=e.y>0==n.y>0;return Nd(e)&&Nd(n)&&v}}let sm={panStep:100,bearingStep:15,pitchStep:10};class Bl{constructor(e){this._tr=new Rl(e);let n=sm;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,u=0,p=0,g=0,v=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),g=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),g=1);break;case 38:e.shiftKey?p=1:(e.preventDefault(),v=-1);break;case 40:e.shiftKey?p=-1:(e.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(u=0,p=0),{cameraAnimation:x=>{let C=this._tr;x.easeTo({duration:300,easeId:"keyboardHandler",easing:Dc,zoom:n?Math.round(C.zoom)+n*(e.shiftKey?2:1):C.zoom,bearing:C.bearing+u*this._bearingStep,pitch:C.pitch+p*this._pitchStep,offset:[-g*this._panStep,-v*this._panStep],center:C.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Dc(f){return f*(2-f)}let oh=4.000244140625;class Yt{constructor(e,n){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new Rl(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,u=ve.now(),p=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,n!==0&&n%oh==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(p*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let n=$.mousePos(this._map.getCanvas(),e),u=this._tr;this._aroundPoint=this._aroundCenter?u.transform.locationToScreenPoint(s.Q.convert(u.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){let x=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=x),typeof this._targetZoom=="number"&&(this._targetZoom+=x)}if(this._delta!==0){let x=this._type==="wheel"&&Math.abs(this._delta)>oh?this._wheelZoomRate:this._defaultZoomRate,C=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&C!==0&&(C=1/C);let T=typeof this._targetZoom!="number"?e.scale:s.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),s.ah(T*C)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,u=this._startZoom,p=this._easing,g,v=!1;if(this._type==="wheel"&&u&&p){let x=ve.now()-this._lastWheelEventTime,C=Math.min((x+5)/200,1),T=p(C);g=s.B.number(u,n,T),C<1?this._frameId||(this._frameId=!0):v=!0}else g=n,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=g,{noInertia:!0,needsRenderFrame:!v,zoomDelta:g-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=s.cf;if(this._prevEase){let u=this._prevEase,p=(ve.now()-u.start)/u.duration,g=u.easing(p+.01)-u.easing(p),v=.27/Math.sqrt(g*g+1e-4)*.01,x=Math.sqrt(.0729-v*v);n=s.cd(v,x,.25,1)}return this._prevEase={start:ve.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class jd{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ng{constructor(e){this._tr=new Rl(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sh{constructor(){this._tap=new Ol({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,u){if(!this._swipePoint)if(this._tapTime){let p=n[0],g=e.timeStamp-this._tapTime<500,v=this._tapPoint.dist(p)<30;g&&v?u.length>0&&(this._swipePoint=p,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,n,u)}touchmove(e,n,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;let p=n[0],g=p.y-this._swipePoint.y;return this._swipePoint=p,e.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(e,n,u)}touchend(e,n,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{let p=this._tap.touchend(e,n,u);p&&(this._tapTime=e.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class am{constructor(e,n,u){this._el=e,this._mousePan=n,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class lm{constructor(e,n,u,p){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=u,this._mouseRoll=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ah{constructor(e,n,u,p){this._el=e,this._touchZoom=n,this._touchRotate=u,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ud{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=$.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),p=document.createElement("div");p.className="maplibregl-desktop-message",p.textContent=n,this._container.appendChild(p);let g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=u,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&($.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let Rc=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class Vg extends s.l{}function $d(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class jg{constructor(e,n){this.handleWindowEvent=p=>{this.handleEvent(p,`${p.type}Window`)},this.handleEvent=(p,g)=>{if(p.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let v=p.type==="renderFrame"?void 0:p,x={needsRenderFrame:!1},C={},T={};for(let{handlerName:D,handler:j,allowed:U}of this._handlers){if(!j.isEnabled())continue;let te;if(this._blockedByActive(T,U,D))j.reset();else if(j[g||p.type]){if(s.cg(p,g||p.type)){let ee=$.mousePos(this._map.getCanvas(),p);te=j[g||p.type](p,ee)}else if(s.ch(p,g||p.type)){let ee=this._getMapTouches(p.touches),ie=$.touchPos(this._map.getCanvas(),ee);te=j[g||p.type](p,ie,ee)}else s.ci(g||p.type)||(te=j[g||p.type](p));this.mergeHandlerResult(x,C,te,D,v),te&&te.needsRenderFrame&&this._triggerRenderFrame()}(te||j.isActive())&&(T[D]=j)}let k={};for(let D in this._previousActiveHandlers)T[D]||(k[D]=v);this._previousActiveHandlers=T,(Object.keys(k).length||$d(x))&&(this._changes.push([x,C,k]),this._triggerRenderFrame()),(Object.keys(T).length||$d(x))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:R}=x;R&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],R(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new tm(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);let u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(let[p,g,v]of this._listeners)$.addEventListener(p,g,p===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(let[e,n,u]of this._listeners)$.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){let n=this._map,u=n.getCanvasContainer();this._add("mapEvent",new im(n,e));let p=n.boxZoom=new ih(n,e);this._add("boxZoom",p),e.interactive&&e.boxZoom&&p.enable();let g=n.cooperativeGestures=new Ud(n,e.cooperativeGestures);this._add("cooperativeGestures",g),e.cooperativeGestures&&g.enable();let v=new om(n),x=new Ng(n);n.doubleClickZoom=new jd(x,v),this._add("tapZoom",v),this._add("clickZoom",x),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();let C=new sh;this._add("tapDragZoom",C);let T=n.touchPitch=new Vd(n);this._add("touchPitch",T),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);let k=()=>n.project(n.getCenter()),R=function({enable:de,clickTolerance:he,aroundCenter:_e=!0,minPixelCenterThreshold:pe=100,rotateDegreesPerPixelMoved:Se=.8},Be){let ke=new Fl({checkCorrectEvent:Ae=>$.mouseButton(Ae)===0&&Ae.ctrlKey||$.mouseButton(Ae)===2&&!Ae.ctrlKey});return new cr({clickTolerance:he,move:(Ae,Re)=>{let Je=Be();if(_e&&Math.abs(Je.y-Ae.y)>pe)return{bearingDelta:s.ce(new s.P(Ae.x,Re.y),Re,Je)};let Ke=(Re.x-Ae.x)*Se;return _e&&Re.y<Je.y&&(Ke=-Ke),{bearingDelta:Ke}},moveStateManager:ke,enable:de,assignEvents:zd})}(e,k),D=function({enable:de,clickTolerance:he,pitchDegreesPerPixelMoved:_e=-.5}){let pe=new Fl({checkCorrectEvent:Se=>$.mouseButton(Se)===0&&Se.ctrlKey||$.mouseButton(Se)===2});return new cr({clickTolerance:he,move:(Se,Be)=>({pitchDelta:(Be.y-Se.y)*_e}),moveStateManager:pe,enable:de,assignEvents:zd})}(e),j=function({enable:de,clickTolerance:he,rollDegreesPerPixelMoved:_e=.3},pe){let Se=new Fl({checkCorrectEvent:Be=>$.mouseButton(Be)===2&&Be.ctrlKey});return new cr({clickTolerance:he,move:(Be,ke)=>{let Ae=pe(),Re=(ke.x-Be.x)*_e;return ke.y<Ae.y&&(Re=-Re),{rollDelta:Re}},moveStateManager:Se,enable:de,assignEvents:zd})}(e,k);n.dragRotate=new lm(e,R,D,j),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",D,["mouseRotate","mouseRoll"]),this._add("mouseRoll",j,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();let U=function({enable:de,clickTolerance:he}){let _e=new Fl({checkCorrectEvent:pe=>$.mouseButton(pe)===0&&!pe.ctrlKey});return new cr({clickTolerance:he,move:(pe,Se)=>({around:Se,panDelta:Se.sub(pe)}),activateOnStart:!0,moveStateManager:_e,enable:de,assignEvents:zd})}(e),te=new Bg(e,n);n.dragPan=new am(u,U,te),this._add("mousePan",U),this._add("touchPan",te,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);let ee=new nt,ie=new zl;n.touchZoomRotate=new ah(u,ie,ee,C),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);let se=n.scrollZoom=new Yt(n,()=>this._triggerRenderFrame());this._add("scrollZoom",se,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);let ue=n.keyboard=new Bl(n);this._add("keyboard",ue),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new nm(n))}_add(e,n,u){this._handlers.push({handlerName:e,handler:n,allowed:u}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(let{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rc(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,u){for(let p in e)if(p!==u&&(!n||n.indexOf(p)<0))return!0;return!1}_getMapTouches(e){let n=[];for(let u of e)this._el.contains(u.target)&&n.push(u);return n}mergeHandlerResult(e,n,u,p,g){if(!u)return;s.e(e,u);let v={handlerName:p,originalEvent:u.originalEvent||g};u.zoomDelta!==void 0&&(n.zoom=v),u.panDelta!==void 0&&(n.drag=v),u.rollDelta!==void 0&&(n.roll=v),u.pitchDelta!==void 0&&(n.pitch=v),u.bearingDelta!==void 0&&(n.rotate=v)}_applyChanges(){let e={},n={},u={};for(let[p,g,v]of this._changes)p.panDelta&&(e.panDelta=(e.panDelta||new s.P(0,0))._add(p.panDelta)),p.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+p.pitchDelta),p.rollDelta&&(e.rollDelta=(e.rollDelta||0)+p.rollDelta),p.around!==void 0&&(e.around=p.around),p.pinchAround!==void 0&&(e.pinchAround=p.pinchAround),p.noInertia&&(e.noInertia=p.noInertia),s.e(n,g),s.e(u,v);this._updateMapTransform(e,n,u),this._changes=[]}_updateMapTransform(e,n,u){let p=this._map,g=p._getTransformForUpdate(),v=p.terrain;if(!($d(e)||v&&this._terrainMovement))return this._fireEvents(n,u,!0);p._stop(!0);let{panDelta:x,zoomDelta:C,bearingDelta:T,pitchDelta:k,rollDelta:R,around:D,pinchAround:j}=e;j!==void 0&&(D=j),D=D||p.transform.centerPoint,v&&!g.isPointOnMapSurface(D)&&(D=g.centerPoint);let U={panDelta:x,zoomDelta:C,rollDelta:R,pitchDelta:k,bearingDelta:T,around:D};this._map.cameraHelper.useGlobeControls&&!g.isPointOnMapSurface(D)&&(D=g.centerPoint);let te=D.distSqr(g.centerPoint)<.01?g.center:g.screenPointToLocation(x?D.sub(x):D);v?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(U,g),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(x))):this._map.cameraHelper.handleMapControlsPan(U,g,te):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(U,g,te))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(U,g),this._map.cameraHelper.handleMapControlsPan(U,g,te)),p._applyUpdatedTransform(g),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,u,!0)}_fireEvents(e,n,u){let p=Rc(this._eventsInProgress),g=Rc(e),v={};for(let R in e){let{originalEvent:D}=e[R];this._eventsInProgress[R]||(v[`${R}start`]=D),this._eventsInProgress[R]=e[R]}!p&&g&&this._fireEvent("movestart",g.originalEvent);for(let R in v)this._fireEvent(R,v[R]);g&&this._fireEvent("move",g.originalEvent);for(let R in e){let{originalEvent:D}=e[R];this._fireEvent(R,D)}let x={},C;for(let R in this._eventsInProgress){let{handlerName:D,originalEvent:j}=this._eventsInProgress[R];this._handlersById[D].isActive()||(delete this._eventsInProgress[R],C=n[D]||j,x[`${R}end`]=C)}for(let R in x)this._fireEvent(R,x[R]);let T=Rc(this._eventsInProgress),k=(p||g)&&!T;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let R=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&R.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(R)}if(u&&k){this._updatingCamera=!0;let R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),D=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;!R||!R.essential&&ve.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:C})),D(this._map.getBearing())&&this._map.resetNorth()):(D(R.bearing||this._map.getBearing())&&(R.bearing=0),R.freezeElevation=!0,this._map.easeTo(R,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new s.l(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Vg("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ug extends s.E{constructor(e,n,u){super(),this._renderFrameCallback=()=>{let p=Math.min((ve.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=u.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new s.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,u){return e=s.P.convert(e).mult(-1),this.panTo(this.transform.center,s.e({offset:e},n),u)}panTo(e,n,u){return this.easeTo(s.e({center:e},n),u)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,u){return this.easeTo(s.e({zoom:e},n),u)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new s.l("movestart",n)).fire(new s.l("move",n)).fire(new s.l("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,u){return this.easeTo(s.e({bearing:e},n),u)}resetNorth(e,n){return this.rotateTo(0,s.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=xi.convert(e).adjustAntiMeridian();let u=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,n)}_cameraForBoxAndBearing(e,n,u,p){let g={top:0,bottom:0,right:0,left:0};if(typeof(p=s.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){let T=p.padding;p.padding={top:T,bottom:T,right:T,left:T}}let v=s.e(g,p.padding);p.padding=v;let x=this.transform,C=new xi(e,n);return this.cameraHelper.cameraForBoxAndBearing(p,v,C,u,x)}fitBounds(e,n,u){return this._fitInternal(this.cameraForBounds(e,n),n,u)}fitScreenCoordinates(e,n,u,p,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(e)),this.transform.screenPointToLocation(s.P.convert(n)),u,p),p,g)}_fitInternal(e,n,u){return e?(delete(n=s.e(e,n)).padding,n.linear?this.easeTo(n,u):this.flyTo(n,u)):this}jumpTo(e,n){this.stop();let u=this._getTransformForUpdate(),p=!1,g=!1,v=!1,x=u.zoom;this.cameraHelper.handleJumpToCenterZoom(u,e);let C=u.zoom!==x;return"elevation"in e&&u.elevation!==+e.elevation&&u.setElevation(+e.elevation),"bearing"in e&&u.bearing!==+e.bearing&&(p=!0,u.setBearing(+e.bearing)),"pitch"in e&&u.pitch!==+e.pitch&&(g=!0,u.setPitch(+e.pitch)),"roll"in e&&u.roll!==+e.roll&&(v=!0,u.setRoll(+e.roll)),e.padding==null||u.isPaddingEqual(e.padding)||u.setPadding(e.padding),this._applyUpdatedTransform(u),this.fire(new s.l("movestart",n)).fire(new s.l("move",n)),C&&this.fire(new s.l("zoomstart",n)).fire(new s.l("zoom",n)).fire(new s.l("zoomend",n)),p&&this.fire(new s.l("rotatestart",n)).fire(new s.l("rotate",n)).fire(new s.l("rotateend",n)),g&&this.fire(new s.l("pitchstart",n)).fire(new s.l("pitch",n)).fire(new s.l("pitchend",n)),v&&this.fire(new s.l("rollstart",n)).fire(new s.l("roll",n)).fire(new s.l("rollend",n)),this.fire(new s.l("moveend",n))}calculateCameraOptionsFromTo(e,n,u,p=0){let g=s.$.fromLngLat(e,n),v=s.$.fromLngLat(u,p),x=v.x-g.x,C=v.y-g.y,T=v.z-g.z,k=Math.hypot(x,C,T);if(k===0)throw new Error("Can't calculate camera options with same From and To");let R=Math.hypot(x,C),D=s.ah(this.transform.cameraToCenterDistance/k/this.transform.tileSize),j=180*Math.atan2(x,-C)/Math.PI,U=180*Math.acos(R/k)/Math.PI;return U=T<0?90-U:90+U,{center:v.toLngLat(),elevation:p,zoom:D,pitch:U,bearing:j}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,u,p,g){let v=this.transform.calculateCenterFromCameraLngLatAlt(e,n,u,p);return{center:v.center,elevation:v.elevation,zoom:v.zoom,bearing:u,pitch:p,roll:g}}easeTo(e,n){this._stop(!1,e.easeId),((e=s.e({offset:[0,0],duration:500,easing:s.cf},e)).animate===!1||!e.essential&&ve.prefersReducedMotion)&&(e.duration=0);let u=this._getTransformForUpdate(),p=this.getBearing(),g=u.pitch,v=u.roll,x="bearing"in e?this._normalizeBearing(e.bearing,p):p,C="pitch"in e?+e.pitch:g,T="roll"in e?this._normalizeBearing(e.roll,v):v,k="padding"in e?e.padding:u.padding,R=s.P.convert(e.offset),D,j;e.around&&(D=s.Q.convert(e.around),j=u.locationToScreenPoint(D));let U={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},te=this.cameraHelper.handleEaseTo(u,{bearing:x,pitch:C,roll:T,padding:k,around:D,aroundPoint:j,offsetAsPoint:R,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||p!==x,this._pitching=this._pitching||C!==g,this._rolling=this._rolling||T!==v,this._padding=!u.isPaddingEqual(k),this._zooming=this._zooming||te.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,U),this.terrain&&this._prepareElevation(te.elevationCenter),this._ease(ee=>{te.easeFunc(ee),this.terrain&&!e.freezeElevation&&this._updateElevation(ee),this._applyUpdatedTransform(u),this._fireMoveEvents(n)},ee=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,ee)},e),this}_prepareEase(e,n,u={}){this._moving=!0,n||u.moving||this.fire(new s.l("movestart",e)),this._zooming&&!u.zooming&&this.fire(new s.l("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new s.l("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new s.l("pitchstart",e)),this._rolling&&!u.rolling&&this.fire(new s.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));let n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){let u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(n-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(s.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};let n=e.getCameraLngLat(),u=e.getCameraAltitude(),p=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(u<p){let g=this.calculateCameraOptionsFromTo(n,p,e.center,e.elevation);return{pitch:g.pitch,zoom:g.zoom}}return{}}_applyUpdatedTransform(e){let n=[];if(n.push(p=>this._elevateCameraIfInsideTerrain(p)),this.transformCameraUpdate&&n.push(p=>this.transformCameraUpdate(p)),!n.length)return;let u=e.clone();for(let p of n){let g=u.clone(),{center:v,zoom:x,roll:C,pitch:T,bearing:k,elevation:R}=p(g);v&&g.setCenter(v),R!==void 0&&g.setElevation(R),x!==void 0&&g.setZoom(x),C!==void 0&&g.setRoll(C),T!==void 0&&g.setPitch(T),k!==void 0&&g.setBearing(k),u.apply(g)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new s.l("move",e)),this._zooming&&this.fire(new s.l("zoom",e)),this._rotating&&this.fire(new s.l("rotate",e)),this._pitching&&this.fire(new s.l("pitch",e)),this._rolling&&this.fire(new s.l("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;let u=this._zooming,p=this._rotating,g=this._pitching,v=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,u&&this.fire(new s.l("zoomend",e)),p&&this.fire(new s.l("rotateend",e)),g&&this.fire(new s.l("pitchend",e)),v&&this.fire(new s.l("rollend",e)),this.fire(new s.l("moveend",e))}flyTo(e,n){if(!e.essential&&ve.prefersReducedMotion){let Re=s.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Re,n)}this.stop(),e=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cf},e);let u=this._getTransformForUpdate(),p=u.bearing,g=u.pitch,v=u.roll,x=u.padding,C="bearing"in e?this._normalizeBearing(e.bearing,p):p,T="pitch"in e?+e.pitch:g,k="roll"in e?this._normalizeBearing(e.roll,v):v,R="padding"in e?e.padding:u.padding,D=s.P.convert(e.offset),j=u.centerPoint.add(D),U=u.screenPointToLocation(j),te=this.cameraHelper.handleFlyTo(u,{bearing:C,pitch:T,roll:k,padding:R,locationAtOffset:U,offsetAsPoint:D,center:e.center,minZoom:e.minZoom,zoom:e.zoom}),ee=e.curve,ie=Math.max(u.width,u.height),se=ie/te.scaleOfZoom,ue=te.pixelPathLength;typeof te.scaleOfMinZoom=="number"&&(ee=Math.sqrt(ie/te.scaleOfMinZoom/ue*2));let de=ee*ee;function he(Re){let Je=(se*se-ie*ie+(Re?-1:1)*de*de*ue*ue)/(2*(Re?se:ie)*de*ue);return Math.log(Math.sqrt(Je*Je+1)-Je)}function _e(Re){return(Math.exp(Re)-Math.exp(-Re))/2}function pe(Re){return(Math.exp(Re)+Math.exp(-Re))/2}let Se=he(!1),Be=function(Re){return pe(Se)/pe(Se+ee*Re)},ke=function(Re){return ie*((pe(Se)*(_e(Je=Se+ee*Re)/pe(Je))-_e(Se))/de)/ue;var Je},Ae=(he(!0)-Se)/ee;if(Math.abs(ue)<2e-6||!isFinite(Ae)){if(Math.abs(ie-se)<1e-6)return this.easeTo(e,n);let Re=se<ie?-1:1;Ae=Math.abs(Math.log(se/ie))/ee,ke=()=>0,Be=Je=>Math.exp(Re*ee*Je)}return e.duration="duration"in e?+e.duration:1e3*Ae/("screenSpeed"in e?+e.screenSpeed/ee:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=p!==C,this._pitching=T!==g,this._rolling=k!==v,this._padding=!u.isPaddingEqual(R),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(te.targetCenter),this._ease(Re=>{let Je=Re*Ae,Ke=1/Be(Je),He=ke(Je);this._rotating&&u.setBearing(s.B.number(p,C,Re)),this._pitching&&u.setPitch(s.B.number(g,T,Re)),this._rolling&&u.setRoll(s.B.number(v,k,Re)),this._padding&&(u.interpolatePadding(x,R,Re),j=u.centerPoint.add(D)),te.easeFunc(Re,Ke,He,j),this.terrain&&!e.freezeElevation&&this._updateElevation(Re),this._applyUpdatedTransform(u),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,n)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,n,u){u.animate===!1||u.duration===0?(e(1),n()):(this._easeStart=ve.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=s.aL(e,-180,180);let u=Math.abs(e-n);return Math.abs(e-360-n)<u&&(e-=360),Math.abs(e+360-n)<u&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(s.Q.convert(e),this.transform.tileZoom):null}}let ys={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Li{constructor(e=ys){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=$.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=$.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=$.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){$.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,n){let u=this._map._getUIString(`AttributionControl.${n}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}let n=this._map.style.sourceCaches;for(let p in n){let g=n[p];if(g.used||g.usedForTerrain){let v=g.getSource();v.attribution&&e.indexOf(v.attribution)<0&&e.push(v.attribution)}}e=e.filter(p=>String(p).trim()),e.sort((p,g)=>p.length-g.length),e=e.filter((p,g)=>{for(let v=g+1;v<e.length;v++)if(e[v].indexOf(p)>=0)return!1;return!0});let u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=$.sanitize(u),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Oc{constructor(e={}){this._updateCompact=()=>{let n=this._container.children;if(n.length){let u=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=$.create("div","maplibregl-ctrl");let n=$.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){$.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class lh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){let n=this._currentlyRunning,u=n?this._queue.concat(n):this._queue;for(let p of u)if(p.id===e)return void(p.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let n=this._currentlyRunning=this._queue;this._queue=[];for(let u of n)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var cm=s.aG([{name:"a_pos3d",type:"Int16",components:3}]);class dm extends s.E{constructor(e){super(),this._lastTilesetChange=ve.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];let u={};for(let p of ye(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))u[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.terrainRttPosMatrix32f=new Float64Array(16),s.bQ(p.terrainRttPosMatrix32f,0,s.Z,s.Z,0,0,1),this._tiles[p.key]=new Br(p,this.tileSize),this._lastTilesetChange=ve.now());for(let p in this._tiles)u[p]||delete this._tiles[p]}freeRtt(e){for(let n in this._tiles){let u=this._tiles[n];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,n){return n?this._getTerrainCoordsForTileRanges(e,n):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){let n={};for(let u of this._renderableTilesKeys){let p=this._tiles[u].tileID,g=e.clone(),v=s.b2();if(p.canonical.equals(e.canonical))s.bQ(v,0,s.Z,s.Z,0,0,1);else if(p.canonical.isChildOf(e.canonical)){let x=p.canonical.z-e.canonical.z,C=p.canonical.x-(p.canonical.x>>x<<x),T=p.canonical.y-(p.canonical.y>>x<<x),k=s.Z>>x;s.bQ(v,0,k,k,0,0,1),s.L(v,v,[-C*k,-T*k,0])}else{if(!e.canonical.isChildOf(p.canonical))continue;{let x=e.canonical.z-p.canonical.z,C=e.canonical.x-(e.canonical.x>>x<<x),T=e.canonical.y-(e.canonical.y>>x<<x),k=s.Z>>x;s.bQ(v,0,s.Z,s.Z,0,0,1),s.L(v,v,[C*k,T*k,0]),s.M(v,v,[1/2**x,1/2**x,0])}}g.terrainRttPosMatrix32f=new Float32Array(v),n[u]=g}return n}_getTerrainCoordsForTileRanges(e,n){let u={};for(let p of this._renderableTilesKeys){let g=this._tiles[p].tileID;if(!this._isWithinTileRanges(g,n))continue;let v=e.clone(),x=s.b2();if(g.canonical.z===e.canonical.z){let C=e.canonical.x-g.canonical.x,T=e.canonical.y-g.canonical.y;s.bQ(x,0,s.Z,s.Z,0,0,1),s.L(x,x,[C*s.Z,T*s.Z,0])}else if(g.canonical.z>e.canonical.z){let C=g.canonical.z-e.canonical.z,T=g.canonical.x-(g.canonical.x>>C<<C),k=g.canonical.y-(g.canonical.y>>C<<C),R=e.canonical.x-(g.canonical.x>>C),D=e.canonical.y-(g.canonical.y>>C),j=s.Z>>C;s.bQ(x,0,j,j,0,0,1),s.L(x,x,[-T*j+R*s.Z,-k*j+D*s.Z,0])}else{let C=e.canonical.z-g.canonical.z,T=e.canonical.x-(e.canonical.x>>C<<C),k=e.canonical.y-(e.canonical.y>>C<<C),R=(e.canonical.x>>C)-g.canonical.x,D=(e.canonical.y>>C)-g.canonical.y,j=s.Z<<C;s.bQ(x,0,j,j,0,0,1),s.L(x,x,[T*s.Z+R*j,k*s.Z+D*j,0])}v.terrainRttPosMatrix32f=new Float32Array(x),u[p]=v}return u}getSourceTile(e,n){let u=this.sourceCache._source,p=e.overscaledZ-this.deltaZoom;if(p>u.maxzoom&&(p=u.maxzoom),p<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(p).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!g||!g.dem)&&n)for(;p>=u.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(e.scaledTo(p--).key);return g}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,n){return n[e.canonical.z]&&e.canonical.x>=n[e.canonical.z].minTileX&&e.canonical.x<=n[e.canonical.z].maxTileX&&e.canonical.y>=n[e.canonical.z].minTileY&&e.canonical.y<=n[e.canonical.z].maxTileY}}class um{constructor(e,n,u){this._meshCache={},this.painter=e,this.sourceCache=new dm(n),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,u,p=s.Z){var g;if(!(n>=0&&n<p&&u>=0&&u<p))return 0;let v=this.getTerrainData(e),x=(g=v.tile)===null||g===void 0?void 0:g.dem;if(!x)return 0;let C=s.cj([],[n/p*s.Z,u/p*s.Z],v.u_terrain_matrix),T=[C[0]*x.dim,C[1]*x.dim],k=Math.floor(T[0]),R=Math.floor(T[1]),D=T[0]-k,j=T[1]-R;return x.get(k,R)*(1-D)*(1-j)+x.get(k+1,R)*D*(1-j)+x.get(k,R+1)*(1-D)*j+x.get(k+1,R+1)*D*j}getElevationForLngLatZoom(e,n){if(!s.ck(n,e.wrap()))return 0;let{tileID:u,mercatorX:p,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(u,p%s.Z,g%s.Z,s.Z)}getElevation(e,n,u,p=s.Z){return this.getDEMElevation(e,n,u,p)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let p=this.painter.context,g=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new pi(p,g,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new pi(p,new s.R({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ad([])}let n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){let p=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new pi(p,n.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),n.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}let u=n&&n+n.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){let p=this.sourceCache.sourceCache._source.maxzoom,g=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=p?g=e.canonical.z-p:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let v=e.canonical.x-(e.canonical.x>>g<<g),x=e.canonical.y-(e.canonical.y>>g<<g),C=s.cl(new Float64Array(16),[1/(s.Z<<g),1/(s.Z<<g),0]);s.L(C,C,[v*s.Z,x*s.Z,0]),this._demMatrixCache[e.key]={matrix:C,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){let n=this.painter,u=n.width/devicePixelRatio,p=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new pi(n.context,{width:u,height:p,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new pi(n.context,{width:u,height:p,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(u,p,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,u,p))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,v=0;g<this._coordsTextureSize;g++)for(let x=0;x<this._coordsTextureSize;x++,v+=4)n[v+0]=255&x,n[v+1]=255&g,n[v+2]=x>>8<<4|g>>8,n[v+3]=0;let u=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),p=new pi(e,u,e.gl.RGBA,{premultiply:!1});return p.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let n=new Uint8Array(4),u=this.painter.context,p=u.gl,g=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),v=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),x=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(g,x-v-1,1,1,p.RGBA,p.UNSIGNED_BYTE,n),u.bindFramebuffer.set(null);let C=n[0]+(n[2]>>4<<8),T=n[1]+((15&n[2])<<8),k=this.coordsIndex[255-n[3]],R=k&&this.sourceCache.getTileByID(k);if(!R)return null;let D=this._coordsTextureSize,j=(1<<R.tileID.canonical.z)*D;return new s.$((R.tileID.canonical.x*D+C)/j+R.tileID.wrap,(R.tileID.canonical.y*D+T)/j,this.getElevation(R.tileID,C,T,D))}depthAtPoint(e){let n=new Uint8Array(4),u=this.painter.context,p=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),p.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,n),u.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;let u=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,p=u&&e.canonical.y===0,g=u&&e.canonical.y===(1<<e.canonical.z)-1,v=`m_${p?"n":""}_${g?"s":""}`;if(this._meshCache[v])return this._meshCache[v];let x=this.painter.context,C=new s.cm,T=new s.aK,k=this.meshSize,R=s.Z/k,D=k*k;for(let pe=0;pe<=k;pe++)for(let Se=0;Se<=k;Se++)C.emplaceBack(Se*R,pe*R,0);for(let pe=0;pe<D;pe+=k+1)for(let Se=0;Se<k;Se++)T.emplaceBack(Se+pe,k+Se+pe+1,k+Se+pe+2),T.emplaceBack(Se+pe,k+Se+pe+2,Se+pe+1);let j=C.length,U=j+(k+1),te=(k+1)*k,ee=p?s.b9:0,ie=p?0:1,se=g?s.ba:s.Z,ue=g?0:1;for(let pe=0;pe<=k;pe++)C.emplaceBack(pe*R,ee,ie);for(let pe=0;pe<=k;pe++)C.emplaceBack(pe*R,se,ue);for(let pe=0;pe<k;pe++)T.emplaceBack(te+pe,U+pe,U+pe+1),T.emplaceBack(te+pe,U+pe+1,te+pe+1),T.emplaceBack(0+pe,j+pe+1,j+pe),T.emplaceBack(0+pe,0+pe+1,j+pe+1);let de=C.length,he=de+2*(k+1);for(let pe of[0,1])for(let Se=0;Se<=k;Se++)for(let Be of[0,1])C.emplaceBack(pe*s.Z,Se*R,Be);for(let pe=0;pe<2*k;pe+=2)T.emplaceBack(de+pe,de+pe+1,de+pe+3),T.emplaceBack(de+pe,de+pe+3,de+pe+2),T.emplaceBack(he+pe,he+pe+3,he+pe+1),T.emplaceBack(he+pe,he+pe+2,he+pe+3);let _e=new Ls(x.createVertexBuffer(C,cm.members),x.createIndexBuffer(T),s.aJ.simpleSegment(0,0,C.length,T.length));return this._meshCache[v]=_e,_e}getMeshFrameDelta(e){return 2*Math.PI*s.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var u;let{tileID:p}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(u=this.getMinMaxElevation(p).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){let n=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return n&&n.dem&&(u.minElevation=n.dem.min*this.exaggeration,u.maxElevation=n.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,n){let u=s.$.fromLngLat(e.wrap()),p=(1<<n)*s.Z,g=u.x*p,v=u.y*p,x=Math.floor(g/s.Z),C=Math.floor(v/s.Z);return{tileID:new s.Y(n,0,n,x,C),mercatorX:g,mercatorY:v}}}class $g{constructor(e,n,u){this._context=e,this._size=n,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new pi(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(u.texture),{id:e,fbo:n,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}let vr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Gd{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new $g(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(n)),this._coordsAscending={};for(let u in e.sourceCaches){this._coordsAscending[u]={};let p=e.sourceCaches[u].getVisibleCoordinates(),g=e.sourceCaches[u].getSource(),v=g instanceof Fn?g.terrainTileRanges:null;for(let x of p){let C=this.terrain.sourceCache.getTerrainCoords(x,v);for(let T in C)this._coordsAscending[u][T]||(this._coordsAscending[u][T]=[]),this._coordsAscending[u][T].push(C[T])}}this._coordsAscendingStr={};for(let u of e._order){let p=e._layers[u],g=p.source;if(vr[p.type]&&!this._coordsAscendingStr[g]){this._coordsAscendingStr[g]={};for(let v in this._coordsAscending[g])this._coordsAscendingStr[g][v]=this._coordsAscending[g][v].map(x=>x.key).sort().join()}}for(let u of this._renderableTiles)for(let p in this._coordsAscendingStr){let g=this._coordsAscendingStr[p][u.tileID.key];g&&g!==u.rttCoords[p]&&(u.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;let u=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),p=e.type,g=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(vr[p]&&(this._prevType&&vr[this._prevType]||this._stacks.push([]),this._prevType=p,this._stacks[this._stacks.length-1].push(e.id),!v))return!0;if(vr[this._prevType]||vr[p]&&v){this._prevType=p;let x=this._stacks.length-1,C=this._stacks[x]||[];for(let T of this._renderableTiles){if(this.pool.isFull()&&(ti(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[x]){let R=this.pool.getObjectForId(T.rtt[x].id);if(R.stamp===T.rtt[x].stamp){this.pool.useObject(R);continue}}let k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),T.rtt[x]={id:k.id,stamp:k.stamp},g.context.bindFramebuffer.set(k.fbo.framebuffer),g.context.clear({color:s.b7.transparent,stencil:0}),g.currentStencilSource=void 0;for(let R=0;R<C.length;R++){let D=g.style._layers[C[R]],j=D.source?this._coordsAscending[D.source][T.tileID.key]:[T.tileID];g.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),g._renderTileClippingMasks(D,j,!0),g.renderLayer(g,g.style.sourceCaches[D.source],D,j,u),D.source&&(T.rttCoords[D.source]=this._coordsAscendingStr[D.source][T.tileID.key])}}return ti(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects(),vr[p]}return!1}}let pt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ct=P,Fc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ys,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ch={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class dh{constructor(e,n,u=!1){this.mousedown=g=>{this.startMove(g,$.mousePos(this.element,g)),$.addEventListener(window,"mousemove",this.mousemove),$.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=g=>{this.move(g,$.mousePos(this.element,g))},this.mouseup=g=>{this._rotatePitchHanlder.dragEnd(g),this.offTemp()},this.touchstart=g=>{g.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=$.touchPos(this.element,g.targetTouches)[0],this.startMove(g,this._startPos),$.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),$.addEventListener(window,"touchend",this.touchend))},this.touchmove=g=>{g.targetTouches.length!==1?this.reset():(this._lastPos=$.touchPos(this.element,g.targetTouches)[0],this.move(g,this._lastPos))},this.touchend=g=>{g.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;let p=new Ll;this._rotatePitchHanlder=new cr({clickTolerance:3,move:(g,v)=>{let x=n.getBoundingClientRect(),C=new s.P((x.bottom-x.top)/2,(x.right-x.left)/2);return{bearingDelta:s.ce(new s.P(g.x,v.y),v,C),pitchDelta:u?-.5*(v.y-g.y):void 0}},moveStateManager:p,enable:!0,assignEvents:()=>{}}),this.map=e,$.addEventListener(n,"mousedown",this.mousedown),$.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),$.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),$.disableDrag()}move(e,n){let u=this.map,{bearingDelta:p,pitchDelta:g}=this._rotatePitchHanlder.dragMove(e,n)||{};p&&u.setBearing(u.getBearing()+p),g&&u.setPitch(u.getPitch()+g)}off(){let e=this.element;$.removeEventListener(e,"mousedown",this.mousedown),$.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),$.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),$.removeEventListener(window,"touchend",this.touchend),$.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){$.enableDrag(),$.removeEventListener(window,"mousemove",this.mousemove),$.removeEventListener(window,"mouseup",this.mouseup),$.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),$.removeEventListener(window,"touchend",this.touchend)}}let gn;function uh(f,e,n,u=!1){if(u||!n.getCoveringTilesDetailsProvider().allowWorldCopies())return f?.wrap();let p=new s.Q(f.lng,f.lat);if(f=new s.Q(f.lng,f.lat),e){let g=new s.Q(f.lng-360,f.lat),v=new s.Q(f.lng+360,f.lat),x=n.locationToScreenPoint(f).distSqr(e);n.locationToScreenPoint(g).distSqr(e)<x?f=g:n.locationToScreenPoint(v).distSqr(e)<x&&(f=v)}for(;Math.abs(f.lng-n.center.lng)>180;){let g=n.locationToScreenPoint(f);if(g.x>=0&&g.y>=0&&g.x<=n.width&&g.y<=n.height)break;f.lng>n.center.lng?f.lng-=360:f.lng+=360}return f.lng!==p.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(f))?f:p}let no={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hm(f,e,n){let u=f.classList;for(let p in no)u.remove(`maplibregl-${n}-anchor-${p}`);u.add(`maplibregl-${n}-anchor-${e}`)}class $a extends s.E{constructor(e){if(super(),this._onKeyPress=n=>{let u=n.code,p=n.charCode||n.keyCode;u!=="Space"&&u!=="Enter"&&p!==32&&p!==13||this.togglePopup()},this._onMapClick=n=>{let u=n.originalEvent.target,p=this._element;this._popup&&(u===p||p.contains(u))&&this.togglePopup()},this._update=n=>{if(!this._map)return;let u=this._map.loaded()&&!this._map.isMoving();(n?.type==="terrain"||n?.type==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=uh(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),$.setTransform(this._element,`${no[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${p}`),ve.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){let u=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=s.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=$.create("div");let n=$.createNS("http://www.w3.org/2000/svg","svg"),u=41,p=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${u}px`),n.setAttributeNS(null,"width",`${p}px`),n.setAttributeNS(null,"viewBox",`0 0 ${p} ${u}`);let g=$.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");let v=$.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");let x=$.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(3.0, 29.0)"),x.setAttributeNS(null,"fill","#000000");let C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let ie of C){let se=$.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",ie.rx),se.setAttributeNS(null,"ry",ie.ry),x.appendChild(se)}let T=$.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill",this._color);let k=$.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),T.appendChild(k);let R=$.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");let D=$.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild(D);let j=$.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(6.0, 7.0)"),j.setAttributeNS(null,"fill","#FFFFFF");let U=$.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"transform","translate(8.0, 8.0)");let te=$.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");let ee=$.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),U.appendChild(te),U.appendChild(ee),v.appendChild(x),v.appendChild(T),v.appendChild(R),v.appendChild(j),v.appendChild(U),n.appendChild(v),n.setAttributeNS(null,"height",u*this._scale+"px"),n.setAttributeNS(null,"width",p*this._scale+"px"),this._element.appendChild(n),this._offset=s.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),hm(this._element,this._anchor,"marker"),e&&e.className)for(let n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),$.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=s.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let p=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){let e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,u;let p=(n=this._map)===null||n===void 0?void 0:n.terrain,g=this._map.transform.isLocationOccluded(this._lngLat);if(!p||g){let j=g?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==j&&(this._element.style.opacity=j))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let v=this._map,x=v.terrain.depthAtPoint(this._pos),C=v.terrain.getElevationForLngLatZoom(this._lngLat,v.transform.tileZoom);if(v.transform.lngLatToCameraDepth(this._lngLat,C)-x<.006)return void(this._element.style.opacity=this._opacity);let T=-this._offset.y/v.transform.pixelsPerMeter,k=Math.sin(v.getPitch()*Math.PI/180)*T,R=v.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),D=v.transform.lngLatToCameraDepth(this._lngLat,C+k)-R>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&D&&this._popup.remove(),this._element.style.opacity=D?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=s.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return(this._opacity===void 0||e===void 0&&n===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}let Ji={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Wi=0,Nl=!1,Lc={maxWidth:100,unit:"metric"};function zc(f,e,n){let u=n&&n.maxWidth||100,p=f._container.clientHeight/2,g=f._container.clientWidth/2,v=f.unproject([g-u/2,p]),x=f.unproject([g+u/2,p]),C=Math.round(f.project(x).x-f.project(v).x),T=Math.min(u,C,f._container.clientWidth),k=v.distanceTo(x);if(n&&n.unit==="imperial"){let R=3.2808*k;R>5280?Ga(e,T,R/5280,f._getUIString("ScaleControl.Miles")):Ga(e,T,R,f._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Ga(e,T,k/1852,f._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Ga(e,T,k/1e3,f._getUIString("ScaleControl.Kilometers")):Ga(e,T,k,f._getUIString("ScaleControl.Meters"))}function Ga(f,e,n,u){let p=function(g){let v=Math.pow(10,`${Math.floor(g)}`.length-1),x=g/v;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:function(C){let T=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*T)/T}(x),v*x}(n);f.style.width=e*(p/n)+"px",f.innerHTML=`${p}&nbsp;${u}`}let hh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},ph=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Vl(f){if(f){if(typeof f=="number"){let e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,f),"top-left":new s.P(e,e),"top-right":new s.P(-e,e),bottom:new s.P(0,-f),"bottom-left":new s.P(e,-e),"bottom-right":new s.P(-e,-e),left:new s.P(f,0),right:new s.P(-f,0)}}if(f instanceof s.P||Array.isArray(f)){let e=s.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:s.P.convert(f.center||[0,0]),top:s.P.convert(f.top||[0,0]),"top-left":s.P.convert(f["top-left"]||[0,0]),"top-right":s.P.convert(f["top-right"]||[0,0]),bottom:s.P.convert(f.bottom||[0,0]),"bottom-left":s.P.convert(f["bottom-left"]||[0,0]),"bottom-right":s.P.convert(f["bottom-right"]||[0,0]),left:s.P.convert(f.left||[0,0]),right:s.P.convert(f.right||[0,0])}}return Vl(new s.P(0,0))}let mh=P;h.AJAXError=s.cq,h.Event=s.l,h.Evented=s.E,h.LngLat=s.Q,h.MercatorCoordinate=s.$,h.Point=s.P,h.addProtocol=s.cr,h.config=s.a,h.removeProtocol=s.cs,h.AttributionControl=Li,h.BoxZoomHandler=ih,h.CanvasSource=Lo,h.CooperativeGesturesHandler=Ud,h.DoubleClickZoomHandler=jd,h.DragPanHandler=am,h.DragRotateHandler=lm,h.EdgeInsets=va,h.FullscreenControl=class extends s.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){$.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let f=this._fullscreenButton=$.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);$.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},h.GeoJSONSource=Pn,h.GeolocateControl=class extends s.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{let n=new s.Q(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,p=this._map.getBearing(),g=s.e({bearing:p},this.options.fitBoundsOptions),v=xi.fromLngLat(n,u);this._map.fitBounds(v,g,{geolocateSource:!0})},this._updateMarker=e=>{if(e){let n=new s.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Nl)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=$.create("button","maplibregl-ctrl-geolocate",this._container),$.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");let n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{let n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=$.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new $a({element:this._dotElement}),this._circleElement=$.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $a({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},Ji,f)}onAdd(f){return this._map=f,this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(e=!1){if(gn!==void 0&&!e)return gn;if(window.navigator.permissions===void 0)return gn=!!window.navigator.geolocation,gn;try{gn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{gn=!!window.navigator.geolocation}return gn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),$.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Wi=0,Nl=!1}_isOutOfMapMaxBounds(f){let e=this._map.getMaxBounds(),n=f.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let f=this._map.getBounds(),e=f.getSouthEast(),n=f.getNorthEast(),u=e.distanceTo(n),p=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Wi--,Nl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Wi++,Wi>1?(f={maximumAge:6e5,timeout:0},Nl=!0):(f=this.options.positionOptions,Nl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},h.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;let e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=$.create("button","maplibregl-ctrl-globe",this._container),$.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){$.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},h.Hash=Qu,h.ImageSource=Fn,h.KeyboardHandler=Bl,h.LngLatBounds=xi,h.LogoControl=Oc,h.Map=class extends Ug{constructor(f){var e,n;s.cn.mark(s.co.create);let u=Object.assign(Object.assign(Object.assign({},Fc),f),{canvasContextAttributes:Object.assign(Object.assign({},Fc.canvasContextAttributes),f.canvasContextAttributes)});if(u.minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");let p=new zs,g=new ba;if(u.minZoom!==void 0&&p.setMinZoom(u.minZoom),u.maxZoom!==void 0&&p.setMaxZoom(u.maxZoom),u.minPitch!==void 0&&p.setMinPitch(u.minPitch),u.maxPitch!==void 0&&p.setMaxPitch(u.maxPitch),u.renderWorldCopies!==void 0&&p.setRenderWorldCopies(u.renderWorldCopies),super(p,g,{bearingSnap:u.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new lh,this._controls=[],this._mapId=s.a4(),this._contextLost=x=>{x.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:x}))},this._contextRestored=x=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:x}))},this._onMapScroll=x=>{if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._maxTileCacheZoomLevels=u.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},u.canvasContextAttributes),this._trackResize=u.trackResize===!0,this._bearingSnap=u.bearingSnap,this._centerClampedToGround=u.centerClampedToGround,this._refreshExpiredTiles=u.refreshExpiredTiles===!0,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions===!0,this._collectResourceTiming=u.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},pt),u.locale),this._clickTolerance=u.clickTolerance,this._overridePixelRatio=u.pixelRatio,this._maxCanvasSize=u.maxCanvasSize,this.transformCameraUpdate=u.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=u.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Mi.addThrottleControl(()=>this.isMoving()),this._requestManager=new At(u.transformRequest),typeof u.container=="string"){if(this._container=document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let x=!1,C=_s(T=>{this._trackResize&&!this._removed&&(this.resize(T),this.redraw())},50);this._resizeObserver=new ResizeObserver(T=>{x?C(T):x=!0}),this._resizeObserver.observe(this._container)}this.handlers=new jg(this,u),this._hash=u.hash&&new Qu(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,elevation:u.elevation,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,roll:u.roll}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,s.e({},u.fitBoundsOptions,{duration:0}))));let v=typeof u.style=="string"||((n=(e=u.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,v),this._localIdeographFontFamily=u.localIdeographFontFamily,this._validateStyle=u.validateStyle,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Li(typeof u.attributionControl=="boolean"?void 0:u.attributionControl)),u.maplibreLogo&&this.addControl(new Oc,u.logoPosition),this.on("style.load",()=>{if(v||this._resizeTransform(),this.transform.unmodified){let x=s.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(x)}}),this.on("data",x=>{this._update(x.dataType==="style"),this.fire(new s.l(`${x.dataType}data`,x))}),this.on("dataloading",x=>{this.fire(new s.l(`${x.dataType}dataloading`,x))}),this.on("dataabort",x=>{this.fire(new s.l("sourcedataabort",x))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let n=f.onAdd(this);this._controls.push(f);let u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(n,u.firstChild):u.appendChild(n),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,n,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,n,u)}resize(f,e=!0){let[n,u]=this._containerDimensions(),p=this._getClampedPixelRatio(n,u);if(this._resizeCanvas(n,u,p),this.painter.resize(n,u,p),this.painter.overLimit()){let v=this.painter.context.gl;this._maxCanvasSize=[v.drawingBufferWidth,v.drawingBufferHeight];let x=this._getClampedPixelRatio(n,u);this._resizeCanvas(n,u,x),this.painter.resize(n,u,x)}this._resizeTransform(e);let g=!this._moving;return g&&(this.stop(),this.fire(new s.l("movestart",f)).fire(new s.l("move",f))),this.fire(new s.l("resize",f)),g&&this.fire(new s.l("moveend",f)),this}_resizeTransform(f=!0){var e;let[n,u]=this._containerDimensions();this.transform.resize(n,u,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,u,f)}_getClampedPixelRatio(f,e){let{0:n,1:u}=this._maxCanvasSize,p=this.getPixelRatio(),g=f*p,v=e*p;return Math.min(g>n?n/g:1,v>u?u/v:1)*p}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(xi.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(s.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(s.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,n){if(f==="mouseenter"||f==="mouseover"){let u=!1;return{layers:e,listener:n,delegates:{mousemove:g=>{let v=e.filter(C=>this.getLayer(C)),x=v.length!==0?this.queryRenderedFeatures(g.point,{layers:v}):[];x.length?u||(u=!0,n.call(this,new Tn(f,this,g.originalEvent,{features:x}))):u=!1},mouseout:()=>{u=!1}}}}if(f==="mouseleave"||f==="mouseout"){let u=!1;return{layers:e,listener:n,delegates:{mousemove:v=>{let x=e.filter(C=>this.getLayer(C));(x.length!==0?this.queryRenderedFeatures(v.point,{layers:x}):[]).length?u=!0:u&&(u=!1,n.call(this,new Tn(f,this,v.originalEvent)))},mouseout:v=>{u&&(u=!1,n.call(this,new Tn(f,this,v.originalEvent)))}}}}{let u=p=>{let g=e.filter(x=>this.getLayer(x)),v=g.length!==0?this.queryRenderedFeatures(p.point,{layers:g}):[];v.length&&(p.features=v,n.call(this,p),delete p.features)};return{layers:e,listener:n,delegates:{[f]:u}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,n){if(!this._delegatedListeners||!this._delegatedListeners[f])return;let u=this._delegatedListeners[f];for(let p=0;p<u.length;p++){let g=u[p];if(g.listener===n&&g.layers.length===e.length&&g.layers.every(v=>e.includes(v))){for(let v in g.delegates)this.off(v,g.delegates[v]);return void u.splice(p,1)}}}on(f,e,n){if(n===void 0)return super.on(f,e);let u=typeof e=="string"?[e]:e,p=this._createDelegatedListener(f,u,n);this._saveDelegatedListener(f,p);for(let g in p.delegates)this.on(g,p.delegates[g]);return{unsubscribe:()=>{this._removeDelegatedListener(f,u,n)}}}once(f,e,n){if(n===void 0)return super.once(f,e);let u=typeof e=="string"?[e]:e,p=this._createDelegatedListener(f,u,n);for(let g in p.delegates){let v=p.delegates[g];p.delegates[g]=(...x)=>{this._removeDelegatedListener(f,u,n),v(...x)}}this._saveDelegatedListener(f,p);for(let g in p.delegates)this.once(g,p.delegates[g]);return this}off(f,e,n){return n===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let n,u=f instanceof s.P||Array.isArray(f),p=u?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:f)||{},p instanceof s.P||typeof p[0]=="number")n=[s.P.convert(p)];else{let g=s.P.convert(p[0]),v=s.P.convert(p[1]);n=[g,new s.P(v.x,g.y),v,new s.P(g.x,v.y),g]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){let e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var n,u;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));let p=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Ns(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,p):this.style.loadJSON(f,e,p),this):((u=(n=this.style)===null||n===void 0?void 0:n.projection)===null||u===void 0||u.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ns(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){let n=this._requestManager.transformRequest(f,"Style");s.j(n,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new s.k(u))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(n){s.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){let e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new s.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){let e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(let n in this.style._layers){let u=this.style._layers[n];u.type==="hillshade"&&u.source===f.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new um(this.painter,e,f),this.painter.renderToTexture=new Gd(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{var u;n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((u=n.source)===null||u===void 0?void 0:u.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){let f=this.style&&this.style.sourceCaches;for(let e in f){let n=f[e]._tiles;for(let u in n){let p=n[u];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}setSourceTileLodParams(f,e,n){if(n){let u=this.getSource(n);if(!u)throw new Error(`There is no source with ID "${n}", cannot set LOD parameters`);u.calculateTileZoom=fe(Math.max(1,f),Math.max(1,e))}else for(let u in this.style.sourceCaches)this.style.sourceCaches[u].getSource().calculateTileZoom=fe(Math.max(1,f),Math.max(1,e));return this._update(!0),this}refreshTiles(f,e){let n=this.style.sourceCaches[f];if(!n)throw new Error(`There is no source cache with ID "${f}", cannot refresh tile`);e===void 0?n.reload():n.refreshTiles(e.map(u=>new s.a1(u.z,u.x,u.y)))}addImage(f,e,n={}){let{pixelRatio:u=1,sdf:p=!1,stretchX:g,stretchY:v,content:x,textFitWidth:C,textFitHeight:T}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||s.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:k,height:R,data:D}=e,j=e;return this.style.addImage(f,{data:new s.R({width:k,height:R},new Uint8Array(D)),pixelRatio:u,stretchX:g,stretchY:v,content:x,textFitWidth:C,textFitHeight:T,sdf:p,version:0,userImage:j}),j.onAdd&&j.onAdd(this,f),this}}{let{width:k,height:R,data:D}=ve.getImageData(e);this.style.addImage(f,{data:new s.R({width:k,height:R},D),pixelRatio:u,stretchX:g,stretchY:v,content:x,textFitWidth:C,textFitHeight:T,sdf:p,version:0})}}updateImage(f,e){let n=this.style.getImage(f);if(!n)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let u=e instanceof HTMLImageElement||s.b(e)?ve.getImageData(e):e,{width:p,height:g,data:v}=u;if(p===void 0||g===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==n.data.width||g!==n.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));let x=!(e instanceof HTMLImageElement||s.b(e));return n.data.replace(v,x),this.style.updateImage(f,n),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return Mi.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,n){return this.style.setLayerZoomRange(f,e,n),this._update(!0)}setFilter(f,e,n={}){return this.style.setFilter(f,e,n),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,n,u={}){return this.style.setPaintProperty(f,e,n,u),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,n,u={}){return this.style.setLayoutProperty(f,e,n,u),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,n,u=>{u||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,n=>{n||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){let f=this._container;f.classList.add("maplibregl-map");let e=this._canvasContainer=$.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=$.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let n=this._containerDimensions(),u=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],u);let p=this._controlContainer=$.create("div","maplibregl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{g[v]=$.create("div",`maplibregl-ctrl-${v} `,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,n){this._canvas.width=Math.floor(n*f),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){let f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0}),e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:f},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!n){let u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new $o(n,this.transform),$e.testSupport(n)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,n,u,p,g;let v=this._idleTriggered?this._fadeDuration:0,x=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let R=this.transform.zoom,D=ve.now();this.style.zoomHistory.update(R,D);let j=new s.C(R,{now:D,fadeDuration:v,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),U=j.crossFadingFactor();U===1&&U===this._crossFadingFactor||(C=!0,this._crossFadingFactor=U),this.style.update(j)}let T=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==x;(u=this.style.projection)===null||u===void 0||u.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((p=this.style.projection)===null||p===void 0?void 0:p.transitionState,(g=this.style.projection)===null||g===void 0?void 0:g.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||T)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,T),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cn.mark(s.co.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,s.cn.mark(s.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(let n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Mi.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();let e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),$.remove(this._canvasContainer),$.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cn.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ve.frame(this._frameRequest,f=>{s.cn.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!s.cp(e)&&!function(n){return n.message===Sl}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return Ct}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},h.MapMouseEvent=Tn,h.MapTouchEvent=Dl,h.MapWheelEvent=th,h.Marker=$a,h.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{let e=this._map.getZoom(),n=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{let u=this._map._getUIString(`NavigationControl.${n}`);e.title=u,e.setAttribute("aria-label",u)},this.options=s.e({},ch,f),this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),$.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),$.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=$.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new dh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){$.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){let n=$.create("button",f,this._container);return n.type="button",n.addEventListener("click",e),n}},h.Popup=class extends s.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&$.remove(this._content),this._container&&($.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=$.create("div","maplibregl-popup",this._map.getContainer()),this._tip=$.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let v of this.options.className.split(" "))this._container.classList.add(v);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=uh(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;let n=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let u=this.options.anchor,p=Vl(this.options.offset);if(!u){let v=this._container.offsetWidth,x=this._container.offsetHeight,C;C=n.y+p.bottom.y<x?["top"]:n.y>this._map.transform.height-x?["bottom"]:[],n.x<v/2?C.push("left"):n.x>this._map.transform.width-v/2&&C.push("right"),u=C.length===0?"bottom":C.join("-")}let g=n.add(p[u]);this.options.subpixelPositioning||(g=g.round()),$.setTransform(this._container,`${no[u]} translate(${g.x}px,${g.y}px)`),hm(this._container,u,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(hh),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=s.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){let e=document.createDocumentFragment(),n=document.createElement("body"),u;for(n.innerHTML=f;u=n.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=$.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=$.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let f=this._container.querySelector(ph);f&&f.focus()}},h.RasterDEMTileSource=ha,h.RasterTileSource=on,h.ScaleControl=class{constructor(f){this._onMove=()=>{zc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,zc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Lc),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){$.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},h.ScrollZoomHandler=Yt,h.Style=Ns,h.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=$.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=$.create("button","maplibregl-ctrl-terrain",this._container),$.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){$.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},h.TwoFingersTouchPitchHandler=Vd,h.TwoFingersTouchRotateHandler=nt,h.TwoFingersTouchZoomHandler=zl,h.TwoFingersTouchZoomRotateHandler=ah,h.VectorTileSource=rn,h.VideoSource=zr,h.addSourceType=(f,e)=>s._(void 0,void 0,void 0,function*(){if(sn(f))throw new Error(`A source type called "${f}" already exists.`);((n,u)=>{Kt[n]=u})(f,e)}),h.clearPrewarmedResources=function(){let f=wn;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(po),wn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},h.createTileMesh=xa,h.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},h.getRTLTextPluginStatus=function(){return Oi().getRTLTextPluginStatus()},h.getVersion=function(){return mh},h.getWorkerCount=function(){return nn.workerCount},h.getWorkerUrl=function(){return s.a.WORKER_URL},h.importScriptInWorkers=function(f){return is().broadcast("IS",f)},h.prewarm=function(){mr().acquire(po)},h.setMaxParallelImageRequests=function(f){s.a.MAX_PARALLEL_IMAGE_REQUESTS=f},h.setRTLTextPlugin=function(f,e){return Oi().setRTLTextPlugin(f,e)},h.setWorkerCount=function(f){nn.workerCount=f},h.setWorkerUrl=function(f){s.a.WORKER_URL=f}});var l=c;return l})});var Jh=class{},rf=class{},Ts=class c{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(a){a?typeof a=="string"?this.lazyInit=()=>{this.headers=new Map,a.split(`
`).forEach(i=>{let l=i.indexOf(":");if(l>0){let h=i.slice(0,l),s=i.slice(l+1).trim();this.addHeaderEntry(h,s)}})}:typeof Headers<"u"&&a instanceof Headers?(this.headers=new Map,a.forEach((i,l)=>{this.addHeaderEntry(l,i)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(a).forEach(([i,l])=>{this.setHeaderEntries(i,l)})}:this.headers=new Map}has(a){return this.init(),this.headers.has(a.toLowerCase())}get(a){this.init();let i=this.headers.get(a.toLowerCase());return i&&i.length>0?i[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(a){return this.init(),this.headers.get(a.toLowerCase())||null}append(a,i){return this.clone({name:a,value:i,op:"a"})}set(a,i){return this.clone({name:a,value:i,op:"s"})}delete(a,i){return this.clone({name:a,value:i,op:"d"})}maybeSetNormalizedName(a,i){this.normalizedNames.has(i)||this.normalizedNames.set(i,a)}init(){this.lazyInit&&(this.lazyInit instanceof c?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(a=>this.applyUpdate(a)),this.lazyUpdate=null))}copyFrom(a){a.init(),Array.from(a.headers.keys()).forEach(i=>{this.headers.set(i,a.headers.get(i)),this.normalizedNames.set(i,a.normalizedNames.get(i))})}clone(a){let i=new c;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof c?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([a]),i}applyUpdate(a){let i=a.name.toLowerCase();switch(a.op){case"a":case"s":let l=a.value;if(typeof l=="string"&&(l=[l]),l.length===0)return;this.maybeSetNormalizedName(a.name,i);let h=(a.op==="a"?this.headers.get(i):void 0)||[];h.push(...l),this.headers.set(i,h);break;case"d":let s=a.value;if(!s)this.headers.delete(i),this.normalizedNames.delete(i);else{let P=this.headers.get(i);if(!P)return;P=P.filter(q=>s.indexOf(q)===-1),P.length===0?(this.headers.delete(i),this.normalizedNames.delete(i)):this.headers.set(i,P)}break}}addHeaderEntry(a,i){let l=a.toLowerCase();this.maybeSetNormalizedName(a,l),this.headers.has(l)?this.headers.get(l).push(i):this.headers.set(l,[i])}setHeaderEntries(a,i){let l=(Array.isArray(i)?i:[i]).map(s=>s.toString()),h=a.toLowerCase();this.headers.set(h,l),this.maybeSetNormalizedName(a,h)}forEach(a){this.init(),Array.from(this.normalizedNames.keys()).forEach(i=>a(this.normalizedNames.get(i),this.headers.get(i)))}};var K_=class{encodeKey(a){return Dx(a)}encodeValue(a){return Dx(a)}decodeKey(a){return decodeURIComponent(a)}decodeValue(a){return decodeURIComponent(a)}};function BM(c,a){let i=new Map;return c.length>0&&c.replace(/^\?/,"").split("&").forEach(h=>{let s=h.indexOf("="),[P,q]=s==-1?[a.decodeKey(h),""]:[a.decodeKey(h.slice(0,s)),a.decodeValue(h.slice(s+1))],X=i.get(P)||[];X.push(q),i.set(P,X)}),i}var NM=/%(\d[a-f0-9])/gi,VM={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Dx(c){return encodeURIComponent(c).replace(NM,(a,i)=>VM[i]??a)}function nf(c){return`${c}`}var oa=class c{map;encoder;updates=null;cloneFrom=null;constructor(a={}){if(this.encoder=a.encoder||new K_,a.fromString){if(a.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=BM(a.fromString,this.encoder)}else a.fromObject?(this.map=new Map,Object.keys(a.fromObject).forEach(i=>{let l=a.fromObject[i],h=Array.isArray(l)?l.map(nf):[nf(l)];this.map.set(i,h)})):this.map=null}has(a){return this.init(),this.map.has(a)}get(a){this.init();let i=this.map.get(a);return i?i[0]:null}getAll(a){return this.init(),this.map.get(a)||null}keys(){return this.init(),Array.from(this.map.keys())}append(a,i){return this.clone({param:a,value:i,op:"a"})}appendAll(a){let i=[];return Object.keys(a).forEach(l=>{let h=a[l];Array.isArray(h)?h.forEach(s=>{i.push({param:l,value:s,op:"a"})}):i.push({param:l,value:h,op:"a"})}),this.clone(i)}set(a,i){return this.clone({param:a,value:i,op:"s"})}delete(a,i){return this.clone({param:a,value:i,op:"d"})}toString(){return this.init(),this.keys().map(a=>{let i=this.encoder.encodeKey(a);return this.map.get(a).map(l=>i+"="+this.encoder.encodeValue(l)).join("&")}).filter(a=>a!=="").join("&")}clone(a){let i=new c({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(a),i}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(a=>this.map.set(a,this.cloneFrom.map.get(a))),this.updates.forEach(a=>{switch(a.op){case"a":case"s":let i=(a.op==="a"?this.map.get(a.param):void 0)||[];i.push(nf(a.value)),this.map.set(a.param,i);break;case"d":if(a.value!==void 0){let l=this.map.get(a.param)||[],h=l.indexOf(nf(a.value));h!==-1&&l.splice(h,1),l.length>0?this.map.set(a.param,l):this.map.delete(a.param)}else{this.map.delete(a.param);break}}}),this.cloneFrom=this.updates=null)}};var Q_=class{map=new Map;set(a,i){return this.map.set(a,i),this}get(a){return this.map.has(a)||this.map.set(a,a.defaultValue()),this.map.get(a)}delete(a){return this.map.delete(a),this}has(a){return this.map.has(a)}keys(){return this.map.keys()}};function jM(c){switch(c){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Rx(c){return typeof ArrayBuffer<"u"&&c instanceof ArrayBuffer}function Ox(c){return typeof Blob<"u"&&c instanceof Blob}function Fx(c){return typeof FormData<"u"&&c instanceof FormData}function UM(c){return typeof URLSearchParams<"u"&&c instanceof URLSearchParams}var Qh=class c{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(a,i,l,h){this.url=i,this.method=a.toUpperCase();let s;if(jM(this.method)||h?(this.body=l!==void 0?l:null,s=h):s=l,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Ts,this.context??=new Q_,!this.params)this.params=new oa,this.urlWithParams=i;else{let P=this.params.toString();if(P.length===0)this.urlWithParams=i;else{let q=i.indexOf("?"),X=q===-1?"?":q<i.length-1?"&":"";this.urlWithParams=i+X+P}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Rx(this.body)||Ox(this.body)||Fx(this.body)||UM(this.body)?this.body:this.body instanceof oa?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Fx(this.body)?null:Ox(this.body)?this.body.type||null:Rx(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof oa?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(a={}){let i=a.method||this.method,l=a.url||this.url,h=a.responseType||this.responseType,s=a.transferCache??this.transferCache,P=a.body!==void 0?a.body:this.body,q=a.withCredentials??this.withCredentials,X=a.reportProgress??this.reportProgress,be=a.headers||this.headers,ve=a.params||this.params,$=a.context??this.context;return a.setHeaders!==void 0&&(be=Object.keys(a.setHeaders).reduce(($e,ht)=>$e.set(ht,a.setHeaders[ht]),be)),a.setParams&&(ve=Object.keys(a.setParams).reduce(($e,ht)=>$e.set(ht,a.setParams[ht]),ve)),new c(i,l,P,{params:ve,headers:be,context:$,reportProgress:X,responseType:h,withCredentials:q,transferCache:s})}},Jl=function(c){return c[c.Sent=0]="Sent",c[c.UploadProgress=1]="UploadProgress",c[c.ResponseHeader=2]="ResponseHeader",c[c.DownloadProgress=3]="DownloadProgress",c[c.Response=4]="Response",c[c.User=5]="User",c}(Jl||{}),ep=class{headers;status;statusText;url;ok;type;constructor(a,i=200,l="OK"){this.headers=a.headers||new Ts,this.status=a.status!==void 0?a.status:i,this.statusText=a.statusText||l,this.url=a.url||null,this.ok=this.status>=200&&this.status<300}},of=class c extends ep{constructor(a={}){super(a)}type=Jl.ResponseHeader;clone(a={}){return new c({headers:a.headers||this.headers,status:a.status!==void 0?a.status:this.status,statusText:a.statusText||this.statusText,url:a.url||this.url||void 0})}},tp=class c extends ep{body;constructor(a={}){super(a),this.body=a.body!==void 0?a.body:null}type=Jl.Response;clone(a={}){return new c({body:a.body!==void 0?a.body:this.body,headers:a.headers||this.headers,status:a.status!==void 0?a.status:this.status,statusText:a.statusText||this.statusText,url:a.url||this.url||void 0})}},Ql=class extends ep{name="HttpErrorResponse";message;error;ok=!1;constructor(a){super(a,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${a.url||"(unknown url)"}`:this.message=`Http failure response for ${a.url||"(unknown url)"}: ${a.status} ${a.statusText}`,this.error=a.error||null}},Vx=200,$M=204;function Y_(c,a){return{body:a,headers:c.headers,context:c.context,observe:c.observe,params:c.params,reportProgress:c.reportProgress,responseType:c.responseType,withCredentials:c.withCredentials,transferCache:c.transferCache}}var Ao=(()=>{class c{handler;constructor(i){this.handler=i}request(i,l,h={}){let s;if(i instanceof Qh)s=i;else{let X;h.headers instanceof Ts?X=h.headers:X=new Ts(h.headers);let be;h.params&&(h.params instanceof oa?be=h.params:be=new oa({fromObject:h.params})),s=new Qh(i,l,h.body!==void 0?h.body:null,{headers:X,context:h.context,params:be,reportProgress:h.reportProgress,responseType:h.responseType||"json",withCredentials:h.withCredentials,transferCache:h.transferCache})}let P=bt(s).pipe(ql(X=>this.handler.handle(X)));if(i instanceof Qh||h.observe==="events")return P;let q=P.pipe(bn(X=>X instanceof tp));switch(h.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return q.pipe(Ft(X=>{if(X.body!==null&&!(X.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return X.body}));case"blob":return q.pipe(Ft(X=>{if(X.body!==null&&!(X.body instanceof Blob))throw new Error("Response is not a Blob.");return X.body}));case"text":return q.pipe(Ft(X=>{if(X.body!==null&&typeof X.body!="string")throw new Error("Response is not a string.");return X.body}));case"json":default:return q.pipe(Ft(X=>X.body))}case"response":return q;default:throw new Error(`Unreachable: unhandled observe type ${h.observe}}`)}}delete(i,l={}){return this.request("DELETE",i,l)}get(i,l={}){return this.request("GET",i,l)}head(i,l={}){return this.request("HEAD",i,l)}jsonp(i,l){return this.request("JSONP",i,{params:new oa().append(l,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,l={}){return this.request("OPTIONS",i,l)}patch(i,l,h={}){return this.request("PATCH",i,Y_(h,l))}post(i,l,h={}){return this.request("POST",i,Y_(h,l))}put(i,l,h={}){return this.request("PUT",i,Y_(h,l))}static \u0275fac=function(l){return new(l||c)(Vt(Jh))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),GM=/^\)\]\}',?\n/,HM="X-Request-URL";function Lx(c){if(c.url)return c.url;let a=HM.toLocaleLowerCase();return c.headers.get(a)}var ZM=(()=>{class c{fetchImpl=ge(J_,{optional:!0})?.fetch??((...i)=>globalThis.fetch(...i));ngZone=ge(_i);handle(i){return new qa(l=>{let h=new AbortController;return this.doRequest(i,h.signal,l).then(e0,s=>l.error(new Ql({error:s}))),()=>h.abort()})}doRequest(i,l,h){return Dr(this,null,function*(){let s=this.createRequestInit(i),P;try{let ht=this.ngZone.runOutsideAngular(()=>this.fetchImpl(i.urlWithParams,Qe({signal:l},s)));WM(ht),h.next({type:Jl.Sent}),P=yield ht}catch(ht){h.error(new Ql({error:ht,status:ht.status??0,statusText:ht.statusText,url:i.urlWithParams,headers:ht.headers}));return}let q=new Ts(P.headers),X=P.statusText,be=Lx(P)??i.urlWithParams,ve=P.status,$=null;if(i.reportProgress&&h.next(new of({headers:q,status:ve,statusText:X,url:be})),P.body){let ht=P.headers.get("content-length"),wt=[],lt=P.body.getReader(),at=0,hi,Mi,At=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>Dr(this,null,function*(){for(;;){let{done:Qi,value:pi}=yield lt.read();if(Qi)break;if(wt.push(pi),at+=pi.length,i.reportProgress){Mi=i.responseType==="text"?(Mi??"")+(hi??=new TextDecoder).decode(pi,{stream:!0}):void 0;let Lr=()=>h.next({type:Jl.DownloadProgress,total:ht?+ht:void 0,loaded:at,partialText:Mi});At?At.run(Lr):Lr()}}}));let bi=this.concatChunks(wt,at);try{let Qi=P.headers.get("Content-Type")??"";$=this.parseBody(i,bi,Qi)}catch(Qi){h.error(new Ql({error:Qi,headers:new Ts(P.headers),status:P.status,statusText:P.statusText,url:Lx(P)??i.urlWithParams}));return}}ve===0&&(ve=$?Vx:0),ve>=200&&ve<300?(h.next(new tp({body:$,headers:q,status:ve,statusText:X,url:be})),h.complete()):h.error(new Ql({error:$,headers:q,status:ve,statusText:X,url:be}))})}parseBody(i,l,h){switch(i.responseType){case"json":let s=new TextDecoder().decode(l).replace(GM,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(l);case"blob":return new Blob([l],{type:h});case"arraybuffer":return l.buffer}}createRequestInit(i){let l={},h=i.withCredentials?"include":void 0;if(i.headers.forEach((s,P)=>l[s]=P.join(",")),i.headers.has("Accept")||(l.Accept="application/json, text/plain, */*"),!i.headers.has("Content-Type")){let s=i.detectContentTypeHeader();s!==null&&(l["Content-Type"]=s)}return{body:i.serializeBody(),method:i.method,headers:l,credentials:h}}concatChunks(i,l){let h=new Uint8Array(l),s=0;for(let P of i)h.set(P,s),s+=P.length;return h}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),J_=class{};function e0(){}function WM(c){c.then(e0,e0)}function jx(c,a){return a(c)}function qM(c,a){return(i,l)=>a.intercept(i,{handle:h=>c(h,l)})}function XM(c,a,i){return(l,h)=>Xo(i,()=>a(l,s=>c(s,h)))}var YM=new ut(""),t0=new ut(""),KM=new ut(""),Ux=new ut("",{providedIn:"root",factory:()=>!0});function QM(){let c=null;return(a,i)=>{c===null&&(c=(ge(YM,{optional:!0})??[]).reduceRight(qM,jx));let l=ge(Vh);if(ge(Ux)){let s=l.add();return c(a,i).pipe(Xa(()=>l.remove(s)))}else return c(a,i)}}var zx=(()=>{class c extends Jh{backend;injector;chain=null;pendingTasks=ge(Vh);contributeToStability=ge(Ux);constructor(i,l){super(),this.backend=i,this.injector=l}handle(i){if(this.chain===null){let l=Array.from(new Set([...this.injector.get(t0),...this.injector.get(KM,[])]));this.chain=l.reduceRight((h,s)=>XM(h,s,this.injector),jx)}if(this.contributeToStability){let l=this.pendingTasks.add();return this.chain(i,h=>this.backend.handle(h)).pipe(Xa(()=>this.pendingTasks.remove(l)))}else return this.chain(i,l=>this.backend.handle(l))}static \u0275fac=function(l){return new(l||c)(Vt(rf),Vt(Ss))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})();var JM=/^\)\]\}',?\n/;function eS(c){return"responseURL"in c&&c.responseURL?c.responseURL:/^X-Request-URL:/m.test(c.getAllResponseHeaders())?c.getResponseHeader("X-Request-URL"):null}var Bx=(()=>{class c{xhrFactory;constructor(i){this.xhrFactory=i}handle(i){if(i.method==="JSONP")throw new Di(-2800,!1);let l=this.xhrFactory;return(l.\u0275loadImpl?wr(l.\u0275loadImpl()):bt(null)).pipe(Cr(()=>new qa(s=>{let P=l.build();if(P.open(i.method,i.urlWithParams),i.withCredentials&&(P.withCredentials=!0),i.headers.forEach((lt,at)=>P.setRequestHeader(lt,at.join(","))),i.headers.has("Accept")||P.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){let lt=i.detectContentTypeHeader();lt!==null&&P.setRequestHeader("Content-Type",lt)}if(i.responseType){let lt=i.responseType.toLowerCase();P.responseType=lt!=="json"?lt:"text"}let q=i.serializeBody(),X=null,be=()=>{if(X!==null)return X;let lt=P.statusText||"OK",at=new Ts(P.getAllResponseHeaders()),hi=eS(P)||i.url;return X=new of({headers:at,status:P.status,statusText:lt,url:hi}),X},ve=()=>{let{headers:lt,status:at,statusText:hi,url:Mi}=be(),At=null;at!==$M&&(At=typeof P.response>"u"?P.responseText:P.response),at===0&&(at=At?Vx:0);let bi=at>=200&&at<300;if(i.responseType==="json"&&typeof At=="string"){let Qi=At;At=At.replace(JM,"");try{At=At!==""?JSON.parse(At):null}catch(pi){At=Qi,bi&&(bi=!1,At={error:pi,text:At})}}bi?(s.next(new tp({body:At,headers:lt,status:at,statusText:hi,url:Mi||void 0})),s.complete()):s.error(new Ql({error:At,headers:lt,status:at,statusText:hi,url:Mi||void 0}))},$=lt=>{let{url:at}=be(),hi=new Ql({error:lt,status:P.status||0,statusText:P.statusText||"Unknown Error",url:at||void 0});s.error(hi)},$e=!1,ht=lt=>{$e||(s.next(be()),$e=!0);let at={type:Jl.DownloadProgress,loaded:lt.loaded};lt.lengthComputable&&(at.total=lt.total),i.responseType==="text"&&P.responseText&&(at.partialText=P.responseText),s.next(at)},wt=lt=>{let at={type:Jl.UploadProgress,loaded:lt.loaded};lt.lengthComputable&&(at.total=lt.total),s.next(at)};return P.addEventListener("load",ve),P.addEventListener("error",$),P.addEventListener("timeout",$),P.addEventListener("abort",$),i.reportProgress&&(P.addEventListener("progress",ht),q!==null&&P.upload&&P.upload.addEventListener("progress",wt)),P.send(q),s.next({type:Jl.Sent}),()=>{P.removeEventListener("error",$),P.removeEventListener("abort",$),P.removeEventListener("load",ve),P.removeEventListener("timeout",$),i.reportProgress&&(P.removeEventListener("progress",ht),q!==null&&P.upload&&P.upload.removeEventListener("progress",wt)),P.readyState!==P.DONE&&P.abort()}})))}static \u0275fac=function(l){return new(l||c)(Vt(ef))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),$x=new ut(""),tS="XSRF-TOKEN",iS=new ut("",{providedIn:"root",factory:()=>tS}),nS="X-XSRF-TOKEN",rS=new ut("",{providedIn:"root",factory:()=>nS}),sf=class{},oS=(()=>{class c{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(i,l,h){this.doc=i,this.platform=l,this.cookieName=h}getToken(){if(this.platform==="server")return null;let i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=Xm(i,this.cookieName),this.lastCookieString=i),this.lastToken}static \u0275fac=function(l){return new(l||c)(Vt(vi),Vt(Ps),Vt(iS))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})();function sS(c,a){let i=c.url.toLowerCase();if(!ge($x)||c.method==="GET"||c.method==="HEAD"||i.startsWith("http://")||i.startsWith("https://"))return a(c);let l=ge(sf).getToken(),h=ge(rS);return l!=null&&!c.headers.has(h)&&(c=c.clone({headers:c.headers.set(h,l)})),a(c)}var Gx=function(c){return c[c.Interceptors=0]="Interceptors",c[c.LegacyInterceptors=1]="LegacyInterceptors",c[c.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",c[c.NoXsrfProtection=3]="NoXsrfProtection",c[c.JsonpSupport=4]="JsonpSupport",c[c.RequestsMadeViaParent=5]="RequestsMadeViaParent",c[c.Fetch=6]="Fetch",c}(Gx||{});function aS(c,a){return{\u0275kind:c,\u0275providers:a}}function i0(...c){let a=[Ao,Bx,zx,{provide:Jh,useExisting:zx},{provide:rf,useFactory:()=>ge(ZM,{optional:!0})??ge(Bx)},{provide:t0,useValue:sS,multi:!0},{provide:$x,useValue:!0},{provide:sf,useClass:oS}];for(let i of c)a.push(...i.\u0275providers);return Xc(a)}var Nx=new ut("");function lS(){return aS(Gx.LegacyInterceptors,[{provide:Nx,useFactory:QM},{provide:t0,useExisting:Nx,multi:!0}])}var sa=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({providers:[i0(lS())]})}return c})();var r0=class extends Mx{supportsDOMEvents=!0},o0=class c extends r0{static makeCurrent(){Cx(new c)}onAndCancel(a,i,l){return a.addEventListener(i,l),()=>{a.removeEventListener(i,l)}}dispatchEvent(a,i){a.dispatchEvent(i)}remove(a){a.remove()}createElement(a,i){return i=i||this.getDefaultDocument(),i.createElement(a)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(a){return a.nodeType===Node.ELEMENT_NODE}isShadowRoot(a){return a instanceof DocumentFragment}getGlobalEventTarget(a,i){return i==="window"?window:i==="document"?a:i==="body"?a.body:null}getBaseHref(a){let i=dS();return i==null?null:uS(i)}resetBaseElement(){ip=null}getUserAgent(){return window.navigator.userAgent}getCookie(a){return Xm(document.cookie,a)}},ip=null;function dS(){return ip=ip||document.querySelector("base"),ip?ip.getAttribute("href"):null}function uS(c){return new URL(c,document.baseURI).pathname}var hS=(()=>{class c{build(){return new XMLHttpRequest}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),s0=new ut(""),Xx=(()=>{class c{_zone;_plugins;_eventNameToPlugin=new Map;constructor(i,l){this._zone=l,i.forEach(h=>{h.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,l,h){return this._findPluginFor(l).addEventListener(i,l,h)}getZone(){return this._zone}_findPluginFor(i){let l=this._eventNameToPlugin.get(i);if(l)return l;if(l=this._plugins.find(s=>s.supports(i)),!l)throw new Di(5101,!1);return this._eventNameToPlugin.set(i,l),l}static \u0275fac=function(l){return new(l||c)(Vt(s0),Vt(_i))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),af=class{_doc;constructor(a){this._doc=a}manager},a0="ng-app-id";function Hx(c){for(let a of c)a.remove()}function Zx(c,a){let i=a.createElement("style");return i.textContent=c,i}function pS(c,a,i){let l=c.head?.querySelectorAll(`style[${a0}="${a}"]`);if(l)for(let h of l)h.textContent&&(h.removeAttribute(a0),i.set(h.textContent,{usage:0,elements:[h]}))}function l0(c,a){let i=a.createElement("link");return i.setAttribute("rel","stylesheet"),i.setAttribute("href",c),i}var Yx=(()=>{class c{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(i,l,h,s={}){this.doc=i,this.appId=l,this.nonce=h,this.isServer=Jm(s),pS(i,l,this.inline),this.hosts.add(i.head)}addStyles(i,l){for(let h of i)this.addUsage(h,this.inline,Zx);l?.forEach(h=>this.addUsage(h,this.external,l0))}removeStyles(i,l){for(let h of i)this.removeUsage(h,this.inline);l?.forEach(h=>this.removeUsage(h,this.external))}addUsage(i,l,h){let s=l.get(i);s?s.usage++:l.set(i,{usage:1,elements:[...this.hosts].map(P=>this.addElement(P,h(i,this.doc)))})}removeUsage(i,l){let h=l.get(i);h&&(h.usage--,h.usage<=0&&(Hx(h.elements),l.delete(i)))}ngOnDestroy(){for(let[,{elements:i}]of[...this.inline,...this.external])Hx(i);this.hosts.clear()}addHost(i){this.hosts.add(i);for(let[l,{elements:h}]of this.inline)h.push(this.addElement(i,Zx(l,this.doc)));for(let[l,{elements:h}]of this.external)h.push(this.addElement(i,l0(l,this.doc)))}removeHost(i){this.hosts.delete(i)}addElement(i,l){return this.nonce&&l.setAttribute("nonce",this.nonce),this.isServer&&l.setAttribute(a0,this.appId),i.appendChild(l)}static \u0275fac=function(l){return new(l||c)(Vt(vi),Vt(jh),Vt(Uh,8),Vt(Ps))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),n0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},u0=/%COMP%/g,Kx="%COMP%",mS=`_nghost-${Kx}`,fS=`_ngcontent-${Kx}`,gS=!0,_S=new ut("",{providedIn:"root",factory:()=>gS});function yS(c){return fS.replace(u0,c)}function vS(c){return mS.replace(u0,c)}function Qx(c,a){return a.map(i=>i.replace(u0,c))}var lf=(()=>{class c{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(i,l,h,s,P,q,X,be=null){this.eventManager=i,this.sharedStylesHost=l,this.appId=h,this.removeStylesOnCompDestroy=s,this.doc=P,this.platformId=q,this.ngZone=X,this.nonce=be,this.platformIsServer=Jm(q),this.defaultRenderer=new np(i,P,X,this.platformIsServer)}createRenderer(i,l){if(!i||!l)return this.defaultRenderer;this.platformIsServer&&l.encapsulation===$h.ShadowDom&&(l=di(Qe({},l),{encapsulation:$h.Emulated}));let h=this.getOrCreateRenderer(i,l);return h instanceof cf?h.applyToHost(i):h instanceof rp&&h.applyStyles(),h}getOrCreateRenderer(i,l){let h=this.rendererByCompId,s=h.get(l.id);if(!s){let P=this.doc,q=this.ngZone,X=this.eventManager,be=this.sharedStylesHost,ve=this.removeStylesOnCompDestroy,$=this.platformIsServer;switch(l.encapsulation){case $h.Emulated:s=new cf(X,be,l,this.appId,ve,P,q,$);break;case $h.ShadowDom:return new c0(X,be,i,l,P,q,this.nonce,$);default:s=new rp(X,be,l,ve,P,q,$);break}h.set(l.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static \u0275fac=function(l){return new(l||c)(Vt(Xx),Vt(Yx),Vt(jh),Vt(_S),Vt(vi),Vt(Ps),Vt(_i),Vt(Uh))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),np=class{eventManager;doc;ngZone;platformIsServer;data=Object.create(null);throwOnSyntheticProps=!0;constructor(a,i,l,h){this.eventManager=a,this.doc=i,this.ngZone=l,this.platformIsServer=h}destroy(){}destroyNode=null;createElement(a,i){return i?this.doc.createElementNS(n0[i]||i,a):this.doc.createElement(a)}createComment(a){return this.doc.createComment(a)}createText(a){return this.doc.createTextNode(a)}appendChild(a,i){(Wx(a)?a.content:a).appendChild(i)}insertBefore(a,i,l){a&&(Wx(a)?a.content:a).insertBefore(i,l)}removeChild(a,i){i.remove()}selectRootElement(a,i){let l=typeof a=="string"?this.doc.querySelector(a):a;if(!l)throw new Di(-5104,!1);return i||(l.textContent=""),l}parentNode(a){return a.parentNode}nextSibling(a){return a.nextSibling}setAttribute(a,i,l,h){if(h){i=h+":"+i;let s=n0[h];s?a.setAttributeNS(s,i,l):a.setAttribute(i,l)}else a.setAttribute(i,l)}removeAttribute(a,i,l){if(l){let h=n0[l];h?a.removeAttributeNS(h,i):a.removeAttribute(`${l}:${i}`)}else a.removeAttribute(i)}addClass(a,i){a.classList.add(i)}removeClass(a,i){a.classList.remove(i)}setStyle(a,i,l,h){h&(Gh.DashCase|Gh.Important)?a.style.setProperty(i,l,h&Gh.Important?"important":""):a.style[i]=l}removeStyle(a,i,l){l&Gh.DashCase?a.style.removeProperty(i):a.style[i]=""}setProperty(a,i,l){a!=null&&(a[i]=l)}setValue(a,i){a.nodeValue=i}listen(a,i,l){if(typeof a=="string"&&(a=hu().getGlobalEventTarget(this.doc,a),!a))throw new Error(`Unsupported event target ${a} for event ${i}`);return this.eventManager.addEventListener(a,i,this.decoratePreventDefault(l))}decoratePreventDefault(a){return i=>{if(i==="__ngUnwrap__")return a;(this.platformIsServer?this.ngZone.runGuarded(()=>a(i)):a(i))===!1&&i.preventDefault()}}};function Wx(c){return c.tagName==="TEMPLATE"&&c.content!==void 0}var c0=class extends np{sharedStylesHost;hostEl;shadowRoot;constructor(a,i,l,h,s,P,q,X){super(a,s,P,X),this.sharedStylesHost=i,this.hostEl=l,this.shadowRoot=l.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let be=Qx(h.id,h.styles);for(let $ of be){let $e=document.createElement("style");q&&$e.setAttribute("nonce",q),$e.textContent=$,this.shadowRoot.appendChild($e)}let ve=h.getExternalStyles?.();if(ve)for(let $ of ve){let $e=l0($,s);q&&$e.setAttribute("nonce",q),this.shadowRoot.appendChild($e)}}nodeOrShadowRoot(a){return a===this.hostEl?this.shadowRoot:a}appendChild(a,i){return super.appendChild(this.nodeOrShadowRoot(a),i)}insertBefore(a,i,l){return super.insertBefore(this.nodeOrShadowRoot(a),i,l)}removeChild(a,i){return super.removeChild(null,i)}parentNode(a){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(a)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},rp=class extends np{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(a,i,l,h,s,P,q,X){super(a,s,P,q),this.sharedStylesHost=i,this.removeStylesOnCompDestroy=h,this.styles=X?Qx(X,l.styles):l.styles,this.styleUrls=l.getExternalStyles?.(X)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},cf=class extends rp{contentAttr;hostAttr;constructor(a,i,l,h,s,P,q,X){let be=h+"-"+l.id;super(a,i,l,s,P,q,X,be),this.contentAttr=yS(be),this.hostAttr=vS(be)}applyToHost(a){this.applyStyles(),this.setAttribute(a,this.hostAttr,"")}createElement(a,i){let l=super.createElement(a,i);return super.setAttribute(l,this.contentAttr,""),l}},bS=(()=>{class c extends af{constructor(i){super(i)}supports(i){return!0}addEventListener(i,l,h){return i.addEventListener(l,h,!1),()=>this.removeEventListener(i,l,h)}removeEventListener(i,l,h){return i.removeEventListener(l,h)}static \u0275fac=function(l){return new(l||c)(Vt(vi))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),qx=["alt","control","meta","shift"],xS={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wS={alt:c=>c.altKey,control:c=>c.ctrlKey,meta:c=>c.metaKey,shift:c=>c.shiftKey},CS=(()=>{class c extends af{constructor(i){super(i)}supports(i){return c.parseEventName(i)!=null}addEventListener(i,l,h){let s=c.parseEventName(l),P=c.eventCallback(s.fullKey,h,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>hu().onAndCancel(i,s.domEventName,P))}static parseEventName(i){let l=i.toLowerCase().split("."),h=l.shift();if(l.length===0||!(h==="keydown"||h==="keyup"))return null;let s=c._normalizeKey(l.pop()),P="",q=l.indexOf("code");if(q>-1&&(l.splice(q,1),P="code."),qx.forEach(be=>{let ve=l.indexOf(be);ve>-1&&(l.splice(ve,1),P+=be+".")}),P+=s,l.length!=0||s.length===0)return null;let X={};return X.domEventName=h,X.fullKey=P,X}static matchEventFullKeyCode(i,l){let h=xS[i.key]||i.key,s="";return l.indexOf("code.")>-1&&(h=i.code,s="code."),h==null||!h?!1:(h=h.toLowerCase(),h===" "?h="space":h==="."&&(h="dot"),qx.forEach(P=>{if(P!==h){let q=wS[P];q(i)&&(s+=P+".")}}),s+=h,s===l)}static eventCallback(i,l,h){return s=>{c.matchEventFullKeyCode(s,i)&&h.runGuarded(()=>l(s))}}static _normalizeKey(i){return i==="esc"?"escape":i}static \u0275fac=function(l){return new(l||c)(Vt(vi))};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})();function Jx(c,a){return bx(Qe({rootComponent:c},MS(a)))}function MS(c){return{appProviders:[...IS,...c?.providers??[]],platformProviders:TS}}function SS(){o0.makeCurrent()}function PS(){return new Kc}function ES(){return nx(document),document}var TS=[{provide:Ps,useValue:Tx},{provide:rx,useValue:SS,multi:!0},{provide:vi,useFactory:ES,deps:[]}];var IS=[{provide:Jb,useValue:"root"},{provide:Kc,useFactory:PS,deps:[]},{provide:s0,useClass:bS,multi:!0,deps:[vi,_i,Ps]},{provide:s0,useClass:CS,multi:!0,deps:[vi]},lf,Yx,Xx,{provide:jm,useExisting:lf},{provide:ef,useClass:hS,deps:[]},[]];var ew=(()=>{class c{_doc;constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}static \u0275fac=function(l){return new(l||c)(Vt(vi))};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var h0=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:function(l){let h=null;return l?h=new(l||c):h=Vt(kS),h},providedIn:"root"})}return c})(),kS=(()=>{class c extends h0{_doc;constructor(i){super(),this._doc=i}sanitize(i,l){if(l==null)return null;switch(i){case ko.NONE:return l;case ko.HTML:return cu(l,"HTML")?lu(l):ux(this._doc,String(l)).toString();case ko.STYLE:return cu(l,"Style")?lu(l):l;case ko.SCRIPT:if(cu(l,"Script"))return lu(l);throw new Di(5200,!1);case ko.URL:return cu(l,"URL")?lu(l):dx(String(l));case ko.RESOURCE_URL:if(cu(l,"ResourceURL"))return lu(l);throw new Di(5201,!1);default:throw new Di(5202,!1)}}bypassSecurityTrustHtml(i){return ox(i)}bypassSecurityTrustStyle(i){return sx(i)}bypassSecurityTrustScript(i){return ax(i)}bypassSecurityTrustUrl(i){return lx(i)}bypassSecurityTrustResourceUrl(i){return cx(i)}static \u0275fac=function(l){return new(l||c)(Vt(vi))};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var Jt="primary",bp=Symbol("RouteTitle"),_0=class{params;constructor(a){this.params=a||{}}has(a){return Object.prototype.hasOwnProperty.call(this.params,a)}get(a){if(this.has(a)){let i=this.params[a];return Array.isArray(i)?i[0]:i}return null}getAll(a){if(this.has(a)){let i=this.params[a];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}};function xu(c){return new _0(c)}function AS(c,a,i){let l=i.path.split("/");if(l.length>c.length||i.pathMatch==="full"&&(a.hasChildren()||l.length<c.length))return null;let h={};for(let s=0;s<l.length;s++){let P=l[s],q=c[s];if(P[0]===":")h[P.substring(1)]=q;else if(P!==q.path)return null}return{consumed:c.slice(0,l.length),posParams:h}}function DS(c,a){if(c.length!==a.length)return!1;for(let i=0;i<c.length;++i)if(!aa(c[i],a[i]))return!1;return!0}function aa(c,a){let i=c?y0(c):void 0,l=a?y0(a):void 0;if(!i||!l||i.length!=l.length)return!1;let h;for(let s=0;s<i.length;s++)if(h=i[s],!hw(c[h],a[h]))return!1;return!0}function y0(c){return[...Object.keys(c),...Object.getOwnPropertySymbols(c)]}function hw(c,a){if(Array.isArray(c)&&Array.isArray(a)){if(c.length!==a.length)return!1;let i=[...c].sort(),l=[...a].sort();return i.every((h,s)=>l[s]===h)}else return c===a}function pw(c){return c.length>0?c[c.length-1]:null}function tc(c){return Fh(c)?c:$m(c)?wr(Promise.resolve(c)):bt(c)}var RS={exact:fw,subset:gw},mw={exact:OS,subset:FS,ignored:()=>!0};function iw(c,a,i){return RS[i.paths](c.root,a.root,i.matrixParams)&&mw[i.queryParams](c.queryParams,a.queryParams)&&!(i.fragment==="exact"&&c.fragment!==a.fragment)}function OS(c,a){return aa(c,a)}function fw(c,a,i){if(!rd(c.segments,a.segments)||!hf(c.segments,a.segments,i)||c.numberOfChildren!==a.numberOfChildren)return!1;for(let l in a.children)if(!c.children[l]||!fw(c.children[l],a.children[l],i))return!1;return!0}function FS(c,a){return Object.keys(a).length<=Object.keys(c).length&&Object.keys(a).every(i=>hw(c[i],a[i]))}function gw(c,a,i){return _w(c,a,a.segments,i)}function _w(c,a,i,l){if(c.segments.length>i.length){let h=c.segments.slice(0,i.length);return!(!rd(h,i)||a.hasChildren()||!hf(h,i,l))}else if(c.segments.length===i.length){if(!rd(c.segments,i)||!hf(c.segments,i,l))return!1;for(let h in a.children)if(!c.children[h]||!gw(c.children[h],a.children[h],l))return!1;return!0}else{let h=i.slice(0,c.segments.length),s=i.slice(c.segments.length);return!rd(c.segments,h)||!hf(c.segments,h,l)||!c.children[Jt]?!1:_w(c.children[Jt],a,s,l)}}function hf(c,a,i){return a.every((l,h)=>mw[i](c[h].parameters,l.parameters))}var Qa=class{root;queryParams;fragment;_queryParamMap;constructor(a=new Ti([],{}),i={},l=null){this.root=a,this.queryParams=i,this.fragment=l}get queryParamMap(){return this._queryParamMap??=xu(this.queryParams),this._queryParamMap}toString(){return BS.serialize(this)}},Ti=class{segments;children;parent=null;constructor(a,i){this.segments=a,this.children=i,Object.values(i).forEach(l=>l.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return pf(this)}},nd=class{path;parameters;_parameterMap;constructor(a,i){this.path=a,this.parameters=i}get parameterMap(){return this._parameterMap??=xu(this.parameters),this._parameterMap}toString(){return vw(this)}};function LS(c,a){return rd(c,a)&&c.every((i,l)=>aa(i.parameters,a[l].parameters))}function rd(c,a){return c.length!==a.length?!1:c.every((i,l)=>i.path===a[l].path)}function zS(c,a){let i=[];return Object.entries(c.children).forEach(([l,h])=>{l===Jt&&(i=i.concat(a(h,l)))}),Object.entries(c.children).forEach(([l,h])=>{l!==Jt&&(i=i.concat(a(h,l)))}),i}var xp=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:()=>new wu,providedIn:"root"})}return c})(),wu=class{parse(a){let i=new b0(a);return new Qa(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(a){let i=`/${op(a.root,!0)}`,l=jS(a.queryParams),h=typeof a.fragment=="string"?`#${NS(a.fragment)}`:"";return`${i}${l}${h}`}},BS=new wu;function pf(c){return c.segments.map(a=>vw(a)).join("/")}function op(c,a){if(!c.hasChildren())return pf(c);if(a){let i=c.children[Jt]?op(c.children[Jt],!1):"",l=[];return Object.entries(c.children).forEach(([h,s])=>{h!==Jt&&l.push(`${h}:${op(s,!1)}`)}),l.length>0?`${i}(${l.join("//")})`:i}else{let i=zS(c,(l,h)=>h===Jt?[op(c.children[Jt],!1)]:[`${h}:${op(l,!1)}`]);return Object.keys(c.children).length===1&&c.children[Jt]!=null?`${pf(c)}/${i[0]}`:`${pf(c)}/(${i.join("//")})`}}function yw(c){return encodeURIComponent(c).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function df(c){return yw(c).replace(/%3B/gi,";")}function NS(c){return encodeURI(c)}function v0(c){return yw(c).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function mf(c){return decodeURIComponent(c)}function nw(c){return mf(c.replace(/\+/g,"%20"))}function vw(c){return`${v0(c.path)}${VS(c.parameters)}`}function VS(c){return Object.entries(c).map(([a,i])=>`;${v0(a)}=${v0(i)}`).join("")}function jS(c){let a=Object.entries(c).map(([i,l])=>Array.isArray(l)?l.map(h=>`${df(i)}=${df(h)}`).join("&"):`${df(i)}=${df(l)}`).filter(i=>i);return a.length?`?${a.join("&")}`:""}var US=/^[^\/()?;#]+/;function p0(c){let a=c.match(US);return a?a[0]:""}var $S=/^[^\/()?;=#]+/;function GS(c){let a=c.match($S);return a?a[0]:""}var HS=/^[^=?&#]+/;function ZS(c){let a=c.match(HS);return a?a[0]:""}var WS=/^[^&#]+/;function qS(c){let a=c.match(WS);return a?a[0]:""}var b0=class{url;remaining;constructor(a){this.url=a,this.remaining=a}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ti([],{}):new Ti([],this.parseChildren())}parseQueryParams(){let a={};if(this.consumeOptional("?"))do this.parseQueryParam(a);while(this.consumeOptional("&"));return a}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let a=[];for(this.peekStartsWith("(")||a.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),a.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let l={};return this.peekStartsWith("(")&&(l=this.parseParens(!1)),(a.length>0||Object.keys(i).length>0)&&(l[Jt]=new Ti(a,i)),l}parseSegment(){let a=p0(this.remaining);if(a===""&&this.peekStartsWith(";"))throw new Di(4009,!1);return this.capture(a),new nd(mf(a),this.parseMatrixParams())}parseMatrixParams(){let a={};for(;this.consumeOptional(";");)this.parseParam(a);return a}parseParam(a){let i=GS(this.remaining);if(!i)return;this.capture(i);let l="";if(this.consumeOptional("=")){let h=p0(this.remaining);h&&(l=h,this.capture(l))}a[mf(i)]=mf(l)}parseQueryParam(a){let i=ZS(this.remaining);if(!i)return;this.capture(i);let l="";if(this.consumeOptional("=")){let P=qS(this.remaining);P&&(l=P,this.capture(l))}let h=nw(i),s=nw(l);if(a.hasOwnProperty(h)){let P=a[h];Array.isArray(P)||(P=[P],a[h]=P),P.push(s)}else a[h]=s}parseParens(a){let i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let l=p0(this.remaining),h=this.remaining[l.length];if(h!=="/"&&h!==")"&&h!==";")throw new Di(4010,!1);let s;l.indexOf(":")>-1?(s=l.slice(0,l.indexOf(":")),this.capture(s),this.capture(":")):a&&(s=Jt);let P=this.parseChildren();i[s]=Object.keys(P).length===1?P[Jt]:new Ti([],P),this.consumeOptional("//")}return i}peekStartsWith(a){return this.remaining.startsWith(a)}consumeOptional(a){return this.peekStartsWith(a)?(this.remaining=this.remaining.substring(a.length),!0):!1}capture(a){if(!this.consumeOptional(a))throw new Di(4011,!1)}};function bw(c){return c.segments.length>0?new Ti([],{[Jt]:c}):c}function xw(c){let a={};for(let[l,h]of Object.entries(c.children)){let s=xw(h);if(l===Jt&&s.segments.length===0&&s.hasChildren())for(let[P,q]of Object.entries(s.children))a[P]=q;else(s.segments.length>0||s.hasChildren())&&(a[l]=s)}let i=new Ti(c.segments,a);return XS(i)}function XS(c){if(c.numberOfChildren===1&&c.children[Jt]){let a=c.children[Jt];return new Ti(c.segments.concat(a.segments),a.children)}return c}function up(c){return c instanceof Qa}function YS(c,a,i=null,l=null){let h=ww(c);return Cw(h,a,i,l)}function ww(c){let a;function i(s){let P={};for(let X of s.children){let be=i(X);P[X.outlet]=be}let q=new Ti(s.url,P);return s===c&&(a=q),q}let l=i(c.root),h=bw(l);return a??h}function Cw(c,a,i,l){let h=c;for(;h.parent;)h=h.parent;if(a.length===0)return m0(h,h,h,i,l);let s=KS(a);if(s.toRoot())return m0(h,h,new Ti([],{}),i,l);let P=QS(s,h,c),q=P.processChildren?lp(P.segmentGroup,P.index,s.commands):Sw(P.segmentGroup,P.index,s.commands);return m0(h,P.segmentGroup,q,i,l)}function ff(c){return typeof c=="object"&&c!=null&&!c.outlets&&!c.segmentPath}function hp(c){return typeof c=="object"&&c!=null&&c.outlets}function m0(c,a,i,l,h){let s={};l&&Object.entries(l).forEach(([X,be])=>{s[X]=Array.isArray(be)?be.map(ve=>`${ve}`):`${be}`});let P;c===a?P=i:P=Mw(c,a,i);let q=bw(xw(P));return new Qa(q,s,h)}function Mw(c,a,i){let l={};return Object.entries(c.children).forEach(([h,s])=>{s===a?l[h]=i:l[h]=Mw(s,a,i)}),new Ti(c.segments,l)}var gf=class{isAbsolute;numberOfDoubleDots;commands;constructor(a,i,l){if(this.isAbsolute=a,this.numberOfDoubleDots=i,this.commands=l,a&&l.length>0&&ff(l[0]))throw new Di(4003,!1);let h=l.find(hp);if(h&&h!==pw(l))throw new Di(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function KS(c){if(typeof c[0]=="string"&&c.length===1&&c[0]==="/")return new gf(!0,0,c);let a=0,i=!1,l=c.reduce((h,s,P)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let q={};return Object.entries(s.outlets).forEach(([X,be])=>{q[X]=typeof be=="string"?be.split("/"):be}),[...h,{outlets:q}]}if(s.segmentPath)return[...h,s.segmentPath]}return typeof s!="string"?[...h,s]:P===0?(s.split("/").forEach((q,X)=>{X==0&&q==="."||(X==0&&q===""?i=!0:q===".."?a++:q!=""&&h.push(q))}),h):[...h,s]},[]);return new gf(i,a,l)}var yu=class{segmentGroup;processChildren;index;constructor(a,i,l){this.segmentGroup=a,this.processChildren=i,this.index=l}};function QS(c,a,i){if(c.isAbsolute)return new yu(a,!0,0);if(!i)return new yu(a,!1,NaN);if(i.parent===null)return new yu(i,!0,0);let l=ff(c.commands[0])?0:1,h=i.segments.length-1+l;return JS(i,h,c.numberOfDoubleDots)}function JS(c,a,i){let l=c,h=a,s=i;for(;s>h;){if(s-=h,l=l.parent,!l)throw new Di(4005,!1);h=l.segments.length}return new yu(l,!1,h-s)}function eP(c){return hp(c[0])?c[0].outlets:{[Jt]:c}}function Sw(c,a,i){if(c??=new Ti([],{}),c.segments.length===0&&c.hasChildren())return lp(c,a,i);let l=tP(c,a,i),h=i.slice(l.commandIndex);if(l.match&&l.pathIndex<c.segments.length){let s=new Ti(c.segments.slice(0,l.pathIndex),{});return s.children[Jt]=new Ti(c.segments.slice(l.pathIndex),c.children),lp(s,0,h)}else return l.match&&h.length===0?new Ti(c.segments,{}):l.match&&!c.hasChildren()?x0(c,a,i):l.match?lp(c,0,h):x0(c,a,i)}function lp(c,a,i){if(i.length===0)return new Ti(c.segments,{});{let l=eP(i),h={};if(Object.keys(l).some(s=>s!==Jt)&&c.children[Jt]&&c.numberOfChildren===1&&c.children[Jt].segments.length===0){let s=lp(c.children[Jt],a,i);return new Ti(c.segments,s.children)}return Object.entries(l).forEach(([s,P])=>{typeof P=="string"&&(P=[P]),P!==null&&(h[s]=Sw(c.children[s],a,P))}),Object.entries(c.children).forEach(([s,P])=>{l[s]===void 0&&(h[s]=P)}),new Ti(c.segments,h)}}function tP(c,a,i){let l=0,h=a,s={match:!1,pathIndex:0,commandIndex:0};for(;h<c.segments.length;){if(l>=i.length)return s;let P=c.segments[h],q=i[l];if(hp(q))break;let X=`${q}`,be=l<i.length-1?i[l+1]:null;if(h>0&&X===void 0)break;if(X&&be&&typeof be=="object"&&be.outlets===void 0){if(!ow(X,be,P))return s;l+=2}else{if(!ow(X,{},P))return s;l++}h++}return{match:!0,pathIndex:h,commandIndex:l}}function x0(c,a,i){let l=c.segments.slice(0,a),h=0;for(;h<i.length;){let s=i[h];if(hp(s)){let X=iP(s.outlets);return new Ti(l,X)}if(h===0&&ff(i[0])){let X=c.segments[a];l.push(new nd(X.path,rw(i[0]))),h++;continue}let P=hp(s)?s.outlets[Jt]:`${s}`,q=h<i.length-1?i[h+1]:null;P&&q&&ff(q)?(l.push(new nd(P,rw(q))),h+=2):(l.push(new nd(P,{})),h++)}return new Ti(l,{})}function iP(c){let a={};return Object.entries(c).forEach(([i,l])=>{typeof l=="string"&&(l=[l]),l!==null&&(a[i]=x0(new Ti([],{}),0,l))}),a}function rw(c){let a={};return Object.entries(c).forEach(([i,l])=>a[i]=`${l}`),a}function ow(c,a,i){return c==i.path&&aa(a,i.parameters)}var cp="imperative",pr=function(c){return c[c.NavigationStart=0]="NavigationStart",c[c.NavigationEnd=1]="NavigationEnd",c[c.NavigationCancel=2]="NavigationCancel",c[c.NavigationError=3]="NavigationError",c[c.RoutesRecognized=4]="RoutesRecognized",c[c.ResolveStart=5]="ResolveStart",c[c.ResolveEnd=6]="ResolveEnd",c[c.GuardsCheckStart=7]="GuardsCheckStart",c[c.GuardsCheckEnd=8]="GuardsCheckEnd",c[c.RouteConfigLoadStart=9]="RouteConfigLoadStart",c[c.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",c[c.ChildActivationStart=11]="ChildActivationStart",c[c.ChildActivationEnd=12]="ChildActivationEnd",c[c.ActivationStart=13]="ActivationStart",c[c.ActivationEnd=14]="ActivationEnd",c[c.Scroll=15]="Scroll",c[c.NavigationSkipped=16]="NavigationSkipped",c}(pr||{}),Jo=class{id;url;constructor(a,i){this.id=a,this.url=i}},Cu=class extends Jo{type=pr.NavigationStart;navigationTrigger;restoredState;constructor(a,i,l="imperative",h=null){super(a,i),this.navigationTrigger=l,this.restoredState=h}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ja=class extends Jo{urlAfterRedirects;type=pr.NavigationEnd;constructor(a,i,l){super(a,i),this.urlAfterRedirects=l}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Ro=function(c){return c[c.Redirect=0]="Redirect",c[c.SupersededByNewNavigation=1]="SupersededByNewNavigation",c[c.NoDataFromResolver=2]="NoDataFromResolver",c[c.GuardRejected=3]="GuardRejected",c}(Ro||{}),_f=function(c){return c[c.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",c[c.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",c}(_f||{}),Ka=class extends Jo{reason;code;type=pr.NavigationCancel;constructor(a,i,l,h){super(a,i),this.reason=l,this.code=h}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ec=class extends Jo{reason;code;type=pr.NavigationSkipped;constructor(a,i,l,h){super(a,i),this.reason=l,this.code=h}},pp=class extends Jo{error;target;type=pr.NavigationError;constructor(a,i,l,h){super(a,i),this.error=l,this.target=h}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},yf=class extends Jo{urlAfterRedirects;state;type=pr.RoutesRecognized;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},w0=class extends Jo{urlAfterRedirects;state;type=pr.GuardsCheckStart;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},C0=class extends Jo{urlAfterRedirects;state;shouldActivate;type=pr.GuardsCheckEnd;constructor(a,i,l,h,s){super(a,i),this.urlAfterRedirects=l,this.state=h,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},M0=class extends Jo{urlAfterRedirects;state;type=pr.ResolveStart;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},S0=class extends Jo{urlAfterRedirects;state;type=pr.ResolveEnd;constructor(a,i,l,h){super(a,i),this.urlAfterRedirects=l,this.state=h}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},P0=class{route;type=pr.RouteConfigLoadStart;constructor(a){this.route=a}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},E0=class{route;type=pr.RouteConfigLoadEnd;constructor(a){this.route=a}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},T0=class{snapshot;type=pr.ChildActivationStart;constructor(a){this.snapshot=a}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},I0=class{snapshot;type=pr.ChildActivationEnd;constructor(a){this.snapshot=a}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},k0=class{snapshot;type=pr.ActivationStart;constructor(a){this.snapshot=a}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},A0=class{snapshot;type=pr.ActivationEnd;constructor(a){this.snapshot=a}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},vf=class{routerEvent;position;anchor;type=pr.Scroll;constructor(a,i,l){this.routerEvent=a,this.position=i,this.anchor=l}toString(){let a=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${a}')`}},mp=class{},Mu=class{url;navigationBehaviorOptions;constructor(a,i){this.url=a,this.navigationBehaviorOptions=i}};function nP(c,a){return c.providers&&!c._injector&&(c._injector=Z_(c.providers,a,`Route: ${c.path}`)),c._injector??a}function Is(c){return c.outlet||Jt}function rP(c,a){let i=c.filter(l=>Is(l)===a);return i.push(...c.filter(l=>Is(l)!==a)),i}function wp(c){if(!c)return null;if(c.routeConfig?._injector)return c.routeConfig._injector;for(let a=c.parent;a;a=a.parent){let i=a.routeConfig;if(i?._loadedInjector)return i._loadedInjector;if(i?._injector)return i._injector}return null}var D0=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return wp(this.route?.snapshot)??this.rootInjector}constructor(a){this.rootInjector=a,this.children=new Cp(this.rootInjector)}},Cp=(()=>{class c{rootInjector;contexts=new Map;constructor(i){this.rootInjector=i}onChildOutletCreated(i,l){let h=this.getOrCreateContext(i);h.outlet=l,this.contexts.set(i,h)}onChildOutletDestroyed(i){let l=this.getContext(i);l&&(l.outlet=null,l.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let l=this.getContext(i);return l||(l=new D0(this.rootInjector),this.contexts.set(i,l)),l}getContext(i){return this.contexts.get(i)||null}static \u0275fac=function(l){return new(l||c)(Vt(Ss))};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),bf=class{_root;constructor(a){this._root=a}get root(){return this._root.value}parent(a){let i=this.pathFromRoot(a);return i.length>1?i[i.length-2]:null}children(a){let i=R0(a,this._root);return i?i.children.map(l=>l.value):[]}firstChild(a){let i=R0(a,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(a){let i=O0(a,this._root);return i.length<2?[]:i[i.length-2].children.map(h=>h.value).filter(h=>h!==a)}pathFromRoot(a){return O0(a,this._root).map(i=>i.value)}};function R0(c,a){if(c===a.value)return a;for(let i of a.children){let l=R0(c,i);if(l)return l}return null}function O0(c,a){if(c===a.value)return[a];for(let i of a.children){let l=O0(c,i);if(l.length)return l.unshift(a),l}return[]}var Do=class{value;children;constructor(a,i){this.value=a,this.children=i}toString(){return`TreeNode(${this.value})`}};function _u(c){let a={};return c&&c.children.forEach(i=>a[i.value.outlet]=i),a}var xf=class extends bf{snapshot;constructor(a,i){super(a),this.snapshot=i,$0(this,a)}toString(){return this.snapshot.toString()}};function Pw(c){let a=oP(c),i=new so([new nd("",{})]),l=new so({}),h=new so({}),s=new so({}),P=new so(""),q=new od(i,l,s,P,h,Jt,c,a.root);return q.snapshot=a.root,new xf(new Do(q,[]),a)}function oP(c){let a={},i={},l={},h="",s=new vu([],a,l,h,i,Jt,c,null,{});return new Cf("",new Do(s,[]))}var od=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(a,i,l,h,s,P,q,X){this.urlSubject=a,this.paramsSubject=i,this.queryParamsSubject=l,this.fragmentSubject=h,this.dataSubject=s,this.outlet=P,this.component=q,this._futureSnapshot=X,this.title=this.dataSubject?.pipe(Ft(be=>be[bp]))??bt(void 0),this.url=a,this.params=i,this.queryParams=l,this.fragment=h,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ft(a=>xu(a))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ft(a=>xu(a))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function wf(c,a,i="emptyOnly"){let l,{routeConfig:h}=c;return a!==null&&(i==="always"||h?.path===""||!a.component&&!a.routeConfig?.loadComponent)?l={params:Qe(Qe({},a.params),c.params),data:Qe(Qe({},a.data),c.data),resolve:Qe(Qe(Qe(Qe({},c.data),a.data),h?.data),c._resolvedData)}:l={params:Qe({},c.params),data:Qe({},c.data),resolve:Qe(Qe({},c.data),c._resolvedData??{})},h&&Tw(h)&&(l.resolve[bp]=h.title),l}var vu=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[bp]}constructor(a,i,l,h,s,P,q,X,be){this.url=a,this.params=i,this.queryParams=l,this.fragment=h,this.data=s,this.outlet=P,this.component=q,this.routeConfig=X,this._resolve=be}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=xu(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=xu(this.queryParams),this._queryParamMap}toString(){let a=this.url.map(l=>l.toString()).join("/"),i=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${a}', path:'${i}')`}},Cf=class extends bf{url;constructor(a,i){super(i),this.url=a,$0(this,i)}toString(){return Ew(this._root)}};function $0(c,a){a.value._routerState=c,a.children.forEach(i=>$0(c,i))}function Ew(c){let a=c.children.length>0?` { ${c.children.map(Ew).join(", ")} } `:"";return`${c.value}${a}`}function f0(c){if(c.snapshot){let a=c.snapshot,i=c._futureSnapshot;c.snapshot=i,aa(a.queryParams,i.queryParams)||c.queryParamsSubject.next(i.queryParams),a.fragment!==i.fragment&&c.fragmentSubject.next(i.fragment),aa(a.params,i.params)||c.paramsSubject.next(i.params),DS(a.url,i.url)||c.urlSubject.next(i.url),aa(a.data,i.data)||c.dataSubject.next(i.data)}else c.snapshot=c._futureSnapshot,c.dataSubject.next(c._futureSnapshot.data)}function F0(c,a){let i=aa(c.params,a.params)&&LS(c.url,a.url),l=!c.parent!=!a.parent;return i&&!l&&(!c.parent||F0(c.parent,a.parent))}function Tw(c){return typeof c.title=="string"||c.title===null}var sP=new ut(""),Mp=(()=>{class c{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Jt;activateEvents=new oi;deactivateEvents=new oi;attachEvents=new oi;detachEvents=new oi;routerOutletData=ix(void 0);parentContexts=ge(Cp);location=ge(uu);changeDetector=ge(Mr);inputBinder=ge(Ef,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(i){if(i.name){let{firstChange:l,previousValue:h}=i.name;if(l)return;this.isTrackedInParentContexts(h)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(h)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Di(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Di(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Di(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,l){this.activated=i,this._activatedRoute=l,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,l){if(this.isActivated)throw new Di(4013,!1);this._activatedRoute=i;let h=this.location,P=i.snapshot.component,q=this.parentContexts.getOrCreateContext(this.name).children,X=new L0(i,q,h.injector,this.routerOutletData);this.activated=h.createComponent(P,{index:h.length,injector:X,environmentInjector:l}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[ao]})}return c})(),L0=class c{route;childContexts;parent;outletData;__ngOutletInjector(a){return new c(this.route,this.childContexts,a,this.outletData)}constructor(a,i,l,h){this.route=a,this.childContexts=i,this.parent=l,this.outletData=h}get(a,i){return a===od?this.route:a===Cp?this.childContexts:a===sP?this.outletData:this.parent.get(a,i)}},Ef=new ut(""),sw=(()=>{class c{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(i){this.unsubscribeFromRouteData(i),this.subscribeToRouteData(i)}unsubscribeFromRouteData(i){this.outletDataSubscriptions.get(i)?.unsubscribe(),this.outletDataSubscriptions.delete(i)}subscribeToRouteData(i){let{activatedRoute:l}=i,h=su([l.queryParams,l.params,l.data]).pipe(Cr(([s,P,q],X)=>(q=Qe(Qe(Qe({},s),P),q),X===0?bt(q):Promise.resolve(q)))).subscribe(s=>{if(!i.isActivated||!i.activatedComponentRef||i.activatedRoute!==l||l.component===null){this.unsubscribeFromRouteData(i);return}let P=wx(l.component);if(!P){this.unsubscribeFromRouteData(i);return}for(let{templateName:q}of P.inputs)i.activatedComponentRef.setInput(q,s[q])});this.outletDataSubscriptions.set(i,h)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})();function aP(c,a,i){let l=fp(c,a._root,i?i._root:void 0);return new xf(l,a)}function fp(c,a,i){if(i&&c.shouldReuseRoute(a.value,i.value.snapshot)){let l=i.value;l._futureSnapshot=a.value;let h=lP(c,a,i);return new Do(l,h)}else{if(c.shouldAttach(a.value)){let s=c.retrieve(a.value);if(s!==null){let P=s.route;return P.value._futureSnapshot=a.value,P.children=a.children.map(q=>fp(c,q)),P}}let l=cP(a.value),h=a.children.map(s=>fp(c,s));return new Do(l,h)}}function lP(c,a,i){return a.children.map(l=>{for(let h of i.children)if(c.shouldReuseRoute(l.value,h.value.snapshot))return fp(c,l,h);return fp(c,l)})}function cP(c){return new od(new so(c.url),new so(c.params),new so(c.queryParams),new so(c.fragment),new so(c.data),c.outlet,c.component,c)}var gp=class{redirectTo;navigationBehaviorOptions;constructor(a,i){this.redirectTo=a,this.navigationBehaviorOptions=i}},Iw="ngNavigationCancelingError";function Mf(c,a){let{redirectTo:i,navigationBehaviorOptions:l}=up(a)?{redirectTo:a,navigationBehaviorOptions:void 0}:a,h=kw(!1,Ro.Redirect);return h.url=i,h.navigationBehaviorOptions=l,h}function kw(c,a){let i=new Error(`NavigationCancelingError: ${c||""}`);return i[Iw]=!0,i.cancellationCode=a,i}function dP(c){return Aw(c)&&up(c.url)}function Aw(c){return!!c&&c[Iw]}var uP=(c,a,i,l)=>Ft(h=>(new z0(a,h.targetRouterState,h.currentRouterState,i,l).activate(c),h)),z0=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(a,i,l,h,s){this.routeReuseStrategy=a,this.futureState=i,this.currState=l,this.forwardEvent=h,this.inputBindingEnabled=s}activate(a){let i=this.futureState._root,l=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,l,a),f0(this.futureState.root),this.activateChildRoutes(i,l,a)}deactivateChildRoutes(a,i,l){let h=_u(i);a.children.forEach(s=>{let P=s.value.outlet;this.deactivateRoutes(s,h[P],l),delete h[P]}),Object.values(h).forEach(s=>{this.deactivateRouteAndItsChildren(s,l)})}deactivateRoutes(a,i,l){let h=a.value,s=i?i.value:null;if(h===s)if(h.component){let P=l.getContext(h.outlet);P&&this.deactivateChildRoutes(a,i,P.children)}else this.deactivateChildRoutes(a,i,l);else s&&this.deactivateRouteAndItsChildren(i,l)}deactivateRouteAndItsChildren(a,i){a.value.component&&this.routeReuseStrategy.shouldDetach(a.value.snapshot)?this.detachAndStoreRouteSubtree(a,i):this.deactivateRouteAndOutlet(a,i)}detachAndStoreRouteSubtree(a,i){let l=i.getContext(a.value.outlet),h=l&&a.value.component?l.children:i,s=_u(a);for(let P of Object.values(s))this.deactivateRouteAndItsChildren(P,h);if(l&&l.outlet){let P=l.outlet.detach(),q=l.children.onOutletDeactivated();this.routeReuseStrategy.store(a.value.snapshot,{componentRef:P,route:a,contexts:q})}}deactivateRouteAndOutlet(a,i){let l=i.getContext(a.value.outlet),h=l&&a.value.component?l.children:i,s=_u(a);for(let P of Object.values(s))this.deactivateRouteAndItsChildren(P,h);l&&(l.outlet&&(l.outlet.deactivate(),l.children.onOutletDeactivated()),l.attachRef=null,l.route=null)}activateChildRoutes(a,i,l){let h=_u(i);a.children.forEach(s=>{this.activateRoutes(s,h[s.value.outlet],l),this.forwardEvent(new A0(s.value.snapshot))}),a.children.length&&this.forwardEvent(new I0(a.value.snapshot))}activateRoutes(a,i,l){let h=a.value,s=i?i.value:null;if(f0(h),h===s)if(h.component){let P=l.getOrCreateContext(h.outlet);this.activateChildRoutes(a,i,P.children)}else this.activateChildRoutes(a,i,l);else if(h.component){let P=l.getOrCreateContext(h.outlet);if(this.routeReuseStrategy.shouldAttach(h.snapshot)){let q=this.routeReuseStrategy.retrieve(h.snapshot);this.routeReuseStrategy.store(h.snapshot,null),P.children.onOutletReAttached(q.contexts),P.attachRef=q.componentRef,P.route=q.route.value,P.outlet&&P.outlet.attach(q.componentRef,q.route.value),f0(q.route.value),this.activateChildRoutes(a,null,P.children)}else P.attachRef=null,P.route=h,P.outlet&&P.outlet.activateWith(h,P.injector),this.activateChildRoutes(a,null,P.children)}else this.activateChildRoutes(a,null,l)}},Sf=class{path;route;constructor(a){this.path=a,this.route=this.path[this.path.length-1]}},bu=class{component;route;constructor(a,i){this.component=a,this.route=i}};function hP(c,a,i){let l=c._root,h=a?a._root:null;return sp(l,h,i,[l.value])}function pP(c){let a=c.routeConfig?c.routeConfig.canActivateChild:null;return!a||a.length===0?null:{node:c,guards:a}}function Pu(c,a){let i=Symbol(),l=a.get(c,i);return l===i?typeof c=="function"&&!Qb(c)?c:a.get(c):l}function sp(c,a,i,l,h={canDeactivateChecks:[],canActivateChecks:[]}){let s=_u(a);return c.children.forEach(P=>{mP(P,s[P.value.outlet],i,l.concat([P.value]),h),delete s[P.value.outlet]}),Object.entries(s).forEach(([P,q])=>dp(q,i.getContext(P),h)),h}function mP(c,a,i,l,h={canDeactivateChecks:[],canActivateChecks:[]}){let s=c.value,P=a?a.value:null,q=i?i.getContext(c.value.outlet):null;if(P&&s.routeConfig===P.routeConfig){let X=fP(P,s,s.routeConfig.runGuardsAndResolvers);X?h.canActivateChecks.push(new Sf(l)):(s.data=P.data,s._resolvedData=P._resolvedData),s.component?sp(c,a,q?q.children:null,l,h):sp(c,a,i,l,h),X&&q&&q.outlet&&q.outlet.isActivated&&h.canDeactivateChecks.push(new bu(q.outlet.component,P))}else P&&dp(a,q,h),h.canActivateChecks.push(new Sf(l)),s.component?sp(c,null,q?q.children:null,l,h):sp(c,null,i,l,h);return h}function fP(c,a,i){if(typeof i=="function")return i(c,a);switch(i){case"pathParamsChange":return!rd(c.url,a.url);case"pathParamsOrQueryParamsChange":return!rd(c.url,a.url)||!aa(c.queryParams,a.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!F0(c,a)||!aa(c.queryParams,a.queryParams);case"paramsChange":default:return!F0(c,a)}}function dp(c,a,i){let l=_u(c),h=c.value;Object.entries(l).forEach(([s,P])=>{h.component?a?dp(P,a.children.getContext(s),i):dp(P,null,i):dp(P,a,i)}),h.component?a&&a.outlet&&a.outlet.isActivated?i.canDeactivateChecks.push(new bu(a.outlet.component,h)):i.canDeactivateChecks.push(new bu(null,h)):i.canDeactivateChecks.push(new bu(null,h))}function Sp(c){return typeof c=="function"}function gP(c){return typeof c=="boolean"}function _P(c){return c&&Sp(c.canLoad)}function yP(c){return c&&Sp(c.canActivate)}function vP(c){return c&&Sp(c.canActivateChild)}function bP(c){return c&&Sp(c.canDeactivate)}function xP(c){return c&&Sp(c.canMatch)}function Dw(c){return c instanceof $b||c?.name==="EmptyError"}var uf=Symbol("INITIAL_VALUE");function Su(){return Cr(c=>su(c.map(a=>a.pipe(To(1),ra(uf)))).pipe(Ft(a=>{for(let i of a)if(i!==!0){if(i===uf)return uf;if(i===!1||wP(i))return i}return!0}),bn(a=>a!==uf),To(1)))}function wP(c){return up(c)||c instanceof gp}function CP(c,a){return Eo(i=>{let{targetSnapshot:l,currentSnapshot:h,guards:{canActivateChecks:s,canDeactivateChecks:P}}=i;return P.length===0&&s.length===0?bt(di(Qe({},i),{guardsResult:!0})):MP(P,l,h,c).pipe(Eo(q=>q&&gP(q)?SP(l,s,c,a):bt(q)),Ft(q=>di(Qe({},i),{guardsResult:q})))})}function MP(c,a,i,l){return wr(c).pipe(Eo(h=>kP(h.component,h.route,i,a,l)),Xl(h=>h!==!0,!0))}function SP(c,a,i,l){return wr(a).pipe(ql(h=>Om(EP(h.route.parent,l),PP(h.route,l),IP(c,h.path,i),TP(c,h.route,i))),Xl(h=>h!==!0,!0))}function PP(c,a){return c!==null&&a&&a(new k0(c)),bt(!0)}function EP(c,a){return c!==null&&a&&a(new T0(c)),bt(!0)}function TP(c,a,i){let l=a.routeConfig?a.routeConfig.canActivate:null;if(!l||l.length===0)return bt(!0);let h=l.map(s=>Lh(()=>{let P=wp(a)??i,q=Pu(s,P),X=yP(q)?q.canActivate(a,c):Xo(P,()=>q(a,c));return tc(X).pipe(Xl())}));return bt(h).pipe(Su())}function IP(c,a,i){let l=a[a.length-1],s=a.slice(0,a.length-1).reverse().map(P=>pP(P)).filter(P=>P!==null).map(P=>Lh(()=>{let q=P.guards.map(X=>{let be=wp(P.node)??i,ve=Pu(X,be),$=vP(ve)?ve.canActivateChild(l,c):Xo(be,()=>ve(l,c));return tc($).pipe(Xl())});return bt(q).pipe(Su())}));return bt(s).pipe(Su())}function kP(c,a,i,l,h){let s=a&&a.routeConfig?a.routeConfig.canDeactivate:null;if(!s||s.length===0)return bt(!0);let P=s.map(q=>{let X=wp(a)??h,be=Pu(q,X),ve=bP(be)?be.canDeactivate(c,a,i,l):Xo(X,()=>be(c,a,i,l));return tc(ve).pipe(Xl())});return bt(P).pipe(Su())}function AP(c,a,i,l){let h=a.canLoad;if(h===void 0||h.length===0)return bt(!0);let s=h.map(P=>{let q=Pu(P,c),X=_P(q)?q.canLoad(a,i):Xo(c,()=>q(a,i));return tc(X)});return bt(s).pipe(Su(),Rw(l))}function Rw(c){return Ub(tn(a=>{if(typeof a!="boolean")throw Mf(c,a)}),Ft(a=>a===!0))}function DP(c,a,i,l){let h=a.canMatch;if(!h||h.length===0)return bt(!0);let s=h.map(P=>{let q=Pu(P,c),X=xP(q)?q.canMatch(a,i):Xo(c,()=>q(a,i));return tc(X)});return bt(s).pipe(Su(),Rw(l))}var _p=class{segmentGroup;constructor(a){this.segmentGroup=a||null}},yp=class extends Error{urlTree;constructor(a){super(),this.urlTree=a}};function gu(c){return qc(new _p(c))}function RP(c){return qc(new Di(4e3,!1))}function OP(c){return qc(kw(!1,Ro.GuardRejected))}var B0=class{urlSerializer;urlTree;constructor(a,i){this.urlSerializer=a,this.urlTree=i}lineralizeSegments(a,i){let l=[],h=i.root;for(;;){if(l=l.concat(h.segments),h.numberOfChildren===0)return bt(l);if(h.numberOfChildren>1||!h.children[Jt])return RP(`${a.redirectTo}`);h=h.children[Jt]}}applyRedirectCommands(a,i,l,h,s){if(typeof i!="string"){let q=i,{queryParams:X,fragment:be,routeConfig:ve,url:$,outlet:$e,params:ht,data:wt,title:lt}=h,at=Xo(s,()=>q({params:ht,data:wt,queryParams:X,fragment:be,routeConfig:ve,url:$,outlet:$e,title:lt}));if(at instanceof Qa)throw new yp(at);i=at}let P=this.applyRedirectCreateUrlTree(i,this.urlSerializer.parse(i),a,l);if(i[0]==="/")throw new yp(P);return P}applyRedirectCreateUrlTree(a,i,l,h){let s=this.createSegmentGroup(a,i.root,l,h);return new Qa(s,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(a,i){let l={};return Object.entries(a).forEach(([h,s])=>{if(typeof s=="string"&&s[0]===":"){let q=s.substring(1);l[h]=i[q]}else l[h]=s}),l}createSegmentGroup(a,i,l,h){let s=this.createSegments(a,i.segments,l,h),P={};return Object.entries(i.children).forEach(([q,X])=>{P[q]=this.createSegmentGroup(a,X,l,h)}),new Ti(s,P)}createSegments(a,i,l,h){return i.map(s=>s.path[0]===":"?this.findPosParam(a,s,h):this.findOrReturn(s,l))}findPosParam(a,i,l){let h=l[i.path.substring(1)];if(!h)throw new Di(4001,!1);return h}findOrReturn(a,i){let l=0;for(let h of i){if(h.path===a.path)return i.splice(l),h;l++}return a}},N0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function FP(c,a,i,l,h){let s=Ow(c,a,i);return s.matched?(l=nP(a,l),DP(l,a,i,h).pipe(Ft(P=>P===!0?s:Qe({},N0)))):bt(s)}function Ow(c,a,i){if(a.path==="**")return LP(i);if(a.path==="")return a.pathMatch==="full"&&(c.hasChildren()||i.length>0)?Qe({},N0):{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};let h=(a.matcher||AS)(i,c,a);if(!h)return Qe({},N0);let s={};Object.entries(h.posParams??{}).forEach(([q,X])=>{s[q]=X.path});let P=h.consumed.length>0?Qe(Qe({},s),h.consumed[h.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:h.consumed,remainingSegments:i.slice(h.consumed.length),parameters:P,positionalParamSegments:h.posParams??{}}}function LP(c){return{matched:!0,parameters:c.length>0?pw(c).parameters:{},consumedSegments:c,remainingSegments:[],positionalParamSegments:{}}}function aw(c,a,i,l){return i.length>0&&NP(c,i,l)?{segmentGroup:new Ti(a,BP(l,new Ti(i,c.children))),slicedSegments:[]}:i.length===0&&VP(c,i,l)?{segmentGroup:new Ti(c.segments,zP(c,i,l,c.children)),slicedSegments:i}:{segmentGroup:new Ti(c.segments,c.children),slicedSegments:i}}function zP(c,a,i,l){let h={};for(let s of i)if(Tf(c,a,s)&&!l[Is(s)]){let P=new Ti([],{});h[Is(s)]=P}return Qe(Qe({},l),h)}function BP(c,a){let i={};i[Jt]=a;for(let l of c)if(l.path===""&&Is(l)!==Jt){let h=new Ti([],{});i[Is(l)]=h}return i}function NP(c,a,i){return i.some(l=>Tf(c,a,l)&&Is(l)!==Jt)}function VP(c,a,i){return i.some(l=>Tf(c,a,l))}function Tf(c,a,i){return(c.hasChildren()||a.length>0)&&i.pathMatch==="full"?!1:i.path===""}function jP(c,a,i){return a.length===0&&!c.children[i]}var V0=class{};function UP(c,a,i,l,h,s,P="emptyOnly"){return new j0(c,a,i,l,h,P,s).recognize()}var $P=31,j0=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(a,i,l,h,s,P,q){this.injector=a,this.configLoader=i,this.rootComponentType=l,this.config=h,this.urlTree=s,this.paramsInheritanceStrategy=P,this.urlSerializer=q,this.applyRedirects=new B0(this.urlSerializer,this.urlTree)}noMatchError(a){return new Di(4002,`'${a.segmentGroup}'`)}recognize(){let a=aw(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(a).pipe(Ft(({children:i,rootSnapshot:l})=>{let h=new Do(l,i),s=new Cf("",h),P=YS(l,[],this.urlTree.queryParams,this.urlTree.fragment);return P.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(P),{state:s,tree:P}}))}match(a){let i=new vu([],Object.freeze({}),Object.freeze(Qe({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Jt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,a,Jt,i).pipe(Ft(l=>({children:l,rootSnapshot:i})),na(l=>{if(l instanceof yp)return this.urlTree=l.urlTree,this.match(l.urlTree.root);throw l instanceof _p?this.noMatchError(l):l}))}processSegmentGroup(a,i,l,h,s){return l.segments.length===0&&l.hasChildren()?this.processChildren(a,i,l,s):this.processSegment(a,i,l,l.segments,h,!0,s).pipe(Ft(P=>P instanceof Do?[P]:[]))}processChildren(a,i,l,h){let s=[];for(let P of Object.keys(l.children))P==="primary"?s.unshift(P):s.push(P);return wr(s).pipe(ql(P=>{let q=l.children[P],X=rP(i,P);return this.processSegmentGroup(a,X,q,P,h)}),Xb((P,q)=>(P.push(...q),P)),B_(null),qb(),Eo(P=>{if(P===null)return gu(l);let q=Fw(P);return GP(q),bt(q)}))}processSegment(a,i,l,h,s,P,q){return wr(i).pipe(ql(X=>this.processSegmentAgainstRoute(X._injector??a,i,X,l,h,s,P,q).pipe(na(be=>{if(be instanceof _p)return bt(null);throw be}))),Xl(X=>!!X),na(X=>{if(Dw(X))return jP(l,h,s)?bt(new V0):gu(l);throw X}))}processSegmentAgainstRoute(a,i,l,h,s,P,q,X){return Is(l)!==P&&(P===Jt||!Tf(h,s,l))?gu(h):l.redirectTo===void 0?this.matchSegmentAgainstRoute(a,h,l,s,P,X):this.allowRedirects&&q?this.expandSegmentAgainstRouteUsingRedirect(a,h,i,l,s,P,X):gu(h)}expandSegmentAgainstRouteUsingRedirect(a,i,l,h,s,P,q){let{matched:X,parameters:be,consumedSegments:ve,positionalParamSegments:$,remainingSegments:$e}=Ow(i,h,s);if(!X)return gu(i);typeof h.redirectTo=="string"&&h.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>$P&&(this.allowRedirects=!1));let ht=new vu(s,be,Object.freeze(Qe({},this.urlTree.queryParams)),this.urlTree.fragment,lw(h),Is(h),h.component??h._loadedComponent??null,h,cw(h)),wt=wf(ht,q,this.paramsInheritanceStrategy);ht.params=Object.freeze(wt.params),ht.data=Object.freeze(wt.data);let lt=this.applyRedirects.applyRedirectCommands(ve,h.redirectTo,$,ht,a);return this.applyRedirects.lineralizeSegments(h,lt).pipe(Eo(at=>this.processSegment(a,l,i,at.concat($e),P,!1,q)))}matchSegmentAgainstRoute(a,i,l,h,s,P){let q=FP(i,l,h,a,this.urlSerializer);return l.path==="**"&&(i.children={}),q.pipe(Cr(X=>X.matched?(a=l._injector??a,this.getChildConfig(a,l,h).pipe(Cr(({routes:be})=>{let ve=l._loadedInjector??a,{parameters:$,consumedSegments:$e,remainingSegments:ht}=X,wt=new vu($e,$,Object.freeze(Qe({},this.urlTree.queryParams)),this.urlTree.fragment,lw(l),Is(l),l.component??l._loadedComponent??null,l,cw(l)),lt=wf(wt,P,this.paramsInheritanceStrategy);wt.params=Object.freeze(lt.params),wt.data=Object.freeze(lt.data);let{segmentGroup:at,slicedSegments:hi}=aw(i,$e,ht,be);if(hi.length===0&&at.hasChildren())return this.processChildren(ve,be,at,wt).pipe(Ft(At=>new Do(wt,At)));if(be.length===0&&hi.length===0)return bt(new Do(wt,[]));let Mi=Is(l)===s;return this.processSegment(ve,be,at,hi,Mi?Jt:s,!0,wt).pipe(Ft(At=>new Do(wt,At instanceof Do?[At]:[])))}))):gu(i)))}getChildConfig(a,i,l){return i.children?bt({routes:i.children,injector:a}):i.loadChildren?i._loadedRoutes!==void 0?bt({routes:i._loadedRoutes,injector:i._loadedInjector}):AP(a,i,l,this.urlSerializer).pipe(Eo(h=>h?this.configLoader.loadChildren(a,i).pipe(tn(s=>{i._loadedRoutes=s.routes,i._loadedInjector=s.injector})):OP(i))):bt({routes:[],injector:a})}};function GP(c){c.sort((a,i)=>a.value.outlet===Jt?-1:i.value.outlet===Jt?1:a.value.outlet.localeCompare(i.value.outlet))}function HP(c){let a=c.value.routeConfig;return a&&a.path===""}function Fw(c){let a=[],i=new Set;for(let l of c){if(!HP(l)){a.push(l);continue}let h=a.find(s=>l.value.routeConfig===s.value.routeConfig);h!==void 0?(h.children.push(...l.children),i.add(h)):a.push(l)}for(let l of i){let h=Fw(l.children);a.push(new Do(l.value,h))}return a.filter(l=>!i.has(l))}function lw(c){return c.data||{}}function cw(c){return c.resolve||{}}function ZP(c,a,i,l,h,s){return Eo(P=>UP(c,a,i,l,P.extractedUrl,h,s).pipe(Ft(({state:q,tree:X})=>di(Qe({},P),{targetSnapshot:q,urlAfterRedirects:X}))))}function WP(c,a){return Eo(i=>{let{targetSnapshot:l,guards:{canActivateChecks:h}}=i;if(!h.length)return bt(i);let s=new Set(h.map(X=>X.route)),P=new Set;for(let X of s)if(!P.has(X))for(let be of Lw(X))P.add(be);let q=0;return wr(P).pipe(ql(X=>s.has(X)?qP(X,l,c,a):(X.data=wf(X,X.parent,c).resolve,bt(void 0))),tn(()=>q++),N_(1),Eo(X=>q===P.size?bt(i):Zl))})}function Lw(c){let a=c.children.map(i=>Lw(i)).flat();return[c,...a]}function qP(c,a,i,l){let h=c.routeConfig,s=c._resolve;return h?.title!==void 0&&!Tw(h)&&(s[bp]=h.title),XP(s,c,a,l).pipe(Ft(P=>(c._resolvedData=P,c.data=wf(c,c.parent,i).resolve,null)))}function XP(c,a,i,l){let h=y0(c);if(h.length===0)return bt({});let s={};return wr(h).pipe(Eo(P=>YP(c[P],a,i,l).pipe(Xl(),tn(q=>{if(q instanceof gp)throw Mf(new wu,q);s[P]=q}))),N_(1),Wb(s),na(P=>Dw(P)?Zl:qc(P)))}function YP(c,a,i,l){let h=wp(a)??l,s=Pu(c,h),P=s.resolve?s.resolve(a,i):Xo(h,()=>s(a,i));return tc(P)}function g0(c){return Cr(a=>{let i=c(a);return i?wr(i).pipe(Ft(()=>a)):bt(a)})}var zw=(()=>{class c{buildTitle(i){let l,h=i.root;for(;h!==void 0;)l=this.getResolvedTitleForRoute(h)??l,h=h.children.find(s=>s.outlet===Jt);return l}getResolvedTitleForRoute(i){return i.data[bp]}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:()=>ge(KP),providedIn:"root"})}return c})(),KP=(()=>{class c extends zw{title;constructor(i){super(),this.title=i}updateTitle(i){let l=this.buildTitle(i);l!==void 0&&this.title.setTitle(l)}static \u0275fac=function(l){return new(l||c)(Vt(ew))};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Pp=new ut("",{providedIn:"root",factory:()=>({})}),QP=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],decls:1,vars:0,template:function(l,h){l&1&&Te(0,"router-outlet")},dependencies:[Mp],encapsulation:2})}return c})();function G0(c){let a=c.children&&c.children.map(G0),i=a?di(Qe({},c),{children:a}):Qe({},c);return!i.component&&!i.loadComponent&&(a||i.loadChildren)&&i.outlet&&i.outlet!==Jt&&(i.component=QP),i}var vp=new ut(""),H0=(()=>{class c{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=ge(Wm);loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return bt(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let l=tc(i.loadComponent()).pipe(Ft(Bw),tn(s=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s}),Xa(()=>{this.componentLoaders.delete(i)})),h=new Rm(l,()=>new qt).pipe(F_());return this.componentLoaders.set(i,h),h}loadChildren(i,l){if(this.childrenLoaders.get(l))return this.childrenLoaders.get(l);if(l._loadedRoutes)return bt({routes:l._loadedRoutes,injector:l._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(l);let s=JP(l,this.compiler,i,this.onLoadEndListener).pipe(Xa(()=>{this.childrenLoaders.delete(l)})),P=new Rm(s,()=>new qt).pipe(F_());return this.childrenLoaders.set(l,P),P}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function JP(c,a,i,l){return tc(c.loadChildren()).pipe(Ft(Bw),Eo(h=>h instanceof mx||Array.isArray(h)?bt(h):wr(a.compileModuleAsync(h))),Ft(h=>{l&&l(c);let s,P,q=!1;return Array.isArray(h)?(P=h,q=!0):(s=h.create(i).injector,P=s.get(vp,[],{optional:!0,self:!0}).flat()),{routes:P.map(G0),injector:s}}))}function eE(c){return c&&typeof c=="object"&&"default"in c}function Bw(c){return eE(c)?c.default:c}var Z0=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:()=>ge(tE),providedIn:"root"})}return c})(),tE=(()=>{class c{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,l){return i}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Nw=new ut(""),Vw=new ut("");function iE(c,a,i){let l=c.get(Vw),h=c.get(vi);return c.get(_i).runOutsideAngular(()=>{if(!h.startViewTransition||l.skipNextTransition)return l.skipNextTransition=!1,new Promise(be=>setTimeout(be));let s,P=new Promise(be=>{s=be}),q=h.startViewTransition(()=>(s(),nE(c))),{onViewTransitionCreated:X}=l;return X&&Xo(c,()=>X({transition:q,from:a,to:i})),P})}function nE(c){return new Promise(a=>{au({read:()=>setTimeout(a)},{injector:c})})}var jw=new ut(""),W0=(()=>{class c{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new qt;transitionAbortSubject=new qt;configLoader=ge(H0);environmentInjector=ge(Ss);urlSerializer=ge(xp);rootContexts=ge(Cp);location=ge(ed);inputBindingEnabled=ge(Ef,{optional:!0})!==null;titleStrategy=ge(zw);options=ge(Pp,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=ge(Z0);createViewTransition=ge(Nw,{optional:!0});navigationErrorHandler=ge(jw,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>bt(void 0);rootComponentType=null;constructor(){let i=h=>this.events.next(new P0(h)),l=h=>this.events.next(new E0(h));this.configLoader.onLoadEndListener=l,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let l=++this.navigationId;this.transitions?.next(di(Qe(Qe({},this.transitions.value),i),{id:l}))}setupNavigations(i,l,h){return this.transitions=new so({id:0,currentUrlTree:l,currentRawUrl:l,extractedUrl:this.urlHandlingStrategy.extract(l),urlAfterRedirects:this.urlHandlingStrategy.extract(l),rawUrl:l,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:cp,restoredState:null,currentSnapshot:h.snapshot,targetSnapshot:null,currentRouterState:h,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(bn(s=>s.id!==0),Ft(s=>di(Qe({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Cr(s=>{let P=!1,q=!1;return bt(s).pipe(Cr(X=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Ro.SupersededByNewNavigation),Zl;this.currentTransition=s,this.currentNavigation={id:X.id,initialUrl:X.rawUrl,extractedUrl:X.extractedUrl,targetBrowserUrl:typeof X.extras.browserUrl=="string"?this.urlSerializer.parse(X.extras.browserUrl):X.extras.browserUrl,trigger:X.source,extras:X.extras,previousNavigation:this.lastSuccessfulNavigation?di(Qe({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let be=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),ve=X.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!be&&ve!=="reload"){let $="";return this.events.next(new ec(X.id,this.urlSerializer.serialize(X.rawUrl),$,_f.IgnoredSameUrlNavigation)),X.resolve(!1),Zl}if(this.urlHandlingStrategy.shouldProcessUrl(X.rawUrl))return bt(X).pipe(Cr($=>{let $e=this.transitions?.getValue();return this.events.next(new Cu($.id,this.urlSerializer.serialize($.extractedUrl),$.source,$.restoredState)),$e!==this.transitions?.getValue()?Zl:Promise.resolve($)}),ZP(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),tn($=>{s.targetSnapshot=$.targetSnapshot,s.urlAfterRedirects=$.urlAfterRedirects,this.currentNavigation=di(Qe({},this.currentNavigation),{finalUrl:$.urlAfterRedirects});let $e=new yf($.id,this.urlSerializer.serialize($.extractedUrl),this.urlSerializer.serialize($.urlAfterRedirects),$.targetSnapshot);this.events.next($e)}));if(be&&this.urlHandlingStrategy.shouldProcessUrl(X.currentRawUrl)){let{id:$,extractedUrl:$e,source:ht,restoredState:wt,extras:lt}=X,at=new Cu($,this.urlSerializer.serialize($e),ht,wt);this.events.next(at);let hi=Pw(this.rootComponentType).snapshot;return this.currentTransition=s=di(Qe({},X),{targetSnapshot:hi,urlAfterRedirects:$e,extras:di(Qe({},lt),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=$e,bt(s)}else{let $="";return this.events.next(new ec(X.id,this.urlSerializer.serialize(X.extractedUrl),$,_f.IgnoredByUrlHandlingStrategy)),X.resolve(!1),Zl}}),tn(X=>{let be=new w0(X.id,this.urlSerializer.serialize(X.extractedUrl),this.urlSerializer.serialize(X.urlAfterRedirects),X.targetSnapshot);this.events.next(be)}),Ft(X=>(this.currentTransition=s=di(Qe({},X),{guards:hP(X.targetSnapshot,X.currentSnapshot,this.rootContexts)}),s)),CP(this.environmentInjector,X=>this.events.next(X)),tn(X=>{if(s.guardsResult=X.guardsResult,X.guardsResult&&typeof X.guardsResult!="boolean")throw Mf(this.urlSerializer,X.guardsResult);let be=new C0(X.id,this.urlSerializer.serialize(X.extractedUrl),this.urlSerializer.serialize(X.urlAfterRedirects),X.targetSnapshot,!!X.guardsResult);this.events.next(be)}),bn(X=>X.guardsResult?!0:(this.cancelNavigationTransition(X,"",Ro.GuardRejected),!1)),g0(X=>{if(X.guards.canActivateChecks.length)return bt(X).pipe(tn(be=>{let ve=new M0(be.id,this.urlSerializer.serialize(be.extractedUrl),this.urlSerializer.serialize(be.urlAfterRedirects),be.targetSnapshot);this.events.next(ve)}),Cr(be=>{let ve=!1;return bt(be).pipe(WP(this.paramsInheritanceStrategy,this.environmentInjector),tn({next:()=>ve=!0,complete:()=>{ve||this.cancelNavigationTransition(be,"",Ro.NoDataFromResolver)}}))}),tn(be=>{let ve=new S0(be.id,this.urlSerializer.serialize(be.extractedUrl),this.urlSerializer.serialize(be.urlAfterRedirects),be.targetSnapshot);this.events.next(ve)}))}),g0(X=>{let be=ve=>{let $=[];ve.routeConfig?.loadComponent&&!ve.routeConfig._loadedComponent&&$.push(this.configLoader.loadComponent(ve.routeConfig).pipe(tn($e=>{ve.component=$e}),Ft(()=>{})));for(let $e of ve.children)$.push(...be($e));return $};return su(be(X.targetSnapshot.root)).pipe(B_(null),To(1))}),g0(()=>this.afterPreactivation()),Cr(()=>{let{currentSnapshot:X,targetSnapshot:be}=s,ve=this.createViewTransition?.(this.environmentInjector,X.root,be.root);return ve?wr(ve).pipe(Ft(()=>s)):bt(s)}),Ft(X=>{let be=aP(i.routeReuseStrategy,X.targetSnapshot,X.currentRouterState);return this.currentTransition=s=di(Qe({},X),{targetRouterState:be}),this.currentNavigation.targetRouterState=be,s}),tn(()=>{this.events.next(new mp)}),uP(this.rootContexts,i.routeReuseStrategy,X=>this.events.next(X),this.inputBindingEnabled),To(1),tn({next:X=>{P=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ja(X.id,this.urlSerializer.serialize(X.extractedUrl),this.urlSerializer.serialize(X.urlAfterRedirects))),this.titleStrategy?.updateTitle(X.targetRouterState.snapshot),X.resolve(!0)},complete:()=>{P=!0}}),Rn(this.transitionAbortSubject.pipe(tn(X=>{throw X}))),Xa(()=>{!P&&!q&&this.cancelNavigationTransition(s,"",Ro.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),na(X=>{if(q=!0,Aw(X))this.events.next(new Ka(s.id,this.urlSerializer.serialize(s.extractedUrl),X.message,X.cancellationCode)),dP(X)?this.events.next(new Mu(X.url,X.navigationBehaviorOptions)):s.resolve(!1);else{let be=new pp(s.id,this.urlSerializer.serialize(s.extractedUrl),X,s.targetSnapshot??void 0);try{let ve=Xo(this.environmentInjector,()=>this.navigationErrorHandler?.(be));if(ve instanceof gp){let{message:$,cancellationCode:$e}=Mf(this.urlSerializer,ve);this.events.next(new Ka(s.id,this.urlSerializer.serialize(s.extractedUrl),$,$e)),this.events.next(new Mu(ve.redirectTo,ve.navigationBehaviorOptions))}else throw this.events.next(be),X}catch(ve){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(ve)}}return Zl}))}))}cancelNavigationTransition(i,l,h){let s=new Ka(i.id,this.urlSerializer.serialize(i.extractedUrl),l,h);this.events.next(s),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let i=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),l=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return i.toString()!==l?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function rE(c){return c!==cp}var oE=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:()=>ge(sE),providedIn:"root"})}return c})(),U0=class{shouldDetach(a){return!1}store(a,i){}shouldAttach(a){return!1}retrieve(a){return null}shouldReuseRoute(a,i){return a.routeConfig===i.routeConfig}},sE=(()=>{class c extends U0{static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Uw=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:()=>ge(aE),providedIn:"root"})}return c})(),aE=(()=>{class c extends Uw{location=ge(ed);urlSerializer=ge(xp);options=ge(Pp,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=ge(Z0);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Qa;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=Pw(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(l=>{l.type==="popstate"&&i(l.url,l.state)})}handleRouterEvent(i,l){if(i instanceof Cu)this.stateMemento=this.createStateMemento();else if(i instanceof ec)this.rawUrlTree=l.initialUrl;else if(i instanceof yf){if(this.urlUpdateStrategy==="eager"&&!l.extras.skipLocationChange){let h=this.urlHandlingStrategy.merge(l.finalUrl,l.initialUrl);this.setBrowserUrl(l.targetBrowserUrl??h,l)}}else i instanceof mp?(this.currentUrlTree=l.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(l.finalUrl,l.initialUrl),this.routerState=l.targetRouterState,this.urlUpdateStrategy==="deferred"&&!l.extras.skipLocationChange&&this.setBrowserUrl(l.targetBrowserUrl??this.rawUrlTree,l)):i instanceof Ka&&(i.code===Ro.GuardRejected||i.code===Ro.NoDataFromResolver)?this.restoreHistory(l):i instanceof pp?this.restoreHistory(l,!0):i instanceof Ja&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,l){let h=i instanceof Qa?this.urlSerializer.serialize(i):i;if(this.location.isCurrentPathEqualTo(h)||l.extras.replaceUrl){let s=this.browserPageId,P=Qe(Qe({},l.extras.state),this.generateNgRouterState(l.id,s));this.location.replaceState(h,"",P)}else{let s=Qe(Qe({},l.extras.state),this.generateNgRouterState(l.id,this.browserPageId+1));this.location.go(h,"",s)}}restoreHistory(i,l=!1){if(this.canceledNavigationResolution==="computed"){let h=this.browserPageId,s=this.currentPageId-h;s!==0?this.location.historyGo(s):this.currentUrlTree===i.finalUrl&&s===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(l&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,l){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:l}:{navigationId:i}}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),ap=function(c){return c[c.COMPLETE=0]="COMPLETE",c[c.FAILED=1]="FAILED",c[c.REDIRECTING=2]="REDIRECTING",c}(ap||{});function $w(c,a){c.events.pipe(bn(i=>i instanceof Ja||i instanceof Ka||i instanceof pp||i instanceof ec),Ft(i=>i instanceof Ja||i instanceof ec?ap.COMPLETE:(i instanceof Ka?i.code===Ro.Redirect||i.code===Ro.SupersededByNewNavigation:!1)?ap.REDIRECTING:ap.FAILED),bn(i=>i!==ap.REDIRECTING),To(1)).subscribe(()=>{a()})}var lE={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},cE={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},uo=(()=>{class c{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=ge(Um);stateManager=ge(Uw);options=ge(Pp,{optional:!0})||{};pendingTasks=ge(Vh);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=ge(W0);urlSerializer=ge(xp);location=ge(ed);urlHandlingStrategy=ge(Z0);_events=new qt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=ge(oE);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=ge(vp,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!ge(Ef,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Rr;subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(l=>{try{let h=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(h!==null&&s!==null){if(this.stateManager.handleRouterEvent(l,s),l instanceof Ka&&l.code!==Ro.Redirect&&l.code!==Ro.SupersededByNewNavigation)this.navigated=!0;else if(l instanceof Ja)this.navigated=!0;else if(l instanceof Mu){let P=l.navigationBehaviorOptions,q=this.urlHandlingStrategy.merge(l.url,h.currentRawUrl),X=Qe({browserUrl:h.extras.browserUrl,info:h.extras.info,skipLocationChange:h.extras.skipLocationChange,replaceUrl:h.extras.replaceUrl||this.urlUpdateStrategy==="eager"||rE(h.source)},P);this.scheduleNavigation(q,cp,null,X,{resolve:h.resolve,reject:h.reject,promise:h.promise})}}uE(l)&&this._events.next(l)}catch(h){this.navigationTransitions.transitionAbortSubject.next(h)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),cp,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,l)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",l)},0)})}navigateToSyncWithBrowser(i,l,h){let s={replaceUrl:!0},P=h?.navigationId?h:null;if(h){let X=Qe({},h);delete X.navigationId,delete X.\u0275routerPageId,Object.keys(X).length!==0&&(s.state=X)}let q=this.parseUrl(i);this.scheduleNavigation(q,l,P,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(G0),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,l={}){let{relativeTo:h,queryParams:s,fragment:P,queryParamsHandling:q,preserveFragment:X}=l,be=X?this.currentUrlTree.fragment:P,ve=null;switch(q??this.options.defaultQueryParamsHandling){case"merge":ve=Qe(Qe({},this.currentUrlTree.queryParams),s);break;case"preserve":ve=this.currentUrlTree.queryParams;break;default:ve=s||null}ve!==null&&(ve=this.removeEmptyProps(ve));let $;try{let $e=h?h.snapshot:this.routerState.snapshot.root;$=ww($e)}catch{(typeof i[0]!="string"||i[0][0]!=="/")&&(i=[]),$=this.currentUrlTree.root}return Cw($,i,ve,be??null)}navigateByUrl(i,l={skipLocationChange:!1}){let h=up(i)?i:this.parseUrl(i),s=this.urlHandlingStrategy.merge(h,this.rawUrlTree);return this.scheduleNavigation(s,cp,null,l)}navigate(i,l={skipLocationChange:!1}){return dE(i),this.navigateByUrl(this.createUrlTree(i,l),l)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,l){let h;if(l===!0?h=Qe({},lE):l===!1?h=Qe({},cE):h=l,up(i))return iw(this.currentUrlTree,i,h);let s=this.parseUrl(i);return iw(this.currentUrlTree,s,h)}removeEmptyProps(i){return Object.entries(i).reduce((l,[h,s])=>(s!=null&&(l[h]=s),l),{})}scheduleNavigation(i,l,h,s,P){if(this.disposed)return Promise.resolve(!1);let q,X,be;P?(q=P.resolve,X=P.reject,be=P.promise):be=new Promise(($,$e)=>{q=$,X=$e});let ve=this.pendingTasks.add();return $w(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(ve))}),this.navigationTransitions.handleNavigationRequest({source:l,restoredState:h,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:s,resolve:q,reject:X,promise:be,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),be.catch($=>Promise.reject($))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function dE(c){for(let a=0;a<c.length;a++)if(c[a]==null)throw new Di(4008,!1)}function uE(c){return!(c instanceof mp)&&!(c instanceof Mu)}var Pf=class{};var hE=(()=>{class c{router;injector;preloadingStrategy;loader;subscription;constructor(i,l,h,s,P){this.router=i,this.injector=h,this.preloadingStrategy=s,this.loader=P}setUpPreloading(){this.subscription=this.router.events.pipe(bn(i=>i instanceof Ja),ql(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,l){let h=[];for(let s of l){s.providers&&!s._injector&&(s._injector=Z_(s.providers,i,`Route: ${s.path}`));let P=s._injector??i,q=s._loadedInjector??P;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&h.push(this.preloadConfig(P,s)),(s.children||s._loadedRoutes)&&h.push(this.processRoutes(q,s.children??s._loadedRoutes))}return wr(h).pipe(L_())}preloadConfig(i,l){return this.preloadingStrategy.preload(l,()=>{let h;l.loadChildren&&l.canLoad===void 0?h=this.loader.loadChildren(i,l):h=bt(null);let s=h.pipe(Eo(P=>P===null?bt(void 0):(l._loadedRoutes=P.routes,l._loadedInjector=P.injector,this.processRoutes(P.injector??i,P.routes))));if(l.loadComponent&&!l._loadedComponent){let P=this.loader.loadComponent(l);return wr([s,P]).pipe(L_())}else return s})}static \u0275fac=function(l){return new(l||c)(Vt(uo),Vt(Wm),Vt(Ss),Vt(Pf),Vt(H0))};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Gw=new ut(""),pE=(()=>{class c{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(i,l,h,s,P={}){this.urlSerializer=i,this.transitions=l,this.viewportScroller=h,this.zone=s,this.options=P,P.scrollPositionRestoration||="disabled",P.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof Cu?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof Ja?(this.lastId=i.id,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.urlAfterRedirects).fragment)):i instanceof ec&&i.code===_f.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof vf&&(i.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(i.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,l){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new vf(i,this.lastSource==="popstate"?this.store[this.restoredId]:null,l))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(l){Nm()};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})();function Hw(c,...a){return Xc([{provide:vp,multi:!0,useValue:c},[],{provide:od,useFactory:Zw,deps:[uo]},{provide:Gm,multi:!0,useFactory:Ww},a.map(i=>i.\u0275providers)])}function Zw(c){return c.routerState.root}function Ep(c,a){return{\u0275kind:c,\u0275providers:a}}function Ww(){let c=ge(Or);return a=>{let i=c.get(Kl);if(a!==i.components[0])return;let l=c.get(uo),h=c.get(qw);c.get(q0)===1&&l.initialNavigation(),c.get(Xw,null,U_.Optional)?.setUpPreloading(),c.get(Gw,null,U_.Optional)?.init(),l.resetRootComponentType(i.componentTypes[0]),h.closed||(h.next(),h.complete(),h.unsubscribe())}}var qw=new ut("",{factory:()=>new qt}),q0=new ut("",{providedIn:"root",factory:()=>1});function mE(){return Ep(2,[{provide:q0,useValue:0},{provide:W_,multi:!0,deps:[Or],useFactory:a=>{let i=a.get(Sx,Promise.resolve());return()=>i.then(()=>new Promise(l=>{let h=a.get(uo),s=a.get(qw);$w(h,()=>{l(!0)}),a.get(W0).afterPreactivation=()=>(l(!0),s.closed?bt(void 0):s),h.initialNavigation()}))}}])}function fE(){return Ep(3,[{provide:W_,multi:!0,useFactory:()=>{let a=ge(uo);return()=>{a.setUpLocationChangeListener()}}},{provide:q0,useValue:2}])}var Xw=new ut("");function gE(c){return Ep(0,[{provide:Xw,useExisting:hE},{provide:Pf,useExisting:c}])}function _E(){return Ep(8,[sw,{provide:Ef,useExisting:sw}])}function yE(c){let a=[{provide:Nw,useValue:iE},{provide:Vw,useValue:Qe({skipNextTransition:!!c?.skipInitialTransition},c)}];return Ep(9,a)}var dw=new ut("ROUTER_FORROOT_GUARD"),vE=[ed,{provide:xp,useClass:wu},uo,Cp,{provide:od,useFactory:Zw,deps:[uo]},H0,[]],ic=(()=>{class c{constructor(i){}static forRoot(i,l){return{ngModule:c,providers:[vE,[],{provide:vp,multi:!0,useValue:i},{provide:dw,useFactory:CE,deps:[[uo,new Bh,new $_]]},l?.errorHandler?{provide:jw,useValue:l.errorHandler}:[],{provide:Pp,useValue:l||{}},l?.useHash?xE():wE(),bE(),l?.preloadingStrategy?gE(l.preloadingStrategy).\u0275providers:[],l?.initialNavigation?ME(l):[],l?.bindToComponentInputs?_E().\u0275providers:[],l?.enableViewTransitions?yE().\u0275providers:[],SE()]}}static forChild(i){return{ngModule:c,providers:[{provide:vp,multi:!0,useValue:i}]}}static \u0275fac=function(l){return new(l||c)(Vt(dw,8))};static \u0275mod=Gt({type:c});static \u0275inj=$t({})}return c})();function bE(){return{provide:Gw,useFactory:()=>{let c=ge(Ix),a=ge(_i),i=ge(Pp),l=ge(W0),h=ge(xp);return i.scrollOffset&&c.setOffset(i.scrollOffset),new pE(h,l,c,a,i)}}}function xE(){return{provide:X_,useClass:Ex}}function wE(){return{provide:X_,useClass:Px}}function CE(c){return"guarded"}function ME(c){return[c.initialNavigation==="disabled"?fE().\u0275providers:[],c.initialNavigation==="enabledBlocking"?mE().\u0275providers:[]]}var uw=new ut("");function SE(){return[{provide:uw,useFactory:Ww},{provide:Gm,multi:!0,useExisting:uw}]}var o1=(()=>{class c{_renderer;_elementRef;onChange=i=>{};onTouched=()=>{};constructor(i,l){this._renderer=i,this._elementRef=l}setProperty(i,l){this._renderer.setProperty(this._elementRef.nativeElement,i,l)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}static \u0275fac=function(l){return new(l||c)(It(du),It(Si))};static \u0275dir=Ht({type:c})}return c})(),zf=(()=>{class c extends o1{static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275dir=Ht({type:c,features:[Wr]})}return c})(),oc=new ut(""),PE={provide:oc,useExisting:qo(()=>ey),multi:!0},ey=(()=>{class c extends zf{writeValue(i){this.setProperty("checked",i)}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275dir=Ht({type:c,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(l,h){l&1&&tt("change",function(P){return h.onChange(P.target.checked)})("blur",function(){return h.onTouched()})},standalone:!1,features:[Gn([PE]),Wr]})}return c})(),EE={provide:oc,useExisting:qo(()=>la),multi:!0};function TE(){let c=hu()?hu().getUserAgent():"";return/android (\d+)/.test(c.toLowerCase())}var IE=new ut(""),la=(()=>{class c extends o1{_compositionMode;_composing=!1;constructor(i,l,h){super(i,l),this._compositionMode=h,this._compositionMode==null&&(this._compositionMode=!TE())}writeValue(i){let l=i??"";this.setProperty("value",l)}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}static \u0275fac=function(l){return new(l||c)(It(du),It(Si),It(IE,8))};static \u0275dir=Ht({type:c,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(l,h){l&1&&tt("input",function(P){return h._handleInput(P.target.value)})("blur",function(){return h.onTouched()})("compositionstart",function(){return h._compositionStart()})("compositionend",function(P){return h._compositionEnd(P.target.value)})},standalone:!1,features:[Gn([EE]),Wr]})}return c})();function nc(c){return c==null||(typeof c=="string"||Array.isArray(c))&&c.length===0}function s1(c){return c!=null&&typeof c.length=="number"}var Bf=new ut(""),Nf=new ut(""),kE=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Oo=class{static min(a){return AE(a)}static max(a){return DE(a)}static required(a){return RE(a)}static requiredTrue(a){return OE(a)}static email(a){return FE(a)}static minLength(a){return LE(a)}static maxLength(a){return zE(a)}static pattern(a){return BE(a)}static nullValidator(a){return a1(a)}static compose(a){return p1(a)}static composeAsync(a){return m1(a)}};function AE(c){return a=>{if(nc(a.value)||nc(c))return null;let i=parseFloat(a.value);return!isNaN(i)&&i<c?{min:{min:c,actual:a.value}}:null}}function DE(c){return a=>{if(nc(a.value)||nc(c))return null;let i=parseFloat(a.value);return!isNaN(i)&&i>c?{max:{max:c,actual:a.value}}:null}}function RE(c){return nc(c.value)?{required:!0}:null}function OE(c){return c.value===!0?null:{required:!0}}function FE(c){return nc(c.value)||kE.test(c.value)?null:{email:!0}}function LE(c){return a=>nc(a.value)||!s1(a.value)?null:a.value.length<c?{minlength:{requiredLength:c,actualLength:a.value.length}}:null}function zE(c){return a=>s1(a.value)&&a.value.length>c?{maxlength:{requiredLength:c,actualLength:a.value.length}}:null}function BE(c){if(!c)return a1;let a,i;return typeof c=="string"?(i="",c.charAt(0)!=="^"&&(i+="^"),i+=c,c.charAt(c.length-1)!=="$"&&(i+="$"),a=new RegExp(i)):(i=c.toString(),a=c),l=>{if(nc(l.value))return null;let h=l.value;return a.test(h)?null:{pattern:{requiredPattern:i,actualValue:h}}}}function a1(c){return null}function l1(c){return c!=null}function c1(c){return $m(c)?wr(c):c}function d1(c){let a={};return c.forEach(i=>{a=i!=null?Qe(Qe({},a),i):a}),Object.keys(a).length===0?null:a}function u1(c,a){return a.map(i=>i(c))}function NE(c){return!c.validate}function h1(c){return c.map(a=>NE(a)?a:i=>a.validate(i))}function p1(c){if(!c)return null;let a=c.filter(l1);return a.length==0?null:function(i){return d1(u1(i,a))}}function ty(c){return c!=null?p1(h1(c)):null}function m1(c){if(!c)return null;let a=c.filter(l1);return a.length==0?null:function(i){let l=u1(i,a).map(c1);return Fm(l).pipe(Ft(d1))}}function iy(c){return c!=null?m1(h1(c)):null}function Yw(c,a){return c===null?[a]:Array.isArray(c)?[...c,a]:[c,a]}function f1(c){return c._rawValidators}function g1(c){return c._rawAsyncValidators}function X0(c){return c?Array.isArray(c)?c:[c]:[]}function kf(c,a){return Array.isArray(c)?c.includes(a):c===a}function Kw(c,a){let i=X0(a);return X0(c).forEach(h=>{kf(i,h)||i.push(h)}),i}function Qw(c,a){return X0(a).filter(i=>!kf(c,i))}var Af=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(a){this._rawValidators=a||[],this._composedValidatorFn=ty(this._rawValidators)}_setAsyncValidators(a){this._rawAsyncValidators=a||[],this._composedAsyncValidatorFn=iy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(a){this._onDestroyCallbacks.push(a)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(a=>a()),this._onDestroyCallbacks=[]}reset(a=void 0){this.control&&this.control.reset(a)}hasError(a,i){return this.control?this.control.hasError(a,i):!1}getError(a,i){return this.control?this.control.getError(a,i):null}},el=class extends Af{name;get formDirective(){return null}get path(){return null}},tl=class extends Af{_parent=null;name=null;valueAccessor=null},Df=class{_cd;constructor(a){this._cd=a}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},VE={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},GR=di(Qe({},VE),{"[class.ng-submitted]":"isSubmitted"}),ca=(()=>{class c extends Df{constructor(i){super(i)}static \u0275fac=function(l){return new(l||c)(It(tl,2))};static \u0275dir=Ht({type:c,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(l,h){l&2&&si("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)},standalone:!1,features:[Wr]})}return c})(),Vf=(()=>{class c extends Df{constructor(i){super(i)}static \u0275fac=function(l){return new(l||c)(It(el,10))};static \u0275dir=Ht({type:c,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(l,h){l&2&&si("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)("ng-submitted",h.isSubmitted)},standalone:!1,features:[Wr]})}return c})();var Ip="VALID",If="INVALID",Eu="PENDING",kp="DISABLED",rc=class{},Rf=class extends rc{value;source;constructor(a,i){super(),this.value=a,this.source=i}},Dp=class extends rc{pristine;source;constructor(a,i){super(),this.pristine=a,this.source=i}},Rp=class extends rc{touched;source;constructor(a,i){super(),this.touched=a,this.source=i}},Tu=class extends rc{status;source;constructor(a,i){super(),this.status=a,this.source=i}},Y0=class extends rc{source;constructor(a){super(),this.source=a}},K0=class extends rc{source;constructor(a){super(),this.source=a}};function ny(c){return(jf(c)?c.validators:c)||null}function jE(c){return Array.isArray(c)?ty(c):c||null}function ry(c,a){return(jf(a)?a.asyncValidators:c)||null}function UE(c){return Array.isArray(c)?iy(c):c||null}function jf(c){return c!=null&&!Array.isArray(c)&&typeof c=="object"}function _1(c,a,i){let l=c.controls;if(!(a?Object.keys(l):l).length)throw new Di(1e3,"");if(!l[i])throw new Di(1001,"")}function y1(c,a,i){c._forEachChild((l,h)=>{if(i[h]===void 0)throw new Di(1002,"")})}var Iu=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(a,i){this._assignValidators(a),this._assignAsyncValidators(i)}get validator(){return this._composedValidatorFn}set validator(a){this._rawValidators=this._composedValidatorFn=a}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(a){this._rawAsyncValidators=this._composedAsyncValidatorFn=a}get parent(){return this._parent}get status(){return Es(this.statusReactive)}set status(a){Es(()=>this.statusReactive.set(a))}_status=Ya(()=>this.statusReactive());statusReactive=Yl(void 0);get valid(){return this.status===Ip}get invalid(){return this.status===If}get pending(){return this.status==Eu}get disabled(){return this.status===kp}get enabled(){return this.status!==kp}errors;get pristine(){return Es(this.pristineReactive)}set pristine(a){Es(()=>this.pristineReactive.set(a))}_pristine=Ya(()=>this.pristineReactive());pristineReactive=Yl(!0);get dirty(){return!this.pristine}get touched(){return Es(this.touchedReactive)}set touched(a){Es(()=>this.touchedReactive.set(a))}_touched=Ya(()=>this.touchedReactive());touchedReactive=Yl(!1);get untouched(){return!this.touched}_events=new qt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(a){this._assignValidators(a)}setAsyncValidators(a){this._assignAsyncValidators(a)}addValidators(a){this.setValidators(Kw(a,this._rawValidators))}addAsyncValidators(a){this.setAsyncValidators(Kw(a,this._rawAsyncValidators))}removeValidators(a){this.setValidators(Qw(a,this._rawValidators))}removeAsyncValidators(a){this.setAsyncValidators(Qw(a,this._rawAsyncValidators))}hasValidator(a){return kf(this._rawValidators,a)}hasAsyncValidator(a){return kf(this._rawAsyncValidators,a)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(a={}){let i=this.touched===!1;this.touched=!0;let l=a.sourceControl??this;this._parent&&!a.onlySelf&&this._parent.markAsTouched(di(Qe({},a),{sourceControl:l})),i&&a.emitEvent!==!1&&this._events.next(new Rp(!0,l))}markAllAsTouched(a={}){this.markAsTouched({onlySelf:!0,emitEvent:a.emitEvent,sourceControl:this}),this._forEachChild(i=>i.markAllAsTouched(a))}markAsUntouched(a={}){let i=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let l=a.sourceControl??this;this._forEachChild(h=>{h.markAsUntouched({onlySelf:!0,emitEvent:a.emitEvent,sourceControl:l})}),this._parent&&!a.onlySelf&&this._parent._updateTouched(a,l),i&&a.emitEvent!==!1&&this._events.next(new Rp(!1,l))}markAsDirty(a={}){let i=this.pristine===!0;this.pristine=!1;let l=a.sourceControl??this;this._parent&&!a.onlySelf&&this._parent.markAsDirty(di(Qe({},a),{sourceControl:l})),i&&a.emitEvent!==!1&&this._events.next(new Dp(!1,l))}markAsPristine(a={}){let i=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let l=a.sourceControl??this;this._forEachChild(h=>{h.markAsPristine({onlySelf:!0,emitEvent:a.emitEvent})}),this._parent&&!a.onlySelf&&this._parent._updatePristine(a,l),i&&a.emitEvent!==!1&&this._events.next(new Dp(!0,l))}markAsPending(a={}){this.status=Eu;let i=a.sourceControl??this;a.emitEvent!==!1&&(this._events.next(new Tu(this.status,i)),this.statusChanges.emit(this.status)),this._parent&&!a.onlySelf&&this._parent.markAsPending(di(Qe({},a),{sourceControl:i}))}disable(a={}){let i=this._parentMarkedDirty(a.onlySelf);this.status=kp,this.errors=null,this._forEachChild(h=>{h.disable(di(Qe({},a),{onlySelf:!0}))}),this._updateValue();let l=a.sourceControl??this;a.emitEvent!==!1&&(this._events.next(new Rf(this.value,l)),this._events.next(new Tu(this.status,l)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(di(Qe({},a),{skipPristineCheck:i}),this),this._onDisabledChange.forEach(h=>h(!0))}enable(a={}){let i=this._parentMarkedDirty(a.onlySelf);this.status=Ip,this._forEachChild(l=>{l.enable(di(Qe({},a),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:a.emitEvent}),this._updateAncestors(di(Qe({},a),{skipPristineCheck:i}),this),this._onDisabledChange.forEach(l=>l(!1))}_updateAncestors(a,i){this._parent&&!a.onlySelf&&(this._parent.updateValueAndValidity(a),a.skipPristineCheck||this._parent._updatePristine({},i),this._parent._updateTouched({},i))}setParent(a){this._parent=a}getRawValue(){return this.value}updateValueAndValidity(a={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let l=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ip||this.status===Eu)&&this._runAsyncValidator(l,a.emitEvent)}let i=a.sourceControl??this;a.emitEvent!==!1&&(this._events.next(new Rf(this.value,i)),this._events.next(new Tu(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!a.onlySelf&&this._parent.updateValueAndValidity(di(Qe({},a),{sourceControl:i}))}_updateTreeValidity(a={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(a)),this.updateValueAndValidity({onlySelf:!0,emitEvent:a.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?kp:Ip}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(a,i){if(this.asyncValidator){this.status=Eu,this._hasOwnPendingAsyncValidator={emitEvent:i!==!1};let l=c1(this.asyncValidator(this));this._asyncValidationSubscription=l.subscribe(h=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(h,{emitEvent:i,shouldHaveEmitted:a})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let a=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,a}return!1}setErrors(a,i={}){this.errors=a,this._updateControlsErrors(i.emitEvent!==!1,this,i.shouldHaveEmitted)}get(a){let i=a;return i==null||(Array.isArray(i)||(i=i.split(".")),i.length===0)?null:i.reduce((l,h)=>l&&l._find(h),this)}getError(a,i){let l=i?this.get(i):this;return l&&l.errors?l.errors[a]:null}hasError(a,i){return!!this.getError(a,i)}get root(){let a=this;for(;a._parent;)a=a._parent;return a}_updateControlsErrors(a,i,l){this.status=this._calculateStatus(),a&&this.statusChanges.emit(this.status),(a||l)&&this._events.next(new Tu(this.status,i)),this._parent&&this._parent._updateControlsErrors(a,i,l)}_initObservables(){this.valueChanges=new oi,this.statusChanges=new oi}_calculateStatus(){return this._allControlsDisabled()?kp:this.errors?If:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Eu)?Eu:this._anyControlsHaveStatus(If)?If:Ip}_anyControlsHaveStatus(a){return this._anyControls(i=>i.status===a)}_anyControlsDirty(){return this._anyControls(a=>a.dirty)}_anyControlsTouched(){return this._anyControls(a=>a.touched)}_updatePristine(a,i){let l=!this._anyControlsDirty(),h=this.pristine!==l;this.pristine=l,this._parent&&!a.onlySelf&&this._parent._updatePristine(a,i),h&&this._events.next(new Dp(this.pristine,i))}_updateTouched(a={},i){this.touched=this._anyControlsTouched(),this._events.next(new Rp(this.touched,i)),this._parent&&!a.onlySelf&&this._parent._updateTouched(a,i)}_onDisabledChange=[];_registerOnCollectionChange(a){this._onCollectionChange=a}_setUpdateStrategy(a){jf(a)&&a.updateOn!=null&&(this._updateOn=a.updateOn)}_parentMarkedDirty(a){let i=this._parent&&this._parent.dirty;return!a&&!!i&&!this._parent._anyControlsDirty()}_find(a){return null}_assignValidators(a){this._rawValidators=Array.isArray(a)?a.slice():a,this._composedValidatorFn=jE(this._rawValidators)}_assignAsyncValidators(a){this._rawAsyncValidators=Array.isArray(a)?a.slice():a,this._composedAsyncValidatorFn=UE(this._rawAsyncValidators)}},ku=class extends Iu{constructor(a,i,l){super(ny(i),ry(l,i)),this.controls=a,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(a,i){return this.controls[a]?this.controls[a]:(this.controls[a]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(a,i,l={}){this.registerControl(a,i),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}removeControl(a,i={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),delete this.controls[a],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(a,i,l={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),delete this.controls[a],i&&this.registerControl(a,i),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}contains(a){return this.controls.hasOwnProperty(a)&&this.controls[a].enabled}setValue(a,i={}){y1(this,!0,a),Object.keys(a).forEach(l=>{_1(this,!0,l),this.controls[l].setValue(a[l],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(a,i={}){a!=null&&(Object.keys(a).forEach(l=>{let h=this.controls[l];h&&h.patchValue(a[l],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(a={},i={}){this._forEachChild((l,h)=>{l.reset(a?a[h]:null,{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i,this),this._updateTouched(i,this),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(a,i,l)=>(a[l]=i.getRawValue(),a))}_syncPendingControls(){let a=this._reduceChildren(!1,(i,l)=>l._syncPendingControls()?!0:i);return a&&this.updateValueAndValidity({onlySelf:!0}),a}_forEachChild(a){Object.keys(this.controls).forEach(i=>{let l=this.controls[i];l&&a(l,i)})}_setUpControls(){this._forEachChild(a=>{a.setParent(this),a._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(a){for(let[i,l]of Object.entries(this.controls))if(this.contains(i)&&a(l))return!0;return!1}_reduceValue(){let a={};return this._reduceChildren(a,(i,l,h)=>((l.enabled||this.disabled)&&(i[h]=l.value),i))}_reduceChildren(a,i){let l=a;return this._forEachChild((h,s)=>{l=i(l,h,s)}),l}_allControlsDisabled(){for(let a of Object.keys(this.controls))if(this.controls[a].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(a){return this.controls.hasOwnProperty(a)?this.controls[a]:null}};var Q0=class extends ku{};var Fp=new ut("CallSetDisabledState",{providedIn:"root",factory:()=>Uf}),Uf="always";function v1(c,a){return[...a.path,c]}function Of(c,a,i=Uf){oy(c,a),a.valueAccessor.writeValue(c.value),(c.disabled||i==="always")&&a.valueAccessor.setDisabledState?.(c.disabled),GE(c,a),ZE(c,a),HE(c,a),$E(c,a)}function Jw(c,a,i=!0){let l=()=>{};a.valueAccessor&&(a.valueAccessor.registerOnChange(l),a.valueAccessor.registerOnTouched(l)),Lf(c,a),c&&(a._invokeOnDestroyCallbacks(),c._registerOnCollectionChange(()=>{}))}function Ff(c,a){c.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(a)})}function $E(c,a){if(a.valueAccessor.setDisabledState){let i=l=>{a.valueAccessor.setDisabledState(l)};c.registerOnDisabledChange(i),a._registerOnDestroy(()=>{c._unregisterOnDisabledChange(i)})}}function oy(c,a){let i=f1(c);a.validator!==null?c.setValidators(Yw(i,a.validator)):typeof i=="function"&&c.setValidators([i]);let l=g1(c);a.asyncValidator!==null?c.setAsyncValidators(Yw(l,a.asyncValidator)):typeof l=="function"&&c.setAsyncValidators([l]);let h=()=>c.updateValueAndValidity();Ff(a._rawValidators,h),Ff(a._rawAsyncValidators,h)}function Lf(c,a){let i=!1;if(c!==null){if(a.validator!==null){let h=f1(c);if(Array.isArray(h)&&h.length>0){let s=h.filter(P=>P!==a.validator);s.length!==h.length&&(i=!0,c.setValidators(s))}}if(a.asyncValidator!==null){let h=g1(c);if(Array.isArray(h)&&h.length>0){let s=h.filter(P=>P!==a.asyncValidator);s.length!==h.length&&(i=!0,c.setAsyncValidators(s))}}}let l=()=>{};return Ff(a._rawValidators,l),Ff(a._rawAsyncValidators,l),i}function GE(c,a){a.valueAccessor.registerOnChange(i=>{c._pendingValue=i,c._pendingChange=!0,c._pendingDirty=!0,c.updateOn==="change"&&b1(c,a)})}function HE(c,a){a.valueAccessor.registerOnTouched(()=>{c._pendingTouched=!0,c.updateOn==="blur"&&c._pendingChange&&b1(c,a),c.updateOn!=="submit"&&c.markAsTouched()})}function b1(c,a){c._pendingDirty&&c.markAsDirty(),c.setValue(c._pendingValue,{emitModelToViewChange:!1}),a.viewToModelUpdate(c._pendingValue),c._pendingChange=!1}function ZE(c,a){let i=(l,h)=>{a.valueAccessor.writeValue(l),h&&a.viewToModelUpdate(l)};c.registerOnChange(i),a._registerOnDestroy(()=>{c._unregisterOnChange(i)})}function x1(c,a){c==null,oy(c,a)}function WE(c,a){return Lf(c,a)}function w1(c,a){if(!c.hasOwnProperty("model"))return!1;let i=c.model;return i.isFirstChange()?!0:!Object.is(a,i.currentValue)}function qE(c){return Object.getPrototypeOf(c.constructor)===zf}function C1(c,a){c._syncPendingControls(),a.forEach(i=>{let l=i.control;l.updateOn==="submit"&&l._pendingChange&&(i.viewToModelUpdate(l._pendingValue),l._pendingChange=!1)})}function M1(c,a){if(!a)return null;Array.isArray(a);let i,l,h;return a.forEach(s=>{s.constructor===la?i=s:qE(s)?l=s:h=s}),h||l||i||null}function XE(c,a){let i=c.indexOf(a);i>-1&&c.splice(i,1)}var YE={provide:el,useExisting:qo(()=>sy)},Ap=Promise.resolve(),sy=(()=>{class c extends el{callSetDisabledState;get submitted(){return Es(this.submittedReactive)}_submitted=Ya(()=>this.submittedReactive());submittedReactive=Yl(!1);_directives=new Set;form;ngSubmit=new oi;options;constructor(i,l,h){super(),this.callSetDisabledState=h,this.form=new ku({},ty(i),iy(l))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(i){Ap.then(()=>{let l=this._findContainer(i.path);i.control=l.registerControl(i.name,i.control),Of(i.control,i,this.callSetDisabledState),i.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(i)})}getControl(i){return this.form.get(i.path)}removeControl(i){Ap.then(()=>{let l=this._findContainer(i.path);l&&l.removeControl(i.name),this._directives.delete(i)})}addFormGroup(i){Ap.then(()=>{let l=this._findContainer(i.path),h=new ku({});x1(h,i),l.registerControl(i.name,h),h.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(i){Ap.then(()=>{let l=this._findContainer(i.path);l&&l.removeControl(i.name)})}getFormGroup(i){return this.form.get(i.path)}updateModel(i,l){Ap.then(()=>{this.form.get(i.path).setValue(l)})}setValue(i){this.control.setValue(i)}onSubmit(i){return this.submittedReactive.set(!0),C1(this.form,this._directives),this.ngSubmit.emit(i),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(i){return i.pop(),i.length?this.form.get(i):this.form}static \u0275fac=function(l){return new(l||c)(It(Bf,10),It(Nf,10),It(Fp,8))};static \u0275dir=Ht({type:c,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(l,h){l&1&&tt("submit",function(P){return h.onSubmit(P)})("reset",function(){return h.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Gn([YE]),Wr]})}return c})();function e1(c,a){let i=c.indexOf(a);i>-1&&c.splice(i,1)}function t1(c){return typeof c=="object"&&c!==null&&Object.keys(c).length===2&&"value"in c&&"disabled"in c}var Op=class extends Iu{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(a=null,i,l){super(ny(i),ry(l,i)),this._applyFormState(a),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),jf(i)&&(i.nonNullable||i.initialValueIsDefault)&&(t1(a)?this.defaultValue=a.value:this.defaultValue=a)}setValue(a,i={}){this.value=this._pendingValue=a,this._onChange.length&&i.emitModelToViewChange!==!1&&this._onChange.forEach(l=>l(this.value,i.emitViewToModelChange!==!1)),this.updateValueAndValidity(i)}patchValue(a,i={}){this.setValue(a,i)}reset(a=this.defaultValue,i={}){this._applyFormState(a),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(a){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(a){this._onChange.push(a)}_unregisterOnChange(a){e1(this._onChange,a)}registerOnDisabledChange(a){this._onDisabledChange.push(a)}_unregisterOnDisabledChange(a){e1(this._onDisabledChange,a)}_forEachChild(a){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(a){t1(a)?(this.value=this._pendingValue=a.value,a.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=a}};var KE=c=>c instanceof Op;var QE={provide:tl,useExisting:qo(()=>il)},i1=Promise.resolve(),il=(()=>{class c extends tl{_changeDetectorRef;callSetDisabledState;control=new Op;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new oi;constructor(i,l,h,s,P,q){super(),this._changeDetectorRef=P,this.callSetDisabledState=q,this._parent=i,this._setValidators(l),this._setAsyncValidators(h),this.valueAccessor=M1(this,s)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){let l=i.name.previousValue;this.formDirective.removeControl({name:l,path:this._getPath(l)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),w1(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Of(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(i){i1.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){let l=i.isDisabled.currentValue,h=l!==0&&yi(l);i1.then(()=>{h&&!this.control.disabled?this.control.disable():!h&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?v1(i,this._parent):[i]}static \u0275fac=function(l){return new(l||c)(It(el,9),It(Bf,10),It(Nf,10),It(oc,10),It(Mr,8),It(Fp,8))};static \u0275dir=Ht({type:c,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Gn([QE]),Wr,ao]})}return c})(),$f=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return c})();var S1=new ut("");var JE={provide:el,useExisting:qo(()=>sd)},sd=(()=>{class c extends el{callSetDisabledState;get submitted(){return Es(this._submittedReactive)}set submitted(i){this._submittedReactive.set(i)}_submitted=Ya(()=>this._submittedReactive());_submittedReactive=Yl(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new oi;constructor(i,l,h){super(),this.callSetDisabledState=h,this._setValidators(i),this._setAsyncValidators(l)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Lf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){let l=this.form.get(i.path);return Of(l,i,this.callSetDisabledState),l.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),l}getControl(i){return this.form.get(i.path)}removeControl(i){Jw(i.control||null,i,!1),XE(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,l){this.form.get(i.path).setValue(l)}onSubmit(i){return this._submittedReactive.set(!0),C1(this.form,this.directives),this.ngSubmit.emit(i),this.form._events.next(new Y0(this.control)),i?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this._submittedReactive.set(!1),this.form._events.next(new K0(this.form))}_updateDomValue(){this.directives.forEach(i=>{let l=i.control,h=this.form.get(i.path);l!==h&&(Jw(l||null,i),KE(h)&&(Of(h,i,this.callSetDisabledState),i.control=h))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){let l=this.form.get(i.path);x1(l,i),l.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){let l=this.form.get(i.path);l&&WE(l,i)&&l.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){oy(this.form,this),this._oldForm&&Lf(this._oldForm,this)}_checkFormPresent(){this.form}static \u0275fac=function(l){return new(l||c)(It(Bf,10),It(Nf,10),It(Fp,8))};static \u0275dir=Ht({type:c,selectors:[["","formGroup",""]],hostBindings:function(l,h){l&1&&tt("submit",function(P){return h.onSubmit(P)})("reset",function(){return h.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Gn([JE]),Wr,ao]})}return c})();var eT={provide:tl,useExisting:qo(()=>Lp)},Lp=(()=>{class c extends tl{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(i){}model;update=new oi;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(i,l,h,s,P){super(),this._ngModelWarningConfig=P,this._parent=i,this._setValidators(l),this._setAsyncValidators(h),this.valueAccessor=M1(this,s)}ngOnChanges(i){this._added||this._setUpControl(),w1(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return v1(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(l){return new(l||c)(It(el,13),It(Bf,10),It(Nf,10),It(oc,10),It(S1,8))};static \u0275dir=Ht({type:c,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Gn([eT]),Wr,ao]})}return c})(),tT={provide:oc,useExisting:qo(()=>sc),multi:!0};function P1(c,a){return c==null?`${a}`:(a&&typeof a=="object"&&(a="Object"),`${c}: ${a}`.slice(0,50))}function iT(c){return c.split(":")[0]}var sc=(()=>{class c extends zf{value;_optionMap=new Map;_idCounter=0;set compareWith(i){this._compareWith=i}_compareWith=Object.is;writeValue(i){this.value=i;let l=this._getOptionId(i),h=P1(l,i);this.setProperty("value",h)}registerOnChange(i){this.onChange=l=>{this.value=this._getOptionValue(l),i(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(i){for(let l of this._optionMap.keys())if(this._compareWith(this._optionMap.get(l),i))return l;return null}_getOptionValue(i){let l=iT(i);return this._optionMap.has(l)?this._optionMap.get(l):i}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275dir=Ht({type:c,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(l,h){l&1&&tt("change",function(P){return h.onChange(P.target.value)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Gn([tT]),Wr]})}return c})(),Au=(()=>{class c{_element;_renderer;_select;id;constructor(i,l,h){this._element=i,this._renderer=l,this._select=h,this._select&&(this.id=this._select._registerOption())}set ngValue(i){this._select!=null&&(this._select._optionMap.set(this.id,i),this._setElementValue(P1(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._setElementValue(i),this._select&&this._select.writeValue(this._select.value)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(l){return new(l||c)(It(Si),It(du),It(sc,9))};static \u0275dir=Ht({type:c,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return c})(),nT={provide:oc,useExisting:qo(()=>E1),multi:!0};function n1(c,a){return c==null?`${a}`:(typeof a=="string"&&(a=`'${a}'`),a&&typeof a=="object"&&(a="Object"),`${c}: ${a}`.slice(0,50))}function rT(c){return c.split(":")[0]}var E1=(()=>{class c extends zf{value;_optionMap=new Map;_idCounter=0;set compareWith(i){this._compareWith=i}_compareWith=Object.is;writeValue(i){this.value=i;let l;if(Array.isArray(i)){let h=i.map(s=>this._getOptionId(s));l=(s,P)=>{s._setSelected(h.indexOf(P.toString())>-1)}}else l=(h,s)=>{h._setSelected(!1)};this._optionMap.forEach(l)}registerOnChange(i){this.onChange=l=>{let h=[],s=l.selectedOptions;if(s!==void 0){let P=s;for(let q=0;q<P.length;q++){let X=P[q],be=this._getOptionValue(X.value);h.push(be)}}else{let P=l.options;for(let q=0;q<P.length;q++){let X=P[q];if(X.selected){let be=this._getOptionValue(X.value);h.push(be)}}}this.value=h,i(h)}}_registerOption(i){let l=(this._idCounter++).toString();return this._optionMap.set(l,i),l}_getOptionId(i){for(let l of this._optionMap.keys())if(this._compareWith(this._optionMap.get(l)._value,i))return l;return null}_getOptionValue(i){let l=rT(i);return this._optionMap.has(l)?this._optionMap.get(l)._value:i}static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275dir=Ht({type:c,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(l,h){l&1&&tt("change",function(P){return h.onChange(P.target)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Gn([nT]),Wr]})}return c})(),Du=(()=>{class c{_element;_renderer;_select;id;_value;constructor(i,l,h){this._element=i,this._renderer=l,this._select=h,this._select&&(this.id=this._select._registerOption(this))}set ngValue(i){this._select!=null&&(this._value=i,this._setElementValue(n1(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._select?(this._value=i,this._setElementValue(n1(this.id,i)),this._select.writeValue(this._select.value)):this._setElementValue(i)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}_setSelected(i){this._renderer.setProperty(this._element.nativeElement,"selected",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(l){return new(l||c)(It(Si),It(du),It(E1,9))};static \u0275dir=Ht({type:c,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return c})();var T1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({})}return c})(),J0=class extends Iu{constructor(a,i,l){super(ny(i),ry(l,i)),this.controls=a,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(a){return this.controls[this._adjustIndex(a)]}push(a,i={}){this.controls.push(a),this._registerControl(a),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(a,i,l={}){this.controls.splice(a,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:l.emitEvent})}removeAt(a,i={}){let l=this._adjustIndex(a);l<0&&(l=0),this.controls[l]&&this.controls[l]._registerOnCollectionChange(()=>{}),this.controls.splice(l,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(a,i,l={}){let h=this._adjustIndex(a);h<0&&(h=0),this.controls[h]&&this.controls[h]._registerOnCollectionChange(()=>{}),this.controls.splice(h,1),i&&(this.controls.splice(h,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(a,i={}){y1(this,!1,a),a.forEach((l,h)=>{_1(this,!1,h),this.at(h).setValue(l,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(a,i={}){a!=null&&(a.forEach((l,h)=>{this.at(h)&&this.at(h).patchValue(l,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(a=[],i={}){this._forEachChild((l,h)=>{l.reset(a[h],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i,this),this._updateTouched(i,this),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(a=>a.getRawValue())}clear(a={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:a.emitEvent}))}_adjustIndex(a){return a<0?a+this.length:a}_syncPendingControls(){let a=this.controls.reduce((i,l)=>l._syncPendingControls()?!0:i,!1);return a&&this.updateValueAndValidity({onlySelf:!0}),a}_forEachChild(a){this.controls.forEach((i,l)=>{a(i,l)})}_updateValue(){this.value=this.controls.filter(a=>a.enabled||this.disabled).map(a=>a.value)}_anyControls(a){return this.controls.some(i=>i.enabled&&a(i))}_setUpControls(){this._forEachChild(a=>this._registerControl(a))}_allControlsDisabled(){for(let a of this.controls)if(a.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(a){a.setParent(this),a._registerOnCollectionChange(this._onCollectionChange)}_find(a){return this.at(a)??null}};function r1(c){return!!c&&(c.asyncValidators!==void 0||c.validators!==void 0||c.updateOn!==void 0)}var Gf=(()=>{class c{useNonNullable=!1;get nonNullable(){let i=new c;return i.useNonNullable=!0,i}group(i,l=null){let h=this._reduceControls(i),s={};return r1(l)?s=l:l!==null&&(s.validators=l.validator,s.asyncValidators=l.asyncValidator),new ku(h,s)}record(i,l=null){let h=this._reduceControls(i);return new Q0(h,l)}control(i,l,h){let s={};return this.useNonNullable?(r1(l)?s=l:(s.validators=l,s.asyncValidators=h),new Op(i,di(Qe({},s),{nonNullable:!0}))):new Op(i,l,h)}array(i,l,h){let s=i.map(P=>this._createControl(P));return new J0(s,l,h)}_reduceControls(i){let l={};return Object.keys(i).forEach(h=>{l[h]=this._createControl(i[h])}),l}_createControl(i){if(i instanceof Op)return i;if(i instanceof Iu)return i;if(Array.isArray(i)){let l=i[0],h=i.length>1?i[1]:null,s=i.length>2?i[2]:null;return this.control(l,h,s)}else return this.control(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var ac=(()=>{class c{static withConfig(i){return{ngModule:c,providers:[{provide:Fp,useValue:i.callSetDisabledState??Uf}]}}static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[T1]})}return c})(),Hf=(()=>{class c{static withConfig(i){return{ngModule:c,providers:[{provide:S1,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:Fp,useValue:i.callSetDisabledState??Uf}]}}static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[T1]})}return c})();var Np=ou(Bp());var Zf=class c{constructor(a,i){this.http=a;this.router=i}apiUrl="https://www.medellin.gov.co/flask-fiware/api/keycloak/login";login(a){return this.http.post(this.apiUrl,a).pipe(tn(i=>{localStorage.setItem("access_tokenadmin",i.access_token),this.router.navigate(["/inicio"])}))}logout(){localStorage.removeItem("access_tokenadmin"),this.router.navigate(["/login"])}isLoggedIn(){return!!localStorage.getItem("access_tokenadmin")}static \u0275fac=function(i){return new(i||c)(Vt(Ao),Vt(uo))};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})};function sT(c,a){if(c&1&&(O(0,"p",9),Y(1),F()),c&2){let i=ze();re(),St(i.errorMsg)}}var Vp=class c{constructor(a,i){this.fb=a;this.auth=i;this.loginForm=this.fb.group({username:["",Oo.required],password:["",Oo.required]})}loginForm;errorMsg="";logout(){localStorage.getItem("access_token")?Np.default.fire({icon:"error",title:"Error",text:"No se pudo eliminar el token",confirmButtonText:"OK"}):Np.default.fire({icon:"success",title:"Token eliminado",text:"El token de acceso ha sido removido del almacenamiento local.",confirmButtonText:"OK"})}onSubmit(){if(this.loginForm.invalid){Np.default.fire({icon:"warning",title:"Formulario incompleto",text:"Por favor diligencie el formulario de inicio de sesi\xF3n",confirmButtonColor:"#334155"});return}this.auth.login(this.loginForm.value).subscribe({next:()=>{},error:a=>{console.error(a),this.errorMsg="Usuario o contrase\xF1a incorrectos",Np.default.fire({icon:"error",title:"Error de autenticaci\xF3n",text:this.errorMsg,confirmButtonColor:"#334155"})}})}static \u0275fac=function(i){return new(i||c)(It(Gf),It(Zf))};static \u0275cmp=rt({type:c,selectors:[["app-login"]],decls:14,vars:2,consts:[[1,"login-wrapper"],[1,"login-card"],[1,"logo"],["src","https://www.fiware.org/custom/brand-guide/img/logo/fiware/primary/jpg/logo-fiware.jpg?","alt","Logo Alcald\xEDa de Medell\xEDn",1,"login-logo"],[3,"ngSubmit","formGroup"],["type","text","formControlName","username","placeholder","Usuario"],["type","password","formControlName","password","placeholder","Contrase\xF1a"],["type","submit"],["class","error",4,"ngIf"],[1,"error"]],template:function(i,l){i&1&&(O(0,"div",0)(1,"div",1)(2,"h1",2),Y(3,"Medell\xEDn "),O(4,"span"),Y(5,"Inteligente"),F()(),O(6,"div",2),Te(7,"img",3),F(),O(8,"form",4),tt("ngSubmit",function(){return l.onSubmit()}),Te(9,"input",5)(10,"input",6),O(11,"button",7),Y(12,"Iniciar Sesi\xF3n"),F()(),Xe(13,sT,2,1,"p",8),F()()),i&2&&(re(8),Oe("formGroup",l.loginForm),re(5),Oe("ngIf",l.errorMsg))},dependencies:[nr,co,Hf,$f,la,ca,Vf,sd,Lp,sa,ic],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;height:100vh;width:100%;background:linear-gradient(135deg,#ffffffe6,#f5f5f5e6);display:flex;justify-content:center;align-items:center;perspective:1000px}.login-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:90%;max-width:400px;padding:2rem}.login-card[_ngcontent-%COMP%]{background:#ffffffbf;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border-radius:20px;padding:2rem;width:100%;box-shadow:0 15px 30px #0000001a,inset 0 0 60px #ffffff4d;transform-style:preserve-3d;transition:transform .6s cubic-bezier(.4,0,.2,1);border:1.5px solid rgba(200,200,200,.4);animation:_ngcontent-%COMP%_fadeInGlass 1.2s ease forwards}.login-card[_ngcontent-%COMP%]:hover{transform:rotateY(8deg) rotateX(8deg) translateZ(10px);box-shadow:0 25px 40px #00000026,inset 0 0 70px #fff6}.logo[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.login-logo[_ngcontent-%COMP%]{max-width:150px;height:auto;filter:drop-shadow(0 0 6px rgba(0,0,0,.12))}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.8rem;border:none;border-radius:12px;background:#ffffffd9;color:#334155;outline:none;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:inset 0 0 8px #fffc,0 4px 10px #0000000d;transition:background .3s ease,box-shadow .3s ease,color .3s ease}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#64748b}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:#fff;color:#1e293b;box-shadow:0 0 12px 3px #38bdf880,inset 0 0 15px #ffffffe6;transform:translateZ(5px)}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem;border-radius:12px;background:#fff3;border:2px solid rgba(128,128,128,.6);color:#334155;font-weight:700;cursor:pointer;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 6px 10px #0000001f,inset 0 0 15px #ffffff80;transition:transform .3s ease,box-shadow .3s ease,background .3s ease;transform-style:preserve-3d}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#fff6;border-color:#646464e6;box-shadow:0 10px 18px #00000040,inset 0 0 20px #ffffffb3;transform:scale(1.08) translateZ(8px)}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{transform:scale(.97) translateZ(0);box-shadow:0 4px 6px #00000026,inset 0 0 12px #fff6}.error[_ngcontent-%COMP%]{color:#ef4444;text-align:center;margin-top:1rem;animation:_ngcontent-%COMP%_pulseRed 2s infinite}@keyframes _ngcontent-%COMP%_fadeInGlass{0%{opacity:0;transform:translateY(40px) scale(.85) rotateX(10deg)}to{opacity:1;transform:translateY(0) scale(1) rotateX(0)}}@keyframes _ngcontent-%COMP%_glow{0%{text-shadow:0 0 6px #38bdf8,0 0 12px #38bdf8}to{text-shadow:0 0 14px #a78bfa,0 0 28px #a78bfa}}@keyframes _ngcontent-%COMP%_pulseRed{0%,to{opacity:1}50%{opacity:.6}}@media (max-width: 600px){.login-card[_ngcontent-%COMP%]{padding:1.5rem;border-radius:16px}.logo[_ngcontent-%COMP%]{font-size:1.5rem}form[_ngcontent-%COMP%]{gap:.8rem}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.9rem}}']})};var cy;try{cy=typeof Intl<"u"&&Intl.v8BreakIterator}catch{cy=!1}var Sr=(()=>{class c{_platformId=ge(Ps);isBrowser=this._platformId?Xh(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||cy)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var jp;function aT(){if(jp==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>jp=!0}))}finally{jp=jp||!1}return jp}function Ru(c){return aT()?c:!!c.capture}var ad;function dy(){if(ad==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return ad=!1,ad;if("scrollBehavior"in document.documentElement.style)ad=!0;else{let c=Element.prototype.scrollTo;c?ad=!/\{\s*\[native code\]\s*\}/.test(c.toString()):ad=!1}}return ad}var ly;function lT(){if(ly==null){let c=typeof document<"u"?document.head:null;ly=!!(c&&(c.createShadowRoot||c.attachShadow))}return ly}function I1(c){if(lT()){let a=c.getRootNode?c.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&a instanceof ShadowRoot)return a}return null}function es(c){return c.composedPath?c.composedPath()[0]:c.target}function uy(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var Wf=new WeakMap,nl=(()=>{class c{_appRef;_injector=ge(Or);_environmentInjector=ge(Ss);load(i){let l=this._appRef=this._appRef||this._injector.get(Kl),h=Wf.get(l);h||(h={loaders:new Set,refs:[]},Wf.set(l,h),l.onDestroy(()=>{Wf.get(l)?.refs.forEach(s=>s.destroy()),Wf.delete(l)})),h.loaders.has(i)||(h.loaders.add(i),h.refs.push(qm(i,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),k1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(l,h){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}"],encapsulation:2,changeDetection:0})}return c})();function rl(c,...a){return a.length?a.some(i=>c[i]):c.altKey||c.shiftKey||c.ctrlKey||c.metaKey}function A1(c){return c!=null&&`${c}`!="false"}function Ou(c){return Array.isArray(c)?c:[c]}function On(c){return c==null?"":typeof c=="string"?c:`${c}px`}function ol(c){return c instanceof Si?c.nativeElement:c}var cT=(()=>{class c{create(i){return typeof MutationObserver>"u"?null:new MutationObserver(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var D1=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({providers:[cT]})}return c})();var R1=new Set,ld,dT=(()=>{class c{_platform=ge(Sr);_nonce=ge(Uh,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):hT}matchMedia(i){return(this._platform.WEBKIT||this._platform.BLINK)&&uT(i,this._nonce),this._matchMedia(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function uT(c,a){if(!R1.has(c))try{ld||(ld=document.createElement("style"),a&&ld.setAttribute("nonce",a),ld.setAttribute("type","text/css"),document.head.appendChild(ld)),ld.sheet&&(ld.sheet.insertRule(`@media ${c} {body{ }}`,0),R1.add(c))}catch(i){console.error(i)}}function hT(c){return{matches:c==="all"||c==="",media:c,addListener:()=>{},removeListener:()=>{}}}var F1=(()=>{class c{_mediaMatcher=ge(dT);_zone=ge(_i);_queries=new Map;_destroySubject=new qt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(i){return O1(Ou(i)).some(h=>this._registerQuery(h).mql.matches)}observe(i){let h=O1(Ou(i)).map(P=>this._registerQuery(P).observable),s=su(h);return s=Om(s.pipe(To(1)),s.pipe(zm(1),Lm(0))),s.pipe(Ft(P=>{let q={matches:!1,breakpoints:{}};return P.forEach(({matches:X,query:be})=>{q.matches=q.matches||X,q.breakpoints[be]=X}),q}))}_registerQuery(i){if(this._queries.has(i))return this._queries.get(i);let l=this._mediaMatcher.matchMedia(i),s={observable:new qa(P=>{let q=X=>this._zone.run(()=>P.next(X));return l.addListener(q),()=>{l.removeListener(q)}}).pipe(ra(l),Ft(({matches:P})=>({query:i,matches:P})),Rn(this._destroySubject)),mql:l};return this._queries.set(i,s),s}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function O1(c){return c.map(a=>a.split(",")).reduce((a,i)=>a.concat(i)).map(a=>a.trim())}var B1=" ";function N1(c,a,i){let l=V1(c,a);i=i.trim(),!l.some(h=>h.trim()===i)&&(l.push(i),c.setAttribute(a,l.join(B1)))}function _y(c,a,i){let l=V1(c,a);i=i.trim();let h=l.filter(s=>s!==i);h.length?c.setAttribute(a,h.join(B1)):c.removeAttribute(a)}function V1(c,a){return c.getAttribute(a)?.match(/\S+/g)??[]}var PT=200,my=class{_letterKeyStream=new qt;_items=[];_selectedItemIndex=-1;_pressedLetters=[];_skipPredicateFn;_selectedItem=new qt;selectedItem=this._selectedItem;constructor(a,i){let l=typeof i?.debounceInterval=="number"?i.debounceInterval:PT;i?.skipPredicate&&(this._skipPredicateFn=i.skipPredicate),this.setItems(a),this._setupKeyHandler(l)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(a){this._selectedItemIndex=a}setItems(a){this._items=a}handleKey(a){let i=a.keyCode;a.key&&a.key.length===1?this._letterKeyStream.next(a.key.toLocaleUpperCase()):(i>=65&&i<=90||i>=48&&i<=57)&&this._letterKeyStream.next(String.fromCharCode(i))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(a){this._letterKeyStream.pipe(tn(i=>this._pressedLetters.push(i)),Lm(a),bn(()=>this._pressedLetters.length>0),Ft(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(i=>{for(let l=1;l<this._items.length+1;l++){let h=(this._selectedItemIndex+l)%this._items.length,s=this._items[h];if(!this._skipPredicateFn?.(s)&&s.getLabel?.().toLocaleUpperCase().trim().indexOf(i)===0){this._selectedItem.next(s);break}}this._pressedLetters=[]})}},fy=class{_items;_activeItemIndex=-1;_activeItem=Yl(null);_wrap=!1;_typeaheadSubscription=Rr.EMPTY;_itemChangesSubscription;_vertical=!0;_horizontal;_allowedModifierKeys=[];_homeAndEnd=!1;_pageUpAndDown={enabled:!1,delta:10};_effectRef;_typeahead;_skipPredicateFn=a=>a.disabled;constructor(a,i){this._items=a,a instanceof G_?this._itemChangesSubscription=a.changes.subscribe(l=>this._itemsChanged(l.toArray())):Hh(a)&&(this._effectRef=xx(()=>this._itemsChanged(a()),{injector:i}))}tabOut=new qt;change=new qt;skipPredicate(a){return this._skipPredicateFn=a,this}withWrap(a=!0){return this._wrap=a,this}withVerticalOrientation(a=!0){return this._vertical=a,this}withHorizontalOrientation(a){return this._horizontal=a,this}withAllowedModifierKeys(a){return this._allowedModifierKeys=a,this}withTypeAhead(a=200){this._typeaheadSubscription.unsubscribe();let i=this._getItemsArray();return this._typeahead=new my(i,{debounceInterval:typeof a=="number"?a:void 0,skipPredicate:l=>this._skipPredicateFn(l)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(l=>{this.setActiveItem(l)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(a=!0){return this._homeAndEnd=a,this}withPageUpDown(a=!0,i=10){return this._pageUpAndDown={enabled:a,delta:i},this}setActiveItem(a){let i=this._activeItem();this.updateActiveItem(a),this._activeItem()!==i&&this.change.next(this._activeItemIndex)}onKeydown(a){let i=a.keyCode,h=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!a[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(i){case 9:this.tabOut.next();return;case 40:if(this._vertical&&h){this.setNextItemActive();break}else return;case 38:if(this._vertical&&h){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&h){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&h){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&h){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&h){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&h){let s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&h){let s=this._activeItemIndex+this._pageUpAndDown.delta,P=this._getItemsArray().length;this._setActiveItemByIndex(s<P?s:P-1,-1);break}else return;default:(h||rl(a,"shiftKey"))&&this._typeahead?.handleKey(a);return}this._typeahead?.reset(),a.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem()}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(a){let i=this._getItemsArray(),l=typeof a=="number"?a:i.indexOf(a),h=i[l];this._activeItem.set(h??null),this._activeItemIndex=l,this._typeahead?.setCurrentSelectedItemIndex(l)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(a){this._wrap?this._setActiveInWrapMode(a):this._setActiveInDefaultMode(a)}_setActiveInWrapMode(a){let i=this._getItemsArray();for(let l=1;l<=i.length;l++){let h=(this._activeItemIndex+a*l+i.length)%i.length,s=i[h];if(!this._skipPredicateFn(s)){this.setActiveItem(h);return}}}_setActiveInDefaultMode(a){this._setActiveItemByIndex(this._activeItemIndex+a,a)}_setActiveItemByIndex(a,i){let l=this._getItemsArray();if(l[a]){for(;this._skipPredicateFn(l[a]);)if(a+=i,!l[a])return;this.setActiveItem(a)}}_getItemsArray(){return Hh(this._items)?this._items():this._items instanceof G_?this._items.toArray():this._items}_itemsChanged(a){this._typeahead?.setItems(a);let i=this._activeItem();if(i){let l=a.indexOf(i);l>-1&&l!==this._activeItemIndex&&(this._activeItemIndex=l,this._typeahead?.setCurrentSelectedItemIndex(l))}}},Yf=class extends fy{setActiveItem(a){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(a),this.activeItem&&this.activeItem.setActiveStyles()}};function yy(c){return c.buttons===0||c.detail===0}function vy(c){let a=c.touches&&c.touches[0]||c.changedTouches&&c.changedTouches[0];return!!a&&a.identifier===-1&&(a.radiusX==null||a.radiusX===1)&&(a.radiusY==null||a.radiusY===1)}var ET=new ut("cdk-input-modality-detector-options"),TT={ignoreKeys:[18,17,224,91,16]},j1=650,Fu=Ru({passive:!0,capture:!0}),IT=(()=>{class c{_platform=ge(Sr);modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new so(null);_options;_lastTouchMs=0;_onKeydown=i=>{this._options?.ignoreKeys?.some(l=>l===i.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=es(i))};_onMousedown=i=>{Date.now()-this._lastTouchMs<j1||(this._modality.next(yy(i)?"keyboard":"mouse"),this._mostRecentTarget=es(i))};_onTouchstart=i=>{if(vy(i)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=es(i)};constructor(){let i=ge(_i),l=ge(vi),h=ge(ET,{optional:!0});this._options=Qe(Qe({},TT),h),this.modalityDetected=this._modality.pipe(zm(1)),this.modalityChanged=this.modalityDetected.pipe(zh()),this._platform.isBrowser&&i.runOutsideAngular(()=>{l.addEventListener("keydown",this._onKeydown,Fu),l.addEventListener("mousedown",this._onMousedown,Fu),l.addEventListener("touchstart",this._onTouchstart,Fu)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Fu),document.removeEventListener("mousedown",this._onMousedown,Fu),document.removeEventListener("touchstart",this._onTouchstart,Fu))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),kT=new ut("liveAnnouncerElement",{providedIn:"root",factory:AT});function AT(){return null}var DT=new ut("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),RT=0,U1=(()=>{class c{_ngZone=ge(_i);_defaultOptions=ge(DT,{optional:!0});_liveElement;_document=ge(vi);_previousTimeout;_currentPromise;_currentResolve;constructor(){let i=ge(kT,{optional:!0});this._liveElement=i||this._createLiveElement()}announce(i,...l){let h=this._defaultOptions,s,P;return l.length===1&&typeof l[0]=="number"?P=l[0]:[s,P]=l,this.clear(),clearTimeout(this._previousTimeout),s||(s=h&&h.politeness?h.politeness:"polite"),P==null&&h&&(P=h.duration),this._liveElement.setAttribute("aria-live",s),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(q=>this._currentResolve=q)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=i,typeof P=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),P)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let i="cdk-live-announcer-element",l=this._document.getElementsByClassName(i),h=this._document.createElement("div");for(let s=0;s<l.length;s++)l[s].remove();return h.classList.add(i),h.classList.add("cdk-visually-hidden"),h.setAttribute("aria-atomic","true"),h.setAttribute("aria-live","polite"),h.id=`cdk-live-announcer-${RT++}`,this._document.body.appendChild(h),h}_exposeAnnouncerToModals(i){let l=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let h=0;h<l.length;h++){let s=l[h],P=s.getAttribute("aria-owns");P?P.indexOf(i)===-1&&s.setAttribute("aria-owns",P+" "+i):s.setAttribute("aria-owns",i)}}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var Xf=function(c){return c[c.IMMEDIATE=0]="IMMEDIATE",c[c.EVENTUAL=1]="EVENTUAL",c}(Xf||{}),OT=new ut("cdk-focus-monitor-default-options"),qf=Ru({passive:!0,capture:!0}),$1=(()=>{class c{_ngZone=ge(_i);_platform=ge(Sr);_inputModalityDetector=ge(IT);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=ge(vi,{optional:!0});_stopInputModalityDetector=new qt;constructor(){let i=ge(OT,{optional:!0});this._detectionMode=i?.detectionMode||Xf.IMMEDIATE}_rootNodeFocusAndBlurListener=i=>{let l=es(i);for(let h=l;h;h=h.parentElement)i.type==="focus"?this._onFocus(i,h):this._onBlur(i,h)};monitor(i,l=!1){let h=ol(i);if(!this._platform.isBrowser||h.nodeType!==1)return bt();let s=I1(h)||this._getDocument(),P=this._elementInfo.get(h);if(P)return l&&(P.checkChildren=!0),P.subject;let q={checkChildren:l,subject:new qt,rootNode:s};return this._elementInfo.set(h,q),this._registerGlobalListeners(q),q.subject}stopMonitoring(i){let l=ol(i),h=this._elementInfo.get(l);h&&(h.subject.complete(),this._setClasses(l),this._elementInfo.delete(l),this._removeGlobalListeners(h))}focusVia(i,l,h){let s=ol(i),P=this._getDocument().activeElement;s===P?this._getClosestElementsInfo(s).forEach(([q,X])=>this._originChanged(q,l,X)):(this._setOrigin(l),typeof s.focus=="function"&&s.focus(h))}ngOnDestroy(){this._elementInfo.forEach((i,l)=>this.stopMonitoring(l))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(i){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(i)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:i&&this._isLastInteractionFromInputLabel(i)?"mouse":"program"}_shouldBeAttributedToTouch(i){return this._detectionMode===Xf.EVENTUAL||!!i?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(i,l){i.classList.toggle("cdk-focused",!!l),i.classList.toggle("cdk-touch-focused",l==="touch"),i.classList.toggle("cdk-keyboard-focused",l==="keyboard"),i.classList.toggle("cdk-mouse-focused",l==="mouse"),i.classList.toggle("cdk-program-focused",l==="program")}_setOrigin(i,l=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=i,this._originFromTouchInteraction=i==="touch"&&l,this._detectionMode===Xf.IMMEDIATE){clearTimeout(this._originTimeoutId);let h=this._originFromTouchInteraction?j1:1;this._originTimeoutId=setTimeout(()=>this._origin=null,h)}})}_onFocus(i,l){let h=this._elementInfo.get(l),s=es(i);!h||!h.checkChildren&&l!==s||this._originChanged(l,this._getFocusOrigin(s),h)}_onBlur(i,l){let h=this._elementInfo.get(l);!h||h.checkChildren&&i.relatedTarget instanceof Node&&l.contains(i.relatedTarget)||(this._setClasses(l),this._emitOrigin(h,null))}_emitOrigin(i,l){i.subject.observers.length&&this._ngZone.run(()=>i.subject.next(l))}_registerGlobalListeners(i){if(!this._platform.isBrowser)return;let l=i.rootNode,h=this._rootNodeFocusListenerCount.get(l)||0;h||this._ngZone.runOutsideAngular(()=>{l.addEventListener("focus",this._rootNodeFocusAndBlurListener,qf),l.addEventListener("blur",this._rootNodeFocusAndBlurListener,qf)}),this._rootNodeFocusListenerCount.set(l,h+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Rn(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(i){let l=i.rootNode;if(this._rootNodeFocusListenerCount.has(l)){let h=this._rootNodeFocusListenerCount.get(l);h>1?this._rootNodeFocusListenerCount.set(l,h-1):(l.removeEventListener("focus",this._rootNodeFocusAndBlurListener,qf),l.removeEventListener("blur",this._rootNodeFocusAndBlurListener,qf),this._rootNodeFocusListenerCount.delete(l))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(i,l,h){this._setClasses(i,l),this._emitOrigin(h,l),this._lastFocusOrigin=l}_getClosestElementsInfo(i){let l=[];return this._elementInfo.forEach((h,s)=>{(s===i||h.checkChildren&&s.contains(i))&&l.push([s,h])}),l}_isLastInteractionFromInputLabel(i){let{_mostRecentTarget:l,mostRecentModality:h}=this._inputModalityDetector;if(h!=="mouse"||!l||l===i||i.nodeName!=="INPUT"&&i.nodeName!=="TEXTAREA"||i.disabled)return!1;let s=i.labels;if(s){for(let P=0;P<s.length;P++)if(s[P].contains(l))return!0}return!1}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var cd=function(c){return c[c.NONE=0]="NONE",c[c.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",c[c.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",c}(cd||{}),L1="cdk-high-contrast-black-on-white",z1="cdk-high-contrast-white-on-black",hy="cdk-high-contrast-active",G1=(()=>{class c{_platform=ge(Sr);_hasCheckedHighContrastMode;_document=ge(vi);_breakpointSubscription;constructor(){this._breakpointSubscription=ge(F1).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return cd.NONE;let i=this._document.createElement("div");i.style.backgroundColor="rgb(1,2,3)",i.style.position="absolute",this._document.body.appendChild(i);let l=this._document.defaultView||window,h=l&&l.getComputedStyle?l.getComputedStyle(i):null,s=(h&&h.backgroundColor||"").replace(/ /g,"");switch(i.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return cd.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return cd.BLACK_ON_WHITE}return cd.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let i=this._document.body.classList;i.remove(hy,L1,z1),this._hasCheckedHighContrastMode=!0;let l=this.getHighContrastMode();l===cd.BLACK_ON_WHITE?i.add(hy,L1):l===cd.WHITE_ON_BLACK&&i.add(hy,z1)}}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var py={},ts=(()=>{class c{_appId=ge(jh);getId(i){return this._appId!=="ng"&&(i+=this._appId),py.hasOwnProperty(i)||(py[i]=0),`${i}${py[i]++}`}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var FT=new ut("cdk-dir-doc",{providedIn:"root",factory:LT});function LT(){return ge(vi)}var zT=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function BT(c){let a=c?.toLowerCase()||"";return a==="auto"&&typeof navigator<"u"&&navigator?.language?zT.test(navigator.language)?"rtl":"ltr":a==="rtl"?"rtl":"ltr"}var ua=(()=>{class c{value="ltr";change=new oi;constructor(){let i=ge(FT,{optional:!0});if(i){let l=i.body?i.body.dir:null,h=i.documentElement?i.documentElement.dir:null;this.value=BT(l||h||"ltr")}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var lc=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({})}return c})();var NT=["text"],VT=[[["mat-icon"]],"*"],jT=["mat-icon","*"];function UT(c,a){if(c&1&&Te(0,"mat-pseudo-checkbox",1),c&2){let i=ze();Oe("disabled",i.disabled)("state",i.selected?"checked":"unchecked")}}function $T(c,a){if(c&1&&Te(0,"mat-pseudo-checkbox",3),c&2){let i=ze();Oe("disabled",i.disabled)}}function GT(c,a){if(c&1&&(O(0,"span",4),Y(1),F()),c&2){let i=ze();re(),Ot("(",i.group.label,")")}}var hn=(()=>{class c{constructor(){ge(G1)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[lc,lc]})}return c})(),Jf=class{_defaultMatcher;ngControl;_parentFormGroup;_parentForm;_stateChanges;errorState=!1;matcher;constructor(a,i,l,h,s){this._defaultMatcher=a,this.ngControl=i,this._parentFormGroup=l,this._parentForm=h,this._stateChanges=s}updateErrorState(){let a=this.errorState,i=this._parentFormGroup||this._parentForm,l=this.matcher||this._defaultMatcher,h=this.ngControl?this.ngControl.control:null,s=l?.isErrorState(h,i)??!1;s!==a&&(this.errorState=s,this._stateChanges.next())}};var Y1=(()=>{class c{isErrorState(i,l){return!!(i&&i.invalid&&(i.touched||l&&l.submitted))}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),eg=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["structural-styles"]],decls:0,vars:0,template:function(l,h){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}'],encapsulation:2,changeDetection:0})}return c})();var Fo=function(c){return c[c.FADING_IN=0]="FADING_IN",c[c.VISIBLE=1]="VISIBLE",c[c.FADING_OUT=2]="FADING_OUT",c[c.HIDDEN=3]="HIDDEN",c}(Fo||{}),by=class{_renderer;element;config;_animationForciblyDisabledThroughCss;state=Fo.HIDDEN;constructor(a,i,l,h=!1){this._renderer=a,this.element=i,this.config=l,this._animationForciblyDisabledThroughCss=h}fadeOut(){this._renderer.fadeOutRipple(this)}},H1=Ru({passive:!0,capture:!0}),xy=class{_events=new Map;addHandler(a,i,l,h){let s=this._events.get(i);if(s){let P=s.get(l);P?P.add(h):s.set(l,new Set([h]))}else this._events.set(i,new Map([[l,new Set([h])]])),a.runOutsideAngular(()=>{document.addEventListener(i,this._delegateEventHandler,H1)})}removeHandler(a,i,l){let h=this._events.get(a);if(!h)return;let s=h.get(i);s&&(s.delete(l),s.size===0&&h.delete(i),h.size===0&&(this._events.delete(a),document.removeEventListener(a,this._delegateEventHandler,H1)))}_delegateEventHandler=a=>{let i=es(a);i&&this._events.get(a.type)?.forEach((l,h)=>{(h===i||h.contains(i))&&l.forEach(s=>s.handleEvent(a))})}},Z1={enterDuration:225,exitDuration:150},HT=800,W1=Ru({passive:!0,capture:!0}),q1=["mousedown","touchstart"],X1=["mouseup","mouseleave","touchend","touchcancel"],ZT=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(l,h){},styles:[".mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}"],encapsulation:2,changeDetection:0})}return c})(),wy=class c{_target;_ngZone;_platform;_containerElement;_triggerElement;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect;static _eventManager=new xy;constructor(a,i,l,h,s){this._target=a,this._ngZone=i,this._platform=h,h.isBrowser&&(this._containerElement=ol(l)),s&&s.get(nl).load(ZT)}fadeInRipple(a,i,l={}){let h=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Qe(Qe({},Z1),l.animation);l.centered&&(a=h.left+h.width/2,i=h.top+h.height/2);let P=l.radius||WT(a,i,h),q=a-h.left,X=i-h.top,be=s.enterDuration,ve=document.createElement("div");ve.classList.add("mat-ripple-element"),ve.style.left=`${q-P}px`,ve.style.top=`${X-P}px`,ve.style.height=`${P*2}px`,ve.style.width=`${P*2}px`,l.color!=null&&(ve.style.backgroundColor=l.color),ve.style.transitionDuration=`${be}ms`,this._containerElement.appendChild(ve);let $=window.getComputedStyle(ve),$e=$.transitionProperty,ht=$.transitionDuration,wt=$e==="none"||ht==="0s"||ht==="0s, 0s"||h.width===0&&h.height===0,lt=new by(this,ve,l,wt);ve.style.transform="scale3d(1, 1, 1)",lt.state=Fo.FADING_IN,l.persistent||(this._mostRecentTransientRipple=lt);let at=null;return!wt&&(be||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let hi=()=>{at&&(at.fallbackTimer=null),clearTimeout(At),this._finishRippleTransition(lt)},Mi=()=>this._destroyRipple(lt),At=setTimeout(Mi,be+100);ve.addEventListener("transitionend",hi),ve.addEventListener("transitioncancel",Mi),at={onTransitionEnd:hi,onTransitionCancel:Mi,fallbackTimer:At}}),this._activeRipples.set(lt,at),(wt||!be)&&this._finishRippleTransition(lt),lt}fadeOutRipple(a){if(a.state===Fo.FADING_OUT||a.state===Fo.HIDDEN)return;let i=a.element,l=Qe(Qe({},Z1),a.config.animation);i.style.transitionDuration=`${l.exitDuration}ms`,i.style.opacity="0",a.state=Fo.FADING_OUT,(a._animationForciblyDisabledThroughCss||!l.exitDuration)&&this._finishRippleTransition(a)}fadeOutAll(){this._getActiveRipples().forEach(a=>a.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(a=>{a.config.persistent||a.fadeOut()})}setupTriggerEvents(a){let i=ol(a);!this._platform.isBrowser||!i||i===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=i,q1.forEach(l=>{c._eventManager.addHandler(this._ngZone,l,i,this)}))}handleEvent(a){a.type==="mousedown"?this._onMousedown(a):a.type==="touchstart"?this._onTouchStart(a):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{X1.forEach(i=>{this._triggerElement.addEventListener(i,this,W1)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(a){a.state===Fo.FADING_IN?this._startFadeOutTransition(a):a.state===Fo.FADING_OUT&&this._destroyRipple(a)}_startFadeOutTransition(a){let i=a===this._mostRecentTransientRipple,{persistent:l}=a.config;a.state=Fo.VISIBLE,!l&&(!i||!this._isPointerDown)&&a.fadeOut()}_destroyRipple(a){let i=this._activeRipples.get(a)??null;this._activeRipples.delete(a),this._activeRipples.size||(this._containerRect=null),a===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),a.state=Fo.HIDDEN,i!==null&&(a.element.removeEventListener("transitionend",i.onTransitionEnd),a.element.removeEventListener("transitioncancel",i.onTransitionCancel),i.fallbackTimer!==null&&clearTimeout(i.fallbackTimer)),a.element.remove()}_onMousedown(a){let i=yy(a),l=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+HT;!this._target.rippleDisabled&&!i&&!l&&(this._isPointerDown=!0,this.fadeInRipple(a.clientX,a.clientY,this._target.rippleConfig))}_onTouchStart(a){if(!this._target.rippleDisabled&&!vy(a)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let i=a.changedTouches;if(i)for(let l=0;l<i.length;l++)this.fadeInRipple(i[l].clientX,i[l].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(a=>{let i=a.state===Fo.VISIBLE||a.config.terminateOnPointerUp&&a.state===Fo.FADING_IN;!a.config.persistent&&i&&a.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let a=this._triggerElement;a&&(q1.forEach(i=>c._eventManager.removeHandler(i,a,this)),this._pointerUpEventsRegistered&&(X1.forEach(i=>a.removeEventListener(i,this,W1)),this._pointerUpEventsRegistered=!1))}};function WT(c,a,i){let l=Math.max(Math.abs(c-i.left),Math.abs(c-i.right)),h=Math.max(Math.abs(a-i.top),Math.abs(a-i.bottom));return Math.sqrt(l*l+h*h)}var K1=new ut("mat-ripple-global-options"),tg=(()=>{class c{_elementRef=ge(Si);_animationMode=ge(Io,{optional:!0});color;unbounded;centered;radius=0;animation;get disabled(){return this._disabled}set disabled(i){i&&this.fadeOutAllNonPersistent(),this._disabled=i,this._setupTriggerEventsIfEnabled()}_disabled=!1;get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(i){this._trigger=i,this._setupTriggerEventsIfEnabled()}_trigger;_rippleRenderer;_globalOptions;_isInitialized=!1;constructor(){let i=ge(_i),l=ge(Sr),h=ge(K1,{optional:!0}),s=ge(Or);this._globalOptions=h||{},this._rippleRenderer=new wy(this,i,this._elementRef,l,s)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Qe(Qe(Qe({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(i,l=0,h){return typeof i=="number"?this._rippleRenderer.fadeInRipple(i,l,Qe(Qe({},this.rippleConfig),h)):this._rippleRenderer.fadeInRipple(0,0,Qe(Qe({},this.rippleConfig),i))}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(l,h){l&2&&si("mat-ripple-unbounded",h.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return c})(),Zp=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn,hn]})}return c})(),My=(()=>{class c{_animationMode=ge(Io,{optional:!0});state="unchecked";disabled=!1;appearance="full";constructor(){}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(l,h){l&2&&si("mat-pseudo-checkbox-indeterminate",h.state==="indeterminate")("mat-pseudo-checkbox-checked",h.state==="checked")("mat-pseudo-checkbox-disabled",h.disabled)("mat-pseudo-checkbox-minimal",h.appearance==="minimal")("mat-pseudo-checkbox-full",h.appearance==="full")("_mat-animation-noopable",h._animationMode==="NoopAnimations")},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(l,h){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-primary))}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color, var(--mat-sys-on-surface-variant));border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color, var(--mat-sys-primary));border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-on-primary))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color, var(--mat-sys-surface))}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}return c})(),qT=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn]})}return c})(),Sy=new ut("MAT_OPTION_PARENT_COMPONENT"),Py=new ut("MatOptgroup");var Cy=class{source;isUserInput;constructor(a,i=!1){this.source=a,this.isUserInput=i}},ig=(()=>{class c{_element=ge(Si);_changeDetectorRef=ge(Mr);_parent=ge(Sy,{optional:!0});group=ge(Py,{optional:!0});_signalDisableRipple=!1;_selected=!1;_active=!1;_disabled=!1;_mostRecentViewValue="";get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}value;id=ge(ts).getId("mat-option-");get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(i){this._disabled=i}get disableRipple(){return this._signalDisableRipple?this._parent.disableRipple():!!this._parent?.disableRipple}get hideSingleSelectionIndicator(){return!!(this._parent&&this._parent.hideSingleSelectionIndicator)}onSelectionChange=new oi;_text;_stateChanges=new qt;constructor(){ge(nl).load(eg),ge(nl).load(k1),this._signalDisableRipple=!!this._parent&&Hh(this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(i=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}deselect(i=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),i&&this._emitSelectionChangeEvent())}focus(i,l){let h=this._getHostElement();typeof h.focus=="function"&&h.focus(l)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(i){(i.keyCode===13||i.keyCode===32)&&!rl(i)&&(this._selectViaInteraction(),i.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=this.multiple?!this._selected:!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){let i=this.viewValue;i!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=i)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(i=!1){this.onSelectionChange.emit(new Cy(this,i))}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-option"]],viewQuery:function(l,h){if(l&1&&ln(NT,7),l&2){let s;wi(s=Ci())&&(h._text=s.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(l,h){l&1&&tt("click",function(){return h._selectViaInteraction()})("keydown",function(P){return h._handleKeydown(P)}),l&2&&(Zm("id",h.id),Ri("aria-selected",h.selected)("aria-disabled",h.disabled.toString()),si("mdc-list-item--selected",h.selected)("mat-mdc-option-multiple",h.multiple)("mat-mdc-option-active",h.active)("mdc-list-item--disabled",h.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",yi]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],features:[hr],ngContentSelectors:jT,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(l,h){l&1&&(Fr(VT),Xe(0,UT,1,2,"mat-pseudo-checkbox",1),Ni(1),O(2,"span",2,0),Ni(4,1),F(),Xe(5,$T,1,1,"mat-pseudo-checkbox",3)(6,GT,2,1,"span",4),Te(7,"div",5)),l&2&&(an(h.multiple?0:-1),re(5),an(!h.multiple&&h.selected&&!h.hideSingleSelectionIndicator?5:-1),re(),an(h.group&&h.group._inert?6:-1),re(),Oe("matRippleTrigger",h._getHostElement())("matRippleDisabled",h.disabled||h.disableRipple))},dependencies:[My,tg],styles:['.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color, var(--mat-sys-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}@media(forced-colors: active){.mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{right:auto;left:16px}}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return c})();function Q1(c,a,i){if(i.length){let l=a.toArray(),h=i.toArray(),s=0;for(let P=0;P<c+1;P++)l[P].group&&l[P].group===h[s]&&s++;return s}return 0}function J1(c,a,i,l){return c<i?c:c+a>i+l?Math.max(0,c-l+a):i}var Ey=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[Zp,hn,qT]})}return c})();var YT=["*"],ng;function KT(){if(ng===void 0&&(ng=null,typeof window<"u")){let c=window;c.trustedTypes!==void 0&&(ng=c.trustedTypes.createPolicy("angular#components",{createHTML:a=>a}))}return ng}function Wp(c){return KT()?.createHTML(c)||c}function eC(c){return Error(`Unable to find icon with the name "${c}"`)}function QT(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function tC(c){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${c}".`)}function iC(c){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${c}".`)}var sl=class{url;svgText;options;svgElement;constructor(a,i,l){this.url=a,this.svgText=i,this.options=l}},JT=(()=>{class c{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(i,l,h,s){this._httpClient=i,this._sanitizer=l,this._errorHandler=s,this._document=h}addSvgIcon(i,l,h){return this.addSvgIconInNamespace("",i,l,h)}addSvgIconLiteral(i,l,h){return this.addSvgIconLiteralInNamespace("",i,l,h)}addSvgIconInNamespace(i,l,h,s){return this._addSvgIconConfig(i,l,new sl(h,null,s))}addSvgIconResolver(i){return this._resolvers.push(i),this}addSvgIconLiteralInNamespace(i,l,h,s){let P=this._sanitizer.sanitize(ko.HTML,h);if(!P)throw iC(h);let q=Wp(P);return this._addSvgIconConfig(i,l,new sl("",q,s))}addSvgIconSet(i,l){return this.addSvgIconSetInNamespace("",i,l)}addSvgIconSetLiteral(i,l){return this.addSvgIconSetLiteralInNamespace("",i,l)}addSvgIconSetInNamespace(i,l,h){return this._addSvgIconSetConfig(i,new sl(l,null,h))}addSvgIconSetLiteralInNamespace(i,l,h){let s=this._sanitizer.sanitize(ko.HTML,l);if(!s)throw iC(l);let P=Wp(s);return this._addSvgIconSetConfig(i,new sl("",P,h))}registerFontClassAlias(i,l=i){return this._fontCssClassesByAlias.set(i,l),this}classNameForFontAlias(i){return this._fontCssClassesByAlias.get(i)||i}setDefaultFontSetClass(...i){return this._defaultFontSetClass=i,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(i){let l=this._sanitizer.sanitize(ko.RESOURCE_URL,i);if(!l)throw tC(i);let h=this._cachedIconsByUrl.get(l);return h?bt(rg(h)):this._loadSvgIconFromConfig(new sl(i,null)).pipe(tn(s=>this._cachedIconsByUrl.set(l,s)),Ft(s=>rg(s)))}getNamedSvgIcon(i,l=""){let h=nC(l,i),s=this._svgIconConfigs.get(h);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(l,i),s)return this._svgIconConfigs.set(h,s),this._getSvgFromConfig(s);let P=this._iconSetConfigs.get(l);return P?this._getSvgFromIconSetConfigs(i,P):qc(eC(h))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(i){return i.svgText?bt(rg(this._svgElementFromConfig(i))):this._loadSvgIconFromConfig(i).pipe(Ft(l=>rg(l)))}_getSvgFromIconSetConfigs(i,l){let h=this._extractIconWithNameFromAnySet(i,l);if(h)return bt(h);let s=l.filter(P=>!P.svgText).map(P=>this._loadSvgIconSetFromConfig(P).pipe(na(q=>{let be=`Loading icon set URL: ${this._sanitizer.sanitize(ko.RESOURCE_URL,P.url)} failed: ${q.message}`;return this._errorHandler.handleError(new Error(be)),bt(null)})));return Fm(s).pipe(Ft(()=>{let P=this._extractIconWithNameFromAnySet(i,l);if(!P)throw eC(i);return P}))}_extractIconWithNameFromAnySet(i,l){for(let h=l.length-1;h>=0;h--){let s=l[h];if(s.svgText&&s.svgText.toString().indexOf(i)>-1){let P=this._svgElementFromConfig(s),q=this._extractSvgIconFromSet(P,i,s.options);if(q)return q}}return null}_loadSvgIconFromConfig(i){return this._fetchIcon(i).pipe(tn(l=>i.svgText=l),Ft(()=>this._svgElementFromConfig(i)))}_loadSvgIconSetFromConfig(i){return i.svgText?bt(null):this._fetchIcon(i).pipe(tn(l=>i.svgText=l))}_extractSvgIconFromSet(i,l,h){let s=i.querySelector(`[id="${l}"]`);if(!s)return null;let P=s.cloneNode(!0);if(P.removeAttribute("id"),P.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(P,h);if(P.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(P),h);let q=this._svgElementFromString(Wp("<svg></svg>"));return q.appendChild(P),this._setSvgAttributes(q,h)}_svgElementFromString(i){let l=this._document.createElement("DIV");l.innerHTML=i;let h=l.querySelector("svg");if(!h)throw Error("<svg> tag not found");return h}_toSvgElement(i){let l=this._svgElementFromString(Wp("<svg></svg>")),h=i.attributes;for(let s=0;s<h.length;s++){let{name:P,value:q}=h[s];P!=="id"&&l.setAttribute(P,q)}for(let s=0;s<i.childNodes.length;s++)i.childNodes[s].nodeType===this._document.ELEMENT_NODE&&l.appendChild(i.childNodes[s].cloneNode(!0));return l}_setSvgAttributes(i,l){return i.setAttribute("fit",""),i.setAttribute("height","100%"),i.setAttribute("width","100%"),i.setAttribute("preserveAspectRatio","xMidYMid meet"),i.setAttribute("focusable","false"),l&&l.viewBox&&i.setAttribute("viewBox",l.viewBox),i}_fetchIcon(i){let{url:l,options:h}=i,s=h?.withCredentials??!1;if(!this._httpClient)throw QT();if(l==null)throw Error(`Cannot fetch icon from URL "${l}".`);let P=this._sanitizer.sanitize(ko.RESOURCE_URL,l);if(!P)throw tC(l);let q=this._inProgressUrlFetches.get(P);if(q)return q;let X=this._httpClient.get(P,{responseType:"text",withCredentials:s}).pipe(Ft(be=>Wp(be)),Xa(()=>this._inProgressUrlFetches.delete(P)),Yb());return this._inProgressUrlFetches.set(P,X),X}_addSvgIconConfig(i,l,h){return this._svgIconConfigs.set(nC(i,l),h),this}_addSvgIconSetConfig(i,l){let h=this._iconSetConfigs.get(i);return h?h.push(l):this._iconSetConfigs.set(i,[l]),this}_svgElementFromConfig(i){if(!i.svgElement){let l=this._svgElementFromString(i.svgText);this._setSvgAttributes(l,i.options),i.svgElement=l}return i.svgElement}_getIconConfigFromResolvers(i,l){for(let h=0;h<this._resolvers.length;h++){let s=this._resolvers[h](l,i);if(s)return eI(s)?new sl(s.url,null,s.options):new sl(s,null)}}static \u0275fac=function(l){return new(l||c)(Vt(Ao,8),Vt(h0),Vt(vi,8),Vt(Kc))};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function rg(c){return c.cloneNode(!0)}function nC(c,a){return c+":"+a}function eI(c){return!!(c.url&&c.options)}var tI=new ut("MAT_ICON_DEFAULT_OPTIONS"),iI=new ut("mat-icon-location",{providedIn:"root",factory:nI});function nI(){let c=ge(vi),a=c?c.location:null;return{getPathname:()=>a?a.pathname+a.search:""}}var rC=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],rI=rC.map(c=>`[${c}]`).join(", "),oI=/^url\(['"]?#(.*?)['"]?\)$/,Lu=(()=>{class c{_elementRef=ge(Si);_iconRegistry=ge(JT);_location=ge(iI);_errorHandler=ge(Kc);_defaultColor;get color(){return this._color||this._defaultColor}set color(i){this._color=i}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(i){i!==this._svgIcon&&(i?this._updateSvgIcon(i):this._svgIcon&&this._clearSvgElement(),this._svgIcon=i)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(i){let l=this._cleanupFontValue(i);l!==this._fontSet&&(this._fontSet=l,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(i){let l=this._cleanupFontValue(i);l!==this._fontIcon&&(this._fontIcon=l,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Rr.EMPTY;constructor(){let i=ge(new Yc("aria-hidden"),{optional:!0}),l=ge(tI,{optional:!0});l&&(l.color&&(this.color=this._defaultColor=l.color),l.fontSet&&(this.fontSet=l.fontSet)),i||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(i){if(!i)return["",""];let l=i.split(":");switch(l.length){case 1:return["",l[0]];case 2:return l;default:throw Error(`Invalid icon name: "${i}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let i=this._elementsWithExternalReferences;if(i&&i.size){let l=this._location.getPathname();l!==this._previousPath&&(this._previousPath=l,this._prependPathToReferences(l))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(i){this._clearSvgElement();let l=this._location.getPathname();this._previousPath=l,this._cacheChildrenWithExternalReferences(i),this._prependPathToReferences(l),this._elementRef.nativeElement.appendChild(i)}_clearSvgElement(){let i=this._elementRef.nativeElement,l=i.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();l--;){let h=i.childNodes[l];(h.nodeType!==1||h.nodeName.toLowerCase()==="svg")&&h.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let i=this._elementRef.nativeElement,l=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(h=>h.length>0);this._previousFontSetClass.forEach(h=>i.classList.remove(h)),l.forEach(h=>i.classList.add(h)),this._previousFontSetClass=l,this.fontIcon!==this._previousFontIconClass&&!l.includes("mat-ligature-font")&&(this._previousFontIconClass&&i.classList.remove(this._previousFontIconClass),this.fontIcon&&i.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(i){return typeof i=="string"?i.trim().split(" ")[0]:i}_prependPathToReferences(i){let l=this._elementsWithExternalReferences;l&&l.forEach((h,s)=>{h.forEach(P=>{s.setAttribute(P.name,`url('${i}#${P.value}')`)})})}_cacheChildrenWithExternalReferences(i){let l=i.querySelectorAll(rI),h=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<l.length;s++)rC.forEach(P=>{let q=l[s],X=q.getAttribute(P),be=X?X.match(oI):null;if(be){let ve=h.get(q);ve||(ve=[],h.set(q,ve)),ve.push({name:P,value:be[1]})}})}_updateSvgIcon(i){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),i){let[l,h]=this._splitIconName(i);l&&(this._svgNamespace=l),h&&(this._svgName=h),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(h,l).pipe(To(1)).subscribe(s=>this._setSvgElement(s),s=>{let P=`Error retrieving icon ${l}:${h}! ${s.message}`;this._errorHandler.handleError(new Error(P))})}}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(l,h){l&2&&(Ri("data-mat-icon-type",h._usingFontIcon()?"font":"svg")("data-mat-icon-name",h._svgName||h.fontIcon)("data-mat-icon-namespace",h._svgNamespace||h.fontSet)("fontIcon",h._usingFontIcon()?h.fontIcon:null),Zh(h.color?"mat-"+h.color:""),si("mat-icon-inline",h.inline)("mat-icon-no-color",h.color!=="primary"&&h.color!=="accent"&&h.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",yi],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[hr],ngContentSelectors:YT,decls:1,vars:0,template:function(l,h){l&1&&(Fr(),Ni(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return c})(),cc=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn,hn]})}return c})();function sI(c,a){c&1&&(O(0,"div",5),Y(1," Cargando men\xFA... "),F())}function aI(c,a){if(c&1&&(O(0,"mat-icon"),Y(1),F()),c&2){let i=ze(2).$implicit,l=ze(2);re(),St(l.isAbierto(i)?"expand_less":"expand_more")}}function lI(c,a){if(c&1&&(O(0,"mat-icon"),Y(1),F()),c&2){let i=ze(2).$implicit,l=ze(5);re(),St(l.isAbierto(i)?"expand_less":"expand_more")}}function cI(c,a){if(c&1){let i=Xt();O(0,"a",13),tt("click",function(){mt(i);let h=ze().$implicit,s=ze(8);return ft(s.navegar(h.ruta))}),O(1,"mat-icon"),Y(2),F(),O(3,"span"),Y(4),F()()}if(c&2){let i=ze().$implicit;re(2),St(i.icono),re(2),St(i.texto)}}function dI(c,a){if(c&1&&(O(0,"li"),Xe(1,cI,5,2,"a",12),F()),c&2){let i=a.$implicit,l=ze(8);re(),Oe("ngIf",l.isVisible(i))}}function uI(c,a){if(c&1&&(O(0,"ul",11),Xe(1,dI,2,1,"li",7),F()),c&2){let i=ze(2).$implicit;re(),Oe("ngForOf",i.hijos)}}function hI(c,a){if(c&1){let i=Xt();O(0,"li")(1,"a",9),tt("click",function(){mt(i);let h=ze().$implicit,s=ze(5);return ft(h.hijos?s.toggle(h):s.navegar(h.ruta))}),O(2,"mat-icon"),Y(3),F(),O(4,"span"),Y(5),F(),Xe(6,lI,2,1,"mat-icon",8),F(),Xe(7,uI,2,1,"ul",10),F()}if(c&2){let i=ze().$implicit,l=ze(5);re(3),St(i.icono),re(2),St(i.texto),re(),Oe("ngIf",i.hijos),re(),Oe("ngIf",i.hijos&&l.isAbierto(i))}}function pI(c,a){if(c&1&&(Wh(0),Xe(1,hI,8,4,"li",8),qh()),c&2){let i=a.$implicit,l=ze(5);re(),Oe("ngIf",l.isVisible(i))}}function mI(c,a){if(c&1&&(O(0,"ul",11),Xe(1,pI,2,1,"ng-container",7),F()),c&2){let i=ze(2).$implicit;re(),Oe("ngForOf",i.hijos)}}function fI(c,a){if(c&1){let i=Xt();O(0,"li")(1,"a",9),tt("click",function(){mt(i);let h=ze().$implicit,s=ze(2);return ft(h.hijos?s.toggle(h):s.navegar(h.ruta))}),O(2,"mat-icon"),Y(3),F(),O(4,"span"),Y(5),F(),Xe(6,aI,2,1,"mat-icon",8),F(),Xe(7,mI,2,1,"ul",10),F()}if(c&2){let i=ze().$implicit,l=ze(2);re(3),St(i.icono),re(2),St(i.texto),re(),Oe("ngIf",i.hijos),re(),Oe("ngIf",i.hijos&&l.isAbierto(i))}}function gI(c,a){if(c&1&&(Wh(0),Xe(1,fI,8,4,"li",8),qh()),c&2){let i=a.$implicit,l=ze(2);re(),Oe("ngIf",l.isVisible(i))}}function _I(c,a){if(c&1&&(O(0,"ul",6),Xe(1,gI,2,1,"ng-container",7),F()),c&2){let i=ze();re(),Oe("ngForOf",i.menu)}}var zu=class c{constructor(a,i){this.router=a;this.http=i}menu=[{icono:"eco",texto:"Ambiente",dimension:"ambiente",hijos:[{icono:"recycling",texto:"Gesti\xF3n de Recursos",ruta:"/ambiente/recursos",subdimension:"gestion_recursos"},{icono:"cloud",texto:"Calidad Ambiental",subdimension:"calidad_ambiental",hijos:[{icono:"dashboard",texto:"Tablero de Control Sensores Ruido",ruta:"/ambiente/calidad/ruido/dashboard"},{icono:"map",texto:"Mapa Sensores Ruido",ruta:"/ambiente/calidad/ruido/mapa"},{icono:"dashboard_customize",texto:"Tablero de Control SIATA",ruta:"/ambiente/calidad/siata/dashboard"},{icono:"map",texto:"Mapa SIATA",ruta:"/ambiente/calidad/siata/mapa"}]},{icono:"warning",texto:"Gesti\xF3n del Riesgo",ruta:"/ambiente/riesgo",subdimension:"gestion_riesgo"},{icono:"delete",texto:"Gesti\xF3n de Residuos",subdimension:"gestion_residuos",hijos:[{icono:"dashboard",texto:"Tablero de Control Camiones EMVARIAS",ruta:"/ambiente/residuos/camiones/dashboard"},{icono:"map",texto:"Mapa Camiones EMVARIAS",ruta:"/ambiente/residuos/camiones/mapa"}]},{icono:"public",texto:"Cambio Clim\xE1tico",ruta:"/ambiente/cambioclimatico",subdimension:"cambio_climatico"}]},{icono:"home_work",texto:"H\xE1bitat",dimension:"habitat",hijos:[{icono:"domain",texto:"Infraestructura",ruta:"/habitat/infraestructura",subdimension:"infraestructura"},{icono:"commute",texto:"Movilidad Inteligente",subdimension:"movilidad_inteligente",hijos:[{icono:"dashboard",texto:"Tablero de Control Movilidad",ruta:"/habitat/movilidad/dashboard"},{icono:"map",texto:"Mapa Movilidad",ruta:"/habitat/movilidad/mapa"},{icono:"dashboard_customize",texto:"Tablero de Control VamosMED",ruta:"/habitat/movilidad/vamosmed/dashboard"},{icono:"map",texto:"Mapa VamosMED",ruta:"/habitat/movilidad/vamosmed/mapa"}]},{icono:"build",texto:"Servicios P\xFAblicos",ruta:"/habitat/servicios-publicos",subdimension:"servicios_publicos"}]},{icono:"trending_up",texto:"Desarrollo Econ\xF3mico",dimension:"desarrollo_economico",hijos:[{icono:"lightbulb",texto:"Emprendimiento e Innovaci\xF3n",ruta:"/economico/emprendimiento",subdimension:"emprendimiento_innovacion"},{icono:"school",texto:"Econom\xEDa del conocimiento",ruta:"/economico/conocimiento",subdimension:"economia_conocimiento"},{icono:"business",texto:"Entorno Productivo y Competitivo",ruta:"/economico/entorno",subdimension:"entorno_productivo"},{icono:"engineering",texto:"Empleo",ruta:"/economico/empleo",subdimension:"empleo"},{icono:"wifi",texto:"Transformaci\xF3n Digital",subdimension:"transformacion_digital",hijos:[{icono:"dashboard",texto:"Tablero de Control Puntos WiFi",ruta:"/economico/digital/wifi/dashboard"},{icono:"map",texto:"Mapa Puntos WiFi",ruta:"/economico/digital/wifi/mapa"}]},{icono:"recycle",texto:"Econom\xEDa Circular",ruta:"/economico/circular",subdimension:"economia_circular"},{icono:"agriculture",texto:"Agricultura",ruta:"/economico/agricultura",subdimension:"agricultura"}]},{icono:"groups",texto:"Ciudadan\xEDa",dimension:"ciudadania",hijos:[{icono:"school",texto:"Educaci\xF3n",ruta:"/ciudadania/educacion",subdimension:"educacion"},{icono:"diversity_1",texto:"Equidad",ruta:"/ciudadania/equidad",subdimension:"equidad"},{icono:"accessible",texto:"Sociedad Incluyente",ruta:"/ciudadania/incluyente",subdimension:"sociedad_incluyente"},{icono:"emoji_people",texto:"Cultura Ciudadana",ruta:"/ciudadania/cultura",subdimension:"cultura_ciudadana"},{icono:"diversity_3",texto:"Cohesi\xF3n social",ruta:"/ciudadania/cohesion",subdimension:"cohesion_social"}]},{icono:"health_and_safety",texto:"Calidad de Vida",dimension:"calidad_vida",hijos:[{icono:"sentiment_satisfied",texto:"Bienestar",ruta:"/calidad/bienestar",subdimension:"bienestar"},{icono:"security",texto:"Seguridad",ruta:"/calidad/seguridad",subdimension:"seguridad"},{icono:"healing",texto:"Salud",ruta:"/calidad/salud",subdimension:"salud"},{icono:"map",texto:"Ocio y Turismo",subdimension:"ocio_turismo",hijos:[{icono:"dashboard",texto:"Tablero de Control Turismo",ruta:"/calidad/turismo/dashboard"},{icono:"map",texto:"Mapa Turismo",ruta:"/calidad/turismo/mapa"}]}]},{icono:"gavel",texto:"Gobernanza",dimension:"gobernanza",hijos:[{icono:"how_to_vote",texto:"Participaci\xF3n Ciudadana",subdimension:"participacion_ciudadana",hijos:[{icono:"dashboard",texto:"Tablero de Control ReportesMED",ruta:"/gobernanza/participacion/reportesmed/dashboard"},{icono:"map",texto:"Mapa Reportes MED",ruta:"/gobernanza/participacion/reportesmed/mapa"},{icono:"dashboard_customize",texto:"Tablero de Control PQRS",ruta:"/gobernanza/participacion/pqrs/dashboard"},{icono:"map",texto:"Mapa PQRS",ruta:"/gobernanza/participacion/pqrs/mapa"}]},{icono:"account_balance",texto:"Gobernanza",ruta:"/gobernanza/gobernanza",subdimension:"gobernanza"},{icono:"public",texto:"Colaboraci\xF3n entre Ciudades y Territorios",ruta:"/gobernanza/colaboracion",subdimension:"colaboracion_ciudades"},{icono:"computer",texto:"Gobierno Digital",ruta:"/gobernanza/digital",subdimension:"gobierno_digital"}]}];nivelesAbiertos={};permisosUsuario=[];cargando=!0;ngOnInit(){return Dr(this,null,function*(){yield this.obtenerPermisosUsuario(),this.aplicarPermisos(),this.cargando=!1})}obtenerPermisosUsuario(){return Dr(this,null,function*(){let a=localStorage.getItem("access_tokenadmin");if(!a){console.warn("No se encontr\xF3 el token de acceso - Mostrando men\xFA completo"),this.permisosUsuario=[];return}try{let l=yield Gb(this.http.get("https://www.medellin.gov.co/flask-fiware/api/keycloak/userinfo",{headers:{Authorization:`Bearer ${a}`}}));this.permisosUsuario=Array.isArray(l)?l:[]}catch(i){console.error("Error al obtener permisos del usuario:",i),this.permisosUsuario=[]}})}aplicarPermisos(){if(Array.isArray(this.permisosUsuario)||(this.permisosUsuario=[]),this.permisosUsuario.length===0){this.menu.forEach(a=>{a.visible=!0,a.hijos&&a.hijos.forEach(i=>{i.visible=!0,i.hijos&&i.hijos.forEach(l=>{l.visible=!0})})});return}this.menu.forEach(a=>{let i=this.permisosUsuario.filter(l=>l.dimension===a.dimension);if(i.length===0){a.visible=!1;return}a.visible=i.some(l=>l.activa),a.hijos&&a.hijos.forEach(l=>{let h=this.permisosUsuario.find(s=>s.dimension===a.dimension&&s.subdimension===l.subdimension);l.visible=h?h.activa:!1,l.hijos&&l.hijos.forEach(s=>{s.visible=l.visible})})})}navegar(a){a&&this.router.navigateByUrl(a)}toggle(a){let i=a.texto;this.nivelesAbiertos[i]=!this.nivelesAbiertos[i]}isAbierto(a){return this.nivelesAbiertos[a.texto]}isVisible(a){return a.visible!==!1}static \u0275fac=function(i){return new(i||c)(It(uo),It(Ao))};static \u0275cmp=rt({type:c,selectors:[["app-menu-opciones"]],decls:5,vars:2,consts:[[1,"menu-container"],["src","https://i.ibb.co/Ksh0J2w/alcaldia-Medellin.png","alt","Logo Alcald\xEDa de Medell\xEDn",1,"menu-logo"],["src","https://www.fiware.org/custom/brand-guide/img/logo/fiware/primary/png/logo-fiware-blue.png?","alt","Logo FIWARE",1,"menu-logon"],["class","cargando",4,"ngIf"],["class","menu-list",4,"ngIf"],[1,"cargando"],[1,"menu-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"menu-item","submenu-toggle",3,"click"],["class","submenu",4,"ngIf"],[1,"submenu"],["class","menu-item",3,"click",4,"ngIf"],[1,"menu-item",3,"click"]],template:function(i,l){i&1&&(O(0,"div",0),Te(1,"img",1)(2,"img",2),Xe(3,sI,2,0,"div",3)(4,_I,2,1,"ul",4),F()),i&2&&(re(3),Oe("ngIf",l.cargando),re(),Oe("ngIf",!l.cargando))},dependencies:[nr,Qo,co,cc,Lu,sa],styles:['@charset "UTF-8";.menu-container[_ngcontent-%COMP%]{position:fixed;top:0;left:-20px;width:260px;height:100vh;background:linear-gradient(145deg,#fffc,#f0f0f099);-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);padding:20px;box-shadow:4px 0 20px #0006,inset -4px 0 15px #ffffff4d;border-right:1px solid rgba(255,255,255,.25);overflow-y:auto;z-index:1000;transition:transform .3s ease-in-out}.menu-logon[_ngcontent-%COMP%]{display:block;max-width:120px;height:auto;margin:0 auto 10px;border-radius:15px;box-shadow:0 4px 10px #0003,inset 0 2px 6px #fff6;transition:transform .3s ease,box-shadow .4s ease,filter .4s ease}.menu-logo[_ngcontent-%COMP%]{display:block;max-width:103%;margin:0 auto 20px;background-color:#fff;transition:transform .3s ease,box-shadow .4s ease,filter .4s ease}.menu-list[_ngcontent-%COMP%], .submenu[_ngcontent-%COMP%]{list-style-type:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;text-decoration:none;color:#000;background:linear-gradient(145deg,#fffc,#e6e6e699);border:1px solid rgba(200,200,200,.4);border-radius:16px;padding:10px 18px;margin-bottom:10px;margin-left:-8px;box-shadow:0 8px 15px #0000004d,inset 0 3px 6px #fff6;transition:all .3s ease-in-out;transform:perspective(500px) rotateY(0)}.menu-item[_ngcontent-%COMP%]:hover{background:linear-gradient(145deg,#ffffffe6,#e6e6e6cc);transform:translateY(-5px) scale(1.08) rotateY(10deg);box-shadow:0 10px 20px #0006,inset 0 4px 10px #ffffff80;filter:brightness(1.1)}mat-icon[_ngcontent-%COMP%]{margin-right:15px;font-size:24px;color:#333;text-shadow:1px 1px 5px rgba(0,0,0,.3),0 0 10px rgba(0,255,255,.8);transition:color .3s ease,transform .3s ease,text-shadow .4s ease}.menu-item[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{color:#000;transform:scale(1.3);text-shadow:0 0 15px rgba(0,255,255,.8),0 0 25px rgba(0,255,255,.6),0 0 30px rgba(0,255,255,.5)}']})};var Iy=ou(Bp());var og=class c{constructor(a){this.router=a}irAPerfil(){this.router.navigate(["perfil/usuarios"])}logout(){localStorage.removeItem("access_token"),localStorage.getItem("access_token")?Iy.default.fire({icon:"error",title:"Error",text:"No se pudo eliminar el token",confirmButtonText:"OK"}):Iy.default.fire({icon:"success",title:"Token eliminado",text:"El token de acceso ha sido removido del almacenamiento local.",confirmButtonText:"OK"})}static \u0275fac=function(i){return new(i||c)(It(uo))};static \u0275cmp=rt({type:c,selectors:[["app-header"]],decls:14,vars:0,consts:[[1,"header"],[1,"header-container"],[1,"logo"],["src","https://www.fiware.org/custom/brand-guide/img/logo/fiware/primary/jpg/logo-fiware.jpg?","alt","Logo Alcald\xEDa de Medell\xEDn",1,"menu-logo",2,"background-color","rgb(250, 250, 250)"],[1,"user-info"],[1,"profile-dropdown"],[1,"profile-button"],[2,"font-size","50px"],[1,"dropdown-menu"],[3,"click"],["href","#",3,"click"]],template:function(i,l){i&1&&(O(0,"header",0)(1,"div",1)(2,"div",2),Te(3,"img",3),F(),O(4,"div",4)(5,"div",5)(6,"button",6)(7,"div",7),Y(8,"\u{1F464}"),F()(),O(9,"div",8)(10,"a",9),tt("click",function(){return l.irAPerfil()}),Y(11,"Perfil"),F(),O(12,"a",10),tt("click",function(){return l.logout()}),Y(13,"Cerrar sesi\xF3n"),F()()()()()())},dependencies:[ic,cc],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{margin:0;font-family:Arial,sans-serif;background-color:#f8f9fa}.menu-logo[_ngcontent-%COMP%]{display:block;max-width:120px;height:auto;margin:0 auto 10px;transition:transform .3s ease,box-shadow .4s ease,filter .4s ease}.header[_ngcontent-%COMP%]{background:#fff;width:calc(100% - 390px);max-width:none;height:75px;padding:12px 25px;display:flex;justify-content:space-between;align-items:center;color:#333;border-radius:18px;box-shadow:0 4px 12px #0003;margin-left:330px;margin-top:20px;position:relative;z-index:1000;opacity:0;transform:translateY(-15px);animation:_ngcontent-%COMP%_fadeIn .4s ease-out forwards}.main[_ngcontent-%COMP%]{margin-top:120px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.header[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 8px 20px #0000004d}.header-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;align-items:center}.logo[_ngcontent-%COMP%]{font-size:26px;font-weight:700;color:#5d4037}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.profile-dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block}.profile-button[_ngcontent-%COMP%]{background:none;border:none;color:#5d4037;font-size:16px;display:flex;align-items:center;cursor:pointer;transition:transform .2s ease-in-out}.profile-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.profile-icon[_ngcontent-%COMP%]{font-size:40px;transition:color .3s ease}.profile-button[_ngcontent-%COMP%]:hover   .profile-icon[_ngcontent-%COMP%]{color:#4a90e2}.dropdown-menu[_ngcontent-%COMP%]{display:none;position:absolute;right:0;background:#fff;box-shadow:0 5px 15px #00000026;border-radius:10px;overflow:hidden;min-width:160px;opacity:0;transform:translateY(10px);transition:all .3s ease-in-out}.profile-dropdown[_ngcontent-%COMP%]:hover   .dropdown-menu[_ngcontent-%COMP%]{display:block;opacity:1;transform:translateY(0)}.dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:12px;color:#333;text-decoration:none;font-weight:500;transition:background .3s ease}.dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#f0f0f0}']})};var sg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-layout"]],decls:3,vars:0,template:function(i,l){i&1&&Te(0,"app-header")(1,"app-menu-opciones")(2,"router-outlet")},dependencies:[nr,zu,og,ic,Mp],encapsulation:2})};var ag=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-inicio"]],decls:12,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733868035919&to=1734472835919&viewPanel=73&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733890467754&to=1734495267754&viewPanel=74&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733891497815&to=1734496297815&viewPanel=75&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733891690672&to=1734496490672&viewPanel=76&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733891734324&to=1734496534324&viewPanel=79&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/inicio/home?orgId=1&from=1733892371283&to=1734497171283&viewPanel=80&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Inicio"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4),F(),O(6,"div",2),Te(7,"iframe",5)(8,"iframe",6),F(),O(9,"div",2),Te(10,"iframe",7)(11,"iframe",8),F()())},styles:[".iframe-container[_ngcontent-%COMP%]{width:75%;height:50%;display:flex;margin-left:25%;justify-content:right}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{border:none;width:60%;height:800px}","body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column;font-family:Arial,sans-serif;background-color:#f4f4f4}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:300px;border:none;border-radius:8px;box-shadow:0 4px 12px #0000001a}iframe[_ngcontent-%COMP%]:hover{transform:scale(1.02)}"]})};var lg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:11,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1734455124927&to=1734498324927&viewPanel=16&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1740352844880&to=1740396044880&viewPanel=10&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1740352870706&to=1740396070706&viewPanel=13&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ta/emvarias?orgId=1&from=1740352901739&to=1740396101739&viewPanel=9&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Camiones"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3),F(),O(5,"div",2),Te(6,"iframe",4),F(),O(7,"div",2),Te(8,"iframe",5),F(),O(9,"div",2),Te(10,"iframe",6),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}"]})};var cg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-sensores-ruido"]],decls:5,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/ce9a9bd3-6b1e-48bc-8fab-cc6a042f6f5b/ambience-dashboard?orgId=1&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Sensores de Ruido"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin-left:300px;margin-bottom:20px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px}.iframe-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:920px;border:none}"]})};var dg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:10,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row","small-iframes"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734607826803&to=1735212626803&viewPanel=2&kiosk`],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734613212216&to=1735218012216&viewPanel=3&kiosk`],[1,"iframe-row","large-iframe"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734613644066&to=1735218444067&viewPanel=56&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ta/reportesmed?orgId=1&from=1734613814858&to=1735218614858&viewPanel=57&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Reportes M\xE9dicos"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4),F(),O(6,"div",5),Te(7,"iframe",6),F(),O(8,"div",5),Te(9,"iframe",7),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-row[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.small-iframes[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;max-width:48%}.large-iframe[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:500px;max-width:80%}@media (max-width: 1200px){.small-iframes[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%], .large-iframe[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{max-width:100%}}"]})};var ug=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:12,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732686476511&to=1735278476511&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732687115885&to=1735279115885&viewPanel=4&kiosk`,"allowfullscreen",""],[1,"iframe-column"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732711995953&to=1735303995953&viewPanel=33&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712398666&to=1735304398666&viewPanel=34&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712155294&to=1735304155295&viewPanel=6&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712771842&to=1735304771842&viewPanel=8&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pw_ta/puntoswifi?orgId=1&from=1732712873380&to=1735304873380&viewPanel=20&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Puntos Wi-Fi"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4),F(),O(6,"div",5),Te(7,"iframe",6)(8,"iframe",7)(9,"iframe",8)(10,"iframe",9)(11,"iframe",10),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.iframe-column[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:600px;border:none}"]})};var hg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:9,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/be4206a5-5095-46c2-8ad6-459879f8b397/evolucion-temporal?orgId=1&var-time_interval=week&var-modo_transporte=%27EnBici%27&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/c4aa4e46-0aeb-4e56-b272-bd96329b9f92/impacto-ambiental?orgId=1&kiosk`,"allowfullscreen",""],[1,"iframe-column"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/d57d13d8-5b6d-48e4-88fc-12d9d874e8dc/travels-kilometers?orgId=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/ba00627d-90a1-485c-a088-16a037d56c33/calories?orgId=1&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Vamos Medell\xEDn"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4),F(),O(6,"div",5),Te(7,"iframe",6)(8,"iframe",7),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:500px;border:none}.iframe-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.iframe-column[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var pg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-pqrsd"]],decls:25,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793439047&to=1740398239047&viewPanel=55&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793492783&to=1740398292783&viewPanel=56&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793532582&to=1740398332582&viewPanel=57&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793599303&to=1740398399303&viewPanel=75&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793702223&to=1740398502223&viewPanel=76&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739793898080&to=1740398698081&viewPanel=67&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794045244&to=1740398845245&viewPanel=69&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794083995&to=1740398883995&viewPanel=64&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794190362&to=1740398990362&viewPanel=72&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794256564&to=1740399056565&viewPanel=65&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/pq_ta/pqrsd?orgId=1&from=1739794325102&to=1740399125102&viewPanel=68&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Ciudad Inteligente - PQRSD"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),F(),O(7,"div",2),Te(8,"iframe",6),F(),O(9,"div",2),Te(10,"iframe",7),F(),O(11,"div",2),Te(12,"iframe",7),F(),O(13,"div",2),Te(14,"iframe",8),F(),O(15,"div",2),Te(16,"iframe",9),F(),O(17,"div",2),Te(18,"iframe",10),F(),O(19,"div",2),Te(20,"iframe",11),F(),O(21,"div",2),Te(22,"iframe",12),F(),O(23,"div",2),Te(24,"iframe",13),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:space-between}.iframe-row[_ngcontent-%COMP%]:first-child   iframe[_ngcontent-%COMP%]{flex:1}iframe[_ngcontent-%COMP%]{width:100%;height:400px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var mg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:7,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/wa_ta/whatsapp?orgId=1&from=1739548898783&to=1740153698783&viewPanel=5&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/wa_ta/whatsapp?orgId=1&from=1739548919606&to=1740153719607&viewPanel=8&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/wa_ta/whatsapp?orgId=1&from=1739542345631&to=1740147145631&viewPanel=6&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"WhatsApp"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var fg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:17,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708535530544&to=1740157930544&theme=light&viewPanel=17&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708535597310&to=1740157997310&theme=light&viewPanel=18&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708535622443&to=1740158022443&viewPanel=19&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536018076&to=1740158418076&viewPanel=22&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536115554&to=1740158515554&viewPanel=5&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536157330&to=1740158557330&viewPanel=13&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ta/turismo?orgId=1&var-menu=--Seleccionar--&from=1708536248147&to=1740158648147&viewPanel=14&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Turismo"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),F()(),O(7,"div",1),Te(8,"iframe",6),F(),O(9,"div",1),Te(10,"iframe",7),F(),O(11,"div",1),Te(12,"iframe",6),F(),O(13,"div",1),Te(14,"iframe",8),F(),O(15,"div",1),Te(16,"iframe",9),F())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var gg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:22,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739554343770&to=1740159143771&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739554430452&to=1740159230452&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739554718561&to=1740159518561&viewPanel=48&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739567093188&to=1740171893188&theme=light&viewPanel=49&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739567465205&to=1740172265205&viewPanel=45&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739567516412&to=1740172316412&viewPanel=34&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739568570628&to=1740173370628&viewPanel=35&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739568941480&to=1740173741480&viewPanel=36&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739653662249&to=1740258462249&viewPanel=37&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ta/siata?orgId=1&from=1739655373761&to=1740260173761&viewPanel=38&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Siata"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4),F()(),O(6,"div",1),Te(7,"iframe",5),F(),O(8,"div",1),Te(9,"iframe",6),F(),O(10,"div",1),Te(11,"iframe",7),F(),O(12,"div",1),Te(13,"iframe",8),F(),O(14,"div",1),Te(15,"iframe",9),F(),O(16,"div",1),Te(17,"iframe",10),F(),O(18,"div",1),Te(19,"iframe",11),F(),O(20,"div",1),Te(21,"iframe",12),F())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var _g=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:10,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740169770252&to=1740256170252&viewPanel=10&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740169943092&to=1740256343092&viewPanel=11&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740174676193&to=1740261076193&viewPanel=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/em_ma/emvarias-map?orgId=1&refresh=1m&var-barrios=--Seleccionar--&from=1740170890221&to=1740257290221&viewPanel=16&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Ciudad Inteligente - Camiones EMVARIAS"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4),F()(),O(6,"div",1),Te(7,"iframe",5),F(),O(8,"div",1),Te(9,"iframe",6),F())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}"]})};var yg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-camiones"]],decls:11,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674305894&to=1740279105894&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674463402&to=1740279263402&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674645460&to=1740279445460&viewPanel=9&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674694900&to=1740279494900&viewPanel=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/rm_ma/reportesmed-map?orgId=1&var-comunas=--Seleccionar--&from=1739674790949&to=1740279590950&viewPanel=6&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Ciudad Inteligente - Camiones EMVARIAS"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),F()(),O(7,"div",1),Te(8,"iframe",6),F(),O(9,"div",1),Te(10,"iframe",7),F())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}iframe[_ngcontent-%COMP%]{flex:1;height:400px;border:none}"]})};var yI=["*"];var vI=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],bI=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],xI=new ut("MAT_CARD_CONFIG"),oC=(()=>{class c{appearance;constructor(){let i=ge(xI,{optional:!0});this.appearance=i?.appearance||"raised"}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(l,h){l&2&&si("mat-mdc-card-outlined",h.appearance==="outlined")("mdc-card--outlined",h.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:yI,decls:1,vars:0,template:function(l,h){l&1&&(Fr(),Ni(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return c})(),sC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]})}return c})();var aC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return c})(),lC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]})}return c})();var cC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:bI,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(l,h){l&1&&(Fr(vI),Ni(0),O(1,"div",0),Ni(2,1),F(),Ni(3,2))},encapsulation:2,changeDetection:0})}return c})();var dC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn,hn]})}return c})();var Bu=class{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new qt;constructor(a=!1,i,l=!0,h){this._multiple=a,this._emitChanges=l,this.compareWith=h,i&&i.length&&(a?i.forEach(s=>this._markSelected(s)):this._markSelected(i[0]),this._selectedToEmit.length=0)}select(...a){this._verifyValueAssignment(a),a.forEach(l=>this._markSelected(l));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}deselect(...a){this._verifyValueAssignment(a),a.forEach(l=>this._unmarkSelected(l));let i=this._hasQueuedChanges();return this._emitChangeEvent(),i}setSelection(...a){this._verifyValueAssignment(a);let i=this.selected,l=new Set(a);a.forEach(s=>this._markSelected(s)),i.filter(s=>!l.has(this._getConcreteValue(s,l))).forEach(s=>this._unmarkSelected(s));let h=this._hasQueuedChanges();return this._emitChangeEvent(),h}toggle(a){return this.isSelected(a)?this.deselect(a):this.select(a)}clear(a=!0){this._unmarkAll();let i=this._hasQueuedChanges();return a&&this._emitChangeEvent(),i}isSelected(a){return this._selection.has(this._getConcreteValue(a))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(a){this._multiple&&this.selected&&this._selected.sort(a)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(a){a=this._getConcreteValue(a),this.isSelected(a)||(this._multiple||this._unmarkAll(),this.isSelected(a)||this._selection.add(a),this._emitChanges&&this._selectedToEmit.push(a))}_unmarkSelected(a){a=this._getConcreteValue(a),this.isSelected(a)&&(this._selection.delete(a),this._emitChanges&&this._deselectedToEmit.push(a))}_unmarkAll(){this.isEmpty()||this._selection.forEach(a=>this._unmarkSelected(a))}_verifyValueAssignment(a){a.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(a,i){if(this.compareWith){i=i??this._selection;for(let l of i)if(this.compareWith(a,l))return l;return a}else return a}};var CI=20,uC=(()=>{class c{_ngZone=ge(_i);_platform=ge(Sr);_document=ge(vi,{optional:!0});constructor(){}_scrolled=new qt;_globalSubscription=null;_scrolledCount=0;scrollContainers=new Map;register(i){this.scrollContainers.has(i)||this.scrollContainers.set(i,i.elementScrolled().subscribe(()=>this._scrolled.next(i)))}deregister(i){let l=this.scrollContainers.get(i);l&&(l.unsubscribe(),this.scrollContainers.delete(i))}scrolled(i=CI){return this._platform.isBrowser?new qa(l=>{this._globalSubscription||this._addGlobalListener();let h=i>0?this._scrolled.pipe(z_(i)).subscribe(l):this._scrolled.subscribe(l);return this._scrolledCount++,()=>{h.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):bt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((i,l)=>this.deregister(l)),this._scrolled.complete()}ancestorScrolled(i,l){let h=this.getAncestorScrollContainers(i);return this.scrolled(l).pipe(bn(s=>!s||h.indexOf(s)>-1))}getAncestorScrollContainers(i){let l=[];return this.scrollContainers.forEach((h,s)=>{this._scrollableContainsElement(s,i)&&l.push(s)}),l}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(i,l){let h=ol(l),s=i.getElementRef().nativeElement;do if(h==s)return!0;while(h=h.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let i=this._getWindow();return Zb(i.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var MI=20,qp=(()=>{class c{_platform=ge(Sr);_viewportSize;_change=new qt;_changeListener=i=>{this._change.next(i)};_document=ge(vi,{optional:!0});constructor(){ge(_i).runOutsideAngular(()=>{if(this._platform.isBrowser){let l=this._getWindow();l.addEventListener("resize",this._changeListener),l.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let i=this._getWindow();i.removeEventListener("resize",this._changeListener),i.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let i={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),i}getViewportRect(){let i=this.getViewportScrollPosition(),{width:l,height:h}=this.getViewportSize();return{top:i.top,left:i.left,bottom:i.top+h,right:i.left+l,height:h,width:l}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let i=this._document,l=this._getWindow(),h=i.documentElement,s=h.getBoundingClientRect(),P=-s.top||i.body.scrollTop||l.scrollY||h.scrollTop||0,q=-s.left||i.body.scrollLeft||l.scrollX||h.scrollLeft||0;return{top:P,left:q}}change(i=MI){return i>0?this._change.pipe(z_(i)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let i=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:i.innerWidth,height:i.innerHeight}:{width:0,height:0}}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var vg=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({})}return c})(),ky=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[lc,vg,lc,vg]})}return c})();var Xp=class{_attachedHost;attach(a){return this._attachedHost=a,a.attach(this)}detach(){let a=this._attachedHost;a!=null&&(this._attachedHost=null,a.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(a){this._attachedHost=a}},Ay=class extends Xp{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(a,i,l,h,s){super(),this.component=a,this.viewContainerRef=i,this.injector=l,this.projectableNodes=s}},Yp=class extends Xp{templateRef;viewContainerRef;context;injector;constructor(a,i,l,h){super(),this.templateRef=a,this.viewContainerRef=i,this.context=l,this.injector=h}get origin(){return this.templateRef.elementRef}attach(a,i=this.context){return this.context=i,super.attach(a)}detach(){return this.context=void 0,super.detach()}},Dy=class extends Xp{element;constructor(a){super(),this.element=a instanceof Si?a.nativeElement:a}},Ry=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(a){if(a instanceof Ay)return this._attachedPortal=a,this.attachComponentPortal(a);if(a instanceof Yp)return this._attachedPortal=a,this.attachTemplatePortal(a);if(this.attachDomPortal&&a instanceof Dy)return this._attachedPortal=a,this.attachDomPortal(a)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(a){this._disposeFn=a}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var bg=class extends Ry{outletElement;_appRef;_defaultInjector;_document;constructor(a,i,l,h,s){super(),this.outletElement=a,this._appRef=l,this._defaultInjector=h,this._document=s}attachComponentPortal(a){let i;if(a.viewContainerRef){let l=a.injector||a.viewContainerRef.injector,h=l.get(px,null,{optional:!0})||void 0;i=a.viewContainerRef.createComponent(a.component,{index:a.viewContainerRef.length,injector:l,ngModuleRef:h,projectableNodes:a.projectableNodes||void 0}),this.setDisposeFn(()=>i.destroy())}else i=qm(a.component,{elementInjector:a.injector||this._defaultInjector||Or.NULL,environmentInjector:this._appRef.injector,projectableNodes:a.projectableNodes||void 0}),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(i.hostView),i.destroy()});return this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=a,i}attachTemplatePortal(a){let i=a.viewContainerRef,l=i.createEmbeddedView(a.templateRef,a.context,{injector:a.injector});return l.rootNodes.forEach(h=>this.outletElement.appendChild(h)),l.detectChanges(),this.setDisposeFn(()=>{let h=i.indexOf(l);h!==-1&&i.remove(h)}),this._attachedPortal=a,l}attachDomPortal=a=>{let i=a.element;i.parentNode;let l=this._document.createComment("dom-portal");i.parentNode.insertBefore(l,i),this.outletElement.appendChild(i),this._attachedPortal=a,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(i,l)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(a){return a.hostView.rootNodes[0]}};var hC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({})}return c})();var pC=dy(),Oy=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(a,i){this._viewportRuler=a,this._document=i}attach(){}enable(){if(this._canBeEnabled()){let a=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=a.style.left||"",this._previousHTMLStyles.top=a.style.top||"",a.style.left=On(-this._previousScrollPosition.left),a.style.top=On(-this._previousScrollPosition.top),a.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let a=this._document.documentElement,i=this._document.body,l=a.style,h=i.style,s=l.scrollBehavior||"",P=h.scrollBehavior||"";this._isEnabled=!1,l.left=this._previousHTMLStyles.left,l.top=this._previousHTMLStyles.top,a.classList.remove("cdk-global-scrollblock"),pC&&(l.scrollBehavior=h.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),pC&&(l.scrollBehavior=s,h.scrollBehavior=P)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let i=this._document.body,l=this._viewportRuler.getViewportSize();return i.scrollHeight>l.height||i.scrollWidth>l.width}};var Fy=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(a,i,l,h){this._scrollDispatcher=a,this._ngZone=i,this._viewportRuler=l,this._config=h}attach(a){this._overlayRef,this._overlayRef=a}enable(){if(this._scrollSubscription)return;let a=this._scrollDispatcher.scrolled(0).pipe(bn(i=>!i||!this._overlayRef.overlayElement.contains(i.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=a.subscribe(()=>{let i=this._viewportRuler.getViewportScrollPosition().top;Math.abs(i-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=a.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}},xg=class{enable(){}disable(){}attach(){}};function Ly(c,a){return a.some(i=>{let l=c.bottom<i.top,h=c.top>i.bottom,s=c.right<i.left,P=c.left>i.right;return l||h||s||P})}function mC(c,a){return a.some(i=>{let l=c.top<i.top,h=c.bottom>i.bottom,s=c.left<i.left,P=c.right>i.right;return l||h||s||P})}var zy=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(a,i,l,h){this._scrollDispatcher=a,this._viewportRuler=i,this._ngZone=l,this._config=h}attach(a){this._overlayRef,this._overlayRef=a}enable(){if(!this._scrollSubscription){let a=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(a).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let i=this._overlayRef.overlayElement.getBoundingClientRect(),{width:l,height:h}=this._viewportRuler.getViewportSize();Ly(i,[{width:l,height:h,bottom:h,right:l,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},PI=(()=>{class c{_scrollDispatcher=ge(uC);_viewportRuler=ge(qp);_ngZone=ge(_i);_document=ge(vi);constructor(){}noop=()=>new xg;close=i=>new Fy(this._scrollDispatcher,this._ngZone,this._viewportRuler,i);block=()=>new Oy(this._viewportRuler,this._document);reposition=i=>new zy(this._scrollDispatcher,this._viewportRuler,this._ngZone,i);static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),wg=class{positionStrategy;scrollStrategy=new xg;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(a){if(a){let i=Object.keys(a);for(let l of i)a[l]!==void 0&&(this[l]=a[l])}}};var By=class{connectionPair;scrollableViewProperties;constructor(a,i){this.connectionPair=a,this.scrollableViewProperties=i}};var bC=(()=>{class c{_attachedOverlays=[];_document=ge(vi);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(i){this.remove(i),this._attachedOverlays.push(i)}remove(i){let l=this._attachedOverlays.indexOf(i);l>-1&&this._attachedOverlays.splice(l,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),EI=(()=>{class c extends bC{_ngZone=ge(_i,{optional:!0});add(i){super.add(i),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}_keydownListener=i=>{let l=this._attachedOverlays;for(let h=l.length-1;h>-1;h--)if(l[h]._keydownEvents.observers.length>0){let s=l[h]._keydownEvents;this._ngZone?this._ngZone.run(()=>s.next(i)):s.next(i);break}};static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),TI=(()=>{class c extends bC{_platform=ge(Sr);_ngZone=ge(_i,{optional:!0});_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;add(i){if(super.add(i),!this._isAttached){let l=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(l)):this._addEventListeners(l),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=l.style.cursor,l.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let i=this._document.body;i.removeEventListener("pointerdown",this._pointerDownListener,!0),i.removeEventListener("click",this._clickListener,!0),i.removeEventListener("auxclick",this._clickListener,!0),i.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(i.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(i){i.addEventListener("pointerdown",this._pointerDownListener,!0),i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0)}_pointerDownListener=i=>{this._pointerDownEventTarget=es(i)};_clickListener=i=>{let l=es(i),h=i.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:l;this._pointerDownEventTarget=null;let s=this._attachedOverlays.slice();for(let P=s.length-1;P>-1;P--){let q=s[P];if(q._outsidePointerEvents.observers.length<1||!q.hasAttached())continue;if(fC(q.overlayElement,l)||fC(q.overlayElement,h))break;let X=q._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>X.next(i)):X.next(i)}};static \u0275fac=(()=>{let i;return function(h){return(i||(i=Yo(c)))(h||c)}})();static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function fC(c,a){let i=typeof ShadowRoot<"u"&&ShadowRoot,l=a;for(;l;){if(l===c)return!0;l=i&&l instanceof ShadowRoot?l.host:l.parentNode}return!1}var xC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(l,h){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}"],encapsulation:2,changeDetection:0})}return c})(),wC=(()=>{class c{_platform=ge(Sr);_containerElement;_document=ge(vi);_styleLoader=ge(nl);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let i="cdk-overlay-container";if(this._platform.isBrowser||uy()){let h=this._document.querySelectorAll(`.${i}[platform="server"], .${i}[platform="test"]`);for(let s=0;s<h.length;s++)h[s].remove()}let l=this._document.createElement("div");l.classList.add(i),uy()?l.setAttribute("platform","test"):this._platform.isBrowser||l.setAttribute("platform","server"),this._document.body.appendChild(l),this._containerElement=l}_loadStyles(){this._styleLoader.load(xC)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),Ny=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_backdropElement=null;_backdropTimeout;_backdropClick=new qt;_attachments=new qt;_detachments=new qt;_positionStrategy;_scrollStrategy;_locationChanges=Rr.EMPTY;_backdropClickHandler=a=>this._backdropClick.next(a);_backdropTransitionendHandler=a=>{this._disposeBackdrop(a.target)};_previousHostParent;_keydownEvents=new qt;_outsidePointerEvents=new qt;_renders=new qt;_afterRenderRef;_afterNextRenderRef;constructor(a,i,l,h,s,P,q,X,be,ve=!1,$){this._portalOutlet=a,this._host=i,this._pane=l,this._config=h,this._ngZone=s,this._keyboardDispatcher=P,this._document=q,this._location=X,this._outsideClickDispatcher=be,this._animationsDisabled=ve,this._injector=$,h.scrollStrategy&&(this._scrollStrategy=h.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=h.positionStrategy,this._afterRenderRef=Es(()=>Bm(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(a){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let i=this._portalOutlet.attach(a);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=au(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof i?.onDestroy=="function"&&i.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),i}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let a=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),a}dispose(){let a=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,a&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(a){a!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=a,this.hasAttached()&&(a.attach(this),this.updatePosition()))}updateSize(a){this._config=Qe(Qe({},this._config),a),this._updateElementSize()}setDirection(a){this._config=di(Qe({},this._config),{direction:a}),this._updateElementDirection()}addPanelClass(a){this._pane&&this._toggleClasses(this._pane,a,!0)}removePanelClass(a){this._pane&&this._toggleClasses(this._pane,a,!1)}getDirection(){let a=this._config.direction;return a?typeof a=="string"?a:a.value:"ltr"}updateScrollStrategy(a){a!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=a,this.hasAttached()&&(a.attach(this),a.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let a=this._pane.style;a.width=On(this._config.width),a.height=On(this._config.height),a.minWidth=On(this._config.minWidth),a.minHeight=On(this._config.minHeight),a.maxWidth=On(this._config.maxWidth),a.maxHeight=On(this._config.maxHeight)}_togglePointerEvents(a){this._pane.style.pointerEvents=a?"":"none"}_attachBackdrop(){let a="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(a)})}):this._backdropElement.classList.add(a)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let a=this._backdropElement;if(a){if(this._animationsDisabled){this._disposeBackdrop(a);return}a.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{a.addEventListener("transitionend",this._backdropTransitionendHandler)}),a.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(a)},500))}}_toggleClasses(a,i,l){let h=Ou(i||[]).filter(s=>!!s);h.length&&(l?a.classList.add(...h):a.classList.remove(...h))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let a=this._renders.pipe(Rn(Wl(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),a.unsubscribe())})})}_disposeScrollStrategy(){let a=this._scrollStrategy;a&&(a.disable(),a.detach&&a.detach())}_disposeBackdrop(a){a&&(a.removeEventListener("click",this._backdropClickHandler),a.removeEventListener("transitionend",this._backdropTransitionendHandler),a.remove(),this._backdropElement===a&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},gC="cdk-overlay-connected-position-bounding-box",II=/([A-Za-z%]+)$/,Vy=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new qt;_resizeSubscription=Rr.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(a,i,l,h,s){this._viewportRuler=i,this._document=l,this._platform=h,this._overlayContainer=s,this.setOrigin(a)}attach(a){this._overlayRef&&this._overlayRef,this._validatePositions(),a.hostElement.classList.add(gC),this._overlayRef=a,this._boundingBox=a.hostElement,this._pane=a.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let a=this._originRect,i=this._overlayRect,l=this._viewportRect,h=this._containerRect,s=[],P;for(let q of this._preferredPositions){let X=this._getOriginPoint(a,h,q),be=this._getOverlayPoint(X,i,q),ve=this._getOverlayFit(be,i,l,q);if(ve.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(q,X);return}if(this._canFitWithFlexibleDimensions(ve,be,l)){s.push({position:q,origin:X,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(X,q)});continue}(!P||P.overlayFit.visibleArea<ve.visibleArea)&&(P={overlayFit:ve,overlayPoint:be,originPoint:X,position:q,overlayRect:i})}if(s.length){let q=null,X=-1;for(let be of s){let ve=be.boundingBoxRect.width*be.boundingBoxRect.height*(be.position.weight||1);ve>X&&(X=ve,q=be)}this._isPushed=!1,this._applyPosition(q.position,q.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(P.position,P.originPoint);return}this._applyPosition(P.position,P.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&dd(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(gC),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let a=this._lastPosition;if(a){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._getOriginPoint(this._originRect,this._containerRect,a);this._applyPosition(a,i)}else this.apply()}withScrollableContainers(a){return this._scrollables=a,this}withPositions(a){return this._preferredPositions=a,a.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(a){return this._viewportMargin=a,this}withFlexibleDimensions(a=!0){return this._hasFlexibleDimensions=a,this}withGrowAfterOpen(a=!0){return this._growAfterOpen=a,this}withPush(a=!0){return this._canPush=a,this}withLockedPosition(a=!0){return this._positionLocked=a,this}setOrigin(a){return this._origin=a,this}withDefaultOffsetX(a){return this._offsetX=a,this}withDefaultOffsetY(a){return this._offsetY=a,this}withTransformOriginOn(a){return this._transformOriginSelector=a,this}_getOriginPoint(a,i,l){let h;if(l.originX=="center")h=a.left+a.width/2;else{let P=this._isRtl()?a.right:a.left,q=this._isRtl()?a.left:a.right;h=l.originX=="start"?P:q}i.left<0&&(h-=i.left);let s;return l.originY=="center"?s=a.top+a.height/2:s=l.originY=="top"?a.top:a.bottom,i.top<0&&(s-=i.top),{x:h,y:s}}_getOverlayPoint(a,i,l){let h;l.overlayX=="center"?h=-i.width/2:l.overlayX==="start"?h=this._isRtl()?-i.width:0:h=this._isRtl()?0:-i.width;let s;return l.overlayY=="center"?s=-i.height/2:s=l.overlayY=="top"?0:-i.height,{x:a.x+h,y:a.y+s}}_getOverlayFit(a,i,l,h){let s=yC(i),{x:P,y:q}=a,X=this._getOffset(h,"x"),be=this._getOffset(h,"y");X&&(P+=X),be&&(q+=be);let ve=0-P,$=P+s.width-l.width,$e=0-q,ht=q+s.height-l.height,wt=this._subtractOverflows(s.width,ve,$),lt=this._subtractOverflows(s.height,$e,ht),at=wt*lt;return{visibleArea:at,isCompletelyWithinViewport:s.width*s.height===at,fitsInViewportVertically:lt===s.height,fitsInViewportHorizontally:wt==s.width}}_canFitWithFlexibleDimensions(a,i,l){if(this._hasFlexibleDimensions){let h=l.bottom-i.y,s=l.right-i.x,P=_C(this._overlayRef.getConfig().minHeight),q=_C(this._overlayRef.getConfig().minWidth),X=a.fitsInViewportVertically||P!=null&&P<=h,be=a.fitsInViewportHorizontally||q!=null&&q<=s;return X&&be}return!1}_pushOverlayOnScreen(a,i,l){if(this._previousPushAmount&&this._positionLocked)return{x:a.x+this._previousPushAmount.x,y:a.y+this._previousPushAmount.y};let h=yC(i),s=this._viewportRect,P=Math.max(a.x+h.width-s.width,0),q=Math.max(a.y+h.height-s.height,0),X=Math.max(s.top-l.top-a.y,0),be=Math.max(s.left-l.left-a.x,0),ve=0,$=0;return h.width<=s.width?ve=be||-P:ve=a.x<this._viewportMargin?s.left-l.left-a.x:0,h.height<=s.height?$=X||-q:$=a.y<this._viewportMargin?s.top-l.top-a.y:0,this._previousPushAmount={x:ve,y:$},{x:a.x+ve,y:a.y+$}}_applyPosition(a,i){if(this._setTransformOrigin(a),this._setOverlayElementStyles(i,a),this._setBoundingBoxStyles(i,a),a.panelClass&&this._addPanelClasses(a.panelClass),this._positionChanges.observers.length){let l=this._getScrollVisibility();if(a!==this._lastPosition||!this._lastScrollVisibility||!kI(this._lastScrollVisibility,l)){let h=new By(a,l);this._positionChanges.next(h)}this._lastScrollVisibility=l}this._lastPosition=a,this._isInitialRender=!1}_setTransformOrigin(a){if(!this._transformOriginSelector)return;let i=this._boundingBox.querySelectorAll(this._transformOriginSelector),l,h=a.overlayY;a.overlayX==="center"?l="center":this._isRtl()?l=a.overlayX==="start"?"right":"left":l=a.overlayX==="start"?"left":"right";for(let s=0;s<i.length;s++)i[s].style.transformOrigin=`${l} ${h}`}_calculateBoundingBoxRect(a,i){let l=this._viewportRect,h=this._isRtl(),s,P,q;if(i.overlayY==="top")P=a.y,s=l.height-P+this._viewportMargin;else if(i.overlayY==="bottom")q=l.height-a.y+this._viewportMargin*2,s=l.height-q+this._viewportMargin;else{let ht=Math.min(l.bottom-a.y+l.top,a.y),wt=this._lastBoundingBoxSize.height;s=ht*2,P=a.y-ht,s>wt&&!this._isInitialRender&&!this._growAfterOpen&&(P=a.y-wt/2)}let X=i.overlayX==="start"&&!h||i.overlayX==="end"&&h,be=i.overlayX==="end"&&!h||i.overlayX==="start"&&h,ve,$,$e;if(be)$e=l.width-a.x+this._viewportMargin*2,ve=a.x-this._viewportMargin;else if(X)$=a.x,ve=l.right-a.x;else{let ht=Math.min(l.right-a.x+l.left,a.x),wt=this._lastBoundingBoxSize.width;ve=ht*2,$=a.x-ht,ve>wt&&!this._isInitialRender&&!this._growAfterOpen&&($=a.x-wt/2)}return{top:P,left:$,bottom:q,right:$e,width:ve,height:s}}_setBoundingBoxStyles(a,i){let l=this._calculateBoundingBoxRect(a,i);!this._isInitialRender&&!this._growAfterOpen&&(l.height=Math.min(l.height,this._lastBoundingBoxSize.height),l.width=Math.min(l.width,this._lastBoundingBoxSize.width));let h={};if(this._hasExactPosition())h.top=h.left="0",h.bottom=h.right=h.maxHeight=h.maxWidth="",h.width=h.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,P=this._overlayRef.getConfig().maxWidth;h.height=On(l.height),h.top=On(l.top),h.bottom=On(l.bottom),h.width=On(l.width),h.left=On(l.left),h.right=On(l.right),i.overlayX==="center"?h.alignItems="center":h.alignItems=i.overlayX==="end"?"flex-end":"flex-start",i.overlayY==="center"?h.justifyContent="center":h.justifyContent=i.overlayY==="bottom"?"flex-end":"flex-start",s&&(h.maxHeight=On(s)),P&&(h.maxWidth=On(P))}this._lastBoundingBoxSize=l,dd(this._boundingBox.style,h)}_resetBoundingBoxStyles(){dd(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){dd(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(a,i){let l={},h=this._hasExactPosition(),s=this._hasFlexibleDimensions,P=this._overlayRef.getConfig();if(h){let ve=this._viewportRuler.getViewportScrollPosition();dd(l,this._getExactOverlayY(i,a,ve)),dd(l,this._getExactOverlayX(i,a,ve))}else l.position="static";let q="",X=this._getOffset(i,"x"),be=this._getOffset(i,"y");X&&(q+=`translateX(${X}px) `),be&&(q+=`translateY(${be}px)`),l.transform=q.trim(),P.maxHeight&&(h?l.maxHeight=On(P.maxHeight):s&&(l.maxHeight="")),P.maxWidth&&(h?l.maxWidth=On(P.maxWidth):s&&(l.maxWidth="")),dd(this._pane.style,l)}_getExactOverlayY(a,i,l){let h={top:"",bottom:""},s=this._getOverlayPoint(i,this._overlayRect,a);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,l)),a.overlayY==="bottom"){let P=this._document.documentElement.clientHeight;h.bottom=`${P-(s.y+this._overlayRect.height)}px`}else h.top=On(s.y);return h}_getExactOverlayX(a,i,l){let h={left:"",right:""},s=this._getOverlayPoint(i,this._overlayRect,a);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,l));let P;if(this._isRtl()?P=a.overlayX==="end"?"left":"right":P=a.overlayX==="end"?"right":"left",P==="right"){let q=this._document.documentElement.clientWidth;h.right=`${q-(s.x+this._overlayRect.width)}px`}else h.left=On(s.x);return h}_getScrollVisibility(){let a=this._getOriginRect(),i=this._pane.getBoundingClientRect(),l=this._scrollables.map(h=>h.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:mC(a,l),isOriginOutsideView:Ly(a,l),isOverlayClipped:mC(i,l),isOverlayOutsideView:Ly(i,l)}}_subtractOverflows(a,...i){return i.reduce((l,h)=>l-Math.max(h,0),a)}_getNarrowedViewportRect(){let a=this._document.documentElement.clientWidth,i=this._document.documentElement.clientHeight,l=this._viewportRuler.getViewportScrollPosition();return{top:l.top+this._viewportMargin,left:l.left+this._viewportMargin,right:l.left+a-this._viewportMargin,bottom:l.top+i-this._viewportMargin,width:a-2*this._viewportMargin,height:i-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(a,i){return i==="x"?a.offsetX==null?this._offsetX:a.offsetX:a.offsetY==null?this._offsetY:a.offsetY}_validatePositions(){}_addPanelClasses(a){this._pane&&Ou(a).forEach(i=>{i!==""&&this._appliedPanelClasses.indexOf(i)===-1&&(this._appliedPanelClasses.push(i),this._pane.classList.add(i))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(a=>{this._pane.classList.remove(a)}),this._appliedPanelClasses=[])}_getOriginRect(){let a=this._origin;if(a instanceof Si)return a.nativeElement.getBoundingClientRect();if(a instanceof Element)return a.getBoundingClientRect();let i=a.width||0,l=a.height||0;return{top:a.y,bottom:a.y+l,left:a.x,right:a.x+i,height:l,width:i}}};function dd(c,a){for(let i in a)a.hasOwnProperty(i)&&(c[i]=a[i]);return c}function _C(c){if(typeof c!="number"&&c!=null){let[a,i]=c.split(II);return!i||i==="px"?parseFloat(a):null}return c||null}function yC(c){return{top:Math.floor(c.top),right:Math.floor(c.right),bottom:Math.floor(c.bottom),left:Math.floor(c.left),width:Math.floor(c.width),height:Math.floor(c.height)}}function kI(c,a){return c===a?!0:c.isOriginClipped===a.isOriginClipped&&c.isOriginOutsideView===a.isOriginOutsideView&&c.isOverlayClipped===a.isOverlayClipped&&c.isOverlayOutsideView===a.isOverlayOutsideView}var vC="cdk-global-overlay-wrapper",jy=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(a){let i=a.getConfig();this._overlayRef=a,this._width&&!i.width&&a.updateSize({width:this._width}),this._height&&!i.height&&a.updateSize({height:this._height}),a.hostElement.classList.add(vC),this._isDisposed=!1}top(a=""){return this._bottomOffset="",this._topOffset=a,this._alignItems="flex-start",this}left(a=""){return this._xOffset=a,this._xPosition="left",this}bottom(a=""){return this._topOffset="",this._bottomOffset=a,this._alignItems="flex-end",this}right(a=""){return this._xOffset=a,this._xPosition="right",this}start(a=""){return this._xOffset=a,this._xPosition="start",this}end(a=""){return this._xOffset=a,this._xPosition="end",this}width(a=""){return this._overlayRef?this._overlayRef.updateSize({width:a}):this._width=a,this}height(a=""){return this._overlayRef?this._overlayRef.updateSize({height:a}):this._height=a,this}centerHorizontally(a=""){return this.left(a),this._xPosition="center",this}centerVertically(a=""){return this.top(a),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let a=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement.style,l=this._overlayRef.getConfig(),{width:h,height:s,maxWidth:P,maxHeight:q}=l,X=(h==="100%"||h==="100vw")&&(!P||P==="100%"||P==="100vw"),be=(s==="100%"||s==="100vh")&&(!q||q==="100%"||q==="100vh"),ve=this._xPosition,$=this._xOffset,$e=this._overlayRef.getConfig().direction==="rtl",ht="",wt="",lt="";X?lt="flex-start":ve==="center"?(lt="center",$e?wt=$:ht=$):$e?ve==="left"||ve==="end"?(lt="flex-end",ht=$):(ve==="right"||ve==="start")&&(lt="flex-start",wt=$):ve==="left"||ve==="start"?(lt="flex-start",ht=$):(ve==="right"||ve==="end")&&(lt="flex-end",wt=$),a.position=this._cssPosition,a.marginLeft=X?"0":ht,a.marginTop=be?"0":this._topOffset,a.marginBottom=this._bottomOffset,a.marginRight=X?"0":wt,i.justifyContent=lt,i.alignItems=be?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let a=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement,l=i.style;i.classList.remove(vC),l.justifyContent=l.alignItems=a.marginTop=a.marginBottom=a.marginLeft=a.marginRight=a.position="",this._overlayRef=null,this._isDisposed=!0}},AI=(()=>{class c{_viewportRuler=ge(qp);_document=ge(vi);_platform=ge(Sr);_overlayContainer=ge(wC);constructor(){}global(){return new jy}flexibleConnectedTo(i){return new Vy(i,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),ud=(()=>{class c{scrollStrategies=ge(PI);_overlayContainer=ge(wC);_positionBuilder=ge(AI);_keyboardDispatcher=ge(EI);_injector=ge(Or);_ngZone=ge(_i);_document=ge(vi);_directionality=ge(ua);_location=ge(ed);_outsideClickDispatcher=ge(TI);_animationsModuleType=ge(Io,{optional:!0});_idGenerator=ge(ts);_appRef;_styleLoader=ge(nl);constructor(){}create(i){this._styleLoader.load(xC);let l=this._createHostElement(),h=this._createPaneElement(l),s=this._createPortalOutlet(h),P=new wg(i);return P.direction=P.direction||this._directionality.value,new Ny(s,l,h,P,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(Ss))}position(){return this._positionBuilder}_createPaneElement(i){let l=this._document.createElement("div");return l.id=this._idGenerator.getId("cdk-overlay-"),l.classList.add("cdk-overlay-pane"),i.appendChild(l),l}_createHostElement(){let i=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalOutlet(i){return this._appRef||(this._appRef=this._injector.get(Kl)),new bg(i,null,this._appRef,this._injector,this._document)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})(),DI=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],CC=new ut("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let c=ge(ud);return()=>c.scrollStrategies.reposition()}}),Kp=(()=>{class c{elementRef=ge(Si);constructor(){}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]})}return c})(),Uy=(()=>{class c{_overlay=ge(ud);_dir=ge(ua,{optional:!0});_overlayRef;_templatePortal;_backdropSubscription=Rr.EMPTY;_attachSubscription=Rr.EMPTY;_detachSubscription=Rr.EMPTY;_positionSubscription=Rr.EMPTY;_offsetX;_offsetY;_position;_scrollStrategyFactory=ge(CC);_disposeOnNavigation=!1;_ngZone=ge(_i);origin;positions;positionStrategy;get offsetX(){return this._offsetX}set offsetX(i){this._offsetX=i,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(i){this._offsetY=i,this._position&&this._updatePositionStrategy(this._position)}width;height;minWidth;minHeight;backdropClass;panelClass;viewportMargin=0;scrollStrategy;open=!1;disableClose=!1;transformOriginSelector;hasBackdrop=!1;lockPosition=!1;flexibleDimensions=!1;growAfterOpen=!1;push=!1;get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(i){this._disposeOnNavigation=i}backdropClick=new oi;positionChange=new oi;attach=new oi;detach=new oi;overlayKeydown=new oi;overlayOutsideClick=new oi;constructor(){let i=ge(Vm),l=ge(uu);this._templatePortal=new Yp(i,l),this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(i){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),i.origin&&this.open&&this._position.apply()),i.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=DI);let i=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=i.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=i.detachments().subscribe(()=>this.detach.emit()),i.keydownEvents().subscribe(l=>{this.overlayKeydown.next(l),l.keyCode===27&&!this.disableClose&&!rl(l)&&(l.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(l=>{let h=this._getOriginElement(),s=es(l);(!h||h!==s&&!h.contains(s))&&this.overlayOutsideClick.next(l)})}_buildConfig(){let i=this._position=this.positionStrategy||this._createPositionStrategy(),l=new wg({direction:this._dir||"ltr",positionStrategy:i,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||this.width===0)&&(l.width=this.width),(this.height||this.height===0)&&(l.height=this.height),(this.minWidth||this.minWidth===0)&&(l.minWidth=this.minWidth),(this.minHeight||this.minHeight===0)&&(l.minHeight=this.minHeight),this.backdropClass&&(l.backdropClass=this.backdropClass),this.panelClass&&(l.panelClass=this.panelClass),l}_updatePositionStrategy(i){let l=this.positions.map(h=>({originX:h.originX,originY:h.originY,overlayX:h.overlayX,overlayY:h.overlayY,offsetX:h.offsetX||this.offsetX,offsetY:h.offsetY||this.offsetY,panelClass:h.panelClass||void 0}));return i.setOrigin(this._getOrigin()).withPositions(l).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){let i=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(i),i}_getOrigin(){return this.origin instanceof Kp?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof Kp?this.origin.elementRef.nativeElement:this.origin instanceof Si?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(i=>{this.backdropClick.emit(i)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(Kb(()=>this.positionChange.observers.length>0)).subscribe(i=>{this._ngZone.run(()=>this.positionChange.emit(i)),this.positionChange.observers.length===0&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",yi],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",yi],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",yi],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",yi],push:[2,"cdkConnectedOverlayPush","push",yi],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",yi]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[hr,ao]})}return c})();function RI(c){return()=>c.scrollStrategies.reposition()}var OI={provide:CC,deps:[ud],useFactory:RI},MC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({providers:[ud,OI],imports:[lc,hC,ky,ky]})}return c})();var $y=class{_box;_destroyed=new qt;_resizeSubject=new qt;_resizeObserver;_elementObservables=new Map;constructor(a){this._box=a,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(i=>this._resizeSubject.next(i)))}observe(a){return this._elementObservables.has(a)||this._elementObservables.set(a,new qa(i=>{let l=this._resizeSubject.subscribe(i);return this._resizeObserver?.observe(a,{box:this._box}),()=>{this._resizeObserver?.unobserve(a),l.unsubscribe(),this._elementObservables.delete(a)}}).pipe(bn(i=>i.some(l=>l.target===a)),j_({bufferSize:1,refCount:!0}),Rn(this._destroyed))),this._elementObservables.get(a)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},SC=(()=>{class c{_observers=new Map;_ngZone=ge(_i);constructor(){typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,i]of this._observers)i.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(i,l){let h=l?.box||"content-box";return this._observers.has(h)||this._observers.set(h,new $y(h)),this._observers.get(h).observe(i)}static \u0275fac=function(l){return new(l||c)};static \u0275prov=st({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var FI=["notch"],LI=["matFormFieldNotchedOutline",""],zI=["*"],BI=["textField"],NI=["iconPrefixContainer"],VI=["textPrefixContainer"],jI=["iconSuffixContainer"],UI=["textSuffixContainer"],$I=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],GI=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function HI(c,a){c&1&&Te(0,"span",21)}function ZI(c,a){if(c&1&&(O(0,"label",20),Ni(1,1),Xe(2,HI,1,0,"span",21),F()),c&2){let i=ze(2);Oe("floating",i._shouldLabelFloat())("monitorResize",i._hasOutline())("id",i._labelId),Ri("for",i._control.disableAutomaticLabeling?null:i._control.id),re(2),an(!i.hideRequiredMarker&&i._control.required?2:-1)}}function WI(c,a){if(c&1&&Xe(0,ZI,3,5,"label",20),c&2){let i=ze();an(i._hasFloatingLabel()?0:-1)}}function qI(c,a){c&1&&Te(0,"div",7)}function XI(c,a){}function YI(c,a){if(c&1&&Xe(0,XI,0,0,"ng-template",13),c&2){ze(2);let i=cn(1);Oe("ngTemplateOutlet",i)}}function KI(c,a){if(c&1&&(O(0,"div",9),Xe(1,YI,1,1,null,13),F()),c&2){let i=ze();Oe("matFormFieldNotchedOutlineOpen",i._shouldLabelFloat()),re(),an(i._forceDisplayInfixLabel()?-1:1)}}function QI(c,a){c&1&&(O(0,"div",10,2),Ni(2,2),F())}function JI(c,a){c&1&&(O(0,"div",11,3),Ni(2,3),F())}function ek(c,a){}function tk(c,a){if(c&1&&Xe(0,ek,0,0,"ng-template",13),c&2){ze();let i=cn(1);Oe("ngTemplateOutlet",i)}}function ik(c,a){c&1&&(O(0,"div",14,4),Ni(2,4),F())}function nk(c,a){c&1&&(O(0,"div",15,5),Ni(2,5),F())}function rk(c,a){c&1&&Te(0,"div",16)}function ok(c,a){if(c&1&&(O(0,"div",18),Ni(1,6),F()),c&2){let i=ze();Oe("@transitionMessages",i._subscriptAnimationState)}}function sk(c,a){if(c&1&&(O(0,"mat-hint",22),Y(1),F()),c&2){let i=ze(2);Oe("id",i._hintLabelId),re(),St(i.hintLabel)}}function ak(c,a){if(c&1&&(O(0,"div",19),Xe(1,sk,2,2,"mat-hint",22),Ni(2,7),Te(3,"div",23),Ni(4,8),F()),c&2){let i=ze();Oe("@transitionMessages",i._subscriptAnimationState),re(),an(i.hintLabel?1:-1)}}var Mg=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["mat-label"]]})}return c})(),lk=new ut("MatError");var PC=(()=>{class c{align="start";id=ge(ts).getId("mat-mdc-hint-");static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(l,h){l&2&&(Zm("id",h.id),Ri("align",null),si("mat-mdc-form-field-hint-end",h.align==="end"))},inputs:{align:"align",id:"id"}})}return c})(),ck=new ut("MatPrefix");var dk=new ut("MatSuffix");var RC=new ut("FloatingLabelParent"),EC=(()=>{class c{_elementRef=ge(Si);get floating(){return this._floating}set floating(i){this._floating=i,this.monitorResize&&this._handleResize()}_floating=!1;get monitorResize(){return this._monitorResize}set monitorResize(i){this._monitorResize=i,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}_monitorResize=!1;_resizeObserver=ge(SC);_ngZone=ge(_i);_parent=ge(RC);_resizeSubscription=new Rr;constructor(){}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return uk(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(l,h){l&2&&si("mdc-floating-label--float-above",h.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return c})();function uk(c){let a=c;if(a.offsetParent!==null)return a.scrollWidth;let i=a.cloneNode(!0);i.style.setProperty("position","absolute"),i.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(i);let l=i.scrollWidth;return i.remove(),l}var TC="mdc-line-ripple--active",Cg="mdc-line-ripple--deactivating",IC=(()=>{class c{_elementRef=ge(Si);constructor(){ge(_i).runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let i=this._elementRef.nativeElement.classList;i.remove(Cg),i.add(TC)}deactivate(){this._elementRef.nativeElement.classList.add(Cg)}_handleTransitionEnd=i=>{let l=this._elementRef.nativeElement.classList,h=l.contains(Cg);i.propertyName==="opacity"&&h&&l.remove(TC,Cg)};ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return c})(),kC=(()=>{class c{_elementRef=ge(Si);_ngZone=ge(_i);open=!1;_notch;constructor(){}ngAfterViewInit(){let i=this._elementRef.nativeElement.querySelector(".mdc-floating-label");i?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(i.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>i.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(i){!this.open||!i?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${i}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(l,h){if(l&1&&ln(FI,5),l&2){let s;wi(s=Ci())&&(h._notch=s.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(l,h){l&2&&si("mdc-notched-outline--notched",h.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},attrs:LI,ngContentSelectors:zI,decls:5,vars:0,consts:[["notch",""],[1,"mat-mdc-notch-piece","mdc-notched-outline__leading"],[1,"mat-mdc-notch-piece","mdc-notched-outline__notch"],[1,"mat-mdc-notch-piece","mdc-notched-outline__trailing"]],template:function(l,h){l&1&&(Fr(),Te(0,"div",1),O(1,"div",2,0),Ni(3),F(),Te(4,"div",3))},encapsulation:2,changeDetection:0})}return c})(),hk={transitionMessages:Yh("transitionMessages",[tf("enter",td({opacity:1,transform:"translateY(0%)"})),mu("void => enter",[td({opacity:0,transform:"translateY(-5px)"}),Kh("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},Gy=(()=>{class c{value;stateChanges;id;placeholder;ngControl;focused;empty;shouldLabelFloat;required;disabled;errorState;controlType;autofilled;userAriaDescribedBy;disableAutomaticLabeling;static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c})}return c})();var Hy=new ut("MatFormField"),pk=new ut("MAT_FORM_FIELD_DEFAULT_OPTIONS"),AC="fill",mk="auto",DC="fixed",fk="translateY(-50%)",OC=(()=>{class c{_elementRef=ge(Si);_changeDetectorRef=ge(Mr);_dir=ge(ua);_platform=ge(Sr);_idGenerator=ge(ts);_defaults=ge(pk,{optional:!0});_animationMode=ge(Io,{optional:!0});_textField;_iconPrefixContainer;_textPrefixContainer;_iconSuffixContainer;_textSuffixContainer;_floatingLabel;_notchedOutline;_lineRipple;_formFieldControl;_prefixChildren;_suffixChildren;_errorChildren;_hintChildren;_labelChild=hx(Mg);get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(i){this._hideRequiredMarker=A1(i)}_hideRequiredMarker=!1;color="primary";get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||mk}set floatLabel(i){i!==this._floatLabel&&(this._floatLabel=i,this._changeDetectorRef.markForCheck())}_floatLabel;get appearance(){return this._appearance}set appearance(i){let l=this._appearance,h=i||this._defaults?.appearance||AC;this._appearance=h,this._appearance==="outline"&&this._appearance!==l&&(this._needsOutlineLabelOffsetUpdate=!0)}_appearance=AC;get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||DC}set subscriptSizing(i){this._subscriptSizing=i||this._defaults?.subscriptSizing||DC}_subscriptSizing=null;get hintLabel(){return this._hintLabel}set hintLabel(i){this._hintLabel=i,this._processHints()}_hintLabel="";_hasIconPrefix=!1;_hasTextPrefix=!1;_hasIconSuffix=!1;_hasTextSuffix=!1;_labelId=this._idGenerator.getId("mat-mdc-form-field-label-");_hintLabelId=this._idGenerator.getId("mat-mdc-hint-");_subscriptAnimationState="";get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(i){this._explicitFormFieldControl=i}_destroyed=new qt;_isFocused=null;_explicitFormFieldControl;_needsOutlineLabelOffsetUpdate=!1;_previousControl=null;_stateChanges;_valueChanges;_describedByChanges;_injector=ge(Or);constructor(){let i=this._defaults;i&&(i.appearance&&(this.appearance=i.appearance),this._hideRequiredMarker=!!i?.hideRequiredMarker,i.color&&(this.color=i.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl(),this._control!==this._previousControl&&(this._initializeControl(this._previousControl),this._previousControl=this._control)}ngOnDestroy(){this._stateChanges?.unsubscribe(),this._valueChanges?.unsubscribe(),this._describedByChanges?.unsubscribe(),this._destroyed.next(),this._destroyed.complete()}getLabelId=Ya(()=>this._hasFloatingLabel()?this._labelId:null);getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(i){let l=this._control,h="mat-mdc-form-field-type-";i&&this._elementRef.nativeElement.classList.remove(h+i.controlType),l.controlType&&this._elementRef.nativeElement.classList.add(h+l.controlType),this._stateChanges?.unsubscribe(),this._stateChanges=l.stateChanges.subscribe(()=>{this._updateFocusState(),this._changeDetectorRef.markForCheck()}),this._describedByChanges?.unsubscribe(),this._describedByChanges=l.stateChanges.pipe(ra([void 0,void 0]),Ft(()=>[l.errorState,l.userAriaDescribedBy]),V_(),bn(([[s,P],[q,X]])=>s!==q||P!==X)).subscribe(()=>this._syncDescribedByIds()),this._valueChanges?.unsubscribe(),l.ngControl&&l.ngControl.valueChanges&&(this._valueChanges=l.ngControl.valueChanges.pipe(Rn(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()))}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(i=>!i._isText),this._hasTextPrefix=!!this._prefixChildren.find(i=>i._isText),this._hasIconSuffix=!!this._suffixChildren.find(i=>!i._isText),this._hasTextSuffix=!!this._suffixChildren.find(i=>i._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Wl(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),Bm(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(Rn(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel=Ya(()=>!!this._labelChild());_shouldLabelFloat(){return this._hasFloatingLabel()?this._control.shouldLabelFloat||this._shouldAlwaysFloat():!1}_shouldForward(i){let l=this._control?this._control.ngControl:null;return l&&l[i]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let i=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&i.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let l=this._hintChildren?this._hintChildren.find(s=>s.align==="start"):null,h=this._hintChildren?this._hintChildren.find(s=>s.align==="end"):null;l?i.push(l.id):this._hintLabel&&i.push(this._hintLabelId),h&&i.push(h.id)}else this._errorChildren&&i.push(...this._errorChildren.map(l=>l.id));this._control.setDescribedByIds(i)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;let i=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){i.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdate=!0;return}let l=this._iconPrefixContainer?.nativeElement,h=this._textPrefixContainer?.nativeElement,s=this._iconSuffixContainer?.nativeElement,P=this._textSuffixContainer?.nativeElement,q=l?.getBoundingClientRect().width??0,X=h?.getBoundingClientRect().width??0,be=s?.getBoundingClientRect().width??0,ve=P?.getBoundingClientRect().width??0,$=this._dir.value==="rtl"?"-1":"1",$e=`${q+X}px`,wt=`calc(${$} * (${$e} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;i.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${fk} translateX(${wt})
    )`;let lt=q+X+be+ve;this._elementRef.nativeElement.style.setProperty("--mat-form-field-notch-max-width",`calc(100% - ${lt}px)`)}_isAttachedToDom(){let i=this._elementRef.nativeElement;if(i.getRootNode){let l=i.getRootNode();return l&&l!==i}return document.documentElement.contains(i)}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-form-field"]],contentQueries:function(l,h,s){if(l&1&&(_x(s,h._labelChild,Mg,5),lo(s,Gy,5),lo(s,ck,5),lo(s,dk,5),lo(s,lk,5),lo(s,PC,5)),l&2){yx();let P;wi(P=Ci())&&(h._formFieldControl=P.first),wi(P=Ci())&&(h._prefixChildren=P),wi(P=Ci())&&(h._suffixChildren=P),wi(P=Ci())&&(h._errorChildren=P),wi(P=Ci())&&(h._hintChildren=P)}},viewQuery:function(l,h){if(l&1&&(ln(BI,5),ln(NI,5),ln(VI,5),ln(jI,5),ln(UI,5),ln(EC,5),ln(kC,5),ln(IC,5)),l&2){let s;wi(s=Ci())&&(h._textField=s.first),wi(s=Ci())&&(h._iconPrefixContainer=s.first),wi(s=Ci())&&(h._textPrefixContainer=s.first),wi(s=Ci())&&(h._iconSuffixContainer=s.first),wi(s=Ci())&&(h._textSuffixContainer=s.first),wi(s=Ci())&&(h._floatingLabel=s.first),wi(s=Ci())&&(h._notchedOutline=s.first),wi(s=Ci())&&(h._lineRipple=s.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(l,h){l&2&&si("mat-mdc-form-field-label-always-float",h._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",h._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",h._hasIconSuffix)("mat-form-field-invalid",h._control.errorState)("mat-form-field-disabled",h._control.disabled)("mat-form-field-autofilled",h._control.autofilled)("mat-form-field-no-animations",h._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",h.appearance=="fill")("mat-form-field-appearance-outline",h.appearance=="outline")("mat-form-field-hide-placeholder",h._hasFloatingLabel()&&!h._shouldLabelFloat())("mat-focused",h._control.focused)("mat-primary",h.color!=="accent"&&h.color!=="warn")("mat-accent",h.color==="accent")("mat-warn",h.color==="warn")("ng-untouched",h._shouldForward("untouched"))("ng-touched",h._shouldForward("touched"))("ng-pristine",h._shouldForward("pristine"))("ng-dirty",h._shouldForward("dirty"))("ng-valid",h._shouldForward("valid"))("ng-invalid",h._shouldForward("invalid"))("ng-pending",h._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Gn([{provide:Hy,useExisting:c},{provide:RC,useExisting:c}])],ngContentSelectors:GI,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],["textSuffixContainer",""],["iconSuffixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(l,h){if(l&1){let s=Xt();Fr($I),Xe(0,WI,1,1,"ng-template",null,0,Qc),O(2,"div",6,1),tt("click",function(q){return mt(s),ft(h._control.onContainerClick(q))}),Xe(4,qI,1,0,"div",7),O(5,"div",8),Xe(6,KI,2,2,"div",9)(7,QI,3,0,"div",10)(8,JI,3,0,"div",11),O(9,"div",12),Xe(10,tk,1,1,null,13),Ni(11),F(),Xe(12,ik,3,0,"div",14)(13,nk,3,0,"div",15),F(),Xe(14,rk,1,0,"div",16),F(),O(15,"div",17),Xe(16,ok,2,1,"div",18)(17,ak,5,2,"div",19),F()}if(l&2){let s;re(2),si("mdc-text-field--filled",!h._hasOutline())("mdc-text-field--outlined",h._hasOutline())("mdc-text-field--no-label",!h._hasFloatingLabel())("mdc-text-field--disabled",h._control.disabled)("mdc-text-field--invalid",h._control.errorState),re(2),an(!h._hasOutline()&&!h._control.disabled?4:-1),re(2),an(h._hasOutline()?6:-1),re(),an(h._hasIconPrefix?7:-1),re(),an(h._hasTextPrefix?8:-1),re(2),an(!h._hasOutline()||h._forceDisplayInfixLabel()?10:-1),re(2),an(h._hasTextSuffix?12:-1),re(),an(h._hasIconSuffix?13:-1),re(),an(h._hasOutline()?-1:14),re(),si("mat-mdc-form-field-subscript-dynamic-size",h.subscriptSizing==="dynamic"),re(),an((s=h._getDisplayedMessages())==="error"?16:s==="hint"?17:-1)}},dependencies:[EC,kC,Km,IC,PC],styles:['.mdc-text-field{display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field__input{width:100%;min-width:0;border:none;border-radius:0;background:none;padding:0;-moz-appearance:none;-webkit-appearance:none;height:28px}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input::placeholder{opacity:0}.mdc-text-field__input::-moz-placeholder{opacity:0}.mdc-text-field__input::-webkit-input-placeholder{opacity:0}.mdc-text-field__input:-ms-input-placeholder{opacity:0}.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-moz-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-webkit-input-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive:-ms-input-placeholder{opacity:0}.mdc-text-field--outlined .mdc-text-field__input,.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-filled-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-outlined-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}}.mdc-text-field--filled{height:56px;border-bottom-right-radius:0;border-bottom-left-radius:0;border-top-left-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small));border-top-right-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color, var(--mat-sys-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 4%, transparent))}.mdc-text-field--outlined{height:56px;overflow:visible;padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)));padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px)}[dir=rtl] .mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px);padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}.mdc-floating-label{position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:auto}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:auto;right:4px}.mdc-text-field--filled .mdc-floating-label{left:16px;right:auto}[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:auto;right:16px}.mdc-text-field--disabled .mdc-floating-label{cursor:default}@media(forced-colors: active){.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-filled-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-filled-text-field-hover-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-filled-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-filled-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-filled-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-filled-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-filled-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-filled-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-outlined-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-outlined-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-outlined-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-outlined-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-outlined-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-outlined-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-floating-label--float-above{cursor:auto;transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1);font-size:.75rem}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mat-mdc-notch-piece{box-sizing:border-box;height:100%;pointer-events:none;border-top:1px solid;border-bottom:1px solid}.mdc-text-field--focused .mat-mdc-notch-piece{border-width:2px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-outline-color, var(--mat-sys-outline));border-width:var(--mdc-outlined-text-field-outline-width, 1px)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-hover-outline-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-focus-outline-color, var(--mat-sys-primary))}.mdc-text-field--outlined.mdc-text-field--disabled .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-notched-outline .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-hover-outline-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-focus-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mat-mdc-notch-piece{border-width:var(--mdc-outlined-text-field-focus-outline-width, 2px)}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__trailing{flex-grow:1;border-left:none;border-right:1px solid;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:min(var(--mat-form-field-notch-max-width, 100%),100% - max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))*2)}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none;--mat-form-field-notch-max-width: 100%}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1;border-bottom-width:var(--mdc-filled-text-field-active-indicator-height, 1px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color, var(--mat-sys-on-surface))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color, var(--mat-sys-on-error-container))}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height, 2px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color, var(--mat-sys-primary))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color, var(--mat-sys-error))}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-text-field--disabled{pointer-events:none}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height, 56px);padding-top:var(--mat-form-field-filled-with-label-container-padding-top, 24px);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom, 8px)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding, 16px);padding-bottom:var(--mat-form-field-container-vertical-padding, 16px)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height, 56px)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height, 56px) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color, var(--mat-sys-error))}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-form-field-subscript-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-form-field-subscript-text-size, var(--mat-sys-body-small-size));letter-spacing:var(--mat-form-field-subscript-text-tracking, var(--mat-sys-body-small-tracking));font-weight:var(--mat-form-field-subscript-text-weight, var(--mat-sys-body-small-weight))}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color, var(--mat-sys-on-surface))}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity, 0)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color, var(--mat-sys-neutral10))}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color, color-mix(in srgb, var(--mat-sys-neutral10) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}@media(forced-colors: active){.mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}}@media(forced-colors: active){.mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-form-field-container-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-form-field-container-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-form-field-container-text-tracking, var(--mat-sys-body-large-tracking));font-weight:var(--mat-form-field-container-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color, var(--mat-sys-error))}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color, var(--mat-sys-on-error-container))}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color, var(--mat-sys-error))}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field-infix:has(textarea[cols]){width:auto}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-moz-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-webkit-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[hk.transitionMessages]},changeDetection:0})}return c})(),FC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn,D1,hn]})}return c})();var _k=["trigger"],yk=["panel"],vk=[[["mat-select-trigger"]],"*"],bk=["mat-select-trigger","*"];function xk(c,a){if(c&1&&(O(0,"span",4),Y(1),F()),c&2){let i=ze();re(),St(i.placeholder)}}function wk(c,a){c&1&&Ni(0)}function Ck(c,a){if(c&1&&(O(0,"span",11),Y(1),F()),c&2){let i=ze(2);re(),St(i.triggerValue)}}function Mk(c,a){if(c&1&&(O(0,"span",5),Xe(1,wk,1,0)(2,Ck,2,1,"span",11),F()),c&2){let i=ze();re(),an(i.customTrigger?1:2)}}function Sk(c,a){if(c&1){let i=Xt();O(0,"div",12,1),tt("@transformPanel.done",function(h){mt(i);let s=ze();return ft(s._panelDoneAnimatingStream.next(h.toState))})("keydown",function(h){mt(i);let s=ze();return ft(s._handleKeydown(h))}),Ni(2,1),F()}if(c&2){let i=ze();gx("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",i._getPanelTheme(),""),Oe("ngClass",i.panelClass)("@transformPanel","showing"),Ri("id",i.id+"-panel")("aria-multiselectable",i.multiple)("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby())}}var Pk={transformPanelWrap:Yh("transformPanelWrap",[mu("* => void",Ax("@transformPanel",[kx()],{optional:!0}))]),transformPanel:Yh("transformPanel",[tf("void",td({opacity:0,transform:"scale(1, 0.8)"})),mu("void => showing",Kh("120ms cubic-bezier(0, 0, 0.2, 1)",td({opacity:1,transform:"scale(1, 1)"}))),mu("* => void",Kh("100ms linear",td({opacity:0})))])};var LC=new ut("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{let c=ge(ud);return()=>c.scrollStrategies.reposition()}});function Ek(c){return()=>c.scrollStrategies.reposition()}var Tk=new ut("MAT_SELECT_CONFIG"),Ik={provide:LC,deps:[ud],useFactory:Ek},kk=new ut("MatSelectTrigger"),Zy=class{source;value;constructor(a,i){this.source=a,this.value=i}},zC=(()=>{class c{_viewportRuler=ge(qp);_changeDetectorRef=ge(Mr);_elementRef=ge(Si);_dir=ge(ua,{optional:!0});_idGenerator=ge(ts);_parentFormField=ge(Hy,{optional:!0});ngControl=ge(tl,{self:!0,optional:!0});_liveAnnouncer=ge(U1);_defaultOptions=ge(Tk,{optional:!0});_initialized=new qt;options;optionGroups;customTrigger;_positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}];_scrollOptionIntoView(i){let l=this.options.toArray()[i];if(l){let h=this.panel.nativeElement,s=Q1(i,this.options,this.optionGroups),P=l._getHostElement();i===0&&s===1?h.scrollTop=0:h.scrollTop=J1(P.offsetTop,P.offsetHeight,h.scrollTop,h.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(i){return new Zy(this,i)}_scrollStrategyFactory=ge(LC);_panelOpen=!1;_compareWith=(i,l)=>i===l;_uid=this._idGenerator.getId("mat-select-");_triggerAriaLabelledBy=null;_previousControl;_destroy=new qt;_errorStateTracker;stateChanges=new qt;disableAutomaticLabeling=!0;userAriaDescribedBy;_selectionModel;_keyManager;_preferredOverlayOrigin;_overlayWidth;_onChange=()=>{};_onTouched=()=>{};_valueId=this._idGenerator.getId("mat-select-value-");_panelDoneAnimatingStream=new qt;_scrollStrategy;_overlayPanelClass=this._defaultOptions?.overlayPanelClass||"";get focused(){return this._focused||this._panelOpen}_focused=!1;controlType="mat-select";trigger;panel;_overlayDir;panelClass;disabled=!1;disableRipple=!1;tabIndex=0;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._syncParentProperties()}_hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get placeholder(){return this._placeholder}set placeholder(i){this._placeholder=i,this.stateChanges.next()}_placeholder;get required(){return this._required??this.ngControl?.control?.hasValidator(Oo.required)??!1}set required(i){this._required=i,this.stateChanges.next()}_required;get multiple(){return this._multiple}set multiple(i){this._selectionModel,this._multiple=i}_multiple=!1;disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1;get compareWith(){return this._compareWith}set compareWith(i){this._compareWith=i,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(i){this._assignValue(i)&&this._onChange(i)}_value;ariaLabel="";ariaLabelledby;get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(i){this._errorStateTracker.matcher=i}typeaheadDebounceInterval;sortComparator;get id(){return this._id}set id(i){this._id=i||this._uid,this.stateChanges.next()}_id;get errorState(){return this._errorStateTracker.errorState}set errorState(i){this._errorStateTracker.errorState=i}panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto";canSelectNullableOptions=this._defaultOptions?.canSelectNullableOptions??!1;optionSelectionChanges=Lh(()=>{let i=this.options;return i?i.changes.pipe(ra(i),Cr(()=>Wl(...i.map(l=>l.onSelectionChange)))):this._initialized.pipe(Cr(()=>this.optionSelectionChanges))});openedChange=new oi;_openedStream=this.openedChange.pipe(bn(i=>i),Ft(()=>{}));_closedStream=this.openedChange.pipe(bn(i=>!i),Ft(()=>{}));selectionChange=new oi;valueChange=new oi;constructor(){let i=ge(Y1),l=ge(sy,{optional:!0}),h=ge(sd,{optional:!0}),s=ge(new Yc("tabindex"),{optional:!0});this.ngControl&&(this.ngControl.valueAccessor=this),this._defaultOptions?.typeaheadDebounceInterval!=null&&(this.typeaheadDebounceInterval=this._defaultOptions.typeaheadDebounceInterval),this._errorStateTracker=new Jf(i,this.ngControl,h,l,this.stateChanges),this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=s==null?0:parseInt(s)||0,this.id=this.id}ngOnInit(){this._selectionModel=new Bu(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(zh(),Rn(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen)),this._viewportRuler.change().pipe(Rn(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(Rn(this._destroy)).subscribe(i=>{i.added.forEach(l=>l.select()),i.removed.forEach(l=>l.deselect())}),this.options.changes.pipe(ra(null),Rn(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){let i=this._getTriggerAriaLabelledby(),l=this.ngControl;if(i!==this._triggerAriaLabelledBy){let h=this._elementRef.nativeElement;this._triggerAriaLabelledBy=i,i?h.setAttribute("aria-labelledby",i):h.removeAttribute("aria-labelledby")}l&&(this._previousControl!==l.control&&(this._previousControl!==void 0&&l.disabled!==null&&l.disabled!==this.disabled&&(this.disabled=l.disabled),this._previousControl=l.control),this.updateErrorState())}ngOnChanges(i){(i.disabled||i.userAriaDescribedBy)&&this.stateChanges.next(),i.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_trackedModal=null;_applyModalPanelOwnership(){let i=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!i)return;let l=`${this.id}-panel`;this._trackedModal&&_y(this._trackedModal,"aria-owns",l),N1(i,"aria-owns",l),this._trackedModal=i}_clearFromModal(){if(!this._trackedModal)return;let i=`${this.id}-panel`;_y(this._trackedModal,"aria-owns",i),this._trackedModal=null}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next())}writeValue(i){this._assignValue(i)}registerOnChange(i){this._onChange=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){let i=this._selectionModel.selected.map(l=>l.viewValue);return this._isRtl()&&i.reverse(),i.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return this._dir?this._dir.value==="rtl":!1}_handleKeydown(i){this.disabled||(this.panelOpen?this._handleOpenKeydown(i):this._handleClosedKeydown(i))}_handleClosedKeydown(i){let l=i.keyCode,h=l===40||l===38||l===37||l===39,s=l===13||l===32,P=this._keyManager;if(!P.isTyping()&&s&&!rl(i)||(this.multiple||i.altKey)&&h)i.preventDefault(),this.open();else if(!this.multiple){let q=this.selected;P.onKeydown(i);let X=this.selected;X&&q!==X&&this._liveAnnouncer.announce(X.viewValue,1e4)}}_handleOpenKeydown(i){let l=this._keyManager,h=i.keyCode,s=h===40||h===38,P=l.isTyping();if(s&&i.altKey)i.preventDefault(),this.close();else if(!P&&(h===13||h===32)&&l.activeItem&&!rl(i))i.preventDefault(),l.activeItem._selectViaInteraction();else if(!P&&this._multiple&&h===65&&i.ctrlKey){i.preventDefault();let q=this.options.some(X=>!X.disabled&&!X.selected);this.options.forEach(X=>{X.disabled||(q?X.select():X.deselect())})}else{let q=l.activeItemIndex;l.onKeydown(i),this._multiple&&s&&i.shiftKey&&l.activeItem&&l.activeItemIndex!==q&&l.activeItem._selectViaInteraction()}}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(To(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(i){if(this.options.forEach(l=>l.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&i)Array.isArray(i),i.forEach(l=>this._selectOptionByValue(l)),this._sortValues();else{let l=this._selectOptionByValue(i);l?this._keyManager.updateActiveItem(l):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(i){let l=this.options.find(h=>{if(this._selectionModel.isSelected(h))return!1;try{return(h.value!=null||this.canSelectNullableOptions)&&this._compareWith(h.value,i)}catch{return!1}});return l&&this._selectionModel.select(l),l}_assignValue(i){return i!==this._value||this._multiple&&Array.isArray(i)?(this.options&&this._setSelectionByValue(i),this._value=i,!0):!1}_skipPredicate=i=>this.panelOpen?!1:i.disabled;_getOverlayWidth(i){return this.panelWidth==="auto"?(i instanceof Kp?i.elementRef:i||this._elementRef).nativeElement.getBoundingClientRect().width:this.panelWidth===null?"":this.panelWidth}_syncParentProperties(){if(this.options)for(let i of this.options)i._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new Yf(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){let i=Wl(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Rn(i)).subscribe(l=>{this._onSelect(l.source,l.isUserInput),l.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Wl(...this.options.map(l=>l._stateChanges)).pipe(Rn(i)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(i,l){let h=this._selectionModel.isSelected(i);!this.canSelectNullableOptions&&i.value==null&&!this._multiple?(i.deselect(),this._selectionModel.clear(),this.value!=null&&this._propagateChanges(i.value)):(h!==i.selected&&(i.selected?this._selectionModel.select(i):this._selectionModel.deselect(i)),l&&this._keyManager.setActiveItem(i),this.multiple&&(this._sortValues(),l&&this.focus())),h!==this._selectionModel.isSelected(i)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){let i=this.options.toArray();this._selectionModel.sort((l,h)=>this.sortComparator?this.sortComparator(l,h,i):i.indexOf(l)-i.indexOf(h)),this.stateChanges.next()}}_propagateChanges(i){let l;this.multiple?l=this.selected.map(h=>h.value):l=this.selected?this.selected.value:i,this._value=l,this.valueChange.emit(l),this._onChange(l),this.selectionChange.emit(this._getChangeEvent(l)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let i=-1;for(let l=0;l<this.options.length;l++)if(!this.options.get(l).disabled){i=l;break}this._keyManager.setActiveItem(i)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(i){this._elementRef.nativeElement.focus(i)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId()||null,l=i?i+" ":"";return this.ariaLabelledby?l+this.ariaLabelledby:i}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let i=this._parentFormField?.getLabelId(),l=(i?i+" ":"")+this._valueId;return this.ariaLabelledby&&(l+=" "+this.ariaLabelledby),l}_panelDoneAnimating(i){this.openedChange.emit(i)}setDescribedByIds(i){i.length?this._elementRef.nativeElement.setAttribute("aria-describedby",i.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-select"]],contentQueries:function(l,h,s){if(l&1&&(lo(s,kk,5),lo(s,ig,5),lo(s,Py,5)),l&2){let P;wi(P=Ci())&&(h.customTrigger=P.first),wi(P=Ci())&&(h.options=P),wi(P=Ci())&&(h.optionGroups=P)}},viewQuery:function(l,h){if(l&1&&(ln(_k,5),ln(yk,5),ln(Uy,5)),l&2){let s;wi(s=Ci())&&(h.trigger=s.first),wi(s=Ci())&&(h.panel=s.first),wi(s=Ci())&&(h._overlayDir=s.first)}},hostAttrs:["role","combobox","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(l,h){l&1&&tt("keydown",function(P){return h._handleKeydown(P)})("focus",function(){return h._onFocus()})("blur",function(){return h._onBlur()}),l&2&&(Ri("id",h.id)("tabindex",h.disabled?-1:h.tabIndex)("aria-controls",h.panelOpen?h.id+"-panel":null)("aria-expanded",h.panelOpen)("aria-label",h.ariaLabel||null)("aria-required",h.required.toString())("aria-disabled",h.disabled.toString())("aria-invalid",h.errorState)("aria-activedescendant",h._getAriaActiveDescendant()),si("mat-mdc-select-disabled",h.disabled)("mat-mdc-select-invalid",h.errorState)("mat-mdc-select-required",h.required)("mat-mdc-select-empty",h.empty)("mat-mdc-select-multiple",h.multiple))},inputs:{userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[2,"disabled","disabled",yi],disableRipple:[2,"disableRipple","disableRipple",yi],tabIndex:[2,"tabIndex","tabIndex",i=>i==null?0:Jc(i)],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",yi],placeholder:"placeholder",required:[2,"required","required",yi],multiple:[2,"multiple","multiple",yi],disableOptionCentering:[2,"disableOptionCentering","disableOptionCentering",yi],compareWith:"compareWith",value:"value",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[2,"typeaheadDebounceInterval","typeaheadDebounceInterval",Jc],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth",canSelectNullableOptions:[2,"canSelectNullableOptions","canSelectNullableOptions",yi]},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Gn([{provide:Gy,useExisting:c},{provide:Sy,useExisting:c}]),hr,ao],ngContentSelectors:bk,decls:11,vars:8,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","attach","detach","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(l,h){if(l&1){let s=Xt();Fr(vk),O(0,"div",2,0),tt("click",function(){return mt(s),ft(h.open())}),O(3,"div",3),Xe(4,xk,2,1,"span",4)(5,Mk,3,1,"span",5),F(),O(6,"div",6)(7,"div",7),Nh(),O(8,"svg",8),Te(9,"path",9),F()()()(),Xe(10,Sk,3,9,"ng-template",10),tt("backdropClick",function(){return mt(s),ft(h.close())})("attach",function(){return mt(s),ft(h._onAttached())})("detach",function(){return mt(s),ft(h.close())})}if(l&2){let s=cn(1);re(3),Ri("id",h._valueId),re(),an(h.empty?4:5),re(6),Oe("cdkConnectedOverlayPanelClass",h._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",h._scrollStrategy)("cdkConnectedOverlayOrigin",h._preferredOverlayOrigin||s)("cdkConnectedOverlayOpen",h.panelOpen)("cdkConnectedOverlayPositions",h._positions)("cdkConnectedOverlayWidth",h._overlayWidth)}},dependencies:[Kp,Uy,Ym],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color, var(--mat-sys-on-surface));font-family:var(--mat-select-trigger-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-select-trigger-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-select-trigger-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-select-trigger-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-select-trigger-text-tracking, var(--mat-sys-body-large-tracking))}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color, var(--mat-sys-error))}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color, var(--mat-sys-on-surface-variant))}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}@media(forced-colors: active){.mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .mat-mdc-select-arrow svg{fill:GrayText}}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-select-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color, var(--mat-sys-on-surface-variant))}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform, translateY(-8px))}'],encapsulation:2,data:{animation:[Pk.transformPanel]},changeDetection:0})}return c})();var BC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({providers:[Ik],imports:[MC,Ey,hn,vg,FC,Ey,hn]})}return c})();var NC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn,Zp]})}return c})();var Dk=["button"],Rk=["*"];function Ok(c,a){if(c&1&&(O(0,"div",2),Te(1,"mat-pseudo-checkbox",6),F()),c&2){let i=ze();re(),Oe("disabled",i.disabled)}}var VC=new ut("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS",{providedIn:"root",factory:Fk});function Fk(){return{hideSingleSelectionIndicator:!1,hideMultipleSelectionIndicator:!1,disabledInteractive:!1}}var jC=new ut("MatButtonToggleGroup"),Lk={provide:oc,useExisting:qo(()=>Wy),multi:!0},Sg=class{source;value;constructor(a,i){this.source=a,this.value=i}},Wy=(()=>{class c{_changeDetector=ge(Mr);_dir=ge(ua,{optional:!0});_multiple=!1;_disabled=!1;_disabledInteractive=!1;_selectionModel;_rawValue;_controlValueAccessorChangeFn=()=>{};_onTouched=()=>{};_buttonToggles;appearance;get name(){return this._name}set name(i){this._name=i,this._markButtonsForCheck()}_name=ge(ts).getId("mat-button-toggle-group-");vertical;get value(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i.map(l=>l.value):i[0]?i[0].value:void 0}set value(i){this._setSelectionByValue(i),this.valueChange.emit(this.value)}valueChange=new oi;get selected(){let i=this._selectionModel?this._selectionModel.selected:[];return this.multiple?i:i[0]||null}get multiple(){return this._multiple}set multiple(i){this._multiple=i,this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(i){this._disabled=i,this._markButtonsForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(i){this._disabledInteractive=i,this._markButtonsForCheck()}get dir(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}change=new oi;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(i){this._hideSingleSelectionIndicator=i,this._markButtonsForCheck()}_hideSingleSelectionIndicator;get hideMultipleSelectionIndicator(){return this._hideMultipleSelectionIndicator}set hideMultipleSelectionIndicator(i){this._hideMultipleSelectionIndicator=i,this._markButtonsForCheck()}_hideMultipleSelectionIndicator;constructor(){let i=ge(VC,{optional:!0});this.appearance=i&&i.appearance?i.appearance:"standard",this.hideSingleSelectionIndicator=i?.hideSingleSelectionIndicator??!1,this.hideMultipleSelectionIndicator=i?.hideMultipleSelectionIndicator??!1}ngOnInit(){this._selectionModel=new Bu(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(i=>i.checked)),this.multiple||this._initializeTabIndex()}writeValue(i){this.value=i,this._changeDetector.markForCheck()}registerOnChange(i){this._controlValueAccessorChangeFn=i}registerOnTouched(i){this._onTouched=i}setDisabledState(i){this.disabled=i}_keydown(i){if(this.multiple||this.disabled)return;let h=i.target.id,s=this._buttonToggles.toArray().findIndex(q=>q.buttonId===h),P=null;switch(i.keyCode){case 32:case 13:P=this._buttonToggles.get(s)||null;break;case 38:P=this._getNextButton(s,-1);break;case 37:P=this._getNextButton(s,this.dir==="ltr"?-1:1);break;case 40:P=this._getNextButton(s,1);break;case 39:P=this._getNextButton(s,this.dir==="ltr"?1:-1);break;default:return}P&&(i.preventDefault(),P._onButtonClick(),P.focus())}_emitChangeEvent(i){let l=new Sg(i,this.value);this._rawValue=l.value,this._controlValueAccessorChangeFn(l.value),this.change.emit(l)}_syncButtonToggle(i,l,h=!1,s=!1){!this.multiple&&this.selected&&!i.checked&&(this.selected.checked=!1),this._selectionModel?l?this._selectionModel.select(i):this._selectionModel.deselect(i):s=!0,s?Promise.resolve().then(()=>this._updateModelValue(i,h)):this._updateModelValue(i,h)}_isSelected(i){return this._selectionModel&&this._selectionModel.isSelected(i)}_isPrechecked(i){return typeof this._rawValue>"u"?!1:this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(l=>i.value!=null&&l===i.value):i.value===this._rawValue}_initializeTabIndex(){if(this._buttonToggles.forEach(i=>{i.tabIndex=-1}),this.selected)this.selected.tabIndex=0;else for(let i=0;i<this._buttonToggles.length;i++){let l=this._buttonToggles.get(i);if(!l.disabled){l.tabIndex=0;break}}this._markButtonsForCheck()}_getNextButton(i,l){let h=this._buttonToggles;for(let s=1;s<=h.length;s++){let P=(i+l*s+h.length)%h.length,q=h.get(P);if(q&&!q.disabled)return q}return null}_setSelectionByValue(i){if(this._rawValue=i,!this._buttonToggles)return;let l=this._buttonToggles.toArray();if(this.multiple&&i?(Array.isArray(i),this._clearSelection(),i.forEach(h=>this._selectValue(h,l))):(this._clearSelection(),this._selectValue(i,l)),!this.multiple&&l.every(h=>h.tabIndex===-1)){for(let h of l)if(!h.disabled){h.tabIndex=0;break}}}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(i=>{i.checked=!1,this.multiple||(i.tabIndex=-1)})}_selectValue(i,l){for(let h of l)if(h.value!=null&&h.value===i){h.checked=!0,this._selectionModel.select(h),this.multiple||(h.tabIndex=0);break}}_updateModelValue(i,l){l&&this._emitChangeEvent(i),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(i=>i._markForCheck())}static \u0275fac=function(l){return new(l||c)};static \u0275dir=Ht({type:c,selectors:[["mat-button-toggle-group"]],contentQueries:function(l,h,s){if(l&1&&lo(s,Pg,5),l&2){let P;wi(P=Ci())&&(h._buttonToggles=P)}},hostAttrs:[1,"mat-button-toggle-group"],hostVars:6,hostBindings:function(l,h){l&1&&tt("keydown",function(P){return h._keydown(P)}),l&2&&(Ri("role",h.multiple?"group":"radiogroup")("aria-disabled",h.disabled),si("mat-button-toggle-vertical",h.vertical)("mat-button-toggle-group-appearance-standard",h.appearance==="standard"))},inputs:{appearance:"appearance",name:"name",vertical:[2,"vertical","vertical",yi],value:"value",multiple:[2,"multiple","multiple",yi],disabled:[2,"disabled","disabled",yi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",yi],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",yi],hideMultipleSelectionIndicator:[2,"hideMultipleSelectionIndicator","hideMultipleSelectionIndicator",yi]},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[Gn([Lk,{provide:jC,useExisting:c}]),hr]})}return c})(),Pg=(()=>{class c{_changeDetectorRef=ge(Mr);_elementRef=ge(Si);_focusMonitor=ge($1);_idGenerator=ge(ts);_animationMode=ge(Io,{optional:!0});_checked=!1;ariaLabel;ariaLabelledby=null;_buttonElement;buttonToggleGroup;get buttonId(){return`${this.id}-button`}id;name;value;get tabIndex(){return this._tabIndex}set tabIndex(i){i!==this._tabIndex&&(this._tabIndex=i,this._markForCheck())}_tabIndex;disableRipple;get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(i){this._appearance=i}_appearance;get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(i){i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(i){this._disabled=i}_disabled=!1;get disabledInteractive(){return this._disabledInteractive||this.buttonToggleGroup!==null&&this.buttonToggleGroup.disabledInteractive}set disabledInteractive(i){this._disabledInteractive=i}_disabledInteractive;change=new oi;constructor(){ge(nl).load(eg);let i=ge(jC,{optional:!0}),l=ge(new Yc("tabindex"),{optional:!0})||"",h=ge(VC,{optional:!0});this._tabIndex=parseInt(l)||0,this.buttonToggleGroup=i,this.appearance=h&&h.appearance?h.appearance:"standard",this.disabledInteractive=h?.disabledInteractive??!1}ngOnInit(){let i=this.buttonToggleGroup;this.id=this.id||this._idGenerator.getId("mat-button-toggle-"),i&&(i._isPrechecked(this)?this.checked=!0:i._isSelected(this)!==this._checked&&i._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._animationMode!=="NoopAnimations"&&this._elementRef.nativeElement.classList.add("mat-button-toggle-animations-enabled"),this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){let i=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),i&&i._isSelected(this)&&i._syncButtonToggle(this,!1,!1,!0)}focus(i){this._buttonElement.nativeElement.focus(i)}_onButtonClick(){if(this.disabled)return;let i=this.isSingleSelector()?!0:!this._checked;if(i!==this._checked&&(this._checked=i,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.isSingleSelector()){let l=this.buttonToggleGroup._buttonToggles.find(h=>h.tabIndex===0);l&&(l.tabIndex=-1),this.tabIndex=0}this.change.emit(new Sg(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this.isSingleSelector()?this.buttonToggleGroup.name:this.name||null}isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-button-toggle"]],viewQuery:function(l,h){if(l&1&&ln(Dk,5),l&2){let s;wi(s=Ci())&&(h._buttonElement=s.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:14,hostBindings:function(l,h){l&1&&tt("focus",function(){return h.focus()}),l&2&&(Ri("aria-label",null)("aria-labelledby",null)("id",h.id)("name",null),si("mat-button-toggle-standalone",!h.buttonToggleGroup)("mat-button-toggle-checked",h.checked)("mat-button-toggle-disabled",h.disabled)("mat-button-toggle-disabled-interactive",h.disabledInteractive)("mat-button-toggle-appearance-standard",h.appearance==="standard"))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",disableRipple:[2,"disableRipple","disableRipple",yi],appearance:"appearance",checked:[2,"checked","checked",yi],disabled:[2,"disabled","disabled",yi],disabledInteractive:[2,"disabledInteractive","disabledInteractive",yi]},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[hr],ngContentSelectors:Rk,decls:7,vars:13,consts:[["button",""],["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"click","id","disabled"],[1,"mat-button-toggle-checkbox-wrapper"],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"],["state","checked","aria-hidden","true","appearance","minimal",3,"disabled"]],template:function(l,h){if(l&1){let s=Xt();Fr(),O(0,"button",1,0),tt("click",function(){return mt(s),ft(h._onButtonClick())}),Xe(2,Ok,2,1,"div",2),O(3,"span",3),Ni(4),F()(),Te(5,"span",4)(6,"span",5)}if(l&2){let s=cn(1);Oe("id",h.buttonId)("disabled",h.disabled&&!h.disabledInteractive||null),Ri("role",h.isSingleSelector()?"radio":"button")("tabindex",h.disabled&&!h.disabledInteractive?-1:h.tabIndex)("aria-pressed",h.isSingleSelector()?null:h.checked)("aria-checked",h.isSingleSelector()?h.checked:null)("name",h._getButtonName())("aria-label",h.ariaLabel)("aria-labelledby",h.ariaLabelledby)("aria-disabled",h.disabled&&h.disabledInteractive?"true":null),re(2),an(h.buttonToggleGroup&&(!h.buttonToggleGroup.multiple&&!h.buttonToggleGroup.hideSingleSelectionIndicator||h.buttonToggleGroup.multiple&&!h.buttonToggleGroup.hideMultipleSelectionIndicator)?2:-1),re(4),Oe("matRippleTrigger",s)("matRippleDisabled",h.disableRipple||h.disabled)}},dependencies:[tg,My],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0);border-radius:var(--mat-legacy-button-toggle-shape)}.mat-button-toggle-standalone:not([class*=mat-elevation-z]),.mat-button-toggle-group:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}@media(forced-colors: active){.mat-button-toggle-standalone,.mat-button-toggle-group{outline:solid 1px}}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full));border:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard .mat-pseudo-checkbox,.mat-button-toggle-group-appearance-standard .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-standard-button-toggle-selected-state-text-color, var(--mat-sys-on-secondary-container))}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard:not([class*=mat-elevation-z]),.mat-button-toggle-group-appearance-standard:not([class*=mat-elevation-z]){box-shadow:none}@media(forced-colors: active){.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{outline:0}}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative;color:var(--mat-legacy-button-toggle-text-color);font-family:var(--mat-legacy-button-toggle-label-text-font);font-size:var(--mat-legacy-button-toggle-label-text-size);line-height:var(--mat-legacy-button-toggle-label-text-line-height);font-weight:var(--mat-legacy-button-toggle-label-text-weight);letter-spacing:var(--mat-legacy-button-toggle-label-text-tracking);--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-legacy-button-toggle-selected-state-text-color)}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-legacy-button-toggle-focus-state-layer-opacity)}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle-checkbox-wrapper{display:inline-block;justify-content:flex-start;align-items:center;width:0;height:18px;line-height:18px;overflow:hidden;box-sizing:border-box;position:absolute;top:50%;left:16px;transform:translate3d(0, -50%, 0)}[dir=rtl] .mat-button-toggle-checkbox-wrapper{left:auto;right:16px}.mat-button-toggle-appearance-standard .mat-button-toggle-checkbox-wrapper{left:12px}[dir=rtl] .mat-button-toggle-appearance-standard .mat-button-toggle-checkbox-wrapper{left:auto;right:12px}.mat-button-toggle-checked .mat-button-toggle-checkbox-wrapper{width:18px}.mat-button-toggle-animations-enabled .mat-button-toggle-checkbox-wrapper{transition:width 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-button-toggle-vertical .mat-button-toggle-checkbox-wrapper{transition:none}.mat-button-toggle-checked{color:var(--mat-legacy-button-toggle-selected-state-text-color);background-color:var(--mat-legacy-button-toggle-selected-state-background-color)}.mat-button-toggle-disabled{pointer-events:none;color:var(--mat-legacy-button-toggle-disabled-state-text-color);background-color:var(--mat-legacy-button-toggle-disabled-state-background-color);--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var(--mat-legacy-button-toggle-disabled-state-text-color)}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:var(--mat-legacy-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-disabled-interactive{pointer-events:auto}.mat-button-toggle-appearance-standard{color:var(--mat-standard-button-toggle-text-color, var(--mat-sys-on-surface));background-color:var(--mat-standard-button-toggle-background-color, transparent);font-family:var(--mat-standard-button-toggle-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-standard-button-toggle-label-text-size, var(--mat-sys-label-large-size));line-height:var(--mat-standard-button-toggle-label-text-line-height, var(--mat-sys-label-large-line-height));font-weight:var(--mat-standard-button-toggle-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mat-standard-button-toggle-label-text-tracking, var(--mat-sys-label-large-tracking))}.mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}[dir=rtl] .mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:none;border-top:solid 1px var(--mat-standard-button-toggle-divider-color, var(--mat-sys-outline))}.mat-button-toggle-appearance-standard.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-selected-state-text-color, var(--mat-sys-on-secondary-container));background-color:var(--mat-standard-button-toggle-selected-state-background-color, var(--mat-sys-secondary-container))}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled{color:var(--mat-standard-button-toggle-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-standard-button-toggle-disabled-state-background-color, transparent)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var(--mat-standard-button-toggle-disabled-selected-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-disabled-selected-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-standard-button-toggle-disabled-selected-state-background-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{background-color:var(--mat-standard-button-toggle-state-layer-color, var(--mat-sys-on-surface))}.mat-button-toggle-appearance-standard:hover .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-button-toggle-appearance-standard.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}@media(hover: none){.mat-button-toggle-appearance-standard:hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;padding:0 16px;line-height:var(--mat-legacy-button-toggle-height);position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px;line-height:var(--mat-standard-button-toggle-height, 40px)}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0;background-color:var(--mat-legacy-button-toggle-state-layer-color)}@media(forced-colors: active){.mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 500px;opacity:.5;height:0}.mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-animations-enabled .mat-button-toggle-button{transition:padding 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-button-toggle-vertical .mat-button-toggle-button{transition:none}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}.mat-button-toggle-checked .mat-button-toggle-button:has(.mat-button-toggle-checkbox-wrapper){padding-left:30px}[dir=rtl] .mat-button-toggle-checked .mat-button-toggle-button:has(.mat-button-toggle-checkbox-wrapper){padding-left:0;padding-right:30px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard{--mat-focus-indicator-border-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full))}.mat-button-toggle-group-appearance-standard .mat-button-toggle:last-of-type .mat-button-toggle-button::before{border-top-right-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full));border-bottom-right-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full))}.mat-button-toggle-group-appearance-standard .mat-button-toggle:first-of-type .mat-button-toggle-button::before{border-top-left-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full));border-bottom-left-radius:var(--mat-standard-button-toggle-shape, var(--mat-sys-corner-full))}"],encapsulation:2,changeDetection:0})}return c})(),UC=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn,Zp,Pg,hn]})}return c})();var Bk=["determinateSpinner"];function Nk(c,a){if(c&1&&(Nh(),O(0,"svg",11),Te(1,"circle",12),F()),c&2){let i=ze();Ri("viewBox",i._viewBox()),re(),qr("stroke-dasharray",i._strokeCircumference(),"px")("stroke-dashoffset",i._strokeCircumference()/2,"px")("stroke-width",i._circleStrokeWidth(),"%"),Ri("r",i._circleRadius())}}var Vk=new ut("mat-progress-spinner-default-options",{providedIn:"root",factory:jk});function jk(){return{diameter:$C}}var $C=100,Uk=10,Eg=(()=>{class c{_elementRef=ge(Si);_noopAnimations;get color(){return this._color||this._defaultColor}set color(i){this._color=i}_color;_defaultColor="primary";_determinateCircle;constructor(){let i=ge(Io,{optional:!0}),l=ge(Vk);this._noopAnimations=i==="NoopAnimations"&&!!l&&!l._forceAnimations,this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",l&&(l.color&&(this.color=this._defaultColor=l.color),l.diameter&&(this.diameter=l.diameter),l.strokeWidth&&(this.strokeWidth=l.strokeWidth))}mode;get value(){return this.mode==="determinate"?this._value:0}set value(i){this._value=Math.max(0,Math.min(100,i||0))}_value=0;get diameter(){return this._diameter}set diameter(i){this._diameter=i||0}_diameter=$C;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(i){this._strokeWidth=i||0}_strokeWidth;_circleRadius(){return(this.diameter-Uk)/2}_viewBox(){let i=this._circleRadius()*2+this.strokeWidth;return`0 0 ${i} ${i}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=rt({type:c,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(l,h){if(l&1&&ln(Bk,5),l&2){let s;wi(s=Ci())&&(h._determinateCircle=s.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(l,h){l&2&&(Ri("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",h.mode==="determinate"?h.value:null)("mode",h.mode),Zh("mat-"+h.color),qr("width",h.diameter,"px")("height",h.diameter,"px")("--mdc-circular-progress-size",h.diameter+"px")("--mdc-circular-progress-active-indicator-width",h.diameter+"px"),si("_mat-animation-noopable",h._noopAnimations)("mdc-circular-progress--indeterminate",h.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",Jc],diameter:[2,"diameter","diameter",Jc],strokeWidth:[2,"strokeWidth","strokeWidth",Jc]},exportAs:["matProgressSpinner"],features:[hr],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(l,h){if(l&1&&(Xe(0,Nk,2,8,"ng-template",null,0,Qc),O(2,"div",2,1),Nh(),O(4,"svg",3),Te(5,"circle",4),F()(),ex(),O(6,"div",5)(7,"div",6)(8,"div",7),Hm(9,8),F(),O(10,"div",9),Hm(11,8),F(),O(12,"div",10),Hm(13,8),F()()()),l&2){let s=cn(1);re(4),Ri("viewBox",h._viewBox()),re(),qr("stroke-dasharray",h._strokeCircumference(),"px")("stroke-dashoffset",h._strokeDashOffset(),"px")("stroke-width",h._circleStrokeWidth(),"%"),Ri("r",h._circleRadius()),re(4),Oe("ngTemplateOutlet",s),re(2),Oe("ngTemplateOutlet",s),re(2),Oe("ngTemplateOutlet",s)}},dependencies:[Km],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0})}return c})();var Tg=(()=>{class c{static \u0275fac=function(l){return new(l||c)};static \u0275mod=Gt({type:c});static \u0275inj=$t({imports:[hn]})}return c})();var ZC=ou(Yy());function $k(c,a){c&1&&(O(0,"div",43),Te(1,"mat-spinner"),O(2,"p"),Y(3,"Cargando datos..."),F()())}function Gk(c,a){if(c&1){let i=Xt();O(0,"div",44)(1,"mat-icon"),Y(2,"error_outline"),F(),O(3,"p"),Y(4,"Error al cargar los datos. Intente nuevamente."),F(),O(5,"button",45),tt("click",function(){mt(i);let h=ze();return ft(h.fetchData())}),Y(6,"Reintentar"),F()()}}function Hk(c,a){c&1&&(O(0,"div")(1,"div",46),Te(2,"span",47),O(3,"span"),Y(4,"0-29% acceso a internet"),F()(),O(5,"div",46),Te(6,"span",48),O(7,"span"),Y(8,"30-69% acceso a internet"),F()(),O(9,"div",46),Te(10,"span",49),O(11,"span"),Y(12,"70-100% acceso a internet"),F()()())}function Zk(c,a){c&1&&(O(0,"div")(1,"div",46),Te(2,"span",50),O(3,"span"),Y(4,"0-14 a\xF1os (bajo)"),F()(),O(5,"div",46),Te(6,"span",51),O(7,"span"),Y(8,"0-14 a\xF1os (medio)"),F()(),O(9,"div",46),Te(10,"span",52),O(11,"span"),Y(12,"0-14 a\xF1os (alto)"),F()()())}function Wk(c,a){c&1&&(O(0,"div")(1,"div",46),Te(2,"span",53),O(3,"span"),Y(4,"15-59 a\xF1os (bajo)"),F()(),O(5,"div",46),Te(6,"span",54),O(7,"span"),Y(8,"15-59 a\xF1os (medio)"),F()(),O(9,"div",46),Te(10,"span",55),O(11,"span"),Y(12,"15-59 a\xF1os (alto)"),F()()())}function qk(c,a){c&1&&(O(0,"div")(1,"div",46),Te(2,"span",56),O(3,"span"),Y(4,"60+ a\xF1os (bajo)"),F()(),O(5,"div",46),Te(6,"span",57),O(7,"span"),Y(8,"60+ a\xF1os (medio)"),F()(),O(9,"div",46),Te(10,"span",58),O(11,"span"),Y(12,"60+ a\xF1os (alto)"),F()()())}function Xk(c,a){c&1&&(O(0,"div")(1,"div",46),Te(2,"span",59),O(3,"span"),Y(4,"Educaci\xF3n Primaria (bajo)"),F()(),O(5,"div",46),Te(6,"span",60),O(7,"span"),Y(8,"Educaci\xF3n Primaria (medio)"),F()(),O(9,"div",46),Te(10,"span",61),O(11,"span"),Y(12,"Educaci\xF3n Primaria (alto)"),F()()())}function Yk(c,a){c&1&&(O(0,"div")(1,"div",46),Te(2,"span",62),O(3,"span"),Y(4,"Educaci\xF3n Secundaria (bajo)"),F()(),O(5,"div",46),Te(6,"span",63),O(7,"span"),Y(8,"Educaci\xF3n Secundaria (medio)"),F()(),O(9,"div",46),Te(10,"span",64),O(11,"span"),Y(12,"Educaci\xF3n Secundaria (alto)"),F()()())}function Kk(c,a){c&1&&(O(0,"div")(1,"div",46),Te(2,"span",65),O(3,"span"),Y(4,"Educaci\xF3n Superior (bajo)"),F()(),O(5,"div",46),Te(6,"span",66),O(7,"span"),Y(8,"Educaci\xF3n Superior (medio)"),F()(),O(9,"div",46),Te(10,"span",67),O(11,"span"),Y(12,"Educaci\xF3n Superior (alto)"),F()()())}function Qk(c,a){if(c&1&&(O(0,"mat-option",68),Y(1),F()),c&2){let i=a.$implicit;Oe("value",i),re(),St(i)}}function Jk(c,a){if(c&1&&(O(0,"mat-button-toggle",68),Y(1),F()),c&2){let i=a.$implicit;Oe("value",i.value),re(),St(i.label)}}function eA(c,a){if(c&1&&(O(0,"mat-button-toggle",68),Y(1),F()),c&2){let i=a.$implicit;Oe("value",i.value),re(),St(i.label)}}function tA(c,a){if(c&1&&(O(0,"mat-card-subtitle"),Y(1),F()),c&2){let i=ze();re(),Ot("Comuna: ",i.selectedComuna,"")}}function iA(c,a){c&1&&(O(0,"mat-card-subtitle"),Y(1,"Todas las comunas"),F())}function nA(c,a){if(c&1&&(O(0,"div",32),Te(1,"span",69),O(2,"span"),Y(3),xn(4,"number"),F()()),c&2){let i=a.$implicit,l=ze();re(),qr("background-color",l.getAgeColor(i.value)),re(2),Ko("",i.label,": ",Hn(4,4,l.ageDistribution[i.value],"1.1-1"),"%")}}function rA(c,a){if(c&1){let i=Xt();O(0,"div",70)(1,"div",71)(2,"button",72),tt("click",function(){mt(i);let h=ze();return ft(h.closeModal())}),Y(3,"\xD7"),F(),O(4,"h4"),Y(5),F(),O(6,"p")(7,"strong"),Y(8,"Comuna:"),F(),Y(9),F(),O(10,"p")(11,"strong"),Y(12,"Poblaci\xF3n:"),F(),Y(13),F(),O(14,"p")(15,"strong"),Y(16,"Densidad:"),F(),Y(17),F(),O(18,"p")(19,"strong"),Y(20,"Acceso a internet:"),F(),Y(21),F(),O(22,"p")(23,"strong"),Y(24,"Acceso a agua:"),F(),Y(25),F(),O(26,"p")(27,"strong"),Y(28,"Acceso a gas:"),F(),Y(29),F(),O(30,"p")(31,"strong"),Y(32,"Adultos mayores (60+):"),F(),Y(33),F(),O(34,"strong"),Y(35,"Educaci\xF3n:"),F(),Te(36,"br"),Y(37),Te(38,"br"),Y(39),Te(40,"br"),Y(41),F()()}if(c&2){let i=ze();re(5),Ot("Manzana ",(i.selectedFeature.properties==null?null:i.selectedFeature.properties.cod_dane_a)||"N/A",""),re(4),Ot(" ",(i.selectedFeature.properties==null?null:i.selectedFeature.properties.nmb_lc_cm)||"N/A",""),re(4),Ot(" ",(i.selectedFeature.properties==null?null:i.selectedFeature.properties.tp27_perso)||"0",""),re(4),Ot(" ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.populationDensity)||0).toFixed(2)," pers/m\xB2"),re(4),Ot(" ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.internetAccess)||0).toFixed(1),"%"),re(4),Ot(" ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.waterAccess)||0).toFixed(1),"%"),re(4),Ot(" ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.gasAccess)||0).toFixed(1),"%"),re(4),Ot(" ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.elderlyPercentage)||0).toFixed(1),"% "),re(4),Ot(" - Primaria: ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.educationPrimary)||0).toFixed(1),"%"),re(2),Ot(" - Secundaria: ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.educationSecondary)||0).toFixed(1),"%"),re(2),Ot(" - Superior: ",((i.selectedFeature.properties==null?null:i.selectedFeature.properties.educationHigher)||0).toFixed(1),"% ")}}var Ig=class c{constructor(a,i){this.platformId=a;this.http=i}map;data=[];popup=null;selectedFeature=null;isLoading=!0;error=!1;selectedComuna="";selectedAgeGroup="";selectedEducationLevel="";internetAccessFilter="all";zoomLevel=12;comunas=[];ageGroups=[{value:"0-14",label:"0-14 a\xF1os"},{value:"15-59",label:"15-59 a\xF1os"},{value:"60+",label:"60+ a\xF1os"}];educationLevels=[{value:"primary",label:"Primaria"},{value:"secondary",label:"Secundaria"},{value:"higher",label:"Superior"}];ngOnInit(){this.fetchData()}ngOnDestroy(){this.map&&this.map.remove(),this.popup&&this.popup.remove(),this.selectedFeature=null}get filteredData(){let a=this.data;return this.selectedComuna&&(a=a.filter(i=>i.nmb_lc_cm===this.selectedComuna)),this.internetAccessFilter==="high"?a=a.filter(i=>i.tp19_inte1/(i.tvivienda||1)>.7):this.internetAccessFilter==="low"&&(a=a.filter(i=>i.tp19_inte1/(i.tvivienda||1)<=.3)),a}get totalPopulation(){return this.filteredData.reduce((a,i)=>a+(i.tp27_perso||0),0)}get totalHomes(){return this.filteredData.reduce((a,i)=>a+(i.tvivienda||0),0)}get internetAccessPercentage(){let a=this.filteredData.reduce((l,h)=>l+(h.tp19_inte1||0),0),i=this.totalHomes||1;return a/i*100}get waterAccessPercentage(){let a=this.filteredData.reduce((l,h)=>l+(h.tp19_acu_1||0),0),i=this.totalHomes||1;return a/i*100}get gasAccessPercentage(){let a=this.filteredData.reduce((l,h)=>l+(h.tp19_gas_1||0),0),i=this.totalHomes||1;return a/i*100}get ageDistribution(){let a={"0-14":0,"15-59":0,"60+":0};this.filteredData.forEach(l=>{a["0-14"]+=(l.tp34_1_eda||0)+(l.tp34_2_eda||0)+(l.tp34_3_eda||0),a["15-59"]+=(l.tp34_4_eda||0)+(l.tp34_5_eda||0)+(l.tp34_6_eda||0),a["60+"]+=(l.tp34_7_eda||0)+(l.tp34_8_eda||0)+(l.tp34_9_eda||0)});let i=a["0-14"]+a["15-59"]+a["60+"]||1;return{"0-14":a["0-14"]/i*100,"15-59":a["15-59"]/i*100,"60+":a["60+"]/i*100}}get educationDistribution(){let a={primary:0,secondary:0,higher:0,other:0};this.filteredData.forEach(l=>{a.primary+=l.tp51primar||0,a.secondary+=l.tp51secund||0,a.higher+=l.tp51superi||0,a.other+=l.tp51_99_ed||0});let i=a.primary+a.secondary+a.higher+a.other||1;return{primary:a.primary/i*100,secondary:a.secondary/i*100,higher:a.higher/i*100,other:a.other/i*100}}fetchData(){Xh(this.platformId)&&(this.isLoading=!0,this.error=!1,this.http.get("https://www.medellin.gov.co/flask-fiware/api/wifi-dane/all").pipe(Hb(6e4),na(a=>(console.error("Error fetching data (timeout o fallo de red):",a),this.error=!0,this.isLoading=!1,bt([])))).subscribe({next:a=>{this.data=a,Xh(this.platformId)&&(this.processData(),this.initMap()),this.isLoading=!1},error:a=>{console.error("Error en la suscripci\xF3n del observable:",a),this.error=!0,this.isLoading=!1}}))}processData(){let a=new Set;this.data.forEach(i=>a.add(i.nmb_lc_cm)),this.comunas=Array.from(a).sort()}initMap(){this.map=new ZC.Map({container:"map",style:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[-75.5454,6.2512],zoom:this.zoomLevel}),this.map.on("load",()=>{this.addDataToMap()}),this.map.on("zoomend",()=>{this.zoomLevel=this.map.getZoom(),this.updateMapLayers()})}addDataToMap(){let a={type:"FeatureCollection",features:this.data.map((i,l)=>({type:"Feature",id:l,geometry:{type:"Point",coordinates:[i.longitud,i.latitud]},properties:di(Qe({},i),{populationDensity:(i.tp27_perso||0)/(i.area||1),internetAccess:(i.tp19_inte1||0)/(i.tvivienda||1)*100,waterAccess:(i.tp19_acu_1||0)/(i.tvivienda||1)*100,gasAccess:(i.tp19_gas_1||0)/(i.tvivienda||1)*100,educationPrimary:(i.tp51primar||0)/(i.tp27_perso||1)*100,educationSecondary:(i.tp51secund||0)/(i.tp27_perso||1)*100,educationHigher:(i.tp51superi||0)/(i.tp27_perso||1)*100,elderlyPercentage:(i.tp34_7_eda+i.tp34_8_eda+i.tp34_9_eda||0)/(i.tp27_perso||1)*100})}))};this.map.addSource("wifi-data",{type:"geojson",data:a,generateId:!0}),this.map.addLayer({id:"wifi-points",type:"circle",source:"wifi-data",paint:{"circle-radius":["interpolate",["linear"],["zoom"],10,6,15,12],"circle-color":["case",["boolean",["feature-state","selected"],!1],"#ff00ff",["interpolate",["linear"],["get","internetAccess"],0,"#ff0000",50,"#ffff00",100,"#00ff00"]],"circle-opacity":.9,"circle-stroke-width":["case",["boolean",["feature-state","selected"],!1],3,1],"circle-stroke-color":"#ffffff"}}),this.map.on("click","wifi-points",i=>{i.features&&i.features.length>0&&this.showPopup(i.features[0])}),this.map.on("click",i=>{this.map.queryRenderedFeatures(i.point,{layers:["wifi-points"]}).length===0&&this.popup&&(this.clearSelectedFeature(),this.popup.remove(),this.popup=null)}),this.map.on("mouseenter","wifi-points",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","wifi-points",()=>{this.map.getCanvas().style.cursor=""})}clearSelectedFeature(){this.selectedFeature&&(this.map.getLayer("wifi-points")&&this.map.setFeatureState({source:"wifi-data",id:this.selectedFeature.id},{selected:!1}),this.selectedFeature=null)}showPopup(a){if(this.clearSelectedFeature(),!a.geometry||!a.geometry.coordinates){console.error("Feature geometry is invalid:",a);return}this.selectedFeature=a,this.map.setFeatureState({source:"wifi-data",id:a.id},{selected:!0})}closeModal(){this.clearSelectedFeature(),this.selectedFeature=null}updateMapLayers(){if(!this.map.getLayer("wifi-points"))return;let a=["interpolate",["linear"],["get","internetAccess"],0,"#ff0000",50,"#ffff00",100,"#00ff00"];this.selectedAgeGroup==="0-14"?a=["interpolate",["linear"],["/",["+",["get","tp34_1_eda"],["get","tp34_2_eda"],["get","tp34_3_eda"]],["get","tp27_perso"]],0,"#ffebee",.5,"#ffcdd2",1,"#ef9a9a"]:this.selectedAgeGroup==="15-59"?a=["interpolate",["linear"],["/",["+",["get","tp34_4_eda"],["get","tp34_5_eda"],["get","tp34_6_eda"]],["get","tp27_perso"]],0,"#e8f5e9",.5,"#c8e6c9",1,"#a5d6a7"]:this.selectedAgeGroup==="60+"?a=["interpolate",["linear"],["/",["+",["get","tp34_7_eda"],["get","tp34_8_eda"],["get","tp34_9_eda"]],["get","tp27_perso"]],0,"#e3f2fd",.5,"#bbdefb",1,"#90caf9"]:this.selectedEducationLevel==="primary"?a=["interpolate",["linear"],["get","educationPrimary"],0,"#fff3e0",50,"#ffe0b2",100,"#ffcc80"]:this.selectedEducationLevel==="secondary"?a=["interpolate",["linear"],["get","educationSecondary"],0,"#f3e5f5",50,"#e1bee7",100,"#ce93d8"]:this.selectedEducationLevel==="higher"&&(a=["interpolate",["linear"],["get","educationHigher"],0,"#e0f7fa",50,"#b2ebf2",100,"#80deea"]),this.map.setPaintProperty("wifi-points","circle-color",a),this.selectedComuna?this.map.setFilter("wifi-points",["==",["get","nmb_lc_cm"],this.selectedComuna]):this.map.setFilter("wifi-points",null),this.map.setPaintProperty("wifi-points","circle-radius",["interpolate",["linear"],["zoom"],10,3,15,8])}applyFilters(){this.updateMapLayers()}resetFilters(){this.selectedComuna="",this.selectedAgeGroup="",this.selectedEducationLevel="",this.internetAccessFilter="all",this.applyFilters()}getAgeColor(a){switch(a){case"0-14":return"#ef9a9a";case"15-59":return"#a5d6a7";case"60+":return"#90caf9";default:return"#bdbdbd"}}static \u0275fac=function(i){return new(i||c)(It(Ps),It(Ao))};static \u0275cmp=rt({type:c,selectors:[["app-wifi-maps"]],decls:144,vars:68,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],[1,"dashboard-container"],[1,"map-container"],["class","loading-overlay",4,"ngIf"],["class","error-overlay",4,"ngIf"],["id","map",1,"map"],[1,"map-legend"],[4,"ngIf"],[1,"controls-container"],[1,"filters-card"],[1,"filter-group"],["appearance","outline"],[3,"ngModelChange","selectionChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"ngModelChange","change","ngModel"],["value","all"],["value","high"],["value","low"],["mat-raised-button","","color","warn",3,"click"],[1,"stats-card"],[1,"stat-item"],[1,"charts-card"],[1,"chart-container"],[1,"chart-legend"],["class","chart-legend-item",4,"ngFor","ngForOf"],[1,"chart-bar"],[1,"chart-bar-segment",2,"background-color","#ef9a9a"],[1,"chart-bar-segment",2,"background-color","#a5d6a7"],[1,"chart-bar-segment",2,"background-color","#90caf9"],[1,"chart-legend-item"],[1,"chart-legend-color",2,"background-color","#ffcc80"],[1,"chart-legend-color",2,"background-color","#ce93d8"],[1,"chart-legend-color",2,"background-color","#80deea"],[1,"chart-legend-color",2,"background-color","#bdbdbd"],[1,"chart-bar-segment",2,"background-color","#ffcc80"],[1,"chart-bar-segment",2,"background-color","#ce93d8"],[1,"chart-bar-segment",2,"background-color","#80deea"],[1,"chart-bar-segment",2,"background-color","#bdbdbd"],["class","modal-overlay",4,"ngIf"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/cd625ad1-09dd-4109-be18-34cffbf9ab79/medellin-dane-geomanzanas?orgId=1&kiosk`,"allowfullscreen","",1,"large-iframe"],[1,"loading-overlay"],[1,"error-overlay"],["mat-raised-button","","color","primary",3,"click"],[1,"legend-item"],[1,"legend-color",2,"background-color","#ff0000"],[1,"legend-color",2,"background-color","#ffff00"],[1,"legend-color",2,"background-color","#00ff00"],[1,"legend-color",2,"background-color","#ffebee"],[1,"legend-color",2,"background-color","#ffcdd2"],[1,"legend-color",2,"background-color","#ef9a9a"],[1,"legend-color",2,"background-color","#e8f5e9"],[1,"legend-color",2,"background-color","#c8e6c9"],[1,"legend-color",2,"background-color","#a5d6a7"],[1,"legend-color",2,"background-color","#e3f2fd"],[1,"legend-color",2,"background-color","#bbdefb"],[1,"legend-color",2,"background-color","#90caf9"],[1,"legend-color",2,"background-color","#fff3e0"],[1,"legend-color",2,"background-color","#ffe0b2"],[1,"legend-color",2,"background-color","#ffcc80"],[1,"legend-color",2,"background-color","#f3e5f5"],[1,"legend-color",2,"background-color","#e1bee7"],[1,"legend-color",2,"background-color","#ce93d8"],[1,"legend-color",2,"background-color","#e0f7fa"],[1,"legend-color",2,"background-color","#b2ebf2"],[1,"legend-color",2,"background-color","#80deea"],[3,"value"],[1,"chart-legend-color"],[1,"modal-overlay"],[1,"modal-content"],[1,"close-btn",3,"click"]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Ciudad Inteligente - Puntos Wifi"),F(),O(2,"div",1),Te(3,"div",2),F(),Te(4,"div",1),O(5,"div",3)(6,"div",4),Xe(7,$k,4,0,"div",5)(8,Gk,7,0,"div",6),Te(9,"div",7),O(10,"div",8)(11,"h4"),Y(12,"Leyenda"),F(),Xe(13,Hk,13,0,"div",9)(14,Zk,13,0,"div",9)(15,Wk,13,0,"div",9)(16,qk,13,0,"div",9)(17,Xk,13,0,"div",9)(18,Yk,13,0,"div",9)(19,Kk,13,0,"div",9),F()(),O(20,"div",10)(21,"mat-card",11)(22,"mat-card-header")(23,"mat-card-title"),Y(24,"Filtros"),F()(),O(25,"mat-card-content")(26,"div",12)(27,"mat-form-field",13)(28,"mat-label"),Y(29,"Comuna"),F(),O(30,"mat-select",14),ir("ngModelChange",function(s){return tr(l.selectedComuna,s)||(l.selectedComuna=s),s}),tt("selectionChange",function(){return l.applyFilters()}),O(31,"mat-option",15),Y(32,"Todas las comunas"),F(),Xe(33,Qk,2,2,"mat-option",16),F()()(),O(34,"div",12)(35,"h4"),Y(36,"Grupo etario"),F(),O(37,"mat-button-toggle-group",17),ir("ngModelChange",function(s){return tr(l.selectedAgeGroup,s)||(l.selectedAgeGroup=s),s}),tt("change",function(){return l.applyFilters()}),O(38,"mat-button-toggle",15),Y(39,"Todos"),F(),Xe(40,Jk,2,2,"mat-button-toggle",16),F()(),O(41,"div",12)(42,"h4"),Y(43,"Nivel educativo"),F(),O(44,"mat-button-toggle-group",17),ir("ngModelChange",function(s){return tr(l.selectedEducationLevel,s)||(l.selectedEducationLevel=s),s}),tt("change",function(){return l.applyFilters()}),O(45,"mat-button-toggle",15),Y(46,"Todos"),F(),Xe(47,eA,2,2,"mat-button-toggle",16),F()(),O(48,"div",12)(49,"h4"),Y(50,"Acceso a internet"),F(),O(51,"mat-button-toggle-group",17),ir("ngModelChange",function(s){return tr(l.internetAccessFilter,s)||(l.internetAccessFilter=s),s}),tt("change",function(){return l.applyFilters()}),O(52,"mat-button-toggle",18),Y(53,"Todos"),F(),O(54,"mat-button-toggle",19),Y(55,"Alto (>70%)"),F(),O(56,"mat-button-toggle",20),Y(57,"Bajo (\u226430%)"),F()()(),O(58,"div",12)(59,"button",21),tt("click",function(){return l.resetFilters()}),Y(60,"Reiniciar filtros"),F()()()(),O(61,"mat-card",22)(62,"mat-card-header")(63,"mat-card-title"),Y(64,"Estad\xEDsticas"),F(),Xe(65,tA,2,1,"mat-card-subtitle",9)(66,iA,2,0,"mat-card-subtitle",9),F(),O(67,"mat-card-content")(68,"div",23)(69,"h4"),Y(70,"Poblaci\xF3n total"),F(),O(71,"p"),Y(72),xn(73,"number"),F()(),O(74,"div",23)(75,"h4"),Y(76,"Viviendas totales"),F(),O(77,"p"),Y(78),xn(79,"number"),F()(),O(80,"div",23)(81,"h4"),Y(82,"Acceso a internet"),F(),O(83,"p"),Y(84),xn(85,"number"),F()(),O(86,"div",23)(87,"h4"),Y(88,"Acceso a agua potable"),F(),O(89,"p"),Y(90),xn(91,"number"),F()(),O(92,"div",23)(93,"h4"),Y(94,"Acceso a gas natural"),F(),O(95,"p"),Y(96),xn(97,"number"),F()()()(),O(98,"mat-card",24)(99,"mat-card-header")(100,"mat-card-title"),Y(101,"Distribuci\xF3n"),F()(),O(102,"mat-card-content")(103,"div",25)(104,"h4"),Y(105,"Distribuci\xF3n por edad"),F(),O(106,"div",26),Xe(107,nA,5,7,"div",27),F(),O(108,"div",28),Te(109,"div",29)(110,"div",30)(111,"div",31),F()(),O(112,"div",25)(113,"h4"),Y(114,"Nivel educativo"),F(),O(115,"div",26)(116,"div",32),Te(117,"span",33),O(118,"span"),Y(119),xn(120,"number"),F()(),O(121,"div",32),Te(122,"span",34),O(123,"span"),Y(124),xn(125,"number"),F()(),O(126,"div",32),Te(127,"span",35),O(128,"span"),Y(129),xn(130,"number"),F()(),O(131,"div",32),Te(132,"span",36),O(133,"span"),Y(134),xn(135,"number"),F()()(),O(136,"div",28),Te(137,"div",37)(138,"div",38)(139,"div",39)(140,"div",40),F()()()()(),Xe(141,rA,42,11,"div",41),F(),O(142,"div",1),Te(143,"iframe",42),F()),i&2&&(re(7),Oe("ngIf",l.isLoading),re(),Oe("ngIf",l.error),re(5),Oe("ngIf",!l.selectedAgeGroup&&!l.selectedEducationLevel),re(),Oe("ngIf",l.selectedAgeGroup==="0-14"),re(),Oe("ngIf",l.selectedAgeGroup==="15-59"),re(),Oe("ngIf",l.selectedAgeGroup==="60+"),re(),Oe("ngIf",l.selectedEducationLevel==="primary"),re(),Oe("ngIf",l.selectedEducationLevel==="secondary"),re(),Oe("ngIf",l.selectedEducationLevel==="higher"),re(11),er("ngModel",l.selectedComuna),re(3),Oe("ngForOf",l.comunas),re(4),er("ngModel",l.selectedAgeGroup),re(3),Oe("ngForOf",l.ageGroups),re(4),er("ngModel",l.selectedEducationLevel),re(3),Oe("ngForOf",l.educationLevels),re(4),er("ngModel",l.internetAccessFilter),re(14),Oe("ngIf",l.selectedComuna),re(),Oe("ngIf",!l.selectedComuna),re(6),St(q_(73,43,l.totalPopulation)),re(6),St(q_(79,45,l.totalHomes)),re(6),Ot("",Hn(85,47,l.internetAccessPercentage,"1.1-1"),"%"),re(6),Ot("",Hn(91,50,l.waterAccessPercentage,"1.1-1"),"%"),re(6),Ot("",Hn(97,53,l.gasAccessPercentage,"1.1-1"),"%"),re(11),Oe("ngForOf",l.ageGroups),re(2),qr("width",l.ageDistribution["0-14"],"%"),re(),qr("width",l.ageDistribution["15-59"],"%"),re(),qr("width",l.ageDistribution["60+"],"%"),re(8),Ot("Primaria: ",Hn(120,56,l.educationDistribution.primary,"1.1-1"),"%"),re(5),Ot("Secundaria: ",Hn(125,59,l.educationDistribution.secondary,"1.1-1"),"%"),re(5),Ot("Superior: ",Hn(130,62,l.educationDistribution.higher,"1.1-1"),"%"),re(5),Ot("Otros: ",Hn(135,65,l.educationDistribution.other,"1.1-1"),"%"),re(3),qr("width",l.educationDistribution.primary,"%"),re(),qr("width",l.educationDistribution.secondary,"%"),re(),qr("width",l.educationDistribution.higher,"%"),re(),qr("width",l.educationDistribution.other,"%"),re(),Oe("ngIf",l.selectedFeature))},dependencies:[nr,Qo,co,pu,ac,ca,il,dC,oC,aC,cC,lC,sC,sa,BC,OC,Mg,zC,ig,NC,cc,Lu,UC,Wy,Pg,Tg,Eg],styles:[".dashboard-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:70vw;height:70vh;margin-left:25%;overflow:hidden}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]{width:444px;background:#f5f5f5;padding:16px;overflow-y:auto;max-height:100vh;z-index:10;box-shadow:2px 0 6px #0000001a;flex-shrink:0}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{width:100%}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{flex:1}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-weight:500;color:#0009;font-size:14px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{margin-bottom:24px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-legend[_ngcontent-%COMP%]{margin-bottom:8px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-legend[_ngcontent-%COMP%]   .chart-legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:4px;font-size:12px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-legend[_ngcontent-%COMP%]   .chart-legend-item[_ngcontent-%COMP%]   .chart-legend-color[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;margin-right:8px;border-radius:2px}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-bar[_ngcontent-%COMP%]{height:20px;background:#e0e0e0;border-radius:4px;overflow:hidden;display:flex}.dashboard-container[_ngcontent-%COMP%]   .controls-container[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-bar[_ngcontent-%COMP%]   .chart-bar-segment[_ngcontent-%COMP%]{height:100%}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;align-items:stretch;justify-content:center}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:0}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   #map[_ngcontent-%COMP%]{width:100%;height:100%;min-height:500px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%], .dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .error-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffffff2;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .error-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:red;margin-bottom:16px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]{position:absolute;bottom:20px;right:20px;background:#fff;padding:10px;border-radius:4px;box-shadow:0 2px 4px #0003;z-index:10;max-width:250px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:4px}.dashboard-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px;margin-right:8px;border-radius:50%;border:1px solid #ccc}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.modal-overlay[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:#fff;max-width:400px;width:90%;padding:20px;border-radius:8px;box-shadow:0 5px 15px #0000004d;position:relative;animation:_ngcontent-%COMP%_scaleIn .3s ease-out}.modal-overlay[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#1976d2;margin-top:0;margin-bottom:15px;font-size:1.2rem}.modal-overlay[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:#666;line-height:1;padding:0 5px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}","body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.small-iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.large-iframe[_ngcontent-%COMP%]{height:700px;border:none}"]})};var kg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-vamosmedmap"]],decls:9,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740220806985&to=1740393606985&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740220846838&to=1740393646839&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740220882021&to=1740393682021&viewPanel=26&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/vm_ma/vamosmed-map?orgId=1&from=1740221071260&to=1740393871260&viewPanel=27&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Ciudad Inteligente - VamosMed"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),F()(),O(7,"div",1),Te(8,"iframe",6),F())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var Ky=ou(Yy());var oA=["map"];function sA(c,a){c&1&&(O(0,"div",28),Y(1," Cargando sensores... "),F())}function aA(c,a){if(c&1){let i=Xt();O(0,"div",29),Y(1),O(2,"button",30),tt("click",function(){mt(i);let h=ze();return ft(h.loadSensors())}),Y(3,"Reintentar"),F()()}if(c&2){let i=ze();re(),Ot(" ",i.errorMessage," ")}}function lA(c,a){if(c&1&&(O(0,"option",35),Y(1),F()),c&2){let i=a.$implicit,l=ze(2);Oe("value",i.entity_id),re(),Ko(" ",l.getShortId(i.entity_id)," - ",i.laeq_slow," dB ")}}function cA(c,a){if(c&1&&(O(0,"div",36),Y(1),F()),c&2){let i=ze(2);re(),Ot(" Sensor seleccionado: ",i.getShortId(i.selectedSensor)," ")}}function dA(c,a){if(c&1){let i=Xt();O(0,"div")(1,"select",31),ir("ngModelChange",function(h){mt(i);let s=ze();return tr(s.selectedSensor,h)||(s.selectedSensor=h),ft(h)}),tt("change",function(){mt(i);let h=ze();return ft(h.onSensorSelect())}),O(2,"option",32),Y(3,"Selecciona un sensor"),F(),Xe(4,lA,2,3,"option",33),F(),Xe(5,cA,2,1,"div",34),F()}if(c&2){let i=ze();re(),er("ngModel",i.selectedSensor),re(3),Oe("ngForOf",i.sensors),re(),Oe("ngIf",i.selectedSensor)}}function uA(c,a){if(c&1&&(O(0,"div",29),Y(1),F()),c&2){let i=ze();re(),Ot(" ",i.errorHistoric," ")}}function hA(c,a){if(c&1&&(O(0,"div",37)(1,"h3"),Y(2),xn(3,"number"),F(),Te(4,"div",38),F()),c&2){let i=ze();re(2),Ot("Resultados hist\xF3ricos (promedio: ",Hn(3,1,i.historicAvg,"1.1-1")," dB)")}}function pA(c,a){c&1&&(O(0,"div",39),Te(1,"mat-spinner"),O(2,"p"),Y(3,"Cargando datos de sensores..."),F()())}function mA(c,a){if(c&1){let i=Xt();O(0,"div",40)(1,"mat-icon"),Y(2,"error_outline"),F(),O(3,"p"),Y(4,"Error al cargar los datos de los sensores"),F(),O(5,"button",41),tt("click",function(){mt(i);let h=ze();return ft(h.loadSensorData())}),Y(6,"Reintentar"),F()()}}function fA(c,a){if(c&1&&(O(0,"div",46)(1,"span",47),Y(2,"Promedio hist\xF3rico:"),F(),O(3,"span",48),Y(4),xn(5,"number"),F()()),c&2){let i=ze(2);re(4),Ot("",Hn(5,1,i.historicAvg,"1.1-1")," dB")}}function gA(c,a){if(c&1){let i=Xt();O(0,"div",42)(1,"div",43)(2,"h3"),Y(3,"Detalles del Sensor"),F(),O(4,"button",44),tt("click",function(){mt(i);let h=ze();return ft(h.closeDetails())}),O(5,"mat-icon"),Y(6,"close"),F()()(),O(7,"div",45)(8,"div",46)(9,"span",47),Y(10,"ID:"),F(),O(11,"span",48),Y(12),F()(),O(13,"div",46)(14,"span",47),Y(15,"Nivel de Ruido:"),F(),O(16,"span",48),Y(17),F()(),O(18,"div",46)(19,"span",47),Y(20,"\xDAltima actualizaci\xF3n:"),F(),O(21,"span",48),Y(22),xn(23,"date"),F()(),Xe(24,fA,6,4,"div",49),F()()}if(c&2){let i=ze();re(12),St(i.getShortId(i.selectedSensorDetails.id)),re(5),Ko("",i.selectedSensorDetails.laeq," dB (",i.selectedSensorDetails.levelName,")"),re(5),St(Hn(23,5,i.selectedSensorDetails.lastUpdate,"medium")),re(2),Oe("ngIf",i.historicAvg)}}var Ag=class c{constructor(a){this.http=a}mapContainer;map=null;apiUrl="https://www.medellin.gov.co/flask-fiware/api/sensores-ruido";sensors=[];selectedSensor="";selectedSensorDetails=null;historicData=[];historicAvg=0;desdeFecha="";hastaFecha="";loading=!0;isLoading=!0;loadingHistoric=!1;error=!1;errorMessage="";errorHistoric=null;ngOnInit(){this.loadSensors(),this.setDefaultDates()}ngAfterViewInit(){this.initMap()}initMap(){this.map=new Ky.default.Map({container:this.mapContainer.nativeElement,style:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[-75.573,6.244],zoom:14}),this.map.addControl(new Ky.default.NavigationControl),this.map.on("load",()=>this.addSensorsToMap())}loadSensors(){this.isLoading=!0,this.errorMessage="",this.http.get(this.apiUrl).subscribe({next:a=>{this.sensors=a.map(i=>di(Qe({},i),{noiseLevel:this.getNoiseLevel(i.laeq_slow),levelName:this.translateLevel(this.getNoiseLevel(i.laeq_slow))})),this.isLoading=!1,this.loadSensorData()},error:a=>{this.errorMessage="Error al cargar los sensores. Por favor intenta nuevamente.",this.isLoading=!1,console.error("Error fetching sensors:",a)}})}loadSensorData(){this.loading=!0,this.error=!1,this.http.get(this.apiUrl).subscribe({next:a=>{this.sensors=a.map(i=>di(Qe({},i),{noiseLevel:this.getNoiseLevel(i.laeq_slow),levelName:this.translateLevel(this.getNoiseLevel(i.laeq_slow))})),this.addSensorsToMap(),this.loading=!1},error:a=>{console.error("Error loading sensor data:",a),this.error=!0,this.loading=!1}})}setDefaultDates(){let a=new Date,i=new Date;i.setDate(a.getDate()-7),this.desdeFecha=this.formatDate(i),this.hastaFecha=this.formatDate(a)}formatDate(a){return a.toISOString().split("T")[0]}onSensorSelect(){if(!this.selectedSensor)return;let a=this.sensors.find(i=>i.entity_id===this.selectedSensor);a&&(this.selectedSensorDetails={id:a.entity_id,laeq:a.laeq_slow,levelName:a.levelName,lastUpdate:a.fecha_ultimo_registro},this.map&&this.map.flyTo({center:[parseFloat(a.longitud),parseFloat(a.latitud)],zoom:16}),this.historicData=[],this.historicAvg=0)}getHistoricData(){if(!this.selectedSensor||!this.desdeFecha||!this.hastaFecha){this.errorHistoric="Por favor selecciona un sensor y ambas fechas";return}this.loadingHistoric=!0,this.errorHistoric=null;let a=`${this.desdeFecha} 00:00:00`,i=`${this.hastaFecha} 23:59:59`;this.getHistoricoNoise(this.selectedSensor,a,i).subscribe({next:l=>{this.historicData=l,this.calculateHistoricAvg(),this.updateMapWithHistoricalData(),this.loadingHistoric=!1},error:l=>{this.errorHistoric="Error al cargar datos hist\xF3ricos",this.loadingHistoric=!1,console.error("Error fetching historic data:",l)}})}calculateHistoricAvg(){if(this.historicData.length===0){this.historicAvg=0;return}let a=this.historicData.reduce((i,l)=>i+l.laeq_slow,0);this.historicAvg=parseFloat((a/this.historicData.length).toFixed(1))}updateMapWithHistoricalData(){if(!this.map||!this.map.isStyleLoaded())return;let a=this.sensors.findIndex(i=>i.entity_id===this.selectedSensor);a!==-1&&(this.sensors[a]=di(Qe({},this.sensors[a]),{laeq_slow:this.historicAvg,noiseLevel:this.getNoiseLevel(this.historicAvg),levelName:this.translateLevel(this.getNoiseLevel(this.historicAvg))}),this.addSensorsToMap(),this.selectedSensorDetails&&(this.selectedSensorDetails=di(Qe({},this.selectedSensorDetails),{laeq:this.historicAvg,levelName:this.translateLevel(this.getNoiseLevel(this.historicAvg))})))}getHistoricoNoise(a,i,l){let h=new oa().set("desde",i).set("hasta",l),s=`${this.apiUrl}/${encodeURIComponent(a)}/historico`;return this.http.get(s,{params:h})}addSensorsToMap(){!this.map||!this.map.isStyleLoaded()||(this.map.getSource("sensors")&&(this.map.removeLayer("sensors-circle"),this.map.removeLayer("sensors-labels"),this.map.removeSource("sensors")),this.map.addSource("sensors",{type:"geojson",data:{type:"FeatureCollection",features:this.sensors.map(a=>({type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(a.longitud),parseFloat(a.latitud)]},properties:{id:a.entity_id,laeq:a.laeq_slow,level:a.noiseLevel,levelName:a.levelName,lastUpdate:a.fecha_ultimo_registro}}))}}),this.map.addLayer({id:"sensors-circle",type:"circle",source:"sensors",paint:{"circle-radius":["case",["==",["get","id"],this.selectedSensor],12,8],"circle-color":["match",["get","level"],"low","#4CAF50","moderate","#FFC107","high","#F44336","#9E9E9E"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),this.map.addLayer({id:"sensors-labels",type:"symbol",source:"sensors",layout:{"text-field":["get","laeq"],"text-size":12,"text-offset":[0,1.5]},paint:{"text-color":"#000000","text-halo-color":"#ffffff","text-halo-width":1}}),this.map.on("click","sensors-circle",a=>{let i=a.features[0].properties;this.selectedSensor=i.id,this.selectedSensorDetails={id:i.id,laeq:i.laeq,levelName:i.levelName,lastUpdate:i.lastUpdate},this.scrollToDetails()}),this.map.on("mouseenter","sensors-circle",()=>{this.map&&(this.map.getCanvas().style.cursor="pointer")}),this.map.on("mouseleave","sensors-circle",()=>{this.map&&(this.map.getCanvas().style.cursor="")}))}getNoiseLevel(a){return a<55?"low":a<=70?"moderate":"high"}translateLevel(a){return{low:"Bajo",moderate:"Moderado",high:"Alto"}[a]||a}getShortId(a){return a.split(":").pop()||a}scrollToDetails(){let a=document.getElementById("sensor-details");a&&a.scrollIntoView({behavior:"smooth"})}closeDetails(){this.selectedSensorDetails=null}static \u0275fac=function(i){return new(i||c)(It(Ao))};static \u0275cmp=rt({type:c,selectors:[["app-noise-sensor-map"]],viewQuery:function(i,l){if(i&1&&ln(oA,5),i&2){let h;wi(h=Ci())&&(l.mapContainer=h.first)}},decls:57,vars:13,consts:[["map",""],[1,"container"],[1,"page-title"],[1,"iframe-container"],[1,"date-controls"],[1,"sensor-container"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],[4,"ngIf"],["for","desde"],["type","date","id","desde",3,"ngModelChange","ngModel"],["for","hasta"],["type","date","id","hasta",3,"ngModelChange","ngModel"],[3,"click","disabled"],["class","historic-results",4,"ngIf"],[1,"map-container"],["class","loading-overlay",4,"ngIf"],["class","error-overlay",4,"ngIf"],[1,"map-layout"],[1,"half-layout"],["id","noise-sensor-map"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/f36b2714-61d2-45cd-91ac-58b622840b4e/sensores-ruido-2025?orgId=1&kiosk=tv`,"allowfullscreen","",2,"width","90%","height","100%","border","none","border-radius","12px"],["class","details-panel",4,"ngIf"],[1,"map-legend"],[1,"legend-item"],[1,"legend-color","low"],[1,"legend-color","moderate"],[1,"legend-color","high"],[1,"loading"],[1,"error"],[3,"click"],[1,"sensor-select",3,"ngModelChange","change","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["class","selected-info",4,"ngIf"],[3,"value"],[1,"selected-info"],[1,"historic-results"],[1,"chart-container"],[1,"loading-overlay"],[1,"error-overlay"],["mat-raised-button","","color","primary",3,"click"],[1,"details-panel"],[1,"panel-header"],["mat-icon-button","",3,"click"],["id","sensor-details",1,"sensor-details"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],["class","detail-row",4,"ngIf"]],template:function(i,l){if(i&1){let h=Xt();O(0,"div",1)(1,"h2",2),Y(2,"Ciudad Inteligente - Sensores de ruido"),F(),O(3,"div",3)(4,"h3"),Y(5),F(),O(6,"div",4)(7,"div",5)(8,"h2"),Y(9,"Selecciona un sensor de ruido"),F(),Xe(10,sA,2,0,"div",6)(11,aA,4,1,"div",7)(12,dA,6,3,"div",8),F(),O(13,"div")(14,"label",9),Y(15,"Desde:"),F(),O(16,"input",10),ir("ngModelChange",function(P){return mt(h),tr(l.desdeFecha,P)||(l.desdeFecha=P),ft(P)}),F()(),O(17,"div")(18,"label",11),Y(19,"Hasta:"),F(),O(20,"input",12),ir("ngModelChange",function(P){return mt(h),tr(l.hastaFecha,P)||(l.hastaFecha=P),ft(P)}),F()(),O(21,"div")(22,"button",13),tt("click",function(){return mt(h),ft(l.getHistoricData())}),Y(23),F()()(),Xe(24,uA,2,1,"div",7)(25,hA,5,4,"div",14),O(26,"h2"),Y(27,"\u{1F50A} Sensores de Ruido"),F(),O(28,"div",15)(29,"h3"),Y(30,"Tablero Ejecutivo"),F(),O(31,"h4"),Y(32,"Mapa de sensores"),F(),Xe(33,pA,4,0,"div",16)(34,mA,7,0,"div",17),O(35,"div",18)(36,"div",19),Te(37,"div",20,0),F(),O(39,"div",19),Te(40,"iframe",21),F(),Xe(41,gA,25,8,"div",22),F(),O(42,"div",23)(43,"h4"),Y(44,"Leyenda"),F(),O(45,"div",24),Te(46,"span",25),O(47,"span"),Y(48,"Bajo (<55 dB)"),F()(),O(49,"div",24),Te(50,"span",26),O(51,"span"),Y(52,"Moderado (55-70 dB)"),F()(),O(53,"div",24),Te(54,"span",27),O(55,"span"),Y(56,"Alto (>70 dB)"),F()()()()()()}i&2&&(re(5),Ot("Consultar hist\xF3rico para: ",l.getShortId(l.selectedSensor),""),re(5),Oe("ngIf",l.isLoading),re(),Oe("ngIf",l.errorMessage),re(),Oe("ngIf",!l.isLoading&&!l.errorMessage),re(4),er("ngModel",l.desdeFecha),re(4),er("ngModel",l.hastaFecha),re(2),Oe("disabled",!l.selectedSensor||l.loadingHistoric),re(),Ot(" ",l.loadingHistoric?"Cargando...":"Consultar"," "),re(),Oe("ngIf",l.errorHistoric),re(),Oe("ngIf",l.historicData.length>0),re(8),Oe("ngIf",l.loading),re(),Oe("ngIf",l.error),re(7),Oe("ngIf",l.selectedSensorDetails))},dependencies:[nr,Qo,co,pu,Qm,ac,Au,Du,la,sc,ca,il,cc,Lu,sa,Tg,Eg],styles:[`@charset "UTF-8";body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:#f4f7fa;overflow-x:hidden}.page-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:#333;text-align:left;padding:25px 30px;background-color:#fff;box-shadow:0 6px 15px #0000001a;margin:0 0 25px 300px;border-radius:0 0 12px 12px;text-shadow:1px 1px 2px rgba(0,0,0,.1);position:relative;z-index:10;border-bottom:4px solid #4CAF50;transform:perspective(500px) rotateX(1deg);transition:all .3s ease}.page-title[_ngcontent-%COMP%]:hover{transform:perspective(500px) rotateX(2deg);box-shadow:0 8px 20px #00000026}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:20px;gap:25px;background:linear-gradient(145deg,#fff,#f8f9fa);border-radius:12px;box-shadow:0 8px 25px #00000014;margin-bottom:30px;transition:all .3s ease}.iframe-container[_ngcontent-%COMP%]:hover{box-shadow:0 12px 30px #0000001f}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:25px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:280px;border:none;border-radius:10px;box-shadow:0 4px 15px #0000001a;transition:all .3s ease;transform:translateZ(0)}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:hover{transform:translateY(-5px) translateZ(10px);box-shadow:0 8px 25px #00000026}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:550px;border:none;border-radius:12px;box-shadow:0 6px 20px #0000001f;transition:all .3s ease}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe):hover{transform:translateY(-5px);box-shadow:0 10px 30px #0000002e}.map-container[_ngcontent-%COMP%]{position:relative;border-radius:15px;overflow:hidden;box-shadow:0 15px 35px #00000026;background:#fff;transform-style:preserve-3d;perspective:1000px;transition:all .4s ease}.map-container[_ngcontent-%COMP%]:hover{box-shadow:0 20px 40px #0003}.loading-overlay[_ngcontent-%COMP%], .error-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#ffffffe6;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000;border-radius:15px;animation:_ngcontent-%COMP%_fadeIn .5s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.loading-overlay[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{transform:scale(1.5);margin-bottom:20px}.error-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3.5rem;width:3.5rem;height:3.5rem;color:#f44336;margin-bottom:20px;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}.map-layout[_ngcontent-%COMP%]{display:flex;width:100%;height:650px;gap:25px;padding:25px;perspective:1500px}.half-layout[_ngcontent-%COMP%]{width:50%;height:100%;border-radius:15px;overflow:hidden;box-shadow:0 10px 30px #00000026;background:#fff;transition:all .4s ease;transform-style:preserve-3d;position:relative}.half-layout[_ngcontent-%COMP%]:hover{transform:translateY(-10px) rotateX(1deg);box-shadow:0 15px 40px #0003}.half-layout[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,#ffffff1a,#fff0);pointer-events:none;border-radius:15px}#noise-sensor-map[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:15px;transform:translateZ(0)}.details-panel[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) perspective(1000px) rotateY(0);width:350px;background:#fff;border-radius:12px;box-shadow:0 15px 35px #0003;z-index:1000;padding:20px;animation:_ngcontent-%COMP%_slideUp .4s cubic-bezier(.18,.89,.32,1.28);border:1px solid rgba(255,255,255,.3);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:#fffffff2;transform-style:preserve-3d}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translate(-50%,-30%) perspective(1000px) rotateY(10deg);opacity:0}to{transform:translate(-50%,-50%) perspective(1000px) rotateY(0);opacity:1}}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #eee}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.3rem;color:#333;text-shadow:1px 1px 2px rgba(0,0,0,.05)}.panel-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:#666;transition:all .2s ease}.panel-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#f44336;transform:rotate(90deg)}.sensor-details[_ngcontent-%COMP%]{font-size:.95rem}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px;padding:8px 10px;background:#f5f5f580;border-radius:8px;transition:all .2s ease}.detail-row[_ngcontent-%COMP%]:hover{background:#f5f5f5e6;transform:translate(5px)}.detail-label[_ngcontent-%COMP%]{font-weight:600;margin-right:10px;color:#555}.detail-value[_ngcontent-%COMP%]{font-weight:500;color:#333}.map-legend[_ngcontent-%COMP%]{position:absolute;bottom:30px;left:30px;background:#ffffffd9;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);padding:15px;border-radius:10px;box-shadow:0 8px 25px #00000026;z-index:100;transform:translateZ(20px);border:1px solid rgba(255,255,255,.3);animation:_ngcontent-%COMP%_float 6s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%{transform:translateY(0) translateZ(20px)}50%{transform:translateY(-10px) translateZ(20px)}to{transform:translateY(0) translateZ(20px)}}.map-legend[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:1.1rem;color:#333;text-align:center}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:8px;padding:5px 10px;border-radius:6px;transition:all .2s ease}.legend-item[_ngcontent-%COMP%]:hover{background:#0000000d;transform:translate(3px)}.legend-color[_ngcontent-%COMP%]{display:inline-block;width:18px;height:18px;border-radius:50%;margin-right:12px;border:2px solid white;box-shadow:0 2px 5px #0000001a;transition:all .3s ease}.legend-item[_ngcontent-%COMP%]:hover   .legend-color[_ngcontent-%COMP%]{transform:scale(1.2)}.legend-color.low[_ngcontent-%COMP%]{background-color:#4caf50}.legend-color.moderate[_ngcontent-%COMP%]{background-color:#ffc107}.legend-color.high[_ngcontent-%COMP%]{background-color:#f44336}.sensor-container[_ngcontent-%COMP%]{max-width:600px;margin:2rem 0 2rem 2rem;padding:1.5rem;background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;box-shadow:0 10px 30px #0000001a;display:flex;flex-direction:column;gap:1.2rem;border:1px solid rgba(255,255,255,.3);transform:perspective(500px) rotateY(-1deg);transition:all .3s ease}.sensor-container[_ngcontent-%COMP%]:hover{transform:perspective(500px) rotateY(0);box-shadow:0 15px 40px #00000026}.sensor-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.4rem;color:#333;text-shadow:1px 1px 2px rgba(0,0,0,.05)}.sensor-select[_ngcontent-%COMP%]{width:100%;padding:.8rem;font-size:1rem;border:1px solid #ddd;border-radius:8px;background:#fffc;box-shadow:inset 0 2px 5px #0000000d;transition:all .3s ease;appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .7rem center;background-size:1rem}.sensor-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50;box-shadow:0 0 0 3px #4caf5033}.selected-info[_ngcontent-%COMP%]{margin-top:1rem;padding:.8rem;background-color:#f8f9fa;border-radius:8px;border-left:4px solid #4CAF50;animation:_ngcontent-%COMP%_fadeIn .5s ease}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{padding:1.2rem;text-align:center;margin:1rem 0;border-radius:8px;animation:_ngcontent-%COMP%_fadeIn .5s ease}.loading[_ngcontent-%COMP%]{color:#666;background:#f5f5f5cc}.error[_ngcontent-%COMP%]{color:#d32f2f;background-color:#fde0e0e6;border-radius:8px;border-left:4px solid #d32f2f}.error[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:.8rem;padding:.6rem 1.2rem;background-color:#d32f2f;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 5px #0000001a}.error[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#b71c1c;transform:translateY(-2px);box-shadow:0 4px 8px #00000026}.date-controls[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:15px;align-items:center;padding:1rem;background:#fffffff2;border-radius:12px;box-shadow:0 5px 15px #00000014;margin-bottom:1.5rem}.date-controls[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:10px}.date-controls[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-right:8px;color:#555;font-size:.95rem}.date-controls[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.7rem;border:1px solid #ddd;border-radius:8px;background:#fffc;box-shadow:inset 0 2px 5px #0000000d;transition:all .3s ease}.date-controls[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50;box-shadow:0 0 0 3px #4caf5033}.date-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem 1.5rem;background:linear-gradient(135deg,#4caf50,#66bb6a);color:#fff;border:none;border-radius:8px;cursor:pointer;transition:all .3s ease;font-weight:600;box-shadow:0 4px 8px #4caf504d;text-transform:uppercase;letter-spacing:.5px}.date-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#43a047,#4caf50);transform:translateY(-3px);box-shadow:0 6px 12px #4caf5066}.date-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed;transform:none;box-shadow:none}.historic-results[_ngcontent-%COMP%]{margin-top:1.5rem;max-height:400px;overflow-y:auto;background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 5px 15px #00000014;animation:_ngcontent-%COMP%_slideUp .5s ease}.historic-results[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333;font-size:1.3rem;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #eee}.historic-results[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.historic-results[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .historic-results[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #eee}.historic-results[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#f8f9fa,#e9ecef);color:#333;font-weight:600;position:sticky;top:0}.historic-results[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#4caf500d}.container[_ngcontent-%COMP%]{margin-left:0;padding:2rem;width:100%;box-sizing:border-box;animation:_ngcontent-%COMP%_fadeIn .8s ease}@media (max-width: 1200px){.map-layout[_ngcontent-%COMP%]{flex-direction:column;height:auto}.half-layout[_ngcontent-%COMP%]{width:100%;height:500px;margin-bottom:20px}.map-container[_ngcontent-%COMP%], .iframe-container[_ngcontent-%COMP%], .page-title[_ngcontent-%COMP%]{margin-left:0}}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000000d;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#0003;border-radius:10px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#0000004d}@media (max-width: 1200px){.page-title[_ngcontent-%COMP%], .iframe-container[_ngcontent-%COMP%]{margin-left:0}.map-layout[_ngcontent-%COMP%]{flex-direction:column;height:auto}.half-layout[_ngcontent-%COMP%]{width:100%;height:400px}.iframe-row[_ngcontent-%COMP%]{flex-direction:column}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:250px}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:400px}}@media (max-width: 768px){.page-title[_ngcontent-%COMP%]{font-size:2rem;padding:20px;margin-bottom:20px}.sensor-container[_ngcontent-%COMP%]{margin:1rem;padding:1rem}.sensor-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}.sensor-select[_ngcontent-%COMP%]{font-size:.95rem;padding:.7rem}.details-panel[_ngcontent-%COMP%]{width:90%;padding:15px}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem}.map-legend[_ngcontent-%COMP%]{bottom:20px;left:20px;padding:10px}.map-legend[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem}.legend-color[_ngcontent-%COMP%]{width:14px;height:14px}.detail-row[_ngcontent-%COMP%]{font-size:.9rem}}@media (max-width: 480px){.page-title[_ngcontent-%COMP%]{font-size:1.6rem;padding:15px}.iframe-container[_ngcontent-%COMP%]{padding:15px;gap:15px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%], .iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:200px}.map-layout[_ngcontent-%COMP%]{padding:15px;gap:15px}.sensor-container[_ngcontent-%COMP%]{margin:1rem .5rem;padding:1rem}.details-panel[_ngcontent-%COMP%]{padding:10px}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem}.sensor-select[_ngcontent-%COMP%]{font-size:.9rem;padding:.6rem}.detail-row[_ngcontent-%COMP%]{padding:6px 8px}.map-legend[_ngcontent-%COMP%]{left:10px;bottom:15px;padding:8px}.legend-item[_ngcontent-%COMP%]{font-size:.85rem}.legend-color[_ngcontent-%COMP%]{width:12px;height:12px}}`]})};var Dg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-turismomaps"]],decls:9,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739789874607&to=1740394674607&viewPanel=7&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739790035176&to=1740394835176&viewPanel=5&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739790124478&to=1740394924478&viewPanel=6&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/tu_ma/turismo-map?orgId=1&var-menu=--Seleccionar--&from=1739790178621&to=1740394978621&viewPanel=4&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Ciudad Inteligente - Turismo"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),F()(),O(7,"div",1),Te(8,"iframe",6),F())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var Rg=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-siatamaps"]],decls:10,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-row"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&from=1739790813208&to=1740395613208&viewPanel=3&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&from=1739790813208&to=1740395613208&viewPanel=4&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&var-city=--Seleccionar--&from=1739790813208&from=1739790813208&to=1740395613208&to=1740395613208&viewPanel=1http:%2F%2Fgrafana-fiware.apps.preprodalcaldia.medellin.gov.co%2Fterritoriointeligente%2Fd%2Fsi_ma%2Fsiata-map%3ForgId%3D1&viewPanel=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/si_ma/siata-map?orgId=1&var-city=--Seleccionar--&from=1739790813208&to=1740395613208&viewPanel=6&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Ciudad Inteligente - SIATA"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4),F()(),O(6,"div",1),Te(7,"iframe",5),F(),O(8,"div",1),Te(9,"iframe",6),F())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-row[_ngcontent-%COMP%]{display:flex;gap:20px}.iframe-row[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{flex:1;height:250px;border:none}.iframe-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]:not(.iframe-row iframe){height:500px;border:none}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}"]})};var Og=class c{static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-medicos"]],decls:7,vars:0,consts:[[1,"page-title"],[1,"iframe-container"],[1,"iframe-column"],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/movilidad-volumen-carri/movilidad-inteligente-volumen-de-trafico-por-carriles?orgId=1&var-carril=All&var-dia_semana=All&from=1734757199500&to=1738558797500&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/movilidad-vel-graph4/grafica-velocidad-promedio4?orgId=1&kiosk`,"allowfullscreen",""],["src",qe`http://grafana-fiware.apps.preprodalcaldia.medellin.gov.co/territoriointeligente/d/c18a5148-09d5-4585-8b7d-ea4aaba9e130/mapa-de-trafico-medellin?orgId=1&kiosk`,"allowfullscreen",""]],template:function(i,l){i&1&&(O(0,"h2",0),Y(1,"Movilidad Inteligente"),F(),O(2,"div",1)(3,"div",2),Te(4,"iframe",3)(5,"iframe",4)(6,"iframe",5),F()())},styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;display:flex;flex-direction:column;height:100vh;overflow-y:auto}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#333;text-align:left;padding:20px;background-color:#fff;box-shadow:0 4px 6px #0000001a;margin:0 0 20px 300px}.iframe-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:300px;padding:10px;gap:20px}.iframe-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.iframe-column[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{height:500px;width:100%;border:none;overflow:visible;pointer-events:auto!important;z-index:10}"]})};var dc=ou(Bp());function _A(c,a){if(c&1){let i=Xt();O(0,"a",12),tt("keyup.enter",function(){mt(i),ze(3);let h=cn(1);return ft(h.previous())})("click",function(){mt(i),ze(3);let h=cn(1);return ft(h.previous())}),Y(1),O(2,"span",13),Y(3),F()()}if(c&2){let i=ze(3);re(),Ot(" ",i.previousLabel," "),re(2),St(i.screenReaderPageLabel)}}function yA(c,a){if(c&1&&(O(0,"span",14),Y(1),O(2,"span",13),Y(3),F()()),c&2){let i=ze(3);re(),Ot(" ",i.previousLabel," "),re(2),St(i.screenReaderPageLabel)}}function vA(c,a){if(c&1&&(O(0,"li",9),Xe(1,_A,4,2,"a",10)(2,yA,4,2,"span",11),F()),c&2){ze(2);let i=cn(1);si("disabled",i.isFirstPage()),re(),Oe("ngIf",1<i.getCurrent()),re(),Oe("ngIf",i.isFirstPage())}}function bA(c,a){if(c&1){let i=Xt();O(0,"a",12),tt("keyup.enter",function(){mt(i);let h=ze().$implicit;ze(2);let s=cn(1);return ft(s.setCurrent(h.value))})("click",function(){mt(i);let h=ze().$implicit;ze(2);let s=cn(1);return ft(s.setCurrent(h.value))}),O(1,"span",13),Y(2),F(),O(3,"span"),Y(4),xn(5,"number"),F()()}if(c&2){let i=ze().$implicit,l=ze(2);re(2),Ot("",l.screenReaderPageLabel," "),re(2),St(i.label==="..."?i.label:Hn(5,2,i.label,""))}}function xA(c,a){if(c&1&&(Wh(0),O(1,"span",16)(2,"span",13),Y(3),F(),O(4,"span"),Y(5),xn(6,"number"),F()(),qh()),c&2){let i=ze().$implicit,l=ze(2);re(3),Ot("",l.screenReaderCurrentLabel," "),re(2),St(i.label==="..."?i.label:Hn(6,2,i.label,""))}}function wA(c,a){if(c&1&&(O(0,"li"),Xe(1,bA,6,5,"a",10)(2,xA,7,5,"ng-container",15),F()),c&2){let i=a.$implicit;ze(2);let l=cn(1);si("current",l.getCurrent()===i.value)("ellipsis",i.label==="..."),re(),Oe("ngIf",l.getCurrent()!==i.value),re(),Oe("ngIf",l.getCurrent()===i.value)}}function CA(c,a){if(c&1){let i=Xt();O(0,"a",12),tt("keyup.enter",function(){mt(i),ze(3);let h=cn(1);return ft(h.next())})("click",function(){mt(i),ze(3);let h=cn(1);return ft(h.next())}),Y(1),O(2,"span",13),Y(3),F()()}if(c&2){let i=ze(3);re(),Ot(" ",i.nextLabel," "),re(2),St(i.screenReaderPageLabel)}}function MA(c,a){if(c&1&&(O(0,"span",14),Y(1),O(2,"span",13),Y(3),F()()),c&2){let i=ze(3);re(),Ot(" ",i.nextLabel," "),re(2),St(i.screenReaderPageLabel)}}function SA(c,a){if(c&1&&(O(0,"li",17),Xe(1,CA,4,2,"a",10)(2,MA,4,2,"span",11),F()),c&2){ze(2);let i=cn(1);si("disabled",i.isLastPage()),re(),Oe("ngIf",!i.isLastPage()),re(),Oe("ngIf",i.isLastPage())}}function PA(c,a){if(c&1&&(O(0,"ul",4),Xe(1,vA,3,4,"li",5),O(2,"li",6),Y(3),F(),Xe(4,wA,3,6,"li",7)(5,SA,3,4,"li",8),F()),c&2){let i=ze(),l=cn(1);si("responsive",i.responsive),re(),Oe("ngIf",i.directionLinks),re(2),Ko(" ",l.getCurrent()," / ",l.getLastPage()," "),re(),Oe("ngForOf",l.pages)("ngForTrackBy",i.trackByIndex),re(),Oe("ngIf",i.directionLinks)}}var Qp=class{constructor(){this.change=new oi,this.instances={},this.DEFAULT_ID="DEFAULT_PAGINATION_ID"}defaultId(){return this.DEFAULT_ID}register(a){return a.id==null&&(a.id=this.DEFAULT_ID),this.instances[a.id]?this.updateInstance(a):(this.instances[a.id]=a,!0)}updateInstance(a){let i=!1;for(let l in this.instances[a.id])a[l]!==this.instances[a.id][l]&&(this.instances[a.id][l]=a[l],i=!0);return i}getCurrentPage(a){return this.instances[a]?this.instances[a].currentPage:1}setCurrentPage(a,i){if(this.instances[a]){let l=this.instances[a],h=Math.ceil(l.totalItems/l.itemsPerPage);i<=h&&1<=i&&(this.instances[a].currentPage=i,this.change.emit(a))}}setTotalItems(a,i){this.instances[a]&&0<=i&&(this.instances[a].totalItems=i,this.change.emit(a))}setItemsPerPage(a,i){this.instances[a]&&(this.instances[a].itemsPerPage=i,this.change.emit(a))}getInstance(a=this.DEFAULT_ID){return this.instances[a]?this.clone(this.instances[a]):{}}clone(a){var i={};for(var l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);return i}},EA=Number.MAX_SAFE_INTEGER,WC=(()=>{class c{constructor(i){this.service=i,this.state={}}transform(i,l){if(!(i instanceof Array)){let $=l.id||this.service.defaultId();return this.state[$]?this.state[$].slice:i}let h=l.totalItems&&l.totalItems!==i.length,s=this.createInstance(i,l),P=s.id,q,X,be=s.itemsPerPage,ve=this.service.register(s);if(!h&&i instanceof Array){if(be=+be||EA,q=(s.currentPage-1)*be,X=q+be,this.stateIsIdentical(P,i,q,X))return this.state[P].slice;{let $e=i.slice(q,X);return this.saveState(P,i,$e,q,X),this.service.change.emit(P),$e}}else return ve&&this.service.change.emit(P),this.saveState(P,i,i,q,X),i}createInstance(i,l){return this.checkConfig(l),{id:l.id!=null?l.id:this.service.defaultId(),itemsPerPage:+l.itemsPerPage||0,currentPage:+l.currentPage||1,totalItems:+l.totalItems||i.length}}checkConfig(i){let h=["itemsPerPage","currentPage"].filter(s=>!(s in i));if(0<h.length)throw new Error(`PaginatePipe: Argument is missing the following required properties: ${h.join(", ")}`)}saveState(i,l,h,s,P){this.state[i]={collection:l,size:l.length,slice:h,start:s,end:P}}stateIsIdentical(i,l,h,s){let P=this.state[i];return!P||!(P.size===l.length&&P.start===h&&P.end===s)?!1:P.slice.every((X,be)=>X===l[h+be])}}return c.\u0275fac=function(i){return new(i||c)(It(Qp,16))},c.\u0275pipe=fx({name:"paginate",type:c,pure:!1,standalone:!1}),c})();var TA=(()=>{class c{constructor(i,l){this.service=i,this.changeDetectorRef=l,this.maxSize=7,this.pageChange=new oi,this.pageBoundsCorrection=new oi,this.pages=[],this.changeSub=this.service.change.subscribe(h=>{this.id===h&&(this.updatePageLinks(),this.changeDetectorRef.markForCheck(),this.changeDetectorRef.detectChanges())})}ngOnInit(){this.id===void 0&&(this.id=this.service.defaultId()),this.updatePageLinks()}ngOnChanges(i){this.updatePageLinks()}ngOnDestroy(){this.changeSub.unsubscribe()}previous(){this.checkValidId(),this.setCurrent(this.getCurrent()-1)}next(){this.checkValidId(),this.setCurrent(this.getCurrent()+1)}isFirstPage(){return this.getCurrent()===1}isLastPage(){return this.getLastPage()===this.getCurrent()}setCurrent(i){this.pageChange.emit(i)}getCurrent(){return this.service.getCurrentPage(this.id)}getLastPage(){let i=this.service.getInstance(this.id);return i.totalItems<1?1:Math.ceil(i.totalItems/i.itemsPerPage)}getTotalItems(){return this.service.getInstance(this.id).totalItems}checkValidId(){this.service.getInstance(this.id).id==null&&console.warn(`PaginationControlsDirective: the specified id "${this.id}" does not match any registered PaginationInstance`)}updatePageLinks(){let i=this.service.getInstance(this.id),l=this.outOfBoundCorrection(i);l!==i.currentPage?setTimeout(()=>{this.pageBoundsCorrection.emit(l),this.pages=this.createPageArray(i.currentPage,i.itemsPerPage,i.totalItems,this.maxSize)}):this.pages=this.createPageArray(i.currentPage,i.itemsPerPage,i.totalItems,this.maxSize)}outOfBoundCorrection(i){let l=Math.ceil(i.totalItems/i.itemsPerPage);return l<i.currentPage&&0<l?l:i.currentPage<1?1:i.currentPage}createPageArray(i,l,h,s){s=+s;let P=[],q=Math.max(Math.ceil(h/l),1),X=Math.ceil(s/2),be=i<=X,ve=q-X<i,$=!be&&!ve,$e=s<q,ht=1;for(;ht<=q&&ht<=s;){let wt,lt=this.calculatePageNumber(ht,i,s,q),at=ht===2&&($||ve),hi=ht===s-1&&($||be);$e&&(at||hi)?wt="...":wt=lt,P.push({label:wt,value:lt}),ht++}return P}calculatePageNumber(i,l,h,s){let P=Math.ceil(h/2);return i===h?s:i===1?i:h<s?s-P<l?s-h+i:P<l?l-P+i:i:i}}return c.\u0275fac=function(i){return new(i||c)(It(Qp),It(Mr))},c.\u0275dir=Ht({type:c,selectors:[["pagination-template"],["","pagination-template",""]],inputs:{id:"id",maxSize:"maxSize"},outputs:{pageChange:"pageChange",pageBoundsCorrection:"pageBoundsCorrection"},exportAs:["paginationApi"],standalone:!1,features:[ao]}),c})();function Qy(c){return!!c&&c!=="false"}var qC=(()=>{class c{constructor(){this.maxSize=7,this.previousLabel="Previous",this.nextLabel="Next",this.screenReaderPaginationLabel="Pagination",this.screenReaderPageLabel="page",this.screenReaderCurrentLabel="You're on page",this.pageChange=new oi,this.pageBoundsCorrection=new oi,this._directionLinks=!0,this._autoHide=!1,this._responsive=!1}get directionLinks(){return this._directionLinks}set directionLinks(i){this._directionLinks=Qy(i)}get autoHide(){return this._autoHide}set autoHide(i){this._autoHide=Qy(i)}get responsive(){return this._responsive}set responsive(i){this._responsive=Qy(i)}trackByIndex(i){return i}}return c.\u0275fac=function(i){return new(i||c)},c.\u0275cmp=rt({type:c,selectors:[["pagination-controls"]],inputs:{id:"id",maxSize:"maxSize",directionLinks:"directionLinks",autoHide:"autoHide",responsive:"responsive",previousLabel:"previousLabel",nextLabel:"nextLabel",screenReaderPaginationLabel:"screenReaderPaginationLabel",screenReaderPageLabel:"screenReaderPageLabel",screenReaderCurrentLabel:"screenReaderCurrentLabel"},outputs:{pageChange:"pageChange",pageBoundsCorrection:"pageBoundsCorrection"},standalone:!1,decls:4,vars:4,consts:[["p","paginationApi"],[3,"pageChange","pageBoundsCorrection","id","maxSize"],["role","navigation"],["class","ngx-pagination",3,"responsive",4,"ngIf"],[1,"ngx-pagination"],["class","pagination-previous",3,"disabled",4,"ngIf"],[1,"small-screen"],[3,"current","ellipsis",4,"ngFor","ngForOf","ngForTrackBy"],["class","pagination-next",3,"disabled",4,"ngIf"],[1,"pagination-previous"],["tabindex","0",3,"keyup.enter","click",4,"ngIf"],["aria-disabled","true",4,"ngIf"],["tabindex","0",3,"keyup.enter","click"],[1,"show-for-sr"],["aria-disabled","true"],[4,"ngIf"],["aria-live","polite"],[1,"pagination-next"]],template:function(i,l){if(i&1){let h=Xt();O(0,"pagination-template",1,0),tt("pageChange",function(P){return mt(h),ft(l.pageChange.emit(P))})("pageBoundsCorrection",function(P){return mt(h),ft(l.pageBoundsCorrection.emit(P))}),O(2,"nav",2),Xe(3,PA,6,8,"ul",3),F()()}if(i&2){let h=cn(1);Oe("id",l.id)("maxSize",l.maxSize),re(2),Ri("aria-label",l.screenReaderPaginationLabel),re(),Oe("ngIf",!(l.autoHide&&h.pages.length<=1))}},dependencies:[TA,co,Qo,pu],styles:[`.ngx-pagination{margin-left:0;margin-bottom:1rem}.ngx-pagination:before,.ngx-pagination:after{content:" ";display:table}.ngx-pagination:after{clear:both}.ngx-pagination li{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;margin-right:.0625rem;border-radius:0}.ngx-pagination li{display:inline-block}.ngx-pagination a,.ngx-pagination button{color:#0a0a0a;display:block;padding:.1875rem .625rem;border-radius:0}.ngx-pagination a:hover,.ngx-pagination button:hover{background:#e6e6e6}.ngx-pagination .current{padding:.1875rem .625rem;background:#2199e8;color:#fefefe;cursor:default}.ngx-pagination .disabled{padding:.1875rem .625rem;color:#cacaca;cursor:default}.ngx-pagination .disabled:hover{background:transparent}.ngx-pagination a,.ngx-pagination button{cursor:pointer}.ngx-pagination .pagination-previous a:before,.ngx-pagination .pagination-previous.disabled:before{content:"\\ab";display:inline-block;margin-right:.5rem}.ngx-pagination .pagination-next a:after,.ngx-pagination .pagination-next.disabled:after{content:"\\bb";display:inline-block;margin-left:.5rem}.ngx-pagination .show-for-sr{position:absolute!important;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0)}.ngx-pagination .small-screen{display:none}@media screen and (max-width: 601px){.ngx-pagination.responsive .small-screen{display:inline-block}.ngx-pagination.responsive li:not(.small-screen):not(.pagination-previous):not(.pagination-next){display:none}}
`],encapsulation:2,changeDetection:0}),c})(),XC=(()=>{class c{}return c.\u0275fac=function(i){return new(i||c)},c.\u0275mod=Gt({type:c}),c.\u0275inj=$t({providers:[Qp],imports:[[nr]]}),c})();var Jy=ou(Bp());var kA=(c,a)=>({itemsPerPage:c,currentPage:a});function AA(c,a){if(c&1&&(O(0,"option",34),Y(1),F()),c&2){let i=a.$implicit;Oe("value",i),re(),St(i)}}function DA(c,a){if(c&1){let i=Xt();O(0,"tr")(1,"td"),Y(2),F(),O(3,"td"),Y(4),F(),O(5,"td")(6,"span",35),Y(7),F()(),O(8,"td")(9,"div",36)(10,"input",37),tt("change",function(){let h=mt(i).$implicit,s=ze();return ft(s.toggleActivation(h))}),F(),O(11,"label",38),Y(12),F()()()()}if(c&2){let i=a.$implicit,l=ze();re(2),St(i.dimension),re(2),St(i.subdimension),re(2),Oe("ngClass",i.activa?"bg-success":"bg-secondary"),re(),Ot(" ",i.activa?"Activo":"Inactivo"," "),re(3),Oe("id","toggle_"+i.dimension+"_"+i.subdimension)("checked",i.activa)("disabled",!l.selectedTipoAcceso),re(),Oe("for","toggle_"+i.dimension+"_"+i.subdimension),re(),Ot(" ",i.activa?"Desactivar":"Activar"," ")}}function RA(c,a){c&1&&(O(0,"tr")(1,"td",39),Y(2,"No se encontraron configuraciones"),F()())}var Fg=class c{baseUrl="https://www.medellin.gov.co/flask-fiware/api/keycloak";loginCredentials={username:"grafana3@sysman.com.co",password:"1234"};isLoading=!1;configuraciones=[];configuracionesFiltradas=[];p=1;itemsPerPage=10;selectedDimension="";searchTerm="";dimensions=[];subdimensions=[];selectedTipoAcceso="";constructor(){}ngOnInit(){this.initializeApp()}initializeApp(){return Dr(this,null,function*(){try{let a=yield this.getAuthToken();localStorage.setItem("access_token",a),yield this.loadConfigurations()}catch(a){this.handleApiError("Error de inicializaci\xF3n",a)}})}getAuthToken(){return Dr(this,null,function*(){this.isLoading=!0;try{let a=yield fetch(`${this.baseUrl}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.loginCredentials)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);let i=yield a.json();if(!i.access_token)throw new Error("No se recibi\xF3 token en la respuesta");return i.access_token}catch(a){throw this.handleApiError("Error de autenticaci\xF3n",a),a}finally{this.isLoading=!1}})}get currentPageRange(){let a=(this.p-1)*this.itemsPerPage+1,i=Math.min(this.p*this.itemsPerPage,this.configuracionesFiltradas.length);return`${a} a ${i}`}get totalItems(){return this.configuracionesFiltradas.length}checkToken(){return localStorage.getItem("access_token")?!0:(this.showError("Error de autenticaci\xF3n","No se encontr\xF3 token de acceso. Por favor inicie sesi\xF3n primero."),!1)}loadConfigurations(){return Dr(this,null,function*(){let a=localStorage.getItem("access_token");if(!a){this.showError("Error","No se encontr\xF3 token de acceso");return}this.isLoading=!0;try{let i=yield fetch(`${this.baseUrl}/userinfo`,{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);let l=yield i.json();Array.isArray(l)?(this.configuraciones=l,this.configuracionesFiltradas=[...l],this.updateFilterLists(),this.applyFilters()):this.showError("Error","Formato de datos incorrecto")}catch(i){this.handleApiError("Error al cargar configuraciones",i)}finally{this.isLoading=!1}})}updateFilterLists(){this.dimensions=[...new Set(this.configuraciones.map(a=>a.dimension))],this.subdimensions=[...new Set(this.configuraciones.map(a=>a.subdimension))]}applyFilters(){this.configuracionesFiltradas=this.configuraciones.filter(a=>{let i=!this.selectedDimension||a.dimension===this.selectedDimension,l=!this.searchTerm||a.dimension.toLowerCase().includes(this.searchTerm.toLowerCase())||a.subdimension.toLowerCase().includes(this.searchTerm.toLowerCase());return i&&l}),this.p=1}toggleActivation(a){return Dr(this,null,function*(){if(!this.selectedTipoAcceso){this.showError("Error","Seleccione un tipo de acceso primero");return}if(!localStorage.getItem("access_tokenadmin")){this.showError("Error","No tiene permisos de administrador");return}let i=!a.activa;try{yield this.updateConfiguration(a,i)}catch(l){console.error("Error:",l)}})}updateConfiguration(a,i){return Dr(this,null,function*(){if(this.checkToken()){this.isLoading=!0;try{let l=localStorage.getItem("access_tokenadmin");if(!l)throw new Error("No se encontr\xF3 token de administrador");let h={rol:this.selectedTipoAcceso,config:[{dimension:a.dimension,subdimension:a.subdimension,activa:i}]},s=yield fetch(`${this.baseUrl}/userinfo`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(h)});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);yield Jy.default.fire({icon:"success",title:"Configuraci\xF3n actualizada",text:`El estado de ${a.dimension} - ${a.subdimension} ha sido modificado a ${i?"activo":"inactivo"} como ${this.selectedTipoAcceso}.`,confirmButtonText:"Entendido"});let P=localStorage.getItem("access_token");P&&(localStorage.setItem("access_token",P),yield this.loadConfigurations())}catch(l){throw this.handleApiError("Error al actualizar configuraci\xF3n used no cuenta con los permisos para hacer esta accion",l),l}finally{this.isLoading=!1}}})}handleApiError(a,i){let l="Ocurri\xF3 un error inesperado";if(typeof i=="string")l=i;else if(i instanceof Error)l=i.message;else if(typeof i=="object"&&i!==null){let h=i;h.error?l=typeof h.error=="string"?h.error:JSON.stringify(h.error,null,2):h.message&&(l=h.message)}this.showError(a,l)}showError(a,i){Jy.default.fire({icon:"error",title:a,html:`<div class="error-message">
               <p>${i}</p>
             </div>`,confirmButtonColor:"#3085d6",width:"700px"})}static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-mde-crud"]],decls:61,vars:17,consts:[[1,"container-fluid"],[1,"card","shadow","mb-4"],[1,"card-header","py-3","d-flex","justify-content-between","align-items-center"],[1,"m-0","font-weight-bold","text-primary"],[1,"card-body"],[1,"row","mb-4"],[1,"col-md-3"],["for","dimensionFilter",1,"form-label"],["id","dimensionFilter",1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","tipoAcceso",1,"form-label"],["id","tipoAcceso",1,"form-select",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],["value","editor"],["value","visualizador"],[1,"col-md-6"],["for","searchInput",1,"form-label"],[1,"input-group"],["type","text","id","searchInput","placeholder","Buscar por dimensi\xF3n o subdimensi\xF3n...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"table-responsive"],[1,"table","table-bordered","table-hover"],[1,"table-light"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"row","mt-3"],[1,"d-flex","align-items-center"],[1,"me-2"],[1,"form-select","form-select-sm","w-auto",3,"ngModelChange","ngModel"],["value","5"],["value","10"],["value","20"],["value","50"],["previousLabel","Anterior","nextLabel","Siguiente",1,"pagination","justify-content-end",3,"pageChange","maxSize","responsive"],[3,"value"],[1,"badge",3,"ngClass"],[1,"form-check","form-switch"],["type","checkbox","role","switch",1,"form-check-input",3,"change","id","checked","disabled"],[1,"form-check-label",3,"for"],["colspan","4",1,"text-center"]],template:function(i,l){i&1&&(O(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),Y(4,"Configuraci\xF3n de Dimensiones"),F()(),O(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),Y(9,"Filtrar por Dimensi\xF3n:"),F(),O(10,"select",8),ir("ngModelChange",function(s){return tr(l.selectedDimension,s)||(l.selectedDimension=s),s}),tt("change",function(){return l.applyFilters()}),O(11,"option",9),Y(12,"Todas las dimensiones"),F(),Xe(13,AA,2,2,"option",10),F()(),O(14,"div",6)(15,"label",11),Y(16,"Tipo de Acceso:"),F(),O(17,"select",12),ir("ngModelChange",function(s){return tr(l.selectedTipoAcceso,s)||(l.selectedTipoAcceso=s),s}),O(18,"option",13),Y(19,"Seleccione un tipo"),F(),O(20,"option",14),Y(21,"Editor"),F(),O(22,"option",15),Y(23,"Visualizador"),F()()(),O(24,"div",16)(25,"label",17),Y(26,"Buscar:"),F(),O(27,"div",18)(28,"input",19),ir("ngModelChange",function(s){return tr(l.searchTerm,s)||(l.searchTerm=s),s}),tt("input",function(){return l.applyFilters()}),F()()()(),O(29,"div",20)(30,"table",21)(31,"thead",22)(32,"tr")(33,"th"),Y(34,"Dimensi\xF3n"),F(),O(35,"th"),Y(36,"Subdimensi\xF3n"),F(),O(37,"th"),Y(38,"Estado"),F(),O(39,"th"),Y(40,"Acciones"),F()()(),O(41,"tbody"),Xe(42,DA,13,9,"tr",23),xn(43,"paginate"),Xe(44,RA,3,0,"tr",24),F()()(),O(45,"div",25)(46,"div",16)(47,"div",26)(48,"span",27),Y(49),F(),O(50,"select",28),ir("ngModelChange",function(s){return tr(l.itemsPerPage,s)||(l.itemsPerPage=s),s}),O(51,"option",29),Y(52,"5 por p\xE1gina"),F(),O(53,"option",30),Y(54,"10 por p\xE1gina"),F(),O(55,"option",31),Y(56,"20 por p\xE1gina"),F(),O(57,"option",32),Y(58,"50 por p\xE1gina"),F()()()(),O(59,"div",16)(60,"pagination-controls",33),tt("pageChange",function(s){return l.p=s}),F()()()()()()),i&2&&(re(10),er("ngModel",l.selectedDimension),re(3),Oe("ngForOf",l.dimensions),re(4),er("ngModel",l.selectedTipoAcceso),re(11),er("ngModel",l.searchTerm),re(14),Oe("ngForOf",Hn(43,11,l.configuracionesFiltradas,vx(14,kA,l.itemsPerPage,l.p))),re(2),Oe("ngIf",l.configuracionesFiltradas.length===0),re(5),Ko("Mostrando ",l.currentPageRange," de ",l.totalItems," registros"),re(),er("ngModel",l.itemsPerPage),re(10),Oe("maxSize",5)("responsive",!0))},dependencies:[nr,Ym,Qo,co,ac,Au,Du,la,sc,ca,il,XC,WC,qC],styles:['@charset "UTF-8";.container[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.card[_ngcontent-%COMP%]{border:none;border-radius:12px;box-shadow:0 10px 30px #0000001a;overflow:hidden;transition:transform .3s ease,box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 15px 35px #00000026}.card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6a11cb,#2575fc);color:#fff;padding:1.5rem;border-bottom:none}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-weight:600;letter-spacing:.5px}.card-body[_ngcontent-%COMP%]{padding:2rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#555;margin-bottom:.5rem;display:block}.form-select[_ngcontent-%COMP%], .form-control[_ngcontent-%COMP%]{border:2px solid #e0e0e0;border-radius:8px;padding:.75rem 1rem;transition:all .3s ease;box-shadow:none}.form-select[_ngcontent-%COMP%]:focus, .form-control[_ngcontent-%COMP%]:focus{border-color:#2575fc;box-shadow:0 0 0 .25rem #2575fc40;outline:none}.table-responsive[_ngcontent-%COMP%]{border-radius:10px;overflow:hidden;margin:1.5rem 0;box-shadow:0 5px 15px #0000000d}.table[_ngcontent-%COMP%]{margin-bottom:0}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#495057;font-weight:600;border-bottom:2px solid #dee2e6;padding:1rem;text-transform:uppercase;font-size:.8rem;letter-spacing:.5px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .3s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#2575fc0d;transform:scale(1.01)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1.2rem 1rem;vertical-align:middle;border-top:1px solid #f1f1f1}.badge[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.8rem;font-weight:500;border-radius:50px;text-transform:uppercase;letter-spacing:.5px;transition:all .3s ease}.bg-success[_ngcontent-%COMP%]{background-color:#28a745!important}.bg-danger[_ngcontent-%COMP%]{background-color:#dc3545!important}.btn[_ngcontent-%COMP%]{border:none;border-radius:50px;padding:.5rem 1.25rem;font-weight:500;letter-spacing:.5px;transition:all .3s ease;box-shadow:0 4px 6px #32325d1c,0 1px 3px #00000014}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 7px 14px #32325d1a,0 3px 6px #00000014}.btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-sm[_ngcontent-%COMP%]{padding:.4rem 1rem;font-size:.8rem}.btn-success[_ngcontent-%COMP%]{background-color:#28a745}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545}.my-pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:1rem}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination{display:flex;gap:.5rem;align-items:center}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination li{border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination li a{color:#495057;text-decoration:none;font-weight:500;display:flex;align-items:center;justify-content:center;width:100%;height:100%;border-radius:50%}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination li:hover:not(.current){background-color:#2575fc1a}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination .current{background:linear-gradient(135deg,#6a11cb,#2575fc);color:#fff;box-shadow:0 4px 6px #32325d1c}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination .pagination-previous a:before, .my-pagination[_ngcontent-%COMP%]     .ngx-pagination .pagination-next a:after{display:none}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination .pagination-previous, .my-pagination[_ngcontent-%COMP%]     .ngx-pagination .pagination-next{font-weight:600}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fffc;display:flex;justify-content:center;align-items:center;z-index:9999;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem;border-width:.25rem;animation:_ngcontent-%COMP%_spin 1s linear infinite,_ngcontent-%COMP%_pulse 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@keyframes _ngcontent-%COMP%_rowHover{0%{transform:scale(1);box-shadow:none}to{transform:scale(1.01);box-shadow:0 5px 15px #0000001a}}@media (max-width: 768px){.card-header[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem;font-size:.7rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem}.btn-sm[_ngcontent-%COMP%]{padding:.3rem .75rem;font-size:.7rem}}']})};function OA(c,a){c&1&&(O(0,"div",8),Te(1,"div",9),O(2,"p"),Y(3,"Cargando..."),F()())}function FA(c,a){c&1&&(O(0,"div",10),Te(1,"app-mde-crud"),F())}function LA(c,a){c&1&&(O(0,"span"),Y(1,"Este campo es requerido"),F())}function zA(c,a){if(c&1&&(O(0,"div",31),Xe(1,LA,2,0,"span",32),F()),c&2){let i,l=ze(2);re(),Oe("ngIf",(i=l.userForm.get("username"))==null||i.errors==null?null:i.errors.required)}}function BA(c,a){c&1&&(O(0,"div",31),Y(1," Ingrese un correo electr\xF3nico v\xE1lido "),F())}function NA(c,a){c&1&&(O(0,"div",31),Y(1," Este campo es requerido "),F())}function VA(c,a){c&1&&(O(0,"div",31),Y(1," Este campo es requerido "),F())}function jA(c,a){if(c&1){let i=Xt();O(0,"button",33),tt("click",function(){mt(i);let h=ze(2);return ft(h.cancelEdit())}),Y(1,"Cancelar"),F()}}function UA(c,a){if(c&1){let i=Xt();O(0,"button",34),tt("click",function(){mt(i);let h=ze(2);return ft(h.openPasswordModal())}),Y(1," Asignar Contrase\xF1a "),F()}}function $A(c,a){if(c&1){let i=Xt();O(0,"button",35),tt("click",function(){mt(i);let h=ze(2);return ft(h.openRolesModal())}),Y(1," Asignar Roles "),F()}}function GA(c,a){if(c&1){let i=Xt();O(0,"button",36),tt("click",function(){mt(i);let h=ze(2);return ft(h.openGrafanaRolesModal())}),Y(1," Asignar Roles Grafana "),F()}}function HA(c,a){if(c&1){let i=Xt();O(0,"tr")(1,"td"),Y(2),F(),O(3,"td"),Y(4),F(),O(5,"td"),Y(6),F(),O(7,"td")(8,"span"),Y(9),F()(),O(10,"td",37)(11,"button",38),tt("click",function(){let h=mt(i).$implicit,s=ze(2);return ft(s.editUser(h))}),Y(12,"Editar"),F(),O(13,"button",39),tt("click",function(){let h=mt(i).$implicit,s=ze(2);return ft(s.confirmDelete(h.id))}),Y(14,"Eliminar"),F()()()}if(c&2){let i=a.$implicit;re(2),Ko("",i.firstName," ",i.lastName,""),re(2),St(i.email),re(2),St(i.username),re(2),si("active",i.enabled)("inactive",!i.enabled),re(),Ot(" ",i.enabled?"Activo":"Inactivo"," ")}}function ZA(c,a){c&1&&(O(0,"div",40),Y(1," No se encontraron usuarios "),F())}function WA(c,a){if(c&1){let i=Xt();O(0,"div",10)(1,"div",11)(2,"h2"),Y(3),F(),O(4,"form",12),tt("ngSubmit",function(){mt(i);let h=ze();return ft(h.selectedUser?h.updateUser():h.createUser())}),O(5,"div",13)(6,"label"),Y(7,"Nombre de usuario *"),F(),Te(8,"input",14),Xe(9,zA,2,1,"div",15),F(),O(10,"div",13)(11,"label"),Y(12,"Correo electr\xF3nico *"),F(),Te(13,"input",16),Xe(14,BA,2,0,"div",15),F(),O(15,"div",13)(16,"label"),Y(17,"Nombre *"),F(),Te(18,"input",17),Xe(19,NA,2,0,"div",15),F(),O(20,"div",13)(21,"label"),Y(22,"Apellido *"),F(),Te(23,"input",18),Xe(24,VA,2,0,"div",15),F(),O(25,"div",13)(26,"label"),Y(27,"Habilitado"),F(),Te(28,"input",19),F(),O(29,"div",20)(30,"button",21),Y(31),F(),Xe(32,jA,2,0,"button",22)(33,UA,2,0,"button",23)(34,$A,2,0,"button",24)(35,GA,2,0,"button",25),F()()(),O(36,"div",26)(37,"h2"),Y(38,"Lista de Usuarios"),F(),O(39,"div",27)(40,"input",28),ir("ngModelChange",function(h){mt(i);let s=ze();return tr(s.searchTerm,h)||(s.searchTerm=h),ft(h)}),tt("input",function(){mt(i);let h=ze();return ft(h.filterUsers())}),F()(),O(41,"table")(42,"thead")(43,"tr")(44,"th"),Y(45,"Nombre"),F(),O(46,"th"),Y(47,"Correo"),F(),O(48,"th"),Y(49,"Usuario"),F(),O(50,"th"),Y(51,"Estado"),F(),O(52,"th"),Y(53,"Acciones"),F()()(),O(54,"tbody"),Xe(55,HA,15,9,"tr",29),F()(),Xe(56,ZA,2,0,"div",30),F()()}if(c&2){let i,l,h,s,P=ze();re(3),St(P.selectedUser?"Editar Usuario":"Crear Usuario"),re(),Oe("formGroup",P.userForm),re(4),Ri("disabled",P.selectedUser?"disabled":null),re(),Oe("ngIf",((i=P.userForm.get("username"))==null?null:i.invalid)&&((i=P.userForm.get("username"))==null?null:i.touched)),re(5),Oe("ngIf",((l=P.userForm.get("email"))==null?null:l.invalid)&&((l=P.userForm.get("email"))==null?null:l.touched)),re(5),Oe("ngIf",((h=P.userForm.get("firstName"))==null?null:h.invalid)&&((h=P.userForm.get("firstName"))==null?null:h.touched)),re(5),Oe("ngIf",((s=P.userForm.get("lastName"))==null?null:s.invalid)&&((s=P.userForm.get("lastName"))==null?null:s.touched)),re(6),Oe("disabled",!P.userForm.valid),re(),Ot(" ",P.selectedUser?"Actualizar":"Crear"," "),re(),Oe("ngIf",P.selectedUser),re(),Oe("ngIf",P.selectedUser),re(),Oe("ngIf",P.selectedUser),re(),Oe("ngIf",P.selectedUser),re(5),er("ngModel",P.searchTerm),re(15),Oe("ngForOf",P.filteredUsers),re(),Oe("ngIf",P.filteredUsers.length===0)}}function qA(c,a){if(c&1&&(O(0,"span",42),Y(1),F()),c&2){let i=a.$implicit;re(),Ot(" ",i.username," ")}}function XA(c,a){c&1&&(O(0,"span"),Y(1,"Ning\xFAn usuario"),F())}function YA(c,a){if(c&1){let i=Xt();O(0,"tr")(1,"td"),Y(2),F(),O(3,"td"),Y(4),F(),O(5,"td"),Xe(6,qA,2,1,"span",41)(7,XA,2,0,"span",32),F(),O(8,"td")(9,"button",5),tt("click",function(){let h=mt(i).$implicit,s=ze(2);return ft(s.viewRoleDetails(h))}),Y(10,"Detalles"),F()()()}if(c&2){let i=a.$implicit,l=ze(2);re(2),St(i.name),re(2),St(i.description||"Sin descripci\xF3n"),re(2),Oe("ngForOf",l.getUsersWithRole(i.id)),re(),Oe("ngIf",l.getUsersWithRole(i.id).length===0)}}function KA(c,a){c&1&&(O(0,"div",40),Y(1," No se encontraron roles del sistema "),F())}function QA(c,a){if(c&1&&(O(0,"div",10)(1,"div",26)(2,"h2"),Y(3,"Roles del Sistema"),F(),O(4,"table")(5,"thead")(6,"tr")(7,"th"),Y(8,"Nombre"),F(),O(9,"th"),Y(10,"Descripci\xF3n"),F(),O(11,"th"),Y(12,"Usuarios Asignados"),F(),O(13,"th"),Y(14,"Acciones"),F()()(),O(15,"tbody"),Xe(16,YA,11,4,"tr",29),F()(),Xe(17,KA,2,0,"div",30),F()()),c&2){let i=ze();re(16),Oe("ngForOf",i.roles),re(),Oe("ngIf",i.roles.length===0)}}function JA(c,a){if(c&1&&(O(0,"span",42),Y(1),F()),c&2){let i=a.$implicit;re(),Ot(" ",i.username," ")}}function eD(c,a){c&1&&(O(0,"span"),Y(1,"Ning\xFAn usuario"),F())}function tD(c,a){if(c&1){let i=Xt();O(0,"tr")(1,"td"),Y(2),F(),O(3,"td"),Y(4),F(),O(5,"td"),Xe(6,JA,2,1,"span",41)(7,eD,2,0,"span",32),F(),O(8,"td")(9,"button",5),tt("click",function(){let h=mt(i).$implicit,s=ze(2);return ft(s.viewRoleDetails(h,!0))}),Y(10,"Detalles"),F()()()}if(c&2){let i=a.$implicit,l=ze(2);re(2),St(i.name),re(2),St(i.description||"Sin descripci\xF3n"),re(2),Oe("ngForOf",l.getUsersWithGrafanaRole(i.id)),re(),Oe("ngIf",l.getUsersWithGrafanaRole(i.id).length===0)}}function iD(c,a){c&1&&(O(0,"div",40),Y(1," No se encontraron roles de Grafana "),F())}function nD(c,a){if(c&1&&(O(0,"div",10)(1,"div",26)(2,"h2"),Y(3,"Roles de Grafana"),F(),O(4,"table")(5,"thead")(6,"tr")(7,"th"),Y(8,"Nombre"),F(),O(9,"th"),Y(10,"Descripci\xF3n"),F(),O(11,"th"),Y(12,"Usuarios Asignados"),F(),O(13,"th"),Y(14,"Acciones"),F()()(),O(15,"tbody"),Xe(16,tD,11,4,"tr",29),F()(),Xe(17,iD,2,0,"div",30),F()()),c&2){let i=ze();re(16),Oe("ngForOf",i.grafanaRoles),re(),Oe("ngIf",i.grafanaRoles.length===0)}}function rD(c,a){if(c&1&&(O(0,"tr")(1,"td"),Y(2),F(),O(3,"td"),Y(4),F(),O(5,"td"),Y(6),F(),O(7,"td"),Y(8),F(),O(9,"td"),Y(10),xn(11,"date"),F()()),c&2){let i=a.$implicit,l=ze(2);re(2),St(i.userId||"Sistema"),re(2),St(l.getActionName(i.operationType)),re(2),St(l.getResourceType(i.resourceType)),re(2),St(i.details||"N/A"),re(2),St(Hn(11,5,i.time,"dd/MM/yyyy HH:mm"))}}function oD(c,a){c&1&&(O(0,"div",40),Y(1," No se encontraron registros de auditor\xEDa "),F())}function sD(c,a){if(c&1){let i=Xt();O(0,"div",10)(1,"h2"),Y(2,"Registros de Auditor\xEDa"),F(),O(3,"div",43)(4,"div",44)(5,"label"),Y(6,"Filtrar por tipo:"),F(),O(7,"select",45),ir("ngModelChange",function(h){mt(i);let s=ze();return tr(s.auditFilter.type,h)||(s.auditFilter.type=h),ft(h)}),tt("change",function(){mt(i);let h=ze();return ft(h.filterAuditLogs())}),O(8,"option",46),Y(9,"Todos"),F(),O(10,"option",47),Y(11,"Usuarios"),F(),O(12,"option",48),Y(13,"Roles"),F(),O(14,"option",49),Y(15,"Roles Grafana"),F()()(),O(16,"div",44)(17,"label"),Y(18,"Filtrar por acci\xF3n:"),F(),O(19,"select",45),ir("ngModelChange",function(h){mt(i);let s=ze();return tr(s.auditFilter.action,h)||(s.auditFilter.action=h),ft(h)}),tt("change",function(){mt(i);let h=ze();return ft(h.filterAuditLogs())}),O(20,"option",46),Y(21,"Todas"),F(),O(22,"option",50),Y(23,"Creaci\xF3n"),F(),O(24,"option",51),Y(25,"Actualizaci\xF3n"),F(),O(26,"option",52),Y(27,"Eliminaci\xF3n"),F()()(),O(28,"button",5),tt("click",function(){mt(i);let h=ze();return ft(h.clearAuditFilters())}),Y(29,"Limpiar Filtros"),F()(),O(30,"div",53)(31,"table")(32,"thead")(33,"tr")(34,"th"),Y(35,"Usuario"),F(),O(36,"th"),Y(37,"Acci\xF3n"),F(),O(38,"th"),Y(39,"Recurso"),F(),O(40,"th"),Y(41,"Detalles"),F(),O(42,"th"),Y(43,"Fecha"),F()()(),O(44,"tbody"),Xe(45,rD,12,8,"tr",29),F()(),Xe(46,oD,2,0,"div",30),F()()}if(c&2){let i=ze();re(7),er("ngModel",i.auditFilter.type),re(12),er("ngModel",i.auditFilter.action),re(26),Oe("ngForOf",i.filteredAuditLogs),re(),Oe("ngIf",i.filteredAuditLogs.length===0)}}function aD(c,a){if(c&1){let i=Xt();O(0,"div",54)(1,"div",55)(2,"div",56)(3,"h3"),Y(4,"Cambiar Contrase\xF1a"),F(),O(5,"button",57),tt("click",function(){mt(i);let h=ze();return ft(h.closePasswordModal())}),Y(6,"\xD7"),F()(),O(7,"div",58)(8,"div",13)(9,"label"),Y(10,"Nueva Contrase\xF1a"),F(),O(11,"input",59),ir("ngModelChange",function(h){mt(i);let s=ze();return tr(s.tempPassword,h)||(s.tempPassword=h),ft(h)}),F()()(),O(12,"div",60)(13,"button",61),tt("click",function(){mt(i);let h=ze();return ft(h.closePasswordModal())}),Y(14,"Cancelar"),F(),O(15,"button",62),tt("click",function(){mt(i);let h=ze();return ft(h.savePassword())}),Y(16),F()()()()}if(c&2){let i=ze();re(11),er("ngModel",i.tempPassword),re(4),Oe("disabled",!i.tempPassword||i.loading),re(),Ot(" ",i.loading?"Guardando...":"Guardar"," ")}}function lD(c,a){if(c&1&&(O(0,"small",69),Y(1),F()),c&2){let i=ze().$implicit;re(),St(i.description)}}function cD(c,a){if(c&1){let i=Xt();O(0,"div",65)(1,"input",66),tt("change",function(h){let s=mt(i).$implicit,P=ze(2);return ft(P.onRoleChange(h,s.id))}),F(),O(2,"label",67),Y(3),F(),Xe(4,lD,2,1,"small",68),F()}if(c&2){let i=a.$implicit,l=ze(2);re(),Oe("id","modal-role-"+i.id)("value",i.id)("checked",l.isRoleSelected(i.id))("disabled",l.roleAssignmentInProgress),re(),Oe("for","modal-role-"+i.id),re(),St(i.name),re(),Oe("ngIf",i.description)}}function dD(c,a){if(c&1&&(O(0,"div",31),Y(1),F()),c&2){let i=ze(2);re(),St(i.roleError)}}function uD(c,a){if(c&1){let i=Xt();O(0,"div",54)(1,"div",55)(2,"div",56)(3,"h3"),Y(4,"Asignar Roles del Sistema"),F(),O(5,"button",57),tt("click",function(){mt(i);let h=ze();return ft(h.closeRolesModal())}),Y(6,"\xD7"),F()(),O(7,"div",58)(8,"div",63),Xe(9,cD,5,7,"div",64),F(),Xe(10,dD,2,1,"div",15),F(),O(11,"div",60)(12,"button",61),tt("click",function(){mt(i);let h=ze();return ft(h.closeRolesModal())}),Y(13,"Cancelar"),F(),O(14,"button",62),tt("click",function(){mt(i);let h=ze();return ft(h.saveRoles())}),Y(15),F()()()()}if(c&2){let i=ze();re(9),Oe("ngForOf",i.roles),re(),Oe("ngIf",i.roleError),re(4),Oe("disabled",i.roleAssignmentInProgress),re(),Ot(" ",i.roleAssignmentInProgress?"Guardando...":"Guardar"," ")}}function hD(c,a){if(c&1&&(O(0,"li"),Y(1),F()),c&2){let i=a.$implicit;re(),St(i)}}function pD(c,a){if(c&1&&(O(0,"div")(1,"ul"),Xe(2,hD,2,1,"li",29),F()()),c&2){let i=ze(3);re(2),Oe("ngForOf",i.userRolesDetails.user_roles)}}function mD(c,a){c&1&&(O(0,"p"),Y(1,"No tiene roles del sistema asignados"),F())}function fD(c,a){if(c&1&&(O(0,"li"),Y(1),F()),c&2){let i=a.$implicit;re(),St(i)}}function gD(c,a){if(c&1&&(O(0,"div")(1,"ul"),Xe(2,fD,2,1,"li",29),F()()),c&2){let i=ze(3);re(2),Oe("ngForOf",i.userRolesDetails.grafana_roles)}}function _D(c,a){c&1&&(O(0,"p"),Y(1,"No tiene roles de Grafana asignados"),F())}function yD(c,a){if(c&1&&(O(0,"div")(1,"div",71)(2,"strong"),Y(3,"Nombre:"),F(),Y(4),F(),O(5,"div",71)(6,"strong"),Y(7,"Email:"),F(),Y(8),F(),O(9,"h4"),Y(10,"Roles del Sistema"),F(),Xe(11,pD,3,1,"div",72)(12,mD,2,0,"ng-template",null,0,Qc),O(14,"h4"),Y(15,"Roles de Grafana"),F(),Xe(16,gD,3,1,"div",72)(17,_D,2,0,"ng-template",null,1,Qc),F()),c&2){let i=cn(13),l=cn(18),h=ze(2);re(4),Ko(" ",h.userRolesDetails.firstName," ",h.userRolesDetails.lastName," "),re(4),Ot(" ",h.userRolesDetails.email," "),re(3),Oe("ngIf",(h.userRolesDetails.user_roles==null?null:h.userRolesDetails.user_roles.length)>0)("ngIfElse",i),re(5),Oe("ngIf",(h.userRolesDetails.grafana_roles==null?null:h.userRolesDetails.grafana_roles.length)>0)("ngIfElse",l)}}function vD(c,a){if(c&1){let i=Xt();O(0,"div",54)(1,"div",55)(2,"div",56)(3,"h3"),Y(4),F(),O(5,"button",57),tt("click",function(){mt(i);let h=ze();return ft(h.closeRolesViewModal())}),Y(6,"\xD7"),F()(),O(7,"div",58),Xe(8,yD,19,7,"div",32),F(),O(9,"div",60)(10,"button",70),tt("click",function(){mt(i);let h=ze();return ft(h.closeRolesViewModal())}),Y(11,"Cerrar"),F()()()()}if(c&2){let i=ze();re(4),Ot("Roles del Usuario: ",i.userRolesDetails==null?null:i.userRolesDetails.username,""),re(4),Oe("ngIf",i.userRolesDetails)}}function bD(c,a){if(c&1&&(O(0,"small",69),Y(1),F()),c&2){let i=ze().$implicit;re(),St(i.description)}}function xD(c,a){if(c&1){let i=Xt();O(0,"div",65)(1,"input",66),tt("change",function(h){let s=mt(i).$implicit,P=ze(2);return ft(P.onRoleChange(h,s.id,!0))}),F(),O(2,"label",67),Y(3),F(),Xe(4,bD,2,1,"small",68),F()}if(c&2){let i=a.$implicit,l=ze(2);re(),Oe("id","modal-grafana-role-"+i.id)("value",i.id)("checked",l.isRoleSelected(i.id,!0))("disabled",l.roleAssignmentInProgress),re(),Oe("for","modal-grafana-role-"+i.id),re(),St(i.name),re(),Oe("ngIf",i.description)}}function wD(c,a){if(c&1&&(O(0,"div",31),Y(1),F()),c&2){let i=ze(2);re(),St(i.roleError)}}function CD(c,a){if(c&1){let i=Xt();O(0,"div",54)(1,"div",55)(2,"div",56)(3,"h3"),Y(4,"Asignar Roles de Grafana"),F(),O(5,"button",57),tt("click",function(){mt(i);let h=ze();return ft(h.closeGrafanaRolesModal())}),Y(6,"\xD7"),F()(),O(7,"div",58)(8,"div",63),Xe(9,xD,5,7,"div",64),F(),Xe(10,wD,2,1,"div",15),F(),O(11,"div",60)(12,"button",61),tt("click",function(){mt(i);let h=ze();return ft(h.closeGrafanaRolesModal())}),Y(13,"Cancelar"),F(),O(14,"button",62),tt("click",function(){mt(i);let h=ze();return ft(h.saveGrafanaRoles())}),Y(15),F()()()()}if(c&2){let i=ze();re(9),Oe("ngForOf",i.grafanaRoles),re(),Oe("ngIf",i.roleError),re(4),Oe("disabled",i.roleAssignmentInProgress),re(),Ot(" ",i.roleAssignmentInProgress?"Guardando...":"Guardar"," ")}}var Lg=class c{constructor(a,i){this.http=a;this.fb=i;this.initUserForm()}activeTab="usuarios";users=[];filteredUsers=[];roles=[];grafanaRoles=[];auditLogs=[];filteredAuditLogs=[];userForm;selectedUser=null;token="";searchTerm="";selectedRoles=[];selectedGrafanaRoles=[];roleAssignmentInProgress=!1;roleError="";loading=!1;showPasswordModal=!1;showRolesModal=!1;showGrafanaRolesModal=!1;tempPassword="";auditFilter={type:"",action:""};apiUrl="https://www.medellin.gov.co/flask-fiware/api/keycloak";ngOnInit(){this.getToken()}initUserForm(){this.userForm=this.fb.group({username:["",[Oo.required],[this.asyncUsernameValidator.bind(this)]],email:["",[Oo.required,Oo.email]],firstName:["",Oo.required],lastName:["",Oo.required],enabled:[!0],password:[""]})}asyncUsernameValidator(a){return this.validateUsername(a.value).then(i=>i?null:{})}validateUsername(a){return Dr(this,null,function*(){if(!a||this.selectedUser)return!0;try{return(yield this.http.get(`${this.apiUrl}/users?username=${a}`,{headers:this.getHeaders()}).toPromise()).length===0}catch{return!1}})}getToken(){this.loading=!0;let a={username:"admin-user@hopu.eu",password:"5uLFJdgF65DqcMbGUzArLd29L4TAAdFHAMq8"};this.http.post(`${this.apiUrl}/login`,a).subscribe({next:i=>{this.token=i.access_token,this.loadInitialData(),this.loading=!1},error:i=>{console.error("Error al obtener token:",i),this.showError("Error al iniciar sesi\xF3n","No se pudo obtener el token de autenticaci\xF3n"),this.loading=!1}})}loadInitialData(){this.loadUsers(),this.loadRoles(),this.loadGrafanaRoles(),this.loadAuditLogs()}getHeaders(){return new Ts({Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"})}loadUsers(){this.loading=!0,this.http.get(`${this.apiUrl}/users`,{headers:this.getHeaders()}).subscribe({next:a=>{this.users=a,this.filteredUsers=[...this.users],this.users.forEach(i=>{this.loadUserRoles(i.id),this.loadUserGrafanaRoles(i.id)}),this.loading=!1},error:a=>{console.error("Error al cargar usuarios:",a),this.showError("Error","No se pudieron cargar los usuarios"),this.loading=!1}})}loadUserRoles(a){this.http.get(`${this.apiUrl}/user_roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:i=>{let l=this.users.find(h=>h.id===a);l&&(l.roles=i,this.filterUsers())},error:i=>{console.error(`Error al cargar roles para usuario ${a}:`,i)}})}loadUserGrafanaRoles(a){this.http.get(`${this.apiUrl}/roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:i=>{let l=this.users.find(h=>h.id===a);l&&(l.grafanaRoles=i,this.filterUsers())},error:i=>{console.error(`Error al cargar roles de Grafana para usuario ${a}:`,i)}})}loadRoles(){this.loading=!0,this.http.get(`${this.apiUrl}/user_roles`,{headers:this.getHeaders()}).subscribe({next:a=>{this.roles=a,this.loading=!1},error:a=>{console.error("Error al cargar roles:",a),this.showError("Error","No se pudieron cargar los roles"),this.loading=!1}})}loadGrafanaRoles(){this.loading=!0,this.http.get(`${this.apiUrl}/roles`,{headers:this.getHeaders()}).subscribe({next:a=>{this.grafanaRoles=a,this.loading=!1},error:a=>{console.error("Error al cargar roles de Grafana:",a),this.showError("Error","No se pudieron cargar los roles de Grafana"),this.loading=!1}})}loadAuditLogs(){this.loading=!0,this.http.get(`${this.apiUrl}/user_logs`,{headers:this.getHeaders()}).subscribe({next:a=>{this.auditLogs=a,this.http.get(`${this.apiUrl}/role_logs`,{headers:this.getHeaders()}).subscribe({next:i=>{this.auditLogs=[...this.auditLogs,...i],this.filteredAuditLogs=[...this.auditLogs],this.filterAuditLogs(),this.loading=!1},error:i=>{console.error("Error al cargar logs de roles:",i),this.loading=!1}})},error:a=>{console.error("Error al cargar logs de usuarios:",a),this.loading=!1}})}assignSingleRole(a,i){return this.http.post(`${this.apiUrl}/user_roles/user_id/${a}`,{roles:["manage-users","view-users","view-events"]},{headers:this.getHeaders()}).toPromise()}removeSingleRole(a,i){return this.http.delete(`${this.apiUrl}/user_roles/user_id/${a}/role_id/${i}`,{headers:this.getHeaders()}).toPromise()}assignSingleGrafanaRole(a,i){return this.http.put(`${this.apiUrl}/roles/user_id/${a}/role_id/${i}`,{},{headers:this.getHeaders()}).toPromise()}removeSingleGrafanaRole(a,i){return this.http.delete(`${this.apiUrl}/roles/user_id/${a}/role_id/${i}`,{headers:this.getHeaders()}).toPromise()}onRoleChange(a,i,l=!1){return Dr(this,null,function*(){if(!this.selectedUser){let h=l?this.selectedGrafanaRoles:this.selectedRoles;if(a.target.checked)h.includes(i)||h.push(i);else{let s=h.indexOf(i);s>-1&&h.splice(s,1)}return}this.roleAssignmentInProgress=!0,this.roleError="";try{a.target.checked?l?yield this.assignSingleGrafanaRole(this.selectedUser.id,i):yield this.assignSingleRole(this.selectedUser.id,i):l?yield this.removeSingleGrafanaRole(this.selectedUser.id,i):yield this.removeSingleRole(this.selectedUser.id,i),l?this.loadUserGrafanaRoles(this.selectedUser.id):this.loadUserRoles(this.selectedUser.id)}catch(h){console.error("Error al actualizar rol:",h),this.roleError="Error al actualizar el rol. Intente nuevamente.",a.target.checked=!a.target.checked}finally{this.roleAssignmentInProgress=!1}})}filterUsers(){if(!this.searchTerm){this.filteredUsers=[...this.users];return}let a=this.searchTerm.toLowerCase();this.filteredUsers=this.users.filter(i=>i.firstName&&i.firstName.toLowerCase().includes(a)||i.lastName&&i.lastName.toLowerCase().includes(a)||i.email&&i.email.toLowerCase().includes(a)||i.username&&i.username.toLowerCase().includes(a))}filterAuditLogs(){this.filteredAuditLogs=this.auditLogs.filter(a=>{let i=!0;return this.auditFilter.type&&(i=i&&a.resourceType===this.auditFilter.type),this.auditFilter.action&&(i=i&&a.operationType===this.auditFilter.action),i}).sort((a,i)=>new Date(i.time).getTime()-new Date(a.time).getTime())}clearAuditFilters(){this.auditFilter={type:"",action:""},this.filterAuditLogs()}getActionName(a){switch(a){case"CREATE":return"Creaci\xF3n";case"UPDATE":return"Actualizaci\xF3n";case"DELETE":return"Eliminaci\xF3n";default:return a}}getResourceType(a){switch(a){case"USER":return"Usuario";case"ROLE":return"Rol";default:return a}}getUsersWithRole(a){return this.users.filter(i=>i.roles&&i.roles.some(l=>l.id===a))}getUsersWithGrafanaRole(a){return this.users.filter(i=>i.grafanaRoles&&i.grafanaRoles.some(l=>l.id===a))}isRoleSelected(a,i=!1){return this.selectedUser?i?this.selectedUser.grafanaRoles&&this.selectedUser.grafanaRoles.some(l=>l.id===a):this.selectedUser.roles&&this.selectedUser.roles.some(l=>l.id===a):i?this.selectedGrafanaRoles.includes(a):this.selectedRoles.includes(a)}createUser(){if(this.userForm.valid){let a={username:this.userForm.value.username,email:this.userForm.value.email,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,enabled:this.userForm.value.enabled};dc.default.fire({title:"Crear usuario",text:"\xBFEst\xE1 seguro de que desea crear este usuario?",icon:"question",showCancelButton:!0,confirmButtonColor:"#334155",cancelButtonColor:"#d33",confirmButtonText:"S\xED, crear",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.createUserWithRoles(a)})}}createUserWithRoles(a){this.loading=!0,this.http.post(`${this.apiUrl}/users`,a,{headers:this.getHeaders()}).subscribe({next:i=>{let l=i.id,h=this.userForm.value.password,s=[];h&&s.push(this.setUserPassword(l,h)),Promise.all(s).then(()=>{this.showSuccess("Usuario creado","El usuario ha sido creado correctamente"),this.resetFormAndReload(),this.loading=!1,dc.default.fire({title:"Usuario creado",text:"\xBFDesea asignar roles ahora?",icon:"success",showCancelButton:!0,confirmButtonText:"S\xED, asignar roles",cancelButtonText:"M\xE1s tarde",confirmButtonColor:"#334155"}).then(P=>{P.isConfirmed&&(this.editUser(i),this.openRolesModal())})}).catch(P=>{this.showError("Error","Ocurri\xF3 un error al completar la creaci\xF3n del usuario"),console.error("Error en el proceso de creaci\xF3n:",P),this.loading=!1})},error:i=>{let l="Ocurri\xF3 un error al crear el usuario";try{let h=JSON.parse(i.error);h.errorMessage&&h.errorMessage.includes("User exists with same email")?l="Ya existe un usuario con el mismo correo electr\xF3nico":h.errorMessage&&h.errorMessage.includes("User exists with same username")&&(l="Ya existe un usuario con el mismo nombre de usuario")}catch{}this.showError("Error",l),this.loading=!1}})}setUserPassword(a,i){return new Promise((l,h)=>{let s={type:"password",value:i,temporary:!1};this.http.put(`${this.apiUrl}/password/${a}`,s,{headers:this.getHeaders()}).subscribe({next:()=>l(),error:P=>h(P)})})}showRolesViewModal=!1;userRolesDetails=null;viewUserRoles(a){return Dr(this,null,function*(){this.loading=!0;try{let i=yield this.http.get(`http://flask-fiware.apps.preprodalcaldia.medellin.gov.co/api/keycloak/userall/${a}`,{headers:this.getHeaders()}).toPromise();this.userRolesDetails=i,this.showRolesViewModal=!0}catch(i){console.error("Error al obtener roles del usuario:",i),this.showError("Error","No se pudieron cargar los roles del usuario")}finally{this.loading=!1}})}openRolesViewModal(a){this.viewUserRoles(a)}closeRolesViewModal(){this.showRolesViewModal=!1,this.userRolesDetails=null}assignRolesToUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.post(`${this.apiUrl}/user_roles/user_id/${a}`,s,{headers:this.getHeaders()}).subscribe({next:()=>l(),error:P=>h(P)})})}assignGrafanaRolesToUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.post(`${this.apiUrl}/roles/user_id/${a}`,s,{headers:this.getHeaders()}).subscribe({next:()=>l(),error:P=>h(P)})})}editUser(a){this.selectedUser=a,this.selectedRoles=a.roles?a.roles.map(i=>i.id):[],this.selectedGrafanaRoles=a.grafanaRoles?a.grafanaRoles.map(i=>i.id):[],this.selectedUser&&this.userForm.get("username")?.disable(),this.userForm.patchValue({username:a.username,email:a.email,firstName:a.firstName,lastName:a.lastName,enabled:a.enabled,password:""})}assignRoles(a){this.selectedUser=a,this.selectedRoles=a.roles?a.roles.map(i=>i.id):[],this.selectedGrafanaRoles=a.grafanaRoles?a.grafanaRoles.map(i=>i.id):[],this.openRolesModal()}openPasswordModal(){this.tempPassword="",this.showPasswordModal=!0}closePasswordModal(){this.showPasswordModal=!1}savePassword(){this.tempPassword&&this.selectedUser&&(this.loading=!0,this.setUserPassword(this.selectedUser.id,this.tempPassword).then(()=>{this.showSuccess("Contrase\xF1a actualizada","La contrase\xF1a se ha actualizado correctamente"),this.closePasswordModal(),this.loading=!1}).catch(a=>{this.showError("Error","No se pudo actualizar la contrase\xF1a"),console.error("Error al actualizar contrase\xF1a:",a),this.loading=!1}))}openRolesModal(){this.showRolesModal=!0}closeRolesModal(){this.showRolesModal=!1}openGrafanaRolesModal(){this.showGrafanaRolesModal=!0}closeGrafanaRolesModal(){this.showGrafanaRolesModal=!1}saveRoles(){if(this.selectedUser){this.loading=!0;try{this.showSuccess("Roles actualizados","Los roles del sistema se han actualizado correctamente"),this.closeRolesModal(),this.loading=!1}catch(a){this.showError("Error","No se pudieron actualizar los roles"),console.error("Error al actualizar roles:",a),this.loading=!1}}}saveGrafanaRoles(){if(this.selectedUser){this.loading=!0;try{this.showSuccess("Roles actualizados","Los roles de Grafana se han actualizado correctamente"),this.loadUserGrafanaRoles(this.selectedUser.id),this.closeGrafanaRolesModal(),this.loading=!1}catch(a){this.showError("Error","No se pudieron actualizar los roles de Grafana"),console.error("Error al actualizar roles de Grafana:",a),this.loading=!1}}}cancelEdit(){this.selectedUser=null,this.selectedRoles=[],this.selectedGrafanaRoles=[],this.userForm.reset(),this.userForm.patchValue({enabled:!0})}updateUser(){if(this.userForm.valid&&this.selectedUser){let a={email:this.userForm.value.email,firstName:this.userForm.value.firstName,lastName:this.userForm.value.lastName,enabled:this.userForm.value.enabled},i=this.selectedUser.id,l=this.userForm.value.password;dc.default.fire({title:"Actualizar usuario",text:"\xBFEst\xE1 seguro de que desea actualizar este usuario?",icon:"question",showCancelButton:!0,confirmButtonColor:"#334155",cancelButtonColor:"#d33",confirmButtonText:"S\xED, actualizar",cancelButtonText:"Cancelar"}).then(h=>{h.isConfirmed&&this.updateUserWithRoles(i,a,l)})}}updateUserWithRoles(a,i,l){this.loading=!0,this.http.put(`${this.apiUrl}/users/${a}`,i,{headers:this.getHeaders()}).subscribe({next:()=>{let h=[];l&&h.push(this.setUserPassword(a,l)),Promise.all(h).then(()=>{this.showSuccess("Usuario actualizado","El usuario ha sido actualizado correctamente"),this.resetFormAndReload(),this.loading=!1}).catch(s=>{this.showError("Error","Ocurri\xF3 un error al actualizar el usuario"),console.error("Error en el proceso de actualizaci\xF3n:",s),this.loading=!1})},error:h=>{this.showError("Error","Ocurri\xF3 un error al actualizar el usuario"),console.error("Error al actualizar usuario:",h),this.loading=!1}})}updateUserRoles(a,i){return new Promise((l,h)=>{this.http.get(`${this.apiUrl}/user_roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:s=>{let P=s.map($=>$.id),q=i.filter($=>!P.includes($)),X=P.filter($=>!i.includes($)),be=q.length>0?this.assignRolesToUser(a,q):Promise.resolve(),ve=X.length>0?this.removeRolesFromUser(a,X):Promise.resolve();Promise.all([be,ve]).then(()=>l()).catch($=>h($))},error:s=>h(s)})})}updateUserGrafanaRoles(a,i){return new Promise((l,h)=>{this.http.get(`${this.apiUrl}/roles/user_id/${a}`,{headers:this.getHeaders()}).subscribe({next:s=>{let P=s.map($=>$.id),q=i.filter($=>!P.includes($)),X=P.filter($=>!i.includes($)),be=q.length>0?this.assignGrafanaRolesToUser(a,q):Promise.resolve(),ve=X.length>0?this.removeGrafanaRolesFromUser(a,X):Promise.resolve();Promise.all([be,ve]).then(()=>l()).catch($=>h($))},error:s=>h(s)})})}removeRolesFromUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.request("DELETE",`${this.apiUrl}/user_roles/user_id/${a}`,{headers:this.getHeaders(),body:s}).subscribe({next:()=>l(),error:P=>h(P)})})}removeGrafanaRolesFromUser(a,i){return new Promise((l,h)=>{let s={roles:i};this.http.request("DELETE",`${this.apiUrl}/roles/user_id/${a}`,{headers:this.getHeaders(),body:s}).subscribe({next:()=>l(),error:P=>h(P)})})}confirmDelete(a){dc.default.fire({title:"Eliminar usuario",text:"\xBFEst\xE1 seguro de que desea eliminar este usuario? Esta acci\xF3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#334155",confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.deleteUser(a)})}deleteUser(a){this.loading=!0,this.http.delete(`${this.apiUrl}/users/${a}`,{headers:this.getHeaders()}).subscribe({next:()=>{this.showSuccess("Usuario eliminado","El usuario ha sido eliminado correctamente"),this.loadUsers(),this.loading=!1},error:i=>{this.showError("Error","Ocurri\xF3 un error al eliminar el usuario"),console.error("Error al eliminar usuario:",i),this.loading=!1}})}resetFormAndReload(){this.selectedUser=null,this.selectedRoles=[],this.selectedGrafanaRoles=[],this.userForm.reset(),this.userForm.patchValue({enabled:!0}),this.loadUsers()}showSuccess(a,i){dc.default.fire({icon:"success",title:a,text:i,confirmButtonColor:"#334155"})}showError(a,i){dc.default.fire({icon:"error",title:a,text:i,confirmButtonColor:"#334155"})}changeTab(a){this.activeTab=a,a==="usuarios"?this.loadUsers():a==="roles"?(this.loadRoles(),this.loadGrafanaRoles()):a==="auditoria"&&this.loadAuditLogs()}viewRoleDetails(a,i=!1){let l=i?this.getUsersWithGrafanaRole(a.id):this.getUsersWithRole(a.id);dc.default.fire({title:`Detalles del Rol: ${a.name}`,html:`
        <p><strong>Tipo:</strong> ${i?"Grafana":"Sistema"}</p>
        <p><strong>Descripci\xF3n:</strong> ${a.description||"No disponible"}</p>
        <p><strong>Usuarios con este rol (${l.length}):</strong></p>
        <ul>
          ${l.map(h=>`<li>${h.username} (${h.firstName} ${h.lastName})</li>`).join("")}
        </ul>
      `,confirmButtonColor:"#334155"})}static \u0275fac=function(i){return new(i||c)(It(Ao),It(Gf))};static \u0275cmp=rt({type:c,selectors:[["app-user-management"]],decls:24,vars:20,consts:[["noSystemRoles",""],["noGrafanaRoles",""],[1,"container"],["class","loading-overlay",4,"ngIf"],[1,"tabs"],[3,"click"],["class","tab-content",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"loading-overlay"],[1,"spinner"],[1,"tab-content"],[1,"user-form"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","username","placeholder","Ingrese nombre de usuario"],["class","error-message",4,"ngIf"],["type","email","formControlName","email","placeholder","Ingrese correo electr\xF3nico"],["type","text","formControlName","firstName","placeholder","Ingrese nombre"],["type","text","formControlName","lastName","placeholder","Ingrese apellido"],["type","checkbox","formControlName","enabled"],[1,"form-actions"],["type","submit",3,"disabled"],["type","button",3,"click",4,"ngIf"],["type","button","class","password-btn",3,"click",4,"ngIf"],["type","button","class","roles-btn",3,"click",4,"ngIf"],["type","button","class","grafana-roles-btn",3,"click",4,"ngIf"],[1,"user-list"],[1,"search-bar"],["type","text","placeholder","Buscar usuarios...",3,"ngModelChange","input","ngModel"],[4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],[1,"error-message"],[4,"ngIf"],["type","button",3,"click"],["type","button",1,"password-btn",3,"click"],["type","button",1,"roles-btn",3,"click"],["type","button",1,"grafana-roles-btn",3,"click"],[1,"actions"],[1,"edit-btn",3,"click"],[1,"delete-btn",3,"click"],[1,"no-results"],["class","user-badge",4,"ngFor","ngForOf"],[1,"user-badge"],[1,"filters"],[1,"filter-group"],[3,"ngModelChange","change","ngModel"],["value",""],["value","USER"],["value","ROLE"],["value","GRAFANA_ROLE"],["value","CREATE"],["value","UPDATE"],["value","DELETE"],[1,"audit-logs"],[1,"modal-overlay"],[1,"modal"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],["type","password","placeholder","Ingrese la nueva contrase\xF1a",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"cancel-btn",3,"click"],[1,"save-btn",3,"click","disabled"],[1,"roles-container"],["class","role-checkbox",4,"ngFor","ngForOf"],[1,"role-checkbox"],["type","checkbox",3,"change","id","value","checked","disabled"],[3,"for"],["class","role-description",4,"ngIf"],[1,"role-description"],[1,"save-btn",3,"click"],[1,"user-detail"],[4,"ngIf","ngIfElse"]],template:function(i,l){i&1&&(O(0,"div",2)(1,"h1"),Y(2,"Gesti\xF3n de Usuarios"),F(),Xe(3,OA,4,0,"div",3),O(4,"div",4)(5,"button",5),tt("click",function(){return l.changeTab("usuarios")}),Y(6,"Usuarios"),F(),O(7,"button",5),tt("click",function(){return l.changeTab("roles")}),Y(8,"Roles"),F(),O(9,"button",5),tt("click",function(){return l.changeTab("grafana-roles")}),Y(10,"Roles Grafana"),F(),O(11,"button",5),tt("click",function(){return l.changeTab("auditoria")}),Y(12,"Auditor\xEDa"),F(),O(13,"button",5),tt("click",function(){return l.changeTab("subdimensiones")}),Y(14,"Subdimensiones"),F()(),Xe(15,FA,2,0,"div",6)(16,WA,57,16,"div",6)(17,QA,18,2,"div",6)(18,nD,18,2,"div",6)(19,sD,47,4,"div",6),F(),Xe(20,aD,17,3,"div",7)(21,uD,16,4,"div",7)(22,vD,12,2,"div",7)(23,CD,16,4,"div",7)),i&2&&(re(3),Oe("ngIf",l.loading),re(2),si("active",l.activeTab==="usuarios"),re(2),si("active",l.activeTab==="roles"),re(2),si("active",l.activeTab==="grafana-roles"),re(2),si("active",l.activeTab==="auditoria"),re(2),si("active",l.activeTab==="subdimensiones"),re(2),Oe("ngIf",l.activeTab==="subdimensiones"),re(),Oe("ngIf",l.activeTab==="usuarios"),re(),Oe("ngIf",l.activeTab==="roles"),re(),Oe("ngIf",l.activeTab==="grafana-roles"),re(),Oe("ngIf",l.activeTab==="auditoria"),re(),Oe("ngIf",l.showPasswordModal),re(),Oe("ngIf",l.showRolesModal),re(),Oe("ngIf",l.showRolesViewModal),re(),Oe("ngIf",l.showGrafanaRolesModal))},dependencies:[nr,Qo,co,Qm,Hf,$f,Au,Du,la,ey,sc,ca,Vf,sd,Lp,sa,ac,il,Fg],styles:['@charset "UTF-8";.container[_ngcontent-%COMP%]{max-width:1200px;margin-left:20%;padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}h1[_ngcontent-%COMP%]{color:#334155;margin-bottom:30px;text-align:center}.tabs[_ngcontent-%COMP%]{display:flex;margin-bottom:20px;border-bottom:1px solid #e2e8f0}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;background:none;border:none;cursor:pointer;font-size:16px;color:#64748b;position:relative;transition:all .3s ease}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#334155}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:#334155;font-weight:700}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-1px;left:0;width:100%;height:2px;background-color:#334155}.tab-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 10px #0000001a}.user-form[_ngcontent-%COMP%]{margin-bottom:30px;padding:20px;background:#f8fafc;border-radius:8px}.user-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;color:#334155;font-size:20px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:15px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:500;color:#334155}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #e2e8f0;border-radius:4px;font-size:14px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus, .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]:focus, .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]:focus, .user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#94a3b8}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-left:10px}.user-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;font-size:12px;color:#64748b;margin-top:5px}.user-form[_ngcontent-%COMP%]   .roles-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}.user-form[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;background:#e2e8f0;padding:5px 10px;border-radius:20px}.user-form[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:5px}.user-form[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:0;font-weight:400}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:20px}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-weight:500;transition:background-color .3s ease}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#334155;color:#fff}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#1e293b}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#cbd5e1;cursor:not-allowed}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]{background-color:#e2e8f0;color:#334155}.user-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]:hover{background-color:#cbd5e1}.user-list[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{margin-bottom:20px}.user-list[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #e2e8f0;border-radius:4px;font-size:14px}.user-list[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#94a3b8}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #e2e8f0}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;color:#334155;font-weight:600}.user-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.user-list[_ngcontent-%COMP%]   .role-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e2e8f0;color:#334155;padding:3px 8px;border-radius:12px;font-size:12px;margin-right:5px;margin-bottom:5px}.user-list[_ngcontent-%COMP%]   .no-roles[_ngcontent-%COMP%]{color:#94a3b8;font-style:italic;font-size:12px}.user-list[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{color:#16a34a;font-weight:500}.user-list[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]{color:#dc2626;font-weight:500}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:5px}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;font-size:13px;transition:background-color .3s ease}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.edit-btn[_ngcontent-%COMP%]{background-color:#e0f2fe;color:#0369a1}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.edit-btn[_ngcontent-%COMP%]:hover{background-color:#bae6fd}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]{background-color:#fee2e2;color:#b91c1c}.user-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]:hover{background-color:#fecaca}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #e2e8f0}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;color:#334155;font-weight:600}.roles-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.roles-list[_ngcontent-%COMP%]   .user-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e2e8f0;color:#334155;padding:3px 8px;border-radius:12px;font-size:12px;margin-right:5px;margin-bottom:5px}.audit-logs[_ngcontent-%COMP%]{margin-top:20px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#334155}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #e2e8f0;border-radius:4px;font-size:14px}.audit-logs[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#94a3b8}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #e2e8f0}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;color:#334155;font-weight:600}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.no-results[_ngcontent-%COMP%]{text-align:center;padding:20px;color:#64748b;font-style:italic}.filter-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#334155;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s ease}.filter-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1e293b}.password-btn[_ngcontent-%COMP%]{background-color:#dbeafe!important;color:#1d4ed8!important}.password-btn[_ngcontent-%COMP%]:hover{background-color:#bfdbfe!important}.roles-btn[_ngcontent-%COMP%]{background-color:#e0f2fe!important;color:#0369a1!important}.roles-btn[_ngcontent-%COMP%]:hover{background-color:#bae6fd!important}.grafana-roles-btn[_ngcontent-%COMP%]{background-color:#ecfccb!important;color:#4d7c0f!important}.grafana-roles-btn[_ngcontent-%COMP%]:hover{background-color:#d9f99d!important}.error-message[_ngcontent-%COMP%]{color:#dc2626;font-size:12px;margin-top:5px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#fffc;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:1000}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:15px;color:#334155;font-weight:500}.spinner[_ngcontent-%COMP%]{border:4px solid #e2e8f0;border-top:4px solid #334155;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #e2e8f0;border-radius:4px;background-color:#fff;color:#334155;font-size:14px;transition:border-color .3s ease}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#94a3b8}.user-info[_ngcontent-%COMP%]{background-color:#f8fafc;padding:10px;border-radius:4px;margin-bottom:15px;border-left:3px solid #334155}.user-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#334155}.roles-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .user-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(.edit-btn):not(.delete-btn){padding:5px 10px;background-color:#e2e8f0;color:#334155;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s ease}.roles-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .user-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(.edit-btn):not(.delete-btn):hover{background-color:#cbd5e1}.role-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:8px;accent-color:#334155}.user-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e2e8f0;color:#334155;padding:3px 8px;border-radius:12px;font-size:12px;margin-right:5px;margin-bottom:5px}.audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.audit-logs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .audit-logs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #e2e8f0}.audit-logs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f5f9;color:#334155;font-weight:600}.audit-logs[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}@media (max-width: 768px){.container[_ngcontent-%COMP%]{margin-left:0;padding:10px}.tabs[_ngcontent-%COMP%]{flex-wrap:wrap}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1 0 auto;padding:8px 10px;font-size:14px}.filters[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.modal[_ngcontent-%COMP%]{width:95%}.roles-container[_ngcontent-%COMP%]{grid-template-columns:1fr}}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;width:90%;max-width:500px;box-shadow:0 10px 30px #0003;overflow:hidden;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out;color:#1e293b}.modal-header[_ngcontent-%COMP%]{background-color:#334155;color:#fff;padding:1rem;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;color:#fff;cursor:pointer;transition:color .2s ease}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{color:#f87171}.modal-body[_ngcontent-%COMP%]{padding:1rem;max-height:400px;overflow-y:auto}.modal-body[_ngcontent-%COMP%]   .roles-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.modal-body[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.modal-body[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:.5rem}.modal-body[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;display:flex;align-items:center;gap:.5rem;cursor:pointer}.modal-body[_ngcontent-%COMP%]   .role-checkbox[_ngcontent-%COMP%]   .role-description[_ngcontent-%COMP%]{font-size:.875rem;color:#64748b;padding-left:1.5rem}.modal-body[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{background-color:#f1f5f9;border-radius:8px;padding:.5rem 1rem;margin-bottom:1rem;font-size:.95rem}.modal-body[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#0f172a}.modal-body[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#dc2626;margin-top:1rem;font-weight:500}.modal-footer[_ngcontent-%COMP%]{padding:1rem;display:flex;justify-content:flex-end;gap:.75rem;background-color:#f8fafc;border-top:1px solid #e2e8f0}.modal-footer[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%], .modal-footer[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:8px;border:none;cursor:pointer;font-weight:600;transition:background-color .2s ease}.modal-footer[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{background-color:#e2e8f0;color:#1e293b}.modal-footer[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover{background-color:#cbd5e1}.modal-footer[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{background-color:#334155;color:#fff}.modal-footer[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:hover{background-color:#1e293b}.modal-footer[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:disabled{background-color:#94a3b8;cursor:not-allowed}@keyframes _ngcontent-%COMP%_fadeIn{0%{transform:scale(.95);opacity:0}to{transform:scale(1);opacity:1}}.audit-tab-wrapper[_ngcontent-%COMP%]{padding:1.5rem;background-color:#f8fafc;border-radius:12px;box-shadow:0 2px 8px #0000000d;color:#1e293b}.audit-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem;color:#334155}.audit-filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1.5rem;align-items:flex-end}.audit-filters[_ngcontent-%COMP%]   .audit-filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.audit-filters[_ngcontent-%COMP%]   .audit-filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;margin-bottom:.25rem;color:#475569}.audit-filters[_ngcontent-%COMP%]   .audit-filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #cbd5e1;border-radius:6px;background-color:#fff;font-size:.95rem;color:#0f172a}.audit-filters[_ngcontent-%COMP%]   .audit-clear-btn[_ngcontent-%COMP%]{background-color:#e11d48;color:#fff;padding:.55rem 1rem;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:background-color .2s}.audit-filters[_ngcontent-%COMP%]   .audit-clear-btn[_ngcontent-%COMP%]:hover{background-color:#be123c}.audit-table-container[_ngcontent-%COMP%]{overflow-x:auto}.audit-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;border-radius:10px;overflow:hidden}.audit-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .audit-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;border-bottom:1px solid #e2e8f0}.audit-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#334155;color:#f1f5f9;font-weight:600}.audit-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#1e293b;font-size:.95rem}.audit-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f5f9}.audit-no-results[_ngcontent-%COMP%]{text-align:center;padding:1rem;font-style:italic;color:#64748b}.tab-content[_ngcontent-%COMP%]{padding:1.5rem;background-color:#f8fafc;border-radius:12px;box-shadow:0 4px 12px #0000000d;color:#1e293b;font-family:Segoe UI,sans-serif}.tab-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;color:#334155;margin-bottom:1rem}.tab-content[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1.5rem}.tab-content[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.tab-content[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.25rem;color:#475569}.tab-content[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem;border-radius:8px;border:1px solid #cbd5e1;background-color:#fff;color:#1e293b;font-size:.9rem}.tab-content[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#334155;box-shadow:0 0 0 2px #33415533}.tab-content[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{align-self:end;padding:.5rem 1rem;background-color:#334155;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:background-color .3s ease}.tab-content[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1e293b}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]{overflow-x:auto}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 6px #0000000d}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#e2e8f0}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;font-size:.9rem;color:#334155;font-weight:700}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f1f5f9}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0f2fe}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;font-size:.9rem;color:#475569}.tab-content[_ngcontent-%COMP%]   .audit-logs[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{text-align:center;margin-top:1rem;font-style:italic;color:#94a3b8}']})};var YC=[{path:"",component:Vp},{path:"login",component:Vp},{path:"",component:sg,children:[{path:"inicio",component:ag},{path:"menu",component:zu},{path:"ambiente/residuos/camiones/dashboard",component:lg},{path:"ambiente/calidad/ruido/dashboard",component:cg},{path:"reportes",component:dg},{path:"economico/digital/wifi/dashboard",component:ug},{path:"habitat/movilidad/vamosmed/dashboard",component:hg},{path:"habitat/movilidad/dashboard",component:Og},{path:"perfil/usuarios",component:Lg},{path:"gobernanza/participacion/pqrs/dashboard",component:pg},{path:"whatsapp",component:mg},{path:"calidad/turismo/dashboard",component:fg},{path:"ambiente/calidad/siata/dashboard",component:gg},{path:"ambiente/residuos/camiones/mapa",component:_g},{path:"mapas/reportes",component:yg},{path:"economico/digital/wifi/mapa",component:Ig,data:{ssr:!1}},{path:"habitat/movilidad/vamosmed/mapa",component:kg},{path:"ambiente/calidad/ruido/mapa",component:Ag},{path:"calidad/turismo/map",component:Dg},{path:"ambiente/calidad/siata/mapa",component:Rg}]},{path:"**",redirectTo:"login"}];var MD="@",SD=(()=>{class c{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=ge(tx,{optional:!0});loadingSchedulerFn=ge(PD,{optional:!0});_engine;constructor(i,l,h,s,P){this.doc=i,this.delegate=l,this.zone=h,this.animationType=s,this.moduleImpl=P}ngOnDestroy(){this._engine?.flush()}loadImpl(){let i=()=>this.moduleImpl??import("./chunk-EI2BLJX4.js").then(h=>h),l;return this.loadingSchedulerFn?l=this.loadingSchedulerFn(i):l=i(),l.catch(h=>{throw new Di(5300,!1)}).then(({\u0275createEngine:h,\u0275AnimationRendererFactory:s})=>{this._engine=h(this.animationType,this.doc);let P=new s(this.delegate,this._engine,this.zone);return this.delegate=P,P})}createRenderer(i,l){let h=this.delegate.createRenderer(i,l);if(h.\u0275type===0)return h;typeof h.throwOnSyntheticProps=="boolean"&&(h.throwOnSyntheticProps=!1);let s=new ev(h);return l?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(P=>{let q=P.createRenderer(i,l);s.use(q),this.scheduler?.notify(11)}).catch(P=>{s.use(h)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static \u0275fac=function(l){Nm()};static \u0275prov=st({token:c,factory:c.\u0275fac})}return c})(),ev=class{delegate;replay=[];\u0275type=1;constructor(a){this.delegate=a}use(a){if(this.delegate=a,this.replay!==null){for(let i of this.replay)i(a);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(a,i){return this.delegate.createElement(a,i)}createComment(a){return this.delegate.createComment(a)}createText(a){return this.delegate.createText(a)}get destroyNode(){return this.delegate.destroyNode}appendChild(a,i){this.delegate.appendChild(a,i)}insertBefore(a,i,l,h){this.delegate.insertBefore(a,i,l,h)}removeChild(a,i,l){this.delegate.removeChild(a,i,l)}selectRootElement(a,i){return this.delegate.selectRootElement(a,i)}parentNode(a){return this.delegate.parentNode(a)}nextSibling(a){return this.delegate.nextSibling(a)}setAttribute(a,i,l,h){this.delegate.setAttribute(a,i,l,h)}removeAttribute(a,i,l){this.delegate.removeAttribute(a,i,l)}addClass(a,i){this.delegate.addClass(a,i)}removeClass(a,i){this.delegate.removeClass(a,i)}setStyle(a,i,l,h){this.delegate.setStyle(a,i,l,h)}removeStyle(a,i,l){this.delegate.removeStyle(a,i,l)}setProperty(a,i,l){this.shouldReplay(i)&&this.replay.push(h=>h.setProperty(a,i,l)),this.delegate.setProperty(a,i,l)}setValue(a,i){this.delegate.setValue(a,i)}listen(a,i,l){return this.shouldReplay(i)&&this.replay.push(h=>h.listen(a,i,l)),this.delegate.listen(a,i,l)}shouldReplay(a){return this.replay!==null&&a.startsWith(MD)}},PD=new ut("");function KC(c="animations"){return H_("NgAsyncAnimations"),Xc([{provide:jm,useFactory:(a,i,l)=>new SD(a,i,l,c),deps:[vi,lf,_i]},{provide:Io,useValue:c==="noop"?"NoopAnimations":"BrowserAnimations"}])}var QC={providers:[Hw(YC),KC(),i0()]};var zg=class c{title="mi-aplicacion";static \u0275fac=function(i){return new(i||c)};static \u0275cmp=rt({type:c,selectors:[["app-root"]],decls:1,vars:0,template:function(i,l){i&1&&Te(0,"router-outlet")},dependencies:[nr,ic,Mp],encapsulation:2})};Jx(zg,QC).catch(c=>console.error(c));
